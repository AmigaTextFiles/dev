;Install script for TestHandler
;$VER: 1.0

FailAt 21

Version >NIL: VERSION=39
If WARN
   Copy TestHandler.guide.WB2.icon T:TestHandler.guide.info
Else
   Copy TestHandler.guide.WB3.icon T:TestHandler.guide.info
EndIf

RequestFile >ENV:THDir DRAWER="C:" TITLE="Select TestHandler program directory" DRAWERSONLY
If WARN
   Skip Cleanup
EndIf
Copy >NIL: TestHandler $THDir
If WARN
  SetENV THError program
  Skip Error
EndIf

RequestFile >ENV:THDir DRAWER=HELP: TITLE="Select TestHandler guide directory" DRAWERSONLY
If WARN
   Skip Cleanup
EndIf
Copy >NIL: TestHandler.guide T:TestHandler.guide.info $THDir
If WARN
  SetENV THError guide
  Skip Error
EndIf

Lab Cleanup
UnSetENV THDir
Delete T:TestHandler.guide.info QUIET
Quit

Lab Error
If EXISTS C:RequestChoice
  RequestChoice >NIL: TITLE="TestHandler Installer" BODY="Error copying $THError" GADGETS="Exit"
Else
  Echo "Error copying $THError" TO "CON:////TestHandler Installer/CLOSE/NOSIZE/WAIT" 
EndIf
UnSetENV THError
Skip Cleanup BACK
