@DATABASE SmartCrash.guide
@AUTHOR "Harry Sintonen"
@(c) "Copyright © PitPlane Productions"
@$VER: SmartCrash.guide 1.3.0 (9.3.00)
@COMMENT
@COMMENT  Right border at 62, no word wrap.
@COMMENT
@COMMENT Hands off dudes and dudettes!
@COMMENT
@WORDWRAP
@MASTER SmartCrash.guide
@INDEX Main
@NODE Main "SmartCrash Guide"
                                                    9-Mar-2000
Documentation for
                      @{u}@{b}  SmartCrash 1.3.0  @{ub}@{uu}

          Copyright © 1995-2000 PitPlane Productions
               Composed by Harry "Piru" Sintonen

       IMPORTANT! Please read @{"copyrights" LINK Copyrights}, @{"disclaimer" LINK Disclaimer} and
           @{"license" LINK License} parts of this document before use.

   @{"  " LINK Copyrights   0}  Copyrights		© © ©
   @{"  " LINK Introduction 0}  Introduction		@{b}What is@{ub} SmartCrash?
   @{"  " LINK Package      0}  Package			What's included?
   @{"  " LINK About        0}  About			Some words about SmartCrash.
   @{"  " LINK Features     0}  Features			!!
   @{"  " LINK Requirements 0}  Requirements		What is required.
   @{"  " LINK Installation 0}  Installation		How can I do it?
   @{"  " LINK Usage        0}  Usage			Really?
   @{"  " LINK Notes        0}  Important notes		Please read.
   @{"  " LINK Future       0}  Future			Things to do...
   @{"  " LINK License      0}  License			FreeWare!
   @{"  " LINK Disclaimer   0}  Disclaimer		"It's not my fault!"
   @{"  " LINK History      0}  History			What has happened.
@ENDNODE
@NODE Introduction "What is SmartCrash anyway?"

     @{b}INTRODUCTION@{ub}

Ever heard of a program called TNT? SmartCrash is very similar to it.
Simply SmartCrash replaces the @{"silly crash requester" LINK figure01} you get when a program crashes with @{"something better" LINK figure02}.

So why not use TNT then? It was made by Commodore after all.
Well that's the main reason really. You might have noticed that Commodore went under ages ago. That means TNT is old. VERY old. WhichAmiga on the other hand supports all "new" stuff (KS 3.0+, MC68060 and reqtools.library for example) and has some features TNT is lacking ("Skip" button for example).

The @{b}very cool@{ub} system enhancer @{"MCP" LINK MCPInfo} has similar patch too, called NoGuru. It has many features SmartCrash has, but is lacking some of the nicest (like Skip), plus NoGuru is bugged (just see what happens if more than one crash requester gets up). Also SmartCrash includes every function NoGuru has to offer.

Conclusion: SmartCrash is the best on its field.

See SmartCrash package @{"features" LINK Features} and @{"requirements" LINK Requirements}.
@ENDNODE
@NODE SegTrackerInfo "About SegTracker"

     @{b}SEGTRACKER@{ub}

SegTracker is a global tracking utility for disk loaded files including libraries and devices. If placed in the startup-sequence right after SetPatch, it will track all disk loaded segments (other than those loaded by SetPatch).

SegTracker is distributed with Enforcer V37 package. Enforcer is available on Aminet.

By using SegTracker, SmartCrash is possible to identify in which module address registers and 16 topmost longwords in stack point to.
@ENDNODE
@NODE MCPInfo "About MCP"

     @{b}MCP@{ub}

MCP, aka Master Control Program is the far best system enhancer there is. If you haven't heard about MCP before get it now!

Latest MCP versions plus latest beta releases can be downloaded from http://www.aliendesign.net.

If you intend to use SmartCrash make sure you turn off NoGuru from MCPPrefs.
@ENDNODE

@NODE skipbut "information about `skip' feature"

     @{b}SKIP INFORMATION@{ub}

Skip button of SmartCrash requester will skip the failed instruction. This works for all CPUs, including 68040 and 68060.

SmartCrash internally analyses the instruction causing the exception and advances PC to the next instruction.

line-a emulators and illegal instruction exceptions advance PC by 2.

line-f emulator exception advances PC according to failed instruction:

instruction	      bytes		notes

  PTRAPcc		4		68851 only
  PTRAPcc.W #<data>	6		68851 only
  PTRAPcc.L #<data>	8		68851 only
  PBcc.w <disp>		4		68851 only
  PBcc.L <disp>		6		68851 only
  PMOVE			4		68851/68030 only
  PLOAD			4		68851/68030 only
  PVALID		4		68851/68030 only
  PFLUSH*		4		68851/68030 only
  PTEST			4		68851/68030/68040/68060 only
  TBLU*			4		CPU32 only
  TBLS*			4		CPU32 only
  LPSTOP		6		CPU32/68060 only
  PDBcc Dn,<disp>	6		68851 only
  MOVE16 (an)+,(an)+	4		68040/68060 only
  PScc			4		68851 only
  MOVE16 abs		6		68040/68060 only
  other			2		the default

privilege violation exception advances PC according to failed instruction:

instruction	      bytes		notes
  ANDI #<data>,sr	4
  EORI #<data>,sr	4
  ORI #<data>,sr	4
  MOVEC xx,xx		4		68010+
  STOP #<data>		4
  PMOVE			4		68851/68030 only
  PLOAD			4		68851/68030 only
  PVALID		4		68851/68030 only
  PFLUSH*		4		68851/68030 only
  PTEST			4		68851/68030/68040/68060 only
  PBcc.W <disp>		4		68851 only
  MOVES xx,xx		4
  PTRAPcc.W #<data>	6		68851 only
  PDBcc Dn,<disp>	6		68851 only
  PBcc.L <disp>		6		68851 only
  PScc			6		68851 only
  LPSTOP #<data>	6		CPU32/68060 only
  PTRAPcc.L #<data>	8		68551 only
  other			2		the default
@ENDNODE

@NODE figure01 "FIGURE 1: Silly OS crash requester"
@FONT courier.font 13
@{JCENTER}___________________________________________
|Software Failure                       [_]
||¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯||
||   causefailpro                        ||
||   Program failed (error #80000005).   ||
||   Wait for disk activity to finish.   ||
||_______________________________________||
|.---------.                    .--------.|
|| Suspend |                    | Reboot ||
|`---------'                    `--------'|
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
FIGURE 1: Silly OS crash requester
@ENDNODE
@NODE figure02 "FIGURE 2: Great SmartCrash crash requester"
@FONT courier.font 13
@{JCENTER}____________________________________________________________________________________
|SmartCrash 1.3.0 Copyright © 1995-2000 Harry "Piru" Sintonen                    [_]
||¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯||
||   Exception 5: zero divide                                                     ||
||   Task: 768577F0  PC: 76597FF2  SR: 0000  USP: 7691C440  SSP: 760025E0         ||
||   D: 000000D0 000000D1 000000D2 000000D3 000000D4 000000D5 000000D6 000000D7   ||
||   A: 000000A0 000000A1 000000A2 000000A3 000000A4 1E26B6DE 000000A6 7691C440   ||
||   S: 000000A0 000000A1 76597FEE 76597FC2 000000D0 000000D1 000000D2 000000D3   ||
||   S: 000000D4 00000001 768599F4 00F9FDEA 00002800 7685952C 00000000 00000000   ||
||   Command: CLI[13]: causefailpro                                               ||
||                                                                                ||
||     PC=76597FF2 points to 'causefailpro', hunk 00:00006A                       ||
||     A5=1E26B6DE points to 'causefailpro', hunk 00:000066                       ||
||   S:08=76597FEE points to 'causefailpro', hunk 00:000066                       ||
||   S:0C=76597FC2 points to 'causefailpro', hunk 00:00003A                       ||
||________________________________________________________________________________||
| .------. .--------. .------. .-------. .--------. .--------. .-----. .---------. |
| | Skip | | Remove | | Exit | | Debug | | Reboot | | JMP... | | RTS | | Suspend | |
| `------' `--------' `------' `-------' `--------' `--------' `-----' `---------' |
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯

FIGURE 2: Great SmartCrash crash requester
@ENDNODE
@NODE About "About SmartCrash"

     @{b}ABOUT SmartCrash@{ub}

@{b}SmartCrash package software and documentation are Copyright © 1995-2000 PitPlane Productions. All Rights Reserved.@{ub}

SmartCrash package is freeware. See @{"license" LINK License}.

If you have any suggestions or remarks about this program, or if you find any bugs, please let me know.

Probably the best way to reach me is IRC:

	@{b}IRC:@{ub}		Piru (#AmigaFIN, #amycoders, #amiga)

Write to the following address (for @{"bug-reports" LINK BugReports}, comments etc.):

	@{b}e-Mail:@{ub}		piru@innocent.com
			(or sintonen@st.jyu.fi)

	@{b}WWW:@{ub}		http://www.jyu.fi/~sintonen/

			@{b}http://www.jyu.fi/~sintonen/sw.html@{ub}
			Latest beta release of SmartCrash
			should be found here.

	@{b}SnailMail:@{ub}	@{"Harry Sintonen" LINK xyz}
			Vaasankatu 8 A 12
			40100 Jyväskylä
			Finland - Europe
@ENDNODE
@NODE xyz "Hmm"

     @{b}GREAT!!@{ub}

Hmm... I think I'm above average programmer... I use mostly AmigaE and Assembler (DevPac) in my programmes. Sometimes I also use C and C++. I'm also quite good ARexx/CLI script writer. I love CygnusEd. I really hate GoldED!! What else? That's about it... :)

Oh, my Amiga's configuration?

Well, it's a good old A1200 put into 200W mini tower case, 3.1 GB and 2.6 GB IDE hard disks, 20x IDE CD-ROM (with selfmade idefix hardware), 4.3 GB and 2.1 GB SCSI hard disks. Blizzard PPC Power Board equipped with 240 MHz 603e and 50 MHz 68060, and 32 MB + 64 MB 60ns SIMMs (total 96 MB fast), 10Mbit PCMCIA ethernet ($80 PC-card + PCMCIA reset hack), Micronik scandoubler for AGA, BlizzardVision PPC 8 MB graphics card (Permedia 2), JUSTer® loudspeakers and finally HITACHI CM752ET 19" monitor. Quite ok system, no? :-)

And of course good old A500 (in 1001 pieces nowadays), few external drives and other stuff in my closet. ;)
@ENDNODE
@NODE Features "Features"

     @{b}FEATURES@{ub}

- This package is free! (see @{"license" LINK License})

- SmartCrash is 100% assembler

- Uses @{"SegTracker" LINK SegTrackerInfo} information if available

- Support for both intuition and reqtools.library requesters

- ReqTools requester font can be configured

- With ReqTools SmartCrash uses key shortcuts

- Falls back to alert message if no requester can be created

- @{"Skip" LINK skipbut} -button can skip failed instructions, works with 68000 to 68060, including CPU32 and 68851 MMU instructions

- Displays @{u}loads of@{uu} @{"information" LINK figure02} about the failure

- Tested with:

      Amiga 1200 96MB/12GB, 68060 @ 50MHz / 603e @ 240MHz
@ENDNODE
@NODE Requirements "Requirements"

     @{b}REQUIREMENTS@{ub}

SmartCrash requires Amiga computer with Kickstart 2.04 (V37) or better. SmartCrash should work with any Amiga hardware. SmartCrash should work with DraCo, too.

SmartCrash can show more information if @{"SegTracker" LINK SegTrackerInfo} is installed.

MultiView is highly recommended because this guide file uses \@WORDWRAP.
@ENDNODE
@NODE Installation "SmartCrash installation"

     @{b}INSTALLATION@{ub}

Simple. Just copy SmartCrash whereever you like.


Example installation:

  copy SmartCrash to c:

  add following line to s:user-startup:

  c:SmartCrash >nil: USEREQTOOLS XCourier.font 13
@ENDNODE
@NODE Notes "Important notes"

     @{b}NOTES@{ub}

@ENDNODE
@NODE Future "Future: Things to come -- or not!"

     @{b}TO DO@{ub}

- Fix bugs (there might be some lurking out there!).
- Add Alert() capture (maybe).
- Add parallel/serial output ala TNT (maybe).

@ENDNODE
@NODE Package "The Package"

     @{b}PACKAGE@{ub}

SmartCrash 1.3.0 distribution package contains following files:

  SmartCrash/src/bin.saver.ASM		Binary saver source code
  SmartCrash/src/CauseFailPro.ASM	Faulty program source code
  SmartCrash/src/RequestLong.ASM	Number requester source code
  SmartCrash/src/RequestLong.i		Number requester header file
  SmartCrash/src/SmartCrash.ASM		The main source code
  SmartCrash/CauseFailPro		Faulty program to test
  SmartCrash/SmartCrash			The main executable
  SmartCrash/SmartCrash.guide		This AmigaGuide document
  SmartCrash/SmartCrash.guide.info	Icon for the Guide
  SmartCrash.readme			Aminet std readme file

@{b}No additional files (including BBS adds) may be included!@{ub}
@ENDNODE
@NODE Usage "How do I use SmartCrash?"

     @{b}USAGE@{ub}

SmartCrash's template is

  @{b}RT=USEREQTOOLS/S,RTFONTNAME,RTFONTSIZE/N@{ub}

  @{b}RT=USEREQTOOLS/S@{ub}
		Specify this switch if you would like to use
		reqtools.library requesters instead of
		intuition ones. Also enables key shortcuts.

  @{b}RTFONTNAME@{ub}
		Name of the font to be used with reqtools
		requesters. Must include `.font' extension.
		It is a good idea to only use non-proportional
		fonts.

  @{b}RTFONTSIZE@{ub}
		Heigth of the font to be used with reqtools
		requesters.


Make sure you disable MCP NoGuru before activating SmartCrash!

On first run SmartCrash is installed. No need to `run' it.

To remove SmartCrash run it again. Please note that due some safety reasons small amount of memory is lost on every removal of SmartCrash.


When a program crashes you get a @{"crash requester" LINK Figure02}.

You have a nice collection of  buttons to choose from:

| .------. .--------. .------. .-------. .--------. .--------. .-----. .---------. |
| | Skip | | Remove | | Exit | | Debug | | Reboot | | JMP... | | RTS | | Suspend | |
| `------' `--------' `------' `-------' `--------' `--------' `-----' `---------' |
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯


  @{b}@{"Skip" LINK skipbut}@{ub}
		Skip the failed instruction. Note that it is not
		always possible to continue a crached program.

  @{b}Remove@{ub}
		Remove the crashed program, free as much resources
		as possible (filehandles, windows, screens).

  @{b}Exit@{ub}
		Exit the program with original stack pointer. Do not
		try to free resources.

  @{b}Debug@{ub}
		Call the system debugger. By default this debugger
		is "SAD" in >= V39 and "ROM-WACK" in < V39.

  @{b}Reboot@{ub}
		Give up, reboot the machine right now.

  @{b}JMP...@{ub}
		Continue the program execution at the given address.

  @{b}RTS@{ub}
		Return from subroutine with current stack.

  @{b}Suspend@{ub}
		Suspend the program. This does the same as
		@{"the original Suspend button" LINK figure01}.

@ENDNODE
@NODE Copyrights "Copyrights"

     @{b}COPYRIGHTS@{ub}

Amiga is Copyright © 1985-1999 Amiga International, Inc.

Blizzard Turbo Boards are Copyright © phase 5 digital products. All rights reserved.

Enforcer and @{"SegTracker" LINK SegTrackerInfo} are Copyright © 1992-1998 Michael Sinz.

SmartCrash package is Copyright © 1995-2000 PitPlane Productions.

Products names are trademarks and registered trademarks of their respective companies.
@ENDNODE
@NODE BugReports "About bug-reports"

     @{b}ABOUT BUG-REPORTS@{ub}

When sending in bug reports, please state exactly under what circumstances the bug occurred, what equipment was used and what happened. If possible also try to give me enough information to reproduce the bug. Dumps produced by common debugging tools are welcome. It is very difficult to find bugs when you don't know exactly what happened.

You are strongly encouriged to use included @{"bug-report -form" link BugForm} to report bugs.
@ENDNODE
@NODE BugForm "Form for sending bug reports"

     @{b}BUG-REPORT@{ub}

I HAVE FOUND BUG(S) FROM SmartCrash. I HAVE VERSION _____.

NAME:__________________________________________________


ADDRESS:_______________________________________________


         _______________________________________________


         _______________________________________________

ELECTRONIC ADDRESSES:
(if any, ie. Internet Email, FidoNet Netmail etc.)


         _______________________________________________

MACHINE CONFIGURATION:
(ie. 500, 600, 1000, 1200, 1400, 1500, 2000, 2500, 3000, 4000, accelerator...)


 _______________________________________________________


 _______________________________________________________

DETAILED DESCRIPTION OF BUG (ENVIRONMENT, ANY DEBUGGING INFORMATION RECEIVED FROM YOUR FAVORITE DEBUGGING TOOLS (ENFORCER etc.), WHAT YOU WERE DOING WHEN BUG OCCURED OR SIMILAR STUFF:


 _______________________________________________________


 _______________________________________________________


 _______________________________________________________


 _______________________________________________________


 _______________________________________________________


 _______________________________________________________


 _______________________________________________________


 _______________________________________________________




 __________________   __________________________________
        (Date)                   (Signature)
@ENDNODE
@NODE History "History"

     @{b}PROGRAM HISTORY@{ub}

     ==== Version 1.3.0 === Mar 9th, 2000 =====================

     - 2nd Aminet release.
     - PUBLIC SOURCE CODE RELEASE !
     - Improved this guide file a bit.

     ==== Version 1.3.0ß = Jan 27th, 2000 =====================

     - beta release, to be tested on different configurations
     - total rewrite, dozens of bugs & hacks removed, loads of
       improvements. Most important are:
       o support for PatchControl
       o added `JMP...' and `RTS' buttons.
       o fixes for 68000/68851/68040/68060/CPU32 support
       o no longer crashes with multiple requesters
       o works with PPC machines now

     ==== Version 1.x.x ===== 1995 - 1999 =====================

     - prehistoric versions, these worked... most of the time.
@ENDNODE
@NODE License "License"

     @{b}LICENSE@{ub}

 @{b}1.@{ub} This license applies to the product called "SmartCrash", a program for the Amiga computer, published by PitPlane Productions under the concepts of FreeWare, and the accompanying documentation. The terms "Program" and "SmartCrash" below, refer to this product. The licensee is addressed as "you".

 @{b}2.@{ub} You may copy and distribute verbatim copies of the program's executable code and documentation as you receive it, in any medium, provided that you conspicuously and appropriately publish only the original, unmodified program, with all copyright notices and disclaimers of warranty intact and including all the accompanying documentation, example files and anything else that came with the original.

 @{b}3.@{ub} You may not copy and/or distribute this program without the accompanying documentation and other additional files that came with the original. You may not copy and/or distribute modified versions of this program.

 @{b}4.@{ub} You may not copy, modify, sublicense, distribute or transfer the program except as expressly provided under this license. Any attempt otherwise to copy, modify, sublicense, distribute or transfer the program is void, and will automatically terminate your rights to use the program under this license. However, parties who have received copies, or rights to use copies, from you under this license will not have their licenses terminated so long as such parties remain in full compliance.

 @{b}5.@{ub} By copying, distributing and/or using the program you indicate your acceptance of this license to do so, and all its terms and conditions.

 @{b}6.@{ub} Each time you redistribute the program, the recipient automatically receives a license from the original licensor to copy, distribute and/or use the program subject to these terms and conditions. You may not impose any further restrictions on the recipients' exercise of the rights granted herein.

 @{b}7.@{ub} You may not disassemble, decompile, re-source or otherwise reverse engineer the program.

 @{b}8.@{ub} If you wish to incorporate parts of the program into other programs, write to the author to ask for permission.

 @{b}9.@{ub} You agree to cease distributing the program and data involved if requested to do so by the author.

@{b}10.@{ub} You may charge a fee to recover distribution costs. The fee for diskette distribution may not be more than the cost to obtain a public domain diskette from Fred Fish.
@ENDNODE
@NODE Disclaimer "Disclaimer"

     @{b}DISCLAIMER@{ub}

NO GUARANTEE IS GIVEN NOR IMPLIED THAT THIS PROGRAM IS FIT FOR ANY USE. THIS PROGRAM AND THE INFORMATION WITHIN THIS TEXT IS PROVIDED ON "AS IS" BASIS. THE ENTIRE RISK AS TO ITS QUALITY AND PERFORMANCE IS WITH THE USER. SHOULD THE PROGRAM PROVE DEFECTIVE, THE USER (AND NOT THE AUTHOR) ASSUMES THE ENTIRE COST OF ALL NECCESSARY DAMAGES. IN NO EVENT WILL THE AUTHOR BE LIABLE FOR DIRECT, INDIRECT, INCIDENTAL OR CONSEQUENTIAL DAMAGES RESULTING FROM ANY DEFECT IN THE PROGRAM. THE AUTHOR RESERVES THE RIGHT TO MAKE CHANGES TO THE SOFTWARE OR DOCUMENTATION WITHOUT NOTICE.
@ENDNODE
