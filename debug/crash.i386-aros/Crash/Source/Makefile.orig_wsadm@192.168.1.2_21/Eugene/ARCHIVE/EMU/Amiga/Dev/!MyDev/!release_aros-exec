# $VER: Makefile_for_Crash 1.1 (20.06.2021)
# $EXTVER: Makefile_for_Crash 1.01 (20.06.2021)
# Author: Marko K. Seppänen, Gothenburg (Sweden, EU)

CC = gcc
RELEASE_PATH = "/release"

compile : crash.c
	; -N switch, avoid alignment and build non-aligned (smaller) binaries
	$(CC) -N crash.c -o Crash -mcrt=newlib 
	strip Crash

lha : 
	copy Crash.readme /release/
	cd $(RELEASE_PATH)@@\
	LHA -aer a "Crash.lha" "Crash"

release : clean compile
	makedir /release/Crash
	copy Crash /release/Crash/
	copy Crash.readme /release/Crash/

	makedir /release/Crash/src
	copy crash.c /release/Crash/src/
	copy Makefile /release/Crash/src/


clean :
	If Exists "Crash"@@\
		delete "Crash"@@\
	endif@@\
	If Exists "/release/Crash.lha"@@\
		delete "/release/Crash.lha"@@\
	endif@@\
	If Exists "/release/Crash.readme"@@\
		delete "/release/Crash.readme"@@\
	endif@@\
	If Exists "/release/Crash"@@\
		delete "/release/Crash/#?" ALL@@\
		delete "/release/Crash"@@\
	endif

