.MakeStartupWindow
CNIF #full=On

  NEWTYPE.tags a.l:b:c:d:e:f:g:h:i:j:k:l:m:n:o:p:q:r:s:t:End NEWTYPE
  DEFTYPE.BitMapHeader *bmhd
  DEFTYPE.dtFrameBox dtf
  DEFTYPE.FrameInfo fri
  DEFTYPE.gpLayout gpl
  DEFTYPE.BitMap *bm

  attrs.tags\a=#DTA_SourceType,#DTST_FILE,#DTA_GroupID,#GID_PICTURE,0

  name$ = global\systemdir + "test.jpg"

  *obj.b=NewDTObjectA_(name$,attrs)
  If *obj
    *this.Task = FindTask_(0)
    GetAttr_ #PDTA_BitMapHeader,*obj,&*bmhd

    WbToScreen 0 : Use Screen 0

    *ssc.Screen = LockPubScreen_ ("Workbench")
    ScreenToFront_(*ssc)

    bmh.l = *bmhd\bmh_Height/2
    bmw.l = *bmhd\bmh_Width/2

    dtf\MethodID = #DTM_FRAMEBOX
    dtf\dtf_FrameInfo = &fri
    dtf\dtf_ContentsInfo = &fri
    dtf\dtf_SizeFrameInfo = SizeOf.FrameInfo

    DoMethodA *obj,&dtf

    gpl\MethodID = #DTM_PROCLAYOUT
    gpl\gpl_GInfo = 0
    gpl\gpl_Initial = 1

    DoMethodA *obj,&gpl
    GetAttr_ #PDTA_BitMap,*obj,&*bm

    scw.l = *ssc\Width/2
    sch.l = *ssc\Height/2

    Dim wintags.TagItem(10)
    wintags(0)\ti_Tag= #WA_Top,sch-bmh
    wintags(1)\ti_Tag= #WA_Left,scw-bmw
    wintags(2)\ti_Tag= #WA_Width,*bmhd\bmh_Width
    wintags(3)\ti_Tag= #WA_Height,*bmhd\bmh_Height + 16
    wintags(4)\ti_Tag= #WA_SmartRefresh,1
    wintags(5)\ti_Tag= #WA_Activate,0
;    wintags(6)\ti_Tag= #WA_Borderless,1
    wintags(6)\ti_Tag= #WA_GimmeZeroZero,1
    wintags(7)\ti_Tag= #WA_CustomScreen,*ssc
    wintags(8)\ti_Tag= #WA_SuperBitMap,*bm
    wintags(9)\ti_Tag= #TAG_END,0

    WindowTags #STARTUP,0,"",&wintags(0)
    VWait
    Use Window #STARTUP

    *win.Window = Peek.l(Addr Window(#STARTUP))
    startwiny.w = WindowHeight - *win\IFont\tf_YSize - *win\BorderBottom - *win\BorderTop
    WJam 0 : WColour 2,1
    Print "V"+version$
    WJam 1
  EndIf

CEND
Return


