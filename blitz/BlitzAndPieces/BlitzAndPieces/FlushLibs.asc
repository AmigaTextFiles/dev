; Flushes all unused libraries :

; Author : James L Boyd - jamesboyd@all-hail.freeserve.co.uk

; Adapted from Krzysztof Cmok's E source.

*exec.ExecBase=Peek.l(4)                    ; get execbase
*mylist.List=*exec\LibList                  ; get library list
*mynode.Node=*mylist\lh_Head                ; library references

Forbid_                                     ; stop everything!

  While *mynode\ln_Succ                     ; check all nodes
    a$=Peek$(*mynode\ln_Name)               ; get library name
    *libnode.Node=FindName_ (*mylist,&a$)   ; find in list
    If *libnode
      RemLibrary_ *libnode                  ; try and free it
    EndIf

    *mynode=*mynode\ln_Succ                 ; NEXT!

  Wend

Permit_                                     ; go, Amiga, go!

End
