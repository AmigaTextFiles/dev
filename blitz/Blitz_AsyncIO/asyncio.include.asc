
; asyncio.include.bb2 generated by FD2inc.


DEFTYPE .Library *_AsyncIOBase

Macro asyncio_OpenAsync ; {ret,fileName,mode,bufferSize}
   GetReg a0,`2 : GetReg d0,`3 : GetReg d1,`4
   GetReg a6,*_AsyncIOBase : JSR -30(a6) : PutReg d0,`1
End Macro

Macro asyncio_OpenAsyncFromFH ; {ret,handle,mode,bufferSize}
   GetReg a0,`2 : GetReg d0,`3 : GetReg d1,`4
   GetReg a6,*_AsyncIOBase : JSR -36(a6) : PutReg d0,`1
End Macro

Macro asyncio_CloseAsync ; {ret,file}
   GetReg a0,`2
   GetReg a6,*_AsyncIOBase : JSR -42(a6) : PutReg d0,`1
End Macro

Macro asyncio_SeekAsync ; {ret,file,position,mode}
   GetReg a0,`2 : GetReg d0,`3 : GetReg d1,`4
   GetReg a6,*_AsyncIOBase : JSR -48(a6) : PutReg d0,`1
End Macro

Macro asyncio_ReadAsync ; {ret,file,buffer,bytes}
   GetReg a0,`2 : GetReg a1,`3 : GetReg d0,`4
   GetReg a6,*_AsyncIOBase : JSR -54(a6) : PutReg d0,`1
End Macro

Macro asyncio_WriteAsync ; {ret,file,buffer,bytes}
   GetReg a0,`2 : GetReg a1,`3 : GetReg d0,`4
   GetReg a6,*_AsyncIOBase : JSR -60(a6) : PutReg d0,`1
End Macro

Macro asyncio_ReadCharAsync ; {ret,file}
   GetReg a0,`2
   GetReg a6,*_AsyncIOBase : JSR -66(a6) : PutReg d0,`1
End Macro

Macro asyncio_WriteCharAsync ; {ret,file,ch}
   GetReg a0,`2 : GetReg d0,`3
   GetReg a6,*_AsyncIOBase : JSR -72(a6) : PutReg d0,`1
End Macro

Macro asyncio_ReadLineAsync ; {ret,file,buf,bytes}
   GetReg a0,`2 : GetReg a1,`3 : GetReg d0,`4
   GetReg a6,*_AsyncIOBase : JSR -78(a6) : PutReg d0,`1
End Macro

Macro asyncio_WriteLineAsync ; {ret,file,buf}
   GetReg a0,`2 : GetReg a1,`3
   GetReg a6,*_AsyncIOBase : JSR -84(a6) : PutReg d0,`1
End Macro

Macro asyncio_FGetsAsync ; {ret,file,buf,bytes}
   GetReg a0,`2 : GetReg a1,`3 : GetReg d0,`4
   GetReg a6,*_AsyncIOBase : JSR -90(a6) : PutReg d0,`1
End Macro

Macro asyncio_FGetsLenAsync ; {ret,file,buf,bytes,length}
   GetReg a0,`2 : GetReg a1,`3 : GetReg d0,`4 : GetReg a2,`5
   GetReg a6,*_AsyncIOBase : JSR -96(a6) : PutReg d0,`1
End Macro

Macro asyncio_PeekAsync ; {ret,file,buffer,bytes}
   GetReg a0,`2 : GetReg a1,`3 : GetReg d0,`4
   GetReg a6,*_AsyncIOBase : JSR -102(a6) : PutReg d0,`1
End Macro


Function.l asyncio_InitLib {minVersion.l}
   SHARED *_AsyncIOBase
   If *_AsyncIOBase Then Function Return *_AsyncIOBase
   If minVersion<0 Then minVersion = 0
   *_AsyncIOBase = OpenLibrary_ ("asyncio.library",minVersion)
   Function Return *_AsyncIOBase
End Function


Statement asyncio_FreeLib {}
   SHARED *_AsyncIOBase
   If *_AsyncIOBase Then CloseLibrary_ *_AsyncIOBase : *_AsyncIOBase = 0
End Statement



;-------------------------------------------------------------------------



; C to Blitz conversion done by c2b.


; This structure is public only by necessity, don't muck with it yourself,
; or you're looking for trouble

NEWTYPE .AsyncFile
   *af_File.b                            ; BPTR
   af_BlockSize.l                        ; ULONG
   *af_Handler.MsgPort                   ; STRUCT
   *af_Offset.b                          ; UBYTE
   af_BytesLeft.l                        ; LONG
   af_BufferSize.l                       ; ULONG
   *af_Buffers.b[2]                      ; UBYTE
   af_Packet.StandardPacket              ; STRUCT
   af_PacketPort.MsgPort                 ; STRUCT
   af_CurrentBuf.l                       ; ULONG
   af_SeekOffset.l                       ; ULONG
   *af_SysBase.ExecBase                  ; STRUCT
   *af_DOSBase.DosLibrary                ; STRUCT
   af_PacketPending.b                    ; UBYTE
   af_ReadMode.b                         ; UBYTE
   af_CloseFH.b                          ; UBYTE
   af_SeekPastEOF.b                      ; UBYTE
   af_LastRes1.l                         ; ULONG
   af_LastBytesLeft.l                    ; ULONG
End NEWTYPE


; enum OpenModes

#MODE_READ                     = 0 ; read an existing file
#MODE_WRITE                    = 1 ; create a new file, delete existing file if needed
#MODE_APPEND                   = 2 ; append to end of existing file, or create new

; enum SeekModes

#MODE_START                    = -1 ; relative to start of file
#MODE_CURRENT                  = 0  ; relative to current file position
#MODE_END                      = 1  ; relative to end of file


