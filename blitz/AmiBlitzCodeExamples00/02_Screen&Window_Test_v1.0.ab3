; XTRA
; Embedded .xtra Header
; 
; General Info
; -------------------------------------------------------
; ExePath         = "ram:"
; ExeFile         = "Empty"
; CreateIcon      = 0
; Residents       = "all.res"
; 
; Compiler
; -------------------------------------------------------
; StringBuffer    = 100000
; MakeSmallest    = 1
; FuncOptimize    = 1
; Version         = 0.0.0
; NumberOfBuilds  = 88
; 
; Debugger
; -------------------------------------------------------
; CliArgs         = ""
; StackSize       = 8192
; RuntimeDebug    = 0
; DebugInfo       = 0
; CreateDbgFile   = 0
; OverflowCheck   = 0
; AssemblerCheck  = 0
; InterruptCheck  = 1
; AutoRun         = 1
; 
; Editor
; -------------------------------------------------------
; CursorLine      = 1
; CursorColumn    = 1
; LabelSearch     = ""
; LabelRemark     = 0
; LabelAll        = 0
; LabelCase       = 0
; LabelPosition   = 0
; 
; Blitz Objects
; -------------------------------------------------------
; Max File        = 100
; Max GadgetList  = 100
; Max Shape       = 200
; Max Bank        = 1
; Max MenuList    = 100
; Max GTList      = 100
; Max Palette     = 4
; Max BitMap      = 10
; Max Screen      = 5
; Max IntuiFont   = 10
; Max BlitzFont   = 1
; Max Window      = 100
; Max IconInfo    = 1
; Max MUIObject   = 50
; Max AsyncReq    = 4
; Max Req-Lib     = 5
; Max GTMenuList  = 100
; Max Console     = 5
; Max TCPSock     = 5
; Max Tape        = 5
; Max TagList     = 5
; Max Database    = 16
; Max Sound       = 10
; Max MedModule   = 8
; Max Buffer      = 10
; Max Queue       = 10
; Max Sprite      = 20
; Max Module      = 5
; Max Slice       = 10
; Max Page        = 4
; Max CopList     = 10
; Max PTModule    = 5
; Max Anim        = 10
; Max NChunky     = 50
; Max Chunky      = 20
; Max Stencil     = 5
; Max XBSound     = 10
; /XTRA
; ##############################
; ### Get WB Screen info     ###
; ### Version 0.001          ###
; ##############################

; ##############################
; ### Global Stuff           ###
; ##############################

; ### Optimize CPU integer (68020+) and FPU ###
OPTIMIZE 3

; ### So it can be started from Workbench... ###
WBStartup

; ### Workbench to AmiBlitz screen ###
WbToScreen 0

; ### Show Workbench ###
ShowScreen 0

XINCLUDE "cpu.include"
XINCLUDE "screen.include"

siwbs.w = screen_Open{"WB", - 1}
If siwbs = -1
  sd.l    = screen_GetDepth{}
EndIf
NPrint ""
NPrint "WB Screen Depth______________________ ", sd

; ### System information ###

cpu.b = GetCPU{}
Select cpu
  Case 0
    cpuid$ = "68000"
  Case 1
    cpuid$ = "68010"
  Case 2
    cpuid$ = "68020"
  Case 3
    cpuid$ = "68030"
  Case 4
    cpuid$ = "68040"
  Case 6
    cpuid$ = "68060"
  Default
    cpuid$ = "OTHER"
End Select

fpu.b = GetFPU{}
Select fpu
  Case 0
    fpuid$ = "NO FPU"
  Case 1
    fpuid$ = "68881"
  Case 2
    fpuid$ = "68882"
  Case 3
    fpuid$ = "68040 NO FPU"
  Case 4
    fpuid$ = "68040 FPU"
  Case 5
    fpuid$ = "68060 NO FPU"
  Case 6
    fpuid$ = "68060 FPU"
  Default
    fpuid$ = "Other"
End Select

NPrint ""
NPrint "System CPU__________________________  ", cpuid$
NPrint "System FPU__________________________  ", fpuid$

; ### Get WB Screen Pointer ###
*wbs.Screen = Peek.l(Addr Screen(0))

; ### WB Screen Prefs Vars ###
wbsw.l      ; WB Sceeen width
wbsh.l      ; WB Screen height
wbwbt.b     ; WB Screen Window Border Top
wbwbl.b     ; WB Screen Window Border Left
wbwbr.b     ; WB Screen Window Border Right
wbwbb.b     ; WB Screen Window Border Bottom
wbfn$       ; WB Screen Font Name
wbfs.w      ; WB Screen Font Size

; ### Gt WB Screen Prefs ###

wbsw  = *wbs\Width
wbsh  = *wbs\Height
wbwbt = *wbs\WBorTop
wbwbl = *wbs\WBorLeft
wbwbr = *wbs\WBorRight
wbwbb = *wbs\WBorBottom

*wbft.TextAttr = *wbs\Font
wbfn$ = Peek$( * wbft\ta_Name)
wbfs  = *wbft\ta_YSize

NPrint ""
NPrint "Workbench Screen Width_______________ ", wbsw
NPrint "Workbench Screen Height______________ ", wbsh
NPrint "Workbench Screen Window Border Top___ ", wbwbt
NPrint "Workbench Screen Window Border Left__ ", wbwbl
NPrint "Workbench Screen Window Border Right_ ", wbwbr
NPrint "Workbench Screen Window Border Bottom ", wbwbb
NPrint "Workbench Screen Font Name___________ ", wbfn$
NPrint "Workbench Screen Font Size___________ ", wbfs

; ### Window dimensions calculation ###

wdsw.l = 640
wdsh.l = 512

; ### Defining size of window to get proper inner dimensions ###

nwdw.l = wdsw + wbwbl + wbwbr
nwdh.l = wdsh + wbfs + 1 + wbwbt + wbwbb   ; # it is necessary to add 1 to font size

; ### Open New Window ###

wflags.l = #WFLG_DRAGBAR | #WFLG_DEPTHGADGET | #WFLG_ACTIVATE | #WFLG_GIMMEZEROZERO
wdwid.l  = Window(0,100,100,nwdw,nwdh,wflags,"Screen & Window Tests",1,2)

; WSize 320,256

wdrp.l   = RastPort (0)
wdw.l    = WindowWidth
wdh.l    = WindowHeight
wdiw.l   = InnerWidth
wdih.l   = InnerHeight
wdto.l   = WTopOff
wdlo.l   = WLeftOff

DefaultOutput

NPrint ""
NPrint "Window Width_________________________ ", wdw
NPrint "Window Height________________________ ", wdh
NPrint "Window Inner Width___________________ ", wdiw
NPrint "Window Inner Height__________________ ", wdih
NPrint "Window Top Offset____________________ ", wdto
NPrint "Window Left Offset___________________ ", wdlo
NPrint "Window RastPort Address______________ ", wdrp

WCls

For i = 0 To (wdih - 1)
  WPlot i,i,i
Next

VWait 50

; ### Better WCls ###
WBox 0,0,wdiw - 1, wdih - 1,0

VWait 50

For i = 0 To (wdiw - 1)
  Wline i,Int(i / 4),i,(wdih - Int(i / 4)),i
Next

VWait 50

; ### Better WCls ###
WBox 0,0,wdiw - 1, wdih - 1,0

VWait 50

VWait 50

wbpen.l = 1

For x.l = 0 To wdih / 2
  WBox x,x, wdiw - 1 - x , wdih - 1 - x , x
  VWait 1
Next

VWait 50

; ### Better WCls ###
WBox 0,0,wdiw - 1, wdih - 1,0

VWait 50

WBox 0,0,wdiw - 1,wdih - 1,1

VWait 50

WBox 1,1,wdiw - 2,wdih - 2,8

VWait 50

; ### Better WCls ###
WBox 0,0,wdiw - 1, wdih - 1,0

VWait 50

For z.w = 0 To 255
  c.l = z * 2^16 + z * 2^8 + z
  error.l = WriteRGBPixel_(wdrp,z,z,c)
  ;NPrint error
Next

VWait 100

CloseWindow 0

End

