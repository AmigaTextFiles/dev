
;
; PrefsReader2000 (C) Loki - s^D 1999!
; Written for BippyM (19/03/99)
; Use this code however you like,.. Just hope it helps people?
;
; AUTHOR: loki@napalmdeath.freeserve.co.uk
;
; Ohhh, isn`t this a nice procedure for reading prefs?
; Its that good I think I`m going to use in in my next project :)
;

WBenchToFront_:WbToScreen 0

If NumPars=0
  NPrint "Required argument missing!"
  End
EndIf

If NumPars>1
  NPrint "Too many arguments!"
  End
EndIf

If Par$(1)="?"
  NPrint " USAGE: PrefsRead <TestPrefsFile>"
  End
EndIf

PrefsFile$=Par$(1)
;PrefsFile$="Blitz2:PrefsReader2000/PR2000.prefs"     ; The prefs file. (enable to bypass parameters!)
INCLUDE "Blitz2:PrefsReader2000/PrefsProcedures.BB2" ; Our main procs!

;--- Ok here comes our main code:
;
;
If ReadPrefs{PrefsFile$}=False
  NPrint "Cant find prefs!!"
  End
EndIf

DefaultOutput

NPrint "Prefs Reader 2000, (C) Robert Hutchinson 1999!"
NPrint "A set of fast, complex preference routines, for Blitz Basic :) (eheh)"
NPrint "---------------------------------------------------------------------"
NPrint " Values Found in file:"
NPrint "       UnitFile: "+SearchPrefs{"UnitFile"}
NPrint "     MouseSpeed: "+SearchPrefs{"Mouse Speed"}
NPrint "          Power: "+SearchPrefs{"Power"}
NPrint "      Placement: "+SearchPrefs{"Placement"}
NPrint "      GameSpeed: "+SearchPrefs{"Game Speed"}
NPrint "      UnitSpeed: "+SearchPrefs{"Unit Speed"}
NPrint "       UnitName: "+SearchPrefs{"Unit Name"}
NPrint ""
NPrint " Other Values:"
NPrint "         ValueA: "+SearchPrefs{"ValueA"}
NPrint "         ValueB: "+SearchPrefs{"ValueB"}
NPrint "         ValueC: "+SearchPrefs{"ValueC"}
NPrint ""

;--- Alter the values!
;

DefaultInput
Print "   Enter new ValueA: ":

NVal$=Edit$(20)
ReplaceEntry{"ValueA",NVal$}

Print "   Enter new ValueB: ":

NVal$=Edit$(20)
ReplaceEntry{"ValueB",NVal$}

Print "   Enter new ValueC: ":

NVal$=Edit$(20)
ReplaceEntry{"ValueC",NVal$}

;--- Finish up!
;
NPrint " Saving prefs..."
If SavePrefs{PrefsFile$}=False
  NPrint "Could not save Prefs!!"
EndIf

NPrint " DONE!"

End



