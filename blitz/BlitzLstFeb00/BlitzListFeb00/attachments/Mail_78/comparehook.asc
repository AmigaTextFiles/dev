Statement hook4{*dahook.Hook, *ncm.NList_CompareMessage2,reg_a2.l}

    SHARED funcret.l

    DEFTYPE.toto *entry1,*entry2  ; Pointer of your two entries

    *entry1 = *ncm\entry1         ; init pointer to your entries
    *entry2 = *ncm\entry2
    col1.l = *ncm\sort_type AND #MUIV_NList_TitleMark_ColMask   ; number of column who are notify
    col2.l = *ncm\sort_type2 AND #MUIV_NList_TitleMark2_ColMask

    If *ncm\sort_type = #MUIV_NList_SortType_None
      funcret=True
    Else
     Select col1      ; select column to be sorted
      Case 0
        If *ncm\sort_type AND #MUIV_NList_TitleMark_TypeMask
          funcret = Stricmp_(&*entry2\name,&*entry1\name)
        Else
          funcret = Stricmp_(&*entry1\name,&*entry2\name)
        EndIf
      Case 1
        If *ncm\sort_type AND #MUIV_NList_TitleMark_TypeMask
          funcret = Stricmp_(&*entry2\name2,&*entry1\name2)
        Else
          funcret = Stricmp_(&*entry1\name2,&*entry2\name2)
        EndIf
      Case  2
        If *ncm\sort_type AND #MUIV_NList_TitleMark_TypeMask
          funcret = *entry2\num - *entry1\num
        Else
          funcret = *entry1\num - *entry2\num
        EndIf
      End Select

      If funcret <> 0 OR col1 = col2
      Else
        Select col2
        Case 0
          If *ncm\sort_type2 AND #MUIV_NList_TitleMark_TypeMask
            funcret = Stricmp_(&*entry2\name,&*entry1\name)
          Else
            funcret = Stricmp_(&*entry1\name,&*entry2\name)
          EndIf
        Case 1
          If *ncm\sort_type2 AND #MUIV_NList_TitleMark2_TypeMask
            funcret = Stricmp_(&*entry2\name2,&*entry1\name2)
          Else
            funcret = Stricmp_(&*entry1\name2,&*entry2\name2)
          EndIf
        Case 2
          If *ncm\sort_type2 AND #MUIV_NList_TitleMark2_TypeMask
            funcret = *entry2\num - *entry1\num
          Else
            funcret = *entry1\num - *entry2\num
          EndIf
        End Select
      EndIf
    EndIf
End Statement




