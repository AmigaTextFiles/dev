
; This is a test program for setting user's preferences.

; By James L Boyd - jamesboyd@all-hail.freeserve.co.uk

; (NOTE: Most users will be pretty unhappy if you change
; their stuff ;)

; WARNING!!! This will screw up your preferences until
; you reboot (or run your prefs programs)!

; I couldn't get the Printer and PrinterGfx prefs programs
; to reflect the printer changes (but maybe that's cos I don't
; have a printer connected?). Try altering some of the print
; parameters, running this, then outputting some text to PRT:

; Oh, and please let me know if it works!

; email: jamesboyd@all-hail.freeserve.co.uk

.GetPrefs

; create structures :

DEFTYPE.Preferences *ReturnedPrefs, PrefsBuffer, *NewPrefs

; get Intuition preferences :

*ReturnedPrefs=GetPrefs_(&PrefsBuffer,SizeOf.Preferences)

;-----------------------------------------------

.KeyTimings

; 1.5 second delay before repeating every 0.02 seconds :

*ReturnedPrefs\KeyRptDelay\tv_secs=1
*ReturnedPrefs\KeyRptDelay\tv_micro=0.5 *1000000

*ReturnedPrefs\KeyRptSpeed\tv_secs=0
*ReturnedPrefs\KeyRptSpeed\tv_micro=0.02 *1000000

;-----------------------------------------------

.DoubleClicks

; wait for up to 5 seconds before ignoring
; second click :

*ReturnedPrefs\DoubleClick\tv_secs=5

;-----------------------------------------------

.Printer

*ReturnedPrefs\PrintQuality=#DRAFT
*ReturnedPrefs\PrintSpacing=#EIGHT_LPI
*ReturnedPrefs\PrintLeftMargin=10
*ReturnedPrefs\PrintRightMargin=70
*ReturnedPrefs\PrintAspect=#ASPECT_VERT
*ReturnedPrefs\PrintShade=#SHADE_GREYSCALE
*ReturnedPrefs\PaperSize=#US_LETTER
*ReturnedPrefs\PaperType=#FANFOLD

;-----------------------------------------------

*NewPrefs=SetPrefs_(*ReturnedPrefs,SizeOf.Preferences,0)

; wasn't sure whether to set the inform parameter of SetPrefs
; to 0 or -1...something to do with notifying other programs'
; windows...?

End
