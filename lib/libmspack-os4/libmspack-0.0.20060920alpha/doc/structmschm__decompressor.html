<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>libmspack: mschm_decompressor Struct Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.6 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li id="current"><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
    <li><a href="functions.html"><span>Data&nbsp;Fields</span></a></li>
  </ul></div>
<h1>mschm_decompressor Struct Reference</h1><!-- doxytag: class="mschm_decompressor" -->A decompressor for .CHM (Microsoft HTMLHelp) files.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;<a class="el" href="mspack_8h-source.html">mspack.h</a>&gt;</code>
<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Data Fields</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structmschmd__header.html">mschmd_header</a> *(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmschm__decompressor.html#8dc69a0971a965418a8e6c1e55c927fe">open</a> )(struct <a class="el" href="structmschm__decompressor.html">mschm_decompressor</a> *self, char *filename)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Opens a CHM helpfile and reads its contents.  <a href="#8dc69a0971a965418a8e6c1e55c927fe"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmschm__decompressor.html#21c15034a3ae43acf6c817728fa566f1">close</a> )(struct <a class="el" href="structmschm__decompressor.html">mschm_decompressor</a> *self, struct <a class="el" href="structmschmd__header.html">mschmd_header</a> *chm)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Closes a previously opened CHM helpfile.  <a href="#21c15034a3ae43acf6c817728fa566f1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmschm__decompressor.html#21d8465cf7dc59762d81af0b7cffdd5a">extract</a> )(struct <a class="el" href="structmschm__decompressor.html">mschm_decompressor</a> *self, struct <a class="el" href="structmschmd__file.html">mschmd_file</a> *file, char *filename)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Extracts a file from a CHM helpfile.  <a href="#21d8465cf7dc59762d81af0b7cffdd5a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmschm__decompressor.html#dc4595f636c976e7c2713f09963e9147">last_error</a> )(struct <a class="el" href="structmschm__decompressor.html">mschm_decompressor</a> *self)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the error code set by the most recently called method.  <a href="#dc4595f636c976e7c2713f09963e9147"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structmschmd__header.html">mschmd_header</a> *(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmschm__decompressor.html#e86bfc928614ca2985246abdfbfacbde">fast_open</a> )(struct <a class="el" href="structmschm__decompressor.html">mschm_decompressor</a> *self, char *filename)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Opens a CHM helpfile quickly.  <a href="#e86bfc928614ca2985246abdfbfacbde"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmschm__decompressor.html#38784ac895b0c323b6337eefcc04831d">fast_find</a> )(struct <a class="el" href="structmschm__decompressor.html">mschm_decompressor</a> *self, struct <a class="el" href="structmschmd__header.html">mschmd_header</a> *chm, char *filename, struct <a class="el" href="structmschmd__file.html">mschmd_file</a> *f_ptr, int f_size)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Finds file details quickly.  <a href="#38784ac895b0c323b6337eefcc04831d"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
A decompressor for .CHM (Microsoft HTMLHelp) files. 
<p>
All fields are READ ONLY.<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="mspack_8h.html#5829a2023927ad4dc8bd452f3b294851">mspack_create_chm_decompressor()</a>, <a class="el" href="mspack_8h.html#50c0799f5c1a128672c024a05c79cac8">mspack_destroy_chm_decompressor()</a> </dd></dl>

<p>
<hr><h2>Field Documentation</h2>
<a class="anchor" name="21c15034a3ae43acf6c817728fa566f1"></a><!-- doxytag: member="mschm_decompressor::close" ref="21c15034a3ae43acf6c817728fa566f1" args=")(struct mschm_decompressor *self, struct mschmd_header *chm)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void(* <a class="el" href="structmschm__decompressor.html#21c15034a3ae43acf6c817728fa566f1">mschm_decompressor::close</a>)(struct <a class="el" href="structmschm__decompressor.html">mschm_decompressor</a> *self, struct <a class="el" href="structmschmd__header.html">mschmd_header</a> *chm)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Closes a previously opened CHM helpfile. 
<p>
This closes a CHM helpfile, frees the <a class="el" href="structmschmd__header.html">mschmd_header</a> and all <a class="el" href="structmschmd__file.html">mschmd_file</a> structures associated with it (if any). This works on both helpfiles opened with <a class="el" href="structmschm__decompressor.html#8dc69a0971a965418a8e6c1e55c927fe">open()</a> and helpfiles opened with <a class="el" href="structmschm__decompressor.html#e86bfc928614ca2985246abdfbfacbde">fast_open()</a>.<p>
The CHM header pointer is now invalid and cannot be used again. All <a class="el" href="structmschmd__file.html">mschmd_file</a> pointers referencing that CHM are also now invalid, and cannot be used again.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>self</em>&nbsp;</td><td>a self-referential pointer to the <a class="el" href="structmschm__decompressor.html">mschm_decompressor</a> instance being called </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>chm</em>&nbsp;</td><td>the CHM helpfile to close </td></tr>
  </table>
</dl>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="structmschm__decompressor.html#8dc69a0971a965418a8e6c1e55c927fe">open()</a>, <a class="el" href="structmschm__decompressor.html#e86bfc928614ca2985246abdfbfacbde">fast_open()</a> </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="21d8465cf7dc59762d81af0b7cffdd5a"></a><!-- doxytag: member="mschm_decompressor::extract" ref="21d8465cf7dc59762d81af0b7cffdd5a" args=")(struct mschm_decompressor *self, struct mschmd_file *file, char *filename)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int(* <a class="el" href="structmschm__decompressor.html#21d8465cf7dc59762d81af0b7cffdd5a">mschm_decompressor::extract</a>)(struct <a class="el" href="structmschm__decompressor.html">mschm_decompressor</a> *self, struct <a class="el" href="structmschmd__file.html">mschmd_file</a> *file, char *filename)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Extracts a file from a CHM helpfile. 
<p>
This extracts a file from a CHM helpfile and writes it to the given filename. The filename of the file, <a class="el" href="structmscabd__file.html#181b45655523f55ed114b51249d305f8">mscabd_file::filename</a>, is not used by <a class="el" href="structmschm__decompressor.html#21d8465cf7dc59762d81af0b7cffdd5a">extract()</a>, but can be used by the caller as a guide for constructing an appropriate filename.<p>
This method works both with files found in the <a class="el" href="structmschmd__header.html#ecdd3b5e84606785e9620a70e8f0d0ed">mschmd_header::files</a> and <a class="el" href="structmschmd__header.html#c38b56f77e2a44d998e57ba9301e39d5">mschmd_header::sysfiles</a> list and <a class="el" href="structmschmd__file.html">mschmd_file</a> structures generated on the fly by <a class="el" href="structmschm__decompressor.html#38784ac895b0c323b6337eefcc04831d">fast_find()</a>.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>self</em>&nbsp;</td><td>a self-referential pointer to the <a class="el" href="structmschm__decompressor.html">mschm_decompressor</a> instance being called </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>file</em>&nbsp;</td><td>the file to be decompressed </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>filename</em>&nbsp;</td><td>the filename of the file being written to </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>an error code, or MSPACK_ERR_OK if successful </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="38784ac895b0c323b6337eefcc04831d"></a><!-- doxytag: member="mschm_decompressor::fast_find" ref="38784ac895b0c323b6337eefcc04831d" args=")(struct mschm_decompressor *self, struct mschmd_header *chm, char *filename, struct mschmd_file *f_ptr, int f_size)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int(* <a class="el" href="structmschm__decompressor.html#38784ac895b0c323b6337eefcc04831d">mschm_decompressor::fast_find</a>)(struct <a class="el" href="structmschm__decompressor.html">mschm_decompressor</a> *self, struct <a class="el" href="structmschmd__header.html">mschmd_header</a> *chm, char *filename, struct <a class="el" href="structmschmd__file.html">mschmd_file</a> *f_ptr, int f_size)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Finds file details quickly. 
<p>
Instead of reading all CHM helpfile headers and building a list of files, <a class="el" href="structmschm__decompressor.html#e86bfc928614ca2985246abdfbfacbde">fast_open()</a> and <a class="el" href="structmschm__decompressor.html#38784ac895b0c323b6337eefcc04831d">fast_find()</a> are intended for finding file details only when they are needed. The CHM file format includes an on-disk file index to allow this.<p>
Given a case-sensitive filename, <a class="el" href="structmschm__decompressor.html#38784ac895b0c323b6337eefcc04831d">fast_find()</a> will search the on-disk index for that file.<p>
If the file was found, the caller-provided <a class="el" href="structmschmd__file.html">mschmd_file</a> structure will be filled out like so:<ul>
<li>section: the correct value for the found file</li><li>offset: the correct value for the found file</li><li>length: the correct value for the found file</li><li>all other structure elements: NULL or 0</li></ul>
<p>
If the file was not found, MSPACK_ERR_OK will still be returned as the result, but the caller-provided structure will be filled out like so:<ul>
<li>section: NULL</li><li>offset: 0</li><li>length: 0</li><li>all other structure elements: NULL or 0</li></ul>
<p>
This method is intended to be used in conjunction with CHM helpfiles opened with <a class="el" href="structmschm__decompressor.html#e86bfc928614ca2985246abdfbfacbde">fast_open()</a>, but it also works with helpfiles opened using the regular <a class="el" href="structmschm__decompressor.html#8dc69a0971a965418a8e6c1e55c927fe">open()</a>.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>self</em>&nbsp;</td><td>a self-referential pointer to the <a class="el" href="structmschm__decompressor.html">mschm_decompressor</a> instance being called </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>chm</em>&nbsp;</td><td>the CHM helpfile to search for the file </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>filename</em>&nbsp;</td><td>the filename of the file to search for </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>f_ptr</em>&nbsp;</td><td>a pointer to a caller-provded <a class="el" href="structmschmd__file.html">mschmd_file</a> structure </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>f_size</em>&nbsp;</td><td><code>sizeof(struct mschmd_file)</code> </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>an error code, or MSPACK_ERR_OK if successful </dd></dl>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="structmschm__decompressor.html#8dc69a0971a965418a8e6c1e55c927fe">open()</a>, <a class="el" href="structmschm__decompressor.html#21c15034a3ae43acf6c817728fa566f1">close()</a>, <a class="el" href="structmschm__decompressor.html#38784ac895b0c323b6337eefcc04831d">fast_find()</a>, <a class="el" href="structmschm__decompressor.html#21d8465cf7dc59762d81af0b7cffdd5a">extract()</a> </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="e86bfc928614ca2985246abdfbfacbde"></a><!-- doxytag: member="mschm_decompressor::fast_open" ref="e86bfc928614ca2985246abdfbfacbde" args=")(struct mschm_decompressor *self, char *filename)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structmschmd__header.html">mschmd_header</a>*(* <a class="el" href="structmschm__decompressor.html#e86bfc928614ca2985246abdfbfacbde">mschm_decompressor::fast_open</a>)(struct <a class="el" href="structmschm__decompressor.html">mschm_decompressor</a> *self, char *filename)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Opens a CHM helpfile quickly. 
<p>
If the file opened is a valid CHM helpfile, only essential headers will be read. A <a class="el" href="structmschmd__header.html">mschmd_header</a> structure will be still be returned, as with <a class="el" href="structmschm__decompressor.html#8dc69a0971a965418a8e6c1e55c927fe">open()</a>, but the <a class="el" href="structmschmd__header.html#ecdd3b5e84606785e9620a70e8f0d0ed">mschmd_header::files</a> field will be NULL. No files details will be automatically read. The <a class="el" href="structmschm__decompressor.html#38784ac895b0c323b6337eefcc04831d">fast_find()</a> method must be used to obtain file details.<p>
In the case of an error occuring, NULL is returned and the error code is available from <a class="el" href="structmschm__decompressor.html#dc4595f636c976e7c2713f09963e9147">last_error()</a>.<p>
The filename pointer should be considered "in use" until <a class="el" href="structmschm__decompressor.html#21c15034a3ae43acf6c817728fa566f1">close()</a> is called on the CHM helpfile.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>self</em>&nbsp;</td><td>a self-referential pointer to the <a class="el" href="structmschm__decompressor.html">mschm_decompressor</a> instance being called </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>filename</em>&nbsp;</td><td>the filename of the CHM helpfile. This is passed directly to <a class="el" href="structmspack__system.html#7885678bf152f13adad6f6fec85f1653">mspack_system::open()</a>. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>a pointer to a <a class="el" href="structmschmd__header.html">mschmd_header</a> structure, or NULL on failure </dd></dl>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="structmschm__decompressor.html#8dc69a0971a965418a8e6c1e55c927fe">open()</a>, <a class="el" href="structmschm__decompressor.html#21c15034a3ae43acf6c817728fa566f1">close()</a>, <a class="el" href="structmschm__decompressor.html#38784ac895b0c323b6337eefcc04831d">fast_find()</a>, <a class="el" href="structmschm__decompressor.html#21d8465cf7dc59762d81af0b7cffdd5a">extract()</a> </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="dc4595f636c976e7c2713f09963e9147"></a><!-- doxytag: member="mschm_decompressor::last_error" ref="dc4595f636c976e7c2713f09963e9147" args=")(struct mschm_decompressor *self)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int(* <a class="el" href="structmschm__decompressor.html#dc4595f636c976e7c2713f09963e9147">mschm_decompressor::last_error</a>)(struct <a class="el" href="structmschm__decompressor.html">mschm_decompressor</a> *self)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Returns the error code set by the most recently called method. 
<p>
This is useful for <a class="el" href="structmschm__decompressor.html#8dc69a0971a965418a8e6c1e55c927fe">open()</a> and <a class="el" href="structmschm__decompressor.html#e86bfc928614ca2985246abdfbfacbde">fast_open()</a>, which do not return an error code directly.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>self</em>&nbsp;</td><td>a self-referential pointer to the <a class="el" href="structmschm__decompressor.html">mschm_decompressor</a> instance being called </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>the most recent error code </dd></dl>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="structmschm__decompressor.html#8dc69a0971a965418a8e6c1e55c927fe">open()</a>, search() </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="8dc69a0971a965418a8e6c1e55c927fe"></a><!-- doxytag: member="mschm_decompressor::open" ref="8dc69a0971a965418a8e6c1e55c927fe" args=")(struct mschm_decompressor *self, char *filename)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct <a class="el" href="structmschmd__header.html">mschmd_header</a>*(* <a class="el" href="structmschm__decompressor.html#8dc69a0971a965418a8e6c1e55c927fe">mschm_decompressor::open</a>)(struct <a class="el" href="structmschm__decompressor.html">mschm_decompressor</a> *self, char *filename)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Opens a CHM helpfile and reads its contents. 
<p>
If the file opened is a valid CHM helpfile, all headers will be read and a <a class="el" href="structmschmd__header.html">mschmd_header</a> structure will be returned, with a full list of files.<p>
In the case of an error occuring, NULL is returned and the error code is available from <a class="el" href="structmschm__decompressor.html#dc4595f636c976e7c2713f09963e9147">last_error()</a>.<p>
The filename pointer should be considered "in use" until <a class="el" href="structmschm__decompressor.html#21c15034a3ae43acf6c817728fa566f1">close()</a> is called on the CHM helpfile.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>self</em>&nbsp;</td><td>a self-referential pointer to the <a class="el" href="structmschm__decompressor.html">mschm_decompressor</a> instance being called </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>filename</em>&nbsp;</td><td>the filename of the CHM helpfile. This is passed directly to <a class="el" href="structmspack__system.html#7885678bf152f13adad6f6fec85f1653">mspack_system::open()</a>. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>a pointer to a <a class="el" href="structmschmd__header.html">mschmd_header</a> structure, or NULL on failure </dd></dl>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="structmschm__decompressor.html#21c15034a3ae43acf6c817728fa566f1">close()</a> </dd></dl>
    </td>
  </tr>
</table>
<hr>The documentation for this struct was generated from the following file:<ul>
<li>/home/kyz/devel/libmspack/libmspack/mspack/<a class="el" href="mspack_8h-source.html">mspack.h</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Wed Sep 20 22:45:37 2006 for libmspack by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.6 </small></address>
</body>
</html>
