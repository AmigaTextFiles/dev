/*
 * pseudo random number generator by megacz@usa.com
*/

pre_:
library='rexxsupport.library'
IF SHOW('L',library)=0 THEN _addlib=ADDLIB(libb,0,-30,0)
SIGNAL ON Break_C
SIGNAL ON Halt
PARSE ARG dosline
dosline=STRIP(dosline,'B')

var_:
rndseed_source   = 1		/* 0 = time / 1 = available memory		*/
rndseed_dumpsize = 16384	/* number of bytes to generate, 61439 max!	*/
rndseed_range    = 6		/* seed number range when 'rndseed_source' is 1	*/
rndprng_pri      = -1		/* script priority -127<>127			*/

init_:
_pri=PRAGMA('P',rndprng_pri)
IF OPEN(__dumpfile,dosline,'W')<=0 THEN DO
SAY " *** error, unable to open '"dosline"' for writing!"
EXIT
END

main_:
_randomstorage=""
_timer=TIME('R')
SAY " /// generating pseudo random numbers ..."
DO WHILE LENGTH(_randomstorage)<rndseed_dumpsize 
IF rndseed_source=0 THEN _randomseed=TIME('S')
ELSE _randomseed=COMPRESS(RIGHT(STORAGE(),rndseed_range))
_randomstorage=_randomstorage||RANDOM(15,64,_randomseed+9)
_randomstorage=_randomstorage||RANDOM(65,128,_randomseed+7)
_randomstorage=_randomstorage||RANDOM(129,192,_randomseed+5)
_randomstorage=_randomstorage||RANDOM(193,256,_randomseed+3)
_randomstorage=_randomstorage||RANDOM(257,640,_randomseed+1)
END
_randomstorage=SUBSTR(_randomstorage,1,rndseed_dumpsize)
_write=WRITECH(__dumpfile,_randomstorage)
say " /// generated "rndseed_dumpsize" bytes in "TIME('E')" second(s)."
EXIT

Break_C:
Halt:
say " *** process terminated!"
EXIT
