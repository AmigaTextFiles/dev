@database ICONV
@master "ICONV.3"
@remark "manual page source format generated by PolyglotMan v3.2 available at http://polyglotman.sourceforge.net/"
@wordwrap
@tab 8

@node sect0 "Name"
iconv - perform character set conversion 
@endnode

@node sect1 "Synopsis"

@{code}#include <iconv.h>
size_t iconv (iconv_t cd,              const char* * inbuf, size_t * inbytesleft,
             char* * outbuf, size_t * outbytesleft);@{body}

@endnode

@node sect2 "@{ub}Description"
The argument @{i}cd@{ui} must be a conversion descriptor created using the function @{b}iconv_open@{ub}. The main case is when @{i}inbuf@{ui} is not NULL and @{i}*inbuf@{ui} is not NULL. In this case, the @{b}iconv@{ub} function converts the multibyte sequence starting at @{i}*inbuf@{ui} to a multibyte sequence starting at @{i}*outbuf@{ui}. At most @{i}*inbytesleft@{ui} bytes, starting at @{i}*inbuf@{ui}, will be read. At most @{i}*outbytesleft@{ui} bytes, starting at @{i}*outbuf@{ui}, will be written. 

The @{b}iconv@{ub} function converts one multibyte character at a time, and for each character conversion it increments @{i}*inbuf@{ui} and decrements @{i}*inbytesleft@{ui} by the number of converted input bytes, it increments @{i}*outbuf@{ui} and decrements @{i}*outbytesleft@{ui} by the number of converted output bytes, and it updates the conversion state contained in @{i}cd@{ui}. If the character encoding of the input is stateful, the @{b}iconv@{ub} function can also convert a sequence of input bytes to an update of the conversion state without producing any output bytes; such input is called a @{i}shift sequence@{ui}. The conversion can stop for four reasons: 

1. An invalid multibyte sequence is encountered in the input. In this case it sets @{b}errno@{ub} to @{b}EILSEQ@{ub} and returns (size_t)(-1). @{i}*inbuf@{ui} is left pointing to the beginning of the invalid multibyte sequence. 

2. The input byte sequence has been entirely converted, i.e. @{i}*inbytesleft@{ui} has gone down to 0. In this case @{b}iconv@{ub} returns the number of non-reversible conversions performed during this call. 

3. An incomplete multibyte sequence is encountered in the input, and the input byte sequence terminates after it. In this case it sets @{b}errno@{ub} to @{b}EINVAL@{ub} and returns (size_t)(-1). @{i}*inbuf@{ui} is left pointing to the beginning of the incomplete multibyte sequence. 

4. The output buffer has no more room for the next converted character. In this case it sets @{b}errno@{ub} to @{b}E2BIG@{ub} and returns (size_t)(-1). 

A different case is when @{i}inbuf@{ui} is NULL or @{i}*inbuf@{ui} is NULL, but @{i}outbuf@{ui} is not NULL and @{i}*outbuf@{ui} is not NULL. In this case, the @{b}iconv@{ub} function attempts to set @{i}cd@{ui}'s conversion state to the initial state and store a corresponding shift sequence at @{i}*outbuf@{ui}. At most @{i}*outbytesleft@{ui} bytes, starting at @{i}*outbuf@{ui}, will be written. If the output buffer has no more room for this reset sequence, it sets @{b}errno@{ub} to @{b}E2BIG@{ub} and returns (size_t)(-1). Otherwise it increments @{i}*outbuf@{ui} and decrements @{i}*outbytesleft@{ui} by the number of bytes written. 

A third case is when @{i}inbuf@{ui} is NULL or @{i}*inbuf@{ui} is NULL, and @{i}outbuf@{ui} is NULL or @{i}*outbuf@{ui} is NULL. In this case, the @{b}iconv@{ub} function sets @{i}cd@{ui}'s conversion state to the initial state. 


@endnode

@node sect3 "Return Value"
The @{b}iconv@{ub} function returns the number of characters converted in a non-reversible way during this call; reversible conversions are not counted. In case of error, it sets @{b}errno@{ub} and returns (size_t)(-1). 
@endnode

@node sect4 "Errors"
The following errors can occur, among others: 

· @{b}E2BIG@{ub} @{lindent 3}
There is not sufficient room at @{i}*outbuf@{ui}. @{lindent 0}

· @{b}EILSEQ@{ub} @{lindent 3}
An invalid multibyte sequence has been encountered in the input. @{lindent 0}

· @{b}EINVAL@{ub} @{lindent 3}
An incomplete multibyte sequence has been encountered in the input. @{lindent 0}


@endnode

@node sect5 "Conforming to"
POSIX:2001 
@endnode

@node sect6 "See Also"
@{"@{b}iconv_open@{ub}(3)" link %s.%siconv_open3/main}, @{"@{b}iconvctl@{ub}(3)" link %s.%siconvctl3/main} @{"@{b}iconv_close@{ub}(3)" link %s.%siconv_close3/main} 
@endnode
@node main "ICONV(3)"
@next sect0
@{b}Table of Contents@{ub}

@{"Name" link sect0}
@{"Synopsis" link sect1}
@{"Description" link sect2}
@{"Return Value" link sect3}
@{"Errors" link sect4}
@{"Conforming to" link sect5}
@{"See Also" link sect6}

@endnode
