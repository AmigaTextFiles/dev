@DATABASE IniFuncs.guide
@REM Source: IniFuncs.c

@REMARK "$VER: IniFuncs.guide 1.0 (17-Sep-2003) by James T. Steichen

@REMARK Written by Jim Steichen, Copyright (c) 2003.

@WIDTH 80
@WORDWRAP

@TOC "contents"

@NODE "contents" "IniFuncs.guide"
@{JCENTER}
@{FG SHINE}@{B}TABLE OF CONTENTS@{UB}@{FG TEXT}
@{JLEFT}

   @{" Purpose                 " LINK "Main"} -- Read this first!    
   @{" Global Variables        " LINK "Globals"}
    
   @{"iniAddGroup()            " LINK "iniAddGroup()"}
   @{"iniAddItem()             " LINK "iniAddItem()"}
   @{"iniCreateNewFile()       " LINK "iniCreateNewFile()"}
   @{"iniCurrentGroup()        " LINK "iniCurrentGroup()"}
   @{"iniExit()                " LINK "iniExit()"}
   @{"iniFindGroup()           " LINK "iniFindGroup()"}
   @{"iniFindItem()            " LINK "iniFindItem()"}
   @{"iniFindItemInGroup()     " LINK "iniFindItemInGroup()"}
   @{"iniGetGroupEnd()         " LINK "iniGetGroupEnd()"}
   @{"iniGetGroupStart()       " LINK "iniGetGroupStart()"}
   @{"iniGetItemName()         " LINK "iniGetItemName()"}
   @{"iniGetItemValue()        " LINK "iniGetItemValue()"}
   @{"iniGroupLength()         " LINK "iniGroupLength()"}
   @{"iniIsGroup()             " LINK "iniIsGroup()"}
   @{"iniIsItem()              " LINK "iniIsItem()"}
   @{"iniItemTypeIsString()    " LINK "iniItemTypeIsString()"}
   @{"iniNamedGroupLen()       " LINK "iniNamedGroupLen()"}
   @{"iniNextGroup()           " LINK "iniNextGroup()"}
   @{"iniOpenFile()            " LINK "iniOpenFile()"}
   @{"iniPrevGroup()           " LINK "iniPrevGroup()"}
   @{"iniRemoveGroup()         " LINK "iniRemoveGroup()"}
   @{"iniRemoveItem()          " LINK "iniRemoveItem()"}
   @{"iniSetGroupName()        " LINK "iniSetGroupName()"}
   @{"iniSetItemName()         " LINK "iniSetItemName()"}
   @{"iniSetItemValue()        " LINK "iniSetItemValue()"}
   @{"iniTranslateErrorNumber()" LINK "iniTranslateErrorNumber()"}
   @{"iniView_EditContents()   " LINK "iniView_EditContents()"}
   @{"iniWrite()               " LINK "iniWrite()"}
   @{"iniWriteToFile()         " LINK "iniWriteToFile()"}

@ENDNODE

@NODE "Main" "IniFuncs.c"
@TOC "contents"
@{FG SHINE}IniFuncs.c@{FG TEXT}

@{B}NAME@{UB}
@{FG SHINE}    @{B}IniFuncs.c@{UB}
@{FG TEXT}
@{B}DESCRIPTION@{UB}
    Various functions for Creating & Editing .ini files for the
    Amiga.  The file structure has very few rules, but you MUST
    adhere to them or your usage of this code will have problems:
    
    1. The maximum line length for each line in a .ini file 
       must be less than or Equal to INI_MAX_LINE_SIZE (which is 80 bytes).
    
    2. groupNames must always be surrounded with @{B}[@{UB} & @{B}]@{UB}
       characters.

    3. Floating point values are not currently supported.

    4. Leading spaces for itemValue strings will NOT be recognized because
       the space character is one of the default delimiters in the 
       code (Read IniFuncs.h).
                  
    The file structure is as follows:
       @{FG SHINE}  
       [GroupName1]
       stringValue=Write any string you like here!
       hexValue=0x12345678 
       decimalValue=1234567890
       [GroupName2]
       ... @{FG TEXT}
        
    and so on.

    Make/run the IniFuncsDBG program (type SMake TestProgram<RETURN>) to see
    how the functions work on the test file(s) supplied.

    @{" The functions... " LINK "contents"}

@{B}HISTORY@{UB}
    16-Sep-2003 - Created this file.

@{B}COPYRIGHT@{UB}
    (c) 2003 by J.T. Steichen
        ALL rights reserved.
   
@{B}NOTES@{UB}
@{FG SHINE}    The idea for this group of functions was inspired by
    @{" amigaini.library " LINK "amigaini"}.  Since @{" I " LINK "Author"}  don't have access to the original
    source code, everything in this file is of @{" my " LINK "Author"} own efforts.
    Furthermore, my implementation does not duplicate the functionality
    of amigaini.library completely, so don't expect anything written
    for amigaini.library to work with @{B}IniFuncs@{UB}!
    @{FG TEXT}

@ENDNODE

@NODE "Globals" "IniFuncs.o Global Variables:"

   These global variables are available for your use & should be 
   considered read-only.  The various functions are designed to 
   keep these variables updated.

   struct LocaleBase *LocaleBase is necessary because the functions
   are localized.

   The following libraries are only used by iniView_EditContents():   

      struct IntuitionBase *IntuitionBase;
      struct GfxBase       *GfxBase;
      struct Library       *GadToolsBase;
@{FG SHINE}
   If you use iniView_EditContents, be sure to test for changes
   to updateAIPointer & use aiCopy to reset whatever aiPTR you're
   currently using after iniVIew_EditContents() returns:
@{B}
      aiPTR aiCopy          = NULL;
      BOOL  updateAIPointer = FALSE; // unless set by iniView_EditContents()
@{UB}
   Look at the test section of IniFuncs.c at the end of the file for an idea
   on what to do with these variables. @{FG TEXT}
   
   This is what IniFuncs.o will use as Item/Value delimiters unless you
   specify otherwise:

      char const *DEFAULT_DELIMITERS = "= &|\0";

   These variables are used to keep track of where you are inside the
   data set:
      char  *currentGroupName;
      char  *currentItemName;
      char  *currentItemValue;
      ULONG  currentErrorNumber;          (See @{" Error Strings " LINK "ErrStrings"})
      ULONG  currentLineNumber;           (Range: 0 to numberOfElements)
      ULONG  currentGroupStartLineNumber; (Range: 0 to numberOfElements)
      ULONG  currentGroupEndLineNumber;   (Range: 1 to numberOfElements)
      ULONG  numberOfElements;            (Range: 1 to n) 

@ENDNODE

@NODE "ErrStrings" "IniFuncs.o Error Strings:"

   The following error strings are used to communicate with the User
   when their application has problems.  It will probably be expanded
   in the future:
   
   INI_NOERROR     = @{FG SHINE}.ini: NO ERROR!@{FG TEXT}
   INI_NOFILE      = @{FG SHINE}.ini: File NOT found!@{FG TEXT}    @{B}(Bogus filename)@{UB}
   INI_NOCONTENT   = @{FG SHINE}.ini: File is EMPTY!@{FG TEXT}     @{B}(FileLines was < 1)@{UB}
   INI_NOFILEOPEN  = @{FG SHINE}.ini: File did NOT open!@{FG TEXT} @{B}(AmigaDOS Error)@{UB}
   INI_NOHEADER    = @{FG SHINE}.ini: No group found!@{FG TEXT}    @{B}(Missing [] perhaps?)@{UB}
   INI_NOITEM      = @{FG SHINE}.ini: Item NOT found!@{FG TEXT}
   INI_NOMEMORY    = @{FG SHINE}.ini: Ran out of Memory!@{FG TEXT} @{B}(Get more memory!)@{UB}
   INI_USERERROR   = @{FG SHINE}.ini: User/Programmer forgot/omitted something!@{FG TEXT}
   INI_UNKERROR    = @{FG SHINE}.ini: Unknown ERROR!@{FG TEXT}

   @{B}NOTE:@{UB}  Don't know what this means, so not implemented:
    
   INI_TEXTERROR   = @{FG SHINE}.ini: Wrong number of items in message!@{FG TEXT}
   
   @{B}NOTE:@{UB}  Since Duplicate group names is allowed, you should
      never see this error message:

   INI_DUPHEADER   = @{FG SHINE}.ini: More than one group with the same name!@{FG TEXT}

   @{B}NOTE:@{UB}  No Auto-additions are implemented at this time:

   INI_NOITEMADDED = @{FG SHINE}.ini: Item was NOT found and Auto-added!@{FG TEXT}

@ENDNODE

@NODE "iniView_EditContents()" "iniView_EditContents()"

@{FG SHINE}iniView_EditContents()@{FG TEXT}

@{B}NAME@{UB}
@{FG SHINE}    int rval = iniView_EditContents( aiPTR ai );

@{FG TEXT}
@{B}DESCRIPTION@{UB}
    Show the User a GUI with limited editing capabilities over the
    current aiPTR data set.

@{B}INPUTS@{UB}
    ai        - the current aiPTR.

@{B}NOTES@{UB}
   @{FG SHINE}
    If you use iniView_EditContents, be sure to test for changes
    to updateAIPointer & use aiCopy to reset whatever aiPTR you're
    currently using after iniVIew_EditContents() returns:
@{B}
       aiPTR aiCopy          = NULL;
       BOOL  updateAIPointer = FALSE; // unless set by iniView_EditContents()
@{UB}
    Look at the test section of IniFuncs.c at the end of the file for an idea
    on what to do with these variables. @{FG TEXT}

@{B}RETURN VALUE@{UB}
    Zero if successful.

@ENDNODE

@NODE "amigaini" "Amigaini.library information:"

   The amigaini.library was written by @{B}Bruce Steers@{UB}
   & appears to be written in Amiga-E.  You can contact him at:
   @{FG SHINE}
   mailto:Bruce Steers <bsteers@ukonline.co.uk>
   http://web.ukonline.co.uk/bsteers/ @{FG TEXT}
    
@ENDNODE

@NODE "Author" "Author Information (What a hoopy guy!):"
@PREV main

  If your conscience is bugging you to contribute some cash for my
  programming efforts, please send $15 or more for the program to:
  
  The Author:
  
  James T. Steichen    @{FG SHINE}(A real cool frood!)@{FG TEXT}
  2217 N. Tamarack Dr. 
  Slayton, Mn. 56172-1155 (USA)

  email: @{FG SHINE} jimbot@frontiernet.net @{FG TEXT} (best place to send bug reports)

  IniFuncs was written in C using the SAS C compiler V6.58.

@ENDNODE

@NODE "iniAddGroup()" "iniAddGroup()"
@{FG SHINE}iniAddGroup()@{FG TEXT}

@{B}NAME@{UB}
@{FG SHINE}    int errorValue = iniAddGroup( aiPTR ai, char *groupName, int numItems );

@{FG TEXT}
@{B}DESCRIPTION@{UB}
    Create a new memory space with room for a new group.


@{B}INPUTS@{UB}
    ai        - the current aiPTR.
    groupName - the name of the group that will be added (including
                the []).
    numItems  - the Number of items to add.


@{B}RETURN VALUE@{UB}
    Zero if successful, INI_ERROR_NUMBER if there's a problem.

@ENDNODE

@NODE "iniAddItem()" "iniAddItem()"
@{FG SHINE}iniAddItem()@{FG TEXT}

@{B}NAME@{UB}
@{FG SHINE}    int errorValue = iniAddItem( aiPTR ai, char *groupName, 
                                 char *itemName, ULONG *itemValue );

@{FG TEXT}
@{B}DESCRIPTION@{UB}
    Create a new memory space with room for a new item in the 
    Current group.


@{B}INPUTS@{UB}
    ai        - the current aiPTR.
    groupName - the name of the group that will be added to (including
                the []).
    itemName  - the Name of the new item.
    itemValue - the Value of the new item.


@{B}RETURN VALUE@{UB}
    Zero if successful, INI_ERROR_NUMBER if there's a problem.

@ENDNODE

@NODE "iniCreateNewFile()" "iniCreateNewFile()"
@{FG SHINE}iniCreateNewFile()@{FG TEXT}

@{B}NAME@{UB}
@{FG SHINE}    aiPTR rval = iniCreateNewFile( char *fileName, int numElements,
                                   BOOL caseFlag,  ULONG delimiters );

@{FG TEXT}
@{B}DESCRIPTION@{UB}
    Create a new aiPTR & associated file.


@{B}INPUTS@{UB}
    fileName    - the new file to create.
    numElements - the Number of Lines to create.  If this value is
                  < 1, a default size of 100 will be created.
    caseFlag    - TRUE is Case-sensitive, FALSE is insensitive.
    delimiters  - the separators between the itemName & itemValue.


@{B}RETURN VALUE@{UB}
    an aiPTR, NULL if there's a problem.

@ENDNODE

@NODE "iniCurrentGroup()" "iniCurrentGroup()"
@{FG SHINE}iniCurrentGroup()@{FG TEXT}

@{B}NAME@{UB}
@{FG SHINE}    char *name = iniCurrentGroup( aiPTR ai );

@{FG TEXT}
@{B}DESCRIPTION@{UB}
    Return the name of the Current group.

@ENDNODE
@NODE "iniExit()" "iniExit()"
@{FG SHINE}iniExit()@{FG TEXT}

@{B}NAME@{UB}
@{FG SHINE}    void iniExit( aiPTR ai );

@{FG TEXT}
@{B}DESCRIPTION@{UB}
    Close a .ini file & free it's memory spaces.


@{B}RETURN VALUE@{UB}
    None.

@ENDNODE

@NODE "iniFindGroup()" "iniFindGroup()"
@{FG SHINE}iniFindGroup()@{FG TEXT}

@{B}NAME@{UB}
@{FG SHINE}    ULONG index = iniFindGroup( aiPTR ai, char *groupName );

@{FG TEXT}
@{B}DESCRIPTION@{UB}
    Starting at the beginning of the memory list, find the first
    group that matches groupName (which includes the []).
    Return the Line number of the matched group or 0xFFFFFFFF if 
    there's no match.

@ENDNODE

@NODE "iniFindItem()" "iniFindItem()"
@{FG SHINE}iniFindItem()@{FG TEXT}

@{B}NAME@{UB}
@{FG SHINE}    ULONG index = iniFindItem( aiPTR ai, char *itemName );

@{FG TEXT}
@{B}DESCRIPTION@{UB}
    Starting at the current group beginning, find the first
    group item that matches itemName.
    Return the Line number of the matched item or zero if there
    is no match.

@ENDNODE

@NODE "iniFindItemInGroup()" "iniFindItemInGroup()"
@{FG SHINE}iniFindItemInGroup()@{FG TEXT}

@{B}NAME@{UB}
@{FG SHINE}    ULONG index = iniFindItemInGroup( aiPTR ia, char *groupName, char *itemName );

@{FG TEXT}
@{B}DESCRIPTION@{UB}
    Starting at the beginning of the memory list, find the first
    group item that matches itemName.
    Return the Line number of the matched item or zero if there
    is no match.

@ENDNODE

@NODE "iniGetGroupEnd()" "iniGetGroupEnd()"
@{FG SHINE}iniGetGroupEnd()@{FG TEXT}

@{B}NAME@{UB}
@{FG SHINE}    ULONG index = iniGetGroupEnd( aiPTR ai, char *groupName );

@{FG TEXT}
@{B}DESCRIPTION@{UB}
    Return the lineIndex for the last item in the named group,
    0 if there's a problem.

@ENDNODE

@NODE "iniGetGroupStart()" "iniGetGroupStart()"
@{FG SHINE}iniGetGroupStart()@{FG TEXT}

@{B}NAME@{UB}
@{FG SHINE}    ULONG index = iniGetGroupStart( aiPTR ai, char *groupName );

@{FG TEXT}
@{B}DESCRIPTION@{UB}
    Return the lineIndex for the first item in the named group,
    0 if there's a problem.

@ENDNODE

@NODE "iniGetItemName()" "iniGetItemName()"
@{FG SHINE}iniGetItemName()@{FG TEXT}

@{B}NAME@{UB}
@{FG SHINE}    char *item = iniGetItemName( aiPTR ai, int lineIndex );

@{FG TEXT}
@{B}DESCRIPTION@{UB}
    Returns a copy of the Item Name for the given lineIndex (if it's
    an item & NOT a group), NULL if there's a problem.

@ENDNODE

@NODE "iniGetItemValue()" "iniGetItemValue()"
@{FG SHINE}iniGetItemValue()@{FG TEXT}

@{B}NAME@{UB}
@{FG SHINE}    char *value = iniGetItemValue( aiPTR ai, int lineIndex );

@{FG TEXT}
@{B}DESCRIPTION@{UB}
    Returns a copy of the Item Value for the given lineIndex (if it's
    an item & NOT a group), NULL if there's a problem.

@ENDNODE

@NODE "iniGroupLength()" "iniGroupLength()"
@{FG SHINE}iniGroupLength()@{FG TEXT}

@{B}NAME@{UB}
@{FG SHINE}    ULONG length = iniGroupLength( aiPTR ai );

@{FG TEXT}
@{B}DESCRIPTION@{UB}
    Get the length in file lines of the current group.

@ENDNODE

@NODE "iniIsGroup()" "iniIsGroup()"
@{FG SHINE}iniIsGroup()@{FG TEXT}

@{B}NAME@{UB}
@{FG SHINE}    BOOL check = iniIsGroup( aiPTR ai, int lineIndex );

@{FG TEXT}
@{B}DESCRIPTION@{UB}
    Returns TRUE if the given lineIndex contains a groupName,
    FALSE if otherwise.

@ENDNODE

@NODE "iniIsItem()" "iniIsItem()"
@{FG SHINE}iniIsItem()@{FG TEXT}

@{B}NAME@{UB}
@{FG SHINE}    BOOL check = iniIsItem( aiPTR ai, int lineIndex );

@{FG TEXT}
@{B}DESCRIPTION@{UB}
    Returns TRUE if the given lineIndex contains a group Item,
    FALSE if otherwise.

@ENDNODE

@NODE "iniItemTypeIsString()" "iniItemTypeIsString()"
@{FG SHINE}iniItemTypeIsString()@{FG TEXT}

@{B}NAME@{UB}
@{FG SHINE}    BOOL check = iniItemTypeIsString( ULONG *itemValue );

@{FG TEXT}
@{B}DESCRIPTION@{UB}
    Returns TRUE if the itemValue is a string, FALSE if it's a Number.

@ENDNODE

@NODE "iniNamedGroupLen()" "iniNamedGroupLen()"
@{FG SHINE}iniNamedGroupLen()@{FG TEXT}

@{B}NAME@{UB}
@{FG SHINE}    ULONG length = iniNamedGroupLen( aiPTR ai, char *groupName );

@{FG TEXT}
@{B}DESCRIPTION@{UB}
    Get the length in file lines of the named group.

@ENDNODE

@NODE "iniNextGroup()" "iniNextGroup()"
@{FG SHINE}iniNextGroup()@{FG TEXT}

@{B}NAME@{UB}
@{FG SHINE}    ULONG index = iniNextGroup( aiPTR ai );

@{FG TEXT}
@{B}DESCRIPTION@{UB}
    Starting at the current group, move down the list to the
    beginning of the next group & return the lineIndex.  If there is 
    none, return ai_NumElements.

@ENDNODE

@NODE "iniOpenFile()" "iniOpenFile()"
@{FG SHINE}iniOpenFile()@{FG TEXT}

@{B}NAME@{UB}
@{FG SHINE}    aiPTR rval = iniOpenFile( char *fileName, BOOL caseFlag, ULONG delimiters );

@{FG TEXT}
@{B}DESCRIPTION@{UB}
    Open a .ini file & read its contents into the aiPTR.


@{B}INPUTS@{UB}
    fileName    - the new file to create.  If the file is empty,
                  a default size of DEFAULT_FILE_SIZE (100 lines)
                  will be allocated.
    caseFlag    - TRUE is Case-sensitive, FALSE is insensitive.
    delimiters  - the separators between the itemName & itemValue.


@{B}RETURN VALUE@{UB}
    an aiPTR, NULL if there's a problem.

@ENDNODE

@NODE "iniPrevGroup()" "iniPrevGroup()"
@{FG SHINE}iniPrevGroup()@{FG TEXT}

@{B}NAME@{UB}
@{FG SHINE}    ULONG index = iniPrevGroup( aiPTR ai );

@{FG TEXT}
@{B}DESCRIPTION@{UB}
    Starting at the current group, move up the list to the
    beginning of the previous group & return the lineIndex.  
    If there is none, return 0.

@ENDNODE

@NODE "iniRemoveGroup()" "iniRemoveGroup()"
@{FG SHINE}iniRemoveGroup()@{FG TEXT}

@{B}NAME@{UB}
@{FG SHINE}    int errorValue = iniRemoveGroup( aiPTR ai, char *groupName );

@{FG TEXT}
@{B}DESCRIPTION@{UB}
    Mark an entire group as deleted.


@{B}INPUTS@{UB}
    ai        - the current aiPTR.
    groupName - the name of the group that will be removed (including
                the []).


@{B}RETURN VALUE@{UB}
    Zero if successful, INI_NOHEADER if there's a problem.

@ENDNODE

@NODE "iniRemoveItem()" "iniRemoveItem()"
@{FG SHINE}iniRemoveItem()@{FG TEXT}

@{B}NAME@{UB}
@{FG SHINE}    int errorValue = iniRemoveItem( aiPTR ai, char *groupName, 
                                              char *itemName   );

@{FG TEXT}
@{B}DESCRIPTION@{UB}
    Mark an itemName line as deleted.


@{B}INPUTS@{UB}
    ai        - the current aiPTR.
    groupName - the name of the group that will be shortened (including
                the []).
    itemName  - the Name of the item to remove.


@{B}RETURN VALUE@{UB}
    Zero if successful, INI_ERROR_NUMBER if there's a problem.

@ENDNODE

@NODE "iniSetGroupName()" "iniSetGroupName()"
@{FG SHINE}iniSetGroupName()@{FG TEXT}

@{B}NAME@{UB}
@{FG SHINE}    int error iniSetGroupName( aiPTR ai, int lineIndex, cahr *groupName );

@{FG TEXT}
@{B}DESCRIPTION@{UB}
    Set the given lineIndex group name groupName (if it's 
    NOT an item).  Return zero if successful.

@ENDNODE

@NODE "iniSetItemName()" "iniSetItemName()"
@{FG SHINE}iniSetItemName()@{FG TEXT}

@{B}NAME@{UB}
@{FG SHINE}    int error iniSetItemName( aiPTR ai, int lineIndex, char *itemName );

@{FG TEXT}
@{B}DESCRIPTION@{UB}
    Set the given lineIndex item to itemName (if it's NOT a group).
    Return zero if successful.

@ENDNODE

@NODE "iniSetItemValue()" "iniSetItemValue()"
@{FG SHINE}iniSetItemValue()@{FG TEXT}

@{B}NAME@{UB}
@{FG SHINE}    int error iniSetItemValue( aiPTR ai, int lineIndex, ULONG *itemValue );

@{FG TEXT}
@{B}DESCRIPTION@{UB}
    Set the given lineIndex item value to itemValue (if it's 
    NOT a group).  Return zero if successful.

@ENDNODE

@NODE "iniTranslateErrorNumber()" "iniTranslateErrorNumber()"
@{FG SHINE}iniTranslateErrorNumber()@{FG TEXT}

@{B}NAME@{UB}
@{FG SHINE}    char *errString = iniTranslateErrorNumber( int errNumber );

@{FG TEXT}
@{B}DESCRIPTION@{UB}
    Return a string correwsponding to the given error number.

@ENDNODE

@NODE "iniWrite()" "iniWrite()"
@{FG SHINE}iniWrite()@{FG TEXT}

@{B}NAME@{UB}
@{FG SHINE}    int errorValue = iniWrite( aiPTR ai );

@{FG TEXT}
@{B}DESCRIPTION@{UB}
    Update the file with the contents of the memory list.


@{B}RETURN VALUE@{UB}
    Zero if successful, IoErr() if there's a problem.

@ENDNODE

@NODE "iniWriteToFile()" "iniWriteToFile()"
@{FG SHINE}iniWriteToFile()@{FG TEXT}

@{B}NAME@{UB}
@{FG SHINE}    int errorValue = iniWriteToFile( aiPTR ai, char *fileName );

@{FG TEXT}
@{B}DESCRIPTION@{UB}
    Write the contents of the memory list to a different file.


@{B}RETURN VALUE@{UB}
    Zero if successful, IoErr() if there's a problem.

@ENDNODE