
	Source Notes
	============
			by M.Meany.

 I devoted the last month to hardware programming, this motly collection is
the result. The bulk of what little programming time I've had was spent
writing the menu program and getting it ready for this disc. Deadlines are
a pain in the butt!

 Cruncher
 ========

 This program is no PowerPacker! It runs from the CLI only for a start, but
that's not the main difference.

 The program uses an adaption of the IFF byterun algorithm. I do not know
how the IFF version works, so I assume it's an adaption! I got the idea
from the name.

 A graphics file is loaded into memory and a buffer the same size as the
file is created. The actual crunch is done by inspecting consecutive bytes
in the file. If the next byte is the same as the current byte it is skipped
and a counter is incremented, this continues until a different byte is
encountered. At this point, the current byte is written into the buffer
along with the counter. The counter is reset and the byte offending byte is
made the current byte. This process continues until either the whole file
has been processed or the buffer fills ( indicating the crunched version is
infact an expansion ).

 For example:

	0,0,0,0,0,0,0,0,0,0,0,0,3,3,3,3,3,1,2,2,2,2,2,2,2

 becomes:
	0,12,3,5,1,1,2,7

 For most simple drawings this works very well and crunches between thirty
and fifty percent can be gained!

 The first long word of each crunched file is the length of the file when
decrunched and the last word of a crunched file is zero.

 The beauty of this routine lies in the decrunch source. A mere 30 bytes in
it's simplest form, it's bloody fast and easy to include in your own code.

 The method of decrunching should be obvious. First read a byte, then a
counter specifying how many times to copy this byte. this continues until a
zero counter is found ( end of crunched data ).

 I have included a slightly more sophisticated version of the decruncher
that allocates memory for the decrunched data. The simple version requires
your program supplies the address of the decrunch buffer.

 To demonstrate the decrunchers in action see the files:

	melt_crunched.s
	wobble_crunched.s
and	lightbikes.s

 Lightbikes is infact a program by Raistlin, but I modified it to run using
the graphics in crunched format. I used the crunch utility to do the dirty
with the bitmap files.

 Instructions for using Crunch are contained in the program. Read the
source or assemble and enter a ? parameter from the CLI.

 Centralise
 ==========

 A subroutine really. I wrote this to use in the menu source. It's purpose
is to put all text into the centre of the display ( assuming you are using
an 80 character display ).

 It works by dividing the length of a string in two and subtracts this from
the mid position of the display. The value derived is the starting position
of the text, but to make life easier the routine builds a buffer padded out
with spaces. This means that you supply the address of a text string and
then print the contents of the buffer, saves having to calculate offsets
from the edge of the display and also every string will be 80 chars long so
the print routine becomes very simple to write.

 Typer
 =====

 I wanted a routine that could print a full screen of text without causing
flicker. This program was the development version. It just prints a few
lines of text every VBL without any flickering, but there are some useful
subroutines in this if you want them.

 Melt / Melt_Crunched
 ====================

 This is a screen effect program and is detailed in the hardware tutorial
elsewhere on this disc.

 Wobble / Wobble_Crunched
 ========================

 Another screen effect also detailed in the hardware tutorial.

 MyMenu
 ======

 Here is the commented source for the menu system I have used on this disc.
I got the hint from so many of you that I decided to change. Some good menu
sources have been sent in already and there are some very good ones
elsewhere on this disc, only problem was none of them came with a built in
text file viewer. Jumping back to the workbench just to read a text file is
bloody anoying and would do your head in on a disc mag like this.

 The solution .... I wrote this. I tried to keep things as simple as
possible still, everything is controlled by using the mouse! I am not going
to attempt to explain the source, just that it includes a number of the
routines explained above and uses powerpacker library to decrunch files.

 Please let me have your thoughts on this and how I could improve it. If it
does not run on your set up I must know as soon as possible!!!


 Well that's it for now. Hope this has made a few people happy seing some
hardware stuff come out of my corner. Sorry to anyone looking for the
Gadgets tutorial, no time. It will be on next months disc.

					Mark Meany.
					August 91


