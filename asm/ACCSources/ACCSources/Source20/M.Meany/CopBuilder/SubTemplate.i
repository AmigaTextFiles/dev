
pf_Width	equ	%d/8
pf_Height	equ	%d
pf_PlaneSize	equ	pf_Width*pf_Height
pf_Depth	equ	%d
pf_Colours	equ	%d

***************	Subroutine to fill Copper List with colour values and
*		Bitplane pointers. Generated by CopperBuilder, © M.Meany.

; Entry		a0->Raw Bitmap data, CMAP behind.

FillCopperList	move.l		#$00E0,d0	BPL1PTH
		move.l		a0,d1		data
		lea		CopPlanes,a1	a1->into copper list

		move.l		#pf_Depth,d2	get depth
		subq.l		#1,d2		adjust for dbra
.planeloop	move.w		d0,(a1)+	write high plane pointer
		addq.w		#2,d0		bump to low pointer
		swap		d1		get high part of addr
		move.w		d1,(a1)+	write high part of addr
		move.w		d0,(a1)+	write low plane pointer
		addq.w		#2,d0		bump to next plane pointer
		swap		d1		get low part of addr
		move.w		d1,(a1)+	write low part of addr
		add.l		#pf_PlaneSize,d1 bump to next bitplane
		dbra		d2,.planeloop	for all planes

		move.l		d1,a0		a0->CMAP
		move.l		#$0180,d0	COLOR00
		lea		CopColours,a1	a1->into copper list
		
		move.l		#pf_Colours,d2	get num of colours
		subq.l		#1,d2		adjust for dbra
.colourloop	move.w		d0,(a1)+	write colour register
		addq.w		#2,d0		bump to next register
		move.w		(a0)+,(a1)+	copy colour
		dbra		d2,.colourloop	for all colours
		
		rts				all done so return

