                                                             1 Alice Way,
                                                             Unstone Green,
                                                             Sheffield,
                                                             S18-5DN
                                                             (0246) 419125
       
Hi There!
        Long time no see. For those with long memories who may be wondering
what happened to the articles on  devices,  well  that's a long(ish) story.
Basically what happened was that the first article on the audio device fell
into some  kind  of  postal  black  hole  which  exists  between  here  and
Southampton. That  is  presuming  that  it  didn't  resurface  since I last
contacted Mark. The last letter that  I  sent  to Ray disappeared for about
two weeks before it turned up  (apparently  it looked like it had travelled
all aver Britain). Well you may ask what  about the back up. Good question,
just wish I knew what had happened  to  it.  I have all the example source,
but the 50k doc file is nowhere to  be  found.  I started to rewrite it but
got a severe case of boredom. There  seemed  to be little or no interest in
these articles anyway.  I  can't  believe  that  people  only want to write
demo's and games, surely there are some people want to write legal code.

  Due to illness I have fallen well behind with all my projects but am now
fighting fit and catching up. Have  just  (four  days ago) got my KickStart
2.04 roms (Hurrah!). I have also got the new 2.04 DOS manual and the latest
hardware manual. I shall have to find homes for the old ones (any takers?).
The new OS is much better than the  old  (workbench is actually useable). I
have also been spending some time  writing  code for (dare I say it?) P.C's
for a well known PD library. Talk about boring!    

  Now what little snippets of code do  I  have  for you this time? Well the
first job (after fitting  the  roms)  was  to  get  scribble up and running
again. As Mark has  already  mentioned  (on  Acc 20 if I remember) scribble
opens a screen much too large  (1008  *  1024  to  be precise) when running
under 2.04. The simple answer is to write  a patch for the OpenScreen() lib
call. The code is simple enough to understand.  Just compile then put it in
your startup-sequence. It is self running, that is just call it by name and
it will launch itself and return control to the cli. The code shows the use
of CreateNewProc to do this.  CreateNewProc  introduces  a new structure to
the Amiga libraries, the Tag list  (Mark  may  have already covered these).
Tag list provide a simple extensible method  of passing parameters. To stop
the program (remove the patch) use  the  break command. You may need to use
status to  find the CLI number  to  break.  If  ScribPatch was run from the
workbench status will still tell you  where  the  program is, as I included
tags to add  a  cli  structure  to  the  process.  Not  easily  done  using
CreateProc. Status doesn't seem to  find  the  process name though when the
prog is run from workbench.  Scribpatch  will appear as 'No Command Loaded'
strangely enough. Break will  still  remove  it  though. Using status again
will show that the  process  has  been  terminated.  Note:  I have just had
another look at this program. It seems  that the Tag for adding the program
name   doesn't   work   properly.   To   get   around   this  I  have  used
SetProgramName().  ScribPatch   now  appears  by  name  even  if  run  from
workbench. On Acc 20 there  was  an  example  of  creating  a  self running
program using CreateProc. This code  is  bugged, you MUST and I repeat MUST
call Forbid() before you  UnLoadSeg  yourself.  Bugs  like  this are easily
found with tools like MungWall.
   
  I have also included a couple of examples of using the Asl requester and
Font Requester. They are only  crude  but  serve  as examples. I also did a
little work on Mark's PPMuchMore  prog,  converting it to 2.04 and removing
Arp dependency. This code is full of  bugs  still but I thought I'd send it
as it is a more practical example  and  shows  the use of some more new lib
calls like OpenWindowTagList(),  CreateMsgPort()  etc. Working on this code
is like banging your head on a wall,  I  wish Mark would make his code more
modular (and perhaps add a few comments).

  I have also included a replacement startup routine for DOS 2.04 programs. 
This requires DOS 2.04 and will not  run  without  it. There is a demo file
which uses the startup code. If you  use  this code you will need to set up
strings called 'TEMPLATE' and 'ExtHelp' as well as an array called ArgList.
The template string should follow the same  format as the templates on most
c commands. For example :

    DIR,OPT/K,ALL/S,DIRS/S,FILES/SINTER/S:

Note that the /K, /S etc. are important, these mean :

/K = Keyword. Only filled if the  keyword  appears in the command line. For
example Drive/K would require Drive=DF0: or Drive DF0:. 
/N = Number. This is for a  decimal  number.  The  number will be converted
from ascii to binary for you.
/S = Switch. This provides a simple  switch.  If the switch name appears in
the command line the entry will  be  set  to  a nonzero value, otherwise it
will be zero.
/T = Toggle.  Similar  to  switch  but  this  toggles  on  and off for each
occurrence.
/A = Always required. If this keyword is not in the command line ReadArgs()  
will fail.
/M = Multiple. This allows  multiple  names  to  be  entered, like multiple
filenames for a copy etc. Only one /M is allowed in the template.
/F = Final. This is the last  modifier.  If this is specified then the rest
of the command line after the  /F  will  be  returned in the entry for this
modifier.

  ArgList requires one long for each modifier. Exceptions being things like
/A/M which requires that something be entered but allows just one argument. 
This needs just one long. In the  case  of  /M you will get a pointer to an
array of filenames (or whatever) in the entry for /M.
  The ExtHelp string is a string (null  terminated)  that will be displayed
when the user types a second '?'. That  is when the user types 'progname ?'
the template will be displayed. If  the  user  then types a further '?" the
extended help string will  be  displayed.  The  user  will automatically be
prompted to enter arguments after requesting the template or extended help. 
  A note here that you will  have  to  use  the  includes  and  not use the
system.gs file if using Devpac 3. The 2.04  system.gs file is missing a lot
of information and macros. I  have  written  to  Hisoft (with a rather long
list of bugs) and have asked permission to distribute my corrected gs file.
If it is OK to do so than I will spread it through ACC disks. I have phoned 
Hisoft's tech line who inform me that the latest version of Devpac is V3.02
and that most bugs have been fixed.  Apparently  the  problem of moving the
cursor with the mouse (sometimes  marked  a  block 1 char long which looked
like a cursor) has not been fixed. This  has caused a few problems and they
have added a workround feature of a flashing cursor option. This is so that
you can tell the difference between the cursor and a block.  
  That's about all for now. When  I  find  out  just  what Mark has already
covered on the new OS I  will  write  a  few  more  examples,  (AppWindows,
AppIcons, public screens etc.). I also want to have a look at outline fonts
and colorfonts. As usual I am   always  willing  to help out with anybodies
programming problems and can be  contacted   at  the above address or phone
number. Ha! no sooner said! Just had a  call from Al Brimble with a problem
using   the  SoundMonitor  playroutine.  Apparently  they  are still having
problems which occured in Alien  Breed  and  Project X. Now where did I put
that souce code?
  
 Steve Marshall 
      


































































































































