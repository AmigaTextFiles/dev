@DATABASE
@INDEX DEX
@NODE MAIN "ConvFP Manual Title Page"
@TOC TBLE
@NEXT MAIN
@PREV MAIN

         @{u}ConvFP: The Function Description/Pragma Conversion Utility@{uu}

              Copyright  1993 by Enchanted Blade Associates


                               USER MANUAL



                                @{"Continue" LINK TBLE}
@ENDNODE
@NODE TBLE "Table of Contents"
@TOC TBLE
@PREV DFRM

        @{u}ConvFP: Function Description/Pragmas File Conversion Utility@{uu}

                           Version 1.02 User Manual

           @{b}Contents@{ub}
           @{"Distribution" LINK DIST}   Legal notices and distribution information
           @{"  Synopsis  " LINK SYNP}   Synopsis of ConvFP's capabilities and uses
           @{"Installation" LINK INST}   Installing the program for everyday use
           @{"Using ConvFP" LINK USEF}   Command arguments and options
           @{"ConvFP Files" LINK USEP}   Using ConvFP files in your programs

           @{b}Appendices@{ub}
           @{"   Errors   " LINK ERRC}   Explanation of error/warning messages
           @{"Macro Format" LINK MFRM}   Structure outline of macro files
           @{"Def'n Format" LINK DFRM}   Structure outline of LVO definition files
@ENDNODE
@NODE DIST "Legal Distribution of ConvFP"
@TOC TBLE

                      Please select area of interest:

                         @{"Distribution Information" LINK SMSG}

                         @{"   Obtaining Updates    " LINK UPDT}

                         @{"      Bug Reports       " LINK BUGS}


@ENDNODE
@NODE SYNP "Product Synopsis"
@TOC TBLE



      ConvFP is a @{"command line" LINK USEF} driven program that simplifies an assembly
   language programmer's access to the Amiga's library functions. ConvFP
   is capable of converting both function description (.fd) and pragmas
   (from the C language) into two types of assembly language include
   files: @{"macro files" LINK MFRM} that make it possible to call each function with
   a single line, and @{"definition files" LINK DFRM} that create LVO (library vector
   offset) equates to reduce or eliminate the time spent linking your
   program.  It is a useful tool for both assembly programmers and
   anyone wishing to write custom libraries.
@ENDNODE
@NODE INST "Product Installation Guide"
@TOC TBLE





      To install ConvFP as a command in your C: directory, double-click
   on the install icon.  ConvFP will then be available at any command
   line prompt by simply typing ConvFP and your desired arguments, and
   pressing RETURN.

@ENDNODE
@NODE USEF "Using ConvFP To Create Include Files"
@TOC TBLE

      ConvFP is called from the shell and accepts a command line according
   to the following syntax:

   ConvFP sourcefile[.fd|_pragmas.h] [destfile[.i]] [i|m|d|a]

      The "sourcefile" parameter determines the function description or
   pragma file that will be converted.  If the ".fd" or "_pragmas.h" file
   extension is left off, ConvFP first tries to read the file as given.
   If it is unable to do this, it will then attempt to open the same file
   with a ".fd" extension.   If this fails, it will try a "_pragmas.h"
   file extension.   If all of these attempts fail, it will give up and
   return a "Can't open source file" error (@{"Error 8" LINK ERRC 41}).  When
   the file type is not explicitly given (by adding the appropriate
   extension to the source file), ConvFP will examine the source file to
   try to determine the file type.  If it is neither a function
   description or pragma file, you will get a "Can't determine file type"
   (@{"Error 4" LINK ERRC 21}) error.   

      The "destfile" argument allows you to specify a destination file.
   If the ".i" extension is left off it will be added automatically.  If
   the argument is left out completely, it will be created from the
   source file's name by removing the existing .fd or pragma extension
   (if present) and appending ".i".  If you choose the "a" mode parameter
   (see below), the destination files will be created by adding "_mac.i"
   to the macro file, and "_def.i" to the definition file.

      The mode parameter is one of four letters which indicates how you
   would like the file processed:
      "i" activates information mode, which displays all functions
          described in the file and a few other pieces of information.
          This is the default option, and it is useful if you wish to
          @{"syntax check" LINK USEP 21} a .fd or pragma file.
      "m" specifies macro file mode.  The destination file will contain
          a series of @{"function macros" LINK USEP}, one for each library call.
      "d" specifies definition file mode.  In this mode, a @{"LVO equate" LINK USEP} is
          generated for each function.  These can then be included to
          reduce or eliminate the linking stage of assembly.
      "a" activates all modes simultaneously.

      Using a question mark ("?") as the only argument will give a summary
   of the above information.  Note that pattern matching is not supported
   in this version of ConvFP, nor is the use of files with spaces enclosed
   in quotes.  Information on obtaining the latest version is in the
   @{"distribution" LINK DIST} section.

      Pressing Ctrl-C at any time during ConvFP's operation will abort the
   current file processing operation.
 
@ENDNODE
@NODE USEP "Using ConvFP Include Files In Your Programs"
@TOC TBLE

      ConvFP has four main uses, all of which will be described in this
   section. In summary, these are:

       A .fd/pragma file decoder and analyzer
       A syntax checker capable of finding most .fd/pragma file errors
       An assembly language library function macro generator, and
       An assembly language Library Vector Offset EQUate generator.

   The exact structure of the @{"macro" LINK MFRM} and @{"equate" LINK DFRM} files can be found in
   Appendices B and C.  For best results, always use .fd files instead
   of pragma files as sources whenever possible.

   File Decoding: To decode a .fd or pragma file, simply use the source
   file as an @{"argument" LINK USEF 4} (thus using the default @{"information mode" LINK USEF 27}). The
   source will be read and parsed, and you will get information about each
   function (including register use) as it is decoded. Private functions
   will be marked with "(PRIVATE)" after the function name. ConvFP also
   determines and displays the bias (LVO of the first function), proper
   library base according to RKRM conventions, and the total number of
   lines, comments, and functions in the file.

   Syntax Checking: If you are trying to create your own .fd or pragma
   file (if you are writing your own library, for example), ConvFP
   can be used as a fairly reliable syntax checker.  To use ConvFP in
   this manner, execute ConvFP with the file extension (i.e. ".fd" or
   "_pragmas.h") explicitly stated as part of the @{"filename" LINK USEF 6}.  In this way,
   ConvFP will not attempt to determine the file type, and thus will
   complain if you accidently use a pragma instruction in a .fd file,
   or vice-versa.

   Function Macros: When called with the "m" or "a" @{"modes" LINK USEF 27}, ConvFP will
   create an assembly language include file that contains macros to call
   any of the functions described by the source file.  The macro names
   are created by adding a single underscore ("_") to the function name,
   to avoid conflicts.  The parameters supplied to the macro are loaded
   into the proper registers, using move.l or movea.l instructions as
   appropriate, and the function is called.  All macros assume that the
   library base is located at a label called "_[basename]", where
   [basename] is the conventional basename variable for that library as
   described in the RKRM Libraries tome (for example, _GfxBase for
   graphics.library).  As an example, the dos.library function CreateProc
   looks like this: CreateProc(name,pri,segList,stackSize).  To use a
   macro created with ConvFP, you would first open dos.library and put
   its address at _DOSBase. You would then include the macro file, and
   call the macro when needed using "CreateProc_ name,pri,segList,
   stackSize", replacing the variables with whatever values you wanted.
   After the macro's code was finished, d0 would contain the result.  If
   the macros are generated from .fd files, the macro include will
   put a comment with a description of the parameters used on each
   function.  If a function uses more than nine paramters, it must be
   split into two macros, since most assemblers only support parameters
   from \1 to \9.  To use such macros, call the macro normally (use
   [function name]_) with the first nine parameters, and then call
   the second part with the remaining parameters using [function name]_2.

   LVO Equates: It can often be a pain to make the numerous XREF's to
   various function calls to obtain their LVOs, and then have to wait
   each time you assemble the program while the linker fills in the
   values from amiga.lib.  Instead, using @{"mode" LINK USEF 27} d or a, you create a file
   containing EQUate instructions for each function in a given library,
   and then include the file.  The equates are generated in the standard
   LVO_[function name] form to maintain compatibility with existing
   programs and routines.  Note that the macros created with the macro
   function of ConvFP do not need the LVO's because they use the values
   directly.  Should the LVO's of a particular library change (not likely
   to happen), simply use ConvFP on the new .fd or _pragma.h file and
   the macros will again work perfectly.

   Notes: Neither the macro files nor the LVO definition files will include
   lines for functions marked private by an .fd file.  Most assemblers let
   you create "preassembled" versions of macro and equate files, thus
   saving space and time.  Check the manual of your assembler.

@ENDNODE
@NODE ERRC "Appendix A: Error Explanations"
@TOC TBLE

      There are two types of errors you may encounter while using ConvFP:
   Errors and Warnings.  Errors are fatal; processing of the file ends
   when the error occurs.  On the other hand, warnings do not inhibit
   file conversion, they merely indicate unusual situations you should
   be aware of.  If the error occurs during the processing of the file,
   the line number of the error and the line itself will be displayed
   along with the error message.  The following index describes all the
   errors and warnings by number.

   ERROR(1)  No arguments found: ConvFP requires at least one @{"argument" LINK USEF 4} to
             be present: the name of the @{"source file" LINK USEF 6}.

   ERROR(2)  Extraneous arguments: ConvFP has found additional arguments
             on the @{"command line" LINK USEF 4}.  This can occur if one of the filenames
             contains a space as well.

   ERROR(3)  Unrecognized mode parameter: A @{"mode" LINK USEF 27} was specified on the
             @{"command line" LINK USEF 4} that is not one of the four legal codes: i,
             m, d, and a.  The mode must always be given last.

   ERROR(4)  Can't determine file type: The file type was not explicitly
             stated on the @{"command line" LINK USEF 4}, and ConvFP has examined the
             file in order to determine the type from its structure.
             When this error occurs, ConvFP has examined the entire file
             and could not find commands of either type.  This means that
             either the file is "empty" and contains no actual functions,
             or that it is neither a .fd or pragma file.

   ERROR(5)  Can't open destination macro file: Either mode "m" or mode
             "a" has been activated, but ConvFP was unable to open the
             @{"destination file" LINK USEF 19}.

   ERROR(6)  Can't open destination def'n file: Either mode "d" or mode
             "i" has been activated, but ConvFP was unable to open the
             @{"destination file" LINK USEF 19}.

   ERROR(7)  Syntax error in source file: Some error has been detected
             in the structure of the @{"source file" LINK USEF 6} and it must be corrected
             before ConvFP can convert it.

   ERROR(8)  Can't open source file: For some reason, ConvFP was unable
             to open the @{"source file" LINK USEF 6}.  Check the spelling and the path.
             Note that ConvFP can detect and open a file with a ".fd"
             or "_pragmas.h" extension automatically without it being
             given on the command line.  For example, given the source
             specification "sc:include/pragmas/asl", ConvFP will
             correctly open "sc:include/pragmas/asl_pragmas.h".

   ERROR(9)  Function defined before bias determined: This indicates an
             error within a function description file.  A proper .fd
             file contains a ##bias instruction that determines what
             the library vector offset of the first function is
             (normally 30).  When a function description occurs before
             this initial bias is defined, ConvFP cannot correctly
             calculate the offset.

   ERROR(10) Function defined before library base determined: This is
             similar to error 10, except that it revolves around the
             ##base instruction, which determines which library the
             functions are in.  When a function is found before the
             base is known, ConvFP cannot use the correct library.

   ERROR(11) Function missing paramter description: This is a specific
             type of syntax error that indicates that the paramter list
             for a function is missing.

   ERROR(12) 100 sequential null lines without end of file: Some filing
             systems do not correctly indicate the end of a file. If 100
             empty lines are read in a row, ConvFP will assume that this
             is why and stop reading the file.  The @{"destination file(s)" LINK USEF 19},
             if any, should still work normally.


   WARNING(1) Unrecognized instruction ignored: In .fd files, a "##"
              sequence indicates a command.  ConvFP understands all
              currently used commands, so this may in fact indicate
              an error in the file.  If new commands are added in
              the future, they are ignored.  Pragma files can contain
              `C' instructions; these will also give this warning.

   WARNING(2) A6/A7 declared as parameter: Normally, this shouldn't
              happen, but if it does for whatever reason, ConvFP
              will still continue with the conversion.

   WARNING(3) Unexpected end of source file: A proper .fd file is
              terminated with a "##end" instruction.  ConvFP can
              still correctly handle a file that does not end
              correctly, but most other .fd related utilities cannot.

   WARNING(4) More than nine paramters; made two @{"macros" LINK MFRM}: Most assemblers
              with macro capabilities only allow nine parameters (\1 to
              \9).  When a function call with more than nine paramters
              is converted into a macro, it is divided into two. The
              first macro (named [function name]_) should be called with
              the first nine paramters, followed immediately by the
              next macro (named [function name]_2) which is given the
              remaining parameters and actually calls the function.

@ENDNODE
@NODE MFRM "Appendix B: Macro File Structure"
@TOC TBLE

      The macro files created by ConvFP follow a similar skeletal outline.
   This structure begins with a brief header stating the source and
   ConvFP version.  It is a good idea to keep this header intact, since
   it will quickly determine when and where a source file came from. If,
   for example, a bug is found and corrected in a later version of ConvFP,
   you will quickly be able to see if a given file needs updating, and if
   so, what source file is needed to do it.
      The header is immediately followed by a macro (or two) for each
   function described in the source file.  Taglist and tagcall versions
   of a library function are ignored by ConvFP, and only the standard
   libcall version is converted. Each macro is followed by a single blank
   line, except for split macros created when a function has more than
   nine parameters.  The format of these macros is as follows: the
   MACRO command, followed by the name of the function with "_" appended,
   possibly followed by a list of what each parameter is for if the
   source file was a .fd file and the function has any parameters.  This
   is then followed by a single move.l or movea.l instruction for each
   parameter, in the proper calling order, that puts the parameter given
   when the macro is expanded into the correct register.  The library base
   is then moved (using movea.l) into a6 from a label created by prefixing
   the library basename with a "_".  The function is then called by JSRing
   to the correct offset.  This offset is hardcoded into the macro. If
   there are more than nine parameters, a similar approach is used, but
   the first macro only loads the first nine parameters.  The second fills
   in the remaining parameters and calls the function.  Graphically, this
   looks like the following:

   *
   * Library macros for [source file]
   *
   * Created using ConvFP [version] by C. Jennings
   *
    MACRO FirstFunction_   [;(param1,param2...)]
     move[a].l \1,[register]
     move[a].l \2,[register]
     ...
     movea.l _[lib base],a6
     jsr [offset](a6)
    ENDM

    MACRO LongFunction_   [;(p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11)]
     move[a].l \1,[register]
     ...
     move[a].l \9,[register]
    ENDM
    MACRO LongFunction_2
     move[a].l \1,[register]
     move[a].l \2,[register]
     movea.l _[lib base],a6
     jsr [offset](a6)
    ENDM

    ...

@ENDNODE
@NODE DFRM "Appendix C: LVO Definition File Structure"
@NEXT TBLE
@TOC TBLE
      The structure of the definition files is quite simple.  It starts
   with a @{"header" LINK MFRM 3} (see the macro structure section for more information),
   and then proceeds with an equate of the form LVO_[function] EQU [offset]
   for each function in the source file.  Graphically, this is as follows:

   *
   * LVO definition file for [source file]
   *
   * Created using ConvFP [version] by C. Jennings
   *
   LVO_[function 1]                                              EQU -[off]
   LVO_[function 2]                                              EQU -[off]
   ...
   LVO_[function n]                                              EQU -[off]

@ENDNODE
@NODE DEX "ConvFP Index"

   A6/A7 declared as parameter ....................................... @{" " LINK ERRC 81}
   Aborting .......................................................... @{" " LINK USEF 46}
   Arguments (Command Line) .......................................... @{" " LINK USEF 4}
      Destination file ............................................... @{" " LINK USEF 19}
      Mode parameters ................................................ @{" " LINK USEF 27}
      Source file .................................................... @{" " LINK USEF 6}
   Bug reports ....................................................... @{" " LINK BUGS}
   Can't determine file type ......................................... @{" " LINK ERRC 21}
   Can't open destination def'n file ................................. @{" " LINK ERRC 33}
   Can't open destination macro file ................................. @{" " LINK ERRC 29}
   Can't open source file ............................................ @{" " LINK ERRC 41}
   Command Line (Arguments) .......................................... @{" " LINK USEF 4}
   Definition files (Using) .......................................... @{" " LINK USEP 55}
   Definition files (Structure) ...................................... @{" " LINK DFRM}
   Destination file .................................................. @{" " LINK USEF 19}
   Enhancements ...................................................... @{" " LINK VERS}
   Errors ............................................................ @{" " LINK ERRC}
   Extraneous arguments .............................................. @{" " LINK ERRC 13}
   Function defined before bias determined ........................... @{" " LINK ERRC 49}
   Function defined before library base determined ................... @{" " LINK ERRC 57}
   Function missing parameter description ............................ @{" " LINK ERRC 63}
   Header ............................................................ @{" " LINK MFRM 2}
   Installation ...................................................... @{" " LINK INST}
   Macro files (Using) ............................................... @{" " LINK USEP 30}
   Macro files (Structure) ........................................... @{" " LINK MFRM}
   Mode parameters ................................................... @{" " LINK USEF 27}
      All files mode ................................................. @{" " LINK USEF 38}
      Definition file mode ........................................... @{" " LINK USEF 35}
      Information mode ............................................... @{" " LINK USEF 29}
      Macro file mode ................................................ @{" " LINK USEF 33}
   More than nine parameters; made two macros ........................ @{" " LINK ERRC 90}
   No arguments found ................................................ @{" " LINK ERRC 10}
   Sequential null lines without end of file, 100 .................... @{" " LINK ERRC 67}
   Source file ....................................................... @{" " LINK USEF 6}
   Suggestions ....................................................... @{" " LINK UPDT 29}
   Synopsis .......................................................... @{" " LINK SYNP}
   Syntax Checking ................................................... @{" " LINK USEP 21}
   Syntax error in source file ....................................... @{" " LINK ERRC 37}
   Unexpected end of source file ..................................... @{" " LINK ERRC 85}
   Unrecognized instruction ignored .................................. @{" " LINK ERRC 74}
   Unrecognized mode parameter ....................................... @{" " LINK ERRC 17}
   Updates (Information) ............................................. @{" " LINK UPDT}
   Updates (Ordering) ................................................ @{" " LINK UPDT 25}
   Warnings .......................................................... @{" " LINK ERRC}

@NEXT TBLE
@PREV TBLE
@TOC TBLE
@ENDNODE
@NODE SMSG "Distribution of ConvFP"
@PREV BUGS
@TOC DIST

      ConvFP is Copyright  1993 by Enchanted Blade Associates (EBA).  This
   software may be distributed freely, as long as it is distributed intact,
   with all files present and unmodified.  The software can be compressed
   and/or stored in an archive so long as all files can be restored to their
   origin al state using the appropriate archival/compression software.  You
   may own and use as many copies of this software as you wish, and you may
   print a hard copy of the instructions, but the software and
   documentation must not be altered.  This software cannot be supplied
   with any commercial product without prior written consent of the author.
   This software cannot be distributed through any facility that claims
   copyright on materials which are distributed through it (the facility).

      Enchanted Blade Associates assumes no responsibilty for any negative
   or damaging result produced through the use or misuse of this product.
   Should damage result from the use of this software, in whatever form,
   the user has the sole responsibility for the repair of such damage, even
   if the author has been advised of the possibility of such damage, and
   regardless of whether the damage was a direct or indirect result of the
   product.

   Enchanted Blade Associates, EBA, and the EBA Sword-In-Stone logo are
   trademarks of Enchanted Blade Associates.  Other names and marks are
   owned by their respective companies, and their use does indicate a claim
   to them by Enchanted Blade Associates.
@ENDNODE
@NODE UPDT "Obtaining the Latest Version"
@TOC DIST

      The latest version can be obtained directly from the author for
   the small fee of $15 Canadian (basically enough to cover the cost of
   buying disks, envelopes, stamps, and so on).  This "registered"
   version will include the latest version (whatever that may be) and
   a GUI frontend for the program, and enough other "goodies" to fill
   up a disk.  This program is freely distributable; it is not shareware.
   There is no obligation to send money.  You only need to send anything
   if you want the latest version, the GUI frontend, and other software
   as described above.

   To order the next available update, send cash (a bit risky) or a money
   order for $15, payable to Enchanted Blade Associates, to the following
   address*:

                          Enchanted Blade Associates
                          R4 Langton, ON
                          N0E 1G0
                          Canada

                          (519) 875-2137

  Enchanted Blade Associates can also be reached via E-Mail:

                          lynnjenn@vef.north.net

   For fastest (and cheapest) response to questions and comments, send
   email with "CONVFP" in the subject header.

   * Be sure to enclose the following along with your payment: your name
   and mailing address, the version number of the version of ConvFP you
   currently have, and any suggestions and @{"bug reports" LINK BUGS} you might wish to
   make.

   THIS IS NOT SHAREWARE; THERE IS NO OBLIGATION TO SEND MONEY. THE MONEY
   IS ONLY TO COVER MY COSTS AND IS ONLY IF YOU WANT AN UPDATED VERSION
   OF THE SOFTWARE.
@ENDNODE
@NODE BUGS "Bug Reports"
@NEXT SMSG
@TOC DIST

      If you find a bug in ConvFP, please write me a letter and tell me
   about it.  Please give me as much information as possible, and at
   least a description of the problem and how to recreate it.  If
   possible, send a disk with the files or source code that seem to be
   causing the problem.  Tell me the version of ConvFP you are using.
   Please send all bug reports to:

                         Attn: ConvFP Bugs
                         Enchanted Blade Associates
                         R4 Langton, ON
                         N0E 1G0
                         Canada

                         (519) 875-2137

   Or via E-Mail to:    lynnjenn@vef.north.net

   For fastest (and cheapest) response to questions and comments, send
   email with "CONVFP" in the title.

@ENDNODE
