
; soc04h.s
; maximaler Gesamt-Offset

DISPLAY_DY=256
RED_ROW_SPEED  =1
RED_START  =359<<1		; Wert zwischen 0 und 718	(Winkelwert * 2)

start:
	lea offset,a3						; nur für Test
	lea testfeld,a4						; nur für Test
	;movea.l rowOffsets,a6				; Adresse nach a6 von einem Speicherbereich
	lea rowOffsets,a6
	move.w redSinus,d3					; rote Komponenete nach d3

	move.w #DISPLAY_DY-1,d1				; 256 über alle Zeilen, Schleifenzähler
_rows:

; Sinusförmige Startversätze in Farbkomponenten
	;movea.l rgbOffsets,a1				; Anfangsadresse der Komponenetenversätze nach a1
	lea rgbOffsets,a1
	move.w (a1,d3.w),d6					; Offset aktueller Sinuswert rot addieren und Wert nach d6
	add.w (a6),d6						; Wert von rowOffsets zu Farbkomponentenwert addieren
	move.w d6,(a3)+						; nur für Test Ergebnis offset
	lea red,a2							; Anfangsadresse Feld rot
	lea (a2,d6.w),a2					; Ergebnis Adresse in a2 (des ermittelten Wertes)
	move.l a2,(a4)+						; nur für Test Ergebnis testfeld	 

; Erhöhen der Sinuslinien	
	subi.w #RED_ROW_SPEED<<1,d3			; rote Geschwindigkeit * 2 subtrahieren
	bge _noRedRowSinusUnderflow			; wenn größer, gleich 0, dann übersrpringen
	addi.w #360<<1,d3					; ansonsten auf Startwert setzen (720)
_noRedRowSinusUnderflow:
	dbf d1,_rows						; über alle 256 Zeilen

	rts

	SECTION yragael,DATA_C
redSinus:			DC.W RED_START

offset:	dcb.w	1000,$FFFF

testfeld:	dcb.w	2000,$FFFF


rowOffsets:
	dc.w $0008, $0008, $0008, $0008, $0008, $0008, $0006, $0006	; kleinster Wert = 0
	dc.w $0006, $0006, $0006, $0006, $0004, $0004, $0004, $0004	; größter Wert = $12
	dc.w $0004, $0004, $0002, $0002, $0002, $0002, $0002, $0002
	dc.w $0002, $0002, $0002, $0000, $0000, $0000, $0000, $0000
	dc.w $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000
	dc.w $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000
	dc.w $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000
	dc.w $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0002
	dc.w $0002, $0002, $0002, $0002, $0002, $0002, $0002, $0002
	dc.w $0004, $0004, $0004, $0004, $0004, $0004, $0006, $0006
	dc.w $0006, $0006, $0006, $0006, $0008, $0008, $0008, $0008
	dc.w $0008, $0008, $000A, $000A, $000A, $000A, $000A, $000A
	dc.w $000C, $000C, $000C, $000C, $000C, $000C, $000E, $000E
	dc.w $000E, $000E, $000E, $000E, $0010, $0010, $0010, $0010
	dc.w $0010, $0010, $0010, $0010, $0010, $0012, $0012, $0012
	dc.w $0012, $0012, $0012, $0012, $0012, $0012, $0012, $0012
	dc.w $0012, $0012, $0012, $0012, $0012, $0012, $0012, $0012
	dc.w $0012, $0012, $0012, $0012, $0012, $0012, $0012, $0012
	dc.w $0012, $0012, $0012, $0012, $0012, $0012, $0012, $0012
	dc.w $0012, $0010, $0010, $0010, $0010, $0010, $0010, $0010
	dc.w $0010, $0010, $000E, $000E, $000E, $000E, $000E, $000E
	dc.w $000C, $000C, $000C, $000C, $000C, $000C, $000A, $000A
	dc.w $000A, $000A, $000A, $000A, $0008, $0008, $0008, $0008
	dc.w $0008, $0008, $0006, $0006, $0006, $0006, $0006, $0006
	dc.w $0004, $0004, $0004, $0004, $0004, $0004, $0002, $0002
	dc.w $0002, $0002, $0002, $0002, $0002, $0002, $0002, $0000
	dc.w $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000
	dc.w $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000
	dc.w $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000
	dc.w $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000
	dc.w $0000, $0000, $0000, $0002, $0002, $0002, $0002, $0002
	dc.w $0002, $0002, $0002, $0002, $0004, $0004, $0004, $0004	

rgbOffsets:
	dc.w $0012, $0012, $0012, $0012, $0012, $0012, $0012, $0014		; kleinster Wert = 0
	dc.w $0014, $0014, $0014, $0014, $0014, $0016, $0016, $0016		; größter Wert = $22
	dc.w $0016, $0016, $0016, $0016, $0018, $0018, $0018, $0018
	dc.w $0018, $0018, $0018, $001A, $001A, $001A, $001A, $001A
	dc.w $001A, $001A, $001C, $001C, $001C, $001C, $001C, $001C
	dc.w $001C, $001C, $001E, $001E, $001E, $001E, $001E, $001E
	dc.w $001E, $001E, $001E, $001E, $0020, $0020, $0020, $0020
	dc.w $0020, $0020, $0020, $0020, $0020, $0020, $0020, $0022
	dc.w $0022, $0022, $0022, $0022, $0022, $0022, $0022, $0022
	dc.w $0022, $0022, $0022, $0022, $0022, $0022, $0022, $0022
	dc.w $0022, $0022, $0022, $0022, $0022, $0022, $0022, $0022
	dc.w $0022, $0022, $0024, $0022, $0022, $0022, $0022, $0022
	dc.w $0022, $0022, $0022, $0022, $0022, $0022, $0022, $0022
	dc.w $0022, $0022, $0022, $0022, $0022, $0022, $0022, $0022
	dc.w $0022, $0022, $0022, $0022, $0022, $0022, $0020, $0020
	dc.w $0020, $0020, $0020, $0020, $0020, $0020, $0020, $0020
	dc.w $0020, $001E, $001E, $001E, $001E, $001E, $001E, $001E
	dc.w $001E, $001E, $001E, $001C, $001C, $001C, $001C, $001C
	dc.w $001C, $001C, $001C, $001A, $001A, $001A, $001A, $001A
	dc.w $001A, $001A, $0018, $0018, $0018, $0018, $0018, $0018
	dc.w $0018, $0016, $0016, $0016, $0016, $0016, $0016, $0016
	dc.w $0014, $0014, $0014, $0014, $0014, $0014, $0012, $0012
	dc.w $0012, $0012, $0012, $0012, $0012, $0010, $0010, $0010
	dc.w $0010, $0010, $0010, $000E, $000E, $000E, $000E, $000E
	dc.w $000E, $000C, $000C, $000C, $000C, $000C, $000C, $000C
	dc.w $000A, $000A, $000A, $000A, $000A, $000A, $000A, $0008
	dc.w $0008, $0008, $0008, $0008, $0008, $0008, $0006, $0006
	dc.w $0006, $0006, $0006, $0006, $0006, $0006, $0004, $0004
	dc.w $0004, $0004, $0004, $0004, $0004, $0004, $0004, $0004
	dc.w $0002, $0002, $0002, $0002, $0002, $0002, $0002, $0002
	dc.w $0002, $0002, $0002, $0000, $0000, $0000, $0000, $0000
	dc.w $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000
	dc.w $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000
	dc.w $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000
	dc.w $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000
	dc.w $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000
	dc.w $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000
	dc.w $0000, $0000, $0002, $0002, $0002, $0002, $0002, $0002
	dc.w $0002, $0002, $0002, $0002, $0002, $0004, $0004, $0004
	dc.w $0004, $0004, $0004, $0004, $0004, $0004, $0004, $0006
	dc.w $0006, $0006, $0006, $0006, $0006, $0006, $0006, $0008
	dc.w $0008, $0008, $0008, $0008, $0008, $0008, $000A, $000A
	dc.w $000A, $000A, $000A, $000A, $000A, $000C, $000C, $000C
	dc.w $000C, $000C, $000C, $000C, $000E, $000E, $000E, $000E
	dc.w $000E, $000E, $0010, $0010, $0010, $0010, $0010, $0010
red:
	dc.w $0800, $0900, $0B00, $0C00, $0D00, $0E00, $0F00, $0F00	; 70 Farbwerte
	dc.w $0F00, $0F00, $0E00, $0D00, $0C00, $0B00, $0900, $0800
	dc.w $0600, $0400, $0300, $0200, $0100, $0000, $0000, $0000
	dc.w $0000, $0100, $0200, $0300, $0400, $0600, $0800, $0900
	dc.w $0B00, $0C00, $0D00, $0E00, $0F00, $0F00, $0F00, $0F00
	dc.w $0E00, $0D00, $0C00, $0B00, $0900, $0800, $0600, $0400
	dc.w $0300, $0200, $0100, $0000, $0000, $0000, $0000, $0100
	dc.w $0200, $0300, $0400, $0600, $0800, $0900, $0B00, $0C00 ; 8x8=64
	dc.w $0D00, $0E00, $0F00, $0F00, $0F00, $0F00				; +6 --> 70*2=140 Bytes
	
	endProgrammanalyse:Welches ist der höchste Gesamtoffset? höchster Gesamtoffset= $2A=42; Ergebnis:>m 23F82															; offset			
00023F82 0018 0018 0018 0018 0018 0018 0016 0016  ................
00023F92 0016 0016 0016 0016 0014 0014 0014 0014  ................
00023FA2 0014 0014 0014 0012 0012 0012 0012 0012  ................
00023FB2 0012 0012 0010 0010 0010 0010 0010 0010  ................
00023FC2 0010 000E 000E 000E 000E 000E 000E 000E  ................
00023FD2 000E 000C 000C 000C 000C 000C 000C 000C  ................
00023FE2 000C 000C 000C 000A 000A 000A 000A 000A  ................
00023FF2 000A 000A 000A 000A 000A 000A 0008 0008  ................
00024002 0008 0008 0008 0008 0008 0008 0008 0008  ................
00024012 0008 0008 0008 0008 0008 0008 0008 0008  ................
00024022 0008 0008 0008 0008 0008 0008 0008 0008  ................
00024032 0008 0008 0008 0008 0008 0008 0008 0008  ................
00024042 0008 0008 0008 0008 0008 0008 0008 0008  ................
00024052 0008 0008 0008 0008 0008 0008 0008 0008  ................
00024062 0008 0008 0008 0008 0008 000A 000A 000A  ................
00024072 000A 000A 000A 000A 000A 000A 000A 000A  ................
00024082 000C 000C 000C 000C 000C 000C 000C 000C  ................
00024092 000C 000C 000E 000E 000E 000E 000E 000E  ................
000240A2 000E 000E 0010 0010 0010 0010 0010 0010  ................
000240B2 0010 0012 0012 0012 0012 0012 0012 0012  ................
>m
000240C2 0014 0014 0014 0014 0014 0014 0014 0016  ................
000240D2 0016 0016 0016 0016 0016 0018 0018 0018  ................
000240E2 0018 0018 0018 001A 001A 001A 001A 001A  ................
000240F2 001A 001A 001C 001C 001C 001C 001C 001C  ................
00024102 001E 001E 001E 001E 001E 001E 001E 0020  ...............
00024112 0020 0020 0020 0020 0020 0020 0022 0022  . . . . . . ."."
00024122 0022 0022 0022 0022 0022 0024 0024 0024  .".".".".".$.$.$
00024132 0024 0024 0024 0024 0024 0026 0026 0026  .$.$.$.$.$.&.&.&
00024142 0026 0026 0026 0026 0026 0026 0026 0028  .&.&.&.&.&.&.&.(
00024152 0028 0028 0028 0028 0028 0028 0028 0028  .(.(.(.(.(.(.(.(
00024162 0028 0028 002A 002A 002A 002A 002A 002A  .(.(.*.*.*.*.*.*	; höchster Gesamtoffset hier = $2A=42
00024172 002A 002A 002A 002A 002A 002A 002A 002A  .*.*.*.*.*.*.*.*
00024182 FFFF FFFF FFFF FFFF FFFF FFFF FFFF FFFF  ................


Im Feld red gibt es 70 Rot-Farbwerte als Wörter, d.h es sind 140 Bytes
als Adressen möglich. Der Zeiger auf einen Farbwert muss immer gerade 
sein, auf gerade Adressen zeigen und Wörter adressieren.

Da der Blitter mit einem Blitt 41 Farbwerte ändert muss der erste 
Farbwert zwischen 0 und 70-41=29 liegen.

Wenn der Offset $2A ist wird somit auf das $2A/2=21 und somit auf das
22. Farbelement (das 22. Word) gezeigt.

0(a5) -> zeigt auf 1. Wert
2(a5) -> zeigt auf 2. Wert
4(a5) -> zeigt auf 3. Wert
$2A(a5) -> zeigt auf 22. Wert
56(a5) --> zeigt auf 29. Wert

Um 41 Farbwerte mindestens anzuzeigen, können maximal 29 Farbwerte
übersprungen werden 41+29=70. D.h. ab 29. Farbwert spätestens 
anzeigen. 

>?56/2
$0000001C = %00000000`00000000`00000000`00011100 = 28 = 28
>

Der maximal mögliche Offset ist:
56(a5) --> zeigt auf 29. Wert
