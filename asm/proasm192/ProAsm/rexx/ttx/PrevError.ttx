/******************************************************************************

 ASX PrevError Script for TurboText

  © 1993 by Michael "TILT!" Ryffel
  [some parts ripped from d.weber]

 ******************************************************************************

 this script reports no errormessage if the active source is not yet assembled
 this will probably be improved in a future release, but who cares....

 ******************************************************************************/


OPTIONS RESULTS				/* uups... */


GETPORT				/* get the arexx_port of */
ttx_port = result			/* the active window */
GETFILEPATH				/* get the filepath */
name = result


ADDRESS 'asx_rexx'			/* address asx */
FindID 'TTX:'name			/* find active source */
port = result				/* get its port */


IF port ~='' THEN DO			/* if ther is a port */
  ADDRESS (''||port)			/* address it */
  PrevError				/* get the previous error */
  errortxt = result


  ADDRESS (''||ttx_port)			/* address active window */
  IF errortxt ='' THEN DO			/* if there are no more errors */
    SETSTATUSBAR 'no more errors'		/* write to windowtitlebar */
    exit(0)				/* skip the rest */
    END


  PARSE VALUE errortxt WITH 1 LineNumber ' : ' ErrorMsg         /* get the linenumber and error */
  SHOWFOLDS ALL				/* show folds (to see errors) */
  MOVE LineNumber 1			/* jump to errorline */
  SETSTATUSBAR ErrorMsg			/* write to windowtitlebar */
  END
