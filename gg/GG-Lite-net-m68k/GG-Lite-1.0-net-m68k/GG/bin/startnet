.KEY ADDR,GATEWAY,NETMASK,IFACE
.BRA «
.KET »
.DEF ADDR           192.168.0.100
.DEF GATEWAY        192.168.0.1
.DEF NETMASK        255.255.255.0
.DEF IFACE          none0
; Geek Gadgets Lite AmiTCP version 3 stack initialisation
;
; See  'db/interfaces' for all predefined network adapters!
; Following are three most common these days ethernet NICs:
;
;   ether0 = A2065 ZorroII ethernet adapter
;   3com0  = 3c589 based PCMCIA ethernet adapters
;   cnet0  = NE2000 compatible PCMCIA ethernet adapters
; 

failat 21
path >NIL: add sys:system
path >NIL: add sys:rexxc
rexxmast >NIL:
if `rx "say show(p, AMITCP)"` eq 0
  cardpatch
  cardreset
  mount >NIL: TCP: from AmiTCP:devs/mountlist.tcp
  run <NIL: >NIL: bin:AmiTCP
  waitforport AMITCP
  if not warn
    bin:login >NIL: -f geek
    bin:umask >NIL: 022
    bin:ifconfig lo0 localhost
    bin:route >NIL: add «ADDR» localhost
    if "«IFACE»" not eq "none0"
      bin:ifconfig «IFACE» «ADDR» netmask «NETMASK»
      bin:route >NIL: add default «GATEWAY»
      run >NIL: nicfeed `rx bin:ifextract «IFACE»` 1
    endif
    run >NIL: bin:inetd
  else
    echo "E: AmiTCP did not start for some reason!"
  endif
endif
