.\" Process this file with
.\" groff -man -Tascii fakebo.1
.\"
.TH fakebo 1 "May 1999" Linux "UNIX Reference Manual"


.SH NAME
fakebo \- fake Back Orifice and NetBus trojan server


.SH SYNOPSIS
.BI "fakebo [ -dihbav ] [ -c " config_file " ]"


.SH DESCRIPTION
This file documents version @VERSION@ of
.BR fakebo ,
the fake Back Orifice (BO) and NetBus server for Linux and other Unices.

Have you ever wanted to know who is trying to access your computer
with Back Orifice or NetBus? This program fakes these trojan servers and
logs every connection from their clients. Connections can be logged to a
file, to stdout, to stderr or to syslog.
.B fakebo
can also send fake pings and replies back to the trojan client.

.B fakebo
can emulate a BO server with three possible levels of realism:
.IP "RealFakeBO"
If the option
.I userealfakebo
is turned on in the configuration file,
.B fakebo
will do its best to emulate a real BO server.
.IP "Custom replies"
If the option
.I usecustomreplies
is turned on,
.B fakebo
will send to the client a different message for each type of incoming
packet received. The messages sent in replies are specified by the user
in separate files (see section CUSTOM REPLIES).
If RealFakeBO is turned on, custom replies will not be used unless the
built-in RealFake server fails to produce a reply.
.IP "Fixed reply"
If both previous methods either fail or are configured out,
.B fakebo
will send to the client the message specified under
.I bomessage
in the configuration file, whatever the incoming packet may be.

.PP
You may want to auto start
.B fakebo
when you connect to the Net via PPP. To do that, just
put "fakebo" in
.IR /etc/ppp/ip-up ,
and it will run
.B fakebo
when PPP is activated. Don't forget to put something like "killall 
fakebo" in 
.IR /etc/ppp/ip-down ...


.SH OPTIONS
.IP "-c config_file"
Path to the configuration file. If this option is omitted,
.B fakebo
will search a file named
.I fakebo.conf
in the following directories:
.IR /etc ", " /usr/local/etc ", " $HOME " and " . " "
(the current directory).
.IP -v
Turn on verbose logging.
.IP -d
Print to stderr the configuration parameters. This option is for
debugging purposes.
.IP -i
Log the BO packet numbers together with their description, otherwise only
the description is logged. This option is for debugging purposes.
.IP -b
Start fakebo as a daemon. When started with this option,
.B fakebo
closes all file descriptors, disassociates itself from the controlling
terminal and puts itself in the background.
.IP -a
Print an "about" message and exit.
.IP -h
Print a short summary of options and exit.


.SH "CONFIGURATION FILE"
The configuration file is a simple plain text file.
Lines beginning with `#' and empty lines are treated as comments. Each
command is a couple
.IR "keyword value" .
Values can be either strings (enclosed in double quotes unless otherwise
stated), integers or booleans. A boolean is an integer which can be 0
(zero) for turning the option off or 1 for turning it on.
.IP "user \fIstring\fP"
If
.B fakebo
is started by root, it will su to the user specified here after opening
the log file. This is intended to avoid compromising the system, should
the program have any security hole. If custom replies are used, the user
owning the
.B fakebo
process must have read access to the files containing the replies.
.IP "boport \fIinteger\fP"
The UDP port to listen for BO connections. The default port is 31337, it
is also the default port in BO itself. In fact,
.I boport
can also be the name of an UDP port (as defined in
.IR /etc/services )
without quotes.
.IP "nbport \fIinteger\fP"
The UDP port to listen for NetBus connections.
.IP "startasdaemon \fIboolean\fP"
Start
.B fakebo
as a daemon. This has the same effect as the -b option.
.IP "bofakever \fIstring\fP"
Fake BO version (not longer than 10 characters).
it's used for sending BO version when
.I sendfakereply
is on.  Now you can fool attacker that you have a computer infected with
a newer version of BO... ;)
.IP "nbfakever \fIstring\fP"
Fake NetBus version (not longer than 10 characters). This is sent to the
client in the greeting message.
.IP "bomessage \fIstring\fP"
Message which will be sent to BO client if both RealFakeBO or custom
replies either fail or are configured out.
.IP "nbmessage \fIstring\fP"
Message which will be sent to NetBus client when accessed.
.IP "logfile \fIstring\fP"
File where all attempts are logged (full path). stdout stands for
STandarD OUTput, stderr stands for STandarD ERRor.
.IP "user \fIstring\fP"
user who should own the process if started by root
.IP "logconnection \fIboolean\fP"
If you want to log IP where it comes from and what type of packet is.
.IP "logreceivedpackets \fIinteger\fP"
There are 5 possible values (0, 1, 2, 3, 4) for logging received packets:
0: do not log,
1: log only command
2: log command & data fields (most common)
3: log command, data and header fields (for debugging purposes).
4 - log packet hex dump, along with everything from above
.IP "logsendingpackets \fIinteger\fP"
There are 4 possible values (0, 1, 2, 3) for logging packets to send:
0: do not log,
1: log only command,
2: log command & data fields (most common),
3: log command, data and header fields (for debugging purposes).
.IP "lognotbopackets \fIboolean\fP"
If you want to log contents of non-BO packets.
.IP "sendfakereply \fIboolean\fP"
If you want to send fake replies to pings from the client
(it will display a message as if you had BO).
Very useful to set when somebody sweeps your domain and you
want him to believe that you have BO server installed.
.IP "machinename \fIstring\fP"
Used for fake ping replies for forming fake ping packet. This must be a
single word.
.IP "logtimeanddate \fIboolean\fP"
Log time and date of received packet.
.IP "silentmode \fIboolean\fP"
Make it silent.
If this option is set
.B fakebo
will not answer the message back to BO client.
Note that pings will still be replied back to the client. Turn off
.I sendfakereply
if you want to make
.B fakebo
completely silent (very useful if
you don't want that public knows that their activity is logged).
.IP "bufferedlogging \fIboolean\fP"
This option is used for turning on or off buffered output to log file.
.B fakebo
runs a little faster if buffering is on. I recommend not to use
buffering.
.IP "logtosyslog \fIinteger\fP"
May be:
0: do not log via syslog,
1: log via syslog,
2: log via syslog verbosely.
.IP "toexecutescript \fIboolean\fP"
If you set this option,
.B fakebo
will execute the program which you specify under parameter 
.I executescript
(see below) when it receives 
the BO packet.
It is a sort of plug-in, so you can do everything you want with his
IP. You can for example run whois, finger, traceroute or something
else, but putting nuke, or land or some similar attack in the script is
not very smart (then you're like the one attacking you!)
.IP "executescriptshell \fIstring\fP"
Path to the shell that will be used to expand command line parameters
when running a custom script. The shell must accept the `-c' option.
.IP "executescript \fIstring\fP"
This parameter is only used when
.I toexecutescript
is set.  In this case,
.B fakebo
will execute the command line you specify here. A `!' in the command
line will be replaced by the IP of the attacker. If you want to insert a
literal `!', you have to type `\\!'. You can put here several commands
separated by a `;', like in the shell.
Likewise, a `%' will be replaced by the text `backorifice' or `netbus',
depending upon which trojan originated the attack.
.IP "usecustomreplies \fIboolean\fP"
With this you can specify for every BO command a different answer
to the attacker. It's very useful if you want to make him believe he 
is doing everything right.
Note: if option
.I silentmode
is on, this parameter is ignored.
See the next section for details on custom replies.
.IP "customrepliespath \fIstring\fP"
For every client command you can specify a different answer to the
attacker.  You just have to make the text file for every command.
The hexadecimal identification of the command is added to the path.
If option
.I usecustomreplies
is off, this parameter doesn't have any effect.  If the file for some
command cannot be found, then a generic message is used
.RI ( message
parameter).
.IP "tocrackpackets \fIboolean\fP"
Try to crack BO packets with password and log encryption key. It takes
less than a second to crack the password on average Pentium. If you're
low on CPU resources you should say no (0) here.
.IP "ignorehost \fIstring\fP"
If set to anything else than "NONE",
.B fakebo
will ignore connections from the specified host. 
.IP "userealfakebo \fIboolean\fP"
If set,
.B kakebo
will use its built-in
.BR RealFake (tm)
BO server to properly emulate responses to the BO client, and hopefully
REALLY confuse them... Don't worry, it may look real, but it is as
harmless as a crax0r using a windoze box.


.SH "CUSTOM REPLIES"
When option
.I usecustomreplies
is set in the configuration file and RealFakeBO either fails or is
configured out,
.B fakebo
will send the contents of a file in reply to each command.  The name of
the file is obtained by appending the hexadecimal value of the command
to the prefix specified in parameter
.IR customrepliespath .
For example:
let's say you set
.I customrepliespath
to "/etc/fakebo/reply." and you want to have a special answer when the
attacker issues the command "get System Information" (hex value 04).
Then you just have to write your message in
.IR /etc/fakebo/reply.04 ...
and keep watching the confused attacker. ;-)

Don't forget to make these files readable by the user owning the
.B fakebo
process
.RI ( user
parameter in the configuration file).

The hex values associated with the commands are:

.IP 02
System Reboot
.IP 03
System Lock Up
.IP 04
List System Passwords
.IP 05
View Console
.IP 06
Get System Information
.IP 07
Log Pressed Keys
.IP 08
Send KeyPress Log
.IP 09
Show A Dialog Box
.IP 0A
Delete A Value from The Registry
.IP 0B
Create TCP redirection (proxy)
.IP 0C
Delete TCP redirection
.IP 0D
List TCP redirections
.IP 0E
Start Application
.IP 0F
End Application
.IP 10
Export a share resource
.IP 11
Cancel share export
.IP 12
Show Export List
.IP 13
Resend Packet
.IP 14
Enable HTTP Server
.IP 15
Disable HTTP Server
.IP 16
Resolve Host Name
.IP 17
Compress a File
.IP 18
Uncompress a File
.IP 19
Plug-in execute
.IP 1A
(unknown)
.IP 1B
(unknown)
.IP 1C
(unknown)
.IP 1D
(unknown)
.IP 1E
(unknown)
.IP 1F
(unknown)
.IP 20
Show active processes
.IP 21
Kill a process
.IP 22
Start a process
.IP 23
Create a key in the registry
.IP 24
Set the Value of a key in registry
.IP 25
Delete a key in registry
.IP 26
Enumerate registry keys
.IP 27
Enumerate registry values
.IP 28
Capture a static image
.IP 29
Capture a video stream
.IP 2A
Play a sound file
.IP 2B
Show Available Video capture devices
.IP 2C
Capture the screen to a file
.IP 2D
Start sending a file using TCP
.IP 2E
Start receiving a file using TCP
.IP 2F
List (running) plug-ins
.IP 30
Kill Plugin
.IP 31
List directory
.IP 32
(unknown)
.IP 33
(unknown)
.IP 34
Find a file
.IP 35
Delete a file
.IP 36
View file contents
.IP 37
Rename a file
.IP 38
Copy a file
.IP 39
List all network devices
.IP 3A
Connect to network resource
.IP 3B
End connection of a network resource
.IP 3C
Show NetWork Connections
.IP 3D
Create Directory (folder)
.IP 3E
Remove directory
.IP 3F
Show Running Applications


.SH FILES
.I @prefix@/etc/fakebo.conf
.RS
Default configuration file.


.SH AUTHORS
The original author and current maintainer of
.B fakebo
is
Vlatko Kosturjak - KoSt <kost@iname.com>, <http://surf.to/kost>

Code, ideas, spelling... were contributed by (in completely random order):
Robert Avilov - DryLLaR <ravilov@barok.foi.hr>,
Edgar Bonet Orozco <edgar@bonet.polycnrs-gre.fr>,
Olaf Tuinder <olaf@warserver.warande.uu.nl>,
Hans Jorgensen <borisj@get2net.dk>,
Sinisa Lolic <vegi@usa.net>,
Marcus Herbert - rhoenie <rhoenie@rhohost.chillout.org>,
Jwit <jwit@sinnerz.com>,
Folkert van Heusden <flok99@dds.nl> and
Bjoern Bendix <bbendix@primusnetz.de>,
Dezso E. Moldvai - MDE <mde@thepentagon.com>,
Mike Kershaw <dragorn@melchior.nerv-un.net>,
c.o.d @ WLU,
Wolfram Kleff <wkleff@bigfoot.com>,
Michiel Steltman <Michiel.Steltman@siennax.com>,
Doug Schieferstine <doschie@global2000.net>,
Javi Polo <javipolo@infomail.lacaixa.es>,
Jochem Wichers Hoeth <wiho@chem.uva.nl>,
Ian Kumlien <iank@smi.mas.lu.se>,
Miodrag Vallat <miodrag@multimania.com>,
Norman Meilick <alvin@gmx.de>,
J. Padfield <olorin@netlink.com.au>,
Marc Quinton <Marc.Quinton@stna.dgac.fr>,
Dop Ganger <dop@fop.ns.ca>,
Michael <nouse@gmx.de>,
Ian Bishop <ibishop@globec.com.au>,
Groovy Pants Gus <gus@SB7.YOONIX.NET>,
Gerald Swann <gswann@pompano.pcola.gulf.net>,
Eric Hedberg <hedberge@gridley.acns.CARLETON.edu>,
Gregory T. Norris <haphazard@socket.net>,
Robert Szarka <szarka@downcity.net>,
Michel Arboi <arboi@bigfoot.com>,
David Grant <dave@reach.net>,
Scott Edwards <scott.edwards@iname.com>,
Martin Kammerhofer <dada@sbox.tu-graz.ac.at>,
Michel Kaempf <maxx@via.ecp.fr>,
Chris Knipe <savage@savage.za.org>,
Justin Wienckowski <jwiencko@vt.edu>,
Daniel P. Stasinski <dannys@karemor.com>,
Larry Reckner <larryr@Capital.NET>,
Ivan Brozovic <ibrozovi@linux.hr>,
Dobrica Pavlinusic <dpavlin@foi.hr>
and others...

.SH COPYRIGHT
Copyright \(co 1999 Vlatko Kosturjak.

.B fakebo
is free software; you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation; either version 2 of the License, or
(at your option) any later version.

.B fakebo
is distributed in the hope that it will be useful, but
.IR "without any warranty" ;
without even the implied warranty of
.I merchantability
or
.IR "fitness for a particular purpose" .
See the License for more details.

You should have received a copy of the GNU General Public License along
with
.BR fakebo ;
see the file COPYING.  If not, write to the Free Software Foundation,
Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA


.SH AVAILABILITY
The most recent released version of
.B fakebo
is always available from <http://cvs.linux.hr/fakebo/>
