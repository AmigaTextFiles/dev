.TH smssend.scripting 1 "october 26th 2001" "Version @VERSION@"
.SH NOM
smssend \- The sms sender (to GSM)
.SH SYNOPSYS
How to make a script for \fBsmssend\fP.

.SH DESCRIPTION
The scripts for \fBSmssend\fP are easy to make, but you'll have to follow some steps.
First, I suggest you use a tool like \fItcpdump\fP or \fIethereal\fP, to trace the output traffic
of your box. So, use your usual navigator and connect to the site you wish to make a script for, and
send a sms (do all this while tracing output). With this, you'll have the URL to call, and the parameters
to use (even the POST parameters).
You are now ready to write your script (see an example at the end of this man page) :
The line starting with a # are comments.
On the first line, give the site's name.
On the second, give the version number of your script (#Version x.xx). This is really important,
because \fBsmssend\fP uses this line to detect new version of the script.
On the third line, give your name and email address.
On the following lines, give the error messages that can happen running the script, with their number.
Then, give the arguments the script will be waiting for, then aliases, and finnaly the commands.

.SS ARGUMENTS
First, you must give a line with the number of arguments (NbParams x).
An argument line starts with a % and must be like this : %Name [Type] : Help message

Here are the different types
.TP
Hidden
Tells this argument is a password and must be hidden.
.TP
Convert
Tells that this argument must be converted (space are converted to +, and non alphanum are converted to ascii code).
.TP
Size=xx
Gives the maximum size are this argument in characters (for message, there is often a max size).
.SS ALIAS
Aliases are very useful, and are used next for dynamic replacement (you'll soon understand).
An alias line starts with a $ and must be like this : $Argument alias
Argument being the name of an existing argument (case non sensitive) and alias the name to search when replacing <input> tags.
.SS COMMANDS
One command per line. \fBSmsSend\fP defines blocs of commands (or phases) which are GET or POST requests.
Each bloc must ABSOLUTELY starts with one of the GetURL or PostURL command, and ends with a GO, and must contain only
ONE of these command.
Between this two lines, you can add all optional commands as you wish.
You can also (and you'll have to anyway) substitution commands (see next chapter).
.TP
GetURL <url> and PostURL <url>
One and only one of these command per bloc, followed by the \fIurl\fP to fetch without parameters and without the '?' (parameters are what is after a '?' in an URL) !!
.TP
Params <parameters>
Gives the \fIparameters\fP associated with the URL to fetch (what is after a '?' in an URL), but without the '?'.
.TP
Referer <referer>
Gives the \fIreferer\fP of this url (some pages check if the Referer is correctly set).
.TP
PostData <data>
Gives \fIdata\fP from a form to send (must be used with PostURL).
.TP
Sleep <delay>
Tells the soft to make a sleep of \fIdelay\fP secondes before sending this request.
.TP
NoAdd <Name>
Tells the soft not to add the INPUT tag of \fIName\fP in the RTGetForm command of the same bloc.
.TP
SetCookie <Phase> <Domain>-<Path>-<Name>=<Value>
Adds a static cookie for \fIPath\fP (not NULL, use / for whole path) in \fIDomain\fP : \fIName\fP=\fIValue\fP.
The cookie will be added starting at \fIPhase\fP (the first one is 1).
.TP
GO
Marks the end of a bloc.
.TP
Search <text>
Tells the soft to look for \fItext\fP in the response of our sent request. Must be followed be ErrorMsg or PrintMsg.
Only ONE Search per bloc (for more searches, use ElseSearch after this one).
.TP
ElseSearch <text>
Tells the soft that there are more than one search to perform (Do not forget to use a Search before this ElseSearch).
Must be followed by ErrorMsg or PrintMsg.
.TP
Else
Tells the soft what to do if no search matched. Must be followed by ErrorMsg or PrintMsg.
.TP
ErrorMsg <num> <message>
Tells the soft to display \fImessage\fP before exiting with the error code \fInum\fP, if the search matched.
.TP
PrintMsg <message>
Tells the soft to display \fImessage\fP before continuing, if the search matched.

.SH DYNAMIC REPLACEMENTS
Here comes what is the more powerful with \fBSmsSend\fP : dynamic replacements.
a Dynamic replacements is defined like this : \%Name[-param]*%
The name must be the name of an argument (no alias in name !), or the name of an internal command.
Most internal commands requiere parameters, wich are separated by '-'.
Here is the list of these commands :
.TP
RTURL-<num>
Replaces the URL which was sent during phase \fInum\fP (the first phase being 1, and automatic redirect being counted).
.TP
RTParams-<num>
Replaces the data which was sent during phase \fInum\fP (the first phase being 1, and automatic redirect being counted).
.TP
RTHost-<num>
Replaces the hostname which was used during phase \fInum\fP (the first phase being 1, and automatic redirect being counted).
.TP
RTFollowLink-<num>-<name>
Replaces with URL of link \fIname\fP searched in the result from phase \fInum\fP (the first phase being 1, and automatic redirect being counted).
.TP
RTGetInput-<num>-<name>
Replaces with the VALUE field of the INPUT tag of NAME \fIname\fP searched in the result from phase \fInum\fP (the first phase being 1, and automatic redirect being counted).
.TP
RTFormAction-<num>-<ind>
Replaces with the ACTION field of the form \fIind\fP (the first form being 0) searched in the result from phase \fInum\fP (the first phase being 1, and automatic redirect being counted).
.TP
RTGetForm-<num>-<ind>
Replaces with ALL INPUTs (NAME=VALUE) of the form \fIind\fP (the first form being 0) searcged in the result from phase \fInum\fP (the first phase being 1, and automatic redirect being counted).
Except for all replacements already made (in the SAME command) if the NAME field of the INPUT tag in found in the replacements done (aliases are very useful here, if the NAME field have an awful
name, and we wish to replace it with the Login argument of the script for example). In the same way, all NoAdd values defined in the same bloc are not added.
.TP
RTGetString-<num>-<textBefore>
Replaces with string found juste after \fItextBefore\fP (after removing spaces and string delimiters) searched in the result from phase \fInum\fP.
.TP
RTSubURL-<num>-<sub>
Replaces with \fIsub\fP th sub part (a sub part is delimited by a /, the first one is just after domain name) searched in the url from phase \fInum\fP.
.TP
RTFollowFrame-<num>-<name>
Replaces with url of frameset of \fIname\fP searched in the result from phase \fInum\fP.
.SH EXAMPLE
Here is a script example of \fBsmssend\fP :
.nf

## SkySMS provider file - www.kiwee.com ##
# Version 1.03
# by Ze KiLleR <zekiller@skytech.org>
# Error codes :
#  1 -> Bad Login/Password
#  2 -> Daily message quota exceeded
#  3 -> ASP/SQL timeout
#  4 -> Error sending message

NbParams 5
%Login : Your login from www.kiwee.com
%Password Hidden : Your password
%Pseudo : Kiwee Pseudo of recipient
%Type : Type of sms : 0 (flash sms) or 2 (normal sms)
%Message Size=125 Convert : Your message

# Logging on Kiwee
GetURL http://www.kiwee.com/sms/
GO
PostURL http://www.kiwee.com/Verifmembre.asp
PostData LoginName=\%Login%&Password=\%Password%
Search  votre pseudo et/ou votre mot de passe
ErrorMsg 1 Bad login and/or password
GO
GetURL http://www.kiwee.com/sms/
GO

# Sending message
PostURL http://www.kiwee.com/sms/sendsms.asp
Params previous=sms.asp
Referer http://www.kiwee.com/sms/
PostData from=\%Login%&topseudo=\%Pseudo%&PhoneNumber=&class=\%Type%&message=\%Message%&arandom=2

Search confirmsms.html
PrintMsg Message successfully sent
ElseSearch atteint votre limite d'envoi
ErrorMsg 2 Daily message quota exceeded
ElseSearch Timeout expired
ErrorMsg 3 ASP/SQL timeout
Else
ErrorMsg 4 Error sending message
GO
.SH SEE ALSO
\fBsmssend\fP(1)
.SH COPYRIGHTS
Copyright (c) 2000'01 - Christophe "Ze KiLleR" Calmejane
<zekiller@skytech.org>


Distributed under GNU General Public License v2;
see COPYING file for more informations.
.SH AUTHORS
Christophe "Ze KiLleR" Calmejane <zekiller@skytech.org>

.sp
