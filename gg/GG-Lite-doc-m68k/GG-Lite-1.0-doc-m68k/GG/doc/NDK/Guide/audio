@DATABASE "gg:doc/NDK/Guide/audio"
@MASTER   "gg:doc/NDK/AutoDocs/audio.doc"
@REMARK   This file was created by ADtoHT 2.1 on 06-Jan-13 19:19:19
@REMARK   Do not edit
@REMARK   ADtoHT is © 1993-1995 Christian Stieber

@NODE MAIN "audio.doc"
@TOC "gg:doc/NDK/Guide/TOC/MAIN"

                                @{b}audio.device@{ub}

@{"AbortIO()" LINK "AbortIO"}   @{"ADCMD_ALLOCATE" LINK "ADCMD_ALLOCATE"}  @{"ADCMD_FINISH" LINK "ADCMD_FINISH"}   @{"ADCMD_FREE" LINK "ADCMD_FREE"}
@{"ADCMD_LOCK" LINK "ADCMD_LOCK"}  @{"ADCMD_PERVOL" LINK "ADCMD_PERVOL"}    @{"ADCMD_SETPREC" LINK "ADCMD_SETPREC"}  @{"ADCMD_WAITCYCLE" LINK "ADCMD_WAITCYCLE"}
@{"BeginIO()" LINK "BeginIO"}   @{"CloseDevice()" LINK "CloseDevice"}   @{"CMD_CLEAR" LINK "CMD_CLEAR"}      @{"CMD_FLUSH" LINK "CMD_FLUSH"}
@{"CMD_READ" LINK "CMD_READ"}    @{"CMD_RESET" LINK "CMD_RESET"}       @{"CMD_START" LINK "CMD_START"}      @{"CMD_STOP" LINK "CMD_STOP"}
@{"CMD_UPDATE" LINK "CMD_UPDATE"}  @{"CMD_WRITE" LINK "CMD_WRITE"}       @{"Expunge()" LINK "Expunge"}      @{"OpenDevice()" LINK "OpenDevice"}

@ENDNODE
@NODE "AbortIO" "audio.device/AbortIO()"
@{b}

   NAME@{ub}
       @{"AbortIO" LINK "gg:doc/NDK/Guide/exec/AbortIO"} - abort a device command@{b}

   SYNOPSIS@{ub}
       @{"AbortIO" LINK "gg:doc/NDK/Guide/exec/AbortIO"}(iORequest);
                   A1@{b}

   FUNCTION@{ub}
       @{"AbortIO" LINK "gg:doc/NDK/Guide/exec/AbortIO"} tries to abort a device command.  It is allowed to be
       unsuccessful.  If the Abort is successful, the io_Error field of the
       iORequest contains an indication that IO was aborted.@{b}

   INPUTS@{ub}
       iORequest -- pointer to the I/O Request for the command to abort

@ENDNODE
@NODE "ADCMD_ALLOCATE" "audio.device/ADCMD_ALLOCATE"

       @{"ADCMD_ALLOCATE" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 30} -- allocate a set of audio channels@{b}

   FUNCTION@{ub}
       @{"ADCMD_ALLOCATE" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 30} is a command that allocates multiple audio channels.
       @{"ADCMD_ALLOCATE" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 30} takes an array of possible channel combinations
       (ioa_Data) and an allocation precedence (ln_Pri) and tries to allocate
       one of the combinations of channels.

       If the channel combination array is zero length (ioa_Length), the
       allocation succeeds; otherwise, @{"ADCMD_ALLOCATE" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 30} checks each
       combination, one at a time, in the specified order, to find one
       combination that does not require @{"ADCMD_ALLOCATE" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 30} to steal allocated
       channels.

       If it must steal allocated channels, it uses the channel combination
       that steals the lowest precedence channels.

       @{"ADCMD_ALLOCATE" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 30} cannot steal a channel of equal or greater precedence
       than the allocation precedence (ln_Pri).

       If it fails to allocate any channel combination and the no-wait flag
       (@{"ADIOF_NOWAIT" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 37}) is set @{"ADCMD_ALLOCATE" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 30} returns a zero in the unit field
       of the I/O request (io_Unit) and an error (IOERR_ALLOCFAILED).  If the
       no-wait flag is clear, it places the I/O request in a list that tries
       to allocate again whenever @{"ADCMD_FREE" LINK "ADCMD_FREE"} frees channels or @{"ADCMD_SETPREC" LINK "ADCMD_SETPREC"}
       lowers the channels' precedences.

       If the allocation is successful, @{"ADCMD_ALLOCATE" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 30} checks if any channels
       are locked (@{"ADCMD_LOCK" LINK "ADCMD_LOCK"}) and if so, replies (@{"ReplyMsg" LINK "gg:doc/NDK/Guide/exec/ReplyMsg"}) the lock I/O
       request with an error (@{"ADIOERR_CHANNELSTOLEN" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 43}). Then it places the
       allocation I/O request in a list waiting for the locked channels to be
       freed.  When all the allocated channels are un-locked, @{"ADCMD_ALLOCATE" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 30}:
         . resets (@{"CMD_RESET" LINK "CMD_RESET"}) the allocated channels,
         . generates a new allocation key (ioa_AllocKey), if it is zero,
         . copies the allocation key into each of the allocated channels
         . copies the allocation precedence into each of the allocated
           channels, and
         . copies the channel bit map into the unit field of the I/O request.

       If channels are allocated with a non-zero allocation key,
       @{"ADCMD_ALLOCATE" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 30} allocates with that same key; otherwise, it generates a
       new and unique key.

       @{"ADCMD_ALLOCATE" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 30} is synchronous:
         . if the allocation succeeds and there are no locked channels to be
           stolen, or
         . if the allocation fails and the no-wait flag is set.

       In either case, @{"ADCMD_ALLOCATE" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 30} only replies (mn_ReplyPort) if the
       quick flag (@{"IOF_QUICK" LINK "gg:doc/NDK/Guide/Include/exec/io.h/File" 46}) is clear; otherwise, the allocation is
       asynchronous, so it clears the quick flag and replies the I/O request
       after the allocation is finished.  If channels are stolen, all audio
       device commands return an error (IOERR_NOALLOCATION) when the former
       user tries to use them again.  Do not use @{"ADCMD_ALLOCATE" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 30} in interrupt
       code.

       If you decide to store directly to the audio hardware registers, you
       must either lock the channels you've allocated, or set the precedence
       to maximum (@{"ADALLOC_MAXPREC" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 22}) to prevent the channels from being
       stolen.

       Under all circumstances, unless channels are stolen, you must free
       (@{"ADCMD_FREE" LINK "ADCMD_FREE"}) all allocated channels when you are finished using them.@{b}

   INPUTS@{ub}
       ln_Pri      - allocation precedence (-128 thru 127)
       mn_ReplyPort- pointer to message port that receives I/O request after
                     the allocation completes is asynchronous or quick flag
                     (ADIOF_QUICK) is set
       io_Device   - pointer to device node, must be set by (or copied from
                     I/O block set by) @{"OpenDevice" LINK "OpenDevice"} function
       io_Command  - command number for @{"ADCMD_ALLOCATE" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 30}
       io_Flags    - flags, must be cleared if not used:
                     @{"IOF_QUICK" LINK "gg:doc/NDK/Guide/Include/exec/io.h/File" 46}   - (CLEAR) reply I/O request
                                   (SET) only reply I/O request only if
                                         asynchronous (see above text)
                     @{"ADIOF_NOWAIT" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 37}- (CLEAR) if allocation fails, wait till is
                                           succeeds
                                   (SET) if allocation fails, return error
                                         (@{"ADIOERR_ALLOCFAILED" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 42})
       ioa_AllocKey- allocation key, zero to generate new key; otherwise,
                     it must be set by (or copied from I/O block set by)
                     @{"OpenDevice" LINK "OpenDevice"} function or previous @{"ADCMD_ALLOCATE" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 30} command
       ioa_Data    - pointer to channel combination options (byte array, bits
                     0 thru 3 correspond to channels 0 thru 3)
       ioa_Length  - length of the channel combination option array
                     (0 thru 16, 0 always succeeds)@{b}

   OUTPUTS@{ub}
       io_Unit     - bit map of successfully allocated channels (bits 0 thru
                     3 correspond to channels 0 thru 3)
       io_Flags    - @{"IOF_QUICK" LINK "gg:doc/NDK/Guide/Include/exec/io.h/File" 46} flag cleared if asynchronous (see above text)
       io_Error    - error number:
                     0                   - no error
                     @{"ADIOERR_ALLOCFAILED" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 42} - allocation failed
       ioa_AllocKey- allocation key, set to a unique number if passed a zero
                     and command succeeds

@ENDNODE
@NODE "ADCMD_FINISH" "audio.device/ADCMD_FINISH"
@{b}

   NAME@{ub}
       @{"ADCMD_FINISH" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 26} -- abort writes in progress to audio channels@{b}

   FUNCTION@{ub}
       @{"ADCMD_FINISH" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 26} is a command for multiple audio channels.  For each
       selected channel (io_Unit), if the allocation key (ioa_AllocKey) is
       correct and there is a write (@{"CMD_WRITE" LINK "CMD_WRITE"})in progress, @{"ADCMD_FINISH" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 26}
       aborts the current write immediately or at the end of the current
       cycle depending on the sync flag (@{"ADIOF_SYNCCYCLE" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 35}).  If the allocation
       key is incorrect @{"ADCMD_FINISH" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 26} returns an error (@{"ADIOERR_NOALLOCATION" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 41}).
       @{"ADCMD_FINISH" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 26} is synchronous and only replies (mn_ReplyPort) if the
       quick flag (@{"IOF_QUICK" LINK "gg:doc/NDK/Guide/Include/exec/io.h/File" 46}) is clear.  Do not use @{"ADCMD_FINISH" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 26} in interrupt
       code at interrupt level 5 or higher.@{b}

   INPUTS@{ub}
       mn_ReplyPort- pointer to message port that receives I/O request
                     if the quick flag (@{"IOF_QUICK" LINK "gg:doc/NDK/Guide/Include/exec/io.h/File" 46}) is clear
       io_Device   - pointer to device node, must be set by (or copied from
                     I/O block set by) @{"OpenDevice" LINK "OpenDevice"} function
       io_Unit     - bit map of channels to finish (bits 0 thru 3 correspond
                     to channels 0 thru 3)
       io_Command  - command number for @{"ADCMD_FINISH" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 26}
       io_Flags    - flags, must be cleared if not used:
                     @{"IOF_QUICK" LINK "gg:doc/NDK/Guide/Include/exec/io.h/File" 46}      - (CLEAR) reply I/O request
                     @{"ADIOF_SYNCCYCLE" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 35}- (CLEAR) finish immediately
                                      (SET) finish at the end of current
                                            cycle

       ioa_AllocKey- allocation key, must be set by (or copied from I/O block
                     set by) @{"OpenDevice" LINK "OpenDevice"} function or @{"ADCMD_ALLOCATE" LINK "ADCMD_ALLOCATE"} command@{b}

   OUTPUTS@{ub}
       io_Unit     - bit map of channels successfully finished (bits 0 thru 3
                     correspond to channels 0 thru 3)
       io_Error    - error number:
                     0                    - no error
                     @{"ADIOERR_NOALLOCATION" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 41} - allocation key (ioa_AllocKey)
                                            does not match key for channel

@ENDNODE
@NODE "ADCMD_FREE" "audio.device/ADCMD_FREE"
@{b}

   NAME@{ub}
       @{"ADCMD_FREE" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 24} -- free audio channels for allocation@{b}

   FUNCTION@{ub}
       @{"ADCMD_FREE" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 24} is a command for multiple audio channels.  For each
       selected channel (io_Unit), if the allocation key (ioa_AllocKey) is
       correct, @{"ADCMD_FREE" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 24} does the following:
         . restores the channel to a known state (@{"CMD_RESET" LINK "CMD_RESET"}),
         . changes the channels allocation key, and
         . makes the channel available for re-allocation.
         . If the channel is locked (@{"ADCMD_LOCK" LINK "ADCMD_LOCK"}) @{"ADCMD_FREE" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 24} unlocks it and
           clears the bit for the channel (io_Unit) in the lock I/O request.
           If the lock I/O request has no channel bits set @{"ADCMD_FREE" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 24} replies
           the lock I/O request, and
         . checks if there are allocation requests (@{"ADCMD_ALLOCATE" LINK "ADCMD_ALLOCATE"}) waiting
           for the channel.

       Otherwise, @{"ADCMD_FREE" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 24} returns an error (@{"ADIOERR_NOALLOCATION" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 41}).
       @{"ADCMD_FREE" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 24} is synchronous and only replies (mn_ReplyPort) if the quick
       flag (@{"IOF_QUICK" LINK "gg:doc/NDK/Guide/Include/exec/io.h/File" 46}) is clear.  Do not use @{"ADCMD_FREE" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 24} in interrupt code.@{b}

   INPUTS@{ub}
       mn_ReplyPort- pointer to message port that receives I/O request
                     if the quick flag (@{"IOF_QUICK" LINK "gg:doc/NDK/Guide/Include/exec/io.h/File" 46}) is clear
       io_Device   - pointer to device node, must be set by (or copied from
                     I/O block set by) @{"OpenDevice" LINK "OpenDevice"} function
       io_Unit     - bit map of channels to free (bits 0 thru 3 correspond to
                     channels 0 thru 3)
       io_Command  - command number for @{"ADCMD_FREE" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 24}
       io_Flags    - flags, must be cleared if not used:
                     @{"IOF_QUICK" LINK "gg:doc/NDK/Guide/Include/exec/io.h/File" 46} - (CLEAR) reply I/O request
       ioa_AllocKey- allocation key, must be set by (or copied from I/O block
                     set by) @{"OpenDevice" LINK "OpenDevice"} function or @{"ADCMD_ALLOCATE" LINK "ADCMD_ALLOCATE"} command@{b}

   OUTPUTS@{ub}
       io_Unit     - bit map of channels successfully freed (bits 0 thru 3
                     correspond to channels 0 thru 3)
       io_Error    - error number:
                     0                    - no error
                     @{"ADIOERR_NOALLOCATION" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 41} - allocation key (ioa_AllocKey)
                                            does not match key for channel

@ENDNODE
@NODE "ADCMD_LOCK" "audio.device/ADCMD_LOCK"
@{b}

   NAME@{ub}
       @{"ADCMD_LOCK" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 28} -- prevent audio channels from being stolen@{b}

   FUNCTION@{ub}
       @{"ADCMD_LOCK" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 28} is a command for multiple audio channels.  For each
       selected channel (io_Unit), if the allocation key (ioa_AllocKey) is
       correct, @{"ADCMD_LOCK" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 28} locks the channel, preventing subsequent
       allocations (@{"ADCMD_ALLOCATE" LINK "ADCMD_ALLOCATE"} or @{"OpenDevice" LINK "OpenDevice"}) from stealing the channel.
       Otherwise, @{"ADCMD_LOCK" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 28} returns an error (@{"ADIOERR_NOALLOCATION" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 41}) and will
       not lock any channels.

       Unlike setting the precedence (@{"ADCMD_SETPREC" LINK "ADCMD_SETPREC"}, @{"ADCMD_ALLOCATE" LINK "ADCMD_ALLOCATE"} or
       @{"OpenDevice" LINK "OpenDevice"}) to maximum (@{"ADALLOC_MAXPREC" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 22}) which would cause all
       subsequent allocations to fail, @{"ADCMD_LOCK" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 28} causes all higher
       precedence allocations, even no-wait (@{"ADIOF_NOWAIT" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 37}) allocations, to
       wait until the channels are un-locked.

       Locked channels can only be unlocked by freeing them (@{"ADCMD_FREE" LINK "ADCMD_FREE"}),
       which clears the channel select bits (io_Unit).  @{"ADCMD_LOCK" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 28} does not
       reply the I/O request (mn_ReplyPort) until all the channels it locks
       are freed, unless a higher precedence allocation attempts to steal one
       the locked channels. If a steal occurs, @{"ADCMD_LOCK" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 28} replies and returns
       an error (@{"ADIOERR_CHANNELSTOLEN" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 43}).  If the lock is replied
       (mn_ReplyPort) with this error, the channels should be freed as soon
       as possible.  To avoid a possible deadlock, never make the freeing of
       stolen channels dependent on another allocations completion.

       @{"ADCMD_LOCK" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 28} is only asynchronous if the allocation key is correct, in
       which case it clears the quick flag (@{"IOF_QUICK" LINK "gg:doc/NDK/Guide/Include/exec/io.h/File" 46}); otherwise, it is
       synchronous and only replies if the quick flag (@{"IOF_QUICK" LINK "gg:doc/NDK/Guide/Include/exec/io.h/File" 46}) is clear.
       Do not use @{"ADCMD_LOCK" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 28} in interrupt code.@{b}

   INPUTS@{ub}
       mn_ReplyPort- pointer to message port that receives I/O request
                     if the quick flag (@{"IOF_QUICK" LINK "gg:doc/NDK/Guide/Include/exec/io.h/File" 46}) is clear
       io_Device   - pointer to device node, must be set by (or copied from
                     I/O block set by) @{"OpenDevice" LINK "OpenDevice"} function
       io_Unit     - bit map of channels to lock (bits 0 thru 3 correspond to
                     channels 0 thru 3)
       io_Command  - command number for @{"ADCMD_LOCK" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 28}
       io_Flags    - flags, must be cleared
       ioa_AllocKey- allocation key, must be set by (or copied from I/O block
                     set by) @{"OpenDevice" LINK "OpenDevice"} function or @{"ADCMD_ALLOCATE" LINK "ADCMD_ALLOCATE"} command@{b}

   OUTPUTS@{ub}
       io_Unit     - bit map of successfully locked channels (bits 0 thru 3
                     correspond to channels 0 thru 3) not freed (@{"ADCMD_FREE" LINK "ADCMD_FREE"})
       io_Flags    - @{"IOF_QUICK" LINK "gg:doc/NDK/Guide/Include/exec/io.h/File" 46} flag cleared if the allocation key is correct
                     (no @{"ADIOERR_NOALLOCATION" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 41} error)
       io_Error    - error number:
                     0                    - no error
                     @{"ADIOERR_NOALLOCATION" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 41} - allocation key (ioa_AllocKey)
                                            does not match key for channel
                     @{"ADIOERR_CHANNELSTOLEN" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 43}- allocation attempting to steal
                                            locked channel

@ENDNODE
@NODE "ADCMD_PERVOL" "audio.device/ADCMD_PERVOL"
@{b}

   NAME@{ub}
       @{"ADCMD_PERVOL" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 27} -- change the period and volume for writes in progress to
                       audio channels@{b}

   FUNCTION@{ub}
       @{"ADCMD_PERVOL" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 27} is a command for multiple audio channels.  For each
       selected channel (io_Unit), if the allocation key (ioa_AllocKey) is
       correct and there is a write (@{"CMD_WRITE" LINK "CMD_WRITE"}) in progress, @{"ADCMD_PERVOL" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 27}
       loads a new volume and period immediately or at the end of the current
       cycle depending on the sync flag (@{"ADIOF_SYNCCYCLE" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 35}).  If the allocation
       key in incorrect, @{"ADCMD_PERVOL" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 27} returns an error
       (@{"ADIOERR_NOALLOCATION" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 41}).  @{"ADCMD_PERVOL" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 27} is synchronous and only replies
       (mn_ReplyPort) if the quick flag (@{"IOF_QUICK" LINK "gg:doc/NDK/Guide/Include/exec/io.h/File" 46}) is clear.  Do not use
       @{"ADCMD_PERVOL" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 27} in interrupt code at interrupt level 5 or higher.@{b}

   INPUTS@{ub}
       mn_ReplyPort- pointer to message port that receives I/O request
                     if the quick flag (@{"IOF_QUICK" LINK "gg:doc/NDK/Guide/Include/exec/io.h/File" 46}) is clear
       io_Device   - pointer to device node, must be set by (or copied from
                     I/O block set by) @{"OpenDevice" LINK "OpenDevice"} function
       io_Unit     - bit map of channels to load period and volume (bits 0
                     thru 3 correspond to channels 0 thru 3)
       io_Command  - command number for @{"ADCMD_PERVOL" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 27}
       io_Flags    - flags, must be cleared if not used:
                     @{"IOF_QUICK" LINK "gg:doc/NDK/Guide/Include/exec/io.h/File" 46}      - (CLEAR) reply I/O request
                     @{"ADIOF_SYNCCYCLE" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 35}- (CLEAR) load period and volume
                                              immediately
                                      (SET) load period and volume at the end
                                            of the current cycle
       ioa_AllocKey- allocation key, must be set by (or copied from I/O block
                     set by) @{"OpenDevice" LINK "OpenDevice"} function or @{"ADCMD_ALLOCATE" LINK "ADCMD_ALLOCATE"} command
       ioa_Period  - new sample period in 279.365 ns increments (124 thru
                     65536, anti-aliasing filter works below 300 to 500
                     depending on waveform)
       ioa_Volume  - new volume (0 thru 64, linear)@{b}

   OUTPUTS@{ub}
       io_Unit     - bit map of channels that successfully loaded period and
                     volume (bits 0 thru 3 correspond to channels 0 thru 3)
       io_Error    - error number:
                     0                    - no error
                     @{"ADIOERR_NOALLOCATION" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 41} - allocation key (ioa_AllocKey)
                                            does not match key for channel

@ENDNODE
@NODE "ADCMD_SETPREC" "audio.device/ADCMD_SETPREC"
@{b}

   NAME@{ub}
       @{"ADCMD_SETPREC" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 25} -- set the allocation precedence for audio channels@{b}

   FUNCTION@{ub}
       @{"ADCMD_SETPREC" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 25} is a command for multiple audio channels.  For each
       selected channel (io_Unit), if the allocation key (ioa_AllocKey) is
       correct, @{"ADCMD_SETPREC" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 25} sets the allocation precedence to a new value
       (ln_Pri) and checks if there are allocation requests (@{"ADCMD_ALLOCATE" LINK "ADCMD_ALLOCATE"})
       waiting for the channel which now have higher precedence; otherwise,
       @{"ADCMD_SETPREC" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 25} returns an error (@{"ADIOERR_NOALLOCATION" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 41}).  @{"ADCMD_SETPREC" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 25}
       is synchronous and only replies (mn_ReplyPort) if the quick flag
       (@{"IOF_QUICK" LINK "gg:doc/NDK/Guide/Include/exec/io.h/File" 46}) is clear.  Do not use @{"ADCMD_SETPREC" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 25} in interrupt code.@{b}

   INPUTS@{ub}
       ln_Pri      - new allocation precedence (-128 thru 127)
       mn_ReplyPort- pointer to message port that receives I/O request
                     if the quick flag (@{"IOF_QUICK" LINK "gg:doc/NDK/Guide/Include/exec/io.h/File" 46}) is clear
       io_Device   - pointer to device node, must be set by (or copied from
                     I/O block set by) @{"OpenDevice" LINK "OpenDevice"} function
       io_Unit     - bit map of channels to set precedence (bits 0 thru 3
                     correspond to channels 0 thru 3)
       io_Command  - command number for @{"ADCMD_SETPREC" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 25}
       io_Flags    - flags, must be cleared if not used:
                     @{"IOF_QUICK" LINK "gg:doc/NDK/Guide/Include/exec/io.h/File" 46} - (CLEAR) reply I/O request
       ioa_AllocKey- allocation key, must be set by (or copied from I/O block
                     set by) @{"OpenDevice" LINK "OpenDevice"} function or @{"ADCMD_ALLOCATE" LINK "ADCMD_ALLOCATE"} command@{b}

   OUTPUTS@{ub}
       io_Unit     - bit map of channels that successfully set precedence
                     (bits 0 thru 3 correspond to channels 0 thru 3)
       io_Error    - error number:
                     0                    - no error
                     @{"ADIOERR_NOALLOCATION" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 41} - allocation key (ioa_AllocKey)
                                            does not match key for channel

@ENDNODE
@NODE "ADCMD_WAITCYCLE" "audio.device/ADCMD_WAITCYCLE"
@{b}

   NAME@{ub}
       @{"ADCMD_WAITCYCLE" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 29} -- wait for an audio channel to complete the current
                          cycle of a write@{b}

   FUNCTION@{ub}
       @{"ADCMD_WAITCYCLE" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 29} is a command for a single audio channel (io_Unit).
       If the allocation key (ioa_AllocKey) is correct and there is a write
       (@{"CMD_WRITE" LINK "CMD_WRITE"}) in progress on selected channel, @{"ADCMD_WAITCYCLE" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 29} does not
       reply (mn_ReplyPort) until the end of the current cycle.  If there is
       no write is progress, @{"ADCMD_WAITCYCLE" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 29} replies immediately.  If the
       allocation key is incorrect, @{"ADCMD_WAITCYCLE" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 29} returns an error
       (@{"ADIOERR_NOALLOCATION" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 41}).  @{"ADCMD_WAITCYCLE" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 29} returns an error
       (@{"IOERR_ABORTED" LINK "gg:doc/NDK/Guide/Include/exec/errors.h/File" 14}) if it is canceled (@{"AbortIO" LINK "AbortIO"}) or the channel is stolen
       (@{"ADCMD_ALLOCATE" LINK "ADCMD_ALLOCATE"}).  @{"ADCMD_WAITCYCLE" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 29} is only asynchronous if it is
       waiting for a cycle to complete, in which case it clears the quick
       flag (@{"IOF_QUICK" LINK "gg:doc/NDK/Guide/Include/exec/io.h/File" 46}); otherwise, it is synchronous and only replies if the
       quick flag (@{"IOF_QUICK" LINK "gg:doc/NDK/Guide/Include/exec/io.h/File" 46}) is clear.  Do not use @{"ADCMD_WAITCYCLE" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 29} in
       interrupt code at interrupt level 5 or higher.@{b}

   INPUTS@{ub}
       mn_ReplyPort- pointer to message port that receives I/O request, if
                     the quick flag (@{"IOF_QUICK" LINK "gg:doc/NDK/Guide/Include/exec/io.h/File" 46}) is clear, or if a write is in
                     progress on the selected channel and a cycle has
                     completed
       io_Device   - pointer to device node, must be set by (or copied from
                     I/O block set by) @{"OpenDevice" LINK "OpenDevice"} function
       io_Unit     - bit map of channel to wait for cycle (bits 0 thru 3
                     correspond to channels 0 thru 3), if more then one bit
                     is set lowest bit number channel is used
       io_Command  - command number for CMD_WAITCYCLE
       io_Flags    - flags, must be cleared if not used:
                     @{"IOF_QUICK" LINK "gg:doc/NDK/Guide/Include/exec/io.h/File" 46} - (CLEAR) reply I/O request
                                 (SET) only reply I/O request if a write is
                                       in progress on the selected channel
                                       and a cycle has completed
       ioa_AllocKey- allocation key, must be set by (or copied from I/O block
                     set by) @{"OpenDevice" LINK "OpenDevice"} function or @{"ADCMD_ALLOCATE" LINK "ADCMD_ALLOCATE"} command@{b}

   OUTPUTS@{ub}
       io_Unit     - bit map of channel that successfully waited for cycle
                     (bits 0 thru 3 correspond to channels 0 thru 3)
       io_Flags    - @{"IOF_QUICK" LINK "gg:doc/NDK/Guide/Include/exec/io.h/File" 46} flag cleared if a write is in progress on the
                     selected channel
       io_Error    - error number:
                     0                    - no error
                     @{"IOERR_ABORTED" LINK "gg:doc/NDK/Guide/Include/exec/errors.h/File" 14}        - canceled (@{"AbortIO" LINK "AbortIO"}) or channel
                                            stolen
                     @{"ADIOERR_NOALLOCATION" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 41} - allocation key (ioa_AllocKey)
                                            does not match key for channel

@ENDNODE
@NODE "BeginIO" "audio.device/BeginIO()"
@{b}

   NAME@{ub}
       @{"BeginIO" LINK "gg:doc/NDK/Guide/serial/BeginIO"} - dispatch a device command@{b}

   SYNOPSIS@{ub}
       @{"BeginIO" LINK "gg:doc/NDK/Guide/serial/BeginIO"}(iORequest);
                   A1@{b}

   FUNCTION@{ub}
       @{"BeginIO" LINK "gg:doc/NDK/Guide/serial/BeginIO"} has the responsibility of dispatching all device commands.
       Immediate commands are always called directly, and all other commands
       are queued to make them single threaded.@{b}

   INPUTS@{ub}
       iORequest -- pointer to the I/O Request for this command

@ENDNODE
@NODE "CloseDevice" "audio.device/CloseDevice()"
@{b}

   NAME@{ub}
       @{"CloseDevice" LINK "gg:doc/NDK/Guide/exec/CloseDevice"} - terminate access to the audio device@{b}

   SYNOPSIS@{ub}
       @{"CloseDevice" LINK "gg:doc/NDK/Guide/exec/CloseDevice"}(iORequest);
                       A1@{b}

   FUNCTION@{ub}
       The @{"CloseDevice" LINK "gg:doc/NDK/Guide/exec/CloseDevice"} routine notifies the audio device that it will no
       longer be used.  It takes an I/O audio request block (IOAudio) and
       clears the device pointer (io_Device).  If there are any channels
       allocated with the same allocation key (ioa_AllocKey), @{"CloseDevice" LINK "gg:doc/NDK/Guide/exec/CloseDevice"}
       frees (@{"ADCMD_FREE" LINK "ADCMD_FREE"}) them. @{"CloseDevice" LINK "gg:doc/NDK/Guide/exec/CloseDevice"} decrements the open count, and if
       it falls to zero and an expunge (Expunge) is pending, the device is
       expunged.@{b}

   INPUTS@{ub}
       iORequest   - pointer to audio request block (@{"struct IOAudio" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 45})
               io_Device   - pointer to device node, must be set by (or
                             copied from I/O block set by) open (@{"OpenDevice" LINK "OpenDevice"})
               io_Unit     - bit map of channels to free (@{"ADCMD_FREE" LINK "ADCMD_FREE"}) (bits 0
                             thru 3 correspond to channels 0 thru 3)
               ioa_AllocKey- allocation key, used to free channels@{b}

   OUTPUTS@{ub}
       iORequest - pointer to audio request block (@{"struct IOAudio" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 45})
               io_Device   - set to -1
               io_Unit     - set to zero

@ENDNODE
@NODE "CMD_CLEAR" "audio.device/CMD_CLEAR"
@{b}

   NAME@{ub}
       @{"CMD_CLEAR" LINK "gg:doc/NDK/Guide/console/CMD_CLEAR"} -- throw away internal caches@{b}

   FUNCTION@{ub}
       @{"CMD_CLEAR" LINK "gg:doc/NDK/Guide/console/CMD_CLEAR"} is a standard command for multiple audio channels.  For each
       selected channel (io_Unit), if the allocation key (ioa_AllocKey) is
       correct, @{"CMD_CLEAR" LINK "gg:doc/NDK/Guide/console/CMD_CLEAR"} does nothing; otherwise, @{"CMD_CLEAR" LINK "gg:doc/NDK/Guide/console/CMD_CLEAR"} returns an error
       (@{"ADIOERR_NOALLOCATION" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 41}).  @{"CMD_CLEAR" LINK "gg:doc/NDK/Guide/console/CMD_CLEAR"} is synchronous and only replies
       (mn_ReplyPort) if the quick flag (@{"IOF_QUICK" LINK "gg:doc/NDK/Guide/Include/exec/io.h/File" 46}) is clear.@{b}

   INPUTS@{ub}
       mn_ReplyPort- pointer to message port that receives I/O request after
                     if the quick flag (@{"IOF_QUICK" LINK "gg:doc/NDK/Guide/Include/exec/io.h/File" 46}) is clear
       io_Device   - pointer to device node, must be set by (or copied from
                     I/O block set by) @{"OpenDevice" LINK "OpenDevice"} function
       io_Unit     - bit map of channels to clear (bits 0 thru 3 correspond
                     to channels 0 thru 3)
       io_Command  - command number for @{"CMD_CLEAR" LINK "gg:doc/NDK/Guide/console/CMD_CLEAR"}
       io_Flags    - flags, must be cleared if not used:
                     @{"IOF_QUICK" LINK "gg:doc/NDK/Guide/Include/exec/io.h/File" 46} - (CLEAR) reply I/O request
       ioa_AllocKey- allocation key, must be set by (or copied from I/O block
                     set by) @{"OpenDevice" LINK "OpenDevice"} function or @{"ADCMD_ALLOCATE" LINK "ADCMD_ALLOCATE"} command@{b}

   OUTPUTS@{ub}
       io_Unit     - bit map of channels successfully cleared (bits 0 thru 3
                     correspond to channels 0 thru 3)
       io_Error    - error number:
                     0                    - no error
                     @{"ADIOERR_NOALLOCATION" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 41} - allocation key (ioa_AllocKey)
                                            does not match key for channel

@ENDNODE
@NODE "CMD_FLUSH" "audio.device/CMD_FLUSH"
@{b}

   NAME@{ub}
       @{"CMD_FLUSH" LINK "gg:doc/NDK/Guide/narrator/CMD_FLUSH"} -- cancel all pending I/O@{b}

   FUNCTION@{ub}
       @{"CMD_FLUSH" LINK "gg:doc/NDK/Guide/narrator/CMD_FLUSH"} is a standard command for multiple audio channels.  For each
       selected channel (io_Unit), if the allocation key (ioa_AllocKey) is
       correct, @{"CMD_FLUSH" LINK "gg:doc/NDK/Guide/narrator/CMD_FLUSH"} aborts all writes (@{"CMD_WRITE" LINK "CMD_WRITE"}) in progress or queued
       and any I/O requests waiting to synchronize with the end of the cycle
       (@{"ADCMD_WAITCYCLE" LINK "ADCMD_WAITCYCLE"}); otherwise, @{"CMD_FLUSH" LINK "gg:doc/NDK/Guide/narrator/CMD_FLUSH"} returns an error
       (@{"ADIOERR_NOALLOCATION" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 41}).  @{"CMD_FLUSH" LINK "gg:doc/NDK/Guide/narrator/CMD_FLUSH"} is synchronous and only replies
       (mn_ReplyPort) if the quick flag (@{"IOF_QUICK" LINK "gg:doc/NDK/Guide/Include/exec/io.h/File" 46}) is clear.  Do not use
       @{"CMD_FLUSH" LINK "gg:doc/NDK/Guide/narrator/CMD_FLUSH"} in interrupt code at interrupt level 5 or higher.@{b}

   INPUTS@{ub}
       mn_ReplyPort- pointer to message port that receives I/O request
                     if the quick flag (@{"IOF_QUICK" LINK "gg:doc/NDK/Guide/Include/exec/io.h/File" 46}) is clear
       io_Device   - pointer to device node, must be set by (or copied from
                     I/O block set by) @{"OpenDevice" LINK "OpenDevice"} function
       io_Unit     - bit map of channels to flush (bits 0 thru 3 correspond
                     to channels 0 thru 3)
       io_Command  - command number for @{"CMD_FLUSH" LINK "gg:doc/NDK/Guide/narrator/CMD_FLUSH"}
       io_Flags    - flags, must be cleared if not used:
                     @{"IOF_QUICK" LINK "gg:doc/NDK/Guide/Include/exec/io.h/File" 46} - (CLEAR) reply I/O request
       ioa_AllocKey- allocation key, must be set by (or copied from I/O block
                     set by) @{"OpenDevice" LINK "OpenDevice"} function or @{"ADCMD_ALLOCATE" LINK "ADCMD_ALLOCATE"} command@{b}

   OUTPUTS@{ub}
       io_Unit     - bit map of channels successfully flushed (bits 0 thru 3
                     correspond to channels 0 thru 3)
       io_Error    - error number:
                     0                    - no error
                     @{"ADIOERR_NOALLOCATION" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 41} - allocation key (ioa_AllocKey)
                                            does not match key for channel

@ENDNODE
@NODE "CMD_READ" "audio.device/CMD_READ"
@{b}

   NAME@{ub}
       @{"CMD_READ" LINK "gg:doc/NDK/Guide/clipboard/CMD_READ"} -- normal I/O entry point@{b}

   FUNCTION@{ub}
       @{"CMD_READ" LINK "gg:doc/NDK/Guide/clipboard/CMD_READ"} is a standard command for a single audio channel (io_Unit).
       If the allocation key (ioa_AllocKey) is correct, @{"CMD_READ" LINK "gg:doc/NDK/Guide/clipboard/CMD_READ"} returns a
       pointer (io_Data) to the I/O block currently writing (@{"CMD_WRITE" LINK "CMD_WRITE"}) on
       the selected channel; otherwise, @{"CMD_READ" LINK "gg:doc/NDK/Guide/clipboard/CMD_READ"} returns an error
       (@{"ADIOERR_NOALLOCATION" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 41}).  If there is no write in progress, @{"CMD_READ" LINK "gg:doc/NDK/Guide/clipboard/CMD_READ"}
       returns zero.  @{"CMD_READ" LINK "gg:doc/NDK/Guide/clipboard/CMD_READ"} is synchronous and only replies (mn_ReplyPort)
       if the quick bit (@{"IOF_QUICK" LINK "gg:doc/NDK/Guide/Include/exec/io.h/File" 46}) is clear.@{b}

   INPUTS@{ub}
       mn_ReplyPort- pointer to message port that receives I/O request after
                     if the quick flag (@{"IOF_QUICK" LINK "gg:doc/NDK/Guide/Include/exec/io.h/File" 46}) is clear
       io_Device   - pointer to device node, must be set by (or copied from
                     I/O block set by) @{"OpenDevice" LINK "OpenDevice"} function
       io_Unit     - bit map of channel to read (bit 0 thru 3 corresponds to
                     channel 0 thru 3), if more then one bit is set lowest
                     bit number channel read
       io_Command  - command number for @{"CMD_READ" LINK "gg:doc/NDK/Guide/clipboard/CMD_READ"}
       io_Flags    - flags, must be cleared if not used:
                     @{"IOF_QUICK" LINK "gg:doc/NDK/Guide/Include/exec/io.h/File" 46} - (CLEAR) reply I/O request
       ioa_AllocKey- allocation key, must be set by (or copied from I/O block
                     set by) @{"OpenDevice" LINK "OpenDevice"} function or @{"ADCMD_ALLOCATE" LINK "ADCMD_ALLOCATE"} command@{b}

   OUTPUTS@{ub}
       io_Unit     - bit map of channel successfully read (bit 0 thru 3
                     corresponds to channel 0 thru 3)
       io_Error    - error number:
                     0                    - no error
                     @{"ADIOERR_NOALLOCATION" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 41} - allocation key (ioa_AllocKey)
                                            does not match key for channel
       ioa_Data    - pointer to I/O block for current write, zero if none is
                     progress

@ENDNODE
@NODE "CMD_RESET" "audio.device/CMD_RESET"
@{b}

   NAME@{ub}
       @{"CMD_RESET" LINK "gg:doc/NDK/Guide/narrator/CMD_RESET"} -- restore device to a known state@{b}

   FUNCTION@{ub}
       @{"CMD_RESET" LINK "gg:doc/NDK/Guide/narrator/CMD_RESET"} is a standard command for multiple audio channels.  For each
       selected channel (io_Unit), if the allocation key (ioa_AllocKey) is
       correct, @{"CMD_RESET" LINK "gg:doc/NDK/Guide/narrator/CMD_RESET"}:
         . clears the hardware audio registers and attach bits,
         . sets the audio interrupt vector,
         . cancels all pending I/O (@{"CMD_FLUSH" LINK "CMD_FLUSH"}), and
         . un-stops the channel if it is stopped (@{"CMD_STOP" LINK "CMD_STOP"}),

       Otherwise, @{"CMD_RESET" LINK "gg:doc/NDK/Guide/narrator/CMD_RESET"} returns an error (@{"ADIOERR_NOALLOCATION" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 41}).
       @{"CMD_RESET" LINK "gg:doc/NDK/Guide/narrator/CMD_RESET"} is synchronous and only replies (mn_ReplyPort) if the quick
       flag (@{"IOF_QUICK" LINK "gg:doc/NDK/Guide/Include/exec/io.h/File" 46}) is clear.  Do not use @{"CMD_RESET" LINK "gg:doc/NDK/Guide/narrator/CMD_RESET"} in interrupt code at
       interrupt level 5 or higher.@{b}

   INPUTS@{ub}
       mn_ReplyPort- pointer to message port that receives I/O request
                     if the quick flag (@{"IOF_QUICK" LINK "gg:doc/NDK/Guide/Include/exec/io.h/File" 46}) is clear
       io_Device   - pointer to device node, must be set by (or copied from
                     I/O block set by) @{"OpenDevice" LINK "OpenDevice"} function
       io_Unit     - bit map of channels to reset (bits 0 thru 3 correspond
                     to channels 0 thru 3)
       io_Command  - command number for @{"CMD_RESET" LINK "gg:doc/NDK/Guide/narrator/CMD_RESET"}
       io_Flags    - flags, must be cleared if not used:
                     @{"IOF_QUICK" LINK "gg:doc/NDK/Guide/Include/exec/io.h/File" 46} - (CLEAR) reply I/O request
       ioa_AllocKey- allocation key, must be set by (or copied from I/O block
                     set by) @{"OpenDevice" LINK "OpenDevice"} function or @{"ADCMD_ALLOCATE" LINK "ADCMD_ALLOCATE"} command@{b}

   OUTPUTS@{ub}
       io_Unit     - bit map of channels to successfully reset (bits 0 thru 3
                     correspond to channels 0 thru 3)
       io_Error    - error number:
                     0                    - no error
                     @{"ADIOERR_NOALLOCATION" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 41} - allocation key (ioa_AllocKey)
                                            does not match key for channel

@ENDNODE
@NODE "CMD_START" "audio.device/CMD_START"
@{b}

   NAME@{ub}
       @{"CMD_START" LINK "gg:doc/NDK/Guide/narrator/CMD_START"} -- start device processing (like ^Q)@{b}

   FUNCTION@{ub}
       @{"CMD_START" LINK "gg:doc/NDK/Guide/narrator/CMD_START"} is a standard command for multiple audio channels.  For each
       selected channel (io_Unit), if the allocation key (ioa_AllocKey) is
       correct and the channel was previously stopped (@{"CMD_STOP" LINK "CMD_STOP"}), CMP_START
       immediately starts all writes (@{"CMD_WRITE" LINK "CMD_WRITE"}) to the channel.  If the
       allocation key is incorrect, @{"CMD_START" LINK "gg:doc/NDK/Guide/narrator/CMD_START"} returns an error
       (@{"ADIOERR_NOALLOCATION" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 41}).  @{"CMD_START" LINK "gg:doc/NDK/Guide/narrator/CMD_START"} starts multiple channels
       simultaneously to minimize distortion if the channels are playing the
       same waveform and their outputs are mixed. @{"CMD_START" LINK "gg:doc/NDK/Guide/narrator/CMD_START"} is synchronous an d
       only replies (mn_ReplyPort) if the quick flag (@{"IOF_QUICK" LINK "gg:doc/NDK/Guide/Include/exec/io.h/File" 46}) is clear.  D o
       not use @{"CMD_START" LINK "gg:doc/NDK/Guide/narrator/CMD_START"} in interrupt code at interrupt level 5 or higher.@{b}

   INPUTS@{ub}
       mn_ReplyPort- pointer to message port that receives I/O request after
                     if the quick flag (@{"IOF_QUICK" LINK "gg:doc/NDK/Guide/Include/exec/io.h/File" 46}) is clear
       io_Device   - pointer to device node, must be set by (or copied from
                     I/O block set by) @{"OpenDevice" LINK "OpenDevice"} function
       io_Unit     - bit map of channels to start (bits 0 thru 3 correspond
                     to channels 0 thru 3)
       io_Command  - command number for @{"CMD_START" LINK "gg:doc/NDK/Guide/narrator/CMD_START"}
       io_Flags    - flags, must be cleared if not used:
                     @{"IOF_QUICK" LINK "gg:doc/NDK/Guide/Include/exec/io.h/File" 46} - (CLEAR) reply I/O request
       ioa_AllocKey- allocation key, must be set by (or copied from I/O block
                     set by) @{"OpenDevice" LINK "OpenDevice"} function or @{"ADCMD_ALLOCATE" LINK "ADCMD_ALLOCATE"} command@{b}

   OUTPUTS@{ub}
       io_Unit     - bit map of channels successfully started (bits 0 thru 3
                     correspond to channels 0 thru 3)
       io_Error    - error number:
                     0                    - no error
                     @{"ADIOERR_NOALLOCATION" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 41} - allocation key (ioa_AllocKey)
                                            does not match key for channel

@ENDNODE
@NODE "CMD_STOP" "audio.device/CMD_STOP"
@{b}

   NAME@{ub}
       @{"CMD_STOP" LINK "gg:doc/NDK/Guide/narrator/CMD_STOP"} -- stop device processing (like ^S)@{b}

   FUNCTION@{ub}
       @{"CMD_STOP" LINK "gg:doc/NDK/Guide/narrator/CMD_STOP"} is a standard command for multiple audio channels.  For each
       selected channel (io_Unit), if the allocation key (ioa_AllocKey) is
       correct, @{"CMD_STOP" LINK "gg:doc/NDK/Guide/narrator/CMD_STOP"} immediately stops any writes (@{"CMD_WRITE" LINK "CMD_WRITE"}) in
       progress; otherwise, @{"CMD_STOP" LINK "gg:doc/NDK/Guide/narrator/CMD_STOP"} returns an error (@{"ADIOERR_NOALLOCATION" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 41}).
       @{"CMD_WRITE" LINK "CMD_WRITE"} queues up writes to a stopped channel until @{"CMD_START" LINK "CMD_START"} starts
       the channel or @{"CMD_RESET" LINK "CMD_RESET"} resets the channel. @{"CMD_STOP" LINK "gg:doc/NDK/Guide/narrator/CMD_STOP"} is synchronous
       and only replies (mn_ReplyPort) if the quick flag (@{"IOF_QUICK" LINK "gg:doc/NDK/Guide/Include/exec/io.h/File" 46}) is
       clear.  Do not use @{"CMD_STOP" LINK "gg:doc/NDK/Guide/narrator/CMD_STOP"} in interrupt code at interrupt level 5 or
       higher.@{b}

   INPUTS@{ub}
       mn_ReplyPort- pointer to message port that receives I/O request after
                     if the quick flag (@{"IOF_QUICK" LINK "gg:doc/NDK/Guide/Include/exec/io.h/File" 46}) is clear
       io_Device   - pointer to device node, must be set by (or copied from
                     I/O block set by) @{"OpenDevice" LINK "OpenDevice"} function
       io_Unit     - bit map of channels to stop (bits 0 thru 3 correspond to
                     channels 0 thru 3)
       io_Command  - command number for @{"CMD_STOP" LINK "gg:doc/NDK/Guide/narrator/CMD_STOP"}
       io_Flags    - flags, must be cleared if not used:
                     @{"IOF_QUICK" LINK "gg:doc/NDK/Guide/Include/exec/io.h/File" 46} - (CLEAR) reply I/O request
       ioa_AllocKey- allocation key, must be set by (or copied from I/O block
                     set by) @{"OpenDevice" LINK "OpenDevice"} function or @{"ADCMD_ALLOCATE" LINK "ADCMD_ALLOCATE"} command@{b}

   OUTPUTS@{ub}
       io_Unit     - bit map of channels successfully stopped (bits 0 thru 3
                     correspond to channels 0 thru 3)
       io_Error    - error number:
                     0                    - no error
                     @{"ADIOERR_NOALLOCATION" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 41} - allocation key (ioa_AllocKey)
                                            does not match key for channel

@ENDNODE
@NODE "CMD_UPDATE" "audio.device/CMD_UPDATE"
@{b}

   NAME@{ub}
       @{"CMD_UPDATE" LINK "gg:doc/NDK/Guide/clipboard/CMD_UPDATE"} -- force dirty buffers out@{b}

   FUNCTION@{ub}
       @{"CMD_UPDATE" LINK "gg:doc/NDK/Guide/clipboard/CMD_UPDATE"} is a standard command for multiple audio channels.  For
       each selected channel (io_Unit), if the allocation key (ioa_AllocKey)
       is correct, @{"CMD_UPDATE" LINK "gg:doc/NDK/Guide/clipboard/CMD_UPDATE"} does nothing; otherwise, @{"CMD_UPDATE" LINK "gg:doc/NDK/Guide/clipboard/CMD_UPDATE"} returns an
       error (@{"ADIOERR_NOALLOCATION" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 41}).  @{"CMD_UPDATE" LINK "gg:doc/NDK/Guide/clipboard/CMD_UPDATE"} is synchronous and only
       replies (mn_ReplyPort) if the quick flag (@{"IOF_QUICK" LINK "gg:doc/NDK/Guide/Include/exec/io.h/File" 46}) is clear.@{b}

   INPUTS@{ub}
       mn_ReplyPort- pointer to message port that receives I/O request after
                     if the quick flag (@{"IOF_QUICK" LINK "gg:doc/NDK/Guide/Include/exec/io.h/File" 46}) is clear
       io_Device   - pointer to device node, must be set by (or copied from
                     I/O block set by) @{"OpenDevice" LINK "OpenDevice"} function
       io_Unit     - bit map of channels to update (bits 0 thru 3 correspond
                     to channels 0 thru 3)
       io_Command  - command number for @{"CMD_UPDATE" LINK "gg:doc/NDK/Guide/clipboard/CMD_UPDATE"}
       io_Flags    - flags, must be cleared if not used:
                     @{"IOF_QUICK" LINK "gg:doc/NDK/Guide/Include/exec/io.h/File" 46} - (CLEAR) reply I/O request
       ioa_AllocKey- allocation key, must be set by (or copied from I/O block
                     set by) @{"OpenDevice" LINK "OpenDevice"} function or @{"ADCMD_ALLOCATE" LINK "ADCMD_ALLOCATE"} command@{b}

   OUTPUTS@{ub}
       io_Unit     - bit map of channels successfully updated (bits 0 thru 3
                     correspond to channels 0 thru 3)
       io_Error    - error number:
                     0                    - no error
                     @{"ADIOERR_NOALLOCATION" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 41} - allocation key (ioa_AllocKey)
                                            does not match key for channel

@ENDNODE
@NODE "CMD_WRITE" "audio.device/CMD_WRITE"
@{b}

   NAME@{ub}
       @{"CMD_WRITE" LINK "gg:doc/NDK/Guide/clipboard/CMD_WRITE"} -- normal I/O entry point@{b}

   FUNCTION@{ub}
       @{"CMD_WRITE" LINK "gg:doc/NDK/Guide/clipboard/CMD_WRITE"} is a standard command for a single audio channel (io_Unit).
       If the allocation key (ioa_AllocKey) is correct, @{"CMD_WRITE" LINK "gg:doc/NDK/Guide/clipboard/CMD_WRITE"} plays a
       sound using the selected channel; otherwise, it returns an error
       (@{"ADIOERR_NOALLOCATION" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 41}).  @{"CMD_WRITE" LINK "gg:doc/NDK/Guide/clipboard/CMD_WRITE"} queues up requests if there is
       another write in progress or if the channel is stopped (@{"CMD_STOP" LINK "CMD_STOP"}).
       When the write actually starts; if the @{"ADIOF_PERVOL" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 33} flag is set,
       @{"CMD_WRITE" LINK "gg:doc/NDK/Guide/clipboard/CMD_WRITE"} loads volume (ioa_Volume) and period (ioa_Period), and if
       the @{"ADIOF_WRITEMESSAGE" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 39} flag is set, @{"CMD_WRITE" LINK "gg:doc/NDK/Guide/clipboard/CMD_WRITE"} replies the write
       message (ioa_WriteMsg).  @{"CMD_WRITE" LINK "gg:doc/NDK/Guide/clipboard/CMD_WRITE"} returns an error (@{"IOERR_ABORTED" LINK "gg:doc/NDK/Guide/Include/exec/errors.h/File" 14}) if
       it is canceled (@{"AbortIO" LINK "AbortIO"}) or the channel is stolen (@{"ADCMD_ALLOCATE" LINK "ADCMD_ALLOCATE"}).
       @{"CMD_WRITE" LINK "gg:doc/NDK/Guide/clipboard/CMD_WRITE"} is only asynchronous if there is no error, in which case it
       clears the quick flag (@{"IOF_QUICK" LINK "gg:doc/NDK/Guide/Include/exec/io.h/File" 46}) and replies the I/O request
       (mn_ReplyPort) after it finishes writting; otherwise, it is synchronous
       and only replies if the quick flag (@{"IOF_QUICK" LINK "gg:doc/NDK/Guide/Include/exec/io.h/File" 46}) is clear.  Do not use
       @{"CMD_WRITE" LINK "gg:doc/NDK/Guide/clipboard/CMD_WRITE"} in interrupt code at interrupt level 5 or higher.@{b}

   INPUTS@{ub}
       mn_ReplyPort- pointer to message port that receives I/O request after
                     the write completes
       io_Device   - pointer to device node, must be set by (or copied from
                     I/O block set by) @{"OpenDevice" LINK "OpenDevice"} function
       io_Unit     - bit map of channel to write (bit 0 thru 3 corresponds to
                     channel 0 thru 3), if more then one bit is set lowest
                     bit number channel is written
       io_Command  - command number for @{"CMD_WRITE" LINK "gg:doc/NDK/Guide/clipboard/CMD_WRITE"}
       io_Flags    - flags, must be cleared if not used:
                     @{"ADIOF_PERVOL" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 33}       - (SET) load volume and period
                     @{"ADIOF_WRITEMESSAGE" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 39} - (SET) reply message at write start
       ioa_AllocKey- allocation key, must be set by (or copied from I/O block
                     set by) @{"OpenDevice" LINK "OpenDevice"} function or @{"ADCMD_ALLOCATE" LINK "ADCMD_ALLOCATE"} command
       ioa_Data    - pointer to waveform array (signed bytes (-128 thru 127)
                     in custom chip addressable ram and word aligned)
       ioa_Length  - length of the wave array in bytes (2 thru 131072, must
                     be even number)
       ioa_Period  - sample period in 279.365 ns increments (124 thru 65536,
                     anti-aliasing filter works below 300 to 500 depending on
                     waveform), if enabled by @{"ADIOF_PERVOL" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 33}
       ioa_Volume  - volume (0 thru 64, linear), if enabled by @{"ADIOF_PERVOL" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 33}
       ioa_Cycles  - number of times to repeat array (0 thru 65535, 0 for
                     infinite)
       ioa_WriteMsg- message replied at start of write,  if enabled by
                     @{"ADIOF_WRITEMESSAGE" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 39}@{b}

   OUTPUTS@{ub}
       io_Unit     - bit map of channel successfully written (bit 0 thru 3
                     corresponds to channel 0 thru 3)
       io_Flags    - @{"IOF_QUICK" LINK "gg:doc/NDK/Guide/Include/exec/io.h/File" 46} flag cleared if there is no error
       io_Error    - error number:
                     0                    - no error
                     @{"IOERR_ABORTED" LINK "gg:doc/NDK/Guide/Include/exec/errors.h/File" 14}        - canceled (@{"AbortIO" LINK "AbortIO"}) or channel
                                            stolen
                     @{"ADIOERR_NOALLOCATION" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 41} - allocation key (ioa_AllocKey)
                                            does not match key for channel@{b}

   BUGS@{ub}
       If @{"CMD_WRITE" LINK "gg:doc/NDK/Guide/clipboard/CMD_WRITE"} starts the write immediately after stopping a previous
       write, you must set the @{"ADIOF_PERVOL" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 33} flag or else the new data pointer
       (ioa_Data) and length (ioa_Length) may not be loaded.

@ENDNODE
@NODE "Expunge" "audio.device/Expunge()"
@{b}

   NAME@{ub}
       EXPUNGE - indicate a desire to remove the Audio device@{b}

   FUNCTION@{ub}
       The Expunge routine is called when a user issues a @{"RemDevice" LINK "gg:doc/NDK/Guide/exec/RemDevice"} call.  By
       the time it is called, the device has already been removed from the
       device list, so no new opens will succeed.  The existence of any other
       users of the device, as determined by the device open count being
       non-zero, will cause the Expunge to be deferred.  When the device is
       not in use, or no longer in use, the Expunge is actually performed.

@ENDNODE
@NODE "OpenDevice" "audio.device/OpenDevice()"
@{b}

   NAME@{ub}
       @{"OpenDevice" LINK "gg:doc/NDK/Guide/exec/OpenDevice"} - open the audio device@{b}

   SYNOPSIS@{ub}
       error = @{"OpenDevice" LINK "gg:doc/NDK/Guide/exec/OpenDevice"}("audio.device", unitNumber, iORequest, flags);@{b}

   FUNCTION@{ub}
       The @{"OpenDevice" LINK "gg:doc/NDK/Guide/exec/OpenDevice"} routine grants access to the audio device.  It takes an
       I/O audio request block (iORequest) and if it can successfully open
       the audio device, it loads the device pointer (io_Device) and the
       allocation key (ioa_AllocKey); otherwise, it returns an error
       (@{"IOERR_OPENFAIL" LINK "gg:doc/NDK/Guide/Include/exec/errors.h/File" 13}).  @{"OpenDevice" LINK "gg:doc/NDK/Guide/exec/OpenDevice"} increments the open count keeping the
       device from being expunged (Expunge).  If the length (ioa_Length) is
       non-zero, @{"OpenDevice" LINK "gg:doc/NDK/Guide/exec/OpenDevice"} tries to allocate (@{"ADCMD_ALLOCATE" LINK "ADCMD_ALLOCATE"}) audio channels
       from a array of channel combination options (ioa_Data). If the
       allocation succeeds, the allocated channel combination is loaded into
       the unit field (ioa_Unit); otherwise, @{"OpenDevice" LINK "gg:doc/NDK/Guide/exec/OpenDevice"} returns an error
       (@{"ADIOERR_ALLOCFAILED" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 42}).  @{"OpenDevice" LINK "gg:doc/NDK/Guide/exec/OpenDevice"} does not wait for allocation to
       succeed and closes (@{"CloseDevice" LINK "CloseDevice"}) the audio device if it fails.  To
       allocate channels, @{"OpenDevice" LINK "gg:doc/NDK/Guide/exec/OpenDevice"} also requires a properly initialized
       reply port (mn_ReplyPort) with an allocated signal bit.@{b}

   INPUTS@{ub}
       unitNumber- not used
       iORequest - pointer to audio request block (@{"struct IOAudio" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 45})
               ln_Pri      - allocation precedence (-128 thru 127), only
                             necessary for allocation (non-zero length)
               mn_ReplyPort- pointer to message port for allocation, only
                             necessary for allocation (non-zero length)
               ioa_AllocKey- allocation key; zero to generate new key.
                             Otherwise, it must be set by (or copied from I/O
                             block that is set by) previous @{"OpenDevice" LINK "gg:doc/NDK/Guide/exec/OpenDevice"}
                             function or @{"ADCMD_ALLOCATE" LINK "ADCMD_ALLOCATE"} command (non-zero
                             length)
               ioa_Data    - pointer to channel combination options (byte
                             array, bits 0 thru 3 correspond to channels 0
                             thru 3), only necessary for allocation (non-zero
                             length)
               ioa_Length  - length of the channel combination option array
                             (0 thru 16), zero for no allocation
       flags     - not used@{b}

   OUTPUTS@{ub}
       iORequest - pointer to audio request block (@{"struct IOAudio" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 45})
               io_Device   - pointer to device node if @{"OpenDevice" LINK "gg:doc/NDK/Guide/exec/OpenDevice"} succeeds,
                             otherwise -1
               io_Unit     - bit map of successfully allocated channels (bits
                             0 thru 3 correspond to channels 0 thru 3)
               io_Error    - error number:
                             0                   - no error
                             @{"IOERR_OPENFAIL" LINK "gg:doc/NDK/Guide/Include/exec/errors.h/File" 13}      - open failed
                             @{"ADIOERR_ALLOCFAILED" LINK "gg:doc/NDK/Guide/Include/devices/audio.h/File" 42} - allocation failed, no open
               ioa_AllocKey- allocation key, set to a unique number if passed
                             a zero and @{"OpenDevice" LINK "gg:doc/NDK/Guide/exec/OpenDevice"} succeeds
       error     - copy of io_Error

@ENDNODE
