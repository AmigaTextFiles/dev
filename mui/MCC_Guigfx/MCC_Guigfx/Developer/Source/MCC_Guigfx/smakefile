CPU	= 68020
GST	= Guigfx.g
DOPTS	= OPTIMIZE OPTSCHEDULE OPTINLOCAL OPTTIME OPTDEPTH=10 OPTRDEPTH=10
TOPTS	= NOOPTIMIZE DEF DEBUG=1 
OPTS	= $(DOPTS)
COPTS	= COMMENTNEST NOICONS NOLINK MATH=STANDARD NOSTACKCHECK \
		NOSTKEXT STRMER MEMSIZE=HUGE DEF=__MakeLib \
		STRUCTUREEQUIVALENCE PARAMS=R CPU=$(CPU) GST $(GST) $(OPTS)
LOPTS	= STRIPDEBUG NOICONS SC SD
LIBS	= lib:sc.lib lib:scm.lib lib:amiga.lib lib:debug.lib
OBJS	= Guigfx_mcc.o Guigfx_functions.o


.c.o:
	sc $< $(COPTS) $(OPTI)


all: Guigfx.mcc

Guigfx.mcc: $(OBJS)
	slink with <<
	   	FROM $(OBJS)
   		TO $@
	   	LIB $(LIBS)
   		$(LOPTS)
	<

Guigfx_mcc.o: $(GST) Guigfx_mcc.c Guigfx_mcc.h MCCLib.c debug.h
Guigfx_functions.o: $(GST) Guigfx_functions.c Guigfx_functions.h Guigfx_mcc.h debug.h

$(GST): gst.c Guigfx_mcc.h Guigfx_data.h Guigfx_functions.h
	sc MGST $@ gst.c IGNORE=105
	delete gst.o

copy:	all
	copy Guigfx.mcc MUI:Libs/MUI/
	copy Guigfx_mcc.h include:MUI/
	avail >NIL: FLUSH

dist:	all
	execute <<
		copy2dist
		cd dist
		if EXISTS ram:MCC_Guigfx.lha
		  delete ram:MCC_Guigfx.lha
		endif
		lha -r a ram:MCC_Guigfx.lha MCC_Guigfx
		cd ..
	<

clean:
	delete *.o *.lnk *.g Guigfx_mcc
