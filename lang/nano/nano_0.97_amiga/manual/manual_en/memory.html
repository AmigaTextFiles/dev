<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
        <title>Nano vm - manual memory</title>
    </head>
    <body bgcolor="white" text="black" link="#1025C3" vlink="red" alink="green">
        <center>
            <table border="0" width="640">
                <tr>
                    <td align="center">
                        <h1>Memory</h1>
                    </td>
                </tr>
                <tr>
                    <td align="left">
Variables are allocated in memory blocks. The default size is "4096" bytes <br>
per block. Up to 64 blocks can be used. Nano allocates the needed blocks <br>
automatically. If you need more memory, you can increase the blocksize <br>
with the "membsize" register. <br><br>

Arrays are allocated as their own block. So "membsize" has no effect on them. <br><br><br>


<h2>Virtual memory</h2>

On machines without a MMU you can use the built in virtual memory driver. <br>
Note: only arrays can be used with VM! <br><br>

You have to set the path, where the swapfile will be created: <br><br>

Set a "NANOTEMP" environment variable to the directory. <br><br>

PC: set nanotemp=%TEMP%\vm_ <br><br>

Amiga: setenv nanotemp "T:vm_" <br><br>

Nano adds the current time to the filename: "vm_hhmmss". <br><br>

The following registers are important: <br><br>

"vmuse" must be set to "1" to enable VM. <br><br>

"vmbsize" the swapfile size in bytes. The default is "1048576" bytes (1 MB). <br>
Just multiply with a factor to increase. <br><br>

"vmcachesize" the cachesize for array elements. The default is "1024". <br><br>

Note: The long registers L32 - L35 are used to store the values. <br>
You should only use the range L0 - L31 for your data! <br><br>

Limits: The swapfile is limited to 2048 MB. This shouldn't be a problem ;-). <br><br>

Example: <br>

     <pre>
     #include &lt;vm.nah&gt;                      sets the register names

     push_i      1, vmuse;                  switch vm on

     push_i      256, L0;
     mul_l       vmbsize, L0, vmbsize;      set 256 MB for swapfile

     push_i      10000, vmcachesize;        cache for 10000 elements
     </pre>



<a href="files_error.html" target="page">Prev: Files error codes</a> | <a href="memory_error.html" target="page">Next: Memory error codes</a>
                    </td>
                </tr>
            </table>
        </center>
    </body>
</html>
