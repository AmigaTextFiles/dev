<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
        <title>Nano vm - manual the basics</title>
    </head>
    <body bgcolor="white" text="black" link="#1025C3" vlink="red" alink="green">
        <center>
            <table border="0" width="640">
                <tr>
                    <td align="center">
                        <h1>Die Grundlagen</h1>
                    </td>
                </tr>
                <tr>
                    <td align="left">
Die nano virtuelle Maschine verwendet Register. Es gibt 32 Register für long int und<br>
32 Register für double Zahlen. Die mathematischen Befehle verwenden die Register. <br>
Deshalb muss eine Variable oder Konstante zuerst in ein Register geschoben werden. <br><br>

Dazu brauchen wir den "push" Befehl: <br><br>

    <pre>
    push_i  10, L0;
    </pre>

Schiebt die Konstante "10" in Register "L0". <br><br>

Um ein Register in eine Variable zu schreiben, brauchen wir den "pull" Befehl: <br><br>

    <pre>
    pull_i  L0, x;
    </pre>

Kopiert Register "L0" in die short int Variable "x". <br><br>

Sehen wir uns das in einem Beispiel an. Wir wollen "77 * 88" ausrechnen und das <br>
Ergebnis in der Variablen "x" speichern. Die Zeilennumern sind nur zur Referenz, sie sind <br>
kein Teil des Programms <br><br>

    <pre>
        calc_1.na

     1| int x;
     2|
     3| push_i  77, L0;
     4| push_i  88, L1;
     5| mul_l   L0, L1, L2;
     6| pull_i  L2, x;
     7|
     8| push_i  0, L4;
     9| exit    L4;
    </pre>

Die erste Zeile deklariert die Variable "x" als "int". <br><br>

In Zeile 5 multiplizieren wir: "L2 = L0 * L1". Das "L" for einem Register meint "long int". <br>
Deshlab benötigen wir hier den "mul_l" Befehl. <br><br>

Zeile 9 beendet das Programm und setzt den Return Wert für die Shell. <br>
Wir setzen "0", das bedutet kein Fehler. <br><br>

<b> Beachte: NIEMALS DEN "exit" BEFEHL VERGESSEN! <br>
DAS IST WICHTIG! <br>
Es ist auch darauf zu achten, dass das Programm den "exit" Befehl auch jemals erreicht! </b> <br><br>

Das Beispiel hat einen Nachteil, wir können das Ergebnis nicht sehen. <br>
Wir müssen es am Bildschirm ausgeben. Hier kommt der "print" Befehl ins Spiel: <br><br>

    <pre>
    print_l	L2;
    </pre>

Wie du siehst, ist er einfach zu verwenden. Nur das richtige Register wird benötigt. <br>
Aber wir wollen noch eine "neue Zeile" nach dem Ergebnis ausgeben, um eine formatierte <br>
Ausgabe zu bekommen: <br><br>

    <pre>
    push_i	1, L3;
    print_n	L3;
    </pre>

Der "print_n" Befehl gibt die Anzahl von neuen Zeilen aus, die im Register steht. <br>
Hier ist das neue Programm: <br><br>

    <pre>
        calc_2.na

     1| int x;
     2|
     3| push_i  77, L0;
     4| push_i  88, L1;
     5| mul_l   L0, L1, L2;
     6| pull_i  L2, x;
     7|
     8| print_l L2;
     9| push_i	1, L3;
    10| print_n L3;
    11|
    12| push_i  0, L4;
    13| exit    L4;
    </pre>
    
    <h2>Befehle</h2>

    <pre>
    L = long Register, D = double Register
    BV = byte Variable, IV = int Variable, LV = long int Variable
    DV = double Variable, SV = string Variable
    V = Variable, N = integer Variable
    
    {} = optional (arrays)
    </pre>

    <h3>Variable Deklaration</h3>

    <pre>
    byte            BV{[NV]};
    int             IV{[NV]};
    lint            LV{[NV]};
    double          DV{[NV]};
    string          SV[NV];
    </pre>
    
    <h3>Variable, Konstante zu Register</h3>
    
    <pre>
    push_b          BV, L;
    push_i          IV, L;
    push_l          LV, L;
    push_d          DV, D;
    </pre>
    
    <h3>Register zu Variable</h3>
    
    <pre>
    pull_b          L, BV;
    pull_i          L, IV;
    pull_l          L, LV;
    pull_d          D, DV;
    </pre>

    <h3>Register zu Register</h3>

    <pre>
    move_l          L1, L2;         L1 to L2
    move_d          D1, D2;         D1 to D2
    </pre>



<a href="console_input.html" target="page">Next: Konsole Eingabe</a>
                    </td>
                </tr>
            </table>
        </center>
    </body>
</html>

