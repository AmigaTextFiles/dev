USE CITWindow
USE CITMenus

DIM Terminate OF SHORT

Info

DIM Menu OF CITMenu
Menu.Title("Project",0,ProjectId)
Menu.Item("Open","O",0,0,PrcOpen(),OpenId)
Menu.Item("Save","",0,0,PrcSave(),SaveId)
Menu.Bar
Menu.Item("Print Mode","",0,0,PrcMode(),ModeId)
Menu.SubItem("Draft","",CHECKIT+CHECKED,%10,PrcMode(),DraftId)
Menu.SubItem("NLQ","",CHECKIT,%01,PrcMode(),NLQId)
Menu.Item("Print","P",0,0,PrcPrint(),PrintId)
Menu.Bar
Menu.Item("Quit","Q",0,0,PrcQuit(),QuitId)
Menu.Title("Edit",0,EditId)
Menu.Item("Cut","X",0,0,PrcCut(),CutId)
Menu.Item("Copy","C",0,0,PrcCopy(),CopyId)
Menu.Item("Paste","V",0,0,PrcPaste(),PasteId)
Menu.Bar
Menu.Item("Undo","Z",0,0,PrcUndo(),UndoId)
ComalWindow.InsObject(Menu,Error)
IF Error THEN
  PRINT "Could not create menu"
ELSE
  WHILE NOT Terminate DO WAIT
  ComalWindow.RemObject(Menu)
ENDIF

// ********** Event procedures *************

PROC PrcQuit(Num OF USHORT)
  Terminate:=TRUE
ENDPROC PrcQuit

PROC PrcOpen(Num OF USHORT)
ENDPROC PrcOpen

PROC PrcSave(Num OF USHORT)
ENDPROC PrcSave

PROC PrcMode(Num OF USHORT)
  CASE Num OF
  WHEN DraftId
    PRINT AT 15,50: "Draft print mode"
  WHEN NLQId
    PRINT AT 15,50: "NLQ print mode  "
  ENDCASE
ENDPROC PrcMode

PROC PrcPrint(Num OF USHORT)
ENDPROC PrcPrint

PROC PrcCut(Num OF USHORT)
ENDPROC PrcCut

PROC PrcCopy(Num OF USHORT)
ENDPROC PrcCopy

PROC PrcPaste(Num OF USHORT)
ENDPROC PrcPaste

PROC PrcUndo(Num OF USHORT)
ENDPROC PrcUndo

// *********** Information ************

PROC Info
  PRINT AT 5,10: "In fact this program does'nt do anything except waiting";
  PRINT AT 6,10: "for you to select the 'Print Mode' and 'Quit' menu."
  PRINT AT 8,10: "Try to select the Print Mode menu."
ENDPROC Info
