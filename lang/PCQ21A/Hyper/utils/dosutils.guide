@database Contents
@master PCQ:Hyper/utils/dosutils.guide
@$VER: 1.0
@author "Nils Sjoholm"
@(c) "@ Nils Sjoholm"

@node "Main" "Utils/DOSUtils"




                          Utils/DOSUtils

                          @{" APTRtoBPTR    " link "aptrtobptr" 0}
                          @{" BPTRtoAPTR    " link "bptrtoaptr" 0}
                          @{" GetFileHandle " link "getfilehandle" 0}












@endnode

@node "aptrtobptr" "Utils/DOSUtils/APTRtoBPTR"


    Utils/DOSUtils/APTRtoBPTR

    NAME
        APTRtoBPTR - convert an Address into a BCPL pointer

    SYNOPSIS
        FUNCTION APTRtoBPTR(a : Address) : BPTR;

    DESCRIPTION
        This function converts a normal Amiga Address into its
        equivalent BCPL pointer, or BPTR.  BCPL apparently
        looks at memory as a big array of longwords, Addresses
        have to be divided by four to be valid BPTRs.  This
        also means that BPTRs should never point to a memory
        location that is not longword aligned.

    EXAMPLE

        PROGRAM Convert;
        {$I "Include:Utils/DOSUtils.i"}
        VAR
            a : Address;
            b : Integer;
        BEGIN
            Write('Enter a decimal address: ');
            Readln(b);
            a := Address(b);
            Writeln('The equivalent BPTR is ', Integer(APTRtoBPTR(a)));
        END.

    INPUTS

        a     : A normal Amiga Address

    RESULTS
        The equivalent BPTR, which is just (a shr 2)

    BUGS

    SEE ALSO

        @{" BPTRtoAPTR " link "bptrtoaptr" 0}

@endnode

@node "bptrtoaptr" "Utils/DOSUtils/BPTRtoAPTR"

    Utils/DOSUtils/BPTRtoAPTR

    NAME
        BPTRtoAPTR - convert a BCPL pointer to an Address

    SYNOPSIS
        FUNCTION BPTRtoAPTR(b : BPTR) : Address;

    DESCRIPTION
        This function converts a BCPL pointer value into its
        equivalent Amiga address by multiplying the BPTR by
        four.

    EXAMPLE

        PROGRAM LocateInput;
        {$I "Include:Utils/DOSUtils.i"}
        BEGIN
            Writeln('The input file handle is at ',
                    Integer(BPTRtoAPTR(GetFileHandle(Input))));
        END.

    INPUTS

        b     : A BCPL pointer value, e.g. from an AmigaDOS record

    RESULTS
        The equivalent Amiga Address, which is just (b shl 4)

    BUGS

    SEE ALSO

        @{" APTRtoBPTR " link "aptrtobptr" 0}

@endnode

@node "getfilehandle" "Utils/DOSUtils/GetFileHandle"

    Utils/DOSUtils/GetFileHandle

    NAME
        GetFileHandle - return the AmigaDOS handle of a PCQ file

    SYNOPSIS
        FUNCTION GetFileHandle(VAR f : Text) : FileHandle;

    DESCRIPTION
        GetFileHandle returns the AmigaDOS FileHandle BPTR of the
        specified PCQ file so you can use it in DOS routines.

    EXAMPLE

        PROGRAM WhereFrom;
        {$I "Include:Utils/DOSUtils.i"}
        {$I "Include:Libraries/DOS.i"}
        BEGIN
            IF IsInteractive(GetFileHandle(Input)) THEN
                Writeln('Input is coming from the console')
            ELSE
                Writeln('Input is coming from a FILE');
        END.

    INPUTS

        f     : An open PCQ file variable

    RESULTS
        The associated AmigaDOS FileHandle

    BUGS

    SEE ALSO

        @{" IsInteractive " alink "Include:Dos/Dos.i/main" 284} @{" Seek          " alink "Include:Dos/Dos.i/main" 305} @{" DOSRead       " alink "Include:Dos/Dos.i/main" 299} @{" DOSWrite      " alink "Include:Dos/Dos.i/main" 320}

@endnode


