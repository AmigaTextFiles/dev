@database Contents
@master PCQ:Hyper/utils/timerutils.guide
@$VER: 1.0
@author "Nils Sjoholm"
@(c) "@ Nils Sjoholm"

@node "Main" "Utils/TimerUtils




                         Utils/TimerUtils


                          @{" CreateTimer " link "createtimer" 0}
                          @{" DeleteTimer " link "deletetimer" 0}
                          @{" GetSysTime  " link "getsystime" 0}
                          @{" SetTimer    " link "settimer" 0}
                          @{" WaitTimer   " link "waittimer" 0}














@endnode

@node "createtimer" "Utils/TimerUtils/CreateTimer"

    Utils/TimerUtils/CreateTimer

    NAME
        CreateTimer - open the timer.device and allocate an IO record

    SYNOPSIS
        FUNCTION CreateTimer(Unit : Integer) : TimeRequestPtr;

    DESCRIPTION
        CreateTimer opens the timer.device, allocates and initializes
        an IO structure, and passes back the IO structure address to
        use with the other TimerUtils routines.

        This routine initializes TimerBase, so you can also call
        SubTime, AddTime, etc.

    EXAMPLE
        See
           @{" Examples/Dry.p       " alink "PCQ:Examples/Dry.p/main" 0}
           @{" Examples/TimerTest.p " alink "PCQ:Examples/TimerTest.p/main" 0}
           @{" Examples/TimeProg.p  " alink "PCQ:Examples/TimeProg.p/main" 0}

    INPUTS

        Unit  : The unit of the timer.device that should be used.  This
                can be either UNIT_MICROHZ (0), which is highly
                accurate, or UNIT_VBLANK (1), which has less resolution
                but much less overhead.  UNIT_VBLANK should not be used
                if you intend to measure small time differences, less
                than a half second.

    RESULTS
        If everything goes correctly, CreateTimer returns a pointer
        to an initialized TimeRequest, or Nil if something went
        wrong.

    BUGS

    SEE ALSO

        @{" DeleteTimer " link "deletetimer" 0} @{" SetTimer    " link "settimer" 0} @{" WaitTimer   " link "waittimer" 0} @{" GetSysTime  " link "getsystime" 0}

@endnode

@node "deletetimer" "Utils/TimerUtils/DeleteTimer"

    Utils/TimerUtils/DeleteTimer

    NAME
        DeleteTimer - close the timer.device and free the IO record

    SYNOPSIS
        PROCEDURE DeleteTimer(WhichTimer : TimeRequestptr);

    DESCRIPTION
        DeleteTimer frees all the system resources allocated by
        CreateTimer.  It closes the timer.device, then deallocates
        the memory and port used for the TimeRequestPtr.

    EXAMPLE
        See
           @{" Examples/Dry.p       " alink "PCQ:Examples/Dry.p/main" 0}
           @{" Examples/TimerTest.p " alink "PCQ:Examples/TimerTest.p/main" 0}
           @{" Examples/TimeProg.p  " alink "PCQ:Examples/TimeProg.p/main" 0}

    INPUTS

        WhichTimer : A pointer to a TimeRequest record as returned
                     by CreateTimer

    RESULTS
        None

    BUGS

    SEE ALSO

        @{" CreateTimer " link "createtimer" 0}

@endnode

@node "getsystime" "Utils/TimerUtils/GetSysTime"

    Utils/TimerUtils/GetSysTime

    NAME
        GetSysTime - return the current system date and time

    SYNOPSIS
        PROCEDURE GetSysTime(WhichTimer : TimeRequestPtr;
                             VAR TV     : TimeVal);

    DESCRIPTION
        GetSysTime fills in the TimeVal structure with the current
        date and time, expressed as the number of seconds since
        midnight, January 1, 1978.

    EXAMPLE
        See
           @{" Examples/Dry.p       " alink "PCQ:Examples/Dry.p/main" 0}
           @{" Examples/TimerTest.p " alink "PCQ:Examples/TimerTest.p/main" 0}
           @{" Examples/TimeProg.p  " alink "PCQ:Examples/TimeProg.p/main" 0}

    INPUTS

        WhichTimer : A pointer to a TimeRequest record, returned by
                     CreateTimer.
        TV         : A TimeVal record to store the current time.

    RESULTS
        None

    BUGS

    SEE ALSO

        @{" CreateTimer    " link "createtimer" 0} @{" CurrentTime    " alink "Include:Intuition/Intuition.i/main" 1771} @{" DateStamp      " alink "Include:DOS/DOS.i/main" 251} @{" GetDescription " link "PCQ:Hyper/utils/datetools.guide/getdescription" 0}

@endnode

@node "settimer" "Utils/TimerUtils/SetTimer"

    Utils/TimerUtils/SetTimer

    NAME
        SetTimer - request to be notified at a given time

    SYNOPSIS
        FUNCTION SetTimer(WhichTimer   : TimeRequestPtr;
                          Seconds,
                          MicroSeconds : Integer) : MsgPortPtr;

    DESCRIPTION
        SetTimer asks the timer.device to notify the task sometime
        after the given number of seconds and microseconds.  When
        the timer.device returns SetTimer's request at the message
        port returned by this function, at least that many seconds
        and microseconds will have elapsed.

    EXAMPLE

        PROGRAM Wait10;
        {$I "Include:Utils/TimerUtils.i"}
        {$I "Include:Exec/Ports.i"}
        VAR
            MyTimer : TimeRequestPtr;
            MyPort  : MsgPortPtr;
            MyMsg   : MessagePtr;
        BEGIN
            MyTimer := CreateTimer(UNIT_VBLANK);
            MyPort  := SetTimer(MyTimer,10,0);
            MyMsg   := WaitPort(MyPort);
            MyMsg   := GetMsg(MyPort);
            Writeln('Ten seconds has elapsed');
            DeleteTimer(MyTimer);
        END.

    INPUTS

        WhichTimer   : A pointer to the TimeRequest record returned
                       by CreateTimer
        Seconds      : The number of seconds to wait
        MicroSeconds : The number of microseconds to wait

    RESULTS
        A pointer to the MsgPort from WhichTimer, which will receive
        the reply of the timer.device.

    BUGS

    SEE ALSO

        @{" CreateTimer " link "createtimer" 0} @{" Delay       " alink "Include:DOS/DOS.i/main" 254} @{" WaitTimer   " link "waittimer" 0} @{" GetSysTime  " link "getsystime" 0}

@endnode

@node "waittimer" "Utils/TimerUtils/WaitTimer"

    Utils/TimerUtils/WaitTimer

    NAME
        WaitTimer - wait for a given amount of time

    SYNOPSIS
        PROCEDURE WaitTimer(WhichTimer   : TimeRequestPtr;
                            Seconds,
                            MicroSeconds : Integer);

    DESCRIPTION
        This routine waits for at least the given number of
        seconds and microseconds, then returns.  If you want
        to continue processing while you wait, use SetTimer
        instead.

    EXAMPLE
        See
           @{" Examples/TimerTest.p " alink "PCQ:Examples/TimerTest.p/main" 0}

    INPUTS

        WhichTimer   : A pointer to the TimeRequest record returned
                       by CreateTimer
        Seconds      : The number of seconds to wait
        MicroSeconds : The number of microseconds to wait

    RESULTS
        None

    BUGS

    SEE ALSO

        @{" CreateTimer " link "createtimer" 0} @{" SetTimer    " link "settimer" 0} @{" Delay       " alink "Include:DOS/DOS.i/main" 254}


@endnode



