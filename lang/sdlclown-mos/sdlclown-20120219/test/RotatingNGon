// Animates a rotating polygon with n sides.
// Tweaked October 9, 2011 - fix n = 7, 10, etc.

#maparg SIDES_ARG 1

// Constants
sides = 1.0 * SIDES_ARG;
radius = 80.0;
center_x = 150.0;
center_y = 150.0;

start_deg = 0.0;
while(start_deg<=360)
{

// White BG
    @DrawRect (0) (0) (640) (480) (255) (255) (255);

// Draw n-gon using trigonometry
    deg = start_deg;
    prev_x = 0.0;
    prev_y = 0.0;

    while(deg <= (500+start_deg))
    {
        deg += (360 / sides);
        rad = deg/360 * (2*3.141);
        x = radius * cos(rad);
        y = radius * sin(rad);

        @DrawRect (center_x+x) (center_y+y) (2) (2) (0) (0) (0);

        if((prev_x+prev_y)!=0)
        {
            // Draw a line (easy to do with floats)
            tmp_x = x;
            tmp_y = y;
            x_dist = prev_x - x;
            y_dist = prev_y - y;
            dist = sqrt((x_dist*x_dist)+(y_dist*y_dist));
            x_d = x_dist / dist;
            y_d = y_dist / dist;

            count = 0;
            while(count<=dist)
            {
                count +=2;
                tmp_x += (2*x_d);
                tmp_y += (2*y_d);
                @DrawRect (center_x+tmp_x) (center_y+tmp_y) (2) (2) (0) (0) (0);
            }
        }

        prev_x = x;
        prev_y = y;
    }

    start_deg++;

    if(start_deg >= 360)
    {
        start_deg %= 360;
    }

    @LimitFPS (30);
    @FlipVideo;
}

