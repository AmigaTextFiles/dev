// Quick pong clone for SDL_clown
// Updated January 22, 2011

#define BALL_SIZE 15
#define COLOR_CYCLE_SPEED 5
#define BALL_SPEED 12

paddle.size = BALL_SIZE*4;
paddle.y = 0;

ball.size = BALL_SIZE;
ball.x = ball.size+1;
ball.y = ball.size+1;
ball.r = 0;
ball.g = 255;
ball.b = 0;

cycling.vel = COLOR_CYCLE_SPEED;
ball.xvel = BALL_SPEED;
ball.yvel = BALL_SPEED;

while(1)
{
    // Movement
    ball.x+=ball.xvel;
    ball.y+=ball.yvel;

    // Collisions
    if(ball.x>=(640-90-ball.size))
    {
        ball.xvel*=(0-1);
    }
    if(ball.x<=0)
    {
        ball.xvel*=(0-1);
    }
    if(ball.y>=(480-ball.size))
    {
        ball.yvel*=(0-1);
    }
    if(ball.y<=0)
    {
        ball.yvel*=(0-1);
    }
    if(ball.x<=(90+10))
    {
        if(ball.x>=90)
        {
            if(ball.y>=paddle.y)
            {
                if(ball.y<=(paddle.y+paddle.size))
                {
                    ball.xvel*=(0-1);
                }
            }
        }
    }

    // Color cycling !
    ball.r+=cycling.vel;
    ball.g-=cycling.vel;
    ball.b+=cycling.vel;
    if(ball.r<=0)
    {
        cycling.vel*=(0-1);
    }
    if(ball.r>=255)
    {
        cycling.vel*=(0-1);
    }

    // Paddles
    @GetMouseY paddle.y;

    // Graphics
    @DrawRect (0) (0) (640) (480) (0) (0) (0);
    @DrawRect (90) paddle.y (10) paddle.size (255) (255) (255)
    @DrawRect (640-90) (ball.y-(paddle.size/2)) (10) paddle.size (255) (255) (255)
    @DrawRect ball.x ball.y ball.size ball.size ball.r ball.g ball.b;
    @FlipVideo;

    // Framerate
    @LimitFPS (30);
}


