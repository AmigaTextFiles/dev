('   Starting TestNewGadTool...') print

amigatalk tracingOff

)i Amigatalk:User/UserGUI.st

amigatalk tracingOn

scr        <- amigatalk activeScreen
win        <- Window     new: 'Testing NewGadgets:'
userGUI    <- UserGUI    new
intuition  <- Intuition  new

tagDone <- intuition systemTag: #TAG_DONE

userGUI setScreen: scr

gadList <- GadgetSystem new: userGUI

xOffset <- scr getWBorLeftSize
yOffset <- scr getBarHeightSize

viObj   <- gadList visualInfo   " or use:  scr getVisualInfo: nil "

bType   <- intuition systemTag: #BUTTON_KIND
sType   <- intuition systemTag: #STRING_KIND
iType   <- intuition systemTag: #INTEGER_KIND

iTags   <- Array new: 7

iTags at: 1 put: (intuition systemTag: #GTIN_MaxChars)
iTags at: 2 put: 8
iTags at: 3 put: (intuition systemTag: #GTIN_Number)
iTags at: 4 put: 98765432
iTags at: 5 put: (intuition systemTag: #GT_Underscore)
iTags at: 6 put: $_
iTags at: 7 put: tagDone

bTags   <- Array new: 5

bTags at: 1 put: (intuition systemTag: #GA_ToggleSelect)
bTags at: 2 put: 1
bTags at: 3 put: (intuition systemTag: #GT_Underscore)
bTags at: 4 put: $_
bTags at: 5 put: tagDone

exitArray <- Array new: 12

exitArray at: 1  put: (xOffset + 4)
exitArray at: 2  put: (yOffset + 92)
exitArray at: 3  put: 87
exitArray at: 4  put: 19
exitArray at: 5  put: '_Exit'
exitArray at: 6  put: (gadList textAttributes)
exitArray at: 7  put: 1
exitArray at: 8  put: 0
exitArray at: 9  put: viObj
exitArray at: 10 put: #testButtonGadget " See method in NewGadget.st/ButtonGadget "
exitArray at: 11 put: bType
exitArray at: 12 put: $E

('   Creating the ButtonGadget...') print
exitButton <- ButtonGadget new: (exitArray at: 10)
exitButton setup: exitArray

getFileArray <- Array new: 12

amigatalk tracingOff

getFileArray at: 1  put: (xOffset + 425)
getFileArray at: 2  put: (yOffset + 37)
getFileArray at: 3  put: 20
getFileArray at: 4  put: 11
getFileArray at: 5  put: nil
getFileArray at: 6  put: nil
getFileArray at: 7  put: 2
getFileArray at: 8  put: 0
getFileArray at: 9  put: viObj
getFileArray at: 10 put: #testGetFileGadget
getFileArray at: 11 put: (intuition systemTag: #GENERIC_KIND)
getFileArray at: 12 put: nil

('   Creating the GetFileGadget...') print
fileButton <- GetFileGadget new: (getFileArray at: 10)
fileButton setup: getFileArray

intArray <- Array new: 12

intArray at: 1  put: (xOffset + 120)
intArray at: 2  put: (yOffset + 115)
intArray at: 3  put: 100
intArray at: 4  put: 20
intArray at: 5  put: 'Test _Integer:'
intArray at: 6  put: (gadList textAttributes)
intArray at: 7  put: 3
intArray at: 8  put: (intuition systemTag: #PLACETEXT_LEFT)
intArray at: 9  put: viObj
intArray at: 10 put: #testIntegerGadget
intArray at: 11 put: iType
intArray at: 12 put: $I

('   Creating the IntegerGadget...') print
intGadget <- IntegerGadget new: 45
intGadget setup: intArray

chkTags   <- Array new: 5

chkTags at: 1 put: (intuition systemTag: #GTCB_Checked)
chkTags at: 2 put: 1
chkTags at: 3 put: (intuition systemTag: #GT_Underscore)
chkTags at: 4 put: $_
chkTags at: 5 put: tagDone

chkArray <- Array new: 12

chkArray at: 1  put: (xOffset + 125)
chkArray at: 2  put: (yOffset + 75)
chkArray at: 3  put: 30
chkArray at: 4  put: 19
chkArray at: 5  put: '_CheckBox Test:'
chkArray at: 6  put: (gadList textAttributes)
chkArray at: 7  put: 4
chkArray at: 8  put: ((intuition systemTag: #PLACETEXT_LEFT) \
                    + (intuition systemTag: #NG_HIGHLABEL))    
chkArray at: 9  put: viObj
chkArray at: 10 put: #testCheckBoxGadget
chkArray at: 11 put: (intuition systemTag: #CHECKBOX_KIND)
chkArray at: 12 put: $C

('   Creating the CheckBoxGadget...') print
chkGadget <- CheckBoxGadget new: nil
chkGadget setup: chkArray

txtArray <- Array new: 12

txtArray at: 1  put: (xOffset + 125)
txtArray at: 2  put: (yOffset + 145)
txtArray at: 3  put: 200
txtArray at: 4  put: 19
txtArray at: 5  put: 'Text Test:'
txtArray at: 6  put: (gadList textAttributes)
txtArray at: 7  put: 5
txtArray at: 8  put: (intuition systemTag: #PLACETEXT_LEFT)
txtArray at: 9  put: viObj
txtArray at: 10 put: #testTextGadget
txtArray at: 11 put: (intuition systemTag: #TEXT_KIND)
txtArray at: 12 put: nil

txtTags <- Array new: 5

txtTags at: 1 put: (intuition systemTag: #GTTX_Text)
txtTags at: 2 put: 'Default Display Text'
txtTags at: 3 put: (intuition systemTag: #GTTX_Border)
txtTags at: 4 put: 1
txtTags at: 5 put: tagDone

('   Creating the TextGadget...') print
txtGadget <- TextGadget new: nil
txtGadget setup: txtArray

sTags   <- Array new: 7

sTags at: 1 put: (intuition systemTag: #GTST_MaxChars)
sTags at: 2 put: 80
sTags at: 3 put: (intuition systemTag: #STRINGA_Justification)
sTags at: 4 put: (intuition systemTag: #GACT_STRINGCENTER)
sTags at: 5 put: (intuition systemTag: #GT_Underscore)
sTags at: 6 put: $_
sTags at: 7 put: tagDone

strArray <- Array new: 12

strArray at: 1  put: (xOffset + 120)
strArray at: 2  put: (yOffset + 35)
strArray at: 3  put: 300
strArray at: 4  put: 20
strArray at: 5  put: '_Test String:'
strArray at: 6  put: (gadList textAttributes)
strArray at: 7  put: 6
strArray at: 8  put: (intuition systemTag: #PLACETEXT_LEFT)
strArray at: 9  put: viObj
strArray at: 10 put: #testStringGadget
strArray at: 11 put: sType
strArray at: 12 put: $T

('   Creating the StringGadget...') print
strGadget <- StringGadget new: nil
strGadget setup: strArray

numArray <- Array new: 12

numArray at: 1  put: (xOffset + 340)
numArray at: 2  put: (yOffset + 115)
numArray at: 3  put: 120
numArray at: 4  put: 20
numArray at: 5  put: 'Test Number:'
numArray at: 6  put: (gadList textAttributes)
numArray at: 7  put: 7
numArray at: 8  put: (intuition systemTag: #PLACETEXT_LEFT)
numArray at: 9  put: viObj
numArray at: 10 put: #testNumberGadget
numArray at: 11 put: (intuition systemTag: #NUMBER_KIND)
numArray at: 12 put: nil " Does NOT really do anything for read-only Gadgets "

numTags <- Array new: 7

numTags at: 1 put: (intuition systemTag: #GTNM_Number)
numTags at: 2 put: 16r10000000
numTags at: 3 put: (intuition systemTag: #GTNM_Border)
numTags at: 4 put: 1
numTags at: 5 put: (intuition systemTag: #GTNM_MaxChars)
numTags at: 6 put: 12
numTags at: 7 put: tagDone

('   Creating the NumberGadget...') print
numGadget <- NumberGadget new: 45
numGadget setup: numArray

palArray <- Array new: 12

palArray at: 1  put: (xOffset + 500)
palArray at: 2  put: (yOffset + 20)
palArray at: 3  put: 180
palArray at: 4  put: 120
palArray at: 5  put: 'Test _Palette:'
palArray at: 6  put: (gadList textAttributes)
palArray at: 7  put: 8
palArray at: 8  put: (intuition systemTag: #PLACETEXT_ABOVE)
palArray at: 9  put: viObj
palArray at: 10 put: #testPaletteGadget
palArray at: 11 put: (intuition systemTag: #PALETTE_KIND)
palArray at: 12 put: $P

palTags <- Array new: 7

palTags at: 1 put: (intuition systemTag: #GTPA_Depth)
palTags at: 2 put: 8
palTags at: 3 put: (intuition systemTag: #GTPA_Color)
palTags at: 4 put: 1
palTags at: 5 put: (intuition systemTag: #GT_Underscore)
palTags at: 6 put: $_
palTags at: 7 put: tagDone

('   Creating the PaletteGadget...') print
palGadget <- PaletteGadget new: 256
palGadget setup: palArray

cycArray <- Array new: 12

cycArray at: 1  put: (xOffset + 30)
cycArray at: 2  put: (yOffset + 190)
cycArray at: 3  put: 100
cycArray at: 4  put: 20
cycArray at: 5  put: 'Test C_ycle:'
cycArray at: 6  put: (gadList textAttributes)
cycArray at: 7  put: 9
cycArray at: 8  put: (intuition systemTag: #PLACETEXT_ABOVE)
cycArray at: 9  put: viObj
cycArray at: 10 put: #testCycleGadget
cycArray at: 11 put: (intuition systemTag: #CYCLE_KIND)
cycArray at: 12 put: $Y

('   Creating the CycleGadget...') print
cycGadget <- CycleGadget new: #( 'Cycler' 'Working...' 'Just Fine!' )
cycTags   <- Array       new: 7

cycTags at: 1 put: (intuition systemTag: #GTCY_Active)
cycTags at: 2 put: 2
cycTags at: 3 put: (intuition systemTag: #GT_Underscore)
cycTags at: 4 put: $_
cycTags at: 5 put: (intuition systemTag: #GTCY_Labels)
cycTags at: 6 put: (cycGadget choicesTag)              " NOTE WELL! "
cycTags at: 7 put: tagDone

cycGadget setup: cycArray

mxArray <- Array new: 12

mxArray at: 1  put: (xOffset + 160)
mxArray at: 2  put: (yOffset + 200)
mxArray at: 3  put: 20                        "Meaningless for MX_KIND"
mxArray at: 4  put: 20                        "Meaningless for MX_KIND"
mxArray at: 5  put: 'Test MX (Radio)'
mxArray at: 6  put: (gadList textAttributes)
mxArray at: 7  put: 10
mxArray at: 8  put: (intuition systemTag: #PLACETEXT_RIGHT)
mxArray at: 9  put: viObj
mxArray at: 10 put: #testMXGadget
mxArray at: 11 put: (intuition systemTag: #MX_KIND)
mxArray at: 12 put: nil                       "Meaningless for MX_KIND"
  
('   Creating the MXGadget...') print
mxGadget <- MXGadget new: #( 'Thin' 'Just right' 'Fat' )
mxTags   <- Array    new: 9

mxTags at: 1 put: (intuition systemTag: #GTMX_Active)
mxTags at: 2 put: 2
mxTags at: 3 put: (intuition systemTag: #GTMX_TitlePlace)
mxTags at: 4 put: (intuition systemTag: #PLACETEXT_ABOVE)
mxTags at: 5 put: (intuition systemTag: #GTMX_Spacing)
mxTags at: 6 put: 3
mxTags at: 7 put: (intuition systemTag: #GTMX_Labels)
mxTags at: 8 put: (mxGadget choicesTag)               " NOTE WELL! "
mxTags at: 9 put: tagDone

mxGadget setup: mxArray

lvArray <- Array new: 12

lvArray at: 1  put: (xOffset + 320)
lvArray at: 2  put: (yOffset + 200)
lvArray at: 3  put: 150
lvArray at: 4  put: 140
lvArray at: 5  put: 'Test _ListView:'
lvArray at: 6  put: (gadList textAttributes)
lvArray at: 7  put: 11
lvArray at: 8  put: (intuition systemTag: #PLACETEXT_ABOVE)
lvArray at: 9  put: viObj
lvArray at: 10 put: #testListViewGadget
lvArray at: 11 put: (intuition systemTag: #LISTVIEW_KIND)
lvArray at: 12 put: $L
  
('   Creating the ListViewGadget...') print
lvGadget <- ListViewGadget new: #( 'String0' 'String1' 'List Viewer' 'To the rescue!' )
lvTags   <- Array    new: 11

lvTags at: 1  put: (intuition systemTag: #GTLV_Selected)
lvTags at: 2  put: 1
lvTags at: 3  put: (intuition systemTag: #LAYOUTA_Spacing)
lvTags at: 4  put: 2
lvTags at: 5  put: (intuition systemTag: #GTLV_Labels)
lvTags at: 6  put: (lvGadget choicesTag)                 " NOTE WELL! "
lvTags at: 7  put: (intuition systemTag: #GT_Underscore)
lvTags at: 8  put: $_
lvTags at: 9  put: (intuition systemTag: #GTLV_ShowSelected)
lvTags at: 10 put: 0
lvTags at: 11 put: tagDone

lvGadget setup: lvArray

slideArray <- Array new: 12

slideArray at: 1  put: 20
slideArray at: 2  put: 300
slideArray at: 3  put: 150
slideArray at: 4  put: 20
slideArray at: 5  put: 'Test _Slider:'
slideArray at: 6  put: (gadList textAttributes)
slideArray at: 7  put: 12
slideArray at: 8  put: (intuition systemTag: #PLACETEXT_ABOVE)
slideArray at: 9  put: viObj
slideArray at: 10 put: #testSliderGadget
slideArray at: 11 put: (intuition systemTag: #SLIDER_KIND)
slideArray at: 12 put: $S
  
('   Creating the SliderGadget...') print
slGadget <- SliderGadget new: (intuition systemTag: #LORIENT_HORIZ)
slTags   <- Array    new: 19

slTags at:  1 put: (intuition systemTag: #GTSL_Min)
slTags at:  2 put: 0
slTags at:  3 put: (intuition systemTag: #GTSL_Max)
slTags at:  4 put: 50
slTags at:  5 put: (intuition systemTag: #GTSL_Level)
slTags at:  6 put: 20
slTags at:  7 put: (intuition systemTag: #GT_Underscore)
slTags at:  8 put: $_
slTags at:  9 put: (intuition systemTag: #GT_RelVerify)
slTags at: 10 put: 1
slTags at: 11 put: (intuition systemTag: #GA_Immediate)
slTags at: 12 put: 1
slTags at: 13 put: (intuition systemTag: #PGA_Freedom)
slTags at: 14 put: (intuition systemTag: #LORIENT_HORIZ)
slTags at: 15 put: (intuition systemTag: #GTSL_LevelFormat)
slTags at: 16 put: '%02ld'
slTags at: 17 put: (intuition systemTag: #GTSL_LevelPlace)
slTags at: 18 put: (intuition systemTag: #PLACETEXT_BELOW)
slTags at: 19 put: tagDone

slGadget setup: slideArray

slGadget setMin: 0 max: 50

('   Please wait for IDCMP Loop start...') print

firstGad <- gadList gadgetContext

next1 <- lvGadget   addToGList: gadList at: firstGad with: lvTags

next2 <- fileButton addToGList: gadList at: next1 with: nil
next3 <- intGadget  addToGList: gadList at: next2 with: iTags
next4 <- chkGadget  addToGList: gadList at: next3 with: chkTags
next5 <- txtGadget  addToGList: gadList at: next4 with: txtTags
next6 <- strGadget  addToGList: gadList at: next5 with: sTags
next7 <- numGadget  addToGList: gadList at: next6 with: numTags
next8 <- palGadget  addToGList: gadList at: next7 with: palTags
next9 <- cycGadget  addToGList: gadList at: next8 with: cycTags
nextA <- mxGadget   addToGList: gadList at: next9 with: mxTags
nextB <- exitButton addToGList: gadList at: nextA with: bTags
nextC <- slGadget   addToGList: gadList at: nextB with: slTags

wFlags <-  (intuition systemTag: #WFLG_ACTIVATE)
wFlags <- ((intuition systemTag: #WFLG_CLOSEGADGET) bitOr: wFlags)
wFlags <- ((intuition systemTag: #WFLG_DEPTHGADGET) bitOr: wFlags)
wFlags <- ((intuition systemTag: #WFLG_RMBTRAP)     bitOr: wFlags)

wIDCMP <-  (intuition systemTag: #IDCMP_CLOSEWINDOW)
wIDCMP <- ((intuition systemTag: #IDCMP_VANILLAKEY)    bitOr: wIDCMP)
wIDCMP <- ((intuition systemTag: #IDCMP_REFRESHWINDOW) bitOr: wIDCMP)
wIDCMP <- ((intuition systemTag: #PALETTEIDCMP)        bitOr: wIDCMP)
wIDCMP <- ((intuition systemTag: #BUTTONIDCMP)         bitOr: wIDCMP)
wIDCMP <- ((intuition systemTag: #CHECKBOXIDCMP)       bitOr: wIDCMP)
wIDCMP <- ((intuition systemTag: #CYCLEIDCMP)          bitOr: wIDCMP)
wIDCMP <- ((intuition systemTag: #INTEGERIDCMP)        bitOr: wIDCMP)
wIDCMP <- ((intuition systemTag: #STRINGIDCMP)         bitOr: wIDCMP)
wIDCMP <- ((intuition systemTag: #MXIDCMP)             bitOr: wIDCMP)
wIDCMP <- ((intuition systemTag: #LISTVIEWIDCMP)       bitOr: wIDCMP)
wIDCMP <- ((intuition systemTag: #SLIDERIDCMP)         bitOr: wIDCMP)

win setFlags:       wFlags
win setIDCMPFlags:  wIDCMP
win setFirstGadget: firstGad

win setWindowOrigin:    0 @   0
win setWindowSize:    800 @ 400

win openOnScreen: scr

userGUI setWindow: win

scr screenToFront

itxt1 <-IText new: 'Explore the various NewGadgets:'

itxt1 setPens:         3 @ 0
itxt1 setITextOrigin:  0 @ 0

win printIText: itxt1 at: 30 @ 30

userGUI addControl: exitButton named: 1
userGUI addControl: fileButton named: 2
userGUI addControl: intGadget  named: 3
userGUI addControl: chkGadget  named: 4
userGUI addControl: txtGadget  named: 5 " Does NOT do anything for read-only Gadgets "
userGUI addControl: strGadget  named: 6
userGUI addControl: numGadget  named: 7 " Does NOT do anything for read-only Gadgets "
userGUI addControl: palGadget  named: 8
userGUI addControl: cycGadget  named: 9
userGUI addControl: mxGadget   named: 10
userGUI addControl: lvGadget   named: 11
userGUI addControl: slGadget   named: 12

strGadget value: 'Enter your name in here!'
txtGadget value: 'Updated Text Contents'
intGadget value: 12345678
numGadget value: 16r7FFFFFFF

('   Starting the IDCMP loop...') print 

userGUI startUp " Here we stay until User asks for exit "

('   IDCMP loop terminated!') print

itxt1 dispose

win close
scr disposeVisualInfo: viObj

slGadget   dispose
lvGadget   dispose
mxGadget   dispose
cycGadget  dispose
palGadget  dispose
numGadget  dispose
chkGadget  dispose
intGadget  dispose
txtGadget  dispose
strGadget  dispose
exitButton dispose
fileButton dispose

gadList    dispose

('   TestNewGadTool done!') print
