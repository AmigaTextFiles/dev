scr <- Screen new: 16r40D20001
scr          open: 'Testing Screen'

win <- Window new: 'TestBitMaps Window'

win setFlags:       16r1100F
win setIDCMPFlags:  16r240     "IDCMP_CLOSEWINDOW + IDCMP_GADGETUP"
win openOnScreen:   scr

itxt <- IText new: 'Press Close Gadget when you are done!'  

itxt setPens:        6 @ 1
itxt setITextOrigin: 0 @ 0
itxt setDrawMode:    0       "JAM1 = 0"
itxt registerTo:     win
itxt setDrawMode:    0

win  printIText:  itxt at: 100 @ 390

bmap <- BitMap new

bmap grabScreenPiece: 'T:screenGrab' x: 0 y: 0 w: 320 h: 500

bmap setBitMapWidth: 200
bmap setBitMapHeight: 90
bmap setBitMapDepth:   8
bmap setBitMapFlags:  14 
bmap makeBitMap

bmap readBitMapFile:  'T:screenGrab'

bmap changeBitMapDepth: 4 "chop off 4 planes!"

bmap writeBitMapFile: 'T:writeBMapCheck'

chkscr <- Screen new: 16r40D20001

chkscr setBitMap: bmap

chkscr open: 'Hacked-up BitMap screen!'

" ---------------------------------------------
  Later:  
    bmap readBitMapFile: 'T:writeBMapCheck'
    bmap displayBitMap
  ---------------------------------------------
"

rval <- win handleIntuition     "Wait for the Close Gadget"

chkscr close

bmap   remove

itxt dispose

win  close
scr  close
