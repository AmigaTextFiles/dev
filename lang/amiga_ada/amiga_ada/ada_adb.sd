##stringtype C
##shortstrings
--****************************************************************
--   This file was created automatically by `FlexCat V1.3'
--   Do NOT edit by hand!
--****************************************************************/
with Text_IO; use Text_IO;
with Interfaces.C.Strings; use Interfaces.C.Strings;

with amiga; use amiga;
with Locale; use Locale;
with utility_tagitem; use utility_tagitem;

package body %b_Locale is

%b_Version : Integer := %v;
%b_BuiltInLanguage : Chars_Ptr := Allocate_String(%l);

%b_Catalog : Catalog_Ptr := Null_Catalog;

procedure Open%bCatalog(loc : Locale_Ptr; language : String) is

temp_taglist : TagListType := NewTagList;

begin

if Locale_Opened then
  Close%bCatalog;

  AddTag(temp_taglist,OC_BuiltInLanguage, %b_BuiltInLanguage );

  if %b_Catalog = Null_Catalog then
    if language'Length /= 0 then
      AddTag(temp_taglist,OC_Language, Allocate_String(language));
    end if;

    AddTag(temp_taglist,OC_Version, %b_Version);

    %b_Catalog := OpenCatalogA(loc, Allocate_String("%b.catalog"), temp_taglist);
  end if;
end if;

%i := ( %d, Allocate_String(%s) );

end Open%bCatalog;

procedure Close%bCatalog is
begin
if Locale_Opened and then %b_Catalog /= Null_Catalog then
 CloseCatalog(%b_Catalog);
 %b_Catalog := Null_Catalog;
end if;
end Close%bCatalog;

function Get%bString(FC : FC_Type) return String is

return_str : Chars_Ptr;

begin
if Locale_Opened then
  return_str := GetCatalogStr(%b_Catalog, FC.ID, FC.Str);
  if return_str /= Null_Ptr then
     return Value(return_str);
  end if;
end if;

return Value(FC.Str);

end Get%bString;

begin
   if OpenLocaleLibrary(0) then
      Locale_Opened := True;
      Open%bCatalog(Null_Locale,"");
      if %b_Catalog = Null_Catalog then
         Put_Line("Failed to open catalog");
      end if;
   else
      Put_Line("Failed to open Locale.library");
   end if;

end %b_Locale;
