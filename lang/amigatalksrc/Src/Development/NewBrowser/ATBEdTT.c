/*
 *  Source machine generated by GadToolsBox V2.0b
 *  which is (c) Copyright 1991-1993 Jaba Development
 *
 *  GUI Designed by : Jim Steichen
 */

#include <exec/types.h>
#include <intuition/intuition.h>
#include <intuition/classes.h>
#include <intuition/classusr.h>
#include <intuition/imageclass.h>
#include <intuition/gadgetclass.h>
#include <libraries/gadtools.h>
#include <graphics/displayinfo.h>
#include <graphics/gfxbase.h>
#include <clib/exec_protos.h>
#include <clib/intuition_protos.h>
#include <clib/gadtools_protos.h>
#include <clib/graphics_protos.h>
#include <clib/utility_protos.h>
#include <string.h>
#include <clib/diskfont_protos.h>

#define GD_BrowserLV                           0
#define GD_ATalkLV                             1
#define GD_BTTSaveBt                           2
#define GD_BTTRestoreBt                        3
#define GD_ATTSaveBt                           4
#define GD_ATTRestoreBt                        5
#define GD_CancelBt                            6

#define BTT_CNT 7

extern struct IntuitionBase *IntuitionBase;
extern struct Library       *GadToolsBase;

struct Screen         *Scr = NULL;
APTR                   VisualInfo = NULL;
struct Window         *BTTWnd = NULL;
struct Gadget         *BTTGList = NULL;
struct IntuiMessage    BTTMsg;
struct Gadget         *BTTGadgets[7];
UWORD                  BTTLeft = 14;
UWORD                  BTTTop = 14;
UWORD                  BTTWidth = 600;
UWORD                  BTTHeight = 260;
UBYTE                 *BTTWdt = (UBYTE *)"AmigaTalk ©1998 ToolTypes Editor:";
struct TextAttr       *Font, Attr;
UWORD                  FontX, FontY;
UWORD                  OffX, OffY;
struct TextFont       *BTTFont = NULL;

UWORD BTTGTypes[] = {
	LISTVIEW_KIND,
	LISTVIEW_KIND,
	BUTTON_KIND,
	BUTTON_KIND,
	BUTTON_KIND,
	BUTTON_KIND,
	BUTTON_KIND
};

PRIVATE int BrowserLVClicked( void );
PRIVATE int ATalkLVClicked( void );
PRIVATE int BTTSaveBtClicked( void );
PRIVATE int BTTRestoreBtClicked( void );
PRIVATE int ATTSaveBtClicked( void );
PRIVATE int ATTRestoreBtClicked( void );
PRIVATE int CancelBtClicked( void );

struct NewGadget BTTNGad[] = {
	6, 19, 291, 187, (UBYTE *)"Browser ToolTypes:", NULL, GD_BrowserLV, PLACETEXT_ABOVE|NG_HIGHLABEL, NULL, (APTR)BrowserLVClicked,
	304, 19, 291, 187, (UBYTE *)"AmigaTalk ToolTypes:", NULL, GD_ATalkLV, PLACETEXT_ABOVE|NG_HIGHLABEL, NULL, (APTR)ATalkLVClicked,
	6, 209, 56, 19, (UBYTE *)"SAVE!", NULL, GD_BTTSaveBt, PLACETEXT_IN, NULL, (APTR)BTTSaveBtClicked,
	218, 209, 79, 19, (UBYTE *)"RESTORE!", NULL, GD_BTTRestoreBt, PLACETEXT_IN, NULL, (APTR)BTTRestoreBtClicked,
	304, 209, 56, 19, (UBYTE *)"SAVE!", NULL, GD_ATTSaveBt, PLACETEXT_IN, NULL, (APTR)ATTSaveBtClicked,
	516, 209, 79, 19, (UBYTE *)"RESTORE!", NULL, GD_ATTRestoreBt, PLACETEXT_IN, NULL, (APTR)ATTRestoreBtClicked,
	208, 236, 169, 19, (UBYTE *)"_CANCEL ALL CHANGES!", NULL, GD_CancelBt, PLACETEXT_IN, NULL, (APTR)CancelBtClicked
};

ULONG BTTGTags[] = {
	(GTLV_ShowSelected), NULL, (LAYOUTA_Spacing), 2, (TAG_DONE),
	(GTLV_ShowSelected), NULL, (LAYOUTA_Spacing), 2, (TAG_DONE),
	(TAG_DONE),
	(TAG_DONE),
	(TAG_DONE),
	(TAG_DONE),
	(GT_Underscore), '_', (TAG_DONE)
};

UWORD DriPens[] = { ~0 };

// -------------------------------------------------------------------

PRIVATE int BrowserLVClicked( void )
{
	/* routine when gadget "Browser ToolTypes:" is clicked. */
}

PRIVATE int ATalkLVClicked( void )
{
	/* routine when gadget "AmigaTalk ToolTypes:" is clicked. */
}

PRIVATE int BTTSaveBtClicked( void )
{
	/* routine when gadget "SAVE!" is clicked. */
}

PRIVATE int BTTRestoreBtClicked( void )
{
	/* routine when gadget "RESTORE!" is clicked. */
}

PRIVATE int ATTSaveBtClicked( void )
{
	/* routine when gadget "SAVE!" is clicked. */
}

PRIVATE int ATTRestoreBtClicked( void )
{
	/* routine when gadget "RESTORE!" is clicked. */
}

PRIVATE int CancelBtClicked( void )
{
	/* routine when gadget "_CANCEL ALL CHANGES!" is clicked. */
}

PRIVATE int BTTCloseWindow( void )
{
	/* routine for "IDCMP_CLOSEWINDOW". */
}

PRIVATE int BTTVanillaKey( void )
{
	/* routine for "IDCMP_VANILLAKEY". */
}

// -------------------------------------------------------------------

int HandleBTTIDCMP( void )
{
	struct IntuiMessage	*m;
	int			(*func)();
	BOOL			running = TRUE;

	while( m = GT_GetIMsg( BTTWnd->UserPort )) {

		CopyMem(( char * )m, ( char * )&BTTMsg, (long)sizeof( struct IntuiMessage ));

		GT_ReplyIMsg( m );

		switch ( BTTMsg.Class ) {

			case	IDCMP_REFRESHWINDOW:
				GT_BeginRefresh( BTTWnd );
				GT_EndRefresh( BTTWnd, TRUE );
				break;

			case	IDCMP_CLOSEWINDOW:
				running = BTTCloseWindow();
				break;

			case	IDCMP_VANILLAKEY:
				running = BTTVanillaKey();
				break;

			case	IDCMP_GADGETUP:
			case	IDCMP_GADGETDOWN:
				func = ( void * )(( struct Gadget * )BTTMsg.IAddress )->UserData;
				running = func();
				break;
		}
	}
	return( running );
}

int OpenBTTWindow( void )
{
	struct NewGadget	ng;
	struct Gadget	*g;
	UWORD		lc, tc;
	UWORD		wleft = BTTLeft, wtop = BTTTop, ww, wh;

	ComputeFont( BTTWidth, BTTHeight );

	ww = ComputeX( BTTWidth );
	wh = ComputeY( BTTHeight );

	if (( wleft + ww + OffX + Scr->WBorRight ) > Scr->Width ) wleft = Scr->Width - ww;
	if (( wtop + wh + OffY + Scr->WBorBottom ) > Scr->Height ) wtop = Scr->Height - wh;

	if ( ! ( BTTFont = OpenDiskFont( Font )))
		return( 5L );

	if ( ! ( g = CreateContext( &BTTGList )))
		return( 1L );

	for( lc = 0, tc = 0; lc < BTT_CNT; lc++ ) {

		CopyMem((char * )&BTTNGad[ lc ], (char * )&ng, (long)sizeof( struct NewGadget ));

		ng.ng_VisualInfo = VisualInfo;
		ng.ng_TextAttr   = Font;
		ng.ng_LeftEdge   = OffX + ComputeX( ng.ng_LeftEdge );
		ng.ng_TopEdge    = OffY + ComputeY( ng.ng_TopEdge );
		ng.ng_Width      = ComputeX( ng.ng_Width );
		ng.ng_Height     = ComputeY( ng.ng_Height);

		BTTGadgets[ lc ] = g = CreateGadgetA((ULONG)BTTGTypes[ lc ], g, &ng, ( struct TagItem * )&BTTGTags[ tc ] );

		while( BTTGTags[ tc ] ) tc += 2;
		tc++;

		if ( NOT g )
			return( 2L );
	}

	if ( ! ( BTTWnd = OpenWindowTags( NULL,
				WA_Left,	wleft,
				WA_Top,		wtop,
				WA_Width,	ww + OffX + Scr->WBorRight,
				WA_Height,	wh + OffY + Scr->WBorBottom,
				WA_IDCMP,	LISTVIEWIDCMP|BUTTONIDCMP|IDCMP_CLOSEWINDOW|IDCMP_VANILLAKEY|IDCMP_REFRESHWINDOW,
				WA_Flags,	WFLG_DRAGBAR|WFLG_DEPTHGADGET|WFLG_CLOSEGADGET|WFLG_SMART_REFRESH|WFLG_ACTIVATE|WFLG_RMBTRAP,
				WA_Gadgets,	BTTGList,
				WA_Title,	BTTWdt,
				WA_ScreenTitle,	"AmigaTalk Browser © 1998",
				WA_CustomScreen,	Scr,
				TAG_DONE )))
	return( 4L );

	GT_RefreshWindow( BTTWnd, NULL );

	return( 0L );
}

void CloseBTTWindow( void )
{
	if ( BTTWnd        ) {
		CloseWindow( BTTWnd );
		BTTWnd = NULL;
	}

	if ( BTTGList      ) {
		FreeGadgets( BTTGList );
		BTTGList = NULL;
	}

	if ( BTTFont ) {
		CloseFont( BTTFont );
		BTTFont = NULL;
	}
}

