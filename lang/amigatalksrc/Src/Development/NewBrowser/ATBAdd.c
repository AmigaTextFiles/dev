/*
 *  Source machine generated by GadToolsBox V2.0b
 *  which is (c) Copyright 1991-1993 Jaba Development
 *
 *  GUI Designed by : Jim Steichen
 */

#include <exec/types.h>
#include <intuition/intuition.h>
#include <intuition/classes.h>
#include <intuition/classusr.h>
#include <intuition/imageclass.h>
#include <intuition/gadgetclass.h>
#include <libraries/gadtools.h>
#include <graphics/displayinfo.h>
#include <graphics/gfxbase.h>
#include <clib/exec_protos.h>
#include <clib/intuition_protos.h>
#include <clib/gadtools_protos.h>
#include <clib/graphics_protos.h>
#include <clib/utility_protos.h>
#include <string.h>
#include <clib/diskfont_protos.h>

#define GetString( g )      ((( struct StringInfo * )g->SpecialInfo )->Buffer  )

#define GD_ParentStr                           0
#define GD_CNameStr                            1
#define GD_FileNameStr                         2
#define GD_ClassLV                             3
#define GD_MethodsLV                           4
#define GD_InstanceLV                          5
#define GD_AddBt                               6
#define GD_CancelBt                            7

#define AC_CNT 8

extern struct IntuitionBase *IntuitionBase;
extern struct Library       *GadToolsBase;

struct Screen         *Scr = NULL;
APTR                   VisualInfo = NULL;
struct Window         *ACWnd = NULL;
struct Gadget         *ACGList = NULL;
struct IntuiMessage    ACMsg;
struct Gadget         *ACGadgets[8];
UWORD                  ACLeft = 0;
UWORD                  ACTop = 14;
UWORD                  ACWidth = 631;
UWORD                  ACHeight = 403;
UBYTE                 *ACWdt = (UBYTE *)"Submit New Class to AmigaTalk...";
struct TextAttr       *Font, Attr;
UWORD                  FontX, FontY;
UWORD                  OffX, OffY;
struct TextFont       *ACFont = NULL;

UWORD ACGTypes[] = {
	STRING_KIND,
	STRING_KIND,
	STRING_KIND,
	LISTVIEW_KIND,
	LISTVIEW_KIND,
	LISTVIEW_KIND,
	BUTTON_KIND,
	BUTTON_KIND
};

PRIVATE int ParentStrClicked( void );
PRIVATE int CNameStrClicked( void );
PRIVATE int FileNameStrClicked( void );
PRIVATE int ClassLVClicked( void );
PRIVATE int MethodsLVClicked( void );
PRIVATE int InstanceLVClicked( void );
PRIVATE int AddBtClicked( void );
PRIVATE int CancelBtClicked( void );

struct NewGadget ACNGad[] = {
	121, 4, 221, 18, (UBYTE *)"Parent Class:", NULL, GD_ParentStr, PLACETEXT_LEFT|NG_HIGHLABEL, NULL, (APTR)ParentStrClicked,
	121, 26, 221, 18, (UBYTE *)"Class Name:", NULL, GD_CNameStr, PLACETEXT_LEFT|NG_HIGHLABEL, NULL, (APTR)CNameStrClicked,
	121, 48, 221, 18, (UBYTE *)"File Name:", NULL, GD_FileNameStr, PLACETEXT_LEFT|NG_HIGHLABEL, NULL, (APTR)FileNameStrClicked,
	346, 19, 281, 352, (UBYTE *)"Classes:", NULL, GD_ClassLV, PLACETEXT_ABOVE|NG_HIGHLABEL, NULL, (APTR)ClassLVClicked,
	6, 84, 335, 176, (UBYTE *)"Enter Methods:", NULL, GD_MethodsLV, PLACETEXT_ABOVE|NG_HIGHLABEL, NULL, (APTR)MethodsLVClicked,
	6, 277, 335, 121, (UBYTE *)"Class Instance Variables:", NULL, GD_InstanceLV, PLACETEXT_ABOVE|NG_HIGHLABEL, NULL, (APTR)InstanceLVClicked,
	346, 380, 94, 18, (UBYTE *)"_ADD CLASS!", NULL, GD_AddBt, PLACETEXT_IN, NULL, (APTR)AddBtClicked,
	547, 380, 70, 18, (UBYTE *)"_CANCEL!", NULL, GD_CancelBt, PLACETEXT_IN, NULL, (APTR)CancelBtClicked
};

ULONG ACGTags[] = {
	(GTST_MaxChars), 256, (STRINGA_Justification), (GACT_STRINGCENTER), (TAG_DONE),
	(GTST_MaxChars), 256, (STRINGA_Justification), (GACT_STRINGCENTER), (TAG_DONE),
	(GTST_MaxChars), 256, (STRINGA_Justification), (GACT_STRINGCENTER), (TAG_DONE),
	(GTLV_ShowSelected), NULL, (LAYOUTA_Spacing), 2, (TAG_DONE),
	(GTLV_ShowSelected), NULL, (LAYOUTA_Spacing), 2, (TAG_DONE),
	(GTLV_ShowSelected), NULL, (LAYOUTA_Spacing), 2, (TAG_DONE),
	(GT_Underscore), '_', (TAG_DONE),
	(GT_Underscore), '_', (TAG_DONE)
};

UWORD DriPens[] = { ~0 };

// --------------------------------------------------------------------

PRIVATE int ParentStrClicked( void )
{
	/* routine when gadget "Parent Class:" is clicked. */
}

PRIVATE int CNameStrClicked( void )
{
	/* routine when gadget "Class Name:" is clicked. */
}

PRIVATE int FileNameStrClicked( void )
{
	/* routine when gadget "File Name:" is clicked. */
}

PRIVATE int ClassLVClicked( void )
{
	/* routine when gadget "Classes:" is clicked. */
}

PRIVATE int MethodsLVClicked( void )
{
	/* routine when gadget "Enter Methods:" is clicked. */
}

PRIVATE int InstanceLVClicked( void )
{
	/* routine when gadget "Class Instance Variables:" is clicked. */
}

PRIVATE int AddBtClicked( void )
{
	/* routine when gadget "_ADD CLASS!" is clicked. */
}

PRIVATE int CancelBtClicked( void )
{
	/* routine when gadget "_CANCEL!" is clicked. */
}

PRIVATE int ACCloseWindow( void )
{
	/* routine for "IDCMP_CLOSEWINDOW". */
}

PRIVATE int ACVanillaKey( void )
{
	/* routine for "IDCMP_VANILLAKEY". */
}
// --------------------------------------------------------------------

int HandleACIDCMP( void )
{
	struct IntuiMessage	*m;
	int			(*func)();
	BOOL			running = TRUE;

	while( m = GT_GetIMsg( ACWnd->UserPort )) {

		CopyMem(( char * )m, ( char * )&ACMsg, (long)sizeof( struct IntuiMessage ));

		GT_ReplyIMsg( m );

		switch ( ACMsg.Class ) {

			case	IDCMP_REFRESHWINDOW:
				GT_BeginRefresh( ACWnd );
				GT_EndRefresh( ACWnd, TRUE );
				break;

			case	IDCMP_CLOSEWINDOW:
				running = ACCloseWindow();
				break;

			case	IDCMP_VANILLAKEY:
				running = ACVanillaKey();
				break;

			case	IDCMP_GADGETUP:
			case	IDCMP_GADGETDOWN:
				func = ( void * )(( struct Gadget * )ACMsg.IAddress )->UserData;
				running = func();
				break;
		}
	}
	return( running );
}

int OpenACWindow( void )
{
	struct NewGadget	ng;
	struct Gadget	*g;
	UWORD		lc, tc;
	UWORD		wleft = ACLeft, wtop = ACTop, ww, wh;

	ComputeFont( ACWidth, ACHeight );

	ww = ComputeX( ACWidth );
	wh = ComputeY( ACHeight );

	if (( wleft + ww + OffX + Scr->WBorRight ) > Scr->Width ) wleft = Scr->Width - ww;
	if (( wtop + wh + OffY + Scr->WBorBottom ) > Scr->Height ) wtop = Scr->Height - wh;

	if ( ! ( ACFont = OpenDiskFont( Font )))
		return( 5L );

	if ( ! ( g = CreateContext( &ACGList )))
		return( 1L );

	for( lc = 0, tc = 0; lc < AC_CNT; lc++ ) {

		CopyMem((char * )&ACNGad[ lc ], (char * )&ng, (long)sizeof( struct NewGadget ));

		ng.ng_VisualInfo = VisualInfo;
		ng.ng_TextAttr   = Font;
		ng.ng_LeftEdge   = OffX + ComputeX( ng.ng_LeftEdge );
		ng.ng_TopEdge    = OffY + ComputeY( ng.ng_TopEdge );
		ng.ng_Width      = ComputeX( ng.ng_Width );
		ng.ng_Height     = ComputeY( ng.ng_Height);

		ACGadgets[ lc ] = g = CreateGadgetA((ULONG)ACGTypes[ lc ], g, &ng, ( struct TagItem * )&ACGTags[ tc ] );

		while( ACGTags[ tc ] ) tc += 2;
		tc++;

		if ( NOT g )
			return( 2L );
	}

	if ( ! ( ACWnd = OpenWindowTags( NULL,
				WA_Left,	wleft,
				WA_Top,		wtop,
				WA_Width,	ww + OffX + Scr->WBorRight,
				WA_Height,	wh + OffY + Scr->WBorBottom,
				WA_IDCMP,	STRINGIDCMP|LISTVIEWIDCMP|BUTTONIDCMP|IDCMP_CLOSEWINDOW|IDCMP_VANILLAKEY|IDCMP_REFRESHWINDOW,
				WA_Flags,	WFLG_DRAGBAR|WFLG_DEPTHGADGET|WFLG_CLOSEGADGET|WFLG_SMART_REFRESH|WFLG_ACTIVATE|WFLG_RMBTRAP,
				WA_Gadgets,	ACGList,
				WA_Title,	ACWdt,
				WA_ScreenTitle,	"AmigaTalk Browser © 1998",
				WA_CustomScreen,	Scr,
				TAG_DONE )))
	return( 4L );

	GT_RefreshWindow( ACWnd, NULL );

	return( 0L );
}

void CloseACWindow( void )
{
	if ( ACWnd        ) {
		CloseWindow( ACWnd );
		ACWnd = NULL;
	}

	if ( ACGList      ) {
		FreeGadgets( ACGList );
		ACGList = NULL;
	}

	if ( ACFont ) {
		CloseFont( ACFont );
		ACFont = NULL;
	}
}

