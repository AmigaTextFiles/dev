/*
 *  Source machine generated by GadToolsBox V2.0b
 *  which is (c) Copyright 1991-1993 Jaba Development
 *
 *  GUI Designed by : Jim Steichen
 */

#include <exec/types.h>
#include <intuition/intuition.h>
#include <intuition/classes.h>
#include <intuition/classusr.h>
#include <intuition/imageclass.h>
#include <intuition/gadgetclass.h>
#include <libraries/gadtools.h>
#include <graphics/displayinfo.h>
#include <graphics/gfxbase.h>
#include <clib/exec_protos.h>
#include <clib/intuition_protos.h>
#include <clib/gadtools_protos.h>
#include <clib/graphics_protos.h>
#include <clib/utility_protos.h>
#include <string.h>
#include <clib/diskfont_protos.h>

#define StrBfPtr( g ) (((struct StringInfo *)g->SpecialInfo)->Buffer)

#define GD_SrcLV                               0
#define GD_PrevBt                              1
#define GD_NextBt                              2
#define GD_MethodTxt                           3
#define GD_ParentTxt                           4
#define GD_CurrentTxt                          5
#define GD_SearchStr                           6
#define GD_ReplaceStr                          7

#define BE_CNT 8

extern struct IntuitionBase *IntuitionBase;
extern struct Library       *GadToolsBase;

struct Screen         *Scr = NULL;
APTR                   VisualInfo = NULL;
struct Window         *BEWnd = NULL;
struct Gadget         *BEGList = NULL;
struct Menu           *BEMenus = NULL;
struct IntuiMessage    BEMsg;
struct Gadget         *BEGadgets[8];
UWORD                  BELeft = 0;
UWORD                  BETop = 14;
UWORD                  BEWidth = 632;
UWORD                  BEHeight = 297;
UBYTE                 *BEWdt = (UBYTE *)"AmigaTalk © 1998 -- Methods Editor:";
struct TextAttr       *Font, Attr;
UWORD                  FontX, FontY;
UWORD                  OffX, OffY;
struct TextFont       *BEFont = NULL;

PRIVATE int BELoadMI( void );
PRIVATE int BESaveMI( void );
PRIVATE int BESaveAsMI( void );
PRIVATE int BEQuitMI( void );
PRIVATE int BEExternEdMI( void );
PRIVATE int BEEditTTMI( void );
PRIVATE int BEAddClassMI( void );
PRIVATE int BEDeleteMI( void );
PRIVATE int BEClassTopMI( void );
PRIVATE int BEFileTopMI( void );
PRIVATE int BEClassEndMI( void );
PRIVATE int BEFileBottMI( void );
PRIVATE int BEEOLKillMI( void );
PRIVATE int BELineKillMI( void );
PRIVATE int BESearchWholeMI( void );
PRIVATE int BESearchLowUpMI( void );
PRIVATE int BEReplaceWholeMI( void );
PRIVATE int BEReplaceLowUpMI( void );
PRIVATE int BEReplaceAllMI( void );
PRIVATE int BEGeneralMI( void );
PRIVATE int BEIntuitionMI( void );
PRIVATE int BESystemMI( void );
PRIVATE int BEUserMI( void );


struct NewMenu BENewMenu[] = {
	NM_TITLE, (STRPTR)"PROJECT", NULL, 0, NULL, NULL,
	NM_ITEM, (STRPTR)"Load..", (STRPTR)"L", 0, 0L, (APTR)BELoadMI,
	NM_ITEM, (STRPTR)"Save", (STRPTR)"S", 0, 0L, (APTR)BESaveMI,
	NM_ITEM, (STRPTR)"Save As..", (STRPTR)"A", 0, 0L, (APTR)BESaveAsMI,
	NM_ITEM, (STRPTR)"Quit", (STRPTR)"Q", 0, 0L, (APTR)BEQuitMI,
	NM_TITLE, (STRPTR)"COMMANDS", NULL, 0, NULL, NULL,
	NM_ITEM, (STRPTR)"Use External Editor...", NULL, 0, 0L, (APTR)BEExternEdMI,
	NM_ITEM, (STRPTR)"Edit ToolTypes...", NULL, 0, 0L, (APTR)BEEditTTMI,
	NM_ITEM, (STRPTR)"Add New Class...", (STRPTR)"N", 0, 0L, (APTR)BEAddClassMI,
	NM_ITEM, (STRPTR)"Delete a Class...", NULL, 0, 0L, (APTR)BEDeleteMI,
	NM_TITLE, (STRPTR)"EDIT", NULL, 0, NULL, NULL,
	NM_ITEM, (STRPTR)"Top of Class", (STRPTR)"T", 0, 0L, (APTR)BEClassTopMI,
	NM_ITEM, (STRPTR)"Top of File", (STRPTR)"F", 0, 0L, (APTR)BEFileTopMI,
	NM_ITEM, (STRPTR)"End of Class", (STRPTR)"E", 0, 0L, (APTR)BEClassEndMI,
	NM_ITEM, (STRPTR)"Bott of File", (STRPTR)"B", 0, 0L, (APTR)BEFileBottMI,
	NM_ITEM, (STRPTR)"Kill to EOL", (STRPTR)"Y", 0, 0L, (APTR)BEEOLKillMI,
	NM_ITEM, (STRPTR)"Kill the Line", (STRPTR)"K", 0, 0L, (APTR)BELineKillMI,
	NM_TITLE, (STRPTR)"SEARCH_REPLACE", NULL, 0, NULL, NULL,
	NM_ITEM, (STRPTR)"Search for Whole words", NULL, CHECKIT|CHECKED|MENUTOGGLE, 0L, (APTR)BESearchWholeMI,
	NM_ITEM, (STRPTR)"Search lower = UPPER case", NULL, CHECKIT|MENUTOGGLE, 0L, (APTR)BESearchLowUpMI,
	NM_ITEM, (STRPTR)"Replace by Whole word", NULL, CHECKIT|MENUTOGGLE, 0L, (APTR)BEReplaceWholeMI,
	NM_ITEM, (STRPTR)"Replace lower = UPPER case", NULL, CHECKIT|MENUTOGGLE, 0L, (APTR)BEReplaceLowUpMI,
	NM_ITEM, (STRPTR)"Replace ALL occurrences", NULL, CHECKIT|MENUTOGGLE, 0L, (APTR)BEReplaceAllMI,
	NM_TITLE, (STRPTR)"INFO", NULL, 0, NULL, NULL,
	NM_ITEM, (STRPTR)"General   Classes", NULL, CHECKIT|CHECKED|MENUTOGGLE, 0L, (APTR)BEGeneralMI,
	NM_ITEM, (STRPTR)"Intuition Classes", NULL, CHECKIT|MENUTOGGLE, 0L, (APTR)BEIntuitionMI,
	NM_ITEM, (STRPTR)"System    Classes", NULL, CHECKIT|MENUTOGGLE, 0L, (APTR)BESystemMI,
	NM_ITEM, (STRPTR)"User      Classes", NULL, CHECKIT|MENUTOGGLE, 0L, (APTR)BEUserMI,
	NM_END, NULL, NULL, 0, 0L, NULL };

UWORD BEGTypes[] = {
	LISTVIEW_KIND,
	BUTTON_KIND,
	BUTTON_KIND,
	TEXT_KIND,
	TEXT_KIND,
	TEXT_KIND,
	STRING_KIND,
	STRING_KIND
};

PRIVATE int SrcLVClicked( void );
PRIVATE int PrevBtClicked( void );
PRIVATE int NextBtClicked( void );
PRIVATE int SearchStrClicked( void );
PRIVATE int ReplaceStrClicked( void );


struct NewGadget BENGad[] = {
	6, 19, 621, 176, (UBYTE *)"Current Method Source:", NULL, GD_SrcLV, PLACETEXT_ABOVE|NG_HIGHLABEL, NULL, (APTR)SrcLVClicked,
	364, 198, 66, 18, (UBYTE *)" « PREV ", NULL, GD_PrevBt, PLACETEXT_IN, NULL, (APTR)PrevBtClicked,
	443, 198, 66, 18, (UBYTE *)" NEXT » ", NULL, GD_NextBt, PLACETEXT_IN, NULL, (APTR)NextBtClicked,
	136, 198, 221, 18, (UBYTE *)"Current Method:", NULL, GD_MethodTxt, PLACETEXT_LEFT, NULL, NULL,
	136, 221, 221, 18, (UBYTE *)"Parent Class:", NULL, GD_ParentTxt, PLACETEXT_LEFT, NULL, NULL,
	136, 244, 221, 18, (UBYTE *)"Current Class:", NULL, GD_CurrentTxt, PLACETEXT_LEFT, NULL, NULL,
	115, 271, 191, 18, (UBYTE *)"Search For:", NULL, GD_SearchStr, PLACETEXT_LEFT|NG_HIGHLABEL, NULL, (APTR)SearchStrClicked,
	427, 271, 191, 18, (UBYTE *)"Replace With:", NULL, GD_ReplaceStr, PLACETEXT_LEFT|NG_HIGHLABEL, NULL, (APTR)ReplaceStrClicked
};

ULONG BEGTags[] = {
	(GTLV_ShowSelected), NULL, (LAYOUTA_Spacing), 2, (TAG_DONE),
	(TAG_DONE),
	(TAG_DONE),
	(GTTX_Border), TRUE, (TAG_DONE),
	(GTTX_Border), TRUE, (TAG_DONE),
	(GTTX_Border), TRUE, (TAG_DONE),
	(GTST_MaxChars), 256, (STRINGA_Justification), (GACT_STRINGCENTER), (TAG_DONE),
	(GTST_MaxChars), 256, (STRINGA_Justification), (GACT_STRINGCENTER), (TAG_DONE)
};

UWORD DriPens[] = { ~0 };

// ---------------------------------------------------------------------

PRIVATE int SrcLVClicked( void )
{
	/* routine when gadget "Current Method Source:" is clicked. */
}

PRIVATE int PrevBtClicked( void )
{
	/* routine when gadget " « PREV " is clicked. */
}

PRIVATE int NextBtClicked( void )
{
	/* routine when gadget " NEXT » " is clicked. */
}

PRIVATE int SearchStrClicked( void )
{
	/* routine when gadget "Search For:" is clicked. */
}

PRIVATE int ReplaceStrClicked( void )
{
	/* routine when gadget "Replace With:" is clicked. */
}

PRIVATE int BELoadMI( void )
{
	/* routine when (sub)item "Load.." is selected. */
}

PRIVATE int BESaveMI( void )
{
	/* routine when (sub)item "Save" is selected. */
}

PRIVATE int BESaveAsMI( void )
{
	/* routine when (sub)item "Save As.." is selected. */
}

PRIVATE int BEQuitMI( void )
{
	/* routine when (sub)item "Quit" is selected. */
}

PRIVATE int BEExternEdMI( void )
{
	/* routine when (sub)item "Use External Editor..." is selected. */
}

PRIVATE int BEEditTTMI( void )
{
	/* routine when (sub)item "Edit ToolTypes..." is selected. */
}

PRIVATE int BEAddClassMI( void )
{
	/* routine when (sub)item "Add New Class..." is selected. */
}

PRIVATE int BEDeleteMI( void )
{
	/* routine when (sub)item "Delete a Class..." is selected. */
}

PRIVATE int BEClassTopMI( void )
{
	/* routine when (sub)item "Top of Class" is selected. */
}

PRIVATE int BEFileTopMI( void )
{
	/* routine when (sub)item "Top of File" is selected. */
}

PRIVATE int BEClassEndMI( void )
{
	/* routine when (sub)item "End of Class" is selected. */
}

PRIVATE int BEFileBottMI( void )
{
	/* routine when (sub)item "Bott of File" is selected. */
}

PRIVATE int BEEOLKillMI( void )
{
	/* routine when (sub)item "Kill to EOL" is selected. */
}

PRIVATE int BELineKillMI( void )
{
	/* routine when (sub)item "Kill the Line" is selected. */
}

PRIVATE int BESearchWholeMI( void )
{
	/* routine when (sub)item "Search for Whole words" is selected. */
}

PRIVATE int BESearchLowUpMI( void )
{
	/* routine when (sub)item "Search lower = UPPER case" is selected. */
}

PRIVATE int BEReplaceWholeMI( void )
{
	/* routine when (sub)item "Replace by Whole word" is selected. */
}

PRIVATE int BEReplaceLowUpMI( void )
{
	/* routine when (sub)item "Replace lower = UPPER case" is selected. */
}

PRIVATE int BEReplaceAllMI( void )
{
	/* routine when (sub)item "Replace ALL occurrences" is selected. */
}

PRIVATE int BEGeneralMI( void )
{
	/* routine when (sub)item "General   Classes" is selected. */
}

PRIVATE int BEIntuitionMI( void )
{
	/* routine when (sub)item "Intuition Classes" is selected. */
}

PRIVATE int BESystemMI( void )
{
	/* routine when (sub)item "System    Classes" is selected. */
}

PRIVATE int BEUserMI( void )
{
	/* routine when (sub)item "User      Classes" is selected. */
}

PRIVATE int BECloseWindow( void )
{
	/* routine for "IDCMP_CLOSEWINDOW". */
}

// ---------------------------------------------------------------------

int HandleBEIDCMP( void )
{
	struct IntuiMessage	*m;
	struct MenuItem		*n;
	int			(*func)();
	BOOL			running = TRUE;

	while( m = GT_GetIMsg( BEWnd->UserPort )) {

		CopyMem(( char * )m, ( char * )&BEMsg, (long)sizeof( struct IntuiMessage ));

		GT_ReplyIMsg( m );

		switch ( BEMsg.Class ) {

			case	IDCMP_REFRESHWINDOW:
				GT_BeginRefresh( BEWnd );
				GT_EndRefresh( BEWnd, TRUE );
				break;

			case	IDCMP_CLOSEWINDOW:
				running = BECloseWindow();
				break;

			case	IDCMP_GADGETUP:
			case	IDCMP_GADGETDOWN:
				func = ( void * )(( struct Gadget * )BEMsg.IAddress )->UserData;
				running = func();
				break;

			case	IDCMP_MENUPICK:
				while( BEMsg.Code != MENUNULL ) {
					n = ItemAddress( BEMenus, BEMsg.Code );
					func = (void *)(GTMENUITEM_USERDATA( n ));
					running = func();
					BEMsg.Code = n->NextSelect;
				}
				break;
		}
	}
	return( running );
}

int OpenBEWindow( void )
{
	struct NewGadget	ng;
	struct Gadget	*g;
	UWORD		lc, tc;
	UWORD		wleft = BELeft, wtop = BETop, ww, wh;

	ComputeFont( BEWidth, BEHeight );

	ww = ComputeX( BEWidth );
	wh = ComputeY( BEHeight );

	if (( wleft + ww + OffX + Scr->WBorRight ) > Scr->Width ) wleft = Scr->Width - ww;
	if (( wtop + wh + OffY + Scr->WBorBottom ) > Scr->Height ) wtop = Scr->Height - wh;

	if ( ! ( BEFont = OpenDiskFont( Font )))
		return( 5L );

	if ( ! ( g = CreateContext( &BEGList )))
		return( 1L );

	for( lc = 0, tc = 0; lc < BE_CNT; lc++ ) {

		CopyMem((char * )&BENGad[ lc ], (char * )&ng, (long)sizeof( struct NewGadget ));

		ng.ng_VisualInfo = VisualInfo;
		ng.ng_TextAttr   = Font;
		ng.ng_LeftEdge   = OffX + ComputeX( ng.ng_LeftEdge );
		ng.ng_TopEdge    = OffY + ComputeY( ng.ng_TopEdge );
		ng.ng_Width      = ComputeX( ng.ng_Width );
		ng.ng_Height     = ComputeY( ng.ng_Height);

		BEGadgets[ lc ] = g = CreateGadgetA((ULONG)BEGTypes[ lc ], g, &ng, ( struct TagItem * )&BEGTags[ tc ] );

		while( BEGTags[ tc ] ) tc += 2;
		tc++;

		if ( NOT g )
			return( 2L );
	}

	if ( ! ( BEMenus = CreateMenus( BENewMenu, GTMN_FrontPen, 0L, TAG_DONE )))
		return( 3L );

	LayoutMenus( BEMenus, VisualInfo, TAG_DONE );

	if ( ! ( BEWnd = OpenWindowTags( NULL,
				WA_Left,	wleft,
				WA_Top,		wtop,
				WA_Width,	ww + OffX + Scr->WBorRight,
				WA_Height,	wh + OffY + Scr->WBorBottom,
				WA_IDCMP,	LISTVIEWIDCMP|BUTTONIDCMP|TEXTIDCMP|STRINGIDCMP|IDCMP_MENUPICK|IDCMP_CLOSEWINDOW|IDCMP_REFRESHWINDOW,
				WA_Flags,	WFLG_DRAGBAR|WFLG_DEPTHGADGET|WFLG_CLOSEGADGET|WFLG_SMART_REFRESH|WFLG_ACTIVATE,
				WA_Gadgets,	BEGList,
				WA_Title,	BEWdt,
				WA_ScreenTitle,	"AmigaTalk Browser ©1998",
				WA_CustomScreen,	Scr,
				TAG_DONE )))
	return( 4L );

	SetMenuStrip( BEWnd, BEMenus );
	GT_RefreshWindow( BEWnd, NULL );

	return( 0L );
}

void CloseBEWindow( void )
{
	if ( BEMenus      ) {
		ClearMenuStrip( BEWnd );
		FreeMenus( BEMenus );
		BEMenus = NULL;	}

	if ( BEWnd        ) {
		CloseWindow( BEWnd );
		BEWnd = NULL;
	}

	if ( BEGList      ) {
		FreeGadgets( BEGList );
		BEGList = NULL;
	}

	if ( BEFont ) {
		CloseFont( BEFont );
		BEFont = NULL;
	}
}

