<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 3.0//EN">
<!--Converted with LaTeX2HTML 96.1-h (September 30, 1996) by Nikos Drakos (nikos@cbl.leeds.ac.uk), CBLU, University of Leeds -->
<HTML>
<HEAD>
<TITLE>Structured Types</TITLE>
<META NAME="description" CONTENT="Structured Types">
<META NAME="keywords" CONTENT="ref">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<LINK REL=STYLESHEET HREF="ref.css">
</HEAD>
<BODY LANG="EN" >
 <A NAME="tex2html574" HREF="node20.html"><IMG WIDTH=37 HEIGHT=24 ALIGN=BOTTOM ALT="next" SRC="file:/usr/lib/latex2html/icons/next_motif.gif"></A> <A NAME="tex2html572" HREF="node16.html"><IMG WIDTH=26 HEIGHT=24 ALIGN=BOTTOM ALT="up" SRC="file:/usr/lib/latex2html/icons/up_motif.gif"></A> <A NAME="tex2html566" HREF="node18.html"><IMG WIDTH=63 HEIGHT=24 ALIGN=BOTTOM ALT="previous" SRC="file:/usr/lib/latex2html/icons/previous_motif.gif"></A> <A NAME="tex2html576" HREF="node1.html"><IMG WIDTH=65 HEIGHT=24 ALIGN=BOTTOM ALT="contents" SRC="file:/usr/lib/latex2html/icons/contents_motif.gif"></A> <A NAME="tex2html577" HREF="node72.html"><IMG WIDTH=43 HEIGHT=24 ALIGN=BOTTOM ALT="index" SRC="file:/usr/lib/latex2html/icons/index_motif.gif"></A> <BR>
<B> Next:</B> <A NAME="tex2html575" HREF="node20.html">Pointers</A>
<B>Up:</B> <A NAME="tex2html573" HREF="node16.html">Types</A>
<B> Previous:</B> <A NAME="tex2html567" HREF="node18.html">Character types</A>
<BR> <P>
<H1><A NAME="SECTION03330000000000000000">Structured Types</A></H1>
<P>
A structured type is a type that can hold multiple values in one variable.
Stuctured types can be nested to unlimited levels.
<P>
<BLOCKQUOTE> <BR><b>  Structured Types</b><BR><BR><IMG WIDTH=327 HEIGHT=16 ALIGN=BOTTOM ALT="syntdiag1447" SRC="img59.gif"><BR></BLOCKQUOTE>
<P>
Unlike Delphi, Free Pascal does not support the keyword <tt>Packed</tt> for all
structured types, as can be seen in the syntax diagram. It will be mentioned
when a type supports the <tt>packed</tt> keyword.
<P>
In the following, each of the possible structured types is discussed.
<P>
<H2><A NAME="SECTION03331000000000000000">Arrays</A></H2>
<P>
Free Pascal supports arrays as in Turbo Pascal, multi-dimensional arrays 
and packed arrays are also supported:
<P>
<BLOCKQUOTE> <BR><b>  Array types</b><BR><BR><IMG WIDTH=442 HEIGHT=16 ALIGN=BOTTOM ALT="syntdiag1489" SRC="img60.gif"><BR></BLOCKQUOTE>
<P>
The following is a valid array declaration:
<BR><IMG WIDTH=346 HEIGHT=16 ALIGN=BOTTOM ALT="listing1468" SRC="img61.gif"><BR>
<P>
As in Turbo Pascal, if the array component type is in itself an array, it is
possible to combine the two arrays into one multi-dimensional array. The
following declaration:
<BR><IMG WIDTH=576 HEIGHT=30 ALIGN=BOTTOM ALT="listing1470" SRC="img62.gif"><BR>
is equivalent to the following declaration:
<BR><IMG WIDTH=576 HEIGHT=47 ALIGN=BOTTOM ALT="listing1472" SRC="img63.gif"><BR>
<P>
The functions <A HREF="node71.html#fuHigh">High</A> and <A HREF="node71.html#fuLow">Low</A> return the high and low bounds of
the leftmost index type of the array. In the above case, this would be 100 
and 1.
<P>
<H2><A NAME="SECTION03332000000000000000">Record types</A></H2>
<P>
Free Pascal supports fixed records and records with variant parts. 
The syntax diagram for a record type is
<P>
<BLOCKQUOTE> <BR><b> Record types</b><BR>
<BR><IMG WIDTH=576 HEIGHT=29 ALIGN=BOTTOM ALT="syntdiag1599" SRC="img64.gif"><BR>
<BR><IMG WIDTH=576 HEIGHT=66 ALIGN=BOTTOM ALT="syntdiag1603" SRC="img65.gif"><BR>
<BR><IMG WIDTH=576 HEIGHT=28 ALIGN=BOTTOM ALT="syntdiag1607" SRC="img66.gif"><BR>
<BR><IMG WIDTH=335 HEIGHT=242 ALIGN=BOTTOM ALT="syntdiag1611" SRC="img67.gif"><BR>
<BR><IMG WIDTH=308 HEIGHT=147 ALIGN=BOTTOM ALT="syntdiag1615" SRC="img68.gif"><BR>
</BLOCKQUOTE>
<P>
So the following are valid record types declarations:
<BR><IMG WIDTH=396 HEIGHT=451 ALIGN=BOTTOM ALT="listing1535" SRC="img69.gif"><BR>
<P>
The variant part must be last in the record. The optional identifier in the
case statement serves to access the tag field value, which otherwise would
be invisible to the programmer. It can be used to see which variant is 
active at a certain time. In effect, it introduces a new field in the
record.
<P>
Remark that it is possible to  nest variant parts, as in:
<BR><IMG WIDTH=130 HEIGHT=13 ALIGN=BOTTOM ALT="listing1537" SRC="img70.gif"><BR>
<P>
The size of a record is the sum of the sizes of its fields, each size of a
field is rounded up to two. If the record contains a variant part, the size
of the variant part is the size of the biggest variant, plus the size of the
tag field type <EM>if an identifier was declared for it</EM>. Here also, the size of 
each part is first rounded up to two. So in the above example, 
<A HREF="node71.html#fuSizeOf">SizeOf</A> would return 24 for <tt>Point</tt>, 24 for <tt>RPoint</tt> and 
26 for <tt>BetterRPoint</tt>. For <tt>MyRec</tt>, the value would be 12.
<P>
If you want to read a typed file with records, produced by
a Turbo Pascal program, then chances are that you will not succeed in
reading that file correctly.
<P>
The reason for this is that by default, elements of a record are aligned at
2-byte boundaries, for performance reasons. This default behaviour can be
changed with the <tt>{$PackRecords n}</tt> switch. Possible values for
<tt>n</tt> are 1, 2, 4, 16 or <tt>Default</tt>. 
This switch tells the compiler to align elements of a record or object or 
class on 1,2,4 or 16 byte boundaries. The keyword <tt>Default</tt> selects the
default value for the platform you're working on (currently 2 on all
platforms)
<P>
Take a look at the following program:
<BR><IMG WIDTH=394 HEIGHT=164 ALIGN=BOTTOM ALT="listing1549" SRC="img71.gif"><BR>
The output of this program will be :
<BR><IMG WIDTH=81 HEIGHT=51 ALIGN=BOTTOM ALT="listing1553" SRC="img74.gif"><BR>
And this is as expected. In <tt>Trec1, each of the elements <tt>A and
<tt>B takes 2 bytes of memory, and in  <tt>Trec1, <tt>A takes only 1
byte of memory.
<P>
As from version 0.9.3, Free Pascal supports also the 'packed record', this is a 
record where all the elements are byte-aligned.
<P>
Thus the two following declarations are equivalent:
<BR><IMG WIDTH=576 HEIGHT=13 ALIGN=BOTTOM ALT="listing1560" SRC="img75.gif"><BR>
The output of this program will be :
<BR><IMG WIDTH=81 HEIGHT=51 ALIGN=BOTTOM ALT="listing1553" SRC="img74.gif"><BR>
And this is as expected. In <tt>Trec1</tt></tt>, each of the elements <tt>A</tt></tt> and
<tt>B</tt></tt> takes 2 bytes of memory, and in  <tt>Trec1</tt></tt>, <tt>A</tt></tt> takes only 1
byte of memory.
<P>
As from version 0.9.3, Free Pascal supports also the 'packed record', this is a 
record where all the elements are byte-aligned.
<P>
Thus the two following declarations are equivalent:
<BR><IMG WIDTH=576 HEIGHT=13 ALIGN=BOTTOM ALT="listing1560" SRC="img75.gif"><BR>
and
<BR><IMG WIDTH=404 HEIGHT=73 ALIGN=BOTTOM ALT="listing1564" SRC="img76.gif"><BR>
Note the <tt>{$PackRecords 2}</tt> after the first declaration !
<P>
<H2><A NAME="SECTION03333000000000000000">Set types</A></H2>
<P>
Free Pascal supports the set types as in Turbo Pascal. The prototype of a set
declaration is:
<P>
<BLOCKQUOTE> <BR><b>  Set Types</b><BR><BR><IMG WIDTH=576 HEIGHT=30 ALIGN=BOTTOM ALT="syntdiag1671" SRC="img77.gif"><BR></BLOCKQUOTE>
<P>
Each of the elements of <tt>SetType</tt> must be of type <tt>TargetType</tt>.
<tt>TargetType</tt> can be any ordinal type with a range between <tt>0</tt> and
<tt>255</tt>. A set can contain maximally <tt>255</tt> elements.
<P>
The following are valid set declaration:
<BR><IMG WIDTH=240 HEIGHT=70 ALIGN=BOTTOM ALT="listing1633" SRC="img78.gif"><BR>
Given this set declarations, the following assignment is legal:
<BR><IMG WIDTH=576 HEIGHT=13 ALIGN=BOTTOM ALT="listing1635" SRC="img79.gif"><BR>
The operators and functions for manipulations of sets are listed in 
table (<A HREF="node19.html#tabSetOps"><IMG  ALIGN=BOTTOM ALT="gif" SRC="file:/usr/lib/latex2html/icons/cross_ref_motif.gif"></A>).
<P><A NAME="1683">&#160;</A><A NAME="tabSetOps">&#160;</A><DIV ALIGN=CENTER><P ALIGN=CENTER><TABLE COLS=2 BORDER FRAME=BELOW RULES=GROUPS>
<COL ALIGN=LEFT><COL ALIGN=RIGHT>
<TBODY>
<TR><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP>
Operation </TD><TD VALIGN=BASELINE ALIGN=RIGHT NOWRAP> Operator </TD></TR>
</TBODY><TBODY>
<TR><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP>Union </TD><TD VALIGN=BASELINE ALIGN=RIGHT NOWRAP> + </TD></TR>
<TR><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 
Difference </TD><TD VALIGN=BASELINE ALIGN=RIGHT NOWRAP> - </TD></TR>
<TR><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 
Intersection </TD><TD VALIGN=BASELINE ALIGN=RIGHT NOWRAP> * </TD></TR>
<TR><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP>  
Add element </TD><TD VALIGN=BASELINE ALIGN=RIGHT NOWRAP> <tt>include</tt> </TD></TR>
<TR><TD VALIGN=BASELINE ALIGN=LEFT NOWRAP> 
Delete element </TD><TD VALIGN=BASELINE ALIGN=RIGHT NOWRAP> <tt>exclude</tt> </TD></TR>
</TBODY>
<CAPTION ALIGN=BOTTOM><STRONG>Table:</STRONG>  Set Manipulation operators</CAPTION></TABLE>
</P></DIV><P>
<P>
You can compare two sets with the <tt>&lt;&gt;</tt> and <tt>=</tt> operators, but not
(yet) with the <tt>&lt;</tt> and <tt>&gt;</tt> operators.
<P>
As of compiler version 0.9.5, the compiler stores small sets (less than 32
elements) in a Longint, if the type range allows it. This allows for faster
processing and decreases program size. Otherwise, sets are stored in 32
bytes.
<P>
<H2><A NAME="SECTION03334000000000000000">File types</A></H2>
<P>
File types are types that store a sequence of some base type, which can be
any type except another file type. It can contain (in principle) an infinite
number of elements.
<P>
File types are used commonly to store data on disk. Nothing stops you,
however, from writing a file driver that stores it's data in memory.
<P>
Here is the type declaration for a file type:
<P>
<BLOCKQUOTE> <BR><b>  File types</b><BR><BR><IMG WIDTH=212 HEIGHT=163 ALIGN=BOTTOM ALT="syntdiag1726" SRC="img80.gif"><BR></BLOCKQUOTE>
If no type identifier is given, then the file is an untyped file; it can be
considered as equivalent to a file of bytes. Untyped files require special
commands to act on them (see <A HREF="node71.html#proBlockread">Blockread</A>, <A HREF="node71.html#proBlockwrite">Blockwrite</A>).
<P>
The following declaration declares a file of records:
<BR><IMG WIDTH=530 HEIGHT=202 ALIGN=BOTTOM ALT="listing1701" SRC="img81.gif"><BR>
<P>
Internally, files are represented by the <tt>FileRec</tt> record.
See chapter (<A HREF="node69.html#chrefchapter"><IMG  ALIGN=BOTTOM ALT="gif" SRC="file:/usr/lib/latex2html/icons/cross_ref_motif.gif"></A>) for it's declaration.
<P>
A special file type is the <tt>Text</tt> file type, represented by the
<tt>TextRec</tt> record. A file of type <tt>Text</tt> uses special input-output
routines.
<P>
<HR><A NAME="tex2html574" HREF="node20.html"><IMG WIDTH=37 HEIGHT=24 ALIGN=BOTTOM ALT="next" SRC="file:/usr/lib/latex2html/icons/next_motif.gif"></A> <A NAME="tex2html572" HREF="node16.html"><IMG WIDTH=26 HEIGHT=24 ALIGN=BOTTOM ALT="up" SRC="file:/usr/lib/latex2html/icons/up_motif.gif"></A> <A NAME="tex2html566" HREF="node18.html"><IMG WIDTH=63 HEIGHT=24 ALIGN=BOTTOM ALT="previous" SRC="file:/usr/lib/latex2html/icons/previous_motif.gif"></A> <A NAME="tex2html576" HREF="node1.html"><IMG WIDTH=65 HEIGHT=24 ALIGN=BOTTOM ALT="contents" SRC="file:/usr/lib/latex2html/icons/contents_motif.gif"></A> <A NAME="tex2html577" HREF="node72.html"><IMG WIDTH=43 HEIGHT=24 ALIGN=BOTTOM ALT="index" SRC="file:/usr/lib/latex2html/icons/index_motif.gif"></A> <BR>
<B> Next:</B> <A NAME="tex2html575" HREF="node20.html">Pointers</A>
<B>Up:</B> <A NAME="tex2html573" HREF="node16.html">Types</A>
<B> Previous:</B> <A NAME="tex2html567" HREF="node18.html">Character types</A>
<P><ADDRESS>
<I>Michael Van Canneyt <BR>
Fri Sep 25 09:15:40 MEST 1998</I>
</ADDRESS>
</BODY>
</HTML>
