
                       ******************************
                       HeliOS AUDIO accessory library
                       ******************************

               ----------------------------------------------
               A table of the functions contained in AUDIOLIB
               ----------------------------------------------

The specific routines available from AUDIOLIB are listed below in a table
with each routine presented as a descriptive name, the routine number, and
a HeliOS Stack diagram showing parameter usage.

AUDIOBASE        0                                       - - - AudioBase(l)
OPENMOD          1                                       - - -
CLOSEMOD         2                                       - - -
OPENAUDIO        3                                       - - - Flag(w)
CLOSEAUDIO       4                                       - - -
MODSTART         5                                       - - -
MODSTOP          6                                       - - -
AUDIOSTATUS      7                                       - - - Flag(w)
PLAY_SYNC        8                     Snd#(w), Chan#(w) - - -
PLAY_RPT_ASYNC   9                     Snd#(w), Chan#(w) - - -
PLAY_ONCE_ASYNC  10                    Snd#(w), Chan#(w) - - -
PLAY_END         11                             Chan#(w) - - -
MOD_CHANNEL      12            Switch(1or0)(w), Chan#(w) - - -
END_REPEAT       13                             Chan#(w) - - -
FILTER           14                      Switch(1or0)(w) - - -
PERVOL           15             Per(w), Vol(w), Chan#(w) - - -
SET_ASYNC        16                                      - - -
SETPERVOL        17                       Per(w), Vol(w) - - -
GETAUDIO         18                                      - - - _AUDIO(l)
ASYNC_STATUS     19                                      - - -  ASYNC(w)
PLAYSAMP_SYNC    20 Strt(l), Len(w), RptLen(w), Chan#(w) - - -
END_ASYNC        21                                      - - -
PSAMP_RPT_ASYNC  22 Strt(l), Len(w), RptLen(w), Chan#(w) - - -
PSAMP_ONCE_ASYNC 23 Strt(l), Len(w), RptLen(w), Chan#(w) - - -

Note:

The names of the routines are for reference in this documentation only,
and are NOT used as HeliOS Words.  The routines are all called by using
the KeyWord AUDIOLIB along with the routine number.

***************************************************************************

  ---------------
  HeliOS AUDIOLIB
  ---------------

  This library of routines implements several useful functions to
  automate the playing of music modules and sound samples.

  -------------------------------------
  Calling HeliOS AUDIO Library routines
  -------------------------------------

  As with all HelIOS internal libraries, each AUDIO library routine
  has an associated reference number.

  In this documentation the functions are all given names for ease of
  reference, but you must remember that the names used here are NOT HeliOS
  command names, and all these functions are accessed from HeliOS by their
  library number alone.

  To call any routine simply use the command AUDIOLIB preceded by the
  reference number of the routine you want to call.

  The calling parameters for any routine should be placed on the stack
  immediately before the reference number of the routine.

  For example, SETPERVOL is routine number "17" in the HeliOS AUDIO
  library, and requires the following parameters:

  SETPERVOL     ( Per(w), Vol(w) - - - )

  where Per and Vol are the period and volume for a given sound.

  So, to call SETPERVOL you might say:

  MyPer MyVol    17                AUDIOLIB

  which expression is constructed as follows:

  MyPer MyVol    17                AUDIOLIB

  ^^^^^^^^^^     ^^                ^^^^^^^^
  Parameters     Routine number    HeliOS internal library call

  -----------------------
  The AUDIOBASE structure
  -----------------------

  The HeliOS audio system uses an AUDIOBASE control data structure which
  was freely programmable in earlier HeliOS versions, but at present is
  "private" and subject to change.

  Future HeliOS language releases will allow direct programming of the
  HeliOS audio system again, but for now you should use the pre-rogrammed
  commands from AUDIOLIB and avoid directly programming the Audio hardware
  or attempting to change the HeliOS AUDIOBASE values directly.

  This version of AUDIOLIB is a temporary patch to allow simple sound
  operations: the new version of AUDIOLIB will be finished soon, and will
  have considerably enhanced functionality.

  The pre-encoded Music-X "fast-play" facility has been removed from this
  version of the software but will be back in enhanced form soon.

  The next release of AUDIOLIB will include support for playing a wide
  range of music modules, but the present release only supports the old
  Public Domain MED2.0 module format.

  Individual sample loading has been left out of this temporary version
  of AUDIOLIB so all music and samples must either be loaded via MED 2.0
  modules or loaded and set up by your own code.

*************************************************************************

***********************************************
A detailed description of the AUDIOLIB routines
***********************************************

Below is a detailed description of all the AUDIOLIB routines.

At the start of each description is the routine number followed by the
documentation name for the function.

*************************************************************************

  [ 0 ]

  ---------
  AUDIOBASE        ( - - - AudioBase )
  ---------

  Returns a pointer to the start of the master HeliOS AudioBase structure.

*************************************************************************

  [ 1 ]

  -------
  OPENMOD
  -------

  Opens a MED 2.0 module whose filename (32-bit counted string) is pointed
  to by the first 32-bit field of AUDIOBASE.

  To use this function get your filename string and store it first into
  AUDIOBASE, then open your module like this:



  $CONSTANTL ModFileName $Mods:MyMod$

  0 AUDIOLIB DCONSTANT AUDIOBASE

  ModFileName AUDIOBASE D!L

  : OpenMod 1 AUDIOLIB ;


*************************************************************************

  [ 2 ]

  --------
  CLOSEMOD
  --------

  Closes the current module and frees up all associated resources.

*************************************************************************

  [ 3 ]

  ---------
  OPENAUDIO        ( - - - flag(w) )
  ---------

  Initialises the HeliOS audio system.

  This routine requests use of the Amiga audio resources from the OS,
  and will return a failure if it cannot successfully gain access to
  these resources.

  Sound samples may still be played using the HeliOS audio routines
  even if OPENAUDIO fails, but this process may interfere with other 
  tasks using the Amiga audio hardware.

  Music modules can only be played when OPENAUDIO has succeeded.

*************************************************************************

  [ 4 ]

  ----------
  CLOSEAUDIO
  ----------

  Closes down the HeliOS audio system and frees up resources.

*************************************************************************

  [ 5 ]

  --------
  MODSTART
  --------

  Starts playing the current module under background interrupt control.

*************************************************************************

  [ 6 ]

  -------
  MODSTOP
  -------

  Stops playing the current module.

*************************************************************************

  [ 7 ]

  -----------
  AUDIOSTATUS      ( - - - flag(w) )
  -----------

  Returns the current HeliOS audio system module playing status.

*************************************************************************

  [ 8 ]

  ---------
  PLAY_SYNC        ( Snd#(w), Chan#(w) - - - )

  ---------

  Plays a sound sample, Snd#, on audio channel number Chan#.

  The sound sample is referred to by number, and must be loaded within a
  music module.

  This command does not support repeat/continuous sample playing.

  This is a synchronous operation and waits for sound completion before
  returning.

*************************************************************************

  [ 9 ]

  --------------
  PLAY_RPT_ASYNC   ( Snd#(w), Chan#(w) - - - )
  --------------

  Plays a sound sample, Snd#, on audio channel number Chan#.

  The sound sample is referred to by number, and must be loaded within a
  music module.

  This command supports repeat/continuous sample playing according to
  repeat parameters set for sample.

  This is an asynchronous operation and does not wait for sound completion
  before returning.

*************************************************************************

  [ 10 ]

  ---------------
  PLAY_ONCE_ASYNC  ( Snd#(w), Chan#(w) - - - )
  ---------------

  Plays a sound sample, Snd#, on audio channel number Chan#.

  The sound sample is referred to by number, and must be loaded within a
  music module.

  This command does not support repeat/continuous sample playing.

  This is an asynchronous operation and does not wait for sound completion
  before returning.

*************************************************************************

  [ 11 ]

  --------
  PLAY_END         ( Chan#(w) - - - )
  --------

  Switches off any sound sample playing on audio channel number Chan#,
  and switches off audio DMA.

  If Chan# value is "-1", all channels are switched off.

*************************************************************************

  [ 12 ]

  -----------
  MOD_CHANNEL      ( Switch(1or0)(w), Chan# - - - )
  -----------

  Switches a MODULE player audio channel On/Off.

*************************************************************************

  [ 13 ]

  ----------
  END_REPEAT       ( Chan#(w) - - - )
  ----------

  Switches off cleanly, at end of sound, any "repeating" sound sample
  playing on audio channel number Chan#.

  Does not switch off audio DMA, but allows the sound to finish and then
  replaces it with a dummy "silent" or "null" sound.

  This command is asynchronous, and does not wait, so depending on the
  length of the sound currently playing, you should allow subsequent code
  to wait until the sound completes before doing something like switching
  off audio DMA.

*************************************************************************

  [ 14 ]

  ------
  FILTER           ( Switch(1or0)(w) - - - )
  ------

  Switches On/Off audio filter.

*************************************************************************

  [ 15 ]

  ------
  PERVOL           ( Per(w), Vol(w), Chan#(w) - - - )
  ------

  Sets the Period and Volume of a sample output channel, either before the
  sample is started or during a repeating sound.

*************************************************************************

  [ 16 ]

  ---------
  SET_ASYNC
  ---------

  Forces sound samples to run in special controlled-asynchronous mode
  whereby the use of ASYNC_STATUS returns a flag telling you whether
  the sound has finished yet.

  This mode is rather limited in that it only supports the use of one
  channel with a single sound.  Basically it allows you to leave a
  sound running and go away to process other data, returning periodically
  to see if the sound has finished.

  Use ASYNC_END to end this mode of operation.

*************************************************************************

  [ 17 ]

  ---------
  SETPERVOL        ( Per(w), Vol(w) - - - )
  ---------

  Sets initial Period and Volume settings for sound samples subsequently
  started on any channel.

*************************************************************************

  [ 18 ]

  --------
  GETAUDIO         ( - - - AudioLib(l) )
  --------

  Used to run AudioLib routines from machine code.

  Returns a pointer to the AudioLib driver code which requires the current
  AudioLib command and parameters to be on the HeliOS stack (pointed to by
  A5) before performing a "jsr" to "AudioLib".

*************************************************************************

  [ 19 ]

  ------------
  ASYNC_STATUS     ( - - - Flag(w) )
  ------------

  Returns status of asynchronous sounds running in special asynchronous
  mode (= 1 if all sounds finished).

*************************************************************************

  [ 20 ]

  -------------
  PSAMP_SYNC       ( Strt(l), Len(w), RptLen(w), Chan(w) - - - )
  -------------

  Plays a sound sample on audio channel number Chan#.

  This command does not support repeat/continuous sample playing.

  This is a synchronous operation and waits for sound completion before
  returning.

*************************************************************************

  [ 21 ]

  ---------
  END_ASYNC        ( - - - )
  ---------

  Ends the special asynchronous mode of operation.

*************************************************************************

  [ 22 ]

  --------------
  PSAMP_RPT_ASYNC  ( Strt(l), Len(w), RptLen(w), Chan(w) - - - )
  --------------

  Plays a sound sample on audio channel number Chan#.

  This command supports repeat/continuous sample playing according to
  repeat parameters set for sample.

  This is an asynchronous operation and does not wait for sound completion
  before returning.

*************************************************************************

  [ 23 ]

  ----------------
  PSAMP_ONCE_ASYNC ( Strt(l), Len(w), RptLen(w), Chan(w) - - - )
  ----------------

  Plays a sound sample on audio channel number Chan#.

  This command does not support repeat/continuous sample playing.

  This is an asynchronous operation and does not wait for sound completion
  before returning.

*************************************************************************
