include? time&date.f parForthExtensions/time&date.f
include? Random.f    parForthExtensions/Random.f
include? MS.f        parForthExtensions/MS.f
include? API.f       parForthExtensions/API.f
include? GadTools.f  parforthExtensions/GadTools.f
include? Turtle.f    parForthExtensions/Turtle.f

ANEW TurtleDemo.f

\ patterns ****************************************************************************************
: Pentagonal ( -- ) 10 1000 5 POLYGONAL ;
: Octagonal  ( -- )  8 1000 8 POLYGONAL ;
: Diagonals  ( -- ) 9 0 DO PENUP I 300 * 0 2DUP GOTO PENDOWN SWAP GOTO LOOP ;
: Patchwork  ( -- ) PENUP LEFTMOST BOTTOMMOST GOTO NEWHOME 10 0 DO PENUP I 500 * 0 GOTO PENDOWN 0 5500 I 500 * - GOTO LOOP ;
: Circles    ( -- ) 10 0 DO 1000 CIRCLE 36 RIGHT LOOP ;

: Petal  ( size -- ) 1 ? DUP 90 ARC 90 LEFT 90 ARC 90 LEFT ;
\ : Flower ( size -- ) 1 ? 8 0 DO DUP Petal 45 LEFT LOOP DROP ;
: Flower ( petals size -- ) 2 ? OVER 0> NOT IF 2DROP EXIT THEN
	OVER 0 DO DUP Petal 360 1OVER2 / LEFT LOOP 2DROP ;

: SineWave ( qty size -- ) 2 ? OVER 0> NOT IF 2DROP EXIT THEN
	SWAP 360 * 1+ 0 DO DUP I * OVER 100 * I SIN 10^4 */ GOTO 5 +LOOP DROP ;

: SawTooth ( qty size -- ) 2 ? OVER 0> NOT IF 2DROP EXIT THEN
	SWAP 0 DO DUP 45 LEFT DUP FORWARD 90 RIGHT DUP 2* FORWARD 90 LEFT FORWARD 45 RIGHT LOOP DROP ;

: Square.F ( size depth -- ) 2 ? DUP 0> NOT IF 2DROP EXIT THEN	\ draw square fractals recursively ( 3000 5 Square.f)
	HIDETURTLE 4 0 DO OVER FORWARD 90 LEFT OVER 4 10 */ OVER 1- RECURSE LOOP 2DROP ;

: Koch ( size depth -- ) 2 ?		\ 2000 2 Koch
	?DUP 0= IF FORWARD EXIT THEN
	1- SWAP 3 / SWAP 2DUP RECURSE
	60 LEFT 2DUP RECURSE
	120 RIGHT 2DUP RECURSE
	60 LEFT RECURSE ;
: Snowflake ( size depth -- ) 2 ? DUP 0> NOT IF 2DROP EXIT THEN				\ 5000 4 snowflake
	PENUP 135 HEADING 2000 FORWARD 0 HEADING PENDOWN HIDETURTLE 3 0 DO 2DUP Koch 120 RIGHT LOOP 2DROP ;

: Stars { n x angle -- } n 0= IF EXIT THEN		\ 21 144 18, 21,144 20, 21 72 18
	HIDETURTLE
	0 n DO RNDCOLOR INK BEGINFILL
		5 0 DO 5 n - 5 * J * FORWARD x      RIGHT
			   5 n - 5 * J * FORWARD 72 x - RIGHT
		LOOP ENDFILL angle RIGHT
	-1 +LOOP ;

: Tree ( size -- ) 1 ? DUP 50 < IF DROP EXIT THEN
	DUP FORWARD 30 RIGHT
	DUP 3 4 */ RECURSE 60 LEFT
	DUP 3 4 */ RECURSE 30 RIGHT BACKWARD ;
: TreeDemo ( -- ) PENUP 90 HEADING 2000 BACKWARD PENDOWN HIDETURTLE 1000 Tree ;

: Curly ( size -- ) 1 ? DUP 10 < IF DROP EXIT THEN
	360 0 DO
		I  5 = IF 90 RIGHT DUP 2/  RECURSE 90 LEFT THEN
		I 10 = IF 90 RIGHT DUP 5 / RECURSE 90 LEFT THEN
		I 15 = IF 90 RIGHT DUP 5 / RECURSE 90 LEFT THEN
		I 20 = IF 90 RIGHT DUP 4 / RECURSE 90 LEFT THEN
		I 25 = IF 90 RIGHT DUP 5 / RECURSE 90 LEFT THEN
		I 30 = IF 90 RIGHT DUP 8 / RECURSE 90 LEFT THEN
		DUP FORWARD I RIGHT
	LOOP DROP 180 RIGHT ;
: CurlyDemo ( -- ) PENUP -4000 2500 GOTO PENDOWN HIDETURTLE 500 Curly ;

50 VALUE DRAGON-SIZE
: Dragon ( n -- ) 1 ? ?DUP 0= IF DRAGON-SIZE FORWARD EXIT THEN
	DUP 0>
	IF DUP 1- RECURSE 90 LEFT 1 OVER - RECURSE
	ELSE -1 OVER - RECURSE 90 RIGHT 1 OVER + RECURSE
	THEN DROP ;
: DragonDemo ( -- ) HIDETURTLE 12 Dragon ;

: SqrFunc   ( size -- ) 4 0 DO DUP FORWARD 90 LEFT 50 - LOOP DROP ;
: OutsideIn ( -- ) 2000 18 0 DO DUP PENUP HOME PENDOWN SqrFunc 100 - LOOP DROP ;

: SqrFunc   ( size -- ) 4 0 DO DUP FORWARD 90 LEFT 50 + LOOP DROP ;
: InsideOut ( -- ) 200 18 0 DO DUP PENUP HOME PENDOWN SqrFunc 100 + LOOP DROP ;

: SpiralHelix ( -- ) HIDETURTLE 101 1 DO RNDCOLOR INK I 25 * CIRCLE I -25 * CIRCLE I LEFT LOOP ;

: Benzene ( -- ) 360 0 DO I 6 MOD
	DUP 0 = IF Red ELSE
	DUP 1 = IF Purple ELSE
	DUP 2 = IF Blue ELSE
	DUP 3 = IF Green ELSE
	DUP 4 = IF Orange ELSE
	DUP 5 = IF Yellow THEN THEN THEN THEN THEN THEN NIP INK
	I 9 * FORWARD 59 LEFT LOOP ;

: Star ( n -- ) 1 ? ?DUP 0= IF EXIT THEN
	0 DO I 50 * FORWARD 144 RIGHT LOOP ;

: MovingBall ( -- ) HIDETURTLE UserWidth 1000 + 50 / 1+ 0 DO 500 MS
	PENUP -5500 I 50 * + 0 GOTO PENDOWN rp -bg @ PEN _SetRast BEGINFILL 500 CIRCLE ENDFILL LOOP ;

: Spiral ( radius -- ) 1 ? 100 0 DO DUP I 10 * + 45 ARC LOOP DROP ;

: Spokes ( -- ) 180 0 DO RNDCOLOR INK 1500 FORWARD 30 RIGHT 300 FORWARD 60 LEFT 750 FORWARD 30 RIGHT
	PENUP HOME PENDOWN 2 RIGHT LOOP ;

: Quora ( -- ) 400 1 DO RNDCOLOR INK 100 I 10 * + FORWARD 91 RIGHT LOOP ;

: Zoe ( -- ) 20 0 DO RNDCOLOR INK 100 FORWARD 18 RIGHT 5 0 DO 2000 FORWARD 72 RIGHT LOOP LOOP ;

: Polygons ( -- ) PENUP 0 BOTTOMMOST 10 + GOTO PENDOWN 1000 21 3 DO 360 I MOD 0= IF RNDCOLOR INK DUP I POLYGON
	THEN LOOP DROP ;

\ : HSVVaries ( -- ) 0 420 0 DO 145 LEFT DUP 36 / 10^4 / 100 90 HSV>RGB HEAP (COLOR) INK 10^4 +
\	5 0 DO 2000 FORWARD 150 LEFT LOOP LOOP DROP ;

\ examples ------------------------------------------------------------------------------------------
\ Spirograph patterns start at the top of the paper thus the 90 HEADING in SPIRODEFAULTS
: Hypo01 ( -- ) SPIRODEFAULTS 17 MAGNIFICATION RNDCOLOR INK  24 StepSize ! 145  36  -18 HYPOTROCHOID ;
: Hypo02 ( -- ) SPIRODEFAULTS  4 MAGNIFICATION RNDCOLOR INK  47 StepSize ! 364  94 -402 HYPOTROCHOID ;
: Hypo03 ( -- ) SPIRODEFAULTS 25 MAGNIFICATION RNDCOLOR INK 122 StepSize !   1  70  -66 HYPOTROCHOID ;
: Hypo04 ( -- ) SPIRODEFAULTS 12 MAGNIFICATION RNDCOLOR INK 145 StepSize ! 176  59  -50 HYPOTROCHOID ;
: Hypo05 ( -- ) SPIRODEFAULTS 16 MAGNIFICATION RNDCOLOR INK 100 StepSize ! 145  63  -57 HYPOTROCHOID ;
: Hypo06 ( -- ) SPIRODEFAULTS 16 MAGNIFICATION RNDCOLOR INK  40 StepSize ! 140  47  -57 HYPOTROCHOID ;
: Hypo07 ( -- ) SPIRODEFAULTS  6 MAGNIFICATION RNDCOLOR INK 120 StepSize !   4 191 -139 HYPOTROCHOID ;
: Hypo08 ( -- ) SPIRODEFAULTS  7 MAGNIFICATION RNDCOLOR INK 120 StepSize ! 300  74 -139 HYPOTROCHOID ;
: Hypo09 ( -- ) SPIRODEFAULTS  8 MAGNIFICATION RNDCOLOR INK  74 StepSize ! 300  74 -252 HYPOTROCHOID ;
: Hypo10 ( -- ) SPIRODEFAULTS 12 MAGNIFICATION RNDCOLOR INK  90 StepSize ! 180  43  -50 HYPOTROCHOID ;
: Hypo11 ( -- ) SPIRODEFAULTS 12 MAGNIFICATION RNDCOLOR INK  20 StepSize ! 194  19 -219 HYPOTROCHOID ;
: Hypo12 ( -- ) SPIRODEFAULTS 11 MAGNIFICATION RNDCOLOR INK  60 StepSize ! 194  19 -107 HYPOTROCHOID ;
: Hypo13 ( -- ) SPIRODEFAULTS 12 MAGNIFICATION RNDCOLOR INK  76 StepSize ! 194  19  -28 HYPOTROCHOID ;
: Hypo14 ( -- ) SPIRODEFAULTS  6 MAGNIFICATION RNDCOLOR INK  45 StepSize ! 468 114 -195 HYPOTROCHOID ;
: Hypo15 ( -- ) SPIRODEFAULTS 16 MAGNIFICATION RNDCOLOR INK 158 StepSize ! 582 255 -102 HYPOTROCHOID ;
: Hypo16 ( -- ) SPIRODEFAULTS 16 MAGNIFICATION RNDCOLOR INK   9 StepSize ! 138   9 -106 HYPOTROCHOID ;
: Hypo17 ( -- ) SPIRODEFAULTS 12 MAGNIFICATION RNDCOLOR INK  69 StepSize ! 188  42 -122 HYPOTROCHOID ;
: Hypo18 ( -- ) SPIRODEFAULTS 10 MAGNIFICATION RNDCOLOR INK  98 StepSize ! 324  98 -232 HYPOTROCHOID ;
: Hypo19 ( -- ) SPIRODEFAULTS 12 MAGNIFICATION RNDCOLOR INK 124 StepSize ! 122  62 -175 HYPOTROCHOID ;
: Hypo20 ( -- ) SPIRODEFAULTS 10 MAGNIFICATION RNDCOLOR INK 183 StepSize !  2 Revolutions ! 4 149  -74 HYPOTROCHOID ;
: Hypo21 ( -- ) SPIRODEFAULTS  8 MAGNIFICATION RNDCOLOR INK 184 StepSize ! 75 Revolutions !   4 149  -74 HYPOTROCHOID ;
: Hypo22 ( -- ) SPIRODEFAULTS 10 MAGNIFICATION RNDCOLOR INK 120 StepSize ! 35 Revolutions ! 176  59 -180 HYPOTROCHOID ;
: Hypo23 ( -- ) SPIRODEFAULTS 14 MAGNIFICATION RNDCOLOR INK 144 StepSize ! 176  59  -50 HYPOTROCHOID ;
: Hypo24 ( -- ) SPIRODEFAULTS  7 MAGNIFICATION RNDCOLOR INK 193 StepSize ! 321 193  -40 EPITROCHOID ;
: Hypo25 ( -- ) SPIRODEFAULTS 20 MAGNIFICATION RNDCOLOR INK  88 StepSize !  56  55 -415 EPITROCHOID ;
: Hypo26 ( -- ) SPIRODEFAULTS 20 MAGNIFICATION RNDCOLOR INK 172 StepSize !   8 135  152 EPITROCHOID ;
: Hypo27 ( -- ) SPIRODEFAULTS 10 MAGNIFICATION RNDCOLOR INK 179 StepSize ! 225  67  -31 EPITROCHOID ;
: Hypo28 ( -- ) SPIRODEFAULTS 10 MAGNIFICATION RNDCOLOR INK 210 StepSize !  51 322  273 HYPOTROCHOID ;
: Hypo29 ( -- ) SPIRODEFAULTS 10 MAGNIFICATION RNDCOLOR INK 240 StepSize ! 190 311   26 HYPOTROCHOID ;
: Hypo30 ( -- ) SPIRODEFAULTS 15 MAGNIFICATION RNDCOLOR INK  90 StepSize !  67 222  226 HYPOTROCHOID ;
: Hypo31 ( -- ) SPIRODEFAULTS 17 MAGNIFICATION RNDCOLOR INK  40 StepSize ! 119 261  272 HYPOTROCHOID ;
: Hypo32 ( -- ) SPIRODEFAULTS 15 MAGNIFICATION RNDCOLOR INK 139 StepSize !  64 278  250 HYPOTROCHOID ;
: Hypo33 ( -- ) SPIRODEFAULTS  5 MAGNIFICATION RNDCOLOR INK   1 StepSize ! 15 Revolutions ! 272  39 -216 EPITROCHOID ;
: Hypo34 ( -- ) SPIRODEFAULTS 10 MAGNIFICATION RNDCOLOR INK 135 StepSize ! 202 171 -119 EPITROCHOID ;
: Hypo35 ( -- ) SPIRODEFAULTS  5 MAGNIFICATION RNDCOLOR INK  45 StepSize ! 150 Revolutions ! 163 339 -259 EPITROCHOID ;
: Hypo36 ( -- ) SPIRODEFAULTS  7 MAGNIFICATION RNDCOLOR INK  72 StepSize ! 266 138 -237 EPITROCHOID ;
: Hypo37 ( -- ) SPIRODEFAULTS 12 MAGNIFICATION RNDCOLOR INK 175 StepSize !  43  41  -91 EPITROCHOID ;
: Hypo38 ( -- ) SPIRODEFAULTS 15 MAGNIFICATION RNDCOLOR INK 147 StepSize !  80 294 -191 EPITROCHOID ;
: Hypo39 ( -- ) SPIRODEFAULTS  4 MAGNIFICATION RNDCOLOR INK 262 StepSize ! 124 332   15 EPITROCHOID ;
: Hypo40 ( -- ) SPIRODEFAULTS  5 MAGNIFICATION RNDCOLOR INK 262 StepSize ! 124 332   15 HYPOTROCHOID ;
: Hypo41 ( -- ) SPIRODEFAULTS 21 MAGNIFICATION RNDCOLOR INK  90 StepSize ! 190  82  100 HYPOTROCHOID ;
: Hypo42 ( -- ) SPIRODEFAULTS  5 MAGNIFICATION RNDCOLOR INK  54 StepSize ! 354 106  469 HYPOTROCHOID ;
: Hypo43 ( -- ) SPIRODEFAULTS 10 MAGNIFICATION RNDCOLOR INK 242 StepSize ! 352 174  351 HYPOTROCHOID ;
: Hypo44 ( -- ) SPIRODEFAULTS 10 MAGNIFICATION RNDCOLOR INK 111 StepSize ! 173 Revolutions ! 89 346  195 HYPOTROCHOID ;
: Hypo45 ( -- ) SPIRODEFAULTS 21 MAGNIFICATION RNDCOLOR INK 135 StepSize ! 365 283  386 HYPOTROCHOID ;
: Hypo46 ( -- ) SPIRODEFAULTS 10 MAGNIFICATION RNDCOLOR INK 120 StepSize ! 162 264  486 EPITROCHOID ;
: Hypo47 ( -- ) SPIRODEFAULTS 15 MAGNIFICATION RNDCOLOR INK 249 StepSize ! 158 219   75 HYPOTROCHOID ;
: Hypo48 ( -- ) SPIRODEFAULTS 15 MAGNIFICATION RNDCOLOR INK 165 StepSize ! 400 351  482 HYPOTROCHOID ;
: Hypo49 ( -- ) SPIRODEFAULTS 20 MAGNIFICATION RNDCOLOR INK 272 StepSize ! 378 346  449 HYPOTROCHOID ;
: Hypo50 ( -- ) SPIRODEFAULTS 10 MAGNIFICATION RNDCOLOR INK 215 StepSize !  77 Revolutions ! 48 310  423 HYPOTROCHOID ;
: Hypo51 ( -- ) SPIRODEFAULTS 10 MAGNIFICATION RNDCOLOR INK  77 StepSize ! 232  63  280 HYPOTROCHOID ;
: Hypo52 ( -- ) SPIRODEFAULTS 17 MAGNIFICATION RNDCOLOR INK 105 StepSize ! 236 127   10 HYPOTROCHOID ;
: Hypo53 ( -- ) SPIRODEFAULTS  5 MAGNIFICATION RNDCOLOR INK   2 StepSize ! 305   3  502 HYPOTROCHOID ;

: Spiro0 ( -- ) SPIRODEFAULTS Red INK 180 Rotation <! 2500 MOVEHOME !>
	9 0 DO 144 TILTFROMBELOW
		7 0	DO 96 24 12 HYPOTROCHOID TILT 1 RIGHT 1 RIGHT LOOP
		0 Rotation <! 240 MOVEHOME !> 144 TILTFROMABOVE
		7 0 DO 96 24 12 HYPOTROCHOID TILT 1 RIGHT 1 LEFT LOOP
		0 Rotation <! 240 MOVEHOME !> LOOP ;

: Spiro1 ( -- ) SPIRODEFAULTS
	Black INK 13 0 DO I 3 = IF Red   INK ELSE
			          I 6 = IF Blue  INK ELSE
			          I 9 = IF Green INK THEN THEN THEN
			          96 64 I 5 * 10 + HYPOTROCHOID	LOOP ;

: Spiro2 ( -- ) SPIRODEFAULTS
	Green INK 18 Revolutions !     105 52 10 HYPOTROCHOID
	Blue  INK 18 StartRevolution ! 105 52 10 HYPOTROCHOID
	Red   INK 36 StartRevolution ! 105 52 10 HYPOTROCHOID ;

: (Spiro3) ( -- ) 105 60 15 HYPOTROCHOID ;
: Spiro3 ( -- ) SPIRODEFAULTS
	Blue Ink (Spiro3) 1 TEETH LEFT (Spiro3) 2 TEETH RIGHT (Spiro3)
	64 HEADING Red INK (Spiro3) 1 TEETH LEFT (Spiro3) 2 TEETH RIGHT (Spiro3) ;

: Spiro4 ( -- ) SPIRODEFAULTS
	Black INK 3 0 DO 105 30 I 3 * 10 + HYPOTROCHOID LOOP
	Green INK 3 0 DO 105 45 I 3 * 20 + HYPOTROCHOID LOOP
	Red   INK 3 0 DO 105 60 I 3 * 30 + HYPOTROCHOID LOOP
	Blue  INK 3 0 DO 105 75 I 3 * 40 + HYPOTROCHOID LOOP ;

: Spiro5 ( -- ) SPIRODEFAULTS
	Blue  INK 5 0 DO 96 24 I 2* 10 + HYPOTROCHOID LOOP 30 RIGHT
	Green INK 5 0 DO 96 24 I 2* 10 + HYPOTROCHOID LOOP 30 RIGHT
	Red   INK 5 0 DO 96 24 I 2* 10 + HYPOTROCHOID LOOP 90 HEADING
	Green INK 5 0 DO 96 80 I 2* 35 + HYPOTROCHOID LOOP 30 RIGHT
	Red   INK 5 0 DO 96 80 I 2* 35 + HYPOTROCHOID LOOP ;    

: Spiro6 ( -- ) SPIRODEFAULTS Red INK
	 9 0 DO 96 84 I 2* 15 + HYPOTROCHOID 1 TEETH RIGHT LOOP 45 HEADING
	10 1 DO 96 84 I 2* 15 + HYPOTROCHOID 1 TEETH RIGHT LOOP ;

: Spiro7 ( -- ) SPIRODEFAULTS
	Black INK 5 0 DO 96 24 I 2* 10 + HYPOTROCHOID LOOP 2 TEETH LEFT
	Red   INK 5 0 DO 96 72 1 2* 20 + HYPOTROCHOID 1 TEETH RIGHT LOOP 45 HEADING
	          4 0 DO 96 72 I 2* 42 + I 2 = IF BLACK INK THEN HYPOTROCHOID LOOP ;

: Spiro8 ( -- ) SPIRODEFAULTS
	Black INK 96 63 0 2* 12 + HYPOTROCHOID
	Blue  INK 96 63 1 2* 12 + HYPOTROCHOID
	Green INK 96 63 2 2* 12 + HYPOTROCHOID
	Red   INK 96 63 3 2* 12 + HYPOTROCHOID ;

: Spiro9 ( -- ) SPIRODEFAULTS Blue INK
	10 0 DO I 3 = IF Green INK ELSE
			I 6 = IF Red   INK THEN THEN
			96 56 I 2* 10 + HYPOTROCHOID
	1 TEETH RIGHT LOOP ;

: Spiro10 ( -- ) SPIRODEFAULTS
	7 0 DO 105 56 I 2* 10 + I 2 MOD IF Red ELSE Black THEN INK HYPOTROCHOID LOOP ;
	
: Spiro11 ( -- ) SPIRODEFAULTS
	Blue INK 26 0 DO 105 84 I 2* 11 + HYPOTROCHOID 2 TEETH RIGHT LOOP ;

: Spiro12 ( -- ) SPIRODEFAULTS
	15 1 DO 96 80 I 2* 10 + I 3 MOD 0= IF Red ELSE Blue THEN INK HYPOTROCHOID LOOP ;

: Spiro13 ( -- ) SPIRODEFAULTS
	Black INK 5 0 DO 105 30 I 2* 10 + HYPOTROCHOID LOOP
	Green INK 5 0 DO 105 45 I 2* 10 + HYPOTROCHOID LOOP
	Red   INK 5 0 DO 105 60 I 2* 10 + HYPOTROCHOID LOOP ;

: Spiro14 ( -- ) SPIRODEFAULTS Red INK
	105 24 18 HYPOTROCHOID
	3 0 DO 105 80 I 2* 35 + HYPOTROCHOID LOOP ;

: (Spiro15) ( f -- f )
	8 0 DO  I 1 = IF Blue INK ELSE
			I 4 = IF Red  INK THEN THEN 1 TEETH OVER IF RIGHT ELSE LEFT THEN
			105 75 I 2* 14 + HYPOTROCHOID LOOP ;
: Spiro15   ( -- ) SPIRODEFAULTS
	Red INK	105 75 13 HYPOTROCHOID FALSE (Spiro15) 90 HEADING 0= (Spiro15) DROP ;

: Spiro16 ( -- ) SPIRODEFAULTS Blue INK
	25 0 DO I  5 = IF Red   INK ELSE
			I 10 = IF Green INK ELSE
			I 15 = IF Red   INK ELSE
			I 20 = IF Blue  INK THEN THEN THEN THEN
			105 80 I 2* 10 + HYPOTROCHOID 5 +LOOP ;

: Spiro17 ( -- ) SPIRODEFAULTS Blue INK
	18 0 DO I  6 = IF Red   INK ELSE
			I 12 = IF Green INK THEN THEN
			105 63 I 2 * 10 + HYPOTROCHOID 2 +LOOP ;

: Spiro18 ( -- ) SPIRODEFAULTS
	Blue INK 96 60 0 2* 13 + HYPOTROCHOID
	Red INK 8 3 DO I 7 = IF Blue INK THEN 3 RIGHT 96 60 I 2* 10 + HYPOTROCHOID 2 +LOOP 90 HEADING
	Red INK 8 3 DO I 7 = IF Blue INK THEN 3 LEFT  96 60 I 2* 10 + HYPOTROCHOID 2 +LOOP 91 HEADING
	Red INK 7 2 DO 3 RIGHT 96 60 I 2* 10 + HYPOTROCHOID 2 +LOOP 89 HEADING
	        7 2 DO 3 LEFT  96 60 I 2* 10 + HYPOTROCHOID 2 +LOOP ;

: Spiro19 ( -- ) SPIRODEFAULTS
	Black INK 105 25  5 2* 10 + HYPOTROCHOID
	Red   INK 105 36 11 2*  9 + HYPOTROCHOID
	Blue  INK 105 48 17 2*  8 + HYPOTROCHOID
	Green INK 105 60 23 2*  9 + HYPOTROCHOID 60 HEADING
	          105 60 23 2*  9 + HYPOTROCHOID 90 HEADING
	Black INK 105 72 29 2*  8 + HYPOTROCHOID
	Red   INK 105 84 35 2*  9 + HYPOTROCHOID 45 HEADING
			  105 84 35 2*  9 + HYPOTROCHOID ;

: Spiro20 ( -- ) SPIRODEFAULTS Red INK
	96 40 5 2* 9 + HYPOTROCHOID
	96 56 9 2* 9 + HYPOTROCHOID
	2 0 DO 96 80 15 2* 9 + HYPOTROCHOID 60 HEADING LOOP
	3 0 DO 96 72 13 2* 9 + HYPOTROCHOID 96 24 1  2* 9 + HYPOTROCHOID 30 RIGHT LOOP
	4 0 DO 96 32  3 2* 9 + HYPOTROCHOID 96 64 11 2* 9 + HYPOTROCHOID 30 RIGHT LOOP
	6 0 DO 96 48  7 2* 9 + HYPOTROCHOID 30 RIGHT LOOP ;

: (Spiro21) ( -- ) 7 0 DO 96 60 I 2* 10 + HYPOTROCHOID 2 +LOOP ;
: Spiro21 ( -- ) SPIRODEFAULTS
	 Green INK (Spiro21) 6 TEETH RIGHT Blue INK (Spiro21) 90 HEADING 3 TEETH RIGHT
	 Red   INK 4 0 DO 3 0 DO 96 72 I 2* 10 + HYPOTROCHOID LOOP 6 TEETH RIGHT LOOP ;

: Spiro22 ( -- ) SPIRODEFAULTS Red INK
	12 0 DO I 4 = IF Green INK ELSE
			I 8 = IF Blue  INK THEN THEN
			105 63 I 2* 10 + HYPOTROCHOID 1 TEETH RIGHT LOOP ;

: Spiro23 ( -- ) SPIRODEFAULTS Black INK
	96 40 0 2* 10 + HYPOTROCHOID
	96 56 0 2* 10 + HYPOTROCHOID
	3 0 DO 96 24 0 2* 10 + HYPOTROCHOID 30 RIGHT LOOP
	4 0 DO 96 32 0 2* 10 + HYPOTROCHOID 30 RIGHT LOOP 
	6 0 DO 96 48 0 2* 10 + HYPOTROCHOID 30 RIGHT LOOP ;

: Spiro24 ( -- ) SPIRODEFAULTS
	Red   INK 96 45  1 2*  9 + HYPOTROCHOID
	Blue  INK 96 45 10 2*  9 + HYPOTROCHOID
	Green INK 96 45 16 2*  9 + HYPOTROCHOID
	          96 63  3 2* 10 + HYPOTROCHOID
	Red   INK 96 63  5 2* 10 + HYPOTROCHOID ;

: Spiro25 ( -- ) SPIRODEFAULTS 0 HEADING Red INK
	17 0 DO 96 48 I 2* 10 + HYPOTROCHOID 120 MOVEHOME LOOP ;

: ((Spiro26)) ( -- ) 96 64 10 HYPOTROCHOID ;
: hop         ( -- ) -120 MOVEHOME ; 
: (Spiro26)   ( -- ) Blue INK 5 0 DO ((Spiro26)) hop LOOP hop Green INK 5 0 DO ((Spiro26)) hop LOOP hop ;
: Spiro26     ( -- ) SPIRODEFAULTS 180 HEADING 2000 MOVEHOME 3 0 DO (Spiro26) LOOP 0 HEADING 3 0 DO (Spiro26) LOOP ;

: Spiro27 ( -- ) SPIRODEFAULTS
	230 TILTFROMBELOW TILT 137 HEADING 137 HEADING
	14 0 DO I 2 MOD IF Red ELSE Blue THEN INK 96 80 15 HYPOTROCHOID TILT 2 TEETH RIGHT 2 TEETH RIGHT LOOP ;

: Spiro28 ( -- ) SPIRODEFAULTS
	150 TILTFROMBELOW TILT 114 HEADING 114 HEADING Blue INK
	17 0 DO 105 84 14 HYPOTROCHOID TILT 1 TEETH RIGHT 2 TEETH LEFT LOOP ;

: Spiro29 ( -- ) SPIRODEFAULTS 180 HEADING 140 14 * MOVEHOME 90 HEADING
	28 0 DO I 2 MOD IF Red ELSE Blue THEN INK
			96 72 I 2* 15 + HYPOTROCHOID 0 HEADING 140 MOVEHOME 90 HEADING LOOP ;

: Spiro30 ( -- ) SPIRODEFAULTS 180 HEADING 480 MOVEHOME 90 HEADING
	8 0 DO  I 0 = I 7 = OR IF Black INK ELSE
			I 1 = I 5 = OR IF Red   INK ELSE
			I 3 =          IF Green INK THEN THEN THEN
			105 42 10 HYPOTROCHOID 0 HEADING 120 MOVEHOME 90 HEADING LOOP ;

: Spiro31 ( -- ) SPIRODEFAULTS 9 MAGNIFICATION 90 HEADING
	Blue  INK 9 0 DO 144 72 5 EPITROCHOID 1 TEETH RIGHT LOOP  45 HEADING
	Red   INK 9 0 DO 144 72 5 EPITROCHOID 1 TEETH RIGHT LOOP   0 HEADING
	Green INK 9 0 DO 144 72 5 EPITROCHOID 1 TEETH RIGHT LOOP -45 HEADING
	Black INK 9 0 DO 144 72 5 EPITROCHOID 1 TEETH RIGHT LOOP -90 HEADING
	Green INK 96 52 10 HYPOTROCHOID
	Blue  INK 84 40 35 EPITROCHOID ;

\ prepare demo --------------------------------------------------------------------------------------
: ReSpeed ( n -- ) PrefsSpeed <! PAD COUNT EVALUATE !> ;
: ?Input ( -- ) KEY (>UPPER) CASE
	[ CHAR Q OLD] LITERAL OF SQUASH TRUE ABORT" Demo ended." 	ENDOF
	[ CHAR A OLD] LITERAL OF PAD COUNT EVALUATE RECURSE       	ENDOF
	[ CHAR 0 OLD] LITERAL OF    0 ReSpeed RECURSE				ENDOF
	[ CHAR 1 OLD] LITERAL OF    1 ReSpeed RECURSE				ENDOF
	[ CHAR 2 OLD] LITERAL OF  100 ReSpeed RECURSE				ENDOF
	[ CHAR 3 OLD] LITERAL OF  350 ReSpeed RECURSE				ENDOF
	[ CHAR 4 OLD] LITERAL OF  500 ReSpeed RECURSE				ENDOF
	[ CHAR 5 OLD] LITERAL OF 1000 ReSpeed RECURSE				ENDOF
	[ CHAR 6 OLD] LITERAL OF 1500 ReSpeed RECURSE				ENDOF
	[ CHAR 7 OLD] LITERAL OF 2000 ReSpeed RECURSE				ENDOF
	[ CHAR 8 OLD] LITERAL OF 2500 ReSpeed RECURSE				ENDOF
	[ CHAR 9 OLD] LITERAL OF 3000 ReSpeed RECURSE				ENDOF
	ENDCASE ;

: PrepareTitles&Command ( <command> -- 0$wTitle )						\ MyPad=window title; PAD=command
	C" TURTLEDEFAULTS " PAD $!											\ start of command
	0 PARSE-WORD MyPad PLACE											\ command in MyPad
	MyPad PAD $+! C"  ?Input" PAD $+!									\ end of command in PAD 
	C"  (Hit ENTER for next demo, Q to quit, A for again, 0-9 SPEED)" MyPad $+! MyPad $>0$ ;	\ 0$ window title

: TurtleDemo ( <command> -- ) PrepareTitles&Command						\ get screen and window titles and command
	wd MyPad 0" Turtle Graphics Demo" _SetWindowTitles					\ set window and screen titles
	PAD COUNT TYPE CR 
	PAD COUNT EVALUATE ;									\ run demo

TURTLE
TurtleDemo Pentagonal
TurtleDemo Octagonal
TurtleDemo 5 WIDTH Octagonal
TurtleDemo Diagonals
TurtleDemo Benzene
TurtleDemo Patchwork
TurtleDemo Circles
TurtleDemo Spokes
TurtleDemo 12 2000 Flower
TurtleDemo PENUP BOTTOMLEFT PENDOWN 6000 6 Square.F
TurtleDemo 1 SPEED Hypo01
TurtleDemo 1 SPEED Hypo02
TurtleDemo 1 SPEED Hypo03
TurtleDemo 1 SPEED 5000 4 Snowflake
TurtleDemo Spiro0
TurtleDemo 1 SPEED Hypo04
TurtleDemo 1 SPEED Hypo05
TurtleDemo 1 SPEED Hypo06
TurtleDemo 1 SPEED Hypo07
TurtleDemo Spiro1
TurtleDemo Spiro2
TurtleDemo 1 SPEED 21 144 18 Stars
TurtleDemo 1 SPEED Hypo08
TurtleDemo 1 SPEED Hypo09
TurtleDemo 1 SPEED Hypo10
TurtleDemo 1 SPEED Hypo11
TurtleDemo 1 SPEED Hypo12
TurtleDemo 1 SPEED Hypo13
TurtleDemo 1 SPEED Hypo14
TurtleDemo 1 SPEED Hypo15
TurtleDemo 1 SPEED Hypo16
TurtleDemo 1 SPEED Hypo17
TurtleDemo 1 SPEED Hypo18
TurtleDemo 1 SPEED Hypo19
TurtleDemo TreeDemo
TurtleDemo 1 SPEED Hypo27
TurtleDemo 1 SPEED Hypo28
TurtleDemo 1 SPEED Hypo29
TurtleDemo Hypo30
TurtleDemo Hypo31
TurtleDemo 1 SPEED Hypo32
TurtleDemo Hypo33
TurtleDemo 1 SPEED Hypo34
TurtleDemo Spiro6
TurtleDemo Spiro7
TurtleDemo Spiro8
TurtleDemo Spiro9
TurtleDemo Spiro10
TurtleDemo 1 SPEED 21 144 20 Stars
TurtleDemo 1 SPEED Hypo37
TurtleDemo 1 SPEED Hypo38
TurtleDemo 1 SPEED Hypo39
TurtleDemo 1 SPEED Hypo40
TurtleDemo 1 SPEED Hypo41
TurtleDemo Spiro11
TurtleDemo Spiro12
TurtleDemo Spiro13
TurtleDemo CurlyDemo
TurtleDemo 1 SPEED Hypo24
TurtleDemo 1 SPEED Hypo25
TurtleDemo 1 SPEED Hypo26
TurtleDemo 1 SPEED Hypo35
TurtleDemo 1 SPEED Hypo36
TurtleDemo Spiro14
TurtleDemo Spiro15
TurtleDemo Spiro16
TurtleDemo Spiro17
TurtleDemo DragonDemo
TurtleDemo OutsideIn
TurtleDemo InsideOut
TurtleDemo 1 SPEED Hypo48
TurtleDemo 1 SPEED Hypo49
TurtleDemo 1 SPEED Hypo50
TurtleDemo 1 SPEED Hypo51
TurtleDemo 1 SPEED Hypo52
TurtleDemo 1 SPEED Hypo53
TurtleDemo Spiro18
TurtleDemo Spiro19
TurtleDemo Spiro20
TurtleDemo Spiro21
TurtleDemo Spiro22
TurtleDemo Spiro23
TurtleDemo Spiro24
TurtleDemo Spiro25
TurtleDemo SpiralHelix
TurtleDemo 1 SPEED 17 72 18 Stars
TurtleDemo 150 Star
TurtleDemo 750 Spiral
TurtleDemo Quora
TurtleDemo Spiro28
TurtleDemo Spiro29
TurtleDemo Spiro30
TurtleDemo Spiro31
TurtleDemo Zoe
TurtleDemo 5 WIDTH Polygons
TurtleDemo 1 SPEED Hypo20	\ cut revolutions
TurtleDemo 1 SPEED Hypo21
TurtleDemo 1 SPEED Hypo22
TurtleDemo 1 SPEED Hypo23
TurtleDemo Spiro3
TurtleDemo Spiro4
TurtleDemo Spiro5
TurtleDemo 1 SPEED Hypo42
TurtleDemo 1 SPEED Hypo43
TurtleDemo 1 SPEED Hypo44
TurtleDemo 1 SPEED Hypo45
TurtleDemo 1 SPEED Hypo46
TurtleDemo 1 SPEED Hypo47
TurtleDemo Spiro26
TurtleDemo Spiro27
SQUASH
