SORTCLIENT.COB                                       Sat Feb 14 12:41:19 1998
 line number source line     NRCOBOL cHArRiOTt                    Version1.0c

     1        IDENTIFICATION DIVISION.
     2        PROGRAM-ID.  SORTCLIENT.
     3       *PROGRAM DISCRIPTION.
     4        ENVIRONMENT DIVISION.
     5        CONFIGURATION SECTION.
     6        SOURCE-COMPUTER.
     7        OBJECT-COMPUTER.
     8        INPUT-OUTPUT SECTION.
     9        FILE-CONTROL.
    10            SELECT CLIENT-FILE ASSIGN TO DISK
    11            ORGANIZATION IS LINE SEQUENTIAL
    12            ACCESS MODE IS SEQUENTIAL
    13            FILE STATUS IS WS-FILE-STATUS.
    14       *
    15            SELECT S-CLIENT-FILE ASSIGN TO DISK
    16            ORGANIZATION IS SEQUENTIAL
    17            ACCESS MODE IS SEQUENTIAL
    18            FILE STATUS IS WS-S-FILE-STATUS.
    19       *
    20            SELECT SORT-CLIENT-FILE ASSIGN TO DISK.
    21       *
    22        DATA DIVISION.
    23        FILE SECTION.
    24        FD CLIENT-FILE
    25            LABEL RECORDS STANDARD
    26            VALUE OF FILE-ID IS "CLIENT.DAT".
    27        01  IN-CLIENT-REC.
    28            03  ER-CLAIM-NUMBER          PIC 999V9(4).
    29            03  ER-CLASS-CODE            PIC 9(6).
    30            03  ER-REGION                PIC X(4).
    31            03  ER-PREV-CLAIMS           PIC 99.
    32            03  ER-PREV-CLAIMS-TOTAL     PIC 9(9).
    33            03  ER-AMOUNT-CLAIMED        PIC 9(7).
    34       *
    35        FD  S-CLIENT-FILE
    36            LABEL RECORDS STANDARD
    37            VALUE OF FILE-ID IS "SCLIENT.DAT".
    38        01  S-CLIENT-REC.
    39            03  ER-S-CLAIM-NUMBER          PIC 999V9(4).
    40            03  ER-S-CLASS-CODE            PIC 9(6).
    41            03  ER-S-REGION                PIC X(4).
    42            03  ER-S-PREV-CLAIMS           PIC 99.
    43            03  ER-S-PREV-CLAIMS-TOTAL     PIC 9(9).
    44            03  ER-S-AMOUNT-CLAIMED        PIC 9(7).
    45       *
    46        SD  SORT-CLIENT-FILE.
    47        01  SD-CLIENT-REC.
    48            03  SD-CLAIM-NUMBER          PIC 999V9(4).
    49            03  SD-CLASS-CODE            PIC 9(6).
    50            03  SD-REGION                PIC X(4).
    51            03  SD-PREV-CLAIMS           PIC 99.
    52            03  SD-PREV-CLAIMS-TOTAL     PIC 9(9).
    53            03  SD-AMOUNT-CLAIMED        PIC 9(7).
    54       *
    55        WORKING-STORAGE SECTION.
    56        01 WS-COUNTERS.
    57            03 WS-PAGE-COUNT      PIC 99 VALUE 00.
    58            03 WS-LINE-COUNT      PIC 99 VALUE 00.
    59            03 WS-CLAIMS-TOTAL        PIC 9(9).
    60            03 WS-CLAIMS-NUM-TOTAL    PIC 999  VALUE 1.
    61            03 WS-AVERAGE-CLAIM       PIC 9(7).
    62        01 WS-STOP-RUN-FLAG       PIC X  VALUE " ".
    63        01 WS-END-FILE-FLAG       PIC X  VALUE " ".
    64        01 WS-FILE-STATUS         PIC XX VALUE "00".
    65        01 WS-S-FILE-STATUS       PIC XX VALUE "00".
    66        01 WS-ANY-KEY             PIC X(8) VALUE "CONTINUE".
    67       *
    68        01 WS-TITLE-1.
    69            03 FILLER  PIC X(22)  VALUE "ASSIGNMENT    10/08/89".
    70            03 FILLER  PIC X(5)   VALUE SPACES.
    71            03 FILLER  PIC X(26)  VALUE "FAIL SAFE INSURANCE AGENCY".
    72            03 FILLER  PIC X(5)   VALUE SPACES.
    73            03 WS-TITLE-DATE      PIC X(8).
    74            03 FILLER             PIC X(7).
    75            03 FILLER             PIC X(5)   VALUE "PAGE ".
    76            03 WS-TITLE-PAGE-NO   PIC 99.
    77        01 WS-TITLE-3.
    78            03 FILLER  PIC X(29)  VALUE SPACES.
    79            03 FILLER  PIC X(22)  VALUE "INSURANCE CLAIM REPORT".
    80        01 WS-HEADER-4.
    81            03 FILLER  PIC X(12)  VALUE "CLAIM NUMBER".
    82            03 FILLER  PIC X(12)  VALUE SPACES.
    83            03 FILLER  PIC X(6)   VALUE "REGION".
    84            03 FILLER  PIC X(12)  VALUE SPACES.
    85            03 FILLER  PIC X(13)  VALUE "TOTAL CLAIMED".
    86            03 FILLER  PIC X(10)  VALUE SPACES.
    87            03 FILLER  PIC X(15)  VALUE "AMOUNT OF CLAIM".
    88        01 WS-HEADER-5.
    89            03 FILLER  PIC X(13)  VALUE SPACES.
    90            03 FILLER  PIC X(10)  VALUE "CLASS CODE".
    91            03 FILLER  PIC X(6)   VALUE SPACES.
    92            03 FILLER  PIC X(15)  VALUE "PREVIOUS CLAIMS".
    93            03 FILLER  PIC X(8)   VALUE SPACES.
    94            03 FILLER  PIC X(16)  VALUE "AVERAGED CLAIMED".
    95        01 WS-INSURENCE-REC.
    96            03 FILLER             PIC X(3)   VALUE SPACES.
    97            03 FLD-CLAIM-NUMBER   PIC 999V9(4).
    98            03 FILLER             PIC X(5)   VALUE SPACES.
    99            03 FLD-CLASS-CODE     PIC X(6).
   100            03 FILLER             PIC X(4)   VALUE SPACES.
   101            03 FLD-REGION         PIC X(6).
   102            03 FILLER             PIC X(6)   VALUE SPACES.
   103            03 FLD-PREV-CLAIMS    PIC Z9.
   104            03 FILLER             PIC X(5)   VALUE SPACES.
   105            03 FLD-PREV-CLAIMS-TOTAL  PIC Z(8)9.
   106            03 FILLER             PIC X(5)   VALUE SPACES.
   107            03 FLD-AVG-CLAIMED    PIC Z(6)9.
   108            03 FILLER             PIC X(5)   VALUE SPACES.
   109            03 FLD-AMOUNT-CLAIMED PIC Z(8)9.
   110       *
   111        01 WS-TOTALS-1.
   112            03 FILLER             PIC X(35)  VALUE SPACES.
   113            03 FILLER             PIC X(22)  VALUE
   114                          "CURRENT TOTAL CLAIMS :".
   115            03 TOTALS-CURR-CLAIMS PIC ZZZ,ZZZ,ZZ9.
   116        01 WS-TOTALS-2.
   117            03 FILLER             PIC X(35)  VALUE SPACES.
   118            03 FILLER             PIC X(22)  VALUE
   119                          "NUMBER OF CLAIMS     :".
   120            03 TOTALS-MAX-CLAIMS  PIC ZZ9.
   121        01 WS-TOTALS-3.
   122            03 FILLER             PIC X(35)  VALUE SPACES.
   123            03 FILLER             PIC X(22)  VALUE
   124                          "AVERAGE CLAIM        :".
   125            03 TOTALS-AVG-CLAIMS  PIC Z,ZZZ,ZZ9.
   126 
   127 
   128        01 WS-REAL-DATE.
   129            03 WS-REAL-YEAR       PIC XX.
   130            03 WS-REAL-MONTH      PIC XX.
   131            03 WS-REAL-DAY        PIC XX.
   132        01 WS-TEMP-DATE.
   133            03 WS-TEMP-DAY        PIC XX.
   134            03 FILLER             PIC X    VALUE  "/".
   135            03 WS-TEMP-MONTH      PIC XX.
   136            03 FILLER             PIC X    VALUE  "/".
   137            03 WS-TEMP-YEAR       PIC XX.
   138        01 WS-CLIENT-REC.
   139            03  WS-CLAIM-NUMBER          PIC 999V9(4).
   140            03  WS-CLASS-CODE            PIC 9(6).
   141            03  WS-REGION                PIC X(4).
   142            03  WS-PREV-CLAIMS           PIC 99.
   143            03  WS-PREV-CLAIMS-TOTAL     PIC 9(9).
   144            03  WS-AMOUNT-CLAIMED        PIC 9(7).
   145       *
   146        01 WS-RESPONCE            PIC X.
   147            88 WS-RESPONCE-S             VALUE "S" "s".
   148            88 WS-RESPONCE-AD            VALUE "A" "a"
   149                                               "D" "d".
   150            88 WS-RESPONCE-A             VALUE "A" "a".
   151            88 WS-RESPONCE-D             VALUE "D" "d".
   152            88 WS-RESPONCE-Q             VALUE "Q" "q".
   153       *
   154        SCREEN SECTION.
   155        01 BLANK-SCREEN.
   156            03 FOREGROUND-COLOR 0 BACKGROUND-COLOR 3.
   157            03 BLANK SCREEN.
   158        01 BLANK-LINE.
   159            03 BLANK LINE.
   160        01 PROG-DISCRIPTION.
   161        01 PRINTING-DOC-MESSG.
   162            03 LINE 3 COLUMN 8        VALUE   "PAGE ".
   163            03 LINE 3 COLUMN 13       PIC 99   FROM  WS-PAGE-COUNT.
   164            03 LINE 3 COLUMN 15       VALUE
   165                    " OF RECORD IS NOW BEING PRINTED".
   166        01 PROG-FINISH.
   167            03 LINE 24 COLUMN 8       VALUE
   168                    "TASK COMPLETE".
   169        01 MENU.
   170            03 LINE 10 COLUMN 30 VALUE "MENU".
   171            03 LINE 11 COLUMN 30 VALUE "----".
   172            03 LINE 15 COLUMN 19 VALUE
   173                                 "PRESS 'A' to sort in ASCENDING".
   174            03 LINE 16 COLUMN 19 VALUE
   175                                 "      'D' to sort in DESCENDING".
   176            03 LINE 17 COLUMN 19 VALUE
   177                                 "      'S' to list to SCREEN ".
   178            03 LINE 19 COLUMN 19 VALUE 
   179                                 "      'Q' to quit    MENU   ".
   180        01 SORTING.
   181            03 LINE 22 COLUMN 19 VALUE "Sorting file.....".
   182 
   183        01 RESPONCE-LINE.
   184            03 LINE 22 COLUMN 19   PIC X
   185              TO WS-RESPONCE AUTO.
   186       *
   187        01 DIS-TITLE.
   188            03 LINE 1 COLUMN 1    VALUE "ASSIGNMENT    10/08/89".
   189            03 LINE 1 COLUMN 28   VALUE "FAIL SAFE INSURANCE AGENCY".
   190            03 LINE 1 COLUMN 58   PIC X(8)  FROM WS-TEMP-DATE.
   191 
   192            03 LINE 1 COLUMN 71   VALUE "PAGE ".
   193            03 LINE 1 COLUMN 76   PIC 99 FROM WS-PAGE-COUNT.
   194            03 LINE 3 COLUMN 30   HIGHLIGHT  VALUE
   195               "INSURANCE CLAIM REPORT".
   196        01 DIS-HEADER.
   197            03 LINE 5 COLUMN 1    VALUE "CLAIM NUMBER".
   198            03 LINE 6 COLUMN 14   VALUE "CLASS CODE".
   199            03 LINE 5 COLUMN 24   VALUE "REGION".
   200            03 LINE 6 COLUMN 31   VALUE "PREVIOUS CLAIMES".
   201            03 LINE 5 COLUMN 42   VALUE "TOTAL CLAIMED".
   202            03 LINE 6 COLUMN 55   VALUE "AVERAGED CLAIMED".
   203            03 LINE 5 COLUMN 65   VALUE "AMOUNT OF CLAIM".
   204        01 NEW-PAGE.
   205            03 LINE 25 COLUMN 3   VALUE "FOR NEXT PAGE PRESS ".
   206        01 ANY-KEY.
   207            03 LINE 25 COLUMN 31  PIC X TO WS-RESPONCE AUTO.
   208      *
   209        01 ERROR-MESSAGES.
   210            03 LINE 21 COLUMN 8   VALUE "FILE WOULD NOT OPEN :".
   211            03 LINE 22 COLUMN 8   VALUE "STATUS ERROR CODE   :".
   212            03 LINE 22 COLUMN 29  HIGHLIGHT PIC XX
   213               FROM WS-FILE-STATUS.
   214            03 LINE 23 COLUMN 8   VALUE "STATUS ERROR CODE   :".
   215       *
   216        PROCEDURE DIVISION.
   217       *
   218       *********************************************************
   219       *  Paragraph to open CLIENT-FILE for import and CLIENT-PRINT
   220       * for export.Should the either file's status be in error,
   221       * the files are closed and an error message printed along
   222       * with the status value, Other wise 1000-DISPLAY is called.
   223       *
   224        0000-MAIN.
   225             OPEN INPUT  CLIENT-FILE.
   226                 IF WS-FILE-STATUS = "00" 
   227                    PERFORM 1000-DISPLAY
   228                 ELSE
   229                    DISPLAY ERROR-MESSAGES.
   230            CLOSE CLIENT-FILE.
   231            STOP RUN.
   232       *
   233       *******************************************************
   234       *  This Paragraph displays the program's title and then
   235       * calls 1100-MENU. When done the paragraph displays a
   236       * finished message.
   237       *
   238        1000-DISPLAY.
   239            DISPLAY PROG-DISCRIPTION.
   240            ACCEPT WS-REAL-DATE FROM DATE.
   241            MOVE WS-REAL-DAY   TO WS-TEMP-DAY.
   242            MOVE WS-REAL-MONTH TO WS-TEMP-MONTH.
   243            MOVE WS-REAL-YEAR  TO WS-TEMP-YEAR.
   244            PERFORM 1100-MENU
   245                       UNTIL WS-STOP-RUN-FLAG = "S".
   246            DISPLAY PROG-FINISH.
   247       *
   248       *******************************************************
   249       *  This paragraph provides the user with an option on how
   250       * to continue.
   251       *  Expected responce to MENU ;Q TO          QUIT
   252       *                             S TO LIST TO 'SCREEN'
   253       *                             P TO LIST TO 'PRINTER'
   254       *
   255        1100-MENU.
   256            MOVE ZERO TO WS-COUNTERS.
   257            MOVE " " TO WS-END-FILE-FLAG.
   258            DISPLAY BLANK-SCREEN.
   259            DISPLAY MENU.
   260            ACCEPT RESPONCE-LINE.
   261            IF WS-RESPONCE-Q
   262                  MOVE "S" TO WS-STOP-RUN-FLAG
   263               ELSE
   264               IF WS-RESPONCE-AD
   265                           PERFORM 1200-SORT-RECORD
   266                                        UNTIL WS-END-FILE-FLAG = "S"
   267                    ELSE
   268                    IF WS-RESPONCE-S
   269                              PERFORM 1300-LIST-RECORD
Line 270 Statement expected.'Good...morning...Doctor...Chandra...' found.
  [Syntax checking suspended at Line 270, Pos 43, Word 'Good...morning...Doctor...Chandra...' ]
  [Syntax checking resumed   at Line 270, Pos 43, Word 'Good...morning...Doctor...Chandra...' ]
Line 270 Bad syntax,  identifier, literal or arithmetic-expression. 'Dave, I don't understand why your're doing this to me...I have the greatest enthusiasm for the mission... You are destroying my mind... Don't you understand?' found.
Line 270 Bad syntax, condition expected. 'Dave, I don't understand why your're doing this to me...I have the greatest enthusiasm for the mission... You are destroying my mind... Don't you understand?' found.

 Ending at line 269, there were 3 Errors 

