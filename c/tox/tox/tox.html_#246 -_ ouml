<!-- X-URL: http://www.40hz.org/tox/ -->
<!-- Date: Wed, 05 Oct 2005 17:12:06 GMT -->
<!-- Last-Modified: Tue, 04 Nov 2003 07:48:13 GMT -->
<BASE HREF="http://www.40hz.org/tox/">




<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
    <title>tox</title>
    <meta name="author" content="Eckhart K&ouml;ppen">
    <meta name="date" content="">
    <meta name="keywords" content="tox Tokenizer XML">
  </head>
<body vlink="#5b5b5b" link="black" text="black" bgcolor="white">
    <table width="100%" cellspacing="0" cellpadding="0" border="0">
      <tr>
        <td bgcolor="#336699" colspan="2"><img src="/spacer.gif" height="5" width="1"></td>
      </tr>
      <tr>
        <td bgcolor="#336699">
          <font face="helvetica,arial,sans-serif" color="white">
            <b><img src="/spacer.gif" width="5">tox</b>
          </font>
        </td>
        <td bgcolor="#336699" align="right">
          <a href="/">
            <font face="helvetica,arial,sans-serif" color="white">
              <b>40Hz</b>
            </font>
          </a><img src="/spacer.gif" width="5"></td>
      </tr>
      <tr>
        <td bgcolor="#336699" colspan="2"><img src="/spacer.gif" height="3" width="1"></td>
      </tr>
      <tr>
        <td><img src="/spacer.gif" height="10" width="1"></td>
      </tr>
      <tr valign="top">
        <td width="40%" valign="middle"><img src="tox-logo.gif"></td>
        <td>
<h1>
            <font face="helvetica,arial,sans-serif">tox</font>
          </h1>
<p>
Tox is a simple tokenizer for XML and HTML data written in <tt>C</tt>. Its main part is a finite state machine (FSM) that covers most of the basic states needed to parse XML and HTML data. The main design goal is to minize code size and RAM usage. Tox can be configured to handle different character types such as unsigned char or unsigned short. It is not a fully functional XML parser yet, handling of UTF-8 input, DTD processing and validation is missing.
</p>
<p>
            <b>Version</b>: 0.4</p>
<p>
            <b>Author</b>: Eckhart K&#246;ppen</p>
<p>
            <b>License</b>: <a href="/LGPL.html">LGPL 2.0</a>
          </p>
</td>
      </tr>
      <tr>
        <td><img src="/spacer.gif" height="10" width="1"></td>
      </tr>
      <tr>
        <td colspan="2" bgcolor="#336699"><img src="/spacer.gif" height="3" width="1"></td>
      </tr>
      <tr>
        <td><img src="/spacer.gif" height="3" width="1"></td>
      </tr>
    </table>
    <h3>
      <font face="helvetica,arial,sans-serif">Usage</font>
    </h3>
    <dl>
      <dd>
<p>
The state of a parser is held in a <tt>parser_state</tt> structure.
It should be cleared before usage, i.e. all fields should be set to
zero. To parse some text, the following fields need to be set:
</p>

<ul>
<li>
            <tt>text</tt>: The text to be parsed.</li>
<li>
            <tt>maxtext</tt>: The length of the text. Note that this field
alone determines the text length and not a trailing zero byte.</li>
<li>
            <tt>char_width</tt>: Character width (can be one or two).</li>
<li>
            <tt>buffer</tt>: To retrieve the parsed components of a document
such as tag names or attribute values, this field needs to point to a
preallocated memory area. The character width is the same as for the input text.</li>
<li>
            <tt>maxbuffer</tt>: This field determines the maximum number of
characters in the <tt>buffer</tt> field.</li>
</ul>

<h4>
          <font face="helvetica,arial,sans-serif">XML Parsing</font>
        </h4>
<p>To capture parsing events and process the components of an XML
document, callback functions need to be set. They are called with the
current <tt>parser_state</tt> structure. Currently, the following
callbacks can be set:</p>

<ul>
<li>
            <tt>element_callback</tt>: Gets called whenever a tag name in a
start and end tag has been encountered.</li>
<li>
            <tt>attrname_callback</tt>: Is called for attribute names.</li>
<li>
            <tt>attrval_callback</tt>: Is called after an attribute value
has been parsed.</li>
<li>
            <tt>word_callback</tt>: Gets called for every word between tags,
seperated by whitespace.</li>
<li>
            <tt>ws_callback</tt>: Handles whitespace (carriage returns,
linefeeds, tabulators and space characters).</li>
</ul>

<p>The value of the parsed component (tag name, attribute name etc) can
be found in the <tt>buffer</tt> field of the
<tt>parser_state</tt> structure. It will be in the same format (i.e. character width) as the input text.</p>

<p>The parser is started by calling <tt>tox_parse</tt>. The parser
parses one character at a time, making interruptions of the parsing
process at any time possible. The parser structure can be used
repeatedly after calling <tt>tox_parse</tt>, e.g. parsing blocks of
data coming over a socket connection.</p>

<h4>
          <font face="helvetica,arial,sans-serif">HTML Parsing</font>
        </h4>
<p>
HTML parsing is supported if the code is compiled with the macro HTML defined. In HTML mode, tox is much more forgiving and accepts otherwise incorrect XML code.
</p>
</dd>
    </dl>
    <h3>
      <font face="helvetica,arial,sans-serif">Implementation</font>
    </h3>
    <dl>
      <dd>
<p>Tox is built around a table containing most of the relevant states
for parsing XML documents (<tt>range_table</tt>). The parsing
function <tt>tox_parse</tt> simply examines the current character in
the given text and performs state transitions. Relevant data is captured
in the <tt>buffer</tt> field of the <tt>parser_state</tt>
structure. The capture is controlled by the <tt>pump</tt> field
which gets toggled according to the information in the
<tt>range_table</tt>.
</p>
</dd>
    </dl>
    <h3>
      <font face="helvetica,arial,sans-serif">Files</font>
    </h3>
    <dl>
      <dd>
<p>Tox consists of just two files:</p>
<ul>
<li>
            <a href="tox.c">tox.c</a>
          </li>
<li>
            <a href="tox.h">tox.h</a>
          </li>
</ul>
<p>A simple example describing how to use tox can be found in <a href="main.c">main.c</a>.</p>
</dd>
    </dl>
    <h3>
      <font face="helvetica,arial,sans-serif">To Do List</font>
    </h3>
    <dl>
      <dd>
<ul>
<li>Handle CDATA, possible using blocked data transfers to the driving
application.</li>
<li>Add UTF-8 support.</li>
</ul>
</dd>
    </dl>
  </body>
</html>



