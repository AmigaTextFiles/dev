# smakefile for dl1 quantizer
# Based on a makefile by Stefan Zivkovic

##### MACROS #####

LIBRARYDIR = //library/outputhandlers

TMP_FILE = T:dl1TMP_SCOPTS

QUANTIZEROBJECTS = dl1quant.o

LIBRARYSCFLAGS = idlen=63 nocheckabort

# Features to make and link a shared library for amiga
VERSION = 2
REV = 0
LIBRARYFD = //include/fd/outputhandler.fd
DL1_LIBRARY = $(LIBRARYDIR)/dl1
MAKELIBRARY = slink WITH lib:utillib.with lib lib:scm881.lib+lib:sc.lib+lib:amiga.lib libversion $(VERSION) librevision $(REV) libfd $(LIBRARYFD) TO $(DL1_LIBRARY) FROM lib:libent.o lib:libinitr.o

CC = sc

##### RULES #####
.a.o:
    $(CC) WITH=$(TMP_File) $*.a

.c.o:
    $(CC) WITH=$(TMP_File) $*.c

##### TARGETS #####

default:
    smake library

library: $(DL1_LIBRARY)
    @echo "------- FINISHED ------"

$(DL1_LIBRARY): AmigaLibrary $(QUANTIZEROBJECTS) DeleteTMP
    @echo "------ Making Library -----"
    $(MAKELIBRARY) $(QUANTIZEROBJECTS)


# Makes temporary scoptions to use in global .c.o

AmigaLibrary:
    @echo >$(TMP_FILE) "$(LIBRARYSCFLAGS)"
DeleteTMP:
    @delete $(TMP_FILE)

