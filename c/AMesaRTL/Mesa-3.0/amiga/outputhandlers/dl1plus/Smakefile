# smakefile for dl1plus quantizer
# Based on a makefile by Stefan Zivkovic

##### MACROS #####

LIBRARYDIR = //library/outputhandlers

TMP_FILE = T:dl1TMP_SCOPTS

QUANTIZEROBJECTS = dl1plus.o

LIBRARYSCFLAGS = idlen=63 nocheckabort

# Features to make and link a shared library for amiga
VERSION = 2
REV = 0
LIBRARYFD = //include/fd/outputhandler.fd
DL1_LIBRARY = $(LIBRARYDIR)/dl1plus

# libs for 040 or 881 FPU

# MATHLIBS=lib:scm040.lib+lib:scm881.lib
MATHLIBS=lib:scm881.lib

MAKELIBRARY = slink WITH lib:utillib.with lib $(MATHLIBS)+lib:sc.lib+lib:amiga.lib libversion $(VERSION) librevision $(REV) libfd $(LIBRARYFD) TO $(DL1_LIBRARY) FROM lib:libent.o lib:libinitr.o lib:debug.lib

CC = sc

##### RULES #####
.a.o:
    $(CC) WITH=$(TMP_File) $*.a

.c.o:
    $(CC) WITH=$(TMP_File) $*.c

##### TARGETS #####

default:
    smake library

library: $(DL1_LIBRARY)
    @echo "------- FINISHED ------"

$(DL1_LIBRARY): AmigaLibrary $(QUANTIZEROBJECTS) DeleteTMP
    @echo "------ Making Library -----"
    $(MAKELIBRARY) $(QUANTIZEROBJECTS)


# Makes temporary scoptions to use in global .c.o

AmigaLibrary:
    @echo >$(TMP_FILE) "$(LIBRARYSCFLAGS)"
DeleteTMP:
    @delete $(TMP_FILE)

