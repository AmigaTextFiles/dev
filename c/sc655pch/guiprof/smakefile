GUIPROFOBJS = guiprof.o timer.o report.o smbar.o
TESTOBJS  = test.o sprofutil.o

all: test smalltest guiprof

test: guiprof.gst $(TESTOBJS)
   sc link $(TESTOBJS) to test

smalltest: guiprof.gst smalltest.o sprofutil.o
   sc link smalltest.o sprofutil.o to smalltest

smalltest.o: test.c 
   sc test.c define SMALLTEST=1 noopt profile objname=smalltest.o

test.o: test.c 
   sc test.c noopt profile

guiprof: guiprof.exe
   slink guiprof.exe to guiprof nd

guiprof.exe: guiprof.gst $(GUIPROFOBJS)
   sc link $(GUIPROFOBJS) to guiprof.exe nosmallcode

guiprof.gst: guiprofpriv.h
   sc guiprof.c mgst guiprof.gst noobjname

guiprof.o: guiprof.c guiprofpriv.h guiprof.h
timer.o: timer.c
smbar.o: smbar.c smbar.h
report.o: report.c guiprofpriv.h guiprof.h smbar.h
sprofutil.o: sprofutil.c guiprofpriv.h

clean:
   -delete \#?.exe \#?.o \#?.map \#?.lnk \#?.gst guiprof quiet force
   -avail >nil: flush
