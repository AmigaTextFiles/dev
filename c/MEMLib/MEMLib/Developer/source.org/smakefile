CDEF     = DEFINE=MWDEBUG=1 CPU=ANY NOUTILLIB STRICT
CFLAGS   =
LC2FLAGS =
LIBOBJS  = mwcontrol.o mwreport.o mwlogname.o mwflags.o \
           mwstrdup.o mwgetenv.o mwgetcwd.o
TALKOBJS = mwtalk.o

default: memwatch.gst memwatch.lib example

memwatch.lib: memwatch.gst $(LIBOBJS)
  oml memwatch.lib r $(LIBOBJS)

example: memwatch.gst example.o memwatch.lib
  sc $(CDEF) link example.o to example lib memwatch.lib

clean:
   -Delete \#?.gst \#?.o \#?.lst \#?.lnk \#?.map quiet

spotless: clean
   -Delete \#?.lib example

mwcontrol.o    : mwcontrol.c   memwatch.gst
mwreport.o     : mwreport.c    memwatch.gst
mwlogname.o    : mwlogname.c   memwatch.gst
mwflags.o      : mwflags.c     memwatch.gst
mwstrdup.o     : mwstrdup.c    memwatch.gst
mwgetcwd.o     : mwgetcwd.c    memwatch.gst
mwgetenv.o     : mwgetenv.c    memwatch.gst
example.o      : example.c     memwatch.h
   sc nogst example.c

memwatch.gst   : memwatch.h mempriv.h
   sc $(CDEF) IGNORE=105 precomp.c mgst memwatch.gst

.c.o :
  sc $<
