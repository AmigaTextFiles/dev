HEAD = extheader.o

SCOPTSPL = RESOPT OPTIMIZE NOVERSION DATA=FARONLY NOSTACKCHECK NOCHECKABORT
SCOPTS   = RESOPT OPTIMIZE NOVERSION NOICON LINK
SLOPTSPL = STRIPDEBUG SMALLDATA SMALLCODE NOICONS FROM $(HEAD)

ALL: master plugins/plugin_hello plugins/plugin_2

# ************* global header

$(HEAD): extheader.c
	sc $(SCOPTSPL) $? OBJNAME=$@

# ************* plugin_hello

plugins/plugin_hello: $(HEAD) plugin_hello.o
	slink $(SLOPTSPL) plugin_hello.o TO $@

plugin_hello.o: plugin_hello.c plugin.h
	sc $(SCOPTSPL) plugin_hello.c OBJNAME=$@

# ************* plugin_2

plugins/plugin_2: $(HEAD) plugin_2.o
	slink $(SLOPTSPL) plugin_2.o TO $@

plugin_2.o: plugin_2.c plugin.h
	sc $(SCOPTSPL) plugin_2.c OBJNAME=$@

# ************* the master

master: master.c plugin.h
	sc $(SCOPTS) master.c

# ************* cleanup

clean:
	delete \#?.lnk \#?.o

cleanall:
	delete \#?.lnk \#?.o plugins/plugin_\#? master

