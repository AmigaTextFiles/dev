; $VER: StormC-Demo V1.1 Install Version 1.06i (8.7.96)

; Script di Installazione

; (c) 1996 HAAGE & PARTNER Computer GmbH
; Traduzione in italiano di Reinhard Spisser


(complete 0)



; La versione e la data di compilazione di questa versione

(set stcpp-version "1.1")

(set stcpp-date "(17 Jul 96)")



;====================================================================

; Inizializzazioni





(set @default-dest "")



(set os-version (/ (getversion) 65536))

(set os-13 (< os-version 36))

(set os-20 (>= os-version 36))

(set os-21 (>= os-version 38))



(set totalmem (database "total-mem")) ; Questa funzione ci semplifica la vita



; Il Percorso dei programmi usati



;(set run-lha				"run RAM:Lhex x -a ")

;(set run-free				"run C/StormFree")



; Qui si trovano i vari file da copiare...



(set #binsource 			(tackon (pathonly @icon) "StormSYS"))	; I programmi eseguibili

(set #includesource 		(tackon (pathonly @icon) "INCLUDE")) 	; Gli include

(set #envsource			(tackon (pathonly @icon) "ENV"))			; Le Preferenze

(set #libsource			(tackon (pathonly @icon) "LIB"))			; Le Librerie

(set #samplesource		(tackon (pathonly @icon) "Examples"))	; Le sorgenti dei programmi dimostrativi

(set #manualsource		(tackon (pathonly @icon) "MANUAL"))		; La documentazione

(set #toolssource       (tackon (pathonly @icon) "TOOLS"))		; I tool

(set #flibsource        (tackon (pathonly @icon) "Fast-Ansi-Lib")) ; Hier steht die neue Ansi-lib

(set #muilibsource      (tackon (pathonly @icon) "Mui-Class-Lib")) ; Hier steht die Mui Klassen-Library

(set source-Liesmich 	(tackon (pathonly @icon) "Leggimi"))		; Il file LEGGIMI

(set source-ikon		(tackon (pathonly @icon) "StormCPP.info"))	; L'icona del Programma

(set #wizlibsource      (tackon (pathonly @icon) "LIBS/Wizard.library")) ; Le nuove classi Boopsi


;(set !auswahlhilfe

;	(cat "\Sul disco si trova già una versione precedente \n "

;        "del file da installare. \n\n"

;        "Selezionando \"Yes\", il file vecchio verrà sovrascritto,  "

;        "con  \"No\" il file non verrà copiato\n"))



(set #prp-copy-samples

	"Copia di:\nEsempi C e C++...")

(set #hlp-copy-samples

	"Utilizzare il manuale e gli esempi per un avvio rapido con StormC")

(set #prp-copy-env

	"Copia di:\nIcone di default di StormC...")

(set #hlp-copy-env

	"Le icone sono utilizzate dal gestore progetti e dal editor")

(set #prp-copy-includes

	"Copia di:\nInclude C++...")


(set #hlp-copy-includes

	"Gli include sono necessari per il compilatore")

(set #prp-copy-libs

	"Copia di:\nLibrerie del linker...")


(set #hlp-copy-libs

	"Queste liberie vengono utilizzate dal linker")

(set #prp-copy-manual

	"Copia di:\nDocumentazione...")

(set #hlp-copy-manual

	"Questo è un file AmigaGuide per StormC")

(set #prp-copy-bin

	"Copia di:\nEseguibili di StormC...")

(set #hlp-copy-bin

	"Per la prima installazione di StormC \nè consigliabile copiare tutto!")

(set #prp-copy-tools

  	"Copia di:\nScreentool...")

(set #hlp-copy-tools
	"Questa è una Screenmanager-Commodity per StormC")

(set #prp-copy-lib
	"Copia di:\nWizard.library...")

(set #hlp-copy-lib
	"Questa è la libreria di classi Boopsi di StormWizard!")

(set #prp-copy-fastlib
   "Copying the FAST-ANSI-Library")

(set #hlp-copy-fastlib
   "With it you can generate fast ANSI-C programms.")

(set #prp-copy-muilib
   "Copying the Mui Klassen-Library")

(set #hlp-copy-muilib
   "The library makes it possible to program MUI with C++")

; Le Dimensioni dei vari file

(set size-stormcpp			24000)
(set size-stormc				432000)
(set size-stormed				200000)
(set size-stormshell	 	 	330000)
(set size-stormrun			220000)
(set size-stormasm			36000)
(set size-stormpics			50000)
(set size-stormlex			50000)
(set size-libs					350000)
(set size-inlcudes			400000)
(set size-demos				100000)


(set size-komplett	( + size-stormrun size-stormasm size-stormcpp size-stormc size-stormed size-stormshell size-stormpics size-stormlex size-libs size-inlcudes size-demos))



; ----------------------------- Procedure ------------------------------



(Procedure Make_Folder

    (

    (set folder (tackon folder "StormC"))

    (if (= (exists folder) 0)

       (

       (makedir folder (infos))

       )

    ))

)



;=====================================================================================

; Beginn der Installation

;=====================================================================================



; Eine kleine Einleitung, gefolgt vom Startbild des Installers.



(set act-user-level @user-level)

(user 1)



(message (cat	"\nBenvenuti all'installazione di \n\n\"StormC demo "
					 stcpp-version " del "stcpp-date "\"!\n\n"
					"Questo script copia su disco fisso tutti i file\n"
					"necessari per un corretto funzionamento\n"
					"di StormC.\n"))



(user act-user-level)

(welcome)



(complete 5)



(set act-user-level @user-level)

(user 1)





;	Alte Version pruefen und entsprechende Warnung ausgeben! **************************************************************



(set folder "WORK:StormC")



(if (exists "StormC:" (noreq))
	(
		(message (cat	"\nSul disco si trova già una versione di StormC\n"
						"Selezionare la directory padre tramite \"Parent Drawer\"\n"
						"se si desidera aggiornare StormC!"))

	(set folder (getassign "STORMC"))
	)
)



(set cmpstr (getassign "STORMC"))



(user act-user-level)



(if (= @user-level 0)

	(

	(user 1)

	(message (cat	"La modalità ENTRY necessita di almeno \n5 MB spazio libero sul disco fisso\n."

						"Selezionare una directory/volume per l'installazione di StormC"

						"\n\n"

						"Le altre impostazioni verranno effettuati dall'installazione "

						"per adattarsi al tuo sistema."))))



(set ok 0)

(while (not ok)

	(set folder

		(askdir

			(prompt (cat "\n"

							 "Selezionare un percorso per l'installazione di StormC.\n"

							 "Verrà crato una directory StormC!"))

			(help (cat	"    Premendo 'Show drives' verrà visualizzato\n un elenco di tutti i i volumi disponibili.\n"

							"Da questa lista selezionare uno dei nomi non colorati.\n "

							"    Nomi tipici sono \"Work:\", \"HD0:\" oppure \"DH0:\"; "

							"non utilizzare nomi come \"DF0:\", \"DF1:\", "

							"\"DF2:\", \"DF3:\", \"RAD:\", \"RAM:\", \"System2.0:\", "

							"\"WB_2.x:\", \"System3.0:\" oppure \"WB_3.x:\"!"

							"\n\n"

							"L'installazione di StormC non può essere effettuata direttamente\nin un volume.\n"

							"Deve essere selezionata una directory, altrimenti verrà visualizzato un errore. "

							"\n\n"

							@askdir-help))

			(default folder)

			(disk)

		)

	)



   (Make_Folder)    ; // Crea automaticamente la directory!



	; Ist der Dateiname leer oder endet mit einem ':' oder existiert unter

	; diesem Namen kein Verzeichnis, wird eine Fehlermeldung angezeigt; andernfalls

	; kann die Auswahl-Schleife beendet werden.

	(if (or (or (or (<= (strlen folder) 0) (= (substr folder (- (strlen folder) 1) 1) ":")) (= (exists folder (noreq)) 0)) (= (getdiskspace folder) -1))

		(message (cat	"\n \"" folder "\" non è una "

							"directory valida !\n\n"

							"Utilizzare 'Show drives' per visualizzare un elenco di tutti i volumi disponibili! "

							" Da questa lista, selezionare solo gli elementi non colorati!."

							"\n"

							"Utilizzare \"New drawer...\" per creare una nuova directory nel volume corrente"))

		;else

		(

			(set freediskspace (getdiskspace folder))	; Der freie Speicher auf diesem Medium



			(if (< freediskspace size-komplett)

				(

				(user 1)

				(message (cat	"\nIl volume selezionato non ha sufficiente\n"
				"spazio libero per l'installazione completa di StormC. "

											"\n\n"

											"Spazio libero: " freediskspace "!\n"

											"Spazie richiesto " size-komplett "!\n\n"

											"Selezionare un altro volume !"))

				)

			;else

			(set ok 1)

			)

		)

	)

)



(makeassign "STORMC")



(user act-user-level)



(set @default-dest folder)	; This Assign is very important!



(set destbin	(tackon folder "StormSYS"))

(if                                      	; Create Directory for Compiler

	(= (exists destbin) 0)

	(makedir destbin (infos))

)



(set destdemo	(tackon folder "Examples"))

(if                                      	; Create Directory for Demos

	(= (exists destdemo) 0)

	(makedir destdemo (infos))

)

(set destinclude (tackon folder "Include"))

(if                                      	; Create Directory for Includes

	(= (exists destinclude) 0)

	(makedir destinclude)

)



(set destlib	(tackon folder "Lib"))

(if                                      	; Create Directory for Libraries

	(= (exists destlib) 0)

	(makedir destlib)

)



(set destmanual	(tackon folder "Manual"))

(if                                      	; Create Directory for Documentation

	(= (exists destmanual) 0)

	(makedir destmanual (infos))

)

(set desttools	(tackon folder "Tools"))

(if                                      	; Create Directory for Tools

	(= (exists desttools) 0)

	(makedir desttools (infos))

)

(set fansilib	(tackon folder "Fast-ANSI-Lib"))

(if                                      	;Fastansilib-Verzeichnis erzeugen
	(= (exists fansilib) 0)
	(makedir fansilib (infos))
)

(set muilib	(tackon folder "MUI-Class-Lib"))

(if                                      	;Muilib-Verzeichnis erzeugen
	(= (exists muilib) 0)
	(makedir muilib (infos))
)

(complete 5)



; Copy Readme to Harddisk!



(copyfiles

	(source source-Liesmich)

	(dest folder)

	(infos)

)



(complete 8)



(set morerunpath "run C/More Leggimi")



(run morerunpath)	; load Leggimi



(complete 10)



(set destinfo	(tackon folder "StormCPP.info"))

(if                                      	; Generate Project-Icon
	(= (exists destinfo) 0)
	(
	(copyfiles
		(source source-ikon)
		(dest folder)
	))
)



(complete 15)


(copyfiles											; copy Examples

	(prompt #prp-copy-samples)

	(help #hlp-copy-samples)

	(source #samplesource)

	(dest destdemo)

	(all)

	(confirm)

)



(complete 20)



(copyfiles											; copy Settings

	(prompt #prp-copy-env)

	(help #hlp-copy-env)

	(source #envsource)

	(dest "ENVARC:")

	(all)

	(confirm)

)



(complete 22)



(copyfiles											; copy Settings

	(prompt #prp-copy-env)

	(help #hlp-copy-env)

	(source #envsource)

	(dest "ENV:")

	(all)

	(confirm)

)



(complete 25)



(copyfiles											; copy compiler

	(prompt #prp-copy-bin)

	(help #hlp-copy-bin)

	(source #binsource)

	(dest destbin)

	(all)

	(confirm)

)



(complete 40)



(copyfiles											; copy includes

	(prompt #prp-copy-includes)

	(help #hlp-copy-includes)

	(source #includesource)

	(dest destinclude)

	(all)

	(confirm)

)



(complete 60)



(copyfiles											; copy libs

	(prompt #prp-copy-libs)

	(help #hlp-copy-libs)

	(source #libsource)

	(dest destlib)

	(all)

	(confirm)

)



(complete 80)



(copyfiles											; copy manual

	(prompt #prp-copy-manual)

	(help #hlp-copy-manual)

	(source #manualsource)

	(dest destmanual)

	(all)

	(confirm)

)

(complete 90)



(copyfiles											; copy tools

	(prompt #prp-copy-tools)

	(help #hlp-copy-tools)

	(source #toolssource)

	(dest desttools)

	(all)

	(confirm)

)

(complete 91)


(copyfiles											; Fastlib kopieren
	(prompt #prp-copy-fastlib)
	(help #hlp-copy-fastlib)
	(source #flibsource)
	(dest fansilib)
	(all)
	(confirm)
)

(complete 92)

(copyfiles											; Muilib kopieren
	(prompt #prp-copy-muilib)
	(help #hlp-copy-muilib)
	(source #muilibsource)
	(dest muilib)
	(all)
	(confirm)
)

(complete 93)

(copylib											; Copy Wizard.Library
	(prompt #prp-copy-lib)
	(help #hlp-copy-lib)
	(source #wizlibsource)
	(dest "LIBS:")
	(confirm)
)


(complete 95)



; ------- CHANGE STARTUP



(set command1 (cat  "ASSIGN STORMC: " folder ""))



(set command1.txt

	(cat

	 	"\n\n\nSono necessarie alcune aggiunte alla User-Startup per permettere un "

      "corretto funzionamento di StormC.\n\n"

	 	command1

	)

)



(startup "StormC"

	(prompt command1.txt)

	(help #help-startup)

	(command command1)

)



(makeassign "STORMC")

(makeassign "STORMC" folder)

(delete "RAM:LHex")

(complete 100)



; ------- FINISHED



(message (cat

	"\nInstallazione di StormC completata.\n"

   "Se le linee:\n" command1 "\nnon sono inserite nella Startup-Sequence o "

   "User-Startup, il comando deve essere inserito a mano!\n\n"

   "\n\nBuon divertimento con StormC! ... ")

)

