; vbcc WarpOS/PowerUp binaries installer
; written by Frank Wille <frank@phoenix.owl.de>

(if (< (/ @installer-version 65536) 43)
  (abort "You are running an old version of Installer.\n\n"
         "Please update to at least version 43, available on Aminet.")
)

(welcome)

(if (exists "vbcc:" (noreq))
  (
    (set #curvers (getversion "vbcc:vbcc_version"))
    (set #ourvers (getversion "vbcc_version"))

    (if (= #curvers #ourvers)
      (
        (set @default-dest "vbcc:")

        (copyfiles
          (prompt "Copying PPC-native vbcc binaries.")
          (help @copyfiles-help)
          (source "bin")
          (dest (tackon @default-dest "bin"))
          (optional "force")
          (all)
        )

        (copyfiles
          (prompt "Copying additional config files unsing PPC binaries.")
          (help @copyfiles-help)
          (source "config")
          (dest (tackon @default-dest "config"))
          (optional "force")
          (all)
        )
      )
      (exit "Version of PPC binaries doesn't match installed vbcc version." (quiet))
    )
  )

  (exit "Please install a vbcc binary base archive first!" (quiet))
)
