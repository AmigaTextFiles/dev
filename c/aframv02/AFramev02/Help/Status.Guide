@database 079ea1e8-1
@master AFrame:Help/Status.Guide
@$VER: 1.0
@author "Deryk B Robosson"
@(c) "1995, 1996 Synthetic Input"
@index Main
@remark Created with Heddley v1.1 (c) Edd Dumbill 1994

@node "Main" "AFStatus"

                      ***********************************

                        Status C++ Object

                        AFrame Version 1.0
                        Status Object Version 1.0

                        (c) 1995,1996 Jeffry A Worth
                                       Deryk B Robosson

                      ***********************************

TABLE OF CONTENTS

  @{"Status Object Information" link "INFORMATION" 0}

  Methods:
    @{"AFStatus" link "AFSTATUS" 0}
    @{"~AFStatus" link "NOTAFSTATUS" 0}

    @{"Create" link "CREATE" 0}
    @{"SetStatus" link "SETSTATUS" 0}
    @{"BuildImages" link "BUILDIMAGES" 0}

    @{"Misc Members" link "MISCMEMBERS" 0}

    @{"Includes" link "INCLUDES" 0}
    @{"Source" link "SOURCE" 0}
    @{"History" link "HISTORY" 0}
    @{"Distribution" link "DISTRIBUTION" 0}
@endnode

@node "INFORMATION" "Status Object Information"
AFStatus/Object Information

  The Status Object was written to provide a C++ Object Class interface for end user information of the status of
current task at hand.
@endnode

@node "AFSTATUS" "AFStatus"
AFStatus/AFStatus

  NAME AFStatus()

  DESCRIPTION
    Default class constructor.  Modify this only if you wish each class to have
    the modifications

  INPUTS
    none

  RESULT
    none

  BUGS
    none known

  SEE ALSO
    @{"~AFStatus" link "NOTAFSTATUS" 0}
@endnode

@node "NOTAFSTATUS" "~AFStatus"
AFStatus/~AFStatus

  NAME ~AFStatus()

  DESCRIPTION
    Default class destructor.  Modify this only if you wish each class to have
    the modifications

  INPUTS
    none

  RESULT
    none

  BUGS
    none known

  SEE ALSO
    @{"AFStatus" link "AFSTATUS" 0}
@endnode

@node "CREATE" "Create"
AFStatus/Create

  NAME Create()

    void = Create(AFWindow* pwindow, AFRect *rect, ULONG id,
                    UBYTE penDone, UBYTE PenToGo)

  DESCRIPTION
    Create the 3DStatus bar with size and coordinates specified in rect.
    Initialize percent done and percent to go with penDone and PenToGO


  INPUTS
    pwindow - pointer to window to receive the status bar
    rect    - AFRect struct which shows size and position of status bar
    id      - gadget id
    penDone - percentage of done status
    PenToGo - percentage of to go status

  NOTE
    penDone and PenToGo percentages should (in all reality) equal 100% ;)

  RESULT
    none

  BUGS
    none known

  SEE ALSO
    AFWindow
    AFRect
@endnode

@node "SETSTATUS" "SetStatus"
AFStatus/SetStatus

  NAME SetStatus(int)

    void = SetStatus(int percent)

  DESCRIPTION
    Sets the new status of the status bar

  INPUTS
    percent - percentage to set

  RESULT
    none

  BUGS
    none known

  SEE ALSO
@endnode

@node "BUILDIMAGES" "BuildImages"
AFStatus/BuildImages

  NAME BuildImages()

    void = BuildImages()

  DESCRIPTION
    This function creates the done and to go images for the status bar.  Under
    normal usage this function is only used internally

  INPUTS
    none

  RESULT
    none

  BUGS
    none known

  SEE ALSO
@endnode

@node "MISCMEMBERS" "Misc Members"
AF3DStatus/Misc Members

    @{"m_IntuiText" link "M_INTUITEXT" 0}
    @{"m_Done" link "M_DONE" 0}, @{"m_ToGo" link "M_TOGO" 0}
    @{"m_text" link "M_TEXT" 0}
    @{"m_percent" link "M_PERCENT" 0}
    @{"m_penDone" link "M_PENDONE" 0}, @{"m_penToGo" link "M_PENTOGO" 0}
@endnode

@node "INCLUDES" "Includes"
  //////////////////////////////////////////////////////////////////////////////
  // status.hpp
  //
  // Jeffry A Worth
  // November 10, 1995
  //////////////////////////////////////////////////////////////////////////////

  #ifndef __STATUS_HPP__
  #define __STATUS_HPP__

  //////////////////////////////////////////////////////////////////////////////
  // Includes
  #include <string.h>
  #include "aframe:include/gadget.hpp"

  //////////////////////////////////////////////////////////////////////////////
  // Status Bar Class

  class AFStatus : public AFGadget
  {
  public:
    AFStatus();
    ~AFStatus();

    virtual void DestroyObject();
    virtual char *ObjectType() { return "Status"; };

    virtual void Create(AFWindow* pwindow, AFRect *rect, ULONG id, UBYTE penDone, UBYTE penToGo);
    virtual void SetStatus(int percent);
    virtual void BuildImages();

    struct IntuiText m_IntuiText;
    struct Image m_Done,m_ToGo;
    char *m_text;
    int m_percent;
    UBYTE m_penDone,m_penToGo;
  };

  //////////////////////////////////////////////////////////////////////////////
  #endif // __STATUS_HPP__
@endnode

@node "SOURCE" "Source"
  //////////////////////////////////////////////////////////////////////////////
  // status.cpp
  //
  // Jeffry A Worth
  // November 10, 1995
  //////////////////////////////////////////////////////////////////////////////

  //////////////////////////////////////////////////////////////////////////////
  // INCLUDES
  #include "aframe:include/status.hpp"
  #include "aframe:include/rastport.hpp"

  //////////////////////////////////////////////////////////////////////////////
  //

  AFStatus::AFStatus()
  {
    m_text=NULL;
    m_percent=0;
  }

  AFStatus::~AFStatus()
  {
    DestroyObject();
  }

  void AFStatus::DestroyObject()
  {
    AFGadget::DestroyObject();
    if(m_text) {
      delete m_text;
      m_text=NULL;
    }
  }

  void AFStatus::Create(AFWindow* pwindow, AFRect *rect, ULONG id, UBYTE penDone, UBYTE penToGo)
  {
    AFRastPort rp(pwindow);
    char string[10];

    // Create the gadget
    AFGadget::Create(pwindow,rect,id);

    // Create string for the text
    sprintf(string,"%d%%",m_percent);
    m_text = new char[strlen(string)+1];
    strcpy(m_text,string);

    // Set Pens
    m_penDone = penDone;
    m_penToGo = penToGo;

    // Build Images
    m_Done.NextImage=&m_ToGo;
    m_ToGo.NextImage=NULL;
    BuildImages(); 

    // Fill IntuiText Structure
    m_IntuiText.FrontPen = 1;
    m_IntuiText.DrawMode = JAM1;
    m_IntuiText.LeftEdge = 5;
    m_IntuiText.TopEdge = 5;
    m_IntuiText.ITextFont = NULL;
    m_IntuiText.LeftEdge = (m_pgadget->Width-rp.TextLength(m_text,strlen(m_text)))/2;
    m_IntuiText.IText = (UBYTE*)m_text;
    m_IntuiText.NextText = NULL;

    // Attach IntuiText Struct and Border Struct to gadget Struct
    m_pgadget->GadgetText = &m_IntuiText;
    m_pgadget->GadgetRender = &m_Done;
    m_pgadget->Flags = GFLG_GADGIMAGE|GFLG_GADGHNONE;
  }

  void AFStatus::BuildImages()
  {
    // Fill Done Image Struct
    m_Done.LeftEdge = m_Done.TopEdge = 0;
    m_Done.Width=m_percent*m_pgadget->Width/100;
    m_Done.Height=m_pgadget->Height;
    m_Done.Depth=4;
    m_Done.ImageData=NULL;
    m_Done.PlanePick=NULL;
    m_Done.PlaneOnOff=m_penDone;

    // Fill ToGo Image Struct
    m_ToGo.TopEdge = 0;
    m_ToGo.LeftEdge=m_percent*m_pgadget->Width/100;
    m_ToGo.Width=m_pgadget->Width-m_ToGo.LeftEdge;
    m_ToGo.Height=m_pgadget->Height;
    m_ToGo.Depth=4;
    m_ToGo.ImageData=NULL;
    m_ToGo.PlanePick=NULL;
    m_ToGo.PlaneOnOff=m_penToGo;
  }

  void AFStatus::SetStatus(int percent)
  {
    AFRastPort rp(m_pwindow);
    char string[10];
  
    // Rebuild Images
    m_percent=percent;
    BuildImages();

    // Build Text String
    m_IntuiText.IText = NULL;
    if(m_text) delete m_text;
    sprintf(string,"%d%%",m_percent);
    m_text = new char[strlen(string)+1];
    strcpy(m_text,string);
    m_IntuiText.LeftEdge = (m_pgadget->Width-rp.TextLength(m_text,strlen(m_text)))/2;
    m_IntuiText.IText = (UBYTE*)m_text;

    // Update the gadget
    RefreshGList(m_pgadget,m_pwindow->m_pWindow,NULL,1);
  }
@endnode

@node "HISTORY" "History"
                    ***HISTORY***

 ***********************************************************
  Status Object v1.0

  Created November 10, 1995
  Release November 11, 1995

   - Created all function class objects.
 ***********************************************************
@endnode

@node "DISTRIBUTION" "Distribution"
Distribution

  The programs and files in this distribution are freely distributable, but are also Copyright (c) Jeff Worth and
Deryk Robosson. They may be freely distributed as long as no more than a nominal fee is charged to cover time and
copying costs. AFrame is distributed as non-crippled shareware, it is fully functional.

Commercial Distribution

Commercial usage is allowed if the following conditions are met:

    a) You state in your documentation that your program uses aframe.library
       and that AFrame is Copyright (c) Jeff Worth and Deryk Robosson.

    b) You send us a copy of your finished product(s) using aframe.library.

  If these conditions are met you are allowed to include the Kickstart 2.0 or higher version of aframe.library and
the installation script(s) with your commercial product.



Freely Distibutable Products

  All of the files copyrighted by the authors must remain unmodified.  None of these files may be distributed on its
own, the entire package must be distributed as one whole.  'demo.cpp' is full public domain and can be used in any
way you like.

  There is one exception to the above.  If you plan to release a freely distributable program (either public domain,
freeware or shareware), you may include 'libs/aframe.library', the installation scripts (with icon), the
documentation (with icons) with your distribution.

If you include AFrame with a crippled shareware program I'd like to ask you to send us a full working version.

  Whether your program is freely distributable or commercial, you must state in your documentation that your program
uses aframe.library and that AFrame is Copyright (c) Jeff Worth and Deryk Robosson
@endnode

@node "NOTAFSTATUS" "~AFStatus"
AFStatus/~AFStatus

  NAME ~AFStatus()

  DESCRIPTION
    Default class destructor.  Modify this only if you wish each class to have
    the modifications

  INPUTS
    none

  RESULT
    none

  BUGS
    none known

  SEE ALSO
    @{"AFStatus" link "AFSTATUS" 0}
@endnode

@node "M_INTUITEXT" "m_IntuiText"
AFStatus/m_IntuiText

  MEMBER TYPE
   struct IntuiText

  DESCRIPTION
   An IntuiText structure used if text is to be place in the panel

  SEE ALSO
   <intuition/intuition.h>
@endnode

@node "M_DONE" "m_Done"
AFStatus/m_Done

  MEMBER TYPE
   struct Image

  DESCRIPTION
   An Image structure used for the percent done image of the status bar

  SEE ALSO
   <intuition/intuition.h>
@endnode

@node "M_TOGO" "m_ToGo"
AFStatus/m_ToGo

  MEMBER TYPE
   struct Image

  DESCRIPTION
   An Image structure used for the percent to go image of the status bar

  SEE ALSO
   <intuition/intuition.h>
@endnode

@node "M_TEXT" "m_text"
AFStatus/m_text

  MEMBER TYPE
   char *

  DESCRIPTION
   A text pointer unique to each class

  SEE ALSO
   <intuition/intuition.h>
@endnode

@node "M_PERCENT" "m_percent"
AFStatus/m_percent

  MEMBER TYPE
   int

  DESCRIPTION
   A storage container to keep track of the percentage

  SEE ALSO
   <intuition/intuition.h>
@endnode

@node "M_PENDONE" "m_penDone"
AFStatus/m_penDone

  MEMBER TYPE
    UBYTE

  DESCRIPTION
    Used to setting the color of the done portion of the status bar

  SEE ALSO
@endnode

@node "M_PENTOGO" "m_penToGo"
AFStatus/m_penToGo

  MEMBER TYPE
    UBYTE

  DESCRIPTION
    Used to setting the color of the to go portion of the status bar

  SEE ALSO
@endnode

