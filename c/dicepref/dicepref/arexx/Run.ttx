/*
 * ARexx-Script zur Steuerung des DICE aus TTX
 */

OPTIONS RESULTS

SetStatusBar "Working..."

/*
 * Filenamen des aktuelles Windows
 */

GetFilePath
fullname = RESULT

/*
 * Erzeugen einer temporären Script-Datei
 */

laenge = Index(fullname,".c")
IF laenge = 0 THEN DO
  SetStatusBar "Kein C-Source! Breche ab..."
  EXIT
END; ELSE DO
  ADDRESS COMMAND
  CONFENSTER = '"CON:0/400/704/112/ARexx »» DICE C-Compiler/CLOSE/SCREENTURBOTEXT"'

  name = LEFT(fullname,laenge-1)

  CALL OPEN OUT,"t:AREXXTEMP",WRITE
  CALL WRITELN OUT, 'cd DCC:SRC'
  CALL WRITELN OUT, 'stack 20000'
  CALL WRITELN OUT, 'path DCC:BIN add'
  CALL WRITELN OUT, 'make ' || name
  CALL WRITELN OUT, 'list ' || name
  CALL WRITELN OUT, 'runback ' || name
  CALL CLOSE OUT

/*
 * Aufruf einer Shell mit der Script-Datei
 */

  'NEWSHELL' CONFENSTER "T:AREXXTEMP"
END;
EXIT
