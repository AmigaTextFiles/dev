<html>
<head>
  <title>ftell command</title>
  <meta name="Generator" content="GuideML V1.6">
  <meta http-equiv="Content-Type" content="text/html">
</head>
<body>
<a href="main.html">CONTENTS</a> | <a href="dice_index/main.html">INDEX</a> | <a href="fsetpos.html">PREV</a> | <a href="fwrite.html">NEXT</a>
<hr>
<pre>

 ftell

 NAME
  ftell - return current position within file pointer

 SYNOPSIS
  #include &#060;stdio.h&#062;

  long pos = ftell(fp);
  FILE *fp;

 FUNCTION
  ftell() returns the current absolute seek offset within a file
  pointer.

 EXAMPLE
  /*
   *  get a line, save current position, get rest of file, go back
   *  to saved position, retrieve line again and print again.
   *
   *  like fsetpos() example but uses ftell()/fseek() instead
   */

  #include &#060;stdio.h&#062;

  main(ac, av)
  int ac;
  char **av;
  {
      FILE *fp;
      long save_pos;
      int count;
      char buf[256];

      if (ac == 1) {
      puts(&quot;Expected textfile argument&quot;);
      exit(1);
      }
      fp = fopen(av[1], &quot;r&quot;);
      if (fp == NULL) {
      printf(&quot;Unable to open %sn&quot;, av[1]);
      exit(1);
      }
      for (count = 0; fgets(buf, sizeof(buf), fp); ++count) {
      if (count == 0)             /*  just before second line */
          save_pos = ftell(fp);
      fprintf(stdout, &quot;%-3d: %s&quot;, count + 1, buf);
      }
      if (count &#060; 2) {
      puts(&quot;not enough lines in file for example!&quot;);
      exit(1);
      }
      puts(&quot;--end of file, now seeking back to line 2--&quot;);
      fseek(fp, save_pos, SEEK_SET);
      if (fgets(buf, sizeof(buf), fp) == NULL) {
      puts(&quot;error!&quot;);
      exit(1);
      }
      fprintf(stdout, &quot;%-3d: %s&quot;, 2, buf);
      fclose(fp);
      return(0);
  }

 INPUTS
  FILE *fp;       file pointer retrieve seek position from


 RESULTS
  long pos;       current absolute seek position in file

 SEE ALSO
  ftell, fgetpos, fsetpos, fseek, rewind


</pre>
</body>
</html>
