@database "UCDoor_V1.0.guide"
@width 80
##
## $VER: UCDoor_V1.0.guide (14-02-97)
## (C) 1997 Blue Heaven Software - All rights reserved.
##
## Contents
##
@node main "Ultra Cee Door Guide: Contents"

         *****************************************************************
         **                  @{B}Ultra Cee Door User Manual@{UB}                 **
         *****************************************************************
 

                   Please select any of the topics listed below.



                           @{"        Disclaimer          " link disclaimer }
                           @{" Copyright and Distribution " link copyright }

                    
                           @{"       Introduction         " link introduction }
                           @{"       Installation         " link installation } 
                           @{"    Usage Ultra Cee Door    " link usage }
                           @{"     Function Reference     " link reference } 


                           @{"    Known problems & bugs   " link bugs } 
                           @{"          History           " link history }
                           @{"     Famous Last Words!     " link last }
                            
                            
@endnode

##
## Disclaimer
##
@node disclaimer "Ultra Cee Door Guide: Disclaimer"


 @{B}DISCLAIMER@{UB}
 @{B}==========@{UB}
 
 The author cannot be held liable for the suitability or  accuracy  of this
 manual  and/or  the  program(s)  it  describes.  Any  damage  directly  or
 indirectly caused by the use or misuse of this manual  and/or the  program
 it describes is the sole responsibility of the user her/him self.

 However, to aid in developing this program the user is asked in a gentle
 way to report any strange behaviour of the program.
 
@endnode

##
## Copyright and Distribution
##
@node copyright "Ultra Cee Door Guide: Copyright and Distribution"


  @{B}COPYRIGHT & DISTRIBUTION@{UB}
  @{B}========================@{UB}
  
  
                          @{B}Ultra Cee Door V1.0

                (C) Copyright 1997 Blue Heaven Software
              Written using SAS/C V6.57 (C) Sas Institute@{UB}

                       @{I}Author > Chris De Maeyer
                        
                         Norbertijnenstraat 4
                         B-2040     ANTWERPEN
                               BELGIUM
 
                       Email: cdemaeyer@mmm.com@{UI}


  This program is  @{B}FREEWARE@{UB} which  means that  you may freely use the library
  in non-commercial FREEWARE programs. Other use is prohibited without written
  permission from me.
  Shareware/Giftware authors must reward me with a registered/free copy of the
  program they developed [as a fee]. 
   
  This program  may be  freely distributed as long as all files are included
  in the distribution without any modifications.  
  This program may *not* be uploaded on SITES/BBS's that  claim copyrights on
  the uploaded material.
  Commercial distribution of the program and/or it's relative files is *NOT*
  allowed without written permission from the author. 
  You are welcome to add a translation to this manual in the archive but this
  gives you no other rights as the ones described above.

@endnode

##
## Introduction
##
@node introduction "Ultra Cee Door Guide: Introduction"


 @{B}INTRODUCTION@{UB}
 @{B}============@{UB}
 
 @{I}Ultra Cee Door@{UI} is a neat linkable library to be used for @{B}MAX's BBS@{UB} door
 development using C.
 
 Features:      - main door entry with NODE argument
                - general door functions 
                - extended door functions for various MAX's data
                  structures.
 
 Anyway, enjoy it & happy coding.
    
@endnode

##
## Installation
##
@node installation "Ultra Cee Door Guide: Installation"


  @{B}INSTALLATION@{UB}
  @{B}============@{UB}
  
  Copy the @{I}UCDoor.lib@{UI} & @{I}UCDoorR.lib@{UI} to your C @{B}lib:@{UB} directory.
  
  Copy the @{I}UCDoor.h@{UI} header to a directory of your choice.
  
@endnode

##
## Usage
##
@node usage "Ultra Cee Door Guide: Usage Ultra Cee Door"

   @{B}USAGE ULTRA CEE DOOR@{UB}
   @{B}====================@{UB}

   As you suspect the @{I}UCDoor.lib@{UI} is for use with Code option @{B}Parms=STACK@{UB},
   @{I}UCDoorR.lib@{UI} is Code option @{B}Parms=REGISTER@{UB}. Whichever you prefer.
   
   Just add it : fe. sc myprogram.c lib:ucdoor.lib
   
   Set up your program as follows:
   
        @{I}#include "UCDoor.h"
   
        struct Task          *thisTask;
        MDDOOR               *ucd_msg;
        struct MsgPort       *DoorControl;
        struct MsgPort       *DoorReply;
        BOOL                 is_carrierLost;
        int                  udc_result;     
                                  
        void cd_Door(int node)
        {
                /* your door code */
                
                /* check regurarly */
                if(cd_CarrierLost())
                    cd_End();
                    
        }
   
        void main(int argc,char *argv[])
        {
                cd_Main(argv[1]);
                if(udc_result != OK)
                {
                    /* whatever action is needed */
                    /* ERROR_MESSAGE      -> Couldn't allocate message
                       ERROR_CONTROLPORT  -> Couldn't find MAX's port
                       ERROR_REPLYPORT    -> Couldn't create door port
                       ERROR_CARRIERLOST  -> Transm. ended
                    */   
                }    
        }
        @{UI}                                   

    That's it !
                                                                       
@endnode

##
## Reference
##
@node reference "Ultra Cee Door Guide: Function Reference"

   @{B}FUNCTION REFERENCE@{UB}
   @{B}==================@{UB}

   @{I}Door functions@{UI}
   
   @{"  cd_Main          " link cdmain }
   @{"  cd_End           " link cdend }
   @{"  cd_WaitMsg       " link cdwaitmsg }
   @{"  cd_Door          " link cddoor }
   @{"  cd_CarrierLost   " link cdcarrierlost }
   @{"  cd_Cls           " link cdcls }
   @{"  cd_SetFG         " link cdsetfg }
   @{"  cd_SetBG         " link cdsetbg }
   @{"  cd_SetColors     " link cdsetcolors }
   @{"  cd_PutStr        " link cdputstr }
   @{"  cd_GetStr        " link cdgetstr }
   @{"  cd_GetChar       " link cdgetchar }
   @{"  cd_GetStrPrompt  " link cdgetstrprompt }
   @{"  cd_TwitCurrent   " link cdtwitcurrent }
   @{"  cd_PrintFile     " link cdprintfile }
   @{"  cd_FileHere      " link cdfilehere }
   @{"  cd_DoFunction    " link cddofunction }
   @{"  cd_GetNumInfo    " link cdgetnuminfo }
   @{"  cd_GetStrInfo    " link cdgetstrinfo }

   @{I}Data functions@{UI}
    
   @{"  cd_GetUserIndex  " link cdgetuserindex }
   @{"  cd_GetUserData   " link cdgetuserdata }
   @{"  cd_PutUserData   " link cdputuserdata }
   @{"  cd_ChangeAccess  " link cdchangeaccess }
                   
@endnode

##
## Bugs
##
@node bugs "Ultra Cee Door Guide: Known problems & bugs"


  @{B}KNOWN PROBLEMS & BUGS@{UB}
  @{B}=====================@{UB}
  
  - None reported.

  
@endnode

##
## History
##
@node history "Ultra Cee Door Guide: History"

   @{B}V1.0 (01-03-97)@{UB}
   @{B}===============@{UB}
   
   - Created Guide/HTML
   - Cleaned up all code + comments added + demo door
   - Changed all function names to a standard cd_xxxxxxxx format
   - Added cd_GetUserIndex(), cd_GetUserData(), cd_PutUserData(),
     cd_ChangeAccess()
   - Added ucd_result return code for cd_Door() as global variable


   @{B}V0.9 (14-02-97)@{UB}
   @{B}===============@{UB}
   
   - Internal release
      
@endnode

##
## Famous Last Words
##
@node last "Ultra Cee Door Guide: Famous Last Words"


  @{B}FAMOUS LAST WORDS@{UB}
  @{B}=================@{UB}
  
  @{B}Future@{UB}
  @{B}------@{UB}
  
  Expect following enhancements...

        - more functions for user data
        - more support functions for ANSI 
        - functions for sections/messages
        - your wildest dreams...

        
  @{B}Bugs/Questions/Propositions/Donations/Gifts@{UB}
  @{B}-------------------------------------------@{UB}
  
  email: @{I}cdemaeyer@mmm.com@{UI}
  snail: @{"address" link copyright }
           
  
  @{B}Availability@{UB}
  @{B}------------@{UB}
  
  New versions will be available in PUBLIC DOMAIN as they appear.
  
  
  @{B}Greetings & thank you's@{UB}
  @{B}-----------------------@{UB}
  
  Greetz   :   - all the guys & dolls at "3M Belgium" [Diegem]
               - my general Amiga product store "Click!" [Wilrijk]
               - all users whom lost their marbles on an "Amiga"
  
@endnode

@node cdmain "cd_Main()"
   
   @{B}void cd_Main"(UBYTE *argstr);@{UB}
   
   ---
   
   Purpose: this is the main entry point for the door, 'argstr' contains
            the node.
            
   Results: OK                  - door ended normally
            ERROR_MESSAGE       - error allocating message structure
            ERROR_CONTROLPORT   - error acquiring MAX's port
            ERROR_REPLYPORT     - error creating doors reply port
            ERROR_ABORTED       - door ended due to cd_End()
            ERROR_CARRIER       - transmission ended

@endnode   
    
@node cdend "cd_End()"

   @{B}void cd_End(int errcod);@{UB}
   
   ---
      
   Purpose: exit the door immediately, use in case of error.
   
   Results: sets 'udc_result' to 'errcode' 
   
   Usage  :     if(cd_CarrierLost())
                {
                    cd_End(ERROR_CARRIER);
                }
                
                or
                
                if(xxxx==9)
                {
                    cd_End(ERROR_ABORTED);
                }        
   
@endnode

@node cdwaitmsg "cd_WaitMsg()" 
   
   @{B}void cd_WaitMsg(MDDOOR *cd_msg);@{UB}
   
   ---
   
   Purpose: support routine which sends door message and waits for reply.
   
   Result : none
   
   Usage  :     msg->mdd_command = 13;
                msg->mdd_data = 0;
                memset(msg->mdd_string,0,SLEN);                  
                memmove(msg->mdd_string,pstring,sizeof(pstring));
                
                cd_WaitMsg(msg);
                
@endnode

@node cddoor "cd_Door()"
   
   @{B}extern int cd_Door(void);@{UB}
   
   ---
   
   Purpose: function for your code.
   
   Results: return code for 'udc_result'
   
   Usage  : called by cd_Main()
   
@endnode
   
@node cdcarrier "cd_CarrierLost()"
   
   @{B}BOOL cd_CarrierLost(void);@{UB}
   
   ---
   
   Purpose: test status of 'is_CarrierLost' variable.
   
   Results: TRUE = transmission ended, or FALSE
   
   Usage  : should be used after door commands
   
            cd_GetStr(buffer,10);
            
            if(cd_CarrierLost())
            {
                /* action */
                cd_End(ERROR_CARRIER);
            }
   
@endnode

@node cdcls "cd_Cls()"
   
   @{B}void cd_Cls(void);@{UB}
   
   ---
   
   Purpose: sends clear screen
   
   Results: none
   
   Usage  : cd_Cls();
   
@endnode

@node cdsetfg "cd_SetFG()"
   
   @{B}void cd_SetFG(int color);@{UB}
   
   ---
   
   Purpose: set ANSI foreground color.
   
   Results: none
   
   Usage  : cd_SetFG(RED);
   
@endnode

@node cdsetbg "cd_SetBG()"
   
   @{B}void cd_SetBG(int color);@{UB}
   
   ---
   
   Purpose: set ANSI background color.
   
   Results: none
   
   Usage  : cd_SetBG(BLUE);
   
@endnode

@node cdsetcolors "cd_SetColors()"
   
   @{B}void cd_SetColors(int fg,int bg);@{UB}
   
   ---
   
   Purpose: set ANSI foreground/background color.
   
   Results: none
   
   Usage  : cd_SetColors(YELLOW,BLACK);
   
@endnode

@node cdputstr "cd_PutStr()"
   
   @{B}void cd_PutStr(UBYTE *string,BOOL nl);@{UB}
   
   ---
   
   Purpose: display a string, followed by newline if necessary.
   
   Results: none
   
   Usage  : cd_PutStr("Hello",TRUE);
   
@endnode
   
@node cdgetstr "cd_GetStr()"
   
   @{B}void cd_GetStr(UBYTE *buffer,int maxchar);@{UB}
   
   ---
   
   Purpose: gets input from user, length limited to 'maxchar'.
   
   Results: 'buffer' contains user entry
   
   Usage  : cd_GetStr(name,40);
   
@endnode
   
@node cdgetchar "cd_GetChar()"
   
   @{B}UBYTE cd_GetChar(void);@{UB}
   
   ---
   
   Purpose: gets single character from user.
   
   Results: character
   
   Usage  : x = cd_GetChar();
 
@endnode

@node cdgetstrprompt "cd_GetStrPrompt()"
   
   @{B}void cd_GetStrPrompt(UBYTE *string,UBYTE *buffer,int maxchar);@{UB}
   
   ---
   
   Purpose: gets user input, with a prompt, length limited.
   
   Results: 'buffer' contains user entry
   
   Usage  : cd_GetStrPrompt("Enter you name:",res,40);
   
@endnode
 
@node cdgetcharprompt "cd_GetCharPrompt()"
   
   @{B}UBYTE cd_GetStrPrompt(UBYTE *string);@{UB}
   
   ---
   
   Purpose: gets single character, with a prompt.
   
   Results: character
   
   Usage  : cd_GetCharPrompt("Enter choice:");
   
@endnode
 
@node cdtwitcurrent "cd_TwitCurrent()"
   
   @{B}void cd_TwitCurrent(void);@{UB}
   
   ---
   
   Purpose: logs off user.
   
   Results: none
   
   Usage  : cd_TwitCurrent();
   
@endnode
 
@node cdprintfile "cd_PrintFile()"
   
   @{B}void cd_PrintFile(UBYTE *filenm);@{UB}
   
   ---
   
   Purpose: displays text file.
   
   Results: none
   
   Usage  : cd_PrintFile("Help.text");
   
@endnode
 
@node cdfilehere "cd_FileHere()"
   
   @{B}BOOL cd_FileHere(UBYTE *filenm);@{UB}
   
   ---
   
   Purpose: checks availablitity of file to BBS.
   
   Results: TRUE = file accessible, FALSE = not
   
   Usage  : if(!cd_FileHere("Help.text"))
            {
                cd_PutStr("Requested file is not here...",TRUE);
            }
                
@endnode
 
@node cddofunction "cd_DoFunction()"
   
   @{B}void cd_DoFunction(int func,int extra,UBYTE *string);@{UB}
   
   ---
   
   Purpose: performs a function (as in MAX's menu config).
   
   Results: none
   
   Usage  : cd_DoFunction(8,0,NULL);
   
@endnode
 
@node cdgetnuminfo "cd_GetNumInfo()"
   
   @{B}int cd_GetNumInfo(int func);@{UB}
   
   ---
   
   Purpose: gets numeric information.
   
   Results: number (as defined in UCDoor.h)
   
   Usage  : access = cd_GetNumInfo(UDC_ACCESS);
   
@endnode
 
@node cdgetstrinfo "cd_GetStrInfo()"
   
   @{B}void cd_GetStrInfo(int func,UBYTE *buffer);@{UB}
   
   ---
   
   Purpose: gets string information.
   
   Results: 'buffer' contains info (as defined in UCDoor.h)
   
   Usage  : cd_GetStrInfo(UDC_SUBURB,string);
   
@endnode
 
@node cdgetuserindex "cd_GetUserIndex()"
   
   @{B}int cd_GetUserIndex(UBYTE *filenm,UBYTE *uname);@{UB}
   
   ---
   
   Purpose: gets index in index file of user with name 'uname'.
   
   Results: index 
      
   Usage  : index = cd_GetUserIndex("User.index","Betty");
               
@endnode

@node cdgetuserdata "cd_GetUserData()"
   
   @{B}int cd_GetUserData(UBYTE *filenm,int uindex,struct ud_Data *buffer);@{UB}
   
   ---
   
   Purpose: gets user data of user with index 'uindex'.
   
   Results: user data in 'buffer' if found + sets return code to:
            
                    OK           - all ok
                    EFILE_OPEN   - file open error
                    EFILE_SEEK   - file seek error
                    EFILE_READ   - file read error
                    
      
   Usage  : rc = cd_GetUserData("User.data",index,&userdata);
            if(rc != OK)
            {
                /* error */
            }
                
               
@endnode

@node cdputuserdata "cd_PutUserData()"
   
   @{B}int cd_PutUserData(UBYTE *filenm,int uindex,struct ud_Data *udata);@{UB}
   
   ---
   
   Purpose: puts userdata in user datafile.
   
   Results: updated 'User.data' file + sets return code to:
            
                    OK           - all ok
                    EFILE_OPEN   - file open error
                    EFILE_SEEK   - file seek error
                    EFILE_WRITE   - file read error
                    
      
   Usage  : rc = cd_PutUserData("User.data",index,&userdata);
            if(rc != OK)
            {
                /* error */
            }
                
               
@endnode

@node cdchangeaccess "cd_ChangeAccess()"
   
   @{B}BOOL cd_ChangeAccess(UBYTE *fidx,UBYTE *fdat,UBYTE *uname,int newaccess);@{UB}
   
   ---
   
   Purpose: sets new access for user 'uname', 'fidx' is index file, 'fdat' is
            user datafile [new access available at next login].
   
   Results: updated 'User.data' file + sets return code to:
            
                TRUE            - update done
                FALSE           - update failed                    
      
   Usage  : rc = cd_ChangeAccess("User.index","User.data,"Tony",80);
            if(!rc)
            {
                /* error */
            }
                
               
@endnode
