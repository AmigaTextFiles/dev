#
#	:ts=8
#

.c.o:
	$(CC) $(CFLAGS) $<

VERSION =	1.7

#CPU =		040
CPU =		any

C_UTILITY =	utillib
L_UTILITY =	define __CXM33=__UCXM33 define __CXD33=__UCXD33 \
		define __CXM22=__UCXM22 define __CXD22=__UCXD22

OPTIMIZE =	optimize optinline

CC =		sc
CFLAGS =	cpu=$(CPU) math=ffp opttime define fseek=unixfseek \
		debug=line nover params=r $(C_UTILITY) \
		define TOOL_VERSION="$(VERSION)" $(OPTIMIZE)
LN =		slink
LNFLAGS =	lib mkid.lib lib:scmffp.lib lib:sc.lib lib:amiga.lib \
		$(L_UTILITY) sc sd nd noicons

OBJ =		amiga.o basename.o bitcount.o bitops.o bitsvec.o  \
		document.o expand_args.o gets0.o getscan.o getsFF.o hash.o init.o memory.o \
		opensrc.o paths.o raw.o scan-asm.o scan-c.o stoi.o strsav.o tty.o uerror.o \
		wmatch.o

all:		mkid.lib lid mkid gid eid aid fid

mkid.lib:	$(OBJ)
		@-delete >nil: $@
		oml $@ r $(OBJ)

fid:		fid.o mkid.lib
		$(LN) lib:cres.o fid.o $(LNFLAGS) to $@

lid:		lid.o mkid.lib
		$(LN) lib:cres.o lid.o $(LNFLAGS) to $@

mkid:		mkid.o mkid.lib
		$(LN) lib:cres.o mkid.o $(LNFLAGS) to $@

gid:		lid
		copy lid $@

eid:		lid
		copy lid $@

aid:		lid
		copy lid $@

clean:
		-delete quiet \#?.o mkid.lib
