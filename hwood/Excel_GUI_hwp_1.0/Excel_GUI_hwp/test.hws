







@VERSION 9,0

@REQUIRE "excel_gui"


;OpenResourceMonitor()
;DebugOutput(TRUE)



@DISPLAY {Hidden = True}



excel_gui.Init_GUI()





excel_gui.Open_GUI(100)






	  Function p_EventFunc(msg)
	  
	  
	  
	   
	  
	  
	  
          Switch(msg.action)
			  
			  
			  
			  
					   
					   
					   

			  
		    	   Case "EXCEL_QUIT":
			  
	

               excel_gui.Close_GUI()

           

                 excel_gui.Exit_GUI()

                End
				   
				

				   Case "EXCEL_OPEN":
					   
					   
					   excel_gui.Set_Sheet_Name("Arbeit",0)
					   
					   
					   excel_gui.Set_Cell_Contents("Siegner",2,1,0)
					   
					   
					   
					 DebugPrint("Sheet: "..excel_gui.Get_Sheet_Name(0));
					   
					   
					   DebugPrint("First cell:"..excel_gui.Get_Cell_Contents(1,1,0)) 
					   
					   
					   excel_gui.Set_Column_Width(1,0,200)
					   
					    excel_gui.Max(1)
					   
					   excel_gui.Set_Busy(1)
					   excel_gui.Sleep(1)
					  
					   
					   

            Local path$ = FileRequest("Open project...",{Filters = "xlsx|xls|tcd|ods",Path = "Project"})
               If path$ = ""
         
                 Else

               Endif


			      excel_gui.Set_Busy(0)
			      excel_gui.Sleep(0)
			      excel_gui.Max(0)
			   


           		  Case "EXCEL_SAVE":

             Local path$ = FileRequest("Save project as...",{Filters = "xlsx",Path = "Project",Mode = #REQ_SAVEMODE})
             If path$ = ""
         
             Else


             Endif
				   
				
		 		 Case "EXCEL_APP_MSG":

            
			 Debugprint("APP Path:"..excel_gui.Get_APP_Path())
				   
					 excel_gui.Set_Properties(#Properties_Titel,"Carsten Siegner")





					 DebugPrint("Properties: Subject: "..excel_gui.Get_Properties(#Properties_Subject))





                       excel_gui.Set_Filename(excel_gui.Get_APP_Path())


                       excel_gui.Set_Cell_Color(1,1,0,$dddddddd,$ddddeeee,$aaaaaaaa)



			  
          EndSwitch
        EndFunction
        

xxx = {EXCEL_OPEN = p_EventFunc,EXCEL_QUIT = p_EventFunc,EXCEL_SAVE = p_EventFunc,EXCEL_APP_MSG = p_EventFunc}






InstallEventHandler(xxx,yyy)


	

; main loop!
Repeat
	WaitEvent
Forever






