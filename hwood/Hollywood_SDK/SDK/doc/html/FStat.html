<html>
<!-- generated from hollywood_sdk.meta by MetaDoc 1.13 (c) by Andreas Falkenhahn -->
<head>
<title>FStat</title>
<meta name="author" content="Andreas Falkenhahn">
<meta name="generator" content="MetaDoc 1.13">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<style type="text/css">
<!--
body {font-family: sans-serif;}
ul.toc {list-style: none; margin-left: 20px; padding-left: 0px;}
dt.autodoc {font-variant: small-caps; font-size: larger; margin-top: 10px; margin-bottom: 10px; padding-left: 0.2em; padding-top: 0.2em; padding-bottom: 0.2em;
	background-color: #bae1ff; border-width: 1px; border-color: #3baaff; border-style: solid;}
dt.codelist {margin-bottom: 0.2em;}
h2.heading {background-color: #bae1ff; font-family: Arial; padding-top: 0.4em; padding-bottom: 0.4em;}
code {background-color: #f2f2f2; padding: 2px 4px; font-weight: bold;}
pre {background-color: #f2f2f2; border: 1px solid #ddd; padding: 0.3em;}
		
-->
</style>
</head>
<body bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#0000FF" alink="#0000FF">
<dl>
<dt class="autodoc"><b>Name</b></dt><dd>
FStat -- obtain information about open file (V6.0)</dd>
<dt class="autodoc"><b>Synopsis</b></dt><dd>
<pre>
int ok = FStat(APTR handle, ULONG flags, struct hwos_StatStruct *st,
                   struct hwTagList *tags);</pre>
</dd>
<dt class="autodoc"><b>Function</b></dt><dd>
This function has to do the same as <a href="Stat.html">Stat()</a> but instead of a string describing
a path to a file system object it has to be able to obtain information about a file from
its handle allocated by <a href="FOpen.html">FOpen()</a>. <code>FStat()</code> needs to write the information
about the file to the structure pointer passed in parameter 3. <code>struct hwos_StatStruct</code>
looks like this:

<p>
<table cellpadding="0" cellspacing="0"><tr><td>&nbsp;</td><td><pre>struct hwos_StatStruct
{
    int Type;                               // [out]
    DOSINT64 Size;                          // [out]
    ULONG Flags;                            // [out]
    struct hwos_DateStruct Time;            // [out]
    struct hwos_DateStruct LastAccessTime;  // [out]
    struct hwos_DateStruct CreationTime;    // [out]
    STRPTR FullPath;                        // [out]
    STRPTR Comment;                         // [out]
    int LinkMode;                           // [out]
    STRPTR Container;                       // [out]
};
</pre></td></tr></table><p>

Your <code>FStat()</code> implementation needs to write the following information
to the individual structure members:

<p>
<dl>
<dt class="codelist"><code>Type:</code></dt>
<dd>
This must always be set to <code>HWSTATTYPE_FILE</code>.

<p>
</dd>
<dt class="codelist"><code>Size:</code></dt>
<dd>
This must be set to the size of the file in bytes or -1 if the size is not
known, maybe because the file is being streamed from a network source.

<p>
</dd>
<dt class="codelist"><code>Flags:</code></dt>
<dd>
Combination of flags describing the file system object attributes.
See <a href="FileAttributes.html">File attributes</a> for a list of supported attributes.

<p>
</dd>
<dt class="codelist"><code>Time:</code></dt>
<dd>
Time stamp indicating when this file system object was last modified. This information
is optional. Do not touch this member if you don't have this time information.

<p>
</dd>
<dt class="codelist"><code>LastAccessTime:</code></dt>
<dd>
Time stamp indicating when this file system object was last accessed. This information
is optional. Do not touch this member if you don't have this time information.

<p>
</dd>
<dt class="codelist"><code>CreationTime:</code></dt>
<dd>
Time stamp indicating when this file system object was created. This information
is optional. Do not touch this member if you don't have this time information.

<p>
</dd>
<dt class="codelist"><code>FullPath:</code></dt>
<dd>
Fully qualified path to the file. This must be provided. If the
<code>HWSTATFLAGS_ALLOCSTRINGS</code> flag is not set, you can set this to a static string
buffer which must stay valid until the next call to <code>FStat()</code>. If <code>HWSTATFLAGS_ALLOCSTRINGS</code>
has been set, you need to allocate a string buffer using <a href="hw_TrackedAlloc.html">hw_TrackedAlloc()</a>.

<p>
</dd>
<dt class="codelist"><code>Comment:</code></dt>
<dd>
Comment stored for this file in the file system. Set this to <code>NULL</code>
if you do not have this information or the file system doesn't support
storage of comments. If the <code>HWSTATFLAGS_ALLOCSTRINGS</code> flag is not set, you
can set this to a static string buffer which must stay valid until the next
call to Stat(). If <code>HWSTATFLAGS_ALLOCSTRINGS</code> has been set, you need to
allocate a string buffer using <a href="hw_TrackedAlloc.html">hw_TrackedAlloc()</a>.

<p>
</dd>
<dt class="codelist"><code>LinkMode:</code></dt>
<dd>
This member has to be set to the link mode to use when Hollywood needs
to link this file into an applet or executable. This can be one of the
following pre-defined link modes:

<p>
<dl>
<dt class="codelist"><code>HWSTATLKMODE_NORMAL:</code></dt>
<dd>
Normal link mode. This means that all data is simply read from the file and
is written to the applet or executable. Consequently, your file adapter is
no longer necessary when running the compiled applet or executable since
the data has already been converted to its raw form. Thus, if you use
<code>HWSTATLKMODE_NORMAL</code>, the compiled applet or executable won't require your
file adapter plugin any more. Also, your file adapter won't be called at all
when the user runs the compiled applet or executable because Hollywood
has already obtained the raw data from the file adapter during linking
stage.

<p>
</dd>
<dt class="codelist"><code>HWSTATLKMODE_NONE:</code></dt>
<dd>
This file should never be linked to applets or executables. If you use
this link mode, Hollywood will not link the file and just keep the
original reference that was specified in the Hollywood script, whatever
it may be. This can be useful when writing a file adapter that
streams data from a network source like an HTTP server. It wouldn't
make sense then for the Hollywood linker to always download the whole
file and link it to your applet or executable. Instead, just the URL
specification should be linked so that the data is streamed from this URL
when the user runs the compiled applet or executable. In that case
<code>HWSTATLKMODE_NONE</code> is the right choice since it skips linking for this
file altogether.

<p>
</dd>
<dt class="codelist"><code>HWSTATLKMODE_CONTAINER:</code></dt>
<dd>
This link mode allows you to specify a container file that should be
linked instead of the current file. Imagine you are writing a file
adapter that can load a compressed file format like gzip. If you used
<code>HWSTATLKMODE_NORMAL</code> now, Hollywood would always link the uncompressed
data to the applet or executable. However, you might want to make
Hollywood link the compressed data instead. This can be achieved by
setting the link mode to <code>HWSTATLKMODE_CONTAINER</code> and then setting the
<code>Container</code> member of this structure to the file that contains the
compressed data. When setting <code>LinkMode</code> to <code>HWSTATLKMODE_CONTAINER</code>,
Hollywood will always link the file specified in <code>Container</code> instead
of the current file. Please note that if you use <code>HWSTATLKMODE_CONTAINER</code>,
your implementation of <a href="FOpen.html">FOpen()</a> has to support the
<code>HWFOPENTAG_CHUNKXXX</code> tags and you have to set the <code>HWCLAFAFLAGS_CHUNKLOADER</code>
flag using <a href="hw_ConfigureLoaderAdapter.html">hw_ConfigureLoaderAdapter()</a>.
See <a href="FOpen.html">FOpen</a> for details.
</dd></dl>

<p>
</dd>
<dt class="codelist"><code>Container:</code></dt>
<dd>
If you set <code>LinkMode</code> to <code>HWSTATLKMODE_CONTAINER</code>, you need to set this
member to a path to a file that should be linked instead of the current file
when Hollywood is in linking mode. This can be used for fine-tuned control
over Hollywood's linker. See above for more information. The string
buffer you use to pass a container file to Hollywood must stay valid
until the next call to <code>FStat()</code>. Note that <code>HWSTATFLAGS_ALLOCSTRINGS</code>
(see below) doesn't affect <code>Container</code>. It must always use a static
string buffer. If link mode isn't set to <code>HWSTATLKMODE_CONTAINER</code>, set
this member to <code>NULL</code>.
</dd></dl>

<p>
The following flags are supported by <code>FStat()</code>:

<p>
<dl>
<dt class="codelist"><code>HWSTATFLAGS_ALLOCSTRINGS:</code></dt>
<dd>
If this flag is set, <code>FStat()</code> must not use static string buffers for the <code>FullPath</code>
and <code>Comment</code> structure members but allocate new private string buffers for them.
Hollywood will then call <a href="hw_TrackedFree.html">hw_TrackedFree()</a> on these buffers
once it is done with them. This flag is often set when <code>FStat()</code> is used in a multithreaded
setup.
</dd></dl>

<p>
<code>FStat()</code> has to return <code>True</code> on success or <code>False</code> on failure.

<p>
This function must be implemented in a thread-safe manner if the <code>HWSTATFLAGS_ALLOCSTRINGS</code>
flag is set.

<p>
</dd>
<dt class="autodoc"><b>Inputs</b></dt><dd>
<dl>
<dt><i>handle</i></dt>
<dd>file handle returned by <a href="FOpen.html">FOpen()</a></dd>
<dt><i>flags</i></dt>
<dd>additional flags (see above)</dd>
<dt><i>st</i></dt>
<dd>pointer to a <code>struct hwos_StatStruct</code> for storing information
about the file</dd>
<dt><i>tags</i></dt>
<dd>reserved for future use (currently <code>NULL</code>)</dl>
</dd>
<dt class="autodoc"><b>Results</b></dt><dd>
<dl>
<dt><i>ok</i></dt>
<dd><code>True</code> to indicate success, <code>False</code> on failure</dd></dl>
</dd></dl>
<hr>
<font size=-2><a href="FStat_.html" target="_top">Show TOC</a></font>
</body>
</html>