<html>
<!-- generated from hollywood_sdk.meta by MetaDoc 1.13 (c) by Andreas Falkenhahn -->
<head>
<title>LockBitMap</title>
<meta name="author" content="Andreas Falkenhahn">
<meta name="generator" content="MetaDoc 1.13">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<style type="text/css">
<!--
body {font-family: sans-serif;}
ul.toc {list-style: none; margin-left: 20px; padding-left: 0px;}
dt.autodoc {font-variant: small-caps; font-size: larger; margin-top: 10px; margin-bottom: 10px; padding-left: 0.2em; padding-top: 0.2em; padding-bottom: 0.2em;
	background-color: #bae1ff; border-width: 1px; border-color: #3baaff; border-style: solid;}
dt.codelist {margin-bottom: 0.2em;}
h2.heading {background-color: #bae1ff; font-family: Arial; padding-top: 0.4em; padding-bottom: 0.4em;}
code {background-color: #f2f2f2; padding: 2px 4px; font-weight: bold;}
pre {background-color: #f2f2f2; border: 1px solid #ddd; padding: 0.3em;}
		
-->
</style>
</head>
<body bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#0000FF" alink="#0000FF">
<dl>
<dt class="autodoc"><b>Name</b></dt><dd>
LockBitMap -- lock a software bitmap (V6.0, optional)</dd>
<dt class="autodoc"><b>Synopsis</b></dt><dd>
<pre>
APTR lock = LockBitMap(APTR handle, ULONG flags, struct
                hwos_LockBitMapStruct *bmlock, struct hwTagList *tags);</pre>
</dd>
<dt class="autodoc"><b>Function</b></dt><dd>
This function must lock a bitmap to allow access to the bitmap's underlying pixel
data. Hollywood will pass a pointer to a <code>struct hwos_LockBitMapStruct</code> to
this function. Your implementation must then fill this structure with all necessary
information. <code>struct hwos_LockBitMapStruct</code> looks like this:

<p>
<table cellpadding="0" cellspacing="0"><tr><td>&nbsp;</td><td><pre>struct hwos_LockBitMapStruct
{
    APTR Data;          // [out]
    int Modulo;         // [out]
    int PixelFormat;    // [out]
    int BytesPerPixel;  // [out]
    int Width;          // [out]
    int Height;         // [out]
};
</pre></td></tr></table><p>

Your <code>LockBitMap()</code> implementation has to write the following information to the
individual structure members:

<p>
<dl>
<dt class="codelist"><code>Data:</code></dt>
<dd>
Must be set to a pointer to the bitmap's actual pixel data. The pointer must
be valid until Hollywood calls <a href="UnLockBitMap.html">UnLockBitMap()</a> on the
handle that is returned by this function.

<p>
</dd>
<dt class="codelist"><code>Modulo:</code></dt>
<dd>
Must be set to the bitmap's modulo width, i.e. the length of a single row of pixels.
For bitmaps of type <code>HWBMTYPE_RGB</code> this value must be specified in pixels. For
the other bitmap types, this value must be specified in bytes.

<p>
</dd>
<dt class="codelist"><code>PixelFormat:</code></dt>
<dd>
This must be set to the pixel format used by the raw pixel array that you've
set in <code>Data</code>. See <a href="PixelFormats.html">Pixel format information</a> for details.

<p>
</dd>
<dt class="codelist"><code>BytesPerPixel:</code></dt>
<dd>
This must be set to how many bytes are needed for a single pixel. Note that
for CLUT bitmaps this must always be 1, even if the actual bit depth is less
than 8 bits.

<p>
</dd>
<dt class="codelist"><code>Width:</code></dt>
<dd>
Must be set to the bitmap's width.

<p>
</dd>
<dt class="codelist"><code>Height:</code></dt>
<dd>
Must be set to the bitmap's height.
</dd></dl>

<p>
Hollywood will also pass a combination of flags to this function. The following
flags are currently supported:

<p>
<dl>
<dt class="codelist"><code>HWLBMFLAGS_READONLY:</code></dt>
<dd>
If this flag is set, Hollywood will only need read access to the bitmap. It won't write
to the pixel array you return in the <code>Data</code> member of the <code>struct hwos_LockBitMapStruct</code>.
</dd></dl>

<p>
<code>LockBitMap()</code> has to return a lock handle for this bitmap. This is an opaque datatype
only known by your plugin. It's only used to unlock the bitmap again when Hollywood is
finished with it. Hollywood will call <a href="UnLockBitMap.html">UnLockBitMap()</a> then, passing
the handle which was returned by <code>LockBitMap()</code>. If this function fails to lock the bitmap,
return <code>NULL</code>.

<p>
This function will usually be called very often by Hollywood so your implementation
should be efficient and should not have to copy the pixels to a new memory block
first. Instead, it should be designed in a way that allows immediate access to the
pixel data.

<p>
<code>LockBitMap()</code> is an optional API and must only be implemented if <code>HWSDAFLAGS_BITMAPADAPTER</code>
has been passed to <a href="hw_SetDisplayAdapter.html">hw_SetDisplayAdapter()</a>. See <a href="hw_SetDisplayAdapter.html">hw_SetDisplayAdapter</a> for details.

<p>
</dd>
<dt class="autodoc"><b>Inputs</b></dt><dd>
<dl>
<dt><i>handle</i></dt>
<dd>bitmap handle allocated by <a href="AllocBitMap.html">AllocBitMap()</a></dd>
<dt><i>flags</i></dt>
<dd>flags for the lock operation (see above)</dd>
<dt><i>bmlock</i></dt>
<dd>pointer to a <code>struct hwos_LockBitMapStruct</code> to be filled out by this function</dd>
<dt><i>tags</i></dt>
<dd>reserved for future use (currently <code>NULL</code>)</dl>
</dd>
<dt class="autodoc"><b>Results</b></dt><dd>
<dl>
<dt><i>lock</i></dt>
<dd>bitmap lock or <code>NULL</code> in case there was an error</dd></dl>
</dd></dl>
<hr>
<font size=-2><a href="LockBitMap_.html" target="_top">Show TOC</a></font>
</body>
</html>