<html>
<!-- generated from hollywood_sdk.meta by MetaDoc 1.13 (c) by Andreas Falkenhahn -->
<head>
<title>AllocVideoBitMap</title>
<meta name="author" content="Andreas Falkenhahn">
<meta name="generator" content="MetaDoc 1.13">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<style type="text/css">
<!--
body {font-family: sans-serif;}
ul.toc {list-style: none; margin-left: 20px; padding-left: 0px;}
dt.autodoc {font-variant: small-caps; font-size: larger; margin-top: 10px; margin-bottom: 10px; padding-left: 0.2em; padding-top: 0.2em; padding-bottom: 0.2em;
	background-color: #bae1ff; border-width: 1px; border-color: #3baaff; border-style: solid;}
dt.codelist {margin-bottom: 0.2em;}
h2.heading {background-color: #bae1ff; font-family: Arial; padding-top: 0.4em; padding-bottom: 0.4em;}
code {background-color: #f2f2f2; padding: 2px 4px; font-weight: bold;}
pre {background-color: #f2f2f2; border: 1px solid #ddd; padding: 0.3em;}
		
-->
</style>
</head>
<body bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#0000FF" alink="#0000FF">
<dl>
<dt class="autodoc"><b>Name</b></dt><dd>
AllocVideoBitMap -- allocate a video bitmap (V6.0, optional)</dd>
<dt class="autodoc"><b>Synopsis</b></dt><dd>
<pre>
APTR handle = AllocVideoBitMap(int width, int height, ULONG flags,
                  struct hwTagList *tags);</pre>
</dd>
<dt class="autodoc"><b>Function</b></dt><dd>
This function must allocate a new video bitmap in the requested dimensions. Video
bitmaps, also called hardware or device-dependent bitmaps (DDBs), are
usually stored in GPU memory and can thus be drawn and transformed with hardware
acceleration. Hollywood can only draw video bitmaps to the custom hardware double
buffer implemented by your plugin. Thus, whenever you write a plugin that supports
video bitmaps you will also have to implement a custom hardware double buffer and
set the <code>HWSDAFLAGS_DOUBLEBUFFERADAPTER</code> flag accordingly. See <a href="BitmapInfo.html">Bitmap information</a> for details.

<p>
Hollywood will pass a taglist which contains further parameters for the operation
to <code>AllocVideoBitMap()</code>. Your implementation must be able to deal with the following
tags:

<p>
<dl>
<dt class="codelist"><code>HWAVBMTAG_DATA:</code></dt>
<dd>
The <code>pData</code> member of this tag item will be set to an object that should be used
to initialize the video bitmap's pixels. This tag will always be provided because
there is no way to set the video bitmap's pixel data at a later stage. That is
why the pixel data for the video bitmap is already provided by Hollywood at
allocation time. If the <code>HWAVBMFLAGS_BITMAPDATA</code> flag is set, then <code>pData</code> will contain
a handle to another video bitmap. This means that the new video bitmap should copy
all pixels from this video bitmap handle. It is guaranteed that the video bitmap
handle provided here matches the size of the new video bitmap that is to be allocated.
If <code>HWAVBMFLAGS_BITMAPDATA</code> is not set, then <code>pData</code> contains a pointer to a 32-bit
ARGB pixel array that contains the raw pixels that should be used to initialize
the new video bitmap. This 32-bit ARGB array will always be of the size
<code>width * height * 4</code>. No row padding is applied to this buffer.

<p>
</dd>
<dt class="codelist"><code>HWAVBMTAG_SRCWIDTH:</code></dt>
<dd>
If this tag is set and the <code>HWAVBMTAG_MATRIX2D</code> tag is not passed, then the width value
passed in parameter 1 is to be interpreted as a scaled value while the width passed in
this tag's <code>iData</code> member contains the width of the source pixel data that is passed in
<code>HWAVBMTAG_DATA</code>. This means that your implementation has to scale the source pixel data
provided in <code>HWAVBMTAG_DATA</code> to the dimensions passed in parameters 1 and 2. It also has
to take the scale mode into account that is passed in <code>HWAVBMTAG_SCALEMODE</code>. Hollywood uses this tag to
offer hardware-accelerated scaling of video bitmaps. Please note that <code>HWAVBMTAG_SRCWIDTH</code>
will only ever be passed to <code>AllocVideoBitMap()</code> if your plugin has explicitly declared
that it supports video bitmap scaling by setting the <code>HWVBMCAPS_SCALE</code> flag in <code>HWSDATAG_VIDEOBITMAPCAPS</code>.
If <code>HWAVMTAG_SRCWIDTH</code> and <code>HWAVBMTAG_MATRIX2D</code> are both passed, then you have to apply
a transformation matrix to the source pixel data. See the documentation of <code>HWAVBMTAG_MATRIX2D</code>
below for more information.

<p>
</dd>
<dt class="codelist"><code>HWAVBMTAG_SRCHEIGHT:</code></dt>
<dd>
This is the height counterpart for <code>HWAVBMTAG_SRCWIDTH</code>. See above for a description
on what this tag is used for.

<p>
</dd>
<dt class="codelist"><code>HWAVBMTAG_SCALEMODE:</code></dt>
<dd>
If <code>HWAVBM_SRCWIDTH</code> and <code>HWAVBM_SRCHEIGHT</code> or <code>HWAVBM_MATRIX2D</code> are set, this tag will also be provided
to tell you about the scale mode that Hollywood wants you to use. Currently, only
0 and 1 are supported here. A value of 0 in <code>iData</code> means that you should do hard
scaling without any interpolation whereas a value of 1 means that Hollywood wants
you to do use anti-alias interpolation. See above in the description of <code>HWAVBM_SRCWIDTH</code>
for more information.

<p>
</dd>
<dt class="codelist"><code>HWAVBMTAG_MATRIX2D:</code></dt>
<dd>
If this tag is set, then Hollywood wants you to apply a transformation to the source
pixel data provided in <code>HWAVBMTAG_DATA</code> and store the transformation's resulting pixels
in the new video bitmap that is to be allocated. Hollywood has already calculated the
dimensions for the new video bitmap and passed them to this function in parameters 1
and 2. To get to know about the dimensions of the source pixel data, you have to
examine the tags <code>HWAVBMTAG_SRCWIDTH</code> and <code>HWAVBM_SRCHEIGHT</code> which are always passed
if <code>HWAVBMTAG_MATRIX2D</code> is set. The <code>pData</code> member of this tag item will be set to
a pointer to a <code>struct hwMatrix2D</code> that contains all parameters for the
transformation. Note that your implementation also has to take the scale mode
that is passed in <code>HWAVBMTAG_SCALEMODE</code> into account. Hollywood uses this tag to
offer hardware-accelerated transformation of video bitmaps. Please note that <code>HWAVBMTAG_MATRIX2D</code>
will only ever be passed to <code>AllocVideoBitMap()</code> if your plugin has explicitly declared
that it supports video bitmap transformation by setting the <code>HWVBMCAPS_TRANSFORM</code> flag
in <code>HWSDATAG_VIDEOBITMAPCAPS</code>.

<p>
</dd>
<dt class="codelist"><code>HWAVBMTAG_DISPLAY:</code></dt>
<dd>
If you've set the <code>HWSDAFLAGS_TIEDVIDEOBITMAP</code> flag when installing your display
adapter using <a href="hw_SetDisplayAdapter.html">hw_SetDisplayAdapter()</a> then this
tag will always be provided and its <code>pData</code> member will be set to a handle to the
display that this video bitmap should be allocated for. This will always be a handle
returned by your <a href="OpenDisplay.html">OpenDisplay()</a> implementation.
</dd></dl>

<p>
In addition to the taglist items described above, Hollywood can also set the
following flags and your plugin has to be prepared to handle them:

<p>
<dl>
<dt class="codelist"><code>HWAVBMFLAGS_BLEND:</code></dt>
<dd>
If this flag is set, then the data provided in <code>HWAVBMTAG_DATA</code> contains alpha
channel transparency information and your plugin is expected to do the alpha
blending with this data whenever it draws this bitmap. Note that the alpha
channel data is always non-premultiplied.

<p>
</dd>
<dt class="codelist"><code>HWAVBMFLAGS_BITMAPDATA:</code></dt>
<dd>
If this flag is set, then the data provided in <code>HWAVBMTAG_DATA</code> is a handle
to another video bitmap which Hollywood wants you to use as the pixel data
source. If this flag isn't set, then <code>HWAVBMTAG_DATA</code> contains a pointer to
a 32-bit ARGB pixel array. See the documentation of <code>HWAVBMTAG_DATA</code> above
for more information.

<p>
</dd>
<dt class="codelist"><code>HWAVBMFLAGS_SMOOTH:</code></dt>
<dd>
If the <code>SmoothScale</code> tag has been set to <code>True</code> in Hollywood's <code>@BRUSH</code>, <code>LoadBrush()</code>,
<code>CreateBrush()</code>, or <code>CopyBrush()</code> commands, this flag will be set. (V8.0)
</dd></dl>

<p>
<code>AllocVideoBitMap()</code> is an optional API and must only be implemented if <code>HWSDAFLAGS_VIDEOBITMAPADAPTER</code>
has been passed to <a href="hw_SetDisplayAdapter.html">hw_SetDisplayAdapter()</a>. See <a href="hw_SetDisplayAdapter.html">hw_SetDisplayAdapter</a> for details.

<p>
</dd>
<dt class="autodoc"><b>Inputs</b></dt><dd>
<dl>
<dt><i>width</i></dt>
<dd>desired bitmap width in pixels</dd>
<dt><i>height</i></dt>
<dd>desired bitmap height in pixels</dd>
<dt><i>flags</i></dt>
<dd>allocation flags (see above)</dd>
<dt><i>tags</i></dt>
<dd>taglist containing additional parameters (see above)</dl>
</dd>
<dt class="autodoc"><b>Results</b></dt><dd>
<dl>
<dt><i>handle</i></dt>
<dd>handle to the bitmap or <code>NULL</code> in case of an error</dd></dl>
</dd></dl>
<hr>
<font size=-2><a href="AllocVideoBitMap_.html" target="_top">Show TOC</a></font>
</body>
</html>