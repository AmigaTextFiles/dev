<html>
<!-- generated from hollywood_sdk.meta by MetaDoc 1.13 (c) by Andreas Falkenhahn -->
<head>
<title>AllocAudioChannel</title>
<meta name="author" content="Andreas Falkenhahn">
<meta name="generator" content="MetaDoc 1.13">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<style type="text/css">
<!--
body {font-family: sans-serif;}
ul.toc {list-style: none; margin-left: 20px; padding-left: 0px;}
dt.autodoc {font-variant: small-caps; font-size: larger; margin-top: 10px; margin-bottom: 10px; padding-left: 0.2em; padding-top: 0.2em; padding-bottom: 0.2em;
	background-color: #bae1ff; border-width: 1px; border-color: #3baaff; border-style: solid;}
dt.codelist {margin-bottom: 0.2em;}
h2.heading {background-color: #bae1ff; font-family: Arial; padding-top: 0.4em; padding-bottom: 0.4em;}
code {background-color: #f2f2f2; padding: 2px 4px; font-weight: bold;}
pre {background-color: #f2f2f2; border: 1px solid #ddd; padding: 0.3em;}
		
-->
</style>
</head>
<body bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#0000FF" alink="#0000FF">
<dl>
<dt class="autodoc"><b>Name</b></dt><dd>
AllocAudioChannel -- allocate new audio channel (V6.0)</dd>
<dt class="autodoc"><b>Synopsis</b></dt><dd>
<pre>
APTR chandle = AllocAudioChannel(APTR handle, int fmt, int freq, int vol,
                  int (*feedproc)(APTR handle, APTR chandle, APTR buf,
                  int count, APTR userdata), ULONG flags, APTR userdata,
                  struct hwTagList *tags);</pre>
</dd>
<dt class="autodoc"><b>Function</b></dt><dd>
This function must allocate a new audio channel on the audio device passed in
the first parameter. Hollywood will inform you about the PCM sample format
that should be played on this channel in parameters 2 to 4. The <code>fmt</code> parameter
can be one of the following formats:

<p>
<dl>
<dt class="codelist"><code>HWSMPFMT_U8M:</code></dt>
<dd>
Unsigned 8-bit mono PCM data is fed to this channel.

<p>
</dd>
<dt class="codelist"><code>HWSMPFMT_U8S:</code></dt>
<dd>
Unsigned 8-bit stereo PCM data is fed to this channel.

<p>
</dd>
<dt class="codelist"><code>HWSMPFMT_S8M:</code></dt>
<dd>
Signed 8-bit mono PCM data is fed to this channel.

<p>
</dd>
<dt class="codelist"><code>HWSMPFMT_S8S:</code></dt>
<dd>
Signed 8-bit stereo PCM data is fed to this channel.

<p>
</dd>
<dt class="codelist"><code>HWSMPFMT_S16M:</code></dt>
<dd>
Signed 16-bit mono PCM data is fed to this channel.

<p>
</dd>
<dt class="codelist"><code>HWSMPFMT_S16S:</code></dt>
<dd>
Signed 16-bit stereo PCM data is fed to this channel.
</dd></dl>

<p>
Parameter 3 contains the number of PCM frames that will be played on
this channel per second. Common values are 44100 or 48000 here. Parameter 4
contains the desired volume for this channel. This can range from 0 (mute)
to 64 (full volume).

<p>
Hollywood will also pass a pointer to an audio feed procedure to this function.
Whenever you need more PCM data to play on this audio channel, call this feed
procedure. The prototype of this procedure looks like this:

<p>
<table cellpadding="0" cellspacing="0"><tr><td>&nbsp;</td><td><pre>int feedproc(APTR hdl, APTR ch, APTR buf, int count, APTR userdata);
</pre></td></tr></table><p>

Here is how you have to call this feed procedure:

<p>
<dl>
<dt class="codelist"><code>hdl:</code></dt>
<dd>
This parameter must be set to the handle of the audio device opened
via <a href="OpenAudio.html">OpenAudio()</a>.

<p>
</dd>
<dt class="codelist"><code>ch:</code></dt>
<dd>
This parameter must be set to the handle of the audio channel allocated
via <code>AllocAudioChannel()</code>.

<p>
</dd>
<dt class="codelist"><code>buf:</code></dt>
<dd>
You have to pass a pointer to a memory buffer that should receive the new PCM data here.

<p>
</dd>
<dt class="codelist"><code>count:</code></dt>
<dd>
You have to pass the number of PCM frames you want to receive here. Please
note that this parameter must be specified in PCM frames, not in bytes.
So if you set this to 1024 and your PCM samples are formatted as 16-bit wide
stereo frames, the buffer you pass would have to be at least 4096 bytes in
size. You should request PCM frames from Hollywood only in small portions.
For a playback rate of 44100 frames per second, a request of 2048 PCM frames per
<code>feedproc()</code> call is a reasonable size.

<p>
</dd>
<dt class="codelist"><code>userdata:</code></dt>
<dd>
You always have to set this parameter to the user data pointer that Hollywood
has passed to your <code>AllocAudioChannel()</code> function here.
</dd></dl>

<p>
<code>feedproc()</code> returns the number of PCM frames successfully copied. Once again,
be careful that this value is in PCM frames, not in bytes (see above). If this
value is less than you requested, the channel has finished playing and Hollywood
will soon call <a href="FreeAudioChannel.html">FreeAudioChannel()</a> on it.

<p>
The feed procedure that Hollywood passes to you is thread-safe so you can
call this from worker threads or audio interrupts as well.

<p>
</dd>
<dt class="autodoc"><b>Inputs</b></dt><dd>
<dl>
<dt><i>handle</i></dt>
<dd>audio device allocated by <a href="OpenAudio.html">OpenAudio()</a></dd>
<dt><i>fmt</i></dt>
<dd>format of PCM data passed to this channel (see above)</dd>
<dt><i>freq</i></dt>
<dd>number of PCM frames per second to be played on this channel</dd>
<dt><i>vol</i></dt>
<dd>initial channel volume (0 to 64)</dd>
<dt><i>feedproc</i></dt>
<dd>pointer to a function that needs to be called to request more
PCM data from Hollywood</dd>
<dt><i>flags</i></dt>
<dd>reserved for future use (currently 0)</dd>
<dt><i>userdata</i></dt>
<dd>userdata that needs to be passed to <code>feedproc()</code></dd>
<dt><i>tags</i></dt>
<dd>reserved for future use (currently <code>NULL</code>)</dl>
</dd>
<dt class="autodoc"><b>Results</b></dt><dd>
<dl>
<dt><i>chandle</i></dt>
<dd>handle to this audio channel or <code>NULL</code> on error</dd></dl>
</dd></dl>
<hr>
<font size=-2><a href="AllocAudioChannel_.html" target="_top">Show TOC</a></font>
</body>
</html>