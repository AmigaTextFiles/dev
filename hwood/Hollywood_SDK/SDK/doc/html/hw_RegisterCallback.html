<html>
<!-- generated from hollywood_sdk.meta by MetaDoc 1.13 (c) by Andreas Falkenhahn -->
<head>
<title>hw_RegisterCallback</title>
<meta name="author" content="Andreas Falkenhahn">
<meta name="generator" content="MetaDoc 1.13">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<style type="text/css">
<!--
body {font-family: sans-serif;}
ul.toc {list-style: none; margin-left: 20px; padding-left: 0px;}
dt.autodoc {font-variant: small-caps; font-size: larger; margin-top: 10px; margin-bottom: 10px; padding-left: 0.2em; padding-top: 0.2em; padding-bottom: 0.2em;
	background-color: #bae1ff; border-width: 1px; border-color: #3baaff; border-style: solid;}
dt.codelist {margin-bottom: 0.2em;}
h2.heading {background-color: #bae1ff; font-family: Arial; padding-top: 0.4em; padding-bottom: 0.4em;}
code {background-color: #f2f2f2; padding: 2px 4px; font-weight: bold;}
pre {background-color: #f2f2f2; border: 1px solid #ddd; padding: 0.3em;}
		
-->
</style>
</head>
<body bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#0000FF" alink="#0000FF">
<dl>
<dt class="autodoc"><b>Name</b></dt><dd>
hw_RegisterCallback -- register a new callback (V5.2)</dd>
<dt class="autodoc"><b>Synopsis</b></dt><dd>
<pre>
APTR cb = hw_RegisterCallback(int type, APTR func, APTR userdata);</pre>
</dd>
<dt class="autodoc"><b>Function</b></dt><dd>
This function can be used to register a new callback that will be run by Hollywood
in a certain context which is specified by <code>type</code>. The following callback types
are currently supported:

<p>
<dl>
<dt class="codelist"><code>HWCB_AMIGASIGNAL:</code></dt>
<dd>
This is only supported in the AmigaOS compatible versions of Hollywood. Hollywood will
run callbacks of the type <code>HWCB_AMIGASIGNAL</code> whenever it is about to call <code>exec.library/Wait()</code>
to wait on a set of signals. Your callback will then be asked for additional signal bits
that should be included in the call to <code>Wait()</code>. The prototype for an Amiga signal callback
looks like this:

<p>
<table cellpadding="0" cellspacing="0"><tr><td>&nbsp;</td><td><pre>ULONG AmigaSignal(APTR userdata);
</pre></td></tr></table><p>

Hollywood will pass the user data that you pass in parameter 3 of <code>hw_RegisterCallback()</code>
to your <code>AmigaSignal()</code> callback. Your <code>AmigaSignal()</code> callback has to return a combination
of signal bits that should be included in the call to <code>Wait()</code>. There are two special return
values: If you return 0, Hollywood will run your <code>AmigaSignal()</code> again. If you return <code>0xFFFFFFFF</code>,
no additional signals will be included in the call to <code>Wait()</code>. If your callback needs to
return an error code to Hollywood, you have to use <code>HWMCP_SETAMIGASIGNALERROR</code> for that.
See <a href="hw_MasterControl.html">hw_MasterControl</a> for details.

<p>
</dd>
<dt class="codelist"><code>HWCB_LINEHOOK:</code></dt>
<dd>
Callbacks of type <code>HWCB_LINEHOOK</code> will be run whenever Hollywood runs its line hook, i.e.
after running one line of Lua code. Line hooks are called very often, usually many times
per second. Thus, you must make sure that your line hook callback doesn't do any expensive
things or it will slow down the script's execution significantly. The prototype for a
line hook callback looks like this:

<p>
<table cellpadding="0" cellspacing="0"><tr><td>&nbsp;</td><td><pre>int LineHook(lua_State *L, APTR userdata);
</pre></td></tr></table><p>

Your line hook callback will receive a pointer to the <code>lua_State</code> as well as the user data
that has been passed to <code>hw_RegisterCallback()</code> when registering the callback. Your callback
has to return a standard Hollywood error code or 0 for success. (V6.0)

<p>
</dd>
<dt class="codelist"><code>HWCB_SHOWHIDEAPP:</code></dt>
<dd>
This is only supported in the AmigaOS compatible versions of Hollywood. Hollywood will
run callbacks of type <code>HWCB_SHOWHIDEAPP</code> whenever the user changes the visibility of an
application via commodities' Exchange tool or application.library on AmigaOS4. The prototype
for a show/hide app callback looks like this:

<p>
<table cellpadding="0" cellspacing="0"><tr><td>&nbsp;</td><td><pre>void ShowHideApp(int show, APTR userdata);
</pre></td></tr></table><p>

When the application is shown, Hollywood will pass <code>True</code> in the <code>show</code> parameter and when
the application is hidden, this parameter will be set to <code>False</code>. (V6.1)

<p>
</dd>
<dt class="codelist"><code>HWCB_ENCODINGCHANGE:</code></dt>
<dd>
Callbacks of type <code>HWCB_ENCODINGCHANGE</code> will be run whenever the encoding of the current
script changes. This can only happen once for each script. Since all scripts run in UTF-8
encoding by default starting in Hollywood 7.0, the only change that you can be notified
of through this callback is an encoding change from UTF-8 to ISO 8859-1. This can only
happen if a script explicitly requests ISO 8859-1 to run in compatibility mode. Normally,
all scripts should run in UTF-8 encoding starting with Hollywood 7.0. The prototype for
an encoding change callback looks like this:

<p>
<table cellpadding="0" cellspacing="0"><tr><td>&nbsp;</td><td><pre>void EncodingChange(int encoding, APTR userdata);
</pre></td></tr></table><p>

The <code>encoding</code> parameter will contain the new encoding. As described above, this can only
ever be <code>HWOS_ENCODING_ISO8859_1</code> since the default encoding is <code>HWOS_ENCODING_UTF8</code>.
Note that there is also a <a href="hw_GetEncoding.html">hw_GetEncoding()</a> function to get the
current encoding but this is not so convenient because the script encoding hasn't been
set yet when the plugin is initialized. See <a href="hw_GetEncoding.html">hw_GetEncoding</a> for details. (V7.0)

<p>
</dd>
<dt class="codelist"><code>HWCB_DROPFILECHANGE:</code></dt>
<dd>
Callbacks of type <code>HWCB_DROPFILECHANGE</code> will be run whenever the user installs or deinstalls
a listener on the &quot;OnDropFile&quot; event handler using Hollywood's <code>InstallEventHandler()</code>
function. This is especially useful for display adapters which want to support drag'n'drop
through Hollywood's standard event handlers and need to take some action whenever the
user enables or disables drag'n'drop by installing or removing a listener on the &quot;OnDropFile&quot;
event handler. The prototype for a drop file change callback looks like this:

<p>
<table cellpadding="0" cellspacing="0"><tr><td>&nbsp;</td><td><pre>void DropFileChange(APTR d, int enable, APTR userdata);
</pre></td></tr></table><p>

The callback will receive a pointer to the display for which drag'n'drop should be
enabled or disabled in the <code>d</code> parameter and either <code>True</code> or <code>False</code> in the <code>enable</code>
parameter. (V7.0)
</dd></dl>

<p>
</dd>
<dt class="autodoc"><b>Designer compatibility</b></dt><dd>
Supported since Designer 5.0

<p>
</dd>
<dt class="autodoc"><b>Inputs</b></dt><dd>
<dl>
<dt><i>type</i></dt>
<dd>callback type to register (see above for supported types)</dd>
<dt><i>func</i></dt>
<dd>pointer to callback function; the actual format of this function depends on
the specified callback type (see above)</dd>
<dt><i>userdata</i></dt>
<dd>user data that should be passed to the callback function when Hollywood runs it</dl>
</dd>
<dt class="autodoc"><b>Results</b></dt><dd>
<dl>
<dt><i>cb</i></dt>
<dd>callback handle or <code>NULL</code> on error</dd></dl>
</dd></dl>
<hr>
<font size=-2><a href="hw_RegisterCallback_.html" target="_top">Show TOC</a></font>
</body>
</html>