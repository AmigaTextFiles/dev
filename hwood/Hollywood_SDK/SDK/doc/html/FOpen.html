<html>
<!-- generated from hollywood_sdk.meta by MetaDoc 1.13 (c) by Andreas Falkenhahn -->
<head>
<title>FOpen</title>
<meta name="author" content="Andreas Falkenhahn">
<meta name="generator" content="MetaDoc 1.13">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<style type="text/css">
<!--
body {font-family: sans-serif;}
ul.toc {list-style: none; margin-left: 20px; padding-left: 0px;}
dt.autodoc {font-variant: small-caps; font-size: larger; margin-top: 10px; margin-bottom: 10px; padding-left: 0.2em; padding-top: 0.2em; padding-bottom: 0.2em;
	background-color: #bae1ff; border-width: 1px; border-color: #3baaff; border-style: solid;}
dt.codelist {margin-bottom: 0.2em;}
h2.heading {background-color: #bae1ff; font-family: Arial; padding-top: 0.4em; padding-bottom: 0.4em;}
code {background-color: #f2f2f2; padding: 2px 4px; font-weight: bold;}
pre {background-color: #f2f2f2; border: 1px solid #ddd; padding: 0.3em;}
		
-->
</style>
</head>
<body bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#0000FF" alink="#0000FF">
<dl>
<dt class="autodoc"><b>Name</b></dt><dd>
FOpen -- open a file (V6.0)</dd>
<dt class="autodoc"><b>Synopsis</b></dt><dd>
<pre>
APTR handle = FOpen(STRPTR name, int mode, struct hwTagList *tags);</pre>
</dd>
<dt class="autodoc"><b>Function</b></dt><dd>
This function is called for every file that Hollywood opens. Your <code>FOpen()</code> implementation
has to check whether your plugin wants to handle this file or not. If your plugin
wants to handle this file, your <code>FOpen()</code> implementation needs to open it and return
a handle to Hollywood. Otherwise <code>FOpen()</code> must return <code>NULL</code>. The handle returned by this
function is an opaque data type only your plugin knows about. Hollywood will pass this
handle to you whenever it wants to do IO on this file.

<p>
The second parameter specifies whether Hollywood wants to open this file for
reading and/or writing. It can be one of the following values:

<p>
<dl>
<dt class="codelist"><code>HWFOPENMODE_READ_NEW:</code></dt>
<dd>
File should be opened for reading. <code>FOpen()</code> must fail if file doesn't exist.

<p>
</dd>
<dt class="codelist"><code>HWFOPENMODE_WRITE:</code></dt>
<dd>
File should be opened for writing. If it doesn't exist, <code>FOpen()</code> has to create it
first.

<p>
</dd>
<dt class="codelist"><code>HWFOPENMODE_READWRITE:</code></dt>
<dd>
File should be opened for reading and writing.
</dd></dl>

<p>
Additionally, Hollywood will pass a tag list to your implementation in parameter 3.
This tag list can contain the following items:

<p>
<dl>
<dt class="codelist"><code>HWFOPENTAG_FLAGS:</code></dt>
<dd>
This tag is used to pass additional flags to your plugin and it also allows you to
report certain flags about the file back to Hollywood. The <code>pData</code> member of this tag
will be set to a pointer to a <code>ULONG</code> which contains the flags Hollywood wants to
pass to your plugin. Your plugin may then also set one or more of the following flags
in this <code>ULONG</code> to inform Hollywood about the properties of the file. Flags marked
as <code>[in]</code> may be set by Hollywood whereas flags marked as <code>[out]</code> can
be set by your plugin. The following flags are currently defined:

<p>
<dl>
<dt class="codelist"><code>HWFOPENFLAGS_STREAMING: [out]</code></dt>
<dd>
Setting this flag tells Hollywood that the file is being streamed from a network source.
If this flag is set, Hollywood will try to avoid operations that are inefficient
on streaming sources like excessive seeking operations.

<p>
</dd>
<dt class="codelist"><code>HWFOPENFLAGS_NOSEEK: [out]</code></dt>
<dd>
Setting this flag tells Hollywood that the file cannot be seeked. Note that if you set
this flag, you will still have to implement the <a href="FSeek.html">FSeek()</a> function
but it only needs to support rewinding (i.e. reverting the read/write cursor to the beginning of the file)
and querying the current file cursor position. Note that if you set <code>HWFOPENFLAGS_NOSEEK</code>
several file format handlers which depend on the seek functionality might stop
working. Plugins may choose to work-around this problem by setting the <code>HWFOPENMODE_EMULATESEEK</code>
flag when calling <a href="hw_FOpen.html">hw_FOpen()</a>. See <a href="hw_FOpen.html">hw_FOpen</a> for details.

<p>
</dd>
<dt class="codelist"><code>HWFOPENFLAGS_WONTSEEK: [in]</code></dt>
<dd>
Hollywood will set this flag in case it doesn't need to seek the file that should be opened.
This allows file adapters to use optimized I/O in case the file will never be seeked. Note,
however, that even if <code>HWFOPENFLAGS_WONTSEEK</code> is set, Hollywood can still call <a href="FSeek.html">FSeek()</a>
to query the current cursor position, to query the file size by seeking to position 0 with mode
set to <code>HWFSEEKMODE_END</code> or to rewind the file back to 0 so your plugin must be able to handle
those situation. (V10.0)
</dd></dl>

<p>
</dd>
<dt class="codelist"><code>HWFOPENTAG_CHUNKFILE:</code></dt>
<dd>
If you've set the <code>HWCLAFAFLAGS_CHUNKLOADER</code> flag to indicate that your file adapter supports
opening of virtual files that do not exist physically but only as parts of other files, you
can use this tag to find out the path to the real file that contains the virtual file.
If Hollywood passes the <code>HWFOPENTAG_CHUNKFILE</code> tag to your <code>FOpen()</code> implementation, the <code>pData</code> member will be set to a string
containing the path to the real file Hollywood wants you to open, but keep in mind that
Hollywood wants you to look at a part of this file only. This part is described by the
<code>HWFOPENTAG_CHUNKOFFSET</code> and <code>HWFOPENTAG_CHUNKLENGTH</code> tags which are always passed alongside
<code>HWFOPENTAG_CHUNKFILE</code>. <code>HWFOPENTAG_CHUNKOFFSET</code> specifies the offset where the virtual
file inside the file passed in <code>HWFOPENTAG_CHUNKFILE</code> starts and <code>HWFOPENTAG_CHUNKLENGTH</code>
specifies its length. Your file adapter implementation must remap all accesses to the
virtual file to the physical file specified in <code>HWFOPENTAG_CHUNKFILE</code> then, i.e. if the
user calls <a href="FSeek.html">FSeek()</a> to seek to the beginning of the file, your implementation
of <a href="FSeek.html">FSeek()</a> must actually seek to the position specified in <code>HWFOPENTAG_CHUNKOFFSET</code>
and so on. You only need to implement support for <code>HWFOPENTAG_CHUNKFILE</code> if you set <code>LinkMode</code>
to <code>HWSTATLKMODE_CONTAINER</code> in <a href="FStat.html">FStat()</a>. Otherwise, it's not necessary
to implement <code>HWFOPENTAG_CHUNKFILE</code>. See <a href="FStat.html">FStat</a> for details.

<p>
</dd>
<dt class="codelist"><code>HWFOPENTAG_CHUNKMEMORY:</code></dt>
<dd>
This is similar to <code>HWFOPENTAG_CHUNKFILE</code> except that the <code>pData</code> member of this tag doesn't
point to a string containing a file path but to a memory block containing the data of the
virtual file. You can look at the <code>HWFOPENTAG_CHUNKLENGTH</code> to find out the size of the memory
block. <code>HWFOPENTAG_CHUNKOFFSET</code> is not used for this tag. See above for more information.

<p>
</dd>
<dt class="codelist"><code>HWFOPENTAG_CHUNKOFFSET:</code></dt>
<dd>
If <code>HWFOPENTAG_CHUNKFILE</code> is set, the <code>iData</code> member of this tag will be set to the starting
offset of the virtual file inside the physical file specified in <code>HWFOPENTAG_CHUNKFILE</code>.

<p>
</dd>
<dt class="codelist"><code>HWFOPENTAG_CHUNKLENGTH:</code></dt>
<dd>
If either <code>HWFOPENTAG_CHUNKFILE</code> or <code>HWFOPENTAG_CHUNKMEMORY</code> is set, the <code>iData</code> member of
this tag will be set to the length of the virtual file in bytes.

<p>
</dd>
<dt class="codelist"><code>HWFOPENTAG_USERTAGS:</code></dt>
<dd>
If this is set, <code>pData</code> will point to a <code>struct hwUserTagList</code> containing
a list of user tags passed by the Hollywood script. User tags are a way of
passing additional information from Hollywood scripts to plugin functions.
See <a href="UserTags.html">User tags</a> for details. (V10.0)

<p>
</dd>
<dt class="codelist"><code>HWFOPENTAG_FORMAT:</code></dt>
<dd>
This tag can be used to pass a file format string back to Hollywood. <code>pData</code> will point
to a pointer to a string pointer, i.e. <code>STRPTR*</code>. Your plugin can set <code>pData</code>
to a null-terminated string containing a format description of the file. Hollywood scripts
will then be able to get this format name by querying the <code>#ATTRFORMAT</code> attribute on <code>#FILE</code>.
Note that the string pointer you write to <code>pData</code> must stay valid for as long as the
file is open. (V10.0)
</dd></dl>

<p>
This function must be implemented in a thread-safe manner.

<p>
</dd>
<dt class="autodoc"><b>Inputs</b></dt><dd>
<dl>
<dt><i>name</i></dt>
<dd>file to open</dd>
<dt><i>mode</i></dt>
<dd>desired access mode (see above)</dd>
<dt><i>tags</i></dt>
<dd>tag list with additional options (see above)</dl>
</dd>
<dt class="autodoc"><b>Results</b></dt><dd>
<dl>
<dt><i>handle</i></dt>
<dd>handle to refer to this file later or <code>NULL</code> if your plugin doesn't
want to handle this file</dd></dl>
</dd></dl>
<hr>
<font size=-2><a href="FOpen_.html" target="_top">Show TOC</a></font>
</body>
</html>