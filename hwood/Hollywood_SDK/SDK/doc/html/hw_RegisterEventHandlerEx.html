<html>
<!-- generated from hollywood_sdk.meta by MetaDoc 1.13 (c) by Andreas Falkenhahn -->
<head>
<title>hw_RegisterEventHandlerEx</title>
<meta name="author" content="Andreas Falkenhahn">
<meta name="generator" content="MetaDoc 1.13">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<style type="text/css">
<!--
body {font-family: sans-serif;}
ul.toc {list-style: none; margin-left: 20px; padding-left: 0px;}
dt.autodoc {font-variant: small-caps; font-size: larger; margin-top: 10px; margin-bottom: 10px; padding-left: 0.2em; padding-top: 0.2em; padding-bottom: 0.2em;
	background-color: #bae1ff; border-width: 1px; border-color: #3baaff; border-style: solid;}
dt.codelist {margin-bottom: 0.2em;}
h2.heading {background-color: #bae1ff; font-family: Arial; padding-top: 0.4em; padding-bottom: 0.4em;}
code {background-color: #f2f2f2; padding: 2px 4px; font-weight: bold;}
pre {background-color: #f2f2f2; border: 1px solid #ddd; padding: 0.3em;}
		
-->
</style>
</head>
<body bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#0000FF" alink="#0000FF">
<dl>
<dt class="autodoc"><b>Name</b></dt><dd>
hw_RegisterEventHandlerEx -- register a new event type (V6.0)</dd>
<dt class="autodoc"><b>Synopsis</b></dt><dd>
<pre>
int id = hw_RegisterEventHandlerEx(STRPTR name, int type, APTR data);</pre>
</dd>
<dt class="autodoc"><b>Function</b></dt><dd>
This function allows you to register a new event type. The user will then be able
to listen to events of this type by installing a new event handler for this type
by using the Hollywood function <code>InstallEventHandler()</code>. Whenever you want this
event handler to trigger, you have to post an event to Hollywood's event
queue using the <a href="hw_PostEvent.html">hw_PostEvent()</a> or <a href="hw_PostEventEx.html">hw_PostEventEx()</a>
function.

<p>
You have to specify a name for the new event type. This name must follow the
conventions for Hollywood variables because the user will need to use this
name when installing a handler for this event type using Hollywood's <code>InstallEventHandler()</code>
function. Thus, the name you specify here must not clash with any existing
event handler names and it must not use any spaces or special characters.
It has to start with a letter from the English alphabet.

<p>
In parameter 2, you need to pass the type of the event you would like to register.
The following event types are currently recognized:

<p>
<dl>
<dt class="codelist"><code>HWEVTHANDLER_STANDARD:</code></dt>
<dd>
This registers a standard event. Standard events are the most basic event
types available and they are also the ones that are registered by the
<a href="hw_RegisterEventHandler.html">hw_RegisterEventHandler()</a> function. For
standard events, the <code>data</code> parameter must be set to a pointer to a
<code>struct hwStandardEventHandler</code> which looks like this:

<p>
<table cellpadding="0" cellspacing="0"><tr><td>&nbsp;</td><td><pre>struct hwStandardEventHandler
{
    void (*EvtFunc)(lua_State *L, int type, APTR userdata);
};
</pre></td></tr></table><p>

The following items are members of this structure:

<p>
<dl>
<dt class="codelist"><code>EvtFunc:</code></dt>
<dd>
This member must be set to a function pointer which will be called whenever
Hollywood is about to run the callback that the user has installed for the
event using <code>InstallEventHandler()</code>. The function you specify here may then push
additional values on the stack. When <code>evtfunc</code> is called, Hollywood will have already
pushed a table to the stack and it will have set the <code>Action</code> field of that table to
the name of your event for consistency with inbuilt Hollywood events. All other
values that your event handler may want to provide to the user's event callback
should also be stored in that table. Note that you must write this function even if
you do not want to push any additional values on the stack. <code>EvtFunc</code> must not be
<code>NULL</code>. The user data that is passed to <code>EvtFunc</code> as the third parameter is the same
pointer that you provided in the call to <a href="hw_PostEvent.html">hw_PostEvent()</a>
or <a href="hw_PostEventEx.html">hw_PostEventEx()</a>.
</dd></dl>

<p>
<code>HWEVTHANDLER_STANDARD</code> is identical to the event handler registered by
<a href="hw_RegisterEventHandler.html">hw_RegisterEventHandler()</a> so you might
also use the latter to register standard events.

<p>
</dd>
<dt class="codelist"><code>HWEVTHANDLER_CUSTOM:</code></dt>
<dd>
This registers a custom event. Custom events differ from standard events
in the way that your plugin is given more fine-tuned control about the
way the events are handled. In contrast to standard events, Hollywood
will call your plugin also after it has run a user callback for this
event and it also supports event destructors. For custom events, the <code>data</code>
parameter must be set to a pointer to a <code>struct hwCustomEventHandler</code>
which looks like this:

<p>
<table cellpadding="0" cellspacing="0"><tr><td>&nbsp;</td><td><pre>struct hwCustomEventHandler
{
    int (*PushData)(lua_State *L, int type, APTR udata);
    void (*PostCall)(lua_State *L, int type, APTR udata);
    void (*FreeEvent)(lua_State *L, int type, APTR udata);
};
</pre></td></tr></table><p>

The following items are members of this structure:

<p>
<dl>
<dt class="codelist"><code>PushData:</code></dt>
<dd>
This member must be set to a function pointer which will be called whenever
Hollywood is about to run the callback that the user has installed for the
event using <code>InstallEventHandler()</code>. The function you specify here may then push
additional values on the stack. Note that in comparison to events of type <code>HWEVTHANDLER_STANDARD</code>,
Hollywood won't push any values on the stack for custom events. There will also
be no table on the stack as it is the case with <code>HWEVTHANDLER_STANDARD</code>. Instead, your
plugin is given complete control over what the stack should look like when
Hollywood runs the user callback. For consistency reasons, however, it is
advised that you push a table, set the <code>Action</code> field to the name of your
event and then store all additional values inside that table. You should
only deviate from this standard if you have very good reason to do so.

<p>
</dd>
<dt class="codelist"><code>PostCall:</code></dt>
<dd>
This member must be set to a function that should be called immediately after
Hollywood has finished running the user callback registered for this event
type.

<p>
</dd>
<dt class="codelist"><code>FreeEvent:</code></dt>
<dd>
This member must be set to a function that should act as a destructor for
this event type. Hollywood will call this function whenever it has to free
an event of your type.
</dd></dl>

<p>
Note that you must provide functions for all of the structure members above,
even if they don't do anything. No structure member must be <code>NULL</code>. The user data
that is passed to all the functions above as the third parameter is the same
pointer that you provided in the call to <a href="hw_PostEvent.html">hw_PostEvent()</a>
or <a href="hw_PostEventEx.html">hw_PostEventEx()</a> when you posted the event.
</dd></dl>

<p>
</dd>
<dt class="autodoc"><b>Designer compatibility</b></dt><dd>
Unsupported

<p>
</dd>
<dt class="autodoc"><b>Inputs</b></dt><dd>
<dl>
<dt><i>name</i></dt>
<dd>name for the new event type (see above for limitations in the event name format)</dd>
<dt><i>type</i></dt>
<dd>desired event type (see above for supported types)</dd>
<dt><i>data</i></dt>
<dd>event type dependent data (see above for details)</dl>
</dd>
<dt class="autodoc"><b>Results</b></dt><dd>
<dl>
<dt><i>id</i></dt>
<dd>identifier of the new event handler or 0 on error</dd></dl>
</dd></dl>
<hr>
<font size=-2><a href="hw_RegisterEventHandlerEx_.html" target="_top">Show TOC</a></font>
</body>
</html>