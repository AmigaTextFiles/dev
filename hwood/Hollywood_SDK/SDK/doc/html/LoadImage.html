<html>
<!-- generated from hollywood_sdk.meta by MetaDoc 1.13 (c) by Andreas Falkenhahn -->
<head>
<title>LoadImage</title>
<meta name="author" content="Andreas Falkenhahn">
<meta name="generator" content="MetaDoc 1.13">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<style type="text/css">
<!--
body {font-family: sans-serif;}
ul.toc {list-style: none; margin-left: 20px; padding-left: 0px;}
dt.autodoc {font-variant: small-caps; font-size: larger; margin-top: 10px; margin-bottom: 10px; padding-left: 0.2em; padding-top: 0.2em; padding-bottom: 0.2em;
	background-color: #bae1ff; border-width: 1px; border-color: #3baaff; border-style: solid;}
dt.codelist {margin-bottom: 0.2em;}
h2.heading {background-color: #bae1ff; font-family: Arial; padding-top: 0.4em; padding-bottom: 0.4em;}
code {background-color: #f2f2f2; padding: 2px 4px; font-weight: bold;}
pre {background-color: #f2f2f2; border: 1px solid #ddd; padding: 0.3em;}
		
-->
</style>
</head>
<body bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#0000FF" alink="#0000FF">
<dl>
<dt class="autodoc"><b>Name</b></dt><dd>
LoadImage -- load image into memory (V5.0)</dd>
<dt class="autodoc"><b>Synopsis</b></dt><dd>
<pre>
APTR handle = LoadImage(STRPTR filename, struct LoadImageCtrl *ctrl);</pre>
</dd>
<dt class="autodoc"><b>Function</b></dt><dd>
This function has to open the specified filename, check if it is in a format that
the plugin wants to handle, and, if it is, return a handle to the image back to
Hollywood. Otherwise it has to return <code>NULL</code>. The handle returned by <code>LoadImage()</code> is
an opaque datatype that only your plugin knows about. Hollywood will simply pass
this handle back to your <a href="GetImage.html">GetImage()</a> function when it wants to
have the raw pixel data.

<p>
This function also has to provide certain information about the image it
has just loaded. This information has to be written to the <code>struct LoadImageCtrl</code>
that is passed in the second parameter. This structure looks like this:

<p>
<table cellpadding="0" cellspacing="0"><tr><td>&nbsp;</td><td><pre>struct LoadImageCtrl
{
    int Width;                      // [out]
    int Height;                     // [out]
    int LineWidth;                  // [out]
    int AlphaChannel;               // [out]
    int ForceAlphaChannel;          // [out]
    int Type;                       // [out]
    ULONG Flags;                    // [in/out] -- V5.3
    int ScaleWidth;                 // [in]     -- V5.3
    int ScaleHeight;                // [in]     -- V5.3
    int BaseWidth;                  // [out]    -- V5.3
    int BaseHeight;                 // [out]    -- V5.3
    ULONG ScaleMode;                // [in]     -- V5.3
    STRPTR Adapter;                 // [in]     -- V6.0
    ULONG *Palette;                 // [unused] -- V9.0
    ULONG TransPen;                 // [out]    -- V9.0
    int Depth;                      // [out]    -- V9.0
    struct hwUserTagList *UserTags; // [in]     -- V10.0
};
</pre></td></tr></table><p>

<b>Be careful when accessing above structure members: LoadImageCtrl has seen several
revisions in Hollywood's history. Before accessing members that haven't been there
in all Hollywood versions you must make sure that your plugin has been opened
by a Hollywood version that has those members or you will access unallocated memory!</b>

<p>
The following information has to be provided by <code>LoadImage()</code>:

<p>
<dl>
<dt class="codelist"><code>Type:</code></dt>
<dd>
This must be set to either <code>HWIMAGETYPE_RASTER</code> or <code>HWIMAGETYPE_VECTOR</code>.
If you set this to <code>HWIMAGETYPE_VECTOR</code>, Hollywood will call your <a href="TransformImage.html">TransformImage()</a>
function whenever it needs to transform the image. This allows you to do lossless
transformation of the vector image. For images of type <code>HWIMAGETYPE_RASTER</code>,
<a href="TransformImage.html">TransformImage()</a> is never called. Instead, Hollywood does
all transformations itself.

<p>
</dd>
<dt class="codelist"><code>Width:</code></dt>
<dd>
Must be set to the image width in pixels.

<p>
</dd>
<dt class="codelist"><code>Height:</code></dt>
<dd>
Must be set to the image height in pixels.

<p>
</dd>
<dt class="codelist"><code>Depth:</code></dt>
<dd>
Must be set to the image's bit depth. (V9.0)

<p>
</dd>
<dt class="codelist"><code>LineWidth:</code></dt>
<dd>
Must be set to the image modulo width in pixels. This is often the same as the
image width.

<p>
</dd>
<dt class="codelist"><code>AlphaChannel:</code></dt>
<dd>
Must be set to <code>True</code> or <code>False</code>, depending on whether or not this image has an
alpha channel.

<p>
</dd>
<dt class="codelist"><code>ForceAlphaChannel:</code></dt>
<dd>
If this is set to <code>True</code>, Hollywood will automatically create an alpha channel for
all objects that load this image. For example, if the user calls <code>LoadBrush()</code>
on your image but does not set the <code>LoadAlpha</code> tag to <code>True</code>, the brush will still
get an alpha channel if you set <code>ForceAlphaChannel</code> to <code>True</code>.

<p>
</dd>
<dt class="codelist"><code>Flags:</code></dt>
<dd>
The following flags may be set by Hollywood:

<p>
<dl>
<dt class="codelist"><code>HWIMGFLAGS_TRANSPARENCY:</code></dt>
<dd>
This flag will be set whenever the user sets the <code>LoadTransparency</code> tag to <code>True</code>. If
<code>HWIMGFLAGS_LOADPALETTE</code> is set as well (see below), you must return the pen that is
transparent in the <code>TransPen</code> member of <code>struct LoadImageCtrl</code>. If <code>HWIMGFLAGS_LOADPALETTE</code>
is not set, you have to write the image's transparency information to its alpha channel
and set the <code>ForceAlphaChannel</code> member to <code>True</code>. See above for more information. (V6.0)

<p>
</dd>
<dt class="codelist"><code>HWIMGFLAGS_LOADPALETTE:</code></dt>
<dd>
This flag will be set whenever the user sets the <code>LoadPalette</code> tag to <code>True</code>. If this
flag is set, your implementation of <code>LoadImage()</code> should fail in case the image does
not have a palette. If it has a palette, you have to return that palette when
Hollywood calls your <a href="GetImage.html">GetImage()</a> implementation. Note that
palette images must always use <code>HWIMAGETYPE_RASTER</code>. They may not register as vector
images. (V9.0)
</dd></dl>

<p>
The following flags may be set by your implementation:

<p>
<dl>
<dt class="codelist"><code>HWIMGFLAGS_DIDSCALE:</code></dt>
<dd>
If your plugin has scale-loaded this image, you have to set the <code>HWIMGFLAGS_DIDSCALE</code>
flag here so that Hollywood knows that your plugin has loaded and scaled the image.
See below for more information on scaled loading of images. (V5.3)
</dd></dl>

<p>
</dd>
<dt class="codelist"><code>Adapter:</code></dt>
<dd>
Starting with Hollywood 6.0 users can specify the file adapter that should be used
to open certain files. If this member is non-<code>NULL</code>, Hollywood wants your plugin to
use the file adapter specified in <code>Adapter</code> to open the image. This means that you
have to use <a href="hw_FOpenExt.html">hw_FOpenExt()</a> instead of <a href="hw_FOpen.html">hw_FOpen()</a>
to open the image. Make sure to check for Hollywood 6.0 before trying to access
this member because it isn't there in previous versions. See <a href="hw_FOpenExt.html">hw_FOpenExt</a> for details. (V6.0)

<p>
</dd>
<dt class="codelist"><code>TransPen:</code></dt>
<dd>
If <code>HWIMGFLAGS_LOADPALETTE</code> and <code>HWIMGFLAGS_TRANSPARENCY</code> are set and the image has
a transparent pen, set <code>TransPen</code> to the index of that transparent pen. Otherwise
set this member to <code>HWPEN_NONE</code>. (V9.0)
</dd></dl>

<p>
Starting with Hollywood 5.3 <code>LoadImage()</code> also supports scaled loading of images.
This is optional functionality and need not be supported by <code>LoadImage()</code>. If you
want to support it, you have to look at the members <code>ScaleWidth</code> and <code>ScaleHeight</code>
of the <code>struct LoadImageCtrl</code> pointer that is passed to <code>LoadImage()</code>.
<b>Warning! Make sure that you access these members only if you have checked that
your plugin has been opened by version 5.3 or higher of Hollywood. Otherwise, these
members won't be there and trying to access them will read from bad memory locations
and give you back random values</b>. So if you want to implement support for scaled loading
of images, first check for Hollywood 5.3 and then take a look at the following members
of the <code>struct LoadImageCtrl</code>:

<p>
<dl>
<dt class="codelist"><code>ScaleWidth:</code></dt>
<dd>
If Hollywood wants your plugin to scale the image while loading, this member
will be set to either a positive or negative integer. A positive integer value
specifies the desired width in pixels for this image while a negative integer
value is to be interpreted as a percentage value specifying the desired scaling
factor relative to the original image width, i.e. &quot;-75&quot; means that the image
should be scaled to 75% of its original width. If <code>ScaleWidth</code> is 0,
Hollywood doesn't want to have any scaling. (V5.3)

<p>
</dd>
<dt class="codelist"><code>ScaleHeight:</code></dt>
<dd>
This works in the same way as described above for <code>ScaleWidth</code> except
that it deals with the image height. (V5.3)

<p>
</dd>
<dt class="codelist"><code>ScaleMode:</code></dt>
<dd>
Contains the ID of a scale mode. Currently, this can be either 0 for hard scaling
or 1 for interpolated scaling using anti-aliasing. (V5.3)

<p>
</dd>
<dt class="codelist"><code>BaseWidth:</code></dt>
<dd>
If your plugin supports scaled loading, you need to set this member to the
original width of the image. This is important because otherwise Hollywood
won't know the original size of the image as the <code>Width</code> member needs
to be set to the scaled width if you do scaling. (V5.3)

<p>
</dd>
<dt class="codelist"><code>BaseHeight:</code></dt>
<dd>
Same as <code>BaseWidth</code> but for the image height. (V5.3)

<p>
</dd>
<dt class="codelist"><code>UserTags:</code></dt>
<dd>
This member will be set to a list of user tags in case they were specified
in the Hollywood script. User tags are a way of passing additional information
from Hollywood scripts to plugin functions. Note that even if your plugin doesn't
support any user tags, you should still look for this tag and pass the user
tags to <a href="hw_FOpenExt.html">hw_FOpenExt</a> because the user tags passed in <code>UserTags</code> could
also be intended for another plugin, namely the file adapter plugin passed
in <code>Adapter</code>. See <a href="UserTags.html">User tags</a> for details. Make sure to check for Hollywood 10.0
before trying to access this member because it isn't there in previous versions.
(V10.0)
</dd></dl>

<p>
Please note that you should not use ANSI C functions like <code>fopen()</code> to
open the file that is passed to this function because the filename that is passed
to this function can also be a specially formatted filename specification that
Hollywood uses to load files that have been linked to applets or executables. In
order to be able to load these files correctly, you have to use special IO functions
provided by Hollywood. See <a href="FileIO.html">File IO information</a> for details.

<p>
</dd>
<dt class="autodoc"><b>Inputs</b></dt><dd>
<dl>
<dt><i>filename</i></dt>
<dd>filename to open</dd>
<dt><i>ctrl</i></dt>
<dd>pointer to a <code>struct LoadImageCtrl</code> for storing information
about the image</dl>
</dd>
<dt class="autodoc"><b>Results</b></dt><dd>
<dl>
<dt><i>handle</i></dt>
<dd>a handle that identifies this image or <code>NULL</code> if plugin doesn't
want to handle this image</dd></dl>
</dd></dl>
<hr>
<font size=-2><a href="LoadImage_.html" target="_top">Show TOC</a></font>
</body>
</html>