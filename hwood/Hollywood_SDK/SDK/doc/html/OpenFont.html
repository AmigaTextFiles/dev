<html>
<!-- generated from hollywood_sdk.meta by MetaDoc 1.13 (c) by Andreas Falkenhahn -->
<head>
<title>OpenFont</title>
<meta name="author" content="Andreas Falkenhahn">
<meta name="generator" content="MetaDoc 1.13">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<style type="text/css">
<!--
body {font-family: sans-serif;}
ul.toc {list-style: none; margin-left: 20px; padding-left: 0px;}
dt.autodoc {font-variant: small-caps; font-size: larger; margin-top: 10px; margin-bottom: 10px; padding-left: 0.2em; padding-top: 0.2em; padding-bottom: 0.2em;
	background-color: #bae1ff; border-width: 1px; border-color: #3baaff; border-style: solid;}
dt.codelist {margin-bottom: 0.2em;}
h2.heading {background-color: #bae1ff; font-family: Arial; padding-top: 0.4em; padding-bottom: 0.4em;}
code {background-color: #f2f2f2; padding: 2px 4px; font-weight: bold;}
pre {background-color: #f2f2f2; border: 1px solid #ddd; padding: 0.3em;}
		
-->
</style>
</head>
<body bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#0000FF" alink="#0000FF">
<dl>
<dt class="autodoc"><b>Name</b></dt><dd>
OpenFont -- create FreeType2 font from memory buffer (V5.0)</dd>
<dt class="autodoc"><b>Synopsis</b></dt><dd>
<pre>
FT_Face face = OpenFont(UBYTE *data, int datalen);</pre>
</dd>
<dt class="autodoc"><b>Function</b></dt><dd>
This function has to create an <code>FT_Face</code> handle from the raw font data passed to it.
You only need to implement this function if you build plugins for WarpOS or if the
<code>HWEXT_VECTOR_CUSTOMFT2</code> extension bit has been set. If neither is the case, your <code>OpenFont()</code>
implementation can just return <code>NULL</code> because it will never be called.

<p>
The reason why this function is needed on WarpOS is that the WarpOS version of Hollywood
contains two builds of FreeType2: one for 68020 and one for the PowerPC architecture.
Plugins will always have to work with the PPC native version to avoid context switches.
Hollywood itself, however, uses the 68020 build of FreeType2 because it's faster in most
cases because Hollywood doesn't have to do any context switches. Using the <code>FT_Face</code>
handle allocated by the 68020 version of FreeType2 is not going to work with the
PowerPC version of FreeType2, though, due to different structure alignments, etc. That is why
you need to use the PowerPC version of FreeType2 on WarpOS to create a compatible <code>FT_Face</code>
handle which is then passed to <a href="CreateVectorFont.html">CreateVectorFont()</a>.

<p>
Plugins that use their own FreeType2 version are in the same situation as with WarpOS
(see above): Their <code>FT_Face</code> won't be compatible with Hollywood's <code>FT_Face</code> which is why
they need to implement <code>OpenFont()</code> as well and they also need to set the <code>HWEXT_VECTOR_CUSTOMFT2</code>
extension bit to tell Hollywood that they use a custom implementation of FreeType2.
See <a href="ExtensionOverview.html">Extension plugins</a> to learn how to use plugin extension bits.

<p>
Basically, all <code>OpenFont()</code> has to do is the following:

<p>
<table cellpadding="0" cellspacing="0"><tr><td>&nbsp;</td><td><pre>HW_EXPORT FT_Face OpenFont(UBYTE *data, int datalen)
{
    FT_Face face;

    if(FT_New_Memory_Face(freetype_library, data,
           datalen, 0, &amp;face)) return NULL;

    return face;
}

HW_EXPORT void CloseFont(FT_Face face)
{
    FT_Done_Face(face);
}
</pre></td></tr></table><p>

Note that on WarpOS those functions needn't even use their own version of FreeType2
but they could just call into Hollywood's FreeType2 functions located in <code>FT2Base</code>.

<p>
Hollywood will call <a href="CloseFont.html">CloseFont()</a> to free handles allocated by this
function.

<p>
</dd>
<dt class="autodoc"><b>Inputs</b></dt><dd>
<dl>
<dt><i>data</i></dt>
<dd>pointer to raw font data (usually pointer to TrueType font data)</dd>
<dt><i>datalen</i></dt>
<dd>size of the <code>data</code> buffer in bytes</dl>
</dd>
<dt class="autodoc"><b>Results</b></dt><dd>
<dl>
<dt><i>face</i></dt>
<dd>handle to an <code>FT_Face</code> allocated by the custom version of FreeType2 or <code>NULL</code> in case of an error</dd></dl>
</dd></dl>
<hr>
<font size=-2><a href="OpenFont_.html" target="_top">Show TOC</a></font>
</body>
</html>