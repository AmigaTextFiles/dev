<html>
<!-- generated from hollywood_sdk.meta by MetaDoc 1.13 (c) by Andreas Falkenhahn -->
<head>
<title>Designer compatibility</title>
<meta name="author" content="Andreas Falkenhahn">
<meta name="generator" content="MetaDoc 1.13">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<style type="text/css">
<!--
body {font-family: sans-serif;}
ul.toc {list-style: none; margin-left: 20px; padding-left: 0px;}
dt.autodoc {font-variant: small-caps; font-size: larger; margin-top: 10px; margin-bottom: 10px; padding-left: 0.2em; padding-top: 0.2em; padding-bottom: 0.2em;
	background-color: #bae1ff; border-width: 1px; border-color: #3baaff; border-style: solid;}
dt.codelist {margin-bottom: 0.2em;}
h2.heading {background-color: #bae1ff; font-family: Arial; padding-top: 0.4em; padding-bottom: 0.4em;}
code {background-color: #f2f2f2; padding: 2px 4px; font-weight: bold;}
pre {background-color: #f2f2f2; border: 1px solid #ddd; padding: 0.3em;}
		
-->
</style>
</head>
<body bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#0000FF" alink="#0000FF">
<h2 class="heading">2.19 Designer compatibility</h2>

<p>
Hollywood Designer, the WYSIWYG editor for Hollywood scripts, also supports Hollywood plugins.
However, it supports only a fraction of Hollywood's plugin API. Thus, you need to be very
careful when calling plugin API functions because they might not be available when Hollywood
Designer has opened your plugin.

<p>
The first version of Hollywood Designer that supports Hollywood plugins is version 4.0.
Hollywood Designer supports the following plugin types:

<p>
<dl>
<dt class="codelist"><code>HWPLUG_CAPS_IMAGE</code></dt>
<dd>
Plugin provides a loader for additional image formats. See <a href="ImageOverview.html">Image plugins</a> for details.

<p>
</dd>
<dt class="codelist"><code>HWPLUG_CAPS_ANIM</code></dt>
<dd>
Plugin provides a loader for additional animation formats. See <a href="AnimOverview.html">Animation plugins</a> for details.

<p>
</dd>
<dt class="codelist"><code>HWPLUG_CAPS_VIDEO</code></dt>
<dd>
Plugin provides a loader for additional video formats. See <a href="VideoOverview.html">Video plugins</a> for details.

<p>
</dd>
<dt class="codelist"><code>HWPLUG_CAPS_SAVEIMAGE</code></dt>
<dd>
Plugin provides a saver for additional image formats. See <a href="ImageSaverOverview.html">Image saver plugins</a> for details.
</dd></dl>

<p>
All the other plugin types are currently unsupported. Thus, you don't have to be careful
about which plugin API functions you call if your plugin is of a type that Designer doesn't
support anyway. Be careful about the <a href="InitPlugin.html">InitPlugin()</a> and <a href="ClosePlugin.html">ClosePlugin()</a>
functions, though. These will be called for all plugins so you must be very careful about
the plugin API functions you call from these functions.

<p>
Let's suppose you are going to write a plugin that adds an image loader and a file adapter.
In that case you would set <code>hwPluginBase.CapsMask</code> to <code>HWPLUG_CAPS_IMAGE|HWPLUG_CAPS_FILEADAPTER</code>.
File adapters usually call <a href="hw_ConfigureLoaderAdapter.html">hw_ConfigureLoaderAdapter()</a> from
their <a href="InitPlugin.html">InitPlugin()</a> implementation. <a href="hw_ConfigureLoaderAdapter.html">hw_ConfigureLoaderAdapter()</a>,
however, is not supported by Designer because Designer doesn't support file adapters.
That's why you have to check if Hollywood or Hollywood Designer has opened your plugin before
you call <a href="hw_ConfigureLoaderAdapter.html">hw_ConfigureLoaderAdapter()</a>. You can check
for Hollywood Designer by looking at the first function of <code>LuaBase</code> and see if it is <code>NULL</code>.
If it is, you can be sure that you are being called by Hollywood Designer. Your implementation
of <a href="InitPlugin.html">InitPlugin()</a> could then look like this:

<p>
<table cellpadding="0" cellspacing="0"><tr><td>&nbsp;</td><td><pre>HW_EXPORT int InitPlugin(hwPluginBase *self, hwPluginAPI *cl, STRPTR p)
{
    int isdesigner = (cl &amp;&amp; cl-&gt;LuaBase-&gt;lua_gettop == NULL);

    self-&gt;CapsMask = HWPLUG_CAPS_IMAGE|HWPLUG_CAPS_FILEADAPTER;
    self-&gt;hwVersion = 1;
    self-&gt;hwRevision = 0;
    ...

    if(cl) {
        if(!isdesigner) cl-&gt;SysBase-&gt;hw_ConfigureLoaderAdapter(...);
    }

    return TRUE;
}
</pre></td></tr></table><p>

The code above will only call <a href="hw_ConfigureLoaderAdapter.html">hw_ConfigureLoaderAdapter()</a> if
<a href="InitPlugin.html">InitPlugin()</a> has been called by Hollywood. If you don't do this check,
Hollywood Designer will crash on every startup because your plugin tries to jump to a function
that is <code>NULL</code>. So make sure your <a href="InitPlugin.html">InitPlugin()</a> implementation is compatible
with Hollywood Designer.

<p>
To find out which plugin APIs are supported by Hollywood Designer, look at the &quot;Designer compatibility&quot;
section that is part of every function's documentation.

<p>
To find out which version of Hollywood Designer is calling you, you must use the <code>HWMCP_GETDESIGNERVERSION</code>
tag with the <a href="hw_MasterControl.html">hw_MasterControl()</a> function. It is not sufficient to look at
the <code>hwVersion</code> and <code>hwRevision</code> members of the <code>hwPluginBase</code> that is passed to your <a href="InitPlugin.html">InitPlugin()</a>
implementation because these just contain the version of the Hollywood plugin API provided by the Designer
version that is calling your plugin. For example, Designer 4.0 will identify itself as Hollywood 5.0
whereas Designer 5.0 will identify itself as Hollywood 8.0. To get the real Designer version numbers,
use <code>HWMCP_GETDESIGNERVERSION</code>. See <a href="hw_MasterControl.html">hw_MasterControl</a> for details.

<p>
<hr>
<font size=-2><a href="DesignerCompatibility_.html" target="_top">Show TOC</a></font>
</body>
</html>