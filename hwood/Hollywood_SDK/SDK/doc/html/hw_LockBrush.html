<html>
<!-- generated from hollywood_sdk.meta by MetaDoc 1.13 (c) by Andreas Falkenhahn -->
<head>
<title>hw_LockBrush</title>
<meta name="author" content="Andreas Falkenhahn">
<meta name="generator" content="MetaDoc 1.13">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<style type="text/css">
<!--
body {font-family: sans-serif;}
ul.toc {list-style: none; margin-left: 20px; padding-left: 0px;}
dt.autodoc {font-variant: small-caps; font-size: larger; margin-top: 10px; margin-bottom: 10px; padding-left: 0.2em; padding-top: 0.2em; padding-bottom: 0.2em;
	background-color: #bae1ff; border-width: 1px; border-color: #3baaff; border-style: solid;}
dt.codelist {margin-bottom: 0.2em;}
h2.heading {background-color: #bae1ff; font-family: Arial; padding-top: 0.4em; padding-bottom: 0.4em;}
code {background-color: #f2f2f2; padding: 2px 4px; font-weight: bold;}
pre {background-color: #f2f2f2; border: 1px solid #ddd; padding: 0.3em;}
		
-->
</style>
</head>
<body bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#0000FF" alink="#0000FF">
<dl>
<dt class="autodoc"><b>Name</b></dt><dd>
hw_LockBrush -- gain access to the raw pixels of a brush (V5.0)</dd>
<dt class="autodoc"><b>Synopsis</b></dt><dd>
<pre>
APTR handle = hw_LockBrush(lua_ID *id, struct hwTagList *tags,
                  struct hwos_LockBrushStruct *brlock);</pre>
</dd>
<dt class="autodoc"><b>Function</b></dt><dd>
This function locks the specified brush and allows you to access its raw pixel
data. You have to pass the object identifier of the brush you want to lock as a
<code>lua_ID</code>. See <a href="LuaID.html">Object identifiers</a> for details.

<p>
You also have to pass a pointer to a <code>struct hwos_LockBrushStruct</code> which
will be filled with all the information you need by <code>hw_LockBrush()</code>. <code>struct hwos_LockBrushStruct</code>
looks like this:

<p>
<table cellpadding="0" cellspacing="0"><tr><td>&nbsp;</td><td><pre>struct hwos_LockBrushStruct
{
    APTR RGBData;        // [out]
    int RGBModulo;       // [out]
    UBYTE *AlphaData;    // [out]
    int AlphaModulo;     // [out]
    UBYTE *MaskData;     // [out]
    int MaskModulo;      // [out]
    int PixelFormat;     // [out]
    int BytesPerPixel;   // [out]
    int Width;           // [out]
    int Height;          // [out]
    UBYTE *CLUTData;     // [out] -- V9.0
    int CLUTModulo;      // [out] -- V9.0
    ULONG *Palette;      // [out] -- V9.0
    ULONG TransPen;      // [out] -- V9.0
    int Depth;           // [out] -- V9.0
};
</pre></td></tr></table><p>

<code>hw_LockBrush()</code> will write to the structure members as follows:

<p>
<dl>
<dt class="codelist"><code>RGBData:</code></dt>
<dd>
This member will be set to a pointer to the raw RGB pixel data. The actual format used
by the individual pixels is determined by the <code>PixelFormat</code> member. Please note that
even if a 32-bit pixel format is used, <code>RGBData</code> will never contain any alpha channel
information because Hollywood always stores the alpha channel separately in order to
be compatible with 15-bit and 16-bit screenmodes. See <a href="BitmapInfo.html">Bitmap information</a> for details.
This member will only be set if the brush is an RGB brush. For palette brushes, the
pixel data will be returned in <code>CLUTData</code> (see below).

<p>
</dd>
<dt class="codelist"><code>RGBModulo:</code></dt>
<dd>
This contains the number of pixels in a single row. This can be more than returned in
<code>Width</code> because Hollywood might choose to allocate some padding bytes for optimized
blitting. Note that the value returned in <code>RGBModulo</code> is specified in pixels, not in
bytes. This member will only be set if the brush is an RGB brush. For palette brushes, the
modulo will be returned in <code>CLUTModulo</code> (see below).

<p>
</dd>
<dt class="codelist"><code>AlphaData:</code></dt>
<dd>
If the brush contains an alpha channel, this member is set to the raw alpha channel
data as an array of unsigned bytes. Otherwise this member will be set to <code>NULL</code>.

<p>
</dd>
<dt class="codelist"><code>AlphaModulo:</code></dt>
<dd>
If the brush contains an alpha channel, this member will be set to the number of
pixels stored in one row of the <code>AlphaData</code> array. This can be more than what has
been returned in the <code>Width</code> member because Hollywood might use padding bytes for
optimized blitting.

<p>
</dd>
<dt class="codelist"><code>MaskData:</code></dt>
<dd>
If the brush contains a mask, this member will be set to the raw mask bits. Otherwise
it is set to <code>NULL</code>. Hollywood masks only know two different states: visible (1) and
invisible (0) pixels. The bits are stored from left to right in chunks of one byte,
i.e. the most significant bit of the first byte describes the transparency setting
for the first pixel.

<p>
</dd>
<dt class="codelist"><code>MaskModulo:</code></dt>
<dd>
If the brush contains a mask, this member will be set to the number of bytes that is
used for one row of mask data. Note that this value is specified in bytes and often
contains some padding.

<p>
</dd>
<dt class="codelist"><code>PixelFormat:</code></dt>
<dd>
This member is set to the pixel format used by the pixel array written to the
<code>RGBData</code> member. See <a href="PixelFormats.html">Pixel format information</a> for details.

<p>
</dd>
<dt class="codelist"><code>BytesPerPixel:</code></dt>
<dd>
This will be set to the number of bytes that are needed to represent one pixel
in the <code>RGBData</code> array.

<p>
</dd>
<dt class="codelist"><code>Width:</code></dt>
<dd>
This will be set to the brush's actual width, without any row padding.

<p>
</dd>
<dt class="codelist"><code>Height:</code></dt>
<dd>
This will be set to the brush's actual height.

<p>
</dd>
<dt class="codelist"><code>CLUTData:</code></dt>
<dd>
If the brush is a palette brush, this will be set to the raw pixel data.
Note that pixels will always be stored as 8 bits per pixel, even if the
palette brush's depth is less than 8. Also note that palette brushes are
only supported if you set the <code>HWLBRSHTAG_PALETTE</code> tag to <code>True</code> (see below).
This is necessary to maintain compatibility with older versions of Hollywood.
The <code>CLUTData</code> member (and the other members required for palette support,
see below) are new in Hollywood 9.0 so of course Hollywood may only
write to these fields if it knows that the caller has allocated member for
them.
(V9.0)

<p>
</dd>
<dt class="codelist"><code>CLUTModulo:</code></dt>
<dd>
If the brush is a palette brush, this will be set to the number of pixels
per row. This is often identical to <code>Width</code>. (V9.0)

<p>
</dd>
<dt class="codelist"><code>Palette:</code></dt>
<dd>
If the brush is a palette brush, this will be set to a pointer to an array
of <code>ULONGs</code> which contains the palette colors for the brush. The palette
colors are stored as raw RGB values. (V9.0)

<p>
</dd>
<dt class="codelist"><code>TransPen:</code></dt>
<dd>
If the brush is a palette brush and has a transparent pen, this pen will
be returned in this member. (V9.0)

<p>
</dd>
<dt class="codelist"><code>Depth:</code></dt>
<dd>
This will be set to the brush's depth. Note that this member will only
ever be set if you set the <code>HWLBRSHTAG_DEPTH</code> tag to <code>True</code> (see below).
This is necessary to maintain compatibility with older versions of Hollywood.
The <code>Depth</code> member is new in Hollywood 9.0 so of course Hollywood may only
write to this field if it knows that the caller has allocated member for
it. (V9.0)
</dd></dl>

<p>
The following tags can be passed in tag list parameter:

<p>
<dl>
<dt class="codelist"><code>HWLBRSHTAG_READONLY:</code></dt>
<dd>
If you set the <code>iData</code> member of this tag item to <code>True</code>, the brush will be locked
for read-only access. This might be faster with some bitmap backends. By
default, the brush is locked for read and write access. (V6.0)

<p>
</dd>
<dt class="codelist"><code>HWLBRSHTAG_PALETTE:</code></dt>
<dd>
If you want <code>hw_LockBrush()</code> to support palette brushes as well, you need to set
the <code>iData</code> member of this tag item to <code>True</code>. Otherwise only RGB brushes will
be supported and the fields in <code>struct hwos_LockBrushStruct</code> that
are new in Hollywood 9.0 will never be touched. Explicitly requesting palette
support via the <code>HWLBRSHTAG_PALETTE</code> tag is necessary to maintain compatibility
with previous versions of Hollywood. (V9.0)

<p>
</dd>
<dt class="codelist"><code>HWLBRSHTAG_DEPTH:</code></dt>
<dd>
If you want <code>hw_LockBrush()</code> to return the brush depth in the <code>Depth</code> field of
<code>struct hwos_LockBrushStruct</code>, you need to set the <code>iData</code> member of
this tag item to <code>True</code>. Otherwise the <code>Depth</code> member in <code>struct hwos_LockBrushStruct</code>
will never be touched. This is necessary to maintain compatibility with
older versions of Hollywood which didn't have the <code>Depth</code> field. (V9.0)
</dd></dl>

<p>
Do not hold brush locks longer than necessary. In particular, do not return control to
the script while holding a brush lock because the script might try to modify the
brush then and this will lead to trouble in case the brush is still locked. You
should call <a href="hw_UnLockBrush.html">hw_UnLockBrush()</a> as soon as possible.

<p>
Note that <code>hw_LockBrush()</code> can only be used with software brushes. It is not possible
to access the raw pixels of hardware brushes.

<p>
If you only need to read a brush's raw pixel data, it might be more convenient
to use the <a href="hw_GetARGBBrush.html">hw_GetARGBBrush()</a> function instead. This will
give you the pixels as readily formatted 32-bit ARGB values. The downside is that
<a href="hw_GetARGBBrush.html">hw_GetARGBBrush()</a> is slower because it needs to copy and
convert the pixels first. See <a href="hw_GetARGBBrush.html">hw_GetARGBBrush</a> for details.

<p>
</dd>
<dt class="autodoc"><b>Designer compatibility</b></dt><dd>
Unsupported

<p>
</dd>
<dt class="autodoc"><b>Inputs</b></dt><dd>
<dl>
<dt><i>id</i></dt>
<dd>object identifier of brush to be locked</dd>
<dt><i>tags</i></dt>
<dd>pointer to a taglist specifying additional options (see above) or <code>NULL</code></dd>
<dt><i>brlock</i></dt>
<dd>pointer to a <code>struct hwos_LockBrushStruct</code> that is to be filled
by this function</dl>
</dd>
<dt class="autodoc"><b>Results</b></dt><dd>
<dl>
<dt><i>handle</i></dt>
<dd>handle to the locked brush or <code>NULL</code> on error</dd></dl>
</dd></dl>
<hr>
<font size=-2><a href="hw_LockBrush_.html" target="_top">Show TOC</a></font>
</body>
</html>