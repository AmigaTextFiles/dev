<html>
<!-- generated from hollywood_sdk.meta by MetaDoc 1.13 (c) by Andreas Falkenhahn -->
<head>
<title>OpenVideo</title>
<meta name="author" content="Andreas Falkenhahn">
<meta name="generator" content="MetaDoc 1.13">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<style type="text/css">
<!--
body {font-family: sans-serif;}
ul.toc {list-style: none; margin-left: 20px; padding-left: 0px;}
dt.autodoc {font-variant: small-caps; font-size: larger; margin-top: 10px; margin-bottom: 10px; padding-left: 0.2em; padding-top: 0.2em; padding-bottom: 0.2em;
	background-color: #bae1ff; border-width: 1px; border-color: #3baaff; border-style: solid;}
dt.codelist {margin-bottom: 0.2em;}
h2.heading {background-color: #bae1ff; font-family: Arial; padding-top: 0.4em; padding-bottom: 0.4em;}
code {background-color: #f2f2f2; padding: 2px 4px; font-weight: bold;}
pre {background-color: #f2f2f2; border: 1px solid #ddd; padding: 0.3em;}
		
-->
</style>
</head>
<body bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#0000FF" alink="#0000FF">
<dl>
<dt class="autodoc"><b>Name</b></dt><dd>
OpenVideo -- open a video file (V5.0)</dd>
<dt class="autodoc"><b>Synopsis</b></dt><dd>
<pre>
APTR handle = OpenVideo(STRPTR filename, struct OpenVideoCtrl *ctrl);</pre>
</dd>
<dt class="autodoc"><b>Function</b></dt><dd>
This function has to open the specified filename, check if it is in a video file
format that the plugin wants to handle, and, if it is, return a handle to the video file
back to Hollywood. Otherwise it has to return <code>NULL</code>. The handle returned by <code>OpenVideo()</code> is
an opaque datatype that only your plugin knows about. Hollywood will simply pass
this handle back to your <a href="NextPacket.html">NextPacket()</a> function when it wants to
have the individual packets of the video file.

<p>
This function also has to provide certain information about the video file it
has just opened. This information has to be written to the <code>struct OpenVideoCtrl</code>
that is passed in the second parameter. This structure looks like this:

<p>
<table cellpadding="0" cellspacing="0"><tr><td>&nbsp;</td><td><pre>struct OpenVideoCtrl
{
    int Width;                      // [out]
    int Height;                     // [out]
    ULONG Duration;                 // [out]
    int Frequency;                  // [out]
    int Channels;                   // [out]
    int SeekMode;                   // [out]
    int BitRate;                    // [out]
    int PixFmt;                     // [out]
    ULONG Flags;                    // [out]
    int Pad;                        // [unused]
    double FrameTime;               // [out]
    DOSINT64 FileSize;              // [out] -- V6.0
    STRPTR Adapter;                 // [in]  -- V6.0
    struct hwUserTagList *UserTags; // [in]  -- V10.0
};
</pre></td></tr></table><p>

The following information has to be written to the <code>struct OpenVideoCtrl</code> pointer
by <code>OpenVideo()</code>:

<p>
<dl>
<dt class="codelist"><code>Width:</code></dt>
<dd>
Frame width in pixels.

<p>
</dd>
<dt class="codelist"><code>Height:</code></dt>
<dd>
Frame height in pixels.

<p>
</dd>
<dt class="codelist"><code>Duration:</code></dt>
<dd>
Duration of the video stream in milliseconds.

<p>
</dd>
<dt class="codelist"><code>Frequency:</code></dt>
<dd>
The number of PCM frames that should be played per second. Usually 44100
or 48000. If there is no audio stream accompanying the video stream, set
this to 0.

<p>
</dd>
<dt class="codelist"><code>Channels:</code></dt>
<dd>
The number of channels used by the sound file. This must be either 1 (mono) or 2
(stereo). If there is no audio stream accompanying the video stream, set
this to 0.

<p>
</dd>
<dt class="codelist"><code>SeekMode:</code></dt>
<dd>
This member specifies the unit in which <a href="SeekVideo.html">SeekVideo()</a> receives
its seek destination position. This can be one of the following constants:

<p>
<dl>
<dt class="codelist"><code>HWVIDSEEKMODE_TIME:</code></dt>
<dd>
Seek destination position will be passed as a time stamp in milliseconds. This
is the most common seek mode but not all video formats support it.

<p>
</dd>
<dt class="codelist"><code>HWVIDSEEKMODE_BYTE:</code></dt>
<dd>
Seek destination position will be passed as an absolute position in bytes which
is calculated by multiplying the <code>BitRate</code> parameter of this structure
with the target time stamp. This will obviously only work with video streams
that use a constant bit rate. If you choose this mode, make sure to set <code>BitRate</code>
to the correct video bit rate.
</dd></dl>

<p>
Note that this member doesn't have any effect if the <code>HWVIDFLAGS_CANSEEK</code>
flag isn't set.

<p>
</dd>
<dt class="codelist"><code>BitRate:</code></dt>
<dd>
Set this to the number of bytes this video stream needs to store one second of
video data. You only need to provide this information if you've set <code>SeekMode</code>
to <code>HWVIDSEEKMODE_BYTE</code>. Otherwise this information is not needed. Please
note that in contrast to its name, this member actually needs to be set to a value
in bytes, not in bits!

<p>
</dd>
<dt class="codelist"><code>PixFmt:</code></dt>
<dd>
This member specifies the pixel format in which you want to provide the individual
video frame data to Hollywood. This can be one of the following constants:

<p>
<dl>
<dt class="codelist"><code>HWVIDPIXFMT_YUV420P:</code></dt>
<dd>
Pixel data is provided in planar YUV 4:2:0 format.

<p>
</dd>
<dt class="codelist"><code>HWVIDPIXFMT_ARGB32:</code></dt>
<dd>
Pixel data is provided as 32-bit ARGB pixel data.
</dd></dl>

<p>
</dd>
<dt class="codelist"><code>Flags:</code></dt>
<dd>
A combination of the following flags describing additional properties
of the stream:

<p>
<dl>
<dt class="codelist"><code>HWVIDFLAGS_CANSEEK</code></dt>
<dd>
This plugin's <a href="SeekVideo.html">SeekVideo()</a> function supports seeking according to the
mode specified in <code>SeekMode</code>. Note that even if this flag isn't set, your plugin
still needs to be able to rewind the video stream, i.e. seek it back to the very beginning
in case 0 is passed to <a href="SeekVideo.html">SeekVideo()</a>. See <a href="SeekVideo.html">SeekVideo</a> for details.
</dd></dl>

<p>
</dd>
<dt class="codelist"><code>FrameTime:</code></dt>
<dd>
Specifies how long each video frame should be presented in seconds which can then be
used to compute the frame rate. For example, a <code>FrameTime</code> of 0.04 means that
the video is meant to play at 25 frames per second.

<p>
</dd>
<dt class="codelist"><code>FileSize:</code></dt>
<dd>
If Hollywood 6.0 or higher is calling your function, you should set this member to
the size of the video file in bytes or -1 if you don't know the size. Setting
this member is optional but doing so allows Hollywood to open your video faster
since Hollywood won't have to query the file size on its own if you can provide
it. Make sure to check for Hollywood 6.0 before touching this member because it
wasn't there in previous versions. (V6.0)

<p>
</dd>
<dt class="codelist"><code>Adapter:</code></dt>
<dd>
Starting with Hollywood 6.0 users can specify the file adapter that should be used
to open certain files. If this member is non-<code>NULL</code>, Hollywood wants your plugin to
use the file adapter specified in <code>Adapter</code> to open the video file. This means that you
have to use <a href="hw_FOpenExt.html">hw_FOpenExt()</a> instead of <a href="hw_FOpen.html">hw_FOpen()</a>
to open the video file. Make sure to check for Hollywood 6.0 before trying to access
this member because it isn't there in previous versions. See <a href="hw_FOpenExt.html">hw_FOpenExt</a> for details. (V6.0)

<p>
</dd>
<dt class="codelist"><code>UserTags:</code></dt>
<dd>
This member will be set to a list of user tags in case they were specified
in the Hollywood script. User tags are a way of passing additional information
from Hollywood scripts to plugin functions. Note that even if your plugin doesn't
support any user tags, you should still look for this tag and pass the user
tags to <a href="hw_FOpenExt.html">hw_FOpenExt</a> because the user tags passed in <code>UserTags</code> could
also be intended for another plugin, namely the file adapter plugin passed
in <code>Adapter</code>. See <a href="UserTags.html">User tags</a> for details. Make sure to check for Hollywood 10.0
before trying to access this member because it isn't there in previous versions.
(V10.0)
</dd></dl>

<p>
Please note that you should not use ANSI C functions like <code>fopen()</code> to
open the file that is passed to this function because the filename that is passed
to this function can also be a specially formatted filename specification that
Hollywood uses to load files that have been linked to applets or executables. In
order to be able to load these files correctly, you have to use special IO functions
provided by Hollywood. See <a href="FileIO.html">File IO information</a> for details.

<p>
</dd>
<dt class="autodoc"><b>Inputs</b></dt><dd>
<dl>
<dt><i>filename</i></dt>
<dd>filename to open</dd>
<dt><i>ctrl</i></dt>
<dd>pointer to a <code>struct OpenVideoCtrl</code> for storing information
about the video file</dl>
</dd>
<dt class="autodoc"><b>Results</b></dt><dd>
<dl>
<dt><i>handle</i></dt>
<dd>a handle that identifies this video file or <code>NULL</code> if plugin doesn't
want to handle this video file</dd></dl>
</dd></dl>
<hr>
<font size=-2><a href="OpenVideo_.html" target="_top">Show TOC</a></font>
</body>
</html>