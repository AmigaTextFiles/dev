<html>
<!-- generated from hollywood_sdk.meta by MetaDoc 1.13 (c) by Andreas Falkenhahn -->
<head>
<title>Building for WarpOS</title>
<meta name="author" content="Andreas Falkenhahn">
<meta name="generator" content="MetaDoc 1.13">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<style type="text/css">
<!--
body {font-family: sans-serif;}
ul.toc {list-style: none; margin-left: 20px; padding-left: 0px;}
dt.autodoc {font-variant: small-caps; font-size: larger; margin-top: 10px; margin-bottom: 10px; padding-left: 0.2em; padding-top: 0.2em; padding-bottom: 0.2em;
	background-color: #bae1ff; border-width: 1px; border-color: #3baaff; border-style: solid;}
dt.codelist {margin-bottom: 0.2em;}
h2.heading {background-color: #bae1ff; font-family: Arial; padding-top: 0.4em; padding-bottom: 0.4em;}
code {background-color: #f2f2f2; padding: 2px 4px; font-weight: bold;}
pre {background-color: #f2f2f2; border: 1px solid #ddd; padding: 0.3em;}
		
-->
</style>
</head>
<body bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#0000FF" alink="#0000FF">
<h2 class="heading">3.6 Building for WarpOS</h2>

<p>
If you build plugins for WarpOS, the <code>hwPluginAPI</code> pointer that is passed to your
<a href="InitPlugin.html">InitPlugin()</a> will contain function pointers to PPC code. However,
many of these function pointers will immediately do a context switch and run on
the 68k context. You might already be aware of the fact that context switches are
quite expensive so you should do your best to minimize the number of context switches
your plugin has to perform. To achieve this, you need to know which of the functions
in the <code>hwPluginAPI</code> base pointer run PPC-native and which of them need a context
switch. So here's an overview on the functions that don't need a context switch.
All other functions not listed here will immediately perform a context switch.

<p>
<dl>
<dt class="codelist"><code>CRTBase:</code></dt>
<dd>
The following functions are available in PPC native versions: <code>malloc()</code>, <code>calloc()</code>,
<code>realloc()</code>, <code>free()</code>, <code>strdup()</code>, <code>qsort()</code>, <code>stricmp()</code>, <code>strnicmp()</code>, <code>toupper()</code>, <code>tolower()</code>,
<code>strtolower()</code>, <code>strtoupper()</code>, <code>gettimeofday()</code>, <code>time()</code>, <code>lrint()</code>, <code>strtol()</code>,
<code>strtoul()</code>, <code>strtod()</code>, <code>vsscanf()</code>, <code>vsnprintf()</code>, <code>atol()</code>, <code>dtostr()</code>.

<p>
</dd>
<dt class="codelist"><code>SysBase:</code></dt>
<dd>
The following functions are available in PPC native versions: <code>hw_GetSysTime()</code>,
<code>hw_SubTime()</code>, <code>hw_AddTime()</code>, <code>hw_CmpTime()</code>, <code>hw_Delay()</code>, <code>hw_MasterControl()</code> (but this
function is only PPC-native when querying the <code>HWMCP_GETPOWERPCBASE</code> tag to make Hollywood return its <code>PowerPCBase</code>
pointer to you), <code>hw_TrackedAlloc()</code>, <code>hw_TrackedFree()</code>,
<code>hw_AllocSemaphore()</code>, <code>hw_FreeSemaphore()</code>, <code>hw_LockSemaphore()</code>, <code>hw_UnLockSemaphore()</code>.

<p>
</dd>
<dt class="codelist"><code>DOSBase:</code></dt>
<dd>
All functions here are implemented in 68k code and will immediately do a
context switch.

<p>
</dd>
<dt class="codelist"><code>GfxBase:</code></dt>
<dd>
All functions here are implemented in 68k code and will immediately do a
context switch.

<p>
</dd>
<dt class="codelist"><code>AudioBase:</code></dt>
<dd>
All functions here are implemented in 68k code and will immediately do a
context switch.

<p>
</dd>
<dt class="codelist"><code>RequesterBase:</code></dt>
<dd>
All functions here are implemented in 68k code and will immediately do a
context switch.

<p>
</dd>
<dt class="codelist"><code>FontBase:</code></dt>
<dd>
All functions here are implemented in 68k code and will immediately do a
context switch.

<p>
</dd>
<dt class="codelist"><code>FT2Base:</code></dt>
<dd>
All functions here are PPC-native and don't need a context switch. Note
that the PPC-native <code>FT2Base</code> for WarpOS is not available before Hollywood 5.3.
You need to make sure that your plugin was opened by Hollywood 5.3 at
least before trying to make any calls in <code>FT2Base</code>.

<p>
</dd>
<dt class="codelist"><code>LuaBase:</code></dt>
<dd>
All functions here are implemented in 68k code and will immediately do a
context switch.

<p>
</dd>
<dt class="codelist"><code>ZBase:</code></dt>
<dd>
All functions here are PPC-native and don't need a context switch.

<p>
</dd>
<dt class="codelist"><code>JPEGBase:</code></dt>
<dd>
All functions here are PPC-native and don't need a context switch.

<p>
</dd>
<dt class="codelist"><code>PluginBase:</code></dt>
<dd>
All functions here are implemented in 68k code and will immediately do a
context switch.

<p>
</dd>
<dt class="codelist"><code>UtilityBase:</code></dt>
<dd>
The following functions are available in PPC native versions: <code>hw_CRC32()</code>,
<code>hw_DecodeBase64()</code>, <code>hw_EncodeBase64()</code>, and <code>hw_MD5()</code>. The other functions
are implemented in 68k code and will do a context switch.

<p>
</dd>
<dt class="codelist"><code>UnicodeBase:</code></dt>
<dd>
All functions here are PPC-native and don't need a context switch.

<p>
</dd>
<dt class="codelist"><code>LocaleBase:</code></dt>
<dd>
All functions here are implemented in 68k code and will immediately do a
context switch.
</dd></dl>

<p>
Also, be careful about structure alignment when developing for WarpOS. The WarpOS
version of Hollywood doesn't use the traditional Amiga structure alignment of
2 bytes but is optimized for performance. This means, for example, that 64-bit
double values will always be aligned on an 8 byte boundary.

<p>
<hr>
<font size=-2><a href="AmigaOSWarpOS_.html" target="_top">Show TOC</a></font>
</body>
</html>