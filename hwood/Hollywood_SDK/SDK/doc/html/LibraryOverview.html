<html>
<!-- generated from hollywood_sdk.meta by MetaDoc 1.13 (c) by Andreas Falkenhahn -->
<head>
<title>Overview</title>
<meta name="author" content="Andreas Falkenhahn">
<meta name="generator" content="MetaDoc 1.13">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<style type="text/css">
<!--
body {font-family: sans-serif;}
ul.toc {list-style: none; margin-left: 20px; padding-left: 0px;}
dt.autodoc {font-variant: small-caps; font-size: larger; margin-top: 10px; margin-bottom: 10px; padding-left: 0.2em; padding-top: 0.2em; padding-bottom: 0.2em;
	background-color: #bae1ff; border-width: 1px; border-color: #3baaff; border-style: solid;}
dt.codelist {margin-bottom: 0.2em;}
h2.heading {background-color: #bae1ff; font-family: Arial; padding-top: 0.4em; padding-bottom: 0.4em;}
code {background-color: #f2f2f2; padding: 2px 4px; font-weight: bold;}
pre {background-color: #f2f2f2; border: 1px solid #ddd; padding: 0.3em;}
		
-->
</style>
</head>
<body bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#0000FF" alink="#0000FF">
<h2 class="heading">20.1 Overview</h2>

<p>
Plugins that have the capability flag <code>HWPLUG_CAPS_LIBRARY</code> set can add
new commands and constants to Hollywood's set of inbuilt commands and constants.
If you want to write such a plugin, you need to familiarize yourself with the
Lua which Hollywood uses as a VM. You can access Hollywood's Lua VM through the
<code>LuaBase</code> pointer that is passed inside the <code>hwPluginAPI</code> table
which your <a href="InitPlugin.html">InitPlugin()</a> function receives.

<p>
Here is a brief explanation of how Lua calls C functions: Your function will
receive just a single parameter - a pointer to the <code>lua_State</code>. All
parameters that the script passes to your function will be pushed into the stack.
If you want to return values to Lua, you have to push them into the stack as
well and return the number of values you pushed. Alternatively, you can also return
an error code. Standard error codes are defined in <code>hollywood/errors.h</code>.
You can also register custom error codes using <a href="hw_RegisterError.html">hw_RegisterError()</a>.

<p>
Here is how a custom function that simply divides the first parameter by the
second:

<p>
<table cellpadding="0" cellspacing="0"><tr><td>&nbsp;</td><td><pre>static SAVEDS int MyDiv(lua_State *L)
{
    double a = luaL_checknumber(L, 1);
    double b = luaL_checknumber(L, 2);

    // catch division by zero CPU exception and handle
    // it cleanly
    if(b == 0) return ERR_ZERODIVISION;

    lua_pushnumber(L, a / b);

    // push 1 to indicate one return value
    return 1;
}
</pre></td></tr></table><p>

This is just a primitive example. Check the Lua manual for more information
on how to implement Lua functions in C. Please note that Hollywood uses
Lua 5.0.2 so make sure you consult the correct manual. See <a href="LuaBaseOverview.html">LuaBase functions</a> for details.

<p>
The SDK distribution also comes with an example library plugin which adds
several functions and constants to Hollywood. Feel free to study this example code
to learn how library plugins are written in practice.

<p>
Starting with Hollywood 6.0 library plugins support the <code>HWEXT_LIBRARY_MULTIPLE</code>
extension. If this extension is set, a library can install multiple libraries
instead of just a single one. If you set the <code>HWEXT_LIBRARY_MULTIPLE</code> extension bit,
you need to implement the <a href="GetLibraryCount.html">GetLibraryCount()</a> and <a href="SetCurrentLibrary.html">SetCurrentLibrary()</a>
functions. Hollywood will then call <a href="GetLibraryCount.html">GetLibraryCount()</a> to
find out how many libraries your plugin wants to install. See <a href="ExtensionOverview.html">Extension plugins</a> to learn how to use plugin extension bits.

<p>
Starting with Hollywood 6.1 library plugins can set the <code>HWEXT_LIBRARY_NOAUTOINIT</code>
extension flag. If this is set, the library's commands and constants won't be
added to Hollywood's set of commands and constants automatically when the plugin
is loaded. Instead, the library's commands and constants will only be added if
the user performs a <code>@REQUIRE</code> on the plugin. This is useful for library plugins
which add lots of commands and constants. Adding them to every single Hollywood
script is unnecessary overhead, so it is a good idea to use <code>HWEXT_LIBRARY_NOAUTOINIT</code>
for those libraries so that their commands and constants are only installed when
a script explicitly requests them. See <a href="ExtensionOverview.html">Extension plugins</a> to learn how to use plugin extension bits.

<p>
Starting with Hollywood 7.0 library plugins support the <code>HWEXT_LIBRARY_HELPSTRINGS</code>
extension bit. If this is set, your plugin needs to implement a function named <a href="GetHelpStrings.html">GetHelpStrings()</a>
which needs to return a table containing a help string and a node in the plugin's help file
for each command. See <a href="GetHelpStrings.html">GetHelpStrings</a> for details.

<p>
Starting with Hollywood 7.1 library plugins support the <code>HWEXT_LIBRARY_UPVALUES</code>
extension bit. If this is set, your plugin needs to implement a function named <a href="PushUpvalues.html">PushUpvalues()</a>
which pushes the desired upvalues to the stack and returns the number of values
pushed. See <a href="PushUpvalues.html">PushUpvalues</a> for details.

<p>

<p>
<hr>
<font size=-2><a href="LibraryOverview_.html" target="_top">Show TOC</a></font>
</body>
</html>