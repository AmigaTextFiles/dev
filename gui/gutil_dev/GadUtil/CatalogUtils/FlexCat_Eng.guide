@database FlexCat_english.guide

@Master FlexCat_english.texinfo

@Width 72


This is the AmigaGuide® file FlexCat_english.guide, produced by Makeinfo-1.55 from 
the input file FlexCat_english.texinfo.


@Node Main "FlexCat_english.guide"

FlexCat V1.4 Documentation
**************************

   This file describes the Usage of FlexCat V1.4, a program which
generates catalogs and the source to handle them. FlexCat works similar
to @{b}CatComp@{ub} and @{b}KitCat@{ub}, but differs in generating any source you want.
This is done by using the so called @{b}Source descriptions@{ub}, which are a
template for the code to generate. They can be edited and hence adapted
to any programming language and individual needs. (Hopefully!)


General:

 @{" Disclaimer " Link "Disclaimer"} 	     Copyrights, (NO) warranty
 @{" Survey " Link "Survey"} 	     What is FlexCat?
 @{" Installation " Link "Installation"}      How can I get it working?

Using FlexCat:

 @{" Program start " Link "Program start"} 	 Calling FlexCat from the CLI
 @{" Catalog description " Link "Catalog description"}   Catalog description files (.cd-files)
 @{" Catalog translation " Link "Catalog translation"}   Catalog translation files (.ct-files)
 @{" Source description " Link "Source description"} 	 Source description (.sd-files)
 @{" Using FlexCat source " Link "Using FlexCat source"}  Using FlexCat source in own programs

Unnecessities:

 @{" Future " Link "Future"} 		Further development of FlexCat
 @{" Credits " Link "Credits"} 		What I always wanted to say...
 @{" Index " Link "Index"} 		Where you find what you are never looking for


@EndNode

@Node "Disclaimer" "FlexCat_english.guide/Disclaimer"
@Next "Survey"
@Prev "Main"
@Toc "Main"

Copyright and other legal stuff
*******************************

     Copyright (C) 1993	Jochen Wiedmann
     			Am Eisteich 9
     		  72555 Metzingen (Deutschland)
     			Tel. 07123 / 14881
     			Internet: wiedmann@uni-tuebingen.de

   Permission is granted to make and distribute verbatim and modified
copies of this documentation and the program FlexCat following the
terms of the "GNU General Public License" provided the copyright notice
and this permission notice are preserved on all copies and the "GNU
General Public License" (in the file @{b}COPYING@{ub}) is distributed as well.

   The author gives @{i}absolutely no@{ui} warranty that the program described
in this documentation and the results produced by it are correct. The
author cannot be held responsible for @{i}any@{ui} damage  resulting from the
use of this software.


@EndNode

@Node "Survey" "FlexCat_english.guide/Survey"
@Next "Installation"
@Prev "Disclaimer"
@Toc "Main"

Survey
******

   Since Workbench 2.1 the Amiga offers a rather pleasant system of
using programs in different languages: The @{b}locale.library@{ub}. (This is
called localizing, that's what the name's for.)

   The idea is simple: You select a language, the english in most cases
and write your program in the same manner as you did without
localizing, except that constant strings are replaced by certain
function calls. Another function call makes it possible that the user
selects another language when the program starts. (The latter function
call loads an external file, the so called @{b}catalog@{ub} and makes the former
to read the strings from the catalog instead of using the predefined
strings.)

   These catalogs are independent from the program. All you need to do
for adding another language is to create a new catalog file and this is
possible at any time without changing the program.

   But there are additional tasks for the programmer: He needs to
create the catalogs, the predefined strings and some source to handle
them all. (The functions that are mentioned above.) FlexCat is designed
to make this in an easy and nearly automatic manner without losing
flexibility especially in creating the source. An example should make
this clear:

   Lets assume that we want to write a @{b}HelloLocalWorld.c@{ub}. Our final
program will look like this:
         #include <stdio.h>
         #include <stdlib.h>
         #include <HelloLocalWorld_Cat.h>  /*  You @{i}must@{ui} include this! */
     
         void main(int argc, char *argv[])
         {
           printf("%s\n", GetString(msgHello));
         }

Note that this is quite the same as the original @{b}HelloWorld.c@{ub} except
for replacing the string "Hello, world!" by a function call.

   The above program uses a constant @{b}msgHello@{ub}. A call to the functon
@{b}GetString@{ub} replaces this by the respective string.  These constants and
strings are defined in a so called @{b}Catalog description@{ub} file. (see
@{"Catalog description" Link "Catalog description"}. You always start by creating such a file called
@{b}HelloLocalWorld.cd@{ub}, which could look like this:
         ;	Comments ar eallowed, of course! Each line beginning with a
         ;	semicolon is assumed to be a comment
         ;
         ;	The language of the builtin strings:
         #language english
         ;
         ;	The catalog version, used for a call to Locale/OpenCatalog().
         ;	This is different to Exec/OpenLibrary(): 0 means any catalog
         ;	version, other numbers must match exactly!
         #version 0
         ;
         ;	This defines a string and the ID which allows to use it.
         ;	The number 4 says, that this string must not be shorter than
         ;	4 characters.
         msgHello (/4/)
         Hello, world!

   By using FlexCat you create another two files from the catalog
description: The include file @{b}HelloLocalWorld_Cat.h@{ub} defines the
constants and the @{b}HelloLocalWorld_Cat.c@{ub} contains an array of strings
and the @{b}GetString@{ub} function.  You don't need to know how this look, just
use them. Especially you don't need to know anything about the
@{b}locale.library@{ub}!

   However, you might be interested, how these files look or even more,
you might want them changed. This is the difference between FlexCat and
other catalog generators: FlexCat is not forced to use a special
builtin format for creating these files. Instead it uses external
template files, so called @{b}Source descriptions@{ub}. This makes it possible,
for example, to allow using catalogs with AmigaDOS 2.0. see
@{"Source description" Link "Source description"}.  If you use the source descriptions from the
FlexCat distribution you can create the source files with the following
commands:
         @{b}FlexCat HelloLocalWorld.cd HelloLocalWorld_Cat.c=AutoC_c.sd@{ub}
         @{b}FlexCat HelloLocalWorld.cd HelloLocalWorld_Cat.h=AutoC_h.sd@{ub}

   When your program is ready you use FlexCat again to create so called
@{b}Catalog translation@{ub} files, one for each language you would like to
support. (Except english, which is builtin.) See @{"Catalog translation" Link "Catalog translation"}.
Lets create a german catalog translation:
         @{b}FlexCat HelloLocalWorld.cd NEWCTFILE Deutsch.ct@{ub}

This file would no look as follows:
         ## version
         ## language
         ## codeset 0
         ;	Comments ar eallowed, of course! Each line beginning with a
         ;	semicolon is assumed to be a comment
         ;
         ;	The language of the builtin strings:
         ;
         ;	The catalog version, used for a call to Locale/OpenCatalog().
         ;	This is different to Exec/OpenLibrary(): 0 means any catalog
         ;	version, other numbers must match exactly!
         ;
         ;	This defines a string and the ID which allows to use it.
         ;	The number 4 says, that this string must not be shorter than
         ;	4 characters.
         msgHello
     
         ;Hello, world!

You see, it looks much like the catalog descriptions. FlexCat includes
the comments from the catalog description, even where it is
meaningless: Note the comment on the string length which shouldn't
appear here as these informations must be in the catalog description
only. All you have to do now is to fill in the informations on the
version (a typical version string like @{b}$VER: Deutsch.catalog 1.0
(11.03.94)@{ub} is expected), the language of the catalog translation
(@{b}Deutsch@{ub} for german here), the codeset (which should always be 0
for now, see Locale/OpenCatalog() for details) and of course the
strings itself. FlexCat includes the original strings as comments, so
you always know what to fill in.  Finally you create the catalogs with
commands like
         @{b}FlexCat HelloLocalWorld.cd Deutsch.ct CATALOG Deutsch.catalog@{ub}

Note, that you don't need the program itself or the source files created
with FlexCat for the catalogs! You can create new catalogs at any time.
It is usual to supply distributions with a file NewCatalog.ct, so users
can create own catalogs.

   But what happens if you change the program later? Just edit the
catalog description and use FlexCat to update the catalog translations:
         @{b}FlexCat HelloLocalWorld.cd Deutsch.ct NEWCTFILE Deutsch.ct@{ub}

All you need to do now is to enter new strings if needed.


@EndNode

@Node "Installation" "FlexCat_english.guide/Installation"
@Next "Program start"
@Prev "Survey"
@Toc "Main"

Installation
************

   FlexCat is written in pure Ansi-C (except for the localization),
hence it should run on any Amiga and hopefully on other machines after
recompiling.  (The localizing is commented out in that case.) This
holds for the created programs too: FlexCat is written using itself.
All distributed source descriptions should create programs running on
any Amiga and even any machine. (Of course you must ensure that the
variable LocaleBase has the value @{b}NULL@{ub} in the latter case.) Localizing,
however, is possible beginning with Workbench 2.1 because the
@{b}locale.library@{ub} isn't available below.

   It is not impossible to offer localizing without the @{b}locale.library@{ub}:
The source description files @{b}C_c_V20.sd@{ub} and @{b}C_h_V20.sd@{ub} give an example,
where the @{b}iffparse.library@{ub} is used to replace the @{b}locale.library@{ub}, if it
is not available. This gives Localizing for Workbench 2.0. See @{"C" Link "C"}.

   Installing FlexCat is simple: Just copy the program to a directory
in your search path and select a place for the source descriptions you
need.  (These are the files called something like @{b}xx_yy.sd@{ub}, where @{b}xx@{ub} is
the programming language.) Probably you want to set the environment
variable @{i}FLEXCAT_SDDIR@{ui}. See @{"Program start" Link "Program start"}.

   If you want to use FlexCat in another language than the english you
need to copy the respective catalog files too. E.g. for the german
language copy the file @{b}Catalogs/Deutsch/FlexCat.catalog@{ub} to
@{b}Locale:Catalogs/Deutsch/FlexCat.catalog@{ub} or to
@{b}PROGDIR:Catalogs/Deutsch/FlexCat.catalog@{ub}, where @{b}PROGDIR:@{ub} is FlexCat's
program directory. See @{"Using FlexCat source" Link "Using FlexCat source"}.


@EndNode

@Node "Program start" "FlexCat_english.guide/Program start"
@Next "Catalog description"
@Prev "Installation"
@Toc "Main"

Calling FlexCat from the CLI
****************************

   FlexCat is a CLI based program and doesn't operate from the
workbench.  It's calling syntax is
         FlexCat CDFILE/a,CTFILE,CATALOG/k,NEWCTFILE/k,SOURCES/m

where the arguments mean
@{i}CDFILE@{ui}
     is the name of a catalog description to be read. This is always
     needed.  Please note, that the base name of the source description
     is created from it making this case significant. See
     @{"Source description" Link "Source description"}.

@{i}CTFILE@{ui}
     is the name of a catalog translation file to be read. This is
     needed for creating catalogs or for updating an old catalog
     translation file using the NEWCTFILE argument: FlexCat reads the
     old file and the catalog description and creates a new catalog
     translation file containing the old strings and possibly some
     empty lines for new strings.

@{i}CATALOG@{ui}
     is the name of a catalog file to be created. This argument
     requires giving CDFILE as well.

@{i}NEWCTFILE@{ui}
     is the name of a catalog translation file to create. FlexCat reads
     strings from CTFILE, if this is given, strings missing in the
     catalog translation are replaced by empty lines. (The new catalog
     translation will contain only empty lines as strings, if CTFILE is
     omitted.)

@{i}SOURCES@{ui}
     are the names of source files to be created. These shoud be given
     in the form @{b}source=template@{ub} where @{b}source@{ub} is the file to create and
     @{b}template@{ub} is the name of a source description file to be scanned.

     If the source description isn't found, FlexCat tries to open a
     file with the same name in the directory @{b}PROGDIR:lib@{ub}. (The
     subdirectory @{b}lib@{ub} of the directory where the binary FlexCat itself
     lives.) You can overwrite this default with the environment
     variable @{i}FLEXCAT_SDDIR@{ui}. Example:
              @{b}FlexCat FlexCat.cd FlexCat_Cat.c=Templates/C_c_V20.sd@{ub}

     would look for a file @{b}Templates/C_c_V20.sd@{ub} in the current
     directory first. If this wouldn't be found and no variable
     @{i}FLEXCAT_SDDIR@{ui} would be present, FlexCat would look for
     @{b}PROGDIR:lib/Templates/C_c_V20.sd@{ub}. But if @{i}FLEXCAT_SDDIR@{ui} would exist
     and have the value @{b}Work:Flexcat@{ub}, for example, then the existence of
     @{b}Work:FlexCat/Templates/C_c_V20.sd@{ub} would be checked.

   For further examples of command lines see @{"Survey" Link "Survey"}.


@EndNode

@Node "Catalog description" "FlexCat_english.guide/Catalog description"
@Next "Catalog translation"
@Prev "Program start"
@Toc "Main"

Catalog description files
*************************

   A catalog description file contains four kinds of lines.

@{i}Comment lines@{ui}
     Any line beginning with a semicolon is assumed to be a comment
     line, hence ignored. (The string lines below are an exception.
     These may begin with a semicolon.)

@{i}Command lines@{ui}
     Any line beginning with a '#' (with the same exception as above)
     are assumed to be command lines. Possible commands are:
    @{b}#language <str>@{ub}
          gives the programs default language, the language of the
          strings in the catalog description. Default is @{b}#language
          english@{ub}.

    @{b}#version <num>@{ub}
          gives the version number of catalogs to be opened. Note that
          this number must match exact and not be same or higher as in
          `Exec/OpenLibrary'.  An exception is the number 0, which
          accepts any catalog. Default is @{b}#version 0@{ub}. See
          @{b}Locale/OpenCatalog@{ub} for further information on catalog
          language and version.

    @{b}#lengthbytes <num>@{ub}
          Instructs FlexCat to put the given number of bytes before a
          string containing its length. The length is the number of
          bytes in the string without length bytes and a trailing @{b}NUL@{ub}
          byte. (Catalog files and hence catalog strings will have a
          trailing @{b}NUL@{ub} byte. This is not always true for the default
          strings, depending on the source description file.) @{b}<num>@{ub}
          must be between 0 and sizeof(long)=4, Default is @{b}#lengthbytes
          0@{ub}.

    @{b}#basename <str>@{ub}
          Sets the basename of the source description. See
          @{"Source description" Link "Source description"}.  This overwrites the basename from the
          command line argument CDFILE.  See @{"Program start" Link "Program start"}.  Commands
     are case insensitive.

@{i}Description lines@{ui}
     declare a string. They look like @{b}IDSTR (id/minlen/maxlen)@{ub} where
     @{b}IDSTR@{ub} is a identifier (a string consisting of the characters
     a-z,A-Z and 0-9), @{b}id@{ub} is a unique number (from now on called ID),
     @{b}minlen@{ub} and @{b}maxlen@{ub} are the strings minimum and maximum length,
     respectively. The latter three may be missing (but not the
     characters @{b}(//)@{ub}!) in which case FlexCat chooses a number and makes
     no restrictions on the string length.  Better don't use the ID's,
     if you don't need. The lines following are the

@{i}String lines@{ui}
     containing the string itself and nothing else. These may contain
     certain control characters beginning with a backslash:
    @{b}\b@{ub}
          Backspace (Ascii 8)

    @{b}\c@{ub}
          Control Sequence Introducer (Ascii 155)

    @{b}\e@{ub}
          Escape (Ascii 27)

    @{b}\f@{ub}
          Form Feed (Ascii 12)

    @{b}\g@{ub}
          Display beep (Ascii 7)

    @{b}\n@{ub}
          Line Feed, newline (Ascii 10)

    @{b}\r@{ub}
          Carriage Return (Ascii 13)

    @{b}\t@{ub}
          Tab (Ascii 9)

    @{b}\v@{ub}
          Vertical tab (Ascii 11)

    @{b}\)@{ub}
          The trailing bracket which is possibly needed as part of a
          @{b}(..)@{ub} sequence, see @{"Source description" Link "Source description"}.

    @{b}\\ @{ub}
          The backslash itself

    @{b}\xHH@{ub}
          The character given by the ascii code @{b}HH@{ub}, where @{b}HH@{ub} are hex
          digits.

    @{b}\OOO@{ub}
          The character given by the ascii code @{b}OOO@{ub}, where @{b}OOO@{ub} are octal
          digits.  Finally a single backslash at the end of the line
     causes concatening the following line. This makes it possible to
     use strings of any length, FlexCat makes no assumptions on string
     length.

   A string is hence given by a description line and the following
string line.  Let's see an example:
         msgHello (/4/)
         Hello, this is english!\n

The ID is missing here, so FlexCat chooses a suitable number. The
number 4 instructs FlexCat, that the following string must not have
less than four characters and it may be of any length. See the file
@{b}FlexCat.cd@{ub} for a further example.


@EndNode

@Node "Catalog translation" "FlexCat_english.guide/Catalog translation"
@Next "Source description"
@Prev "Catalog description"
@Toc "Main"

Catalog translation files
*************************

   Catalog translation files are very similar to catalog descriptions,
except for other commands and having no informations on string ID and
length.  (These are taken from the catalog description.) Any string
from the catalog description must be present (However, FlexCat omits
writing strings into the catalog which are identical to the default
string.) and no additional identifiers may occur. This is easy assured
by using FlexCat to create new catalog translation files. See @{"Survey" Link "Survey"}.

   The commands allowed in catalog translations are:
@{b}##version <str>@{ub}
     Gives the catalog version as AmigaDOS version string. Example:
              @{b}##version $VER: Deutsch.ct 8.1 (27.09.93)@{ub}
     The version number of this catalog is 8. Hence the catalog
     descriptions version number must be 0 or 8.

@{b}##language <str>@{ub}
     The catalogs language. Of course this should be another language
     than the catalog descriptions language. The @{b}##language@{ub} and
     @{b}##version@{ub} commands must be present in a catalog translation.

@{b}##codeset <num>@{ub}
     Currently not used, must be 0. This is the default value.

   The string from above looks like this in the catalog translation:
         msgHello
         Hallo, dies ist deutsch!\n

See @{b}Deutsch.ct@{ub} as further example of a catalog translation.


@EndNode

@Node "Source description" "FlexCat_english.guide/Source description"
@Next "Using FlexCat source"
@Prev "Catalog translation"
@Toc "Main"

Source description files
************************

   This is the special part of FlexCat. Until now there is nothing that
CatComp, KitCat and others don't offer too. The created source should
make it easy, to use the catalogs without losing flexibility. Any
programming language should be possible and any requirements should be
satisfyable.  This seems like a contradiction, but FlexCat's solution
are the source description files containing a template of the source to
be created. These are editable as the catalog description and
translation files are, hence FlexCat can create any code.

   The source descriptions are searched for certain symbols which are
replaced by certain values. Possible symbols are the backslash
characters from above and additionally sequences beginning with a @{b}%@{ub}.
(This is well known for C programmers.)
@{b}%b@{ub}
     is the base name of the catalog description. See @{"Program start" Link "Program start"}.

@{b}%v@{ub}
     is the version number of the catalog description. Don't mix this
     up with the catalog version string from the catalog translation.

@{b}%l@{ub}
     is the catalog descriptions language. Please note, that this is
     inserted as a string. See @{b}%s@{ub} below.  below.

@{b}%n@{ub}
     is the number of strings in the catalog description.

@{b}%%@{ub}
     is the character @{b}%@{ub} itself.

   But the most important thing are the following seqences. These
represent the catalog strings in different ways. Lines containing one
or more of these symbols are repeated for any String.

@{b}%i@{ub}
     is the identifier from the catalog description.

@{b}%d@{ub}
     is the strings ID.

@{b}%e@{ub}
     is the number of this string. Counting begins with 0.

@{b}%s@{ub}
     is the string itself; this will be inserted in a way depending on
     the programming language and can be controlled using the commands
     @{b}##stringtype@{ub} and @{b}##shortstrings@{ub}.

@{b}%(...)@{ub}
     inserts the text between the brackets for any string except the
     last.  This is probably needed in Arrays, if the array entries
     should be separated by commas, but the last entry must not be
     followed by a comma. You can use @{b}%(,)@{ub} in that case. Note that
     within the brackets there is no replacing of @{b}%@{ub} sequences.
     Backslash sequences, however, are still allowed.

   The control sequences @{b}%l@{ub} and @{b}%s@{ub} create strings. But how strings look
depends on the program language. That's why the source description
allows command lines similar to the catalog translation. These must
begin with the first character of the line and any command must have
its own line.  Possible commands are:
@{b}##shortstrings@{ub}
     makes longer strings to be splitted on different lines. This is
     probably not always possible or not implemented into FlexCat and
     hence the default is to create one, probably very long string.

@{b}##stringtype <type>@{ub}
     Tells FlexCat how strings should look like. Possible types are
    @{i}None@{ui}
          No additional characters are created. An image of the string
          is inserted and nothing else. No output of binary characters
          (the backslash sequences) is possible.

    @{i}C@{ui}
          creates strings according to C. The strings are preceded and
          followed by the character @{b}"@{ub}. Strings are splitted using the
          sequences @{b}"\ @{ub} at the end of the line and @{b}"@{ub} at the beginning
          of the new line. (The backslash is needed in macros.) Binary
          characters are inserted using @{b}\OOO@{ub}. See @{"C" Link "C"}.

    @{i}Oberon@{ui}
          is like string type C, except for the trailing backslash at
          the end of the line. See @{"Oberon" Link "Oberon"}. This string type is
          recommended for Modula-2, too.

    @{i}Assembler@{ui}
          Strings are created using @{b}dc.b@{ub}. Readable ascii characters are
          preceded and followed by the character @{b}'@{ub}, binary characters
          are inserted as @{b}$XX@{ub}. See @{"Assembler" Link "Assembler"}.

    @{i}E@{ui}
          Strings are preceded and followed by the character @{b}'@{ub}. A @{b}+@{ub}
          concatenates strings which are spread on different lines.
          Binary characters are inserted like in C.

   Let's look at an excerpt from the file @{b}C_h.sd@{ub} creating an include
file for the programming language C.
     ##stringtype C
     ##shortstrings
     
     #ifndef %b_CAT_H    /*	Assure that this is read only once. */
     #define %b_CAT_H
     
     
     /*  Get other include files	*/
     #include <exec/types.h>
     #include <libraries/locale.h>
     
     
     /*  Prototypes	*/
     extern void Open%bCatalog(struct Locale *, STRPTR);
     extern void Close%bCatalog(void);
     extern STRPTR Get%bString(LONG);
     
     /*  Definitions of the identifiers and their ID's           */
     /*  This line will be repeated for any string.		    */
     #define %i %d
     
     #endif

   For the search path that is used for source descriptions see see
@{"Program start" Link "Program start"}.


@EndNode

@Node "Using FlexCat source" "FlexCat_english.guide/Using FlexCat source"
@Next "Future"
@Prev "Source description"
@Toc "Main"

Including FlexCat source in own programs
****************************************

   Of course this depends on what source is created and hence on the
source description. What we are talking here about are the source
description files distributed with FlexCat. See @{"Source description" Link "Source description"}.

   All source descriptions should allow using the program without
@{b}locale.library@{ub}. However, a global variable called @{b}LocaleBase@{ub}
(@{b}_LocaleBase@{ub} for assembler) must be present and initialized with
NULL or by a call to `Exec/OpenLibrary'. No localizing is possible in
the former case except when using the source description @{b}C_c_V20.sd@{ub}.
This allows localizing on 2.0 by repacing the @{b}locale.library@{ub} with the
@{b}iffparse.library@{ub}. (A variable @{b}IFFParseBase@{ub} has to be present for this
and initialized like @{b}LocaleBase@{ub}.) See @{"C" Link "C"}.  The programmer does not need
knowledge of these libraries except when creating own source
descriptions.

   There are three functions and calling them is rather simple.

 - : OpenCatalog (@{i}locale,@{ui}  @{i}language@{ui} )
     This function possibly opens a catalog. The argument @{b}locale@{ub} is a
     pointer to a Locale structure amd @{b}language@{ub} is a string containing
     the name of the language that should be opened. In most cases
     these should both be @{b}NULL@{ub} or @{b}NIL@{ub}, respectively, because the user's
     defaults are overwritten otherwise. See `Locale.OpenCatalog' for
     details.

     If the user has @{b}Deutsch@{ub} and @{b}Français@{ub} as default languages and the
     programs base name is @{b}XXX@{ub} this looks for the following files:
              @{b}PROGDIR:Catalogs/Deutsch/XXX.catalog@{ub}
              @{b}LOCALE:Catalogs/Deutsch/XXX.catalog@{ub}
              @{b}PROGDIR:Catalogs/Français/XXX.catalog@{ub}
              @{b}LOCALE:Catalogs/Français/XXX.catalog@{ub}

     where @{b}PROGDIR:@{ub} is the programs current directory. (The order of
     @{b}PROGDIR:@{ub} and @{b}LOCALE:@{ub} can get changed in order to suppress a
     requester like @{b}Insert volume YYY@{ub}.

     OpenCatalog is of type void (a procedure for Pascal programmers)
     and hence gives no result.

 - : GetString (@{i}ID@{ui} )
     Gives a pointer to the string with the given ID from the catalog
     description.  Of course these strings are owned by @{b}locale.library@{ub}
     and must not be modified.

     An example might be useful. Take the string from the catalog
     description example, which was called @{b}msgHello@{ub}. The source
     descriptions declare a constant @{b}msgHello@{ub} representing the ID. This
     could be printed in C using
              printf("%s\n", GetString(msgHello));

 - : CloseCatalog (@{i}void@{ui} )
     This function frees the catalog (that is the allocated RAM) before
     terminating the program. You can call this function at any time
     even before OpenCatalog is called.


 @{" C " Link "C"} 	      FlexCat source in C programs
 @{" C++ " Link "C++"}        FlexCat source in C++ programs
 @{" Oberon " Link "Oberon"}     FlexCat source in Oberon programs
 @{" Modula-2 " Link "Modula-2"}   FlexCat source in Modula-2 programs
 @{" Assembler " Link "Assembler"}  FlexCat source in Assembler programs
 @{" E " Link "E"} 	      FlexCat source in E programs


@EndNode

@Node "C" "FlexCat_english.guide/C"
@Next "C++"
@Toc "Using FlexCat source"

FlexCat source in C programs
============================

   C source consists of two parts: A @{b}.c@{ub} file which should be compiled
and linked without further notice and an include file which should be
included from any source part using catalog strings and which defines
the ID's as macros.

   Three different versions are available: @{b}AutoC_c.sd@{ub} is the the
simplest. They use the autoinizializing possibilities of @{b}Dice@{ub} and @{b}SAS/C@{ub}
and are thus for those compilers only. All you have to do here is using
the @{b}GetString@{ub} function. Unfortunately you don't have all possibilities
with these source descriptions, at least without own extensions, but
this should be sufficient for 95% of all applications. Together with
@{b}AutoC_c.sd@{ub} you need the file @{b}AutoC_h.sd@{ub} which creates the include files.
For an example of a program using these source descriptions see @{"Survey" Link "Survey"}.

   @{b}C_c_V21.sd@{ub} and @{b}C_h.sd@{ub} are what you need if you either
  1. have another compiler than Dice or SAS/C

  2. want to use all possibilities of the @{b}locale.library/OpenCatalogA@{ub}
     call or

  3. want to use more than one catalog file

The last reason is why the function names are slightly modified to
@{b}OpenXXXCatalog@{ub}, @{b}GetXXXString@{ub} and @{b}CloseXXXCatalog@{ub} where @{b}XXX@{ub} is the base
name from the source description.  See @{"Source description" Link "Source description"}. These are
the function prototypes:
         void OpenXXXCatalog(struct Locale *loc, char *language);
         STRPTR GetXXXString(ULONG);
         void CloseXXXCatalog(void);

Using these source descriptions you have to do the initialization and
termination manually. A program using these sourcce descriptions looks
like this:
         #include <stdio.h>
         #include <stdlib.h>
         #include <HelloLocalWorld_Cat.h>  /*  You @{i}must@{ui} include this! */
         #include <clib/exec_protos.h>
     
         struct Library *LocaleBase;
     
         void main(int argc, char *argv[])
         { /*  Open the library for yourself, even if the compiler supports  */
           /*  automatic opening. @{i}NO@{ui} exit, if OpenLibrary fails:	*/
           /*  We use the builtin strings in that case.			*/
           /*  For the same reason we must not use autoinitialization of the */
           /*  variable LocaleBase, even if our compiler supports it!	*/
           LocaleBase = OpenLibrary("locale.library", 38);
     
           OpenHelloLocalWorldCatalog(NULL, NULL);
     
           printf("%s\n", GetHelloLocalWorldString(msgHello));
     
           CloseHelloLocalWorldCatalog();
           if (LocaleBase)
     	  CloseLibrary(LocaleBase);
         }

   The last version, being the source descriptions @{b}C_c_V20.h@{ub} and
@{b}C_h.sd@{ub}, is functionally identical except for supporting catalogs
under 2.0. This is done by using the @{b}iffparse.library@{ub} and reading the
catalogs manually.(1) Programs using this look quite the same as the
example above except for an option LANGUAGE which should be used under
2.0 only for calling @{b}OpenXXXCatalog@{ub} and probably even be disabled under
2.1+.

   ---------- Footnotes ----------

   (1)  Of course you could do this even without the @{b}iffparse.library@{ub}
and thus have catalogs under 1.3. However, I don't want to support 1.3
anymore.


@EndNode

@Node "C++" "FlexCat_english.guide/C++"
@Next "Oberon"
@Prev "C"
@Toc "Using FlexCat source"

FlexCat source in C++ programs
==============================

   Using FlexCat source in C++ programs is extremely comfortable: Almost
everything is done by a special class implemented in the files
@{b}C++_CatalogF.cc@{ub} and @{b}C++_CatalogF.h@{ub}. All you have to do is to rename
these files into @{b}CatalogF.cc@{ub} and @{b}CatalogF.h@{ub}, compile them and create
and compile two additional files using the source descriptions
@{b}C++_cc.sd@{ub} and @{b}C++_h.sd@{ub}.  The former will create a file with the
strings (which must be compiled too, of course) and the latter will be
included into your own program.  A C++ program which uses FlexCat
source will look like this:
         #include <iostream.h>
         extern "C"
         {
         #include <clib/exec_protos.h>
         }
         #include "CatalogF.h"
         #include "HelloLocalWorld_Cat.h"
     
         struct LocaleBase *LocaleBase = 0;
     
         int main()
         { //  You must open the library here, even if your compiler supports
           //  Auto-Opening: This will usually break if the locale.library
           //  is not present. This is not what we want here as we just use
           //  the builtin strings in that case.
           LocaleBase = (struct LocaleBase *) OpenLibrary("locale.library", 38);
     
           const CatalogF cat(0, 0, HelloLocalWorld_ARGS);
     
           cout >> cat.GetString(msgHelloLocalWorld);
     
           if (LocaleBase)
     	  CloseLibrary(LocaleBase);
         }
   A modification of gcc's @{b}libauto.a@{ub} is available which will even allow
to remove the lines concerning the variable @{b}LocaleBase@{ub}.


@EndNode

@Node "Oberon" "FlexCat_english.guide/Oberon"
@Next "Modula-2"
@Prev "C++"
@Toc "Using FlexCat source"

FlexCat source in Oberon programs
=================================

   There are different source descriptions: @{b}AmigaOberon.sd@{ub} is designed
for the current version of the @{b}AmigaOberon@{ub} compiler, @{b}Oberon_V39.sd@{ub} is
for older versions and @{b}Oberon_V38.sd@{ub} uses the @{b}Locale.mod@{ub} from Hartmut
Goebel. @{b}Oberon-A.sd@{ub} is, of course for @{b}Oberon-A@{ub}.

   The function prototypes are
         XXX.OpenCatalog(loc: Locale.LocalePtr; language : ARRAY OF CHAR);
         XXX.GetString(num: LONGINT): Exec.StrPtr;
         XXX.CloseCatalog();

where @{b}XXX@{ub} is the basename from the source description.  See
@{"Source description" Link "Source description"}.

   Finally an example using FlexCat source:
         MODULE HelloLocalWorld;
     
         IMPORT  x:=HelloLocalWorld_Cat; Dos;
     
         BEGIN
           x.OpenCatalog(NIL, "");
     
           Dos.PrintF("%s\n", x.GetString(x.msgHello));
     
           (* Catalog will be closed automatically       *)
           (* when program exits.                        *)
         END Anything;


@EndNode

@Node "Modula-2" "FlexCat_english.guide/Modula-2"
@Next "Assembler"
@Prev "Oberon"
@Toc "Using FlexCat source"

Flexcat source in Modula-2 programs
===================================

   Modula-2 supports a module concept similar to Oberon. This means
that the function names are always the same. Unlike Oberon, however,
Modula-2 needs an implementation and a definition module, that's why
you have to create two files using the source descriptions
@{b}Modula2Def.sd@{ub} and @{b}Modula2Mod.sd@{ub}. These are adapted for the M2Amiga
compiler. Note, that you need the file @{b}OptLocaleL.def@{ub} from version 4.3
of the M2Amiga compiler, too.

   The function prototypes are:
         PROCEDURE OpenCatalog(loc : ld.LocalePtr;
     			  language : ARRAY OF CHAR);
         PROCEDURE CloseCatalog();
         PROCEDURE GetString(num : LONGINT) : ld.StrPtr;

where @{b}XXX@{ub} is the base name from the source description.  See
@{"Source description" Link "Source description"}.

   Finally an example of a program using FlexCat source:
         MODULE HelloLocalWorld;
     
         IMPORT hl: HelloLocalWorldLocale,
     	   io: InOut;
     
         BEGIN
           hl.OpenCatalog(NIL, "");
     
           io.WriteString(hl.GetString(hl.msgHello)); io.WriteLn;
     
           hl.CloseCatalog;
         END HelloLocalWorld.


@EndNode

@Node "Assembler" "FlexCat_english.guide/Assembler"
@Next "E"
@Prev "Modula-2"
@Toc "Using FlexCat source"

FlexCat source in Assembler programs
====================================

   Assembler source is created for usage with the Aztec Assembler.
This should not be very different to other assemblers and you should be
able to implement own source descriptions. The source consists of two
parts: A @{b}.asm@{ub} file which should be assembled and linked without further
notice and an @{b}.i@{ub} include file which defines the string ID's and must be
included by the using program.

   The FlexCat-function names are slightly modified to allow the usage
of different catalogs in one file: These are @{b}OpenXXXCatalog@{ub},
@{b}CloseXXXCatalog@{ub} and @{b}GetXXXString@{ub}, where @{b}XXX@{ub} is the base name from the
source description. The concept is copied from the GadToolsBox and
prooved good, as I think. See @{"Source description" Link "Source description"}.

   As usual the function result is given in d0 and the functions save
registers d2-d7 and a2-a7. OpenCatalog expects its arguments in a0
(pointer to Locale structure) and a1 (Pointer to language string) which
should be NULL in most cases. GetString expects a pointer in a0. You
should not care about what it points to.

   Finally an example of a program using FLexCat source:
     *   HelloLocalWorld.asm
     	include "XXX.i" ; Opening this is a must. This
     			; contains "xref OpenHelloLocalWorldCatalog", ...
     
     	xref	_LVOOpenLibrary
     	xref	_LVOCloseLibrary
     	xref	_AbsExecBase
     
     	dseg
     LocNam: dc.b	"locale.library",0
     	dc.l	_LocaleBase,4	    ; Must be present under this name
     
     	cseg
     
     main:	move.l	#38,d0		    ; Open locale.library
     	lea	LocName,a1
     	move.l	_AbsExecBase.a6
     	jsr	_LVOOpenLibrary(a6)
     *   NO exit, if OpenLibrary fails
     
     	sub.l	a0,a0		    ; Open catalog
     	sub.l	a1,a1
     	jsr	OpenHelloLocalWorldCatalog
     
     	lea.l	msgHello,a0	    ; Get pointer to string
     	jsr	GetHelloLocalWorldString
     	jsr	PrintD0 	    ; and print it
     
     Ende:
     	jsr	CloseHelloLocalWorldCatalog ; Close Catalog
     	move.l	_LocaleBase,a1	    ; Close locale.library
     	move.l	a1,d0		    ; this test is a must for 1.3
     	beq	Ende1
     	jsr	CloseLibrary
     Ende1:
     	rts
     	end


@EndNode

@Node "E" "FlexCat_english.guide/E"
@Prev "Assembler"
@Toc "Using FlexCat source"

FlexCat source in E programs
============================

   Since version 3.0 E allows to split a programs in separate modules.
The following describes the usage of @{b}E30b.sd@{ub} which works with E3.0b or
later. (Version 3.0a had significant bugs, previous versions might use
@{b}E21b.sd@{ub} which needs inserting the created source into the own source
manually.)

   @{b}E30b.sd@{ub} creates a module called @{b}Locale@{ub} which contains a variable @{b}cat@{ub}
of type @{b}catalog_XXX@{ub}, where @{b}XXX@{ub} is the basename from the source
description. See @{"Source description" Link "Source description"}.  A file @{b}HelloLocalWorld.e@{ub} might
look like this:
         MODULE '*Locale'
     	-> Use this module
     
         DEF cat : PTR TO catalog_HelloLocalWorld
     	-> This variable contains all the catalog strings and some
     	-> methods. You must declare it in any module using
     	-> Localization, but initialize it in the main module only.
     
         PROC main()
     
     	localebase := OpenLibrary('locale.library', 0)
     	    -> Open locale.library; @{i}No@{ui} exit, if it cannot
     	    -> be opened: We use the builtin strings in that case.
     
     	NEW cat.create()
     	cat.open()
     	    -> As already mentioned, this is needed in the main
     	    -> module only.
     
     	WriteF('\s\n', cat.msg_Hello_world.getstr())
     	    -> cat.msg_Hello_world one of the strings contained in
     	    -> cat. This string declares a method getstr() which
     	    -> reads the catalog and returns a pointer to the
     	    -> localized string.
     
     	cat.close()
     	IF localebase THEN CloseLibrary(localebase)
         ENDPROC


@EndNode

@Node "Future" "FlexCat_english.guide/Future"
@Next "Credits"
@Prev "Using FlexCat source"
@Toc "Main"

Further development of FlexCat
******************************

   I don't expect much further development for I think FlexCat to be
rather complete. Of course I'm open for suggestions, tips or critics.
Especially I offer to include new string types because this is possible
with very minor changes.

   I would be pleased, if someone would send me new source descriptions
and I could introduce them into further distributions. Any programming
language, any extensions, provided that they are prooved good by
testing the source in a real existing program. And I would appreciate
receiving new catalogs.  It is enough to insert the strings in the file
@{b}NewCatalogs.ct@{ub} which is part of the distribution.


@EndNode

@Node "Credits" "FlexCat_english.guide/Credits"
@Next "Index"
@Prev "Future"
@Toc "Main"

Credits
*******

   My thanks go to:
@{i}Albert Weinert@{ui}
     for KitCat, the predecessor of FlexCat which has done me valuable
     things, but finally wasn't flexible enough, and for the Oberon
     source descriptions.

@{i}Reinhard Spisser und Sebastiano Vigna@{ui}
     for the Amiga version of texinfo. This documentation is written
     using it.

@{i}The Free Software Foundation@{ui}
     for the original version of texinfo and many other excellent
     software.

@{i}Matt Dillon@{ui}
     for DICE and especially for DME.

@{i}Alessandro Galassi@{ui}
     for the italian catalog.

@{i}Lionel Vintenat@{ui}
     for the E source description and its documentation, the french
     catalogs and bug reports.

@{i}Antonio Joaquín Gomez Gonzalez (u0868551@oboe.etsiig.uniovi.es) for@{ui}
     the C++ source descripton, the spanish translation of the manual,
     the spanish catalog and the very good hint on speeding up the
     GetString function.

@{i}Olaf Peters (op@hb2.maus.de) for the Modula-2 source description@{ui}
@{i}Russ Steffen (steffen@uwstout.edu)@{ui}
     for the suggestion of the FLEXCAT_SDDIR variable.

@{i}Lauri Aalto (kilroy@tolsun.oulu.fi)@{ui}
     for the finnish catalogs.

@{i}Marcin Orlowski (carlos@felix.univ.szczecin.pl)@{ui}
     for the polnish catalogs and for maintaining the polnish locale
     package.

@{i}The people of #AmigaGer@{ui}
     for answering many stupid questions and lots of fun, for example
     stefanb (Stefan Becker), PowerStat (Kai Hoffmann), \ ill (Markus
     Illenseer), Quarvon (Jürgen Lang), ZZA (Bernhard Möllemann),
     Tron (Mathias Scheler), mungo (Ignatios Souvlatzis), \ jow
     (Jürgen Weinelt) und Stargazer (Petra Zeidler).

@{i}Commodore@{ui}
     for the Amiga and Kickstart 2.0. Keep on developing it and I'll be
     an Amiga-user for the next 8 years too. ;-)


@EndNode

@Node "Index" "FlexCat_english.guide/Index"
@Prev "Credits"
@Toc "Main"

Index
*****

@Index "Index"

x8

 @{" .cd " Link "Catalog description"}                                  Catalog description
 @{" .ct " Link "Catalog translation"}                                  Catalog translation
 @{" .sd " Link "Source description"}                                  Source description
 @{" Adress " Link "Disclaimer"}                               Disclaimer
 @{" AmigaOberon " Link "Oberon"}                          Oberon
 @{" Ascii-Code " Link "Catalog description"}                           Catalog description
 @{" Assembler " Link "Assembler"}                            Assembler
 @{" Author " Link "Disclaimer"}                               Disclaimer
 @{" AutoC_c.sd " Link "C"}                           C
 @{" AutoC_h.sd " Link "C"}                           C
 @{" AztecAs_asm.sd " Link "Assembler"}                       Assembler
 @{" AztecAs_i.sd " Link "Assembler"}                         Assembler
 @{" C " Link "C"}                                    C
 @{" C++ " Link "C++"}                                  C++
 @{" C++_CatalogF.cc " Link "C++"}                      C++
 @{" C++_CatalogF.h " Link "C++"}                       C++
 @{" C++_cc.sd " Link "C++"}                            C++
 @{" C++_h.sd " Link "C++"}                             C++
 @{" Catalog description " Link "Catalog description"}                  Catalog description
 @{" Catalog translation " Link "Catalog translation"}                  Catalog translation
 @{" CLI " Link "Program start"}                                  Program start
 @{" Contributions " Link "Future"}                        Future
 @{" Control characters " Link "Catalog description"}                   Catalog description
 @{" Copyright " Link "Disclaimer"}                            Disclaimer
 @{" Credits " Link "Credits"}                              Credits
 @{" C_c_V20.sd " Link "C"}                           C
 @{" C_c_V21.sd " Link "C"}                           C
 @{" C_h.sd " Link "C"}                               C
 @{" Deutsch.ct " Link "Catalog translation"}                           Catalog translation
 @{" Distribution " Link "Disclaimer"}                         Disclaimer
 @{" E " Link "E"}                                    E
 @{" E21b.sd " Link "E"}                              E
 @{" E30b.sd " Link "E"}                              E
 @{" FlexCat " Link "Future"}                              Future
 @{" FlexCat source " Link "Using FlexCat source"}                       Using FlexCat source
 @{" FlexCat.cd " Link "Catalog description"}                           Catalog description
 @{" Future " Link "Future"}                               Future
 @{" Installation " Link "Installation"}                         Installation
 @{" Internet " Link "Disclaimer"}                             Disclaimer
 @{" Mail " Link "Disclaimer"}                                 Disclaimer
 @{" Modula-2 " Link "Modula-2"}                             Modula-2
 @{" Modula2Def.sd " Link "Modula-2"}                        Modula-2
 @{" Modula2Mod.sd " Link "Modula-2"}                        Modula-2
 @{" Oberon " Link "Oberon"}                               Oberon
 @{" Oberon-A " Link "Oberon"}                             Oberon
 @{" Oberon_V38.sd " Link "Oberon"}                        Oberon
 @{" Oberon_V39.sd " Link "Oberon"}                        Oberon
 @{" Permissions " Link "Disclaimer"}                          Disclaimer
 @{" Prohibitions " Link "Disclaimer"}                         Disclaimer
 @{" Requirements " Link "Installation"}                         Installation
 @{" Source description " Link "Source description"}                   Source description
 @{" Survey " Link "Survey"}                               Survey
 @{" Using FlexCat source " Link "Using FlexCat source"}                 Using FlexCat source
 @{" Workbench " Link "Program start"}                            Program start

@EndNode

