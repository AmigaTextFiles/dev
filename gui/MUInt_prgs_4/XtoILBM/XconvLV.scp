.key selected/a
.bra {
.ket }



;    FILENAME: XconvLV.scp

;    REQUIRES: XtoILBM
;              DOSREQTOOLS
;              MAGIC USER INTERFACE (MUI)
;              MUINT
;              DOS 3.0
;              DATATYPES
;              VIEWTEK, MULTIVIEW OR ANOTHER VIEWER

;    OVERVIEW: CONVERTS THE PICTURE FILE IN THE LISTVIEW TO ILBM FORMAT.
;              THE CONVERTED FILE IS TO COPIED TO RAM: AND RENAMED WITH THE
;              EXTENSION ".ILBM"

;    NOTICE:   QUIT 0 IS REQUIRED TO EXIT THESE SCRIPTS
;--------------------------------------------------------------------------

FAILAT 21

;--------------------------------------------------------------------------
;              CHECK TO SEE IF A FILE WAS SELECTED
;              NOTICE: NO CHECKS ARE MADE TO SEE IF {SELECTED} IS A
;              REAL PICTURE FILE
;--------------------------------------------------------------------------

if exists  {selected}

;--------------------------------------------------------------------------
;              TAKE THE FILENAME OF {SELECTED} AND ASSIGN IT TO $TEMPNAME
;--------------------------------------------------------------------------


     filepart >env:tempname {selected}

     XtoILBM {selected} RAM:$tempname

          if warn

               skip failed

          else

;--------------------------------------------------------------------------
;              CHANGE THE EXTENSION TO ".ILBM" AND 
;              STORE THE RESULT IN $TEMP
;--------------------------------------------------------------------------

               changeext >env:temp ram:$tempname ".ILBM"

;--------------------------------------------------------------------------
;              MAKE $LAST EQUAL TO $TEMP
;              $LAST IS NOW AVAILABLE TO OTHER SCRIPTS FOR
;              VIEWING, DELETING AND COPYING
;--------------------------------------------------------------------------

               setenv last $temp

;--------------------------------------------------------------------------
;              CHANGE THE FILENAME IN RAM: TO REFLECT THE NEW EXTENSION
;--------------------------------------------------------------------------
               if not exists ram:$temp
                    rename ram:$tempname $temp
               endif
;--------------------------------------------------------------------------
;              CALL THE VIEWER TO DISPLAY THE PICTURE
;--------------------------------------------------------------------------

               $XTviewer $temp
     
               QUIT 0

          endif
endif


LAB FAILED

rtezrequest TITLE "System Error Advice:" BODY "The procedure you requested has failed.\nConvert {selected} to $temp n\n  Possibilities: \n1. The filetype is not supported by a datatype.\n2. The Viewing script is not available.\n3. The file is not a picture.\n4. Cosmic Interference" BUTTONTEXT "Continue" pos centerscr 

QUIT 0


