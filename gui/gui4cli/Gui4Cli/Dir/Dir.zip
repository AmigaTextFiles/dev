G4C


WINBIG -1 -1 423 39 'ZIP selected files/dirs to :'
WinType 11110010
resinfo 8 640 256
varpath dir.gc

BOX 0 0 0 0 out button

xOnLoad
gosub dir.zip startup

xOnReload
gosub dir.zip startup

xRoutine StartUp
old_dir  = $$G4C.DIR
cd $$lv.dir
lvmulti first
if $lv_file = ""
   ezreq "ZIP:\nChoose some files first\nwhy don't you ?" OK ""
   guiquit dir.zip
   stop
endif
guiopen dir.zip

xOnOpen
setgad dir.zip 2 ON

xOnClose
guiquit dir.zip

xOnQuit
cd $old_dir

xOnFail
guiwindow dir.zip resume

;========================= Gadgets

XTEXTIN 10 5 400 14 "" zipname "RAM:MyFiles.zip" 130
gadid 2
gadhelp 'Enter name of Archive'

XBUTTON 10 20 99 14 "Pack"
gadhelp 'Click to start packing...'
zipcom = 'zip -r $zipname'
while $lv_file > ""
    extract lv_file file zipfile
    appvar  zipcom ' $zipfile'
    lvmulti next
endwhile
setwintitle dir.zip "Ziping files..."
LAUNCH 1 '$zipcom'
guiwindow dir.zip wait


xOnReturn 1
guiwindow dir.zip resume
guiquit dir.zip


XBUTTON 230 20 78 14 "Browse.."
gadhelp 'Choose another archive path'
zipreq = ""
ReqFile -1 -1 300 -40 'Destination archive:' SAVE zipreq RAM:
if $zipreq > ""
   zipname = $zipreq
   update dir.zip 2 $zipname
endif


XBUTTON 310 20 100 14 CANCEL
GuiQuit dir.zip


