WBStartup

FindScreen 0
Use Screen 0

Statement openprogind{piw$}
  piw.l=Maximum Window - 1
  Window piw.l,100,100,163,37,$1402,piw$,1,2
  WLine 2,2,2,12,1
  WLine 152,2,152,12,1
  WLine 77,2,77,12,1
  WLine 39,2,39,12,1
  WLine 114,2,114,12,1
  WBox 4,4,150,10,2
  WLocate 30,15
  LoadFont 1,"topaz.font",8
  WindowFont 1
  Print "100 % done"
End Statement

Statement drawprogind{t.l}
  piw.l=Maximum Window - 1
  Use Window piw.l
  WBox 4,4,t.l*146/100+4,10,3
  WLocate 1,15
  LoadFont 1,"topaz.font",8
  WindowFont 1
  Print Centre$(Right$(SPACE$(3)+UStr$(t.l),3)+" % done",20)
End Statement

Statement closeprogind{}
  piw.l=Maximum Window - 1
  CloseWindow piw.l
End Statement

;*** Test **********************************************
openprogind{"Please wait..."}
For i.l = 0 To 100
  drawprogind{i.l}
  Delay_ 3
Next i
MouseWait
closeprogind{}

