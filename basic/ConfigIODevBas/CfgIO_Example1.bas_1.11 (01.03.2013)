' *********************************************************************
'      CfgIO_Example1.bas by/de Dámaso D. Estévez {este, son, eu}
'          AmiSpaTra - http://www.xente.mundo-r.com/amispatra/
'                             ------------
'            All rights reserved over this derivative work:
'                 my Hisoft Basic developpers package.
'       Forbidden to remove ALL legal/copyrights remarks included
'            in this package: if you create a derivate work,
'                 you MUST to include all legal notes.
'
'                  Creating an ficticious config file
'                             ------------
'           Creación de un fichero de configuración ficticio
'
'      Todos los derechos reservados sobre este trabajo derivado:
'    mi paquete para desarrolladores que programen con Hisoft Basic.
'          Está prohibido eliminar cualquier comentario o nota
'     de autoría/legal de este paquete: si crea un trabajo derivado
'        HA DE INCLUIR OBLIGATORIAMENTE TODAS LAS NOTAS LEGALES.
' *********************************************************************

' ---------------------------------------------------------------------
'                Include files / Ficheros de inclusión
' ---------------------------------------------------------------------

'         OS / SO
' ------------------------
REM $include exec.bh
REM $include dos.bh
REM $include utility.bc
REM $include asl.bh

' ConfigIO
' --------
REM $include configio.bh

' ---------------------------------------------------------------------
'    From/De:  http://aminet.net/package/dev/basic/AST_HBRoutines
' ---------------------------------------------------------------------
REM $include BLib_AST/StrTo.bas
REM $include BLib_AST/SReqScr.bas

' ---------------------------------------------------------------------
'                 C= string version / Cadena de versión de C=
' ---------------------------------------------------------------------
v$ = "$VER: CfgIO_Example1.bas 1.11 (01.03.2013) by Dámaso 'AmiSpaTra' Domínguez "+CHR$(0)

' ---------------------------------------------------------------------
'                  Main program / Programa principal
' ---------------------------------------------------------------------

LIBRARY OPEN "exec.library"
LIBRARY OPEN "dos.library"
LIBRARY OPEN "asl.library",36
LIBRARY OPEN "configio.library", ConfigIOVersion&

'      Array for the functions' results
' Matriz para los resultados de las funciones
' -------------------------------------------
DIM result&(6)

'   Application's name
' Nombre de mi aplicación
' -----------------------
a$ = "CfgIOExample_MyFakeApp"

'      Config file name and their path
' Nombre y ruta del fichero de configuración
' ------------------------------------------
f$ = "ENV:"+a$+".cfg"

'    Exit code: Initial hypothesis
' Código de salida: Hipótesis inicial
' -----------------------------------
e& = RETURN_OK&

PRINT "One moment, please / Aguarde un momento, por favor..."

cfg& = CfgIO_NewConfig&(SADD(Str2C$(a$)),SADD(Str2C$("$VER: "+a$+" 2.0 (01/03/2013) © AmiSpaTra")))

IF cfg& THEN

	' Screen requester for to select the screen mode
	'   Petición de pantalla para elegir el modo
	' ----------------------------------------------
	result&(0) = SReqScr&(NULL&, a$, 15&, 15&, 100&, 100&, scrmd&, 110&, 0&, TRUE&, TRUE&, 110&, 50&)

	'          Creating elements in two sections named Interface and Work (reusing result&(0))
	' Creando elementos dentro de dos secciones denominadas Interface y Work (reutilización de result&(0))
	' ----------------------------------------------------------------------------------------------------
	result&(1) = CfgIO_WriteBool&(			cfg&, SADD(Str2C$("Interface")),	SADD(Str2C$("AslReq")),		TRUE&)
	result&(2) = CfgIO_WriteUnsignedInteger&(		cfg&, SADD(Str2C$("Interface")),	SADD(Str2C$("ScreenMode")),	scrmd&)

	result&(3) = CfgIO_WriteString&(			cfg&, SADD(Str2C$("Work")),		SADD(Str2C$("TempFile")),	SADD(Str2C$("T:MyApp_TempFile.raw")))
	result&(4) = CfgIO_WriteSignedInteger&(		cfg&, SADD(Str2C$("Work")),		SADD(Str2C$("Delta")),		-2%)

	'    Checking the results
	' Comprobando los resultados
	' --------------------------
	FOR i% = 1% TO 4%
		IF result&(i%) = NULL& THEN
			e& = RETURN_WARN&
			PRINT result&(i%)
			PRINT " > Failing to create the config's entry #";i%;" / Fallo al crear la entrada de configuración nº";i%
		END IF
	NEXT i%

	'             Saving the config file
	' Guardando en disco el fichero de configuración
	' ----------------------------------------------
	result&(5) = CfgIO_WriteConfig&(cfg&,SADD(Str2C$(f$)))

	IF result&(5) = NULL& THEN

		e& = RETURN_FAIL&
		PRINT "I can't write the (full) config file / No puedo escribir el fichero de configuración (completamente)"

	ELSE

		PRINT "Created the config file / Creado el fichero de configuración : ";CHR$(34);f$;CHR$(34)
		PRINT "Please, execute the CfgIO_Example2 exe / Por favor, ejecute el ejecutable CfgIO_Example2"

	END IF

	result&(6) = CfgIO_RemConfig&(cfg&)

	IF result&(6) = NULL& THEN

		e& = RETURN_WARN&

	END IF

ELSE

	e& =RETURN_FAIL&

END IF

LIBRARY CLOSE

STOP e&

' ---------------------------------------------------------------------
