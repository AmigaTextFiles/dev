@DATABASE ToolType 1.01
$VER: Pure Basic - ToolType library V1.01 (11.06.2000) © Fantaisie Software
@NODE MAIN "ToolType"


  @{b}Pure Basic - ToolType V1.01@{ub}

    The 'Tooltypes' are located in a workbench icon. It's some
    strings you can easely write and read to store, for example,
    your program configuration. This is very useful because you
    don't need to create a separate file and the user can modify
    it himslef via the menu 'Icon/Information' of the Workbench
    screen.

  @{b}Commands summary:@{ub}

    @{" FreeToolType          " LINK FreeToolType}
    @{" GetNextToolTypeString " LINK GetNextToolTypeString}
    @{" GetNumberOfToolTypes  " LINK GetNumberOfToolTypes}
    @{" GetToolTypeValue      " LINK GetToolTypeValue}
    @{" InitToolType          " LINK InitToolType}
    @{" MatchToolType         " LINK MatchToolType}
    @{" MatchToolTypeString   " LINK MatchToolTypeString}
    @{" ReadToolTypeDiskInfo  " LINK ReadToolTypeDiskInfo}
    @{" WriteToolTypeDiskInfo " LINK WriteToolTypeDiskInfo}

    @{" ToolType Demo " LINK PureBasic:Examples/Sources/ToolType.pb/Main}
@ENDNODE


@Node FreeToolType

    @{b}SYNTAX@{ub}
  FreeToolType(@{b}#Info@{ub}.w)

    @{b}STATEMENT@{ub}
  This statement frees a ToolType info that was initialized with
  ReadToolTypeDiskInfo(), but it doesn't care if the info to free
  isn't initialized.

  @{b}#Info@{ub}
  The info to free.
@EndNode


@Node GetNextToolTypeString

    @{b}SYNTAX@{ub}
  @{b}String@{ub}$ = GetNextToolTypeString(@{b}#Info@{ub}.w)

    @{b}FUNCTION@{ub}
  This function returns the next ToolType and all associated values
  as a string.

  After the last ToolType is reached the next ToolType that will be
  returned is the first one. To find out how many ToolType strings
  exist, use the return value from the function GetNumberOfToolTypes().

  A ToolType is in length restricted to 128 bytes by the OS.

  @{b}#Info@{ub}
  The info to use.

  @{b}String@{ub}
  The returned string holds the ToolType and all associated values like
  this  "AMIGA=1200|4000".
@EndNode


@Node GetNumberOfToolTypes

    @{b}SYNTAX@{ub}
  @{b}Result@{ub}.w = GetNumberOfToolTypes(@{b}#Info@{ub}.w)

    @{b}FUNCTION@{ub}
  This function returns the number of ToolTypes that are present
  in the icon's .info file, this should be used to easily fetch
  the right number of ToolType strings.

  @{b}#Info@{ub}
  The info to use.

  @{b}Result@{ub}
  Any value higher than zero is the number of ToolTypes there is in
  the  icon's .info file, but if it's instead  0  this indicate that
  no ToolType at all is present in icon's .info file.
@EndNode


@Node GetToolTypeValue

    @{b}SYNTAX@{ub}
  @{b}String@{ub}$ = GetToolTypeValue(@{b}#Info@{ub}.w,@{b}ToolName@{ub}$)

    @{b}FUNCTION@{ub}
  This function returns the associated values, to the specified ToolType,
  as a string.

  @{b}#Info@{ub}
  The info to use.

  @{b}String@{ub}
  The returned string holds the Tool value like this "1200|4000", but
  if the ToolType was not present in icon's .info file the string
  will be empty.
@EndNode


@Node InitToolType

    @{b}SYNTAX@{ub}
  @{b}Result@{ub}.l = InitToolType(@{b}#Infos@{ub}.l)

    @{b}FUNCTION@{ub}
  This is the init routine and should always be called before any
  other ToolType function. If there is a failure with this call
  then no other function should be called.

  @{b}#Infos@{ub}
  This parameter specifies how many ToolType infos are needed.
  Each info can hold data about one .info file.

  Maximum number of infos is 2046.

  @{b}Special Note:@{ub}
  The second parameter, used in version 1.00, that could hold
  a value of zero or be a return value from WBStartup() is gone.
  This is now done automatically with the restriction that
  WBStartup() must be called befor InitToolType().

  If InitToolType() detects that the program is started from
  WorkBench then #Info 0 will be automatically initialized from
  the .info file of the double clicked icon and the current
  directory is also set to the directory of this icon.

  @{b}Result@{ub}
  If some error has occurred then result is FALSE and there is no
  point in calling any other ToolType functions.
@EndNode


@Node MatchToolType

    @{b}SYNTAX@{ub}
  @{b}Result@{ub}.w = MatchToolType(@{b}#Info@{ub}.w,@{b}ToolName@{ub}$,@{b}Value@{ub}$)

    @{b}FUNCTION@{ub}
  This function checks if ToolType is present and if it's set to
  the specified value.

  None of the ToolTypes need to be read into Pure Basic strings for
  this function, it's convenient when ToolTypes only need to be
  examined.

  @{b}#Info@{ub}
  The info to use.

  @{b}ToolName@{ub}
  This is the ToolType to look out for.

  @{b}Value@{ub}
  This is the value to look out for, could be a empty string.

  @{b}Result@{ub}
  If this is -1 the ToolType is not present in icon's .info file, if
  it's instead 0 the ToolType is found but it's not set to the specified
  value and finally if it's 1 then the ToolType is found and have one
  value that is the same as third parameter.
@EndNode


@Node MatchToolTypeString

    @{b}SYNTAX@{ub}
  @{b}Result@{ub}.w = MatchToolTypeString(@{b}String@{ub}$,@{b}ToolName@{ub}$,@{b}Value@{ub}$)

    @{b}FUNCTION@{ub}
  This function checks if a Pure Basic string holds a specific
  ToolType and a matching value.

  @{b}String@{ub}
  This is the string to examine.

  @{b}ToolName@{ub}
  This is the ToolType to check for.

  @{b}Value@{ub}
  This is the value to check for, could be a empty string.

  @{b}Result@{ub}
  If this is -1 the ToolType is not present in Pure Basic string, if
  it's instead 0 the ToolType is found but it's not set to the specified
  value and finally if it's 1 then the ToolType is found and have one
  value that is the same as third parameter.
@EndNode


@Node ReadToolTypeDiskInfo

    @{b}SYNTAX@{ub}
  @{b}Result@{ub}.l = ReadToolTypeDiskInfo(@{b}#Info@{ub}.w,@{b}IconName@{ub}$)

    @{b}FUNCTION@{ub}
  This function reads the icon's .info file that is specified by name
  and initializes the ToolType info.

  If the info is already initialized this function doesn't care and
  just creates the new info without deleting the old one - then
  there is no possibile way to preform any actions on the old info.

  Maximum number of ToolTypes that could be handled is 32767,
  restricted by this Pure Basic Lib.

  @{b}#Info@{ub}
  The info to use.

  @{b}IconName@{ub}
  The icon's name: ".info" is automatically added to the end of name.

  @{b}Result@{ub}
  If this is set to FALSE the icon's .info file couldn't be read.
@EndNode


@Node WriteToolTypeDiskInfo

    @{b}SYNTAX@{ub}
  @{b}Result@{ub}.w = WriteToolTypeDiskInfo(@{b}#Info@{ub}.w,@{b}Array()@{ub},@{b}IconName@{ub}$)

    @{b}FUNCTION@{ub}
  This function writes the icon's .info file back to disk.

  @{b}#Info@{ub}
  The info to use.

  @{b}Array()@{ub}
  This array hold the strings that contain the new ToolTypes
  to be written.

  The new ToolTypes have priority over old ToolTypes. So if
  only one ToolType is added or changed then all ToolTypes
  must first be read into Pure Basic strings with the function
  GetNextToolTypeString() and then written back.

  Maximum number of ToolTypes that could be handled is 32767,
  restricted by this Pure Basic Lib.

  @{b}IconName@{ub}
  The icon's name: ".info" is automatically added to the end of name.

  @{b}Result@{ub}
  If this is TRUE then the writing was successful.
@EndNode

