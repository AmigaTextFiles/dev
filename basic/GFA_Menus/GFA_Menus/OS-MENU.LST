OPENW #0,0,0,400,100,512,4108! *** Use "4108 or &H200000" for WB 3.0+ NewLook
DIM m$(20)
m$(0)="Project"
m$(1)="About       "
m$(2)="-~~~~~~~~~~~~"
m$(3)="Quit...     "
m$(4)=""
m$(5)="Test"
m$(6)="Sub Items »"
m$(7)="!1"
m$(8)="!2"
m$(9)=""
m$(10)=""
MENU m$()
MENU KEY 1,ASC("A")
MENU KEY 3,ASC("Q")
REPEAT
  msg=WaitPort(LPEEK(WINDOW(0)+86))
  msg=GetMsg(LPEEK(WINDOW(0)+86))
  WHILE (msg)
    class%=LPEEK(msg+20)
    code%=DPEEK(msg+24)
    ~ReplyMsg(msg)
    IF HEX$(class%)="200" ! *** CLOSEWINDOW
      CLOSEW #0
      EDIT
    ENDIF
    IF HEX$(class%)="100" ! *** MENUPICK
      i$=RIGHT$(STRING$(16,"0")+BIN$(code%),16)
      s%=VAL("%"+MID$(i$,1,5)) ! *** sub item
      i%=VAL("%"+MID$(i$,6,6)) ! *** menu item
      m%=VAL("%"+MID$(i$,12,5)) ! menu
      SELECT m%
      CASE 0 ! *** First menu (# 0)
        SELECT i%
        CASE 0 ! *** About
          ALERT 0,"System friendly|event handling!",1,"Continue",nk%
        CASE 1 ! *** Separator
          '
        CASE 2 ! *** Quit...
          ALERT 0,"Quit demo?",0,"Yes|No",nk%
          IF nk%=1
            CLOSEW #0
            EDIT
          ENDIF
        DEFAULT
        ENDSELECT
      CASE 1 ! *** Second menu (# 1)
        SELECT i%
        CASE 0 ! *** Sub Item...
          SELECT s%
          CASE 0
            CLS
            PRINT "Sub item #1"
          CASE 1
            CLS
            PRINT "Sub item #2"
          DEFAULT
          ENDSELECT
        DEFAULT
        ENDSELECT
      DEFAULT
      ENDSELECT
    ENDIF
    msg=GetMsg(LPEEK(WINDOW(0)+86))
  WEND
UNTIL FALSE
EDIT
