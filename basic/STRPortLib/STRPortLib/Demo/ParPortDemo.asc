; STRPort.obj  (c) 1998-2001 by Stephan Richartz
;
; Parallel Port Demo  (Drucker anschliessen...)
;                     (connect the printer...)
;
; SetParDDR, GetParDDR, WriteParPort, ReadParPort


SetParDDR 255                  ; setzt alle 8 Leitungen auf Ausgang.
                               ; put all pins to output

If GetParDDR=255               ; sind auch Alle auf Ausgang gesetzt ?
                               ; (hier zu Demozwecken. Muss nicht sein)
                               ; read the DataDirectionRegister

  Text$="Es klappt !"+Chr$(10) ; etwas schreiben...
                               ; some Text...

  For i=1 To Len(Text$)        ;
    m$=Mid$(Text$,i,1)         ; Text$ in einzelne Zeichen teilen
    WriteParPort Asc(m$)       ; ASC-Wert zum parallelen Port uebertragen
  Next                         ;

EndIf
End                            ; Das wars! Ready!



; SetParDDR 0                  ; setzt alle 8 Leitungen auf Eingang.
                               ; put all pins to input
; nprint ReadParPort           ; liest den Zustand des parallelen Ports aus
                               ; get the byte from Port
; SetParDDR %11000011          ; Leitung (Bit) 1,2,7,8 = Ausgang (output)
                               ; Leitung (Bit) 3,4,5,6 = Eingang (input)
