@database "LockWindow"
@master "Work:Oberon/LockWindow/LockWindow.doc"

@Node Main "LockWindow.doc"
    @{" --AMOK-Header--() " Link "--AMOK-Header--()"}
    @{" --background-- " Link "--background--"}
    @{" --history--() " Link "--history--()"}
    @{" --interface--() " Link "--interface--()"}
    @{" ClearWaitPointer() " Link "ClearWaitPointer()"}
    @{" LockWindow() " Link "LockWindow()"}
    @{" SetWaitPointer() " Link "SetWaitPointer()"}
    @{" UnlockWindow() " Link "UnlockWindow()"}
@EndNode

@Node "--AMOK-Header--()" "LockWindow/--AMOK-Header--"

Program.    LockWindow.mod
Author.     Albert Weinert [awn], Kai Bolai [kai],
Author.     hartmut Goebel [hG], Oliver Knorr [olk]
Version.    $VER: LockWindow.mod 1.4 (16.2.95)
Copyright.  Freeware
Language.   Oberon
Translator. Amiga Oberon 3.11
Contents.   Procedures for setting a "busy"-mousepointer and for "locking"
Contents.   windows, so all user input is blocked.

@EndNode

@Node "--background--" "LockWindow/--background--"

       The "User Interface Style Guide" (UISG) suggests that the user
       should be informed when a window can temporary not accept any
       input. The most simple possibility is to use a "busy" mouse-pointer.
       A "busy"-pointer has a special look defined in the UISG.

       This module gives you one set of procedures to set and remove
       only the busy-pointer and another to both change the mouse-pointer
       and block all user input by opening an invisible Intuition
       Requester.

@EndNode

@Node "--history--()" "LockWindow/--history--"

@{b}   V1.4   : 16-Feb-1995 [olk]@{ub}
       @{"UnlockWindow()" Link "UnlockWindow()"} uses @{"ClearWaitPointer()" Link "ClearWaitPointer()"} instead of I.ClearPointer().
       All procedures now check for NIL-pointers.
       Documentation revised and translated to English.

@{b}   V1.3   : 24-Sep-1993 [awn]@{ub}
       New documentation in AutoDoc-Format.

@{b}   V1.2   : 19-Sep-1993 [hG] (based on V1.1)@{ub}
       @{"LockWindow()" Link "LockWindow()"} now uses SYSTEM.ALLOCATE().
       Under V39+ the default BusyPointer is used.
       Now works with garbage collector.
       Needs V39 Interfaces.

@{b}   V1.1.1 : ??-???-???? [kai]@{ub}
       Under V39+ the default BusyPointer is used.

@{b}   V1.1   : 19-Aug-1992 [awn]@{ub}
       Mouse-pointer setting has been moved to separate Procedures.

@{b}   V1.0   : 02-Aug-1992 [awn]@{ub}
       First working version.

@EndNode

@Node "--interface--()" "LockWindow/--interface--"

DEFINITION LockWindow;

IMPORT
  I := Intuition;

PROCEDURE SetWaitPointer(window: I.WindowPtr);
PROCEDURE ClearWaitPointer(window: I.WindowPtr);
PROCEDURE LockWindow(window: I.WindowPtr): I.RequesterPtr;
PROCEDURE UnlockWindow(VAR req: I.RequesterPtr);

END LockWindow.

@EndNode

@Node "ClearWaitPointer()" "LockWindow/ClearWaitPointer"

@{b}   NAME@{ub}
       ClearWaitPointer -- set a window's mouse-pointer to "normal"-state

@{b}   SYNOPSIS@{ub}
       ClearWaitPointer (window: I.WindowPtr)

@{b}   FUNCTION@{ub}
       Removes the "busy" mouse-pointer from a window.

@{b}   INPUTS@{ub}
       window = Intuition Window that shall get a "normal" mouse-pointer,
                as defined in preferences.

@{b}   NOTES@{ub}

@{b}   SEE ALSO@{ub}
       @{"SetWaitPointer()" Link "SetWaitPointer()"}

@EndNode

@Node "LockWindow()" "LockWindow/LockWindow"

@{b}   NAME@{ub}
       LockWindow -- lock an Intuition Window

@{b}   SYNOPSIS@{ub}
       LockWindow (window: I.WindowPtr): I.RequesterPtr

@{b}   FUNCTION@{ub}
       Locks an Intuition Window by opening an invisible Requester,
       so all user input is completely blocked. To give the user a visible
       hint for this, the mouse-pointer is set to "busy"-look with
       @{"SetWaitPointer()" Link "SetWaitPointer()"}.

@{b}   INPUTS@{ub}
       window = Intuition Window that shall be locked

@{b}   RESULTS@{ub}
       Pointer to the invisible Intuition Requester. Use it to
       unlock the Window again.

@{b}   EXAMPLE@{ub}

       MODULE Test.

       IMPORT lw := LockWindow,
              I  := Intuition,

       VAR req: I.RequesterPtr;
           win: I.WindowPtr;

       BEGIN
         [......]
         req := lw.LockWindow( win );
         [......]
         lw.UnlockWindow( req );
       END Test.

@{b}   NOTES@{ub}

@{b}   BUGS@{ub}
       The size-gadget of a locked window (if it has one) can still be
       used. So please mind that the user might have changed the window
       size while it was locked.

@{b}   SEE ALSO@{ub}
       @{"UnlockWindow()" Link "UnlockWindow()"}, @{"SetWaitPointer()" Link "SetWaitPointer()"}, Intuition/Request()

@EndNode

@Node "SetWaitPointer()" "LockWindow/SetWaitPointer"

@{b}   NAME@{ub}
       SetWaitPointer -- set a window's mouse-pointer to "busy"-state

@{b}   SYNOPSIS@{ub}
       SetWaitPointer (window: I.WindowPtr)

@{b}   FUNCTION@{ub}
       Changes the look of an Intuition Window's mouse-pointer to "busy".

@{b}   INPUTS@{ub}
       window = Intuition Window that shall get a "busy" mouse-pointer.

@{b}   NOTES@{ub}
       Running und Intuition V39 or higher, the busy-pointer defined in
       preferences will be used. Under ealier versions, the busy-pointer
       suggested by the UISG (a clock) will be used.

       This Procedure only changes the mouse-pointer look, input is *not*
       blocked by this.

@{b}   SEE ALSO@{ub}
       @{"ClearWaitPointer()" Link "ClearWaitPointer()"}, @{"LockWindow()" Link "LockWindow()"}

@EndNode

@Node "UnlockWindow()" "LockWindow/UnlockWindow"

@{b}   NAME@{ub}
       UnlockWindow -- unlock an Intuition Window

@{b}   SYNOPSIS@{ub}
       UnlockWindow (VAR req: I.RequesterPtr)

@{b}   FUNCTION@{ub}
       Unlocks a window that has been locked with @{"LockWindow()" Link "LockWindow()"} and
       restores the normal mouse-pointer.

@{b}   INPUTS@{ub}
       req = Pointer to the Requester returned by @{"LockWindow()" Link "LockWindow()"}.

@{b}   NOTES@{ub}

@{b}   SEE ALSO@{ub}
       @{"LockWindow()" Link "LockWindow()"}, @{"ClearWaitPointer()" Link "ClearWaitPointer()"}

@EndNode

