@DATABASE OS2Unit
@NODE MAIN "OS2Unit by Björn Schotte"
@INDEX MyIndex
@NEXT Willkommen
@{B}
 *****   *****   *****
**   ** **   ** **   **
**   ** **          **
**   **  *****     **    *** Unit
**   **      **   **
**   ** **   **  **  **    @{FG SHINE}©1995,96 by Björn Schotte@{FG TEXT}
 *****   *****  ******     @{FG SHINE}··· GIFTWARE ···@{FG TEXT}@{UB}



@{U}@{B}INHALT@{UB}@{UU}

  @{"Why this Unit?" LINK Warum}

  @{"The Functions/Procedures" LINK Funcs}

  @{"Remarks" LINK Hinweise}

  @{"History" LINK History}

  @{"Address/Copyright" LINK addi}
@ENDNODE
@NODE Warum "Why this Unit?"
@PREV Main
@NEXT Funcs

Well, because I have only been writing programs which
run with OS2.0 or higher for some time, I wanted to
make the "designing" easier with writing a unit, where
many procedures/functions are which I often use in my
own programs.

OS2.x has new functions, e.g. new (and easy) Gadgets etc.
(with gadtools.library). And for this library this unit
supports new functions.

There are many procedures/functions, especially for
fontsensitive programming!
@ENDNODE
@NODE Funcs "The Functions/Procedures"
@PREV Warum
@NEXT Hinweise

Alphabetical list of all procedures/functions of this unit:

@{"ActStringGad" LINK ASG}
@{"ASLFileReq" LINK ASLF}
@{"CloseASL" LINK CASL}
@{"CloseGadTools" LINK CGT}
@{"ComputeFont" LINK CF}
@{"ComputeX" LINK ComputeX}
@{"ComputeY" LINK ComputeY}
@{"DrawBevelLine" LINK DrawBevelLine}
@{"FS_BevelBox" LINK FSB}
@{"GadSelect" LINK GS}
@{"GhostGadget" LINK GG}
@{"InitASLStruct" LINK IASL}
@{"OpenASL" LINK OASL}
@{"OpenGadTools" LINK OGT}
@{"SensitivGadget" LINK SG}
@{"SetCheckBox" LINK SCB}
@{"SetCycleGad" LINK SCG}
@{"SetListViewGad" LINK SLVG}
@{"SetListViewList" LINK SLVL}
@{"SetMXGad" LINK SMG}
@{"SetNumberGad" LINK SNG}
@{"UserReq" LINK UserReq}


Note:

You have to @{"declare" LINK ausfuellen} some variables which are defined in
the INTERFACE-part of this unit in your main program
for fontsensitive programming.
@ENDNODE
@NODE ausfuellen "OS2-Unit/Declaring of variables"
@PREV Funcs
@NEXT hinweise

For the mathematical routines for fontsensitive programming
it is important that you declare some variables! These are:

@{B}ScreenW@{UB}     : Width of the screen, where the window
              should be opened.

@{B}ScreenH@{UB}     : The Height of the screen.

@{B}WBRight@{UB}     : Width of the border on the right side
              (sp^.WBorRight)

@{B}WBBottom@{UB}    : Height of the border on the bottom
              (sp^.WBorBottom)

@{B}XOff@{UB}        : Width of the border on the left side (sp^.WBorLeft)

@{B}YOff@{UB}        : Height of the Windowtitle (Screen^.WBorTop+DrawInfo^.dri_Font^.ty_YSize+1)

@{U}Example:@{UU}

|------------------------- snipp ------------------------|
...
VAR
  ps    : p_Screen;
  drinf : p_DrawInfo;

BEGIN
...
  { Lock Workbenchscreen (or any other screen) }
  ps := LockPubScreen("Workbench");
  IF ps = NIL THEN { Error-handling }

  { Get Screen-DrawInfo }
  drinf := GetScreenDrawInfo(ps);
  IF drinf <> NIL THEN
  BEGIN
    { Copying variables from Screen }
    ScreenW := ps^.Width;  { Width of the screen }
    ScreenH := ps^.Height; { Height of the screen }
    WBRight := ps^.WBorRight;
    WBBottom := ps^.WBorBottom;

    { Copying Font from DrawInfo }
    psfont := drinf^.dri_Font;

    { Calculating offsets }
    XOff := ps^.WBorLeft;
    YOff := ps^.WBorTop + psfont^.tf_YSize + 1;

    { Release DrawInfo }
    FreeScreenDrawInfo(ps,drinf);
  END ELSE { Error-handling }
  UnLockPubScreen(NIL,ps);
  ComputeFont(psfont,0,0);
...
|------------------------- snipp ------------------------|
@ENDNODE
@NODE ASG "OS2-Unit/ActStringGad"

NAME

   ActStringGad

SYNOPSIS

   ActStringGad(wp,gad,req);

   wp  : p_Window;
   gad : p_Gadget;
   req : p_Requester;

DESCRIPTION

   This procedure activates the gadget in the window
   and, if necessary, in the given requester

RETURNS

   None.

BUGS

   None known.
@ENDNODE
@NODE ASLF "OS2-Unit/ASLFileReq"

NAME

   ASLFileReq

SYNOPSIS

   LONG = ASLFileReq(ASLStruct);

   ASLStruct : ASLFileStruct;

   ASLFileStruct = RECORD
          left, top,               { Linke Ecke, rechte Ecke,      }
          width,                   { Breite und                    }
          height     : INTEGER;    { Höhe d. FileReqs (optional)   }
          titel      : STRING[80]; { Titel des FileReqs            }
          pfad,                    { Hier werden Pfad und Datei    }
          datei,                   { von der Prozedur abgelegt.    }
          initp,                   { Vorgegebener Pfad/Datei, der  }
          initd,                   { als erstes im Req dargestellt }
                                   { werden soll.                  }
          filename   : STRING[256];{ Hier wird von der Prozedur ein}
                                   { vollständiger Filename erstellt}
                                   { also z.B. "Work:xx/yy"         }
          pattern    : STRING[80]; { Muster (z.B. "~(#?.info)" (optional) }
          display_pat: BOOLEAN;    { Soll ein String-Gadget im Req }
                                   { dargestellt werden, damit man }
                                   { das Pattern ändern kann ?     }
          win        : p_Window;   { Zugehöriges Window des Reqs (opt.) }
          winsleep,                { Soll Wartezeiger + unsichtb. Req }
                                   { auf <win> geöffnet werden ? }
          canceled   : BOOLEAN;    { Wurde der Requester gecanceled ? }
          negativ,                 { Negativer Gadget-Text (opt.) }
          positiv    : STRING;     { Positiver Gadget-Text (opt.) }
   END;


DESCRIPTION

   This big function gives you an easy-to-handle ASL-Filerequester.
   You have to notice that "asl.library" has to be opened first (e.g.
   with @{"OpenASL" LINK OASL}) because this function doesn't do
   it by itself.

   And the "dos.library" has to be opened because ASLFileReq() uses
   some functions of dos.library.

   At first the program which calls this function, has to init all
   variables of the Structure ASLFileStruct with the procedure
   @{"InitASLStruct" LINK IASL}.

   Then we initialize the structure with our variables. Some
   variables don't have to be filled with values (they have an
   "opt." in the explanation above).

   Well, you fill in the structure and then give it to the Function.
   It returns 0 if all was finde, or FREQ_NOALLEC (=-100). This means
   that the allocation per AllocASLRequest() has failed!

   In our own structure we gave to ASLFileReq(), our complete filename
   is found under @{B}ASLFileStruct.filename@{UB}.

   Under @{B}ASLFileStruct.pfad@{UB} and @{B}ASLFileStruct.datei@{UB} we find the simple
   path or the simple filename.

   Under @{B}ASLFileStruct.pattern@{UB} we find the old pattern or a new one,
   if the user entered one in the filerequester.

   @{B}ASLFileStruct.initp@{UB} and @{B}ASLFileStruct.initd@{UB} are our initialized
   file and path (they are displayed in the string-gadgets in the
   filerequester).

   @{B}ASLFileStruct.canceled@{UB} gives us TRUE if the user has canceled the
   Filerequester.

   I hope all is clear?! ;)

RETURNS

   0, if all was clear or FREQ_NOALLOC if allocating failed!

BUGS

   None known.
@ENDNODE
@NODE CASL "OS2-Unit/CloseASL"

NAME

   CloseASL

SYNOPSIS

   CloseASL

DESCRIPTION

   Closes asl.library, if opened.

RETURNS

   None.

BUGS

   None known.

SEE ALSO

   @{"OpenASL" LINK OASL}
@ENDNODE
@NODE CGT "OS2-Unit/CloseGadTools"

NAME

   CloseGadTools

SYNOPSIS

   CloseGadTools;

DESCRIPTION

   Closes gadtools.library, if opened.

RETURNS

   Nothing.

BUGS

   None known.

SEE ALSO

   @{"OpenGadTools" LINK OGT}
@ENDNODE
@NODE CF "OS2-Unit/ComputeFont"

NAME

   ComputeFont

SYNOPSIS

   ComputeFont(TheFont, width, height);

   TheFont : p_TextFont;
   width,
   height  : INTEGER;

DESCRIPTION

   Main procedure for fontsensitive GUIs.

   Parameters are: The font which we want
   to use, width and height we want to use.

   It checks if our font suits for the
   given width and height.

   The following variables must be @{"initialized" LINK ausfuellen}
   on our own:

   ScreenW, ScreenH, WBRight, WBBottom, XOff, YOff

RETURNS

   Nothing.

BUGS

   None known.

SEE ALSO

   @{"ComputeX" LINK ComputeX}
   @{"ComputeY" LINK ComputeY}
@ENDNODE
@NODE ComputeX "OS2-Unit/ComputeX"

NAME

   ComputeX

SYNOPSIS

   LONG = ComputeX(value);

   value : INTEGER;

DESCRIPTION

   Parameters are: The width with topaz/8-font.
   ComputeX calculates then the width with
   TheFont from @{"ComputeFont" LINK CF}.

RETURNS

   Width with TheFont

BUGS

   None known.

SEE ALSO

   @{"ComputeFont" LINK CF}
@ENDNODE
@NODE ComputeY "OS2-Unit/ComputeY"

NAME

   ComputeY

SYNOPSIS

   LONG = ComputeY(value);

   value : INTEGER;

DESCRIPTION

   Parameters are: The Height with topaz/8-font.

   ComputeX calculates then the height with
   TheFont from @{"ComputeFont" LINK CF}

RETURNS

   Height with TheFont.

BUGS

   None known.

SEE ALSO

   @{"ComputeFont" LINK CF}
@ENDNODE
@NODE DrawBevelLine "OS2-Unit/DrawBevelLine"
@NEXT FSB
@PREV ComputeY

NAME

   DrawBevelLine

SYNOPSIS

   DrawBevelLine(rp,vi,x,y,b,recessed);

   rp       : p_RastPort;  { RastPort for our BevelLine }
   vi       : PTR;         { VisualInfo for BevelBox }
   x,y,                    { x-/y-Coordinate }
   b        : INTEGER;     { Width of BevelLine in Pixels }
   recessed : BOOLEAN;     { Recessed Line or not? (See also: GTBB_Recessed-Tag) }

DESCRIPTION

   Draws a fontsensitive (@{"Initializing variables!!" LINK ausfuellen}
   BevelBox with a height of 2 Pixels.

RETURNS

   Keine

BUGS

   Keine bekannt.

SEE ALSO

   @{"FS_BevelBox" LINK FSB}
@ENDNODE
@NODE FSB "OS2-Unit/FS_BevelBox"

NAME

   FS_BevelBox

SYNOPSIS

   FS_BevelBox(wp,vi,x,y,b,h,recessed);

   wp       : p_Window;
   vi       : PTR; { VisualInfo }
   x,y      : INTEGER; { LeftEdge }
   b,h      : INTEGER; { Width and height }
   recessed : BOOLEAN; { BevelBox recessed ?? }

DESCRIPTION

   Draws a fontsensitive BevelBox.

RETURNS

   Nothing.

BUGS

   None known.
@ENDNODE
@NODE GS "OS2-Unit/GadSelect"

NAME

   GadSelect

SYNOPSIS

   GadSelect(wp,gad);

   wp  : p_Window;
   gad : p_Gadget;

DESCRIPTION

   With the tag GT_Underscore you can specify the char
   to underline in a gadget. This means the char is
   the shortcut for this gadget. But, in your program
   you have to react on your own for the shortcut
   (IDCMP_RAWKEY), select the gadget on your own
   and de-select it... this procedure makes it easier.

   If you get the rawkey-code (IntuiMessage^.Code on
   pressing the char), then call this procedure
   (parameters are: Our window and the gadget to select).
   Then it selects the gadget, waits until you release
   the gadget (you @{B}have@{UB} to set IDCMP_RAWKEY!)
   and then deselects it.

   That's it! :)

RETURNS

   Nothing.

BUGS

   None known.
@ENDNODE
@NODE GG "OS2-Unit/GhostGadget"

NAME

   GhostGadget

SYNOPSIS

   GhostGadget(wp,gad,req,dis);

   wp     : p_Window;
   gad    : p_Gadget;
   req    : p_Requester; (optional)
   dis    : BOOLEAN;

DESCRIPTION

   This procedure ghosts a gadget (not selectable). Parameters
   are clear: Window, the gadget to ghost, (optional) a requester
   and TRUE for ghosting it, else FALSE.

RETURNS

   Nothing.

BUGS

   None known.
@ENDNODE
@NODE IASL "OS2-Unit/InitASLStruct"

NAME

   InitASLStruct

SYNOPSIS

   InitASLStruct(ASLStruct);

   ASLStruct : ASLFileStruct;

DESCRIPTION

   This function is linked with @{"ASLFileReq" LINK ASLF}.
   You have to call it before you use ASLFileReq.

   Parameters are: the ASLFileStruct you want to initialize.

RETURNS

   Nothing.

BUGS

   None known.

SEE ALSO

   @{"ASLFileReq" LINK ASLF}
@ENDNODE
@NODE SG "OS2-Unit/SensitivGadget"

NAME

   SensitivGadget

SYNOPSIS

   SensitivGadget(ng);

   ng : NewGadget;

DESCRIPTION

   For fontsensitive GUIs: If you declared your Gadget-Structure
   NewGadget, then call this procedure. It changes the coordinates
   of the gadget for fontsensitive behaviour.

   ATTENTION: You have to edit the coordinates in ng as if you
              would use topaz.8-font!!

RETURNS

   Nothing.

BUGS

   None known.
@ENDNODE
@NODE SCB "OS2-Unit/SetCheckBox"

NAME

   SetCheckBox

SYNOPSIS

   SetCheckBox(wp,gad,req,flag);

   wp     : p_Window;
   gad    : p_Gadget;
   req    : p_Requester;
   flag   : BOOLEAN;

DESCRIPTION

   Activates or disactivates a checkbox.

RETURNS

   Nothing.

BUGS

   None known.

SEE ALSO

   @{"SetCycleGad" LINK SCG}
   @{"SetListViewGad" LINK SLVG}
   @{"SetListViewList" LINK SLVL}
   @{"SetMXGad" LINK SMG}
   @{"SetNumberGad" LINK SNG}
@ENDNODE
@NODE SCG "OS2-Unit/SetCycleGad"

NAME

   SetCycleGad

SYNOPSIS

   SetCycleGad(wp,gad,req,active);

   wp     : p_Window;
   gad    : p_Gadget;
   req    : p_Requester;
   active : LONG;

DESCRIPTION

   Sets the cyclegadget-text nr. <active> (begins at 0!)

RETURNS

   Nothing.

BUGS

   None known.

SEE ALSO

   @{"SetCheckBox" LINK SCB}
   @{"SetListViewGad" LINK SLVG}
   @{"SetListViewList" LINK SLVL}
   @{"SetMXGad" LINK SMG}
   @{"SetNumberGad" LINK SNG}

@ENDNODE
@NODE SLVG "OS2-Unit/SetListViewGad"

NAME

   SetListViewGad

SYNOPSIS

   SetListViewGad(wp,gad,req,active,top);

   wp     : p_Window;
   gad    : p_Gadget;
   req    : p_Requester;
   active,
   top    : LONG;

DESCRIPTION

   Sets the active entry of a listview. You can
   also specify the top element with <top>.

RETURNS

   Nothing.

BUGS

   None known.

SEE ALSO

   @{"SetCheckBox" LINK SCB}
   @{"SetCycleGad" LINK SCG}
   @{"SetListViewList" LINK SLVL}
   @{"SetMXGad" LINK SMG}
   @{"SetNumberGad" LINK SNG}
@ENDNODE
@NODE SLVL "OS2-Unit/SetListViewList"

NAME

   SetListViewList

SYNOPSIS

   SetListViewList(wp,gad,req,NeueList);

   wp       : p_Window;
   gad      : p_Gadget;
   req      : p_Requester;
   NeueList : p_List;

DESCRIPTION

   Sets the new list of a listview-gadget.

RETURNS

   Nothing.

BUGS

   None known.

SEE ALSO

   @{"SetCheckBox" LINK SCB}
   @{"SetCycleGad" LINK SCG}
   @{"SetListViewGad" LINK SLVG}
   @{"SetMXGad" LINK SMG}
   @{"SetNumberGad" LINK SNG}
@ENDNODE
@NODE SMG "OS2-Unit/SetMXGad"

NAME

   SetMXGad

SYNOPSIS

   SetMXGad(wp,gad,req,active);

   wp        : p_Window;
   gad       : p_Gadget;
   req       : p_Requester;
   active    : LONG;

DESCRIPTION

   Sets the active (parameter <active>) element of a MX_GADGET.

RETURNS

   Nothing

BUGS

   None known

SEE ALSO

   @{"SetCheckBox" LINK SCB}
   @{"SetCycleGad" LINK SCG}
   @{"SetListViewGad" LINK SLVG}
   @{"SetListViewList" LINK SLVL}
   @{"SetNumberGad" LINK SNG}

@ENDNODE
@NODE SNG "OS2-Unit/SetNumberGad"

NAME

   SetNumberGad

SYNOPSIS

   SetNumberGad(wp,gad,req,nummer);

   wp       : p_Window;
   gad      : p_Gadget;
   req      : p_Requester;
   nummer   : LONG;

DESCRIPTION

   Sets a NUMBER_KIND-gadget with the value <nummer>.

RETURNS

   Nothing.

BUGS

   None known.

SEE ALSO

   @{"SetCheckBox" LINK SCB}
   @{"SetCycleGad" LINK SCG}
   @{"SetMXGad" LINK SMG}
   @{"SetListViewGad" LINK SLVG}
   @{"SetListViewList" LINK SLVL}

@ENDNODE
@NODE OASL "OS2-Unit/OpenASL"

NAME

   OpenASL

SYNOPSIS

   BOOLEAN = OpenASL(version);

   version : INTEGER;

DESCRIPTION

   Tries to open asl.library with the given version number or
   higher.

RETURNS

   TRUE, if asl.library could be opened, else FALSE.

BUGS

   None known.

SEE ALSO

   @{"CloseASL" LINK CASL}
@ENDNODE
@NODE OGT "OS2-Unit/OpenGadTools"

NAME

   OpenGadTools

SYNOPSIS

   BOOLEAN := OpenGadTools(version);

   version : INTEGER;

DESCRIPTION

   Tries to open gadtools.library with the given version number or
   higher.

RETURNS

   TRUE, if gadtools.library could be opened, else FALSE.

BUGS

   None known.

SEE ALSO

   @{"CloseGadTools" LINK CGT}
@ENDNODE
@NODE UserReq
@PREV OGT
@NEXT Hinweise

NAME

   UserReq

SYNOPSIS

   LONG := UserReq(win,tit,txt,gad);

   win : p_Window;
   tit,txt,gad : STR;

DESCRIPTION

   Creates an EasyRequester on the window <win>, which is
   optional. <tit> is the title of the requester, <txt>
   the body and <gad> the gadgettext, e.g. "Quit|Quit&Save|Abort"
   (this will display 3 Gadgets).

RETURNS

   0 for the right gadget. The other gadgets are numbered from
   left to right beginning at 1.

BUGS

   None known.
@ENDNODE
@NODE Hinweise "Hinweise"


@{B}Important:@{UB}

The program that uses this unit, has to open "gadtools.library"
(e.g. with @{"OpenGadTools" LINK OGT}), because mostly all of this procedures/
functions use gadtools.library!

And you have to @{"fill" LINK ausfuellen} in some variables if you
expect the fontsensitive routines to work right!
@ENDNODE
@NODE History "4. History"

(ONLY German history!)

-=-=-=-=-=-=-=-=-=-=-
- Revision: V0.050  -
-=-=-=-=-=-=-=-=-=-=-

  - Procedure DrawBevelLine() hinzugekommen.
  - Guide-Datei erweitert.

-=-=-=-=-=-=-=-=-=-=-
- Revision: V0.040  -
-=-=-=-=-=-=-=-=-=-=-

  Funktion UserReq() hinzugefügt.
  Guide-Datei erweitert.

-=-=-=-=-=-=-=-=-=-=-
- Revision: V0.030  -
-=-=-=-=-=-=-=-=-=-=-

  ASLFileReq() hinzugefügt. Mächtige Funktion
  zum Auswählen von Dateien.

-=-=-=-=-=-=-=-=-=-=-
- Revision: V0.020  -
-=-=-=-=-=-=-=-=-=-=-

  SetXXXGad-Prozeduren erweitert;
  GhostGadget(), GadSelect hinzugefügt.

-=-=-=-=-=-=-=-=-=-=-
- Revision: V0.010  -
-=-=-=-=-=-=-=-=-=-=-

  SetXXXGad-Prozeduren hinzugefügt.

-=-=-=-=-=-=-=-=-=-=-
- Revision: V0.000  -
-=-=-=-=-=-=-=-=-=-=-

  --- Initial release ---

@ENDNODE
@NODE Addi "5. Adresse/Copyright"

This Unit is GIFTWARE. If you want you can send me a gift, e.g.
Pascal-Sources, chocolate ;), a brand-new RISC-Amiga etc. :)

If you have the ability to send EMails, it would be nice to
hear of you that you use this unit.

My address (include return postage, or you won't get an answer!)

    Björn Schotte
    Am Burkardstuhl 45
    D-97267 Himmelstadt
    Germany/Europe

@{B}EMail: bjoern@bomber.mayn.de@{UB}

(Pascal-FTP-Server: ftp@bomber.mayn.de, Subject: HELPALL)

Have fun! :O)
@ENDNODE
@NODE MyIndex "OS2-Unit/Index"

@{U}Alphabetical Index@{UU}

@{"ActStringGad()          " LINK ASG}
@{"Address of the Author   " LINK Addi}
@{"ASLFileReq()            " LINK ASLF}
@{"Declaring some variables" LINK Ausfuellen}
@{"CloseASL()              " LINK CASL}
@{"CloseGadTools           " LINK CGT}
@{"ComputeFont()           " LINK CF}
@{"ComputeX()              " LINK ComputeX}
@{"ComputeY()              " LINK ComputeY}
@{"DrawBevelLine()         " LINK DrawBevelLine}
@{"FS_BevelBox()           " LINK FSB}
@{"GadSelect()             " LINK GS}
@{"GhostGadget()           " LINK GG}
@{"Important notes         " LINK Hinweise}
@{"Programm-History        " LINK History}
@{"InitASLStruct()         " LINK IASL}
@{"OpenASL()               " LINK OASL}
@{"OpenGadTools()          " LINK OGT}
@{"SensitivGadget()        " LINK SG}
@{"SetCheckBox()           " LINK SCB}
@{"SetCycleGad()           " LINK SCG}
@{"SetListViewGad()        " LINK SLVG}
@{"SetListViewList()       " LINK SLVL}
@{"SetMXGad()              " LINK SMG}
@{"SetNumberGad()          " LINK SNG}
@{"UserReq()               " LINK UserReq}

@{"Why this unit?          " LINK Warum}

@ENDNODE
