@database " Tools.ag" 
@node Main "Tools AutoGuide"
CONTENTS
        @{" Download.dos " link Download.dos} - download S-Records via a DOS device.
        @{" Download.term " link Download.term} - download S-Records via terminal program Term.
        @{" Locate " link Locate} - locate an Amiga executable and construct S-Records
        @{" MemTag " link MemTag} - Memory region ROMTag editor.
        @{" Sysgen.rexx " link Sysgen.rexx} - System Generation utility.
@endnode 
@node  Download.dos
 
     NAME
        Download.dos - download S-Records via a DOS device.
 
     SYNOPSIS
        Download.dos [DOS] <dos> ([FILES] {<file>} | MODFILE <modfile>)
        Download.dos DOS/A,FILES/M,MODFILE/K
 
     FUNCTION
        Downloads files of (presumably) S-Records by copying them to
        the specified DOS device.  The target (e.g. a ROM monitor
        program at the other end of SER:) must be ready to receive
        the records.
 
        Primary use of this script is envisioned as being indirect via
        Sysgen.rexx.
 
     INPUTS
        DOS      - name of the DOS device, including ':', to be used.
                   e.g. SER:
        FILES    - names of the files to download
        MODFILE  - name of a file whose contents are a list of files to
                   download, one file name per line.  Mutually exclusive
                   with FILES.
 
     COMMENTS
        Yes, this is a suspiciously thin wrapping of 'copy'.
 
@endnode
@node  Download.term
 
     NAME
        Download.term - download S-Records via terminal program Term.
 
     SYNOPSIS
        Download.term ([FILES] {<file>} | MODFILE <modfile>) [BAUD <baud>]
                       [FBUG]
        Download.term FILES/M,MODFILE/K,BAUD/K/N,FBUG/S
 
     FUNCTION
        Downloads files of (presumably) S-Records using the terminal
        program Term. Term must be running, sitting at the command line
        prompt of the ROM monitor.  If no switch indicating otherwise
        is provided, the ROM monitor is assumed to be debug.library.
 
     INPUTS
        FILES    - names of the files to download
        MODFILE  - name of a file whose contents are a list of files to
                   download, one file name per line.  Mutually exclusive
                   with FILES.
        BAUD     - specifies the baud rate to use for downloading. This
                   keyword allows the use of debug.library's ability to
                   accept S-Records at a higher baud rate than the
                   terminal port is usually run at.
        FBUG     - target system is running FBUG.
 
@endnode
@node  Locate
 
     NAME
        Locate - locate an Amiga executable and construct S-Records
 
     SYNOPSIS
        Locate [IN] <infile> [OUT] <outfile> [T=TEXT <textstart>
               [D=DATA <datastart>] [DB=DATABURN <databurn>]]
               [QUIET] [TERM]
 
        Locate IN/A,OUT/A,T=TEXT/K,D=DATA/K,DB=DATABURN/K,TERM/S,QUIET/S
 
     FUNCTION
        This command processes an Amiga load file producing output
        suitable for downloading to EPROM programmers or single board
        computers.
 
        The usual way to use this command is to process the load file
        directly into Motorola S-Records.  However, in case some other
        download format is required, this command can also output a very
        simple IFF FORM which is basically the memory image  resulting
        from the location procedure.  The user can then use his own
        utility to process the memory image into whatever download format
        is required.  (There probably isn't a programmer or 680x0 board
        in the world which doesn't accept S-Records, but hey - other than
        explaining it, the feature was easy to add.)
 
     INPUTS
        IN       - A required parameter, this is the name of the file
                   to be processed.  Unless the file has an extension
                   of ".rom", it is assumed to be an Amiga load file
                   and the program will locate it using the supplied
                   section start addresses.
 
                   If the file name has a ".rom" extension, then it is
                   assumed to be an IFF FORM of type 'ROM '.  In this case
                   the location work has already been performed, and the
                   program will read the form and generate the S-Record
                   output, skipping the location procedure.  Note that
                   if input is a ROM form, any section address arguments
                   supplied are ignored.
 
        OUT      - A required parameter, this is the name of the file
                   output is to be written to.  If the output file name
                   has a ".rom" extension, the output will be a ROM form
                   instead of S-Records.
 
        TEXT     - Hexadecimal address where the text (code) hunks are
                   to be located.  All code hunks in the load file are
                   located, one after another, starting at this address.
 
        DATA     - Hexadecimal address where the data hunks are to be
                   located.  All data hunks in the load file are located,
                   one after another, starting at this address.  If a
                   data start address is not supplied, the data hunks are
                   located immediately following the code hunks.  Bss
                   hunks are treated like data hunks.
 
        DATABURN - Hexadecimal address specifying where the data hunks
                   are to be located.  This _is_ different than the
                   DATA argument described above.  DATA specifies where
                   the data hunks are going to be at post-boot-time.
                   Usually DATA is a RAM address so that the data section
                   is writeable.  DATABURN specifies where the data is
                   going to be at boot-time, usually a ROM address.  The
                   software's bootstrap code has to copy the data section
                   from DATABURN to DATA (i.e. from ROM to RAM) at boot
                   time.  If DATABURN is not supplied, DATABURN = DATA.
 
        TERM     - A switch, that if supplied, will cause an 'S7'
                   termination record to be written to the outfile.
 
        QUIET    - A switch which will suppress the console output
                   produced by this program.  Unless suppressed, this
                   program reports the total length of the code and the
                   total length of the data/bss.
 
     RESULTS
        rc - 0 if all went well.  Supposedly appropriate levels of
             DOS errors if something goes wrong.
 
     IFF NOTES
        A 'ROM ' form looks like:
 
           FORM 'ROM '
              Chunk 'CODE'
                 4 byte starting address of code
                 memory image of code - size of memory image is implied
                                        by chunk size.
              Chunk 'DATA'
                 4 byte starting address of data
                 memory image of data - size of memory image is implied
                                        by chunk size.
 
@endnode
@node  MemTag
 
     NAME
        MemTag - Memory region ROMTag editor.
 
     SYNOPSIS
        MemTag [BASE <base>] [SIZE <size>] [PRI <pri>] [DEST <dest>]
               [TAGPRI <tagpri>] [DATA] [PUBLIC] [BAT] [SAVESOURCE]
               [NAME <name>]
 
        MemTag BASE/K,SIZE/K,PRI/K,DEST/K,TAGPRI/K,DATA/S,PUBLIC/S,BAT/S,
               SAVESOURCE/S,NAME/F
 
     FUNCTION
        A tool to create and edit memory region ROMTags.  The product
        of this tool is an Amiga load file containing a ROMTag describing
        a memory region, and a corresponding icon whose tool types
        describe the ROMTag.
 
        When invoked from the CLI, the CLI arguments take precedence
        over their corresponding (and identically named) icon tool-types.
 
     INPUTS
        BASE       - The base address of the memory region (hexadecimal).
        SIZE       - The size in bytes of the memory region (hexadecimal).
        PRI        - The priority of the memory region (decimal).
        DEST       - The location the memory region is to be copied to.
                     This should not be specified or should be -1 for all
                     regions except those describing a data section.
        TAGPRI     - Priority of the ROMTag.
        DATA       - Switch indicating region is a data section.
        PUBLIC     - Switch indicating region has MEMF_PUBLIC attribute.
        BAT        - Switch indication regions has MEMF_BAT attribute.
        SAVESOURCE - Switch indicating the assembler source file
                     describing the ROMTag is to be kept.
        NAME       - Name of the file containing, or to contain, the
                     memory ROMTag.  A ".memory" extension is considered
                     the norm.
 
     RESULTS
        error  - DOS error codes - i.e. 0 is good.
 
@endnode
@node  Sysgen.rexx
 
     NAME
        Sysgen.rexx - System Generation utility.
 
     SYNOPSIS
        Sysgen [MODFILE] <modfile> [DOS <dos> | TERM] [FBUG] [BAUD <baud>]
               [BLOCKSIZE <blocksize>] [MAKEALL] [LOCATEALL] [DOWNLOADALL]
               [QUIET]
 
        Sysgen.rexx MODFILE/A,DOS/K,TERM/S,FBUG/S,BAUD/K/N,BLOCKSIZE/K/N,
                    MAKEALL/S, LOCATEALL/S, DOWNLOADALL/S,QUIET/S
 
     FUNCTION
        A program to perform System Generation.  This program uses the
        Locate utility to locate multiple AmigaDOS load files
        (executables), one after the other.  The resulting S-Record
        (.mx) files are then downloaded to the specified destination,
        usually a serial port connected to an SBC or EPROM programmer.
 
        Aside from generating the .mx files, this program creates a .map
        file which records the starting addresses, lengths, and time of
        last download for the modules.  This map file is used by
        subsequent invocations of this program to reduce unnecessary
        Locate's and downloads.
 
     NOTES
        The downloading itself is performed by a separate Download
        script invoked by this program.  The script invoked is indicated
        by the keywords passed to this program.  Currently supported
        scripts are Download.dos and Download.term.  The former downloads
        to DOS devices such as SER: or files, the latter to the serial
        port being used by the terminal program 'term'.
 
        Support for additional terminal programs and/or ROM monitors
        requires straightforward modification of this script. See
        procedure Download() herein.
 
     INPUTS
        MODFILE - Required parameter.  This is the name of a module
                  list file with the info to control the system
                  generation.  Each non-blank, non-comment line in the
                  file is one of two forms:
 
                  LOCATION TEXT <tstart> DATA <dstart> DATABURN <dburn>
 
                  Where:
                    tstart  - where to locate the text section of the
                              modules.  Each module's text section is
                              placed one after the other.
                    dstart  - where to locate the data section of the
                              modules.  Each module's data section is
                              placed one after the other.
                    dburn   - this specifies where the data section will
                              actually be downloaded to.  At boot time,
                              the data will be copied from dburn to
                              dstart.  i.e. this is the ROM address
                              whereas dstart is the RAM address.
 
                  or,
 
                  MOD <fullname> [REL <release>] [MAKE <makeflag>
                  HOME <home>]
 
                  Where:
                    fullname - is the full file name of a standard
                               AmigaDOS load file.
                    release  - release number required, e.g. 2.1
                               If the version of the module is older than
                               the specified release, the Sysgen aborts.
                    makeflag - '1' means the module is to be made and
                               hence possibly recompiled and linked.
                               The default is to *not* make the
                               module.
                    home     - the full pathname of the modules home
                               directory.
 
                               Note that if MAKE is provided, HOME
                               must be provided.  The home directory
                               must contain a makefile such that in
                               the directory the command:
 
                                make <fullname>
 
                               will construct the module.
 
        DOS       - Indicates S-Records are to be downloaded using
                    Download.dos script. The parameter is the name of a
                    file or device the S-Record files are to be copied to.
                     e.g. SER:.  Mutually exclusive with the TERM switch.
                    If neither DOS nor TERM is provided provided no
                    downloading takes place.  (Though .mx file creation
                    still does.)
 
        TERM      - Switch indicating downloading is to be done by
                    invoking script Download.term.
 
        FBUG      - Switch passed through to Download scripts.  Indicates
                    target system is running FBUG ROM monitor. Without
                    switch target is assumed to be running AmiExec Debug.
 
        BAUD      - This is the baud rate to use for downloading and is
                    passed through to the Download scripts.
 
        BLOCKSIZE - Starting addresses of modules will be aligned on a
                    multiple of the blocksize. (Unless overridden by
                    the LOCATION keyword)  Specify in decimal bytes.
                    The default is 2048 bytes.  This allows individual
                    modules to change slightly in size without requiring
                    all modules to relocate and re-download.
 
        MAKEALL   - Switch indicating all modules are to be made
                    regardless of their individual makeflags.
 
        LOCATEALL - Switch indicating all modules are to be located.  By
                    default, modules are located only if their ".mx"
                    file is out of date, or if preceding modules have
                    grown or shrunk sufficiently so as to change the
                    module's start address.
 
        DOWNLOADALL - Switch indicating all modules are to be downloaded.
                      By default, only those modules whose .mx files
                      are more recent than their download timestamp are
                      downloaded.
 
        QUIET     - Switch suppressing message display.
 
     RESULTS
        rc - 0 if all went well.  Supposedly appropriate levels of
             DOS errors if something goes wrong.
 
     BUGS
        May have problems with modules that lie on 7FFFFFFF.  See
        procedure AddNRoundHex.
 
        The V39 Version command broke release number checking as done
        in response to the REL keyword.  The REL keyword is currently
        ineffective under WB3.0+.
 
     SEE ALSO
        @{" Locate " link Locate}, @{" Download.dos " link Download.dos}, @{" Download.term " link Download.term}
 
@endnode 
