; WLALINK ($VER: wlalink 5.20 (23.6.2023)) listing file
; 2023-06-23 15:58:20

;Line Bank Slot PC   Offset Hex                             Source
                                                            
                                                            ;»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»
                                                            ; a small example testing spc-700 parsing
                                                            ; written by ville helin <ville.helin@iki.fi> in 2021
                                                            ;»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»
                                                            
                                                            .MEMORYMAP
                                                            SlotSize $10000
                                                            DeFaUlTsLoT 0
                                                            slOt 0 $0000
                                                            .ENDME
                                                            
                                                            .ROMBANKMAP
                                                            BANKStotal 1
                                                            BaNKSiZE $10000
                                                            BaNKs 1
                                                            .ENDRO
                                                            
                                                            ;»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»
                                                            ; tests
                                                            ;»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»»
                                                            
                                                            .bank 0 slot 0
                                                            
                                                            // bits for settings
                                                            .define SETTINGS_BIT_AUDIO    0
                                                            .define SETTINGS_BIT_JOYSTICK 1
                                                            .define SETTINGS_BIT_KEYBOARD 2
                                                            
                                                            // bits for cheat_codes
                                                            .define CHEAT_CODES_BIT_1 0
                                                            .define CHEAT_CODES_BIT_2 1
                                                            .define CHEAT_CODES_BIT_3 2
                                                            
                                                            .org 0
                                                            
                                                            .section "VARIABLES" force
                                                            settings:
   39 0000 0000 0000 0000   00                                  .db 0
                                                            cheat_codes:
   41 0000 0000 0001 0001   00                                  .db 0
                                                            .ends
                                                            
                                                            .org $200
                                                            address_0x0200: 
                                                                    
                                                            ; @BT result.rom
                                                            
                                                            .section "TEST01" force
   50 0000 0000 0200 0200   30 31 3E                            .db "01>"                                       ; @BT TEST-01 01 START
   51 0000 0000 0203 0203   53 00 00                            bbc settings.SETTINGS_BIT_KEYBOARD,label_1      ; @BT 53 00 00
                                                            label_1:
   53 0000 0000 0206 0206   02 00                               set1 settings.SETTINGS_BIT_AUDIO                ; @BT 02 00
   54 0000 0000 0208 0208   6A 01 00                            and1 C,/cheat_codes.CHEAT_CODES_BIT_1           ; @BT 6A 01 00
   55 0000 0000 020B 020B   4A 01 00                            and1 C,cheat_codes.CHEAT_CODES_BIT_1            ; @BT 4A 01 00
   56 0000 0000 020E 020E   3C 30 31                            .db "<01"                                       ; @BT END
                                                            .ends
                                                            
                                                            .section "TEST02" force
   60 0000 0000 0211 0211   30 32 3E                            .db "02>"                                       ; @BT TEST-02 02 START
   61 0000 0000 0214 0214   53 00 00                            bbc settings,SETTINGS_BIT_KEYBOARD,label_2      ; @BT 53 00 00
                                                            label_2:
   63 0000 0000 0217 0217   02 00                               set1 settings,SETTINGS_BIT_AUDIO                ; @BT 02 00
   64 0000 0000 0219 0219   6A 01 00                            and1 C,/cheat_codes,CHEAT_CODES_BIT_1           ; @BT 6A 01 00
   65 0000 0000 021C 021C   4A 01 00                            and1 C,cheat_codes,CHEAT_CODES_BIT_1            ; @BT 4A 01 00
   66 0000 0000 021F 021F   3C 30 32                            .db "<02"                                       ; @BT END
                                                            .ends
                                                            
                                                            .define TCALL_0  0
                                                            .define TCALL_1  1
                                                            .define TCALL_15 15
                                                                    
                                                            .section "TEST03" force
   74 0000 0000 0222 0222   30 33 3E                            .db "03>"                                       ; @BT TEST-03 03 START
   75 0000 0000 0225 0225   87 01                               adc a, [SETTINGS_BIT_JOYSTICK+X]                ; @BT 87 01
   76 0000 0000 0227 0227   97 01                               adc a, [SETTINGS_BIT_JOYSTICK]+Y                ; @BT 97 01
   77 0000 0000 0229 0229   01                                  tcall 0                                         ; @BT 01
   78 0000 0000 022A 022A   11                                  tcall TCALL_1 + 0                               ; @BT 11
   79 0000 0000 022B 022B   F1                                  tcall TCALL_1 * 10 - 10 + TCALL_15              ; @BT F1
   80 0000 0000 022C 022C   4E 01 00                            tclr1 !cheat_codes                              ; @BT 4E 01 00
   81 0000 0000 022F 022F   0E 01 00                            tset1 !cheat_codes                              ; @BT 0E 01 00
   82 0000 0000 0232 0232   3C 30 33                            .db "<03"                                       ; @BT END
                                                            .ends
                                                            
                                                            .section "TEST04" force
   86 0000 0000 0235 0235   30 34 3E                                .db "04>"                   ; @BT TEST-04 04 START
   87 0000 0000 0238 0238   5F 00 02                                jmp !address_0x0200         ; @BT 5F 00 02
   88 0000 0000 023B 023B   1F 00 02                                jmp [!address_0x0200+x]     ; @BT 1F 00 02
   89 0000 0000 023E 023E   3C 30 34                                .db "<04"                   ; @BT END
                                                            .ends
                                                                    
                                                                    .section "TEST05" force
   93 0000 0000 0241 0241   30 35 3E                                .db "05>"               ; @BT TEST-05 05 START
   94 0000 0000 0244 0244   54 65 73 74 5C                          .db "Test\\"            ; @BT 54 65 73 74 5C
   95 0000 0000 0249 0249   5C 27                                   .db "\\'"               ; @BT 5C 27
   96 0000 0000 024B 024B   5C                                      .db "\\"                ; @BT 5C
   97 0000 0000 024C 024C   54 5C 22 5C 54                          .db "T\\\"\\T"          ; @BT 54 5C 22 5C 54
   98 0000 0000 0251 0251   3C 30 35                                .db "<05"               ; @BT END
                                                                    .ends
                                                                    
                                                            
                                                                    .org $10
                                                            
                                                                    .STRUCT HELPERVARIABLES
                                                                    N0  DB
                                                                    N1  DB
                                                                    N2  DB
                                                                    N3  DB
                                                                    .ENDST
  110 0000 0000 0010 0010   00                              
  110 0000 0000 0011 0011   01 
  110 0000 0000 0012 0012   02 
  111 0000 0000 0013 0013   03                                      .dstruct helpervariable INSTANCEOF HELPERVARIABLES DATA 0, 1, 2, 3
                                                            
                                                                    .define ONE 1
                                                                    
  115 0000 0000 0014 0014   30 36 3E                                .db "06>"                ; @BT TEST-06 06 START
  116 0000 0000 0017 0017   C4 01                                   mov 1, a                 ; @BT C4 01
  117 0000 0000 0019 0019   C4 10                                   MOV helpervariable, A    ; @BT C4 10
  118 0000 0000 001B 001B   C4 10                                   MOV helpervariable.N0, A ; @BT C4 10
  119 0000 0000 001D 001D   10                                      .db helpervariable       ; @BT 10
  120 0000 0000 001E 001E   10                                      .db helpervariable.N0    ; @BT 10
  121 0000 0000 001F 001F   11                                      .db helpervariable.N1    ; @BT 11
  122 0000 0000 0020 0020   12                                      .db helpervariable.N2    ; @BT 12
  123 0000 0000 0021 0021   13                                      .db helpervariable.N3    ; @BT 13
  124 0000 0000 0022 0022   D8 10                                   MOV helpervariable, X    ; @BT D8 10
  125 0000 0000 0024 0024   D8 10                                   MOV helpervariable.N0, X ; @BT D8 10
  126 0000 0000 0026 0026   11                                      .db helpervariable.N0+1  ; @BT 11
  127 0000 0000 0027 0027   12                                      .db helpervariable.N1+1  ; @BT 12
  128 0000 0000 0028 0028   13                                      .db helpervariable.N2+1  ; @BT 13
  129 0000 0000 0029 0029   14                                      .db helpervariable.N3+1  ; @BT 14
  130 0000 0000 002A 002A   CA 01 20                                MOV1 1.1,C               ; @BT CA 01 20
  131 0000 0000 002D 002D   CA 10 20                                MOV1 helpervariable.1,C  ; @BT CA 10 20
  132 0000 0000 0030 0030   CA 11 20                                MOV1 helpervariable.N1.1,C ; @BT CA 11 20
  133 0000 0000 0033 0033   CA 11 20                                MOV1 helpervariable.N1.ONE,C ; @BT CA 11 20
  134 0000 0000 0036 0036   3C 30 36                                .db "<06"                ; @BT END
                                                            
                                                                    .define TWO ONE*2
                                                            
  138 0000 0000 0039 0039   30 37 3E                                .db "07>"               ; @BT TEST-07 07 START
  139 0000 0000 003C 003C   CA 01 20                                MOV1 HELPERVARIABLES2.N1.1,C   ; @BT CA 01 20
  140 0000 0000 003F 003F   CA 02 40                                MOV1 HELPERVARIABLES2.N2.TWO,C ; @BT CA 02 40
  141 0000 0000 0042 0042   CA 04 20                                MOV1 THREE+1.1,C               ; @BT CA 04 20
  142 0000 0000 0045 0045   CA 03 40                                MOV1 THREE.TWO,C               ; @BT CA 03 40
  143 0000 0000 0048 0048   CA FF 3F                                MOV1 VALUE_8191+1-1.1,C        ; @BT CA FF 3F
  144 0000 0000 004B 004B   CA FF 5F                                MOV1 VALUE_8191.TWO,C          ; @BT CA FF 5F
  145 0000 0000 004E 004E   CA FF 3F                                MOV1 VALUE_8191_2+1-1.1,C      ; @BT CA FF 3F
  146 0000 0000 0051 0051   CA FF 5F                                MOV1 VALUE_8191_2.TWO,C        ; @BT CA FF 5F
  147 0000 0000 0054 0054   3C 30 37                                .db "<07"               ; @BT END
                                                            
                                                                    .STRUCT HELPERVARIABLES2
                                                                    N0  DB
                                                                    N1  DB
                                                                    N2  DB
                                                                    N3  DB
                                                                    .ENDST
                                                            
                                                                    .define THREE ONE+ONE+ONE
                                                                    .define VALUE_8191 8190*ONE+THREE-2
