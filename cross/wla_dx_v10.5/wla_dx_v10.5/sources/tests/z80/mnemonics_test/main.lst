; WLALINK ($VER: wlalink 5.20 (23.6.2023)) listing file
; 2023-06-23 15:58:25

;Line Bank Slot PC   Offset Hex                             Source
                                                            
                                                                    .memorymap
                                                                      slotsize $2000
                                                                      defaultslot 1
                                                                      slot 0 $0000
                                                                      slot 1 $2000
                                                                    .endme
                                                            
                                                                    .rombanksize $2000
                                                                    .rombanks 2
                                                            
                                                                    .bank 0 slot 0
                                                            
                                                                    .section "Section1" force
                                                            
                                                                    ; @BT result.rom
   17 0000 0000 0000 0000   30 31 3E                                .db "01>"          ; @BT TEST-01 01 START
   18 0000 0000 0003 0003   DD CB 12 82                             res 0, (ix+$12), d ; @BT DD CB 12 82
   19 0000 0000 0007 0007   FD CB 69 87                             res 0,(iy+$69),a   ; @BT FD CB 69 87
   20 0000 0000 000B 000B   3C 30 31                                .db "<01"          ; @BT END
                                                            
   22 0000 0000 000E 000E   30 32 3E                                .db "02>"          ; @BT TEST-02 02 START
   23 0000 0000 0011 0011   DD CB 34 9C                             res 3, (ix+$34), h ; @BT DD CB 34 9C
   24 0000 0000 0015 0015   FD CB 56 9E                             res 3, (iy+$56)    ; @BT FD CB 56 9E
   25 0000 0000 0019 0019   3C 30 32                                .db "<02"          ; @BT END
                                                            
   27 0000 0000 001C 001C   30 33 3E                                .db "03>"          ; @BT TEST-03 03 START
   28 0000 0000 001F 001F   FD CB 12 12                             rl (iy+$12),d      ; @BT FD CB 12 12
   29 0000 0000 0023 0023   DD CB 34 03                             rlc (ix+$34), e    ; @BT DD CB 34 03
   30 0000 0000 0027 0027   3C 30 33                                .db "<03"          ; @BT END
                                                            
                                                                    .ends
                                                            
   34 0000 0000 002A 002A   30 34 3E                                .db "04>"          ; @BT TEST-04 04 START
   35 0000 0000 002D 002D   FD CB 56 1F                             rr (iy+56h),a      ; @BT FD CB 56 1F
   36 0000 0000 0031 0031   DD CB 67 0D                             rrc (ix+$67), l    ; @BT DD CB 67 0D
   37 0000 0000 0035 0035   3C 30 34                                .db "<04"          ; @BT END
                                                            
   39 0000 0000 0038 0038   30 35 3E                                .db "05>"          ; @BT TEST-05 05 START
   40 0000 0000 003B 003B   DD CB 01 D2                             set 2, (ix+$01), d ; @BT DD CB 01 D2
   41 0000 0000 003F 003F   FD CB 23 E0                             set 4,(iy+$23),b   ; @BT FD CB 23 E0
   42 0000 0000 0043 0043   3C 30 35                                .db "<05"          ; @BT END
                                                            
   44 0000 0000 0046 0046   30 36 3E                                .db "06>"          ; @BT TEST-06 06 START
   45 0000 0000 0049 0049   DD CB 70 25                             sla (ix+$70), l    ; @BT DD CB 70 25
   46 0000 0000 004D 004D   DD CB 21 37                             sl1 (ix+$21),a     ; @BT DD CB 21 37
   47 0000 0000 0051 0051   3C 30 36                                .db "<06"          ; @BT END
                                                            
   49 0000 0000 0054 0054   30 37 3E                                .db "07>"          ; @BT TEST-07 07 START
   50 0000 0000 0057 0057   FD CB 51 28                             sra (iy+$51), b    ; @BT FD CB 51 28
   51 0000 0000 005B 005B   DD CB 32 3C                             srl (ix+$32),h     ; @BT DD CB 32 3C
   52 0000 0000 005F 005F   3C 30 37                                .db "<07"          ; @BT END
                                                            
   54 0000 0000 0062 0062   30 38 3E                                .db "08>"               ; @BT TEST-08 08 START
   55 0000 0000 0065 0065   08                                      ex af',af               ; @BT 08
   56 0000 0000 0066 0066   08                                      ex af',af               ; @BT 08
   57 0000 0000 0067 0067   EB                                      ex de',hl'              ; @BT EB
   58 0000 0000 0068 0068   EB                                      ex de,hl                ; @BT EB
   59 0000 0000 0069 0069   EB                                      ex hl',de'              ; @BT EB
   60 0000 0000 006A 006A   EB                                      ex hl,de                ; @BT EB
   61 0000 0000 006B 006B   E3                                      ex (sp),hl'             ; @BT E3
   62 0000 0000 006C 006C   E3                                      ex (sp),hl              ; @BT E3
   63 0000 0000 006D 006D   DD E3                                   ex (sp),ix              ; @BT DD E3
   64 0000 0000 006F 006F   FD E3                                   ex (sp),iy              ; @BT FD E3
   65 0000 0000 0071 0071   E3                                      ex hl',(sp)             ; @BT E3
   66 0000 0000 0072 0072   E3                                      ex hl,(sp)              ; @BT E3
   67 0000 0000 0073 0073   DD E3                                   ex ix,(sp)              ; @BT DD E3
   68 0000 0000 0075 0075   FD E3                                   ex iy,(sp)              ; @BT FD E3        
   69 0000 0000 0077 0077   3C 30 38                                .db "<08"               ; @BT END
                                                            
                                                                    .function sumAB(varA, varB) (varA + varB)
                                                                    
   73 0000 0000 007A 007A   30 39 3E                                .db "09>"               ; @BT TEST-09 09 START
                                                                    .IFDEF SKIPTHENEXTBLOCK
                                                                    ld a, d
                                                                    add a, (ix+14)
                                                                    ex (sp),hl
                                                                    add a, (ix+sumAB(10,4))
                                                                    add a, (ix+sumDE(10,4))
                                                                    cp $bf
                                                                    ret nc
                                                                    .ENDIF
   83 0000 0000 007D 007D   00                                      .db 0                   ; @BT 00
   84 0000 0000 007E 007E   3C 30 39                                .db "<09"               ; @BT END
                                                            
                                                                    .org 0xF0
                                                            address_test_10:
                                                            
                                                                    .struct Object
                                                                    status  db
                                                                    data    dsb 8
                                                                    .endst
   93 0000 0000 00F0 00F0   01                              
   94 0000 0000 00F1 00F1   48 45 4C 4C 4F 00 00 00                 .dstruct Object1 instanceof Object DATA 1, "HELLO"
                                                            
                                                                    // NOTE: following tests were "removed" as they depended on a feature that was broken
                                                                    
   98 0000 0000 00F9 00F9   31 30 3E                                .db "10>"                     ; @BT TEST-10 10 START
   99 0000 0000 00FC 00FC   01                                      .db 0x01                      ; @BT 01
  100 0000 0000 00FD 00FD   3C 31 30                                .db "<10"                     ; @BT END
                                                            
  102 0000 0000 0100 0100   31 31 3E                                .db "11>"                  ; @BT TEST-11 11 START
  103 0000 0000 0103 0103   01                                      .db 0x01                   ; @BT 01
  104 0000 0000 0104 0104   3C 31 31                                .db "<11"                  ; @BT END
                                                            
  106 0000 0000 0107 0107   31 32 3E                                .db "12>"                 ; @BT TEST-12 12 START
  107 0000 0000 010A 010A   01                                      .db 0x01                  ; @BT 01
  108 0000 0000 010B 010B   3C 31 32                                .db "<12"                 ; @BT END
                                                            
                                                                    .org 0xC0
                                                                    
                                                                    .section "Section2" force
  113 0000 0000 00C0 00C0   31 33 3E                                .db "13>"                ; @BT TEST-13 13 START
  114 0000 0000 00C3 00C3   01                                      .db 01                   ; @BT 01
  115 0000 0000 00C4 00C4   3C 31 33                                .db "<13"                ; @BT END
                                                                    .ends
                                                            
                                                                    .org 0x200
                                                                    
                                                                    .section "boot" force
  121 0000 0000 0200 0200   31 34 3E                                .db "14>"               ; @BT TEST-14 14 START
  122 0000 0000 0203 0203   F3                                      di                      ; @BT F3
  123 0000 0000 0204 0204   ED 56                                   im 1                    ; @BT ED 56
  124 0000 0000 0206 0206   31 F0 DF                                ld sp, $dff0            ; @BT 31 F0 DF
                                                            
  126 0000 0000 0209 0209   FD 21 34 12                             ld iy, myLabel          ; @BT FD 21 34 12
  127 0000 0000 020D 020D   DD 26 12                                ld ixh, >myLabel        ; @BT DD 26 12
  128 0000 0000 0210 0210   DD 2E 34                                ld ixl, <myLabel        ; @BT DD 2E 34
                                                            
  130 0000 0000 0213 0213   21 34 12                                ld hl, myLabel          ; @BT 21 34 12
  131 0000 0000 0216 0216   16 12                                   ld d, >myLabel          ; @BT 16 12
  132 0000 0000 0218 0218   1E 34                                   ld e, <myLabel          ; @BT 1E 34
                                                            
  134 0000 0000 021A 021A   3C 31 34                                .db "<14"               ; BT END
                                                            
  136 0000 0000 021D 021D   C3 1D 02                        -:      jp -
                                                                    .ends
                                                            
                                                                    .org 0x1234
                                                                    
                                                                    .section "someSection" force
                                                            myLabel:
  143 0000 0000 1234 1234   ED A3                                   outi
  144 0000 0000 1236 1236   C9                                      ret
                                                                    .ends
                                                                    
