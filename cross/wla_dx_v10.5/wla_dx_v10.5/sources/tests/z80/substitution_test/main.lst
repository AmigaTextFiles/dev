; WLALINK ($VER: wlalink 5.20 (23.6.2023)) listing file
; 2023-06-23 15:58:38

;Line Bank Slot PC   Offset Hex                             Source
                                                            // MAIN.S
                                                                    .MEMORYMAP
                                                                    DEFAULTSLOT 0
                                                                    SLOTSIZE $2000
                                                                    SLOT 0 $0000
                                                                    SLOT 1 $2000
                                                                    .ENDME
                                                            
                                                                    .ROMBANKMAP
                                                                    BANKSTOTAL 2
                                                                    BANKSIZE $2000
                                                                    BANKS 2
                                                                    .ENDRO
                                                            
                                                                    
                                                                    ; @BT linked.rom
                                                            
                                                            
                                                                    .STRUCT TestStruct
                                                                    pos_x  DW
                                                                    pos_y  Dw
                                                                    health DB
                                                                    .ENDST
                                                            
                                                                    .PRINT "_sizeof_TestStruct = ", _sizeof_TestStruct, "\n"
                                                            
                                                                    .BANK 0 SLOT 0
                                                                    .ORG 0
                                                            
                                                                    .RAMSECTION "RAMSection" BANK 0 SLOT 0
                                                            label1: db
                                                            label2: dsb 2
                                                                    .ENDS
                                                            
                                                                    .PRINT "_sizeof_label1 = "
                                                                    .PRINTV DEC _sizeof_label1
                                                                    .PRINT " = "
                                                                    .PRINTV DEC (_sizeof_label1+0)
                                                                    .PRINT "\n"
                                                                    
                                                                    .DEFINE I0 = 0
                                                                    .DEFINE I1 = 1
                                                                    .DEFINE I2 = 2
                                                                    .DEFINE I3 = 3
                                                                    .DEFINE I10 = 5+3+2
                                                                    .DEFINE I23 = 20+3
                                                                    .DEFINE DEF_A = "A"
                                                                    .DEFINE DEF_B = "B"
                                                                    .DEFINE DEF_C = "C"
                                                                    .DEFINE DEF_I = "I"
                                                                    .PRINT "1ST SUBSTITUTION - START\n"
                                                                    .DEFINE ABC = { "{DEF_A}{DEF_B}{DEF_C}" }
                                                                    .PRINT "1ST SUBSTITUTION - END\n"
                                                                    .DEFINE VALUE_{I0} 0
                                                                    .EXPORT VALUE_{I0}
                                                            
                                                                    .BANK 0 SLOT 0
                                                                    .ORG 0
                                                            
                                                                    .SECTION "TESTS-A" FORCE
                                                            test_{I1}:
                                                            test_{I1}_address_{I0}
   63 0000 0000 0000 0000   30 31 28                                .DB "01("
                                                            MyValueIs_{%.1X{ 0x3 }}
                                                            formatted_{%.4X{I10}}
                                                            formatted_{%.4X{I10}}_label:
   67 0000 0000 0003 0003   41 31 42                                .DB "A1B"
                                                            {ABC}_{%.3d{I23}}:
   69 0000 0000 0006 0006   29 30 31                                .DB ")01"
                                                            
   71 0000 0000 0009 0009   30 32 28                                .DB "02("
                                                            substitution_of_{I10}
   73 0000 0000 000C 000C   31 30                                   .DB "10"
   74 0000 0000 000E 000E   29 30 32                                .DB ")02"
                                                            
   76 0000 0000 0011 0011   30 31 3E                                .DB "01>"               ; @BT TEST-01 01 START
   77 0000 0000 0014 0014   0C                                      .DB substitution_of_{I10}                 ; @BT 0C
   78 0000 0000 0015 0015   0D                                      .DB 1 + substitution_of_{I10} + 2 - 1 - 1 ; @BT 0D
   79 0000 0000 0016 0016   03                                      .DB test_{I1}_address_{I0} + 3            ; @BT 03
   80 0000 0000 0017 0017   03                                      .DB formatted_{%.4X{I10}}                 ; @BT 03
   81 0000 0000 0018 0018   01                                      .DB 6 - formatted_{%.4X{I10}} - 2         ; @BT 01
   82 0000 0000 0019 0019   03                                      .DB formatted_{%.4X{I10}}_label           ; @BT 03
   83 0000 0000 001A 001A   02                                      .DB 6 - formatted_{%.4X{I10}}_label - 1   ; @BT 02
   84 0000 0000 001B 001B   06                                      .DB {ABC}_{%.3d{I23}}                     ; @BT 06
   85 0000 0000 001C 001C   05                                      .DB 1 + {ABC}_{%.3d{I23}} - 2             ; @BT 05
   86 0000 0000 001D 001D   3C 30 31                                .DB "<01"               ; @BT END
                                                            
                                                                    .DEFINE COUNT = 10
                                                                    .DEFINE UNIT = 5
                                                            Label_{%.4x{COUNT}}:
                                                            Label_{%.3X{COUNT}}_{%.3X{UNIT}}:
                                                            Label_{%.9d{COUNT+1}}:
                                                            Label_{%.3i{COUNT+1+2+3+4+I10}}:
                                                            
                                                                    .MACRO MacroTest
                                                                    .if \@ == 2
                                                                      .db "07>"                ; @BT TEST-07 07 START
                                                            LastNumberShouldBeTwo_{\@+1+2-3}
                                                            LastNumberShouldBeThree_{ \@ + 1 + 3 - 3 }:
                                                            InTheMiddleShouldBeFive_{  \@  *  2  +  1  }_IsThere
                                                            LastNumbersShouldBeOneTwoThree_{1 + \@ - 2}{%.1d{\@}}{\@+1}
                                                            InTheMiddleOneTwoThree_{\@ - 1}{\@}{\@+1}_IsThere
                                                                      .db {"{\@ + 3 - 3 + 1}"} ; @BT 33
                                                                      .db { "{\@*\@}" }        ; @BT 34
                                                                      .db {"{\1+\@}" }         ; @BT 35
                                                                      .db "<07"                ; @BT END
                                                                    .endif
                                                                    .if 0 + \@ + 1 == 2 + 1
                                                                    .db "08>"                 ; @BT TEST-08 08 START
                                                                    .print "-----------------------------------------------------------------\n"
                                                                    .db MyValueIs_{ %11 } + 1 ; @BT 04
                                                                    .print "-----------------------------------------------------------------\n"
                                                                    .db "<08"                 ; @BT END
                                                                    .endif
                                                            Hack_{\@+1000}:
                                                            Hack_{\@+1}_Hack:
                                                            Hack_{3+\@}_More:
                                                                    .ENDM
                                                            
                                                            All_{1 + 1+1+1}_MacroTests1:
                                                            All_{I10-6}_MacroTests2:      
                                                                    MacroTest 1
   97 0000 0000 0020 0020   30 37 3E                                MacroTest 2
  103 0000 0000 0023 0023   33 
  104 0000 0000 0024 0024   34 
  105 0000 0000 0025 0025   35 
  106 0000 0000 0026 0026   3C 30 37 
  109 0000 0000 0029 0029   30 38 3E 
  111 0000 0000 002C 002C   04 
  113 0000 0000 002D 002D   3C 30 38 
                                                                    MacroTest 3
                                                                    MacroTest 4
                                                                    
  127 0000 0000 0030 0030   30 32 3E                                .DB "02>"               ; @BT TEST-02 02 START
  128 0000 0000 0033 0033   7B 41 42 43 7D                          .DB "{ABC}"             ; @BT 7B 41 42 43 7D
  129 0000 0000 0038 0038   31 32 33                                .DB {"{I1}"}, {"{%.1i{I2}}"}, {"{%.1d{I3}}"} ; @BT 31 32 33
  130 0000 0000 003B 003B   3C 30 32                                .DB "<02"               ; @BT END
                                                            
  132 0000 0000 003E 003E   30 33 3E                                .DB "03>"               ; @BT TEST-03 03 START
  133 0000 0000 0041 0041   41 42 43                                .DB {"{ABC}"}           ; @BT 41 42 43
  134 0000 0000 0044 0044   30 30 30 41 30                          .DB {   "0{%.3X{I10}}0"    } ; @BT 30 30 30 41 30
  135 0000 0000 0049 0049   41 42 43 30 30 30 41 30                 .DB { "{ABC}0{%.3X{I10}}0" } ; @BT 41 42 43 30 30 30 41 30
  136 0000 0000 0051 0051   3C 30 33                                .DB "<03"               ; @BT END
                                                            
  138 0000 0000 0054 0054   30 34 3E                                .DB "04>"                    ; @BT TEST-04 04 START
  139 0000 0000 0057 0057   35                                      .DB {"{_sizeof_TestStruct}"} ; @BT 35
  140 0000 0000 0058 0058   31                                      .DB {"{_sizeof_label1}"}     ; @BT 31
  141 0000 0000 0059 0059   3C 30 34                                .DB "<04"                    ; @BT END
                                                            
                                                                    .PRINT "I10-1 = ", I10-1, " = 9\n"
                                                                    
  145 0000 0000 005C 005C   30 35 3E                                .DB "05>"                ; @BT TEST-05 05 START
  146 0000 0000 005F 005F   31 30                                   .DB {"{1+2+3+4}"}        ; @BT 31 30
  147 0000 0000 0061 0061   39                                      .DB {"{-1+I10}"}         ; @BT 39
  148 0000 0000 0062 0062   39                                      .DB { "{I10-1}" }        ; @BT 39
  149 0000 0000 0063 0063   31                                      .DB { "{I23-I10-I3*4}" } ; @BT 31
  150 0000 0000 0064 0064   3C 30 35                                .DB "<05"                ; @BT END
                                                            
  152 0000 0000 0067 0067   30 36 3E                                .DB "06>"                 ; @BT TEST-06 06 START
  153 0000 0000 006A 006A   39                                      .DB { "{I10-%1}" }        ; @BT 39
  154 0000 0000 006B 006B   39                                      .DB { "{I10-$1}" }        ; @BT 39
  155 0000 0000 006C 006C   39                                      .DB { "{I10-0x1}" }       ; @BT 39
  156 0000 0000 006D 006D   39                                      .DB { "{I10-1h}" }        ; @BT 39
  157 0000 0000 006E 006E   39                                      .DB { "{I10-0b00001}" }   ; @BT 39
  158 0000 0000 006F 006F   39                                      .DB { "{-%1+I10}" }       ; @BT 39
  159 0000 0000 0070 0070   39                                      .DB { "{%1+I10-2}" }      ; @BT 39
  160 0000 0000 0071 0071   39                                      .DB { "{-$1+I10}" }       ; @BT 39
  161 0000 0000 0072 0072   39                                      .DB { "{-0x1+I10}" }      ; @BT 39
  162 0000 0000 0073 0073   39                                      .DB { "{-1h+I10}" }       ; @BT 39
  163 0000 0000 0074 0074   39                                      .DB { "{-0b00001+I10}" }  ; @BT 39
  164 0000 0000 0075 0075   39                                      .DB { "{%.1X{ I10 - %1 }}" } ; @BT 39
  165 0000 0000 0076 0076   39                                      .DB { "{%.1x{%1+I2+6}}" } ; @BT 39
  166 0000 0000 0077 0077   39                                      .DB { "{%.1d{I10-$1}}" }  ; @BT 39
  167 0000 0000 0078 0078   39                                      .DB { "{%.1i{I10-0x1}}" } ; @BT 39
  168 0000 0000 0079 0079   39                                      .DB { "{%.1d{I10-1h}}" }  ; @BT 39
  169 0000 0000 007A 007A   3C 30 36                                .DB "<06"                 ; @BT END
                                                            
  171 0000 0000 007D 007D   01                                      .DB _sizeof_label1
                                                                    .ENDS
                                                                    
                                                                    
                                                            
                                                                    .BANK 0 SLOT 0
                                                                    .ORG $1000
                                                            
                                                                    .SECTION "TESTS-B" FORCE
                                                            
  181 0000 0000 1000 1000   30 39 3E                                .DB "09>"                 ; @BT TEST-09 09 START
                                                            gfxHeader{5 - 1}
                                                            gfxHeaderB1{%101 - %1}
                                                            gfxHeaderB2{0b101 - 0b1}
                                                            gfxHeaderH1{0x5 - 0x1}
                                                            gfxHeaderH2{5h - 1h}
                                                            gfxHeaderH3{$5 - $1}
  188 0000 0000 1003 1003   03 10                                   .DW gfxHeader{5 - 1}         ; @BT 03 10
                                                            Data{ 1 + 1 * 1 }{%.3d{ %10 + %10 * %10 }}{      $3      +      $3       *        $3    }Label:
                                                            Data{   %.4X{   0xBEEF   }  }{ I3 }{ %.4X{ $DEAD }}
  191 0000 0000 1005 1005   03 10                                   .DW gfxHeaderB1{%101 - %1}   ; @BT 03 10
  192 0000 0000 1007 1007   03 10                                   .DW gfxHeaderB2{0b101 - 0b1} ; @BT 03 10
  193 0000 0000 1009 1009   03 10                                   .DW gfxHeaderH1{0x5 - 0x1}   ; @BT 03 10
  194 0000 0000 100B 100B   03 10                                   .DW gfxHeaderH2{5h - 1h}     ; @BT 03 10
  195 0000 0000 100D 100D   03 10                                   .DW gfxHeaderH3{$5 - $1}     ; @BT 03 10
                                                            .define COUNT2 5
  197 0000 0000 100F 100F   03 10                                   .DW gfxHeader{COUNT2 - 1}    ; @BT 03 10
  198 0000 0000 1011 1011   3C 30 39                                .DB "<09"                    ; @BT END
                                                            
                                                                    .MACRO MAKE_DATA
                                                                    .DW \1, COUNT\2
                                                                    .ENDM
                                                            
  204 0000 0000 1014 1014   31 30 3E                                .DB "10>"               ; @BT TEST-10 10 START
  201 0000 0000 1017 1017   05 10 05 00 
                                                                    MAKE_DATA Data{ 1 + 1 * 1 }{%.3d{%10 + %10 * %10}}{    $3    +    $3     *      $3           }Label, 2 ; @BT 05 10 05 00
  206 0000 0000 101B 101B   05 10                                   .DW Data{   %.4X{0xBEEF   }  }{ I3 }{ %.4X{ 0xDEAD }} ; @BT 05 10
  207 0000 0000 101D 101D   3C 31 30                                .DB "<10"               ; @BT END
                                                            
  209 0000 0000 1020 1020   31 31 3E                                .DB "11>"               ; @BT TEST-11 11 START
                                                                    .REPEAT 5 INDEX COUNTER_FROM_{0}_TO_{%.x{ 1 + 1 + 1 + %1 }}
  211 0000 0000 1023 1023   04                                      .DB 4-COUNTER_FROM_{0}_TO_{%.x{ 1 + 1 + 1 + %1 }} ; @BT 04 03 02 01 00
  211 0000 0000 1024 1024   03 
  211 0000 0000 1025 1025   02 
  211 0000 0000 1026 1026   01 
  211 0000 0000 1027 1027   00 
                                                                    .ENDR
  213 0000 0000 1028 1028   3C 31 31                                .DB "<11"               ; @BT END
                                                            
  215 0000 0000 102B 102B   31 32 3E                                .DB "12>"               ; @BT TEST-12 12 START
                                                                    .DEFINE FILE_ID = 0
                                                                    .PRINT "FILE_ID = ", FILE_ID, "\n"
                                                                    .INCLUDE { "{%.2d{ FILE_ID+1 }}.s" }     ; @BT 01
                                                                    .REDEFINE FILE_ID = FILE_ID + 1
                                                                    .PRINT "FILE_ID = ", FILE_ID, "\n"
                                                                    .INCLUDE {"{%.2d{FILE_ID+1}}.s"}         ; @BT 02
                                                                    .REDEFINE FILE_ID = FILE_ID + 1
                                                                    .PRINT "FILE_ID = ", FILE_ID, "\n"
                                                                    .INCLUDE { "{%.2d{ FILE_ID + 0x1 }}.s" } ; @BT 03
                                                                    .REDEFINE FILE_ID = FILE_ID + 1
                                                                    .PRINT "FILE_ID = ", FILE_ID, "\n"
                                                                    .DEFINE FILE_NAME_{%.2d{1+1-1}} { "{%.2d{ FILE_ID + %00000000000000000000000000000001 }}.s" }
                                                                    .INCLUDE FILE_NAME_{%.2d{1}}             ; @BT 04
  229 0000 0000 1032 1032   3C 31 32                                .DB "<12"               ; @BT END
                                                            
  231 0000 0000 1035 1035   31 33 3E                                .DB "13>"               ; @BT TEST-13 13 START
  232 0000 0000 1038 1038   02                                      .DB I{1+3-1}-I{%.1d{1+1}}+I{1} ; @BT 02
  233 0000 0000 1039 1039   03 03 01                                .DB {DEF_I}{3}, I{1+1}+1, I{1}       ; @BT 03 03 01
  234 0000 0000 103C 103C   03 03 01                                .DB I{$3}, {DEF_I}{$1+$1}+$1, {DEF_I}{$1}  ; @BT 03 03 01
  235 0000 0000 103F 103F   03 03 01                                .DB I{%11}, I{%1+%1}+%1, I{%1} ; @BT 03 03 01
  236 0000 0000 1042 1042   3C 31 33                                .DB "<13"               ; @BT END
                                                            
                                                                    .ENDS
                                                            
  240 0000 0000 1045 1045   31 34 3E                                .DB "14>"               ; @BT TEST-14 14 START
                                                                    .REPEAT 5 INDEX COUNTER_FROM_{0}_TO_{%.x{ 1 + 1 + 1 + %1 }}
  242 0000 0000 1048 1048   04                                      .DB 4-COUNTER_FROM_{0}_TO_{%.x{ 1 + 1 + 1 + %1 }} ; @BT 04 FF 03 FF 02 FF 01 FF 00 FF
  243 0000 0000 1049 1049   FF 
  242 0000 0000 104A 104A   03 
  243 0000 0000 104B 104B   FF 
  242 0000 0000 104C 104C   02 
  243 0000 0000 104D 104D   FF 
  242 0000 0000 104E 104E   01 
  243 0000 0000 104F 104F   FF 
  242 0000 0000 1050 1050   00 
  243 0000 0000 1051 1051   FF 
                                                                    .DB $ff
                                                                    .ENDR
                                                                    .REPEAT 5 INDEX COUNTER_FROM_{0}_TO_{%.x{ 1 + 1 + 1 + %1 }}
  246 0000 0000 1052 1052   00                                      .DB COUNTER_FROM_{0}_TO_{%.x{ 1 + 1 + 1 + %1 }} ; @BT 00 01 02 03 04
  246 0000 0000 1053 1053   01 
  246 0000 0000 1054 1054   02 
  246 0000 0000 1055 1055   03 
  246 0000 0000 1056 1056   04 
                                                                    .ENDR
  248 0000 0000 1057 1057   3C 31 34                                .DB "<14"               ; @BT END
                                                            
                                                                    .DEFINE SUPERDUPER 1
                                                                    
  252 0000 0000 105A 105A   31 35 3E                                .DB "15>"               ; @BT TEST-15 15 START
                                                                    .IF 0
                                                                    .DB "{HAH}"
                                                                    .DB { "{HOH}" }
                                                                    .ENDIF
  257 0000 0000 105D 105D   7B 48 49 7D                             .DB "{HI}"              ; @BT 7B 48 49 7D
  258 0000 0000 1061 1061   31                                      .DB { "{SUPERDUPER}" }  ; @BT 31
  259 0000 0000 1062 1062   3C 31 35                                .DB "<15"               ; @BT END
                                                                    
                                                                    
