@DATABASE
@NODE MAIN 16C5X
* 16C5X HyperSource© include file for 16C5X
* © 1998 RST Ralf Steines Trier, ALL RIGHTS RESERVED
*
* source: Microchip databook 1994
*

    @{" 16C5X CPU-CORE     " link "16C5X_CPU-CORE"}
    @{" 16C5X INTERRUPTS   " link "16C5X_INTERRUPTS"}

    @{" 16C5X IO-PORTS     " link "16C5X_IO-PORTS"}

    @{" 16C5X TIMERS       " link "16C5X_TIMERS"}

* Values with a '*' in front of them show the defaults after a RESET.

@ENDNODE
@NODE 16C5X_INTERRUPTS
****************************
*    INTERRUPT VECTORS     *
****************************

  ; THESE ARE NO VECTORS BUT PROGRAM MEMORY LOCATIONS THE CPU JUMPS TO
  ; MUST CONTAIN OBJECT CODE TO JUMP TO YOUR RELATING ROUTINES !

  C_RESET    = ROM_SIZE-1


@ENDNODE
@NODE 16C5X_CPU-CORE
************************
*       CPU CORE       *
************************

  IND       = REGS+$00 ;  USE CONTENTS OF FSR TO ADDRESS DATA MEMORY
                       ;  (NO PHYSICAL REGISTER)

  PCL       = REGS+$02 ;  LOW ORDER 8 BITS OF PC
                       ;  (*0 AFTER RESET)

  FSR       = REGS+$04 ;  INDIRECT DATA MEMORY ADDRESS POINTER 0
                       ;  LOW ORDER 8 BITS
                       ;  (*UNDEFINED AFTER RESET)

  PCLATH    = REGS+$0A ;  HOLDING REGISTER FOR HIGH BYTE OF PC
                       ;  (*>ROM_SIZE-1 AFTER RESET)

  STATUS    = REGS+$03 ;  STATUS REGISTER


        TO        = 4           ; TIMEOUT BIT, ACTIVE LOW !
                                ;  0= WATCHDOG TIMEOUT OCCURED
                                ; *1= SET BY CLRWDT, SLEEP, POWER UP

        PD        = 3           ; POWER DOWN BIT, ACTIVE LOW
                                ;  0= POWER DOWN OCCURED
                                ;     OR SLEEP WAS EXECUTED
                                ; *1= SET 1 BY CLRWDT OR POWER UP

        Z         = 2           ; ZERO BIT
                                ;  1= LAST ARITHMETIC OPERATION RESULTS 0
                                ;  MOVF ALSO AFFECT ZERO BIT !
                                ;  (*UNDEFINED AFTER RESET)

        DC        = 1           ; DIGIT CARRY / -BORROW BIT
                                ;  1= ADDWF,ADDLW OVERFLOWED  BIT 3
                                ;     SUBWF,SUBLW UNDERFLOWED BIT 3
                                ;  (*UNDEFINED AFTER RESET)

        C         = 0           ; CARRY / -BORROW BIT
                                ;  1= ADDWF,ADDLW OVERFLOWED  BIT 7
                                ;     SUBWF,SUBLW UNDERFLOWED BIT 7
                                ;  RRF AND RLF ALSO AFFECT C !
                                ;  (*UNDEFINED AFTER RESET)

@ENDNODE
@NODE 16C5X_IO-PORTS
****************************
*   INPUT/ OUTPUT PORTS    *
****************************

;       RTCC = EXTERNAL INPUT PIN FOR REAL TIME CLOCK/COUNTER

; TRISA                   DATA DIRECTION REGISTER FOR PORT A
;                         ACCESS VIA 'TRIS PORTA' INSTRUCTION

        TRISA3    = 3           ; (0=OUT, *1=IN)
        TRISA2    = 2           ; (0=OUT, *1=IN)
        TRISA1    = 1           ; (0=OUT, *1=IN)
        TRISA0    = 0           ; (0=OUT, *1=IN)

  PORTA     = REGS+$05 ;  PORT A DATA REGISTER
                       ;  (*UNDEFINED AFTER RESET)

        RA3       = 3           ; I/O
        RA2       = 2           ; I/O
        RA1       = 1           ; I/O
        RA0       = 0           ; I/O

; TRISB                   DATA DIRECTION REGISTER FOR PORT B
;                         ACCESS VIA 'TRIS PORTB' INSTRUCTION

        TRISB7    = 7           ; (0=OUT, *1=IN)
        TRISB6    = 6           ; (0=OUT, *1=IN)
        TRISB5    = 5           ; (0=OUT, *1=IN)
        TRISB4    = 4           ; (0=OUT, *1=IN)
        TRISB3    = 3           ; (0=OUT, *1=IN)
        TRISB2    = 2           ; (0=OUT, *1=IN)
        TRISB1    = 1           ; (0=OUT, *1=IN)
        TRISB0    = 0           ; (0=OUT, *1=IN)

  PORTB     = REGS+$06 ;  PORT B DATA REGISTER
                       ;  (*UNDEFINED AFTER RESET)

        RB7       = 7           ; I/O
        RB6       = 6           ; I/O
        RB5       = 5           ; I/O
        RB4       = 4           ; I/O
        RB3       = 3           ; I/O
        RB2       = 2           ; I/O
        RB1       = 1           ; I/O
        RB0       = 0           ; I/O

 .IFD HAS_PORTC ; 16C55/16C57 ONLY

; TRISC                   DATA DIRECTION REGISTER FOR PORT C
;                         ACCESS VIA 'TRIS PORTC' INSTRUCTION

        TRISC7    = 7           ; (0=OUT, *1=IN)
        TRISC6    = 6           ; (0=OUT, *1=IN)
        TRISC5    = 5           ; (0=OUT, *1=IN)
        TRISC4    = 4           ; (0=OUT, *1=IN)
        TRISC3    = 3           ; (0=OUT, *1=IN)
        TRISC2    = 2           ; (0=OUT, *1=IN)
        TRISC1    = 1           ; (0=OUT, *1=IN)
        TRISC0    = 0           ; (0=OUT, *1=IN)

  PORTC     = REGS+$07 ;  PORT C DATA REGISTER
                       ;  (*UNDEFINED AFTER RESET)

        RC7       = 7           ; I/O
        RC6       = 6           ; I/O
        RC5       = 5           ; I/O
        RC4       = 4           ; I/O
        RC3       = 3           ; I/O
        RC2       = 2           ; I/O
        RC1       = 1           ; I/O
        RC0       = 0           ; I/O

 .ENDIF

@ENDNODE
@NODE 16C5X_TIMERS
****************************
*     TIMER REGISTERS      *
****************************

  RTCC      = REGS+$01 ;  TIMER 0 COUNTER REGISTER
                       ;  (*UNDEFINED AFTER RESET)

; OPTION                  OPTION REGISTER
;                         ACCESS VIA 'OPTION' INSTRUCTION

        RTS       = 5           ; TIMER 0 SIGNAL SOURCE
                                ;  0= INTERNAL INSTRUCTION CYCLE CLOCK
                                ; *1= TRANSITION ON RA4/T0CKI PIN

        RTE       = 4           ; TIMER 0 SIGNAL EDGE
                                ;  0= INCREMENT ON RISING EDGE ON RA4/T0CKI
                                ; *1= INCREMENT ON FALLING EDGE ON RA4/T0CKI

        PSA       = 3           ; PRESCALER ASSIGNMENT
                                ;  0= TMR0
                                ; *1= WDT

        PS2       = 2           ; PRESCALER VALUE
        PS1       = 1           ;  PS2 PS1 PS0  TMR0 RATE  WDT RATE
        PS0       = 0           ;   0   0   0     1:2        1:1
                                ;   0   0   1     1:4        1:2
                                ;   0   1   0     1:8        1:4
                                ;   0   1   1     1:16       1:8
                                ;   1   0   0     1:32       1:16
                                ;   1   0   1     1:64       1:32
                                ;   1   1   0     1:128      1:64
                                ;  *1  *1  *1     1:256      1:128

@ENDNODE
