# ##############################################################
#  MakeFile - the SAS make file for Z80Simulator & Z80XLate
# ##############################################################
#
SCOpts = cpu=68020 nover strmer data=far ign=100,154,147 nostkchk idir=INCLUDE:
#
LibList = LIB:sc.lib,LIB:scm.lib,LIB:Amiga.lib,LIB:Funcs.lib
#
XLibs = LIB:sc.lib,LIB:scm.lib,LIB:Funcs.LIB,LIB:Amiga.lib
#
GLOB = CPGM:GlobalObjects/CommonFuncs.o
#
OBJS = Z80Code.o Z80Console.o Z80ST1.o Z80ST2.o Z80ST3.o\
 Z80S21.o Z80S22.o Z80S23.o Z80S24.o Z80S.o\
 Z80Mach.o Z80LexLoader.o OutPort.o\
 Z80DisAssembler.o ShowBrkPt.o ClearBrkPt.o SetBrkPt.o\
 DumpMem.o DumpStack.o FillMem.o PrintListing.o\
 TranslateReq.o IM0Req.o IM2Req.o StartAddr.o CmdReq.o\
 InPort.o AddressRange.o Z80SimGTGUI.o Z80Loader.o\
 SetRegister.o Z80MenuFuncs.o $(GLOB)
#
# #################################################################
# Careful with this target!!:
#
clean:
  Delete *.o
# #################################################################
#
# ----------------------------------------------------------------------
# ---------------- Z80Xlate Section: -----------------------------------
# ----------------------------------------------------------------------
#
#
Z80Xlate:   Z80Xlate.o Z80Xlatemain.o
   SLink LIB:c.o,Z80Xlate.o,Z80Xlatemain.o TO Z80Xlate LIB $(XLibs)
#
Z80Xlate.o: Z80Xlate.c
   SC $(SCOpts) ignore=100 objname=Z80Xlate.o Z80Xlate.c
#
Z80Xlate.c: Z80Xlate.flex
   FLeX -L -s -t Z80Xlate.flex >Z80Xlate.c
#
Z80Xlatemain.o:   Z80Xlatemain.c
   SC $(SCOpts) Z80Xlatemain.c
#
#
# ------------------------------------------------------------------------
# ----- Z80Simulator: ----------------------------------------------------
# ------------------------------------------------------------------------
#
Z80Simulator: $(OBJS)  
   SLink WITH Z80.with TO Z80Simulator STRIPDEBUG
   Copy Z80Simulator CData:Z80/Z80Simulator
#
# ------------------------------------------------------------------------
# ----- Z80SimX: -- Debug version of the simulator: ----------------------
# ------------------------------------------------------------------------
#
Z80SimX: $(OBJS)
   SLink  WITH Z80.with TO Z80SimX # MAP Z80SimX.map s,f,x,h
   Copy Z80SimX CData:Z80/Z80SimX
#
#  ------------------ Default Compile Rule: ----------------------------
#
.c.o:
   SC $(SCOpts) dbg=sym objname=$@ $?
#
#  --------------- Requester build rules: ------------------------------
#
# ----------------------------------------------------------------------
# ---------------- Main GUI for the Simulator: -------------------------
#
Z80SimGTGUI.o    : Z80SimGTGUI.c
#
# ----------------------------------------------------------------------
#
CmdReq.o         : CmdReq.c
#
ShowBrkPt.o      : ShowBrkPt.c
#
ClearBrkPt.o     : ClearBrkPt.c
#
SetBrkPt.o       : SetBrkPt.c
#
SetRegister.o    : SetRegister.c
#
DumpMem.o        : DumpMem.c
#
DumpStack.o      : DumpStack.c
#
FillMem.o        : Fillmem.c
#
PrintListing.o   : PrintListing.c
#
StartAddr.o      : StartAddr.c
#
InPort.o         : InPort.c
#
OutPort.o        : OutPort.c
#
IM0Req.o         : IM0Req.c
#
IM2Req.o         : IM2Req.c
#
TranslateReq.o   : TranslateReq.c
#
AddressRange.o   : AddressRange.c
#
Z80MenuFuncs.o   : Z80MenuFuncs.c
#
Z80LexLoader.o   : Z80LexLoader.c
#
Z80Loader.o      : Z80Loader.c
#
Z80Code.o        : Z80Code.c
#
Z80Console.o     : Z80Console.c
#
Z80DisAssembler.o: Z80DisAssembler.c
#
Z80ST1.o         : Z80ST1.c
#
Z80ST2.o         : Z80ST2.c
#
Z80ST3.o         : Z80ST3.c
#
Z80S21.o         : Z80S21.c
#
Z80S22.o         : Z80S22.c
#
Z80S23.o         : Z80S23.c
#
Z80S24.o         : Z80S24.c
#
Z80S.o           : Z80S.c
#
Z80Mach.o        : Z80Mach.c
#
# ---------------------------------------------------------------------
# --------------- Z80Xlator - debug version of the lexical analyzer: 
# ---------------------------------------------------------------------
#
Z80Xlator:   Z80XlateD.o
   SLink LIB:c.o,Z80XlateD.o TO Z80Xlator LIB $(XLibs) ADDSYM
#
Z80XlateD.o: Z80XlateD.c
   SC $(SCOpts) def XLATE_DEBUG=1 Z80XlateD.c
#
Z80XlateD.c: Z80Xlate.flex
   FLeX -L -s -t Z80Xlate.flex >Z80XlateD.c
#   
#  --------------------------------------------------------------------
#  ------- Debug version of Z80LexLoader code: ------------------------
#  --------------------------------------------------------------------
#
TestLexLoader: Z80LexLoaderD.o
   SLink LIB:c.o,Z80LexLoaderD.o TO TestLexLoader LIB $(LibList) ADDSYM
#
Z80LexLoaderD.o:  Z80LexLoaderD.c
   SC $(SCOpts) deb=symbol def LOADFILE_DEBUG=1 Z80LexLoaderD.c
#
Z80LexLoaderD.c:  Z80LexLoader.flex
   FLeX -L -s -t Z80LexLoader.flex >Z80LexLoaderD.c
#
#  ------------------------- Debugging executables: ---------------------
#
#Z80Loader.c: Z80Loader.defn
#   FSMGen <Z80Loader.defn Z80Loader.c
