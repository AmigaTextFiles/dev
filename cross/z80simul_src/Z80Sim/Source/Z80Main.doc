Z80SimGTGUI.c/CloseDownScreen()

NAME
   CloseDownScreen - Get rid of screen-related data.


SYNOPSIS
   void CloseDownScreen( void )


FUNCTION
   Free the VisualInfo (for GadTools) & Unlock the Public Screen
   (Workbench).


NOTES
   This function is also called by cleanup() in Z80Loader.c,
   this is why this function is NOT PRIVATE.


Z80SimGTGUI.c/CloseLibs()

NAME
   CloseLibs - close all open libraries.


SYNOPSIS
   void CloseLibs( void )


FUNCTION
   This function closes IntuitionBase, GfxBase, & GadToolsBase.


NOTES
   This function is VISIBLE.


SEE ALSO
   OpenLibs()


Z80SimGTGUI.c/CloseZ80SimWindow()

NAME
   CloseZ80SimWindow - Close the main GUI window.


SYNOPSIS
   void CloseZ80SimWindow( void )


FUNCTION
   Clear & Free the MenuStrip, close the Z80SimWindow, then
   Free the Gadgets (Z80SimGList).


SEE ALSO
   Z80SimCloseWindow()

Z80SimGTGUI.c/Display_Status()

NAME
   Display_Status - Update the Graphical representation of the Z80
                    Status Text Gadget.


SYNOPSIS
   void Display_Status( void )


FUNCTION
   take the current integer value of status & convert it into the
   correct status string to display.


Z80SimGTGUI.c/EditFile()

NAME
   EditFile - Execute an Edit command string.


SYNOPSIS
   error = EditFIle( char *filename )


FUNCTION
   Generate an 'Execute'able string of the form:
   Editor filename


INPUTS
   filename - the name of the file to edit.

 RETURNS
   the result of 'Execute()'


NOTES
   called by Z80SimEditFileMI();


Z80SimGTGUI.c/Execute_Instruction()

NAME
   Execute_Instruction - Process the next Z80 instruction byte.


SYNOPSIS
   status = Execute_Instruction( UBYTE instruction )


FUNCTION
   Decode the instruction, then process it as a Z80 would,
   Update the display, CheckBkpt()'s & return status.
   open a Dump Console.

 RETURNS
   status - the Z80 Processor status integer value.
 

SEE ALSO
   decode_mach(), Update_Regs(), CheckBkpt()

Z80SimGTGUI.c/Form_String()

NAME
   Form_String - Make the memory string for Dump Memory function. 


SYNOPSIS
   Form_String( struct Console *cons, UBYTE *memory, ULONG address,
                int howmany );


FUNCTION
   Make a string of the memory contents in order to display them
   in the console.


INPUTS
   cons    - The console to display the string on.
   memory  - Z80 memory space pointer.
   address - The starting Z80 address memory location.
   howmany - How many bytes of memory to display. 


Z80SimGTGUI.c/HandleZ80SimIDCMP()

NAME
   HandleZ80SimIDCMP - Interface with the user's mouse input.


SYNOPSIS
   continue = HandleZ80SimIDCMP( void )


FUNCTION
   Process menu & Gadget selections made by the user.

 RETURNS
   Exit the program value of 'FALSE' to the main() function.


Z80SimGTGUI.c/Init_Mem()

NAME
   Init_Mem - Place 0x76 (HALT) opcode into all Z80 memory spaces.


SYNOPSIS
   void Init_Mem( void )


FUNCTION
   Initialize all Z80 memory locations to 0x76 (HALT) opcode.


Z80SimGTGUI.c/IntFlags()

NAME
   IntFlags - Update the Graphical representation of the Z80
              Interrupt flag registers 'IFF1' & 'IFF2'.


SYNOPSIS
   void IntFlags( void )


FUNCTION
   Determine from IFF1_2 which Interrupt flags need to be asserted
   or unasserted, then update the Text Gadgets.


Z80SimGTGUI.c/Make_Byte()

NAME
   Make_Byte - is part of the configuration file reader.


SYNOPSIS
   Z80Address = Make_Byte( char *buffer, UWORD address )


FUNCTION
   Get a byte from the buffer & place it at the address.


INPUTS
   'buffer'  - the character string read in from the config file.
   'address' - starting address of the Z80 memory space. 


NOTES
   see get_byte() note.

Z80SimGTGUI.c/Misc_Regs()

NAME
   Misc_Regs - Update the Graphical representation of the Z80
               'I' & 'R' registers.


SYNOPSIS
   void Misc_Regs( void )


FUNCTION
   take the current values of reg[] & convert them to
   binary strings.  Next, send them to the correct GUI Text
   gadgets.


Z80SimGTGUI.c/OpenLibs()

NAME
   OpenLibs - open needed libraries.


SYNOPSIS
   error = OpenLibs( void )


FUNCTION
   This function opens IntuitionBase, GfxBase & GadToolsBase.

 RETURNS
   0 for success, a negative number for failure.


Z80SimGTGUI.c/OpenZ80SimWindow()

NAME
   OpenZ80SimWindow - Open the Z80SimWnd.


SYNOPSIS
   error = OpenZ80SimWindow( void )


FUNCTION
   This function Sets up the GadTools, & opens the main GUI
   window.

 RETURNS
   0 for success, a negative number for failure.


Z80SimGTGUI.c/Open_Dump_Window()

NAME
   Open_Dump_Window - Open a Console window to show memory contents.


SYNOPSIS
   DWindow = Open_Dump_Window( char *title, int x, int y )


FUNCTION
   Open a window & a Console to show the memory 'Dump' that the
   user requested.


INPUTS
   title - title string to place on the new window.
   x     - the LeftEdge to open the window at.
   y     - the TopEdge to open the window at.

 RETURNS
   DWindow - a pointer to the Dump Memory Window.
 

WARNINGS
   there is an exit() point in this function.


Z80SimGTGUI.c/PreprocessFile()

NAME
   PreprocessFile - make the Execute Macro string.


SYNOPSIS
   error = PreprocessFile( char *filename, char *outfile )


FUNCTION
   Generate an 'Execute'able string of the form:
   Macro <filename >outfile

 RETURNS
   the result of 'Execute()'


SEE ALSO
   Z80SimMacroMI()


Z80SimGTGUI.c/PrintFile()

NAME
   PrintFile - Output a source listing to a file.


SYNOPSIS
   error = PrintFile( char *filename )


FUNCTION
   Write the dis-assembly from 'FromAddress' to 'ToAddress'
   to the 'filename'.

 RETURNS
   0 if successful, -1 if there is a failure.


SEE ALSO
   Z80SimPrtListMI()

Z80SimGTGUI.c/ProcessToolTypes()

NAME
   ProcessToolTypes - Get the tooltypes from the program icon &
                      set the Tool strings accordingly.


SYNOPSIS
   void ProcessToolTypes( void )


FUNCTION
   Examine the program Icon for any ToolTypes that the user
   might have placed there.

   The Current ToolTypes recognized by the Z80Siumlator are:
       "CONFIGFILE" (Default:  Z80.cfg)
       "EDITOR"     (Default:  SC:C/SE)
       "TRANSLATOR" (Default:  Z80XLate)
       "ASSEMBLER"  (Default:  Z80Asm)
       "MACRO"      (Default:  Macro)


Z80SimGTGUI.c/Save_File()

NAME
   Save_File - write a configuration file.


SYNOPSIS
   error = Save_File( char *filename )


FUNCTION
   Write the register contents to the configuration file.
   Then, write out all memory spaces specified by the user.


INPUTS
   filename - The Amiga Output filename.

 RETURNS
   -1 if there is an error, 0 for success.


SEE ALSO
   HandleAddrRange()

Z80SimGTGUI.c/SetupScreen()

NAME
   SetupScreen - Get ready for GadTools window.


SYNOPSIS
   error = SetupScreen( void )


FUNCTION
   This function locks the Public Screen, & Gets the
   VisualInfo that GadTools needs.

 RETURNS
   0 for success, a negative number for failure.


Z80SimGTGUI.c/ShutDown()

NAME
   ShutDown - Free up system resources & allocated Z80 memory space.


SYNOPSIS
   void ShutDown( void )


FUNCTION
   Close the main GUI (register) window.
   Free the allocated Z80 memory space (mem).
   Call CloseDownScreen(), then CloseLibs().


Z80SimGTGUI.c/SrcCodeListViewClicked()

NAME
   SrcCodeListViewClicked -


SYNOPSIS
   continue = SrcCodeListViewClicked( void )


FUNCTION
   This function should only highlight whatever line the user
   clicked on.

 RETURNS
   TRUE


Z80SimGTGUI.c/Update_Regs()

NAME
   Update_Regs - Update the Graphical representation of the Z80
                 registers.


SYNOPSIS
   void Update_Regs( UWORD program_counter )


FUNCTION
   take the current values of reg[] & dreg[] & convert them to
   binary strings.  Next, send them to the correct GUI Text
   gadgets.  Finally, update the status Text Gadget.


INPUTS
   'program_counter' - the current program counter value of the 
                       Z80 simulated processor.


Z80SimGTGUI.c/Write_It()

NAME
   Write_It - write a string to the output file.


SYNOPSIS
   error = Write_It( FileHandle *file, char *output, int length )


FUNCTION
   Write the 'output' string of length 'length' to the 'file'.


INPUTS
   file   - Amiga Output file pointer.
   output - output string to write to file.
   length - length of outstr.


Z80SimGTGUI.c/Z80SImMacroMI()

NAME
   Z80SimMacroMI - Execute the Macro menuitem command.


SYNOPSIS
   continue = Z80SimMacroMI( void )


FUNCTION
   Get input & output filenames from the user, then
   call PreprocessFile().

 RETURNS
   TRUE


SEE ALSO
   PreprocessFile()


Z80SimGTGUI.c/Z80SimAboutsMI()

NAME
   Z80SimAboutMI - Show some information about the program.


SYNOPSIS
   continue = Z80SimAboutMI( void )


FUNCTION
   Open the 'About' information requester.

 RETURNS
   TRUE


Z80SimGTGUI.c/Z80SimAssembleMI()

NAME
   Z80SimAssembleMI - Execute the Assemble menuitem command.


SYNOPSIS
   continue = Z80SimAssembleMI( void )


FUNCTION
   Get the source filename from the user, then
   generate a string of the form:
      Z80Asm srcfile -l srcfile.list -o srcfile.o
   Finally, Execute it.

 RETURNS
   TRUE


Z80SimGTGUI.c/Z80SimClearBreakMI()

NAME
   Z80SimClearBreakMI - Execute the ClearBreakPt menuitem command.


SYNOPSIS
   continue = Z80SimClearBreakMI( void )


FUNCTION
   Delete a breakpoint from the list via requester.

 RETURNS
   TRUE
 

SEE ALSO
   HandleClearBreakPt()

Z80SimGTGUI.c/Z80SimCloseWindow()

NAME
   Z80SimCloseWindow - Close the main GUI window.


SYNOPSIS
   continue = Z80SimCloseWindow( void )


FUNCTION
   Check user sanity first, then Call closeZ80SimWindow().

 RETURNS
   Exit the program value of 'FALSE' to the IDCMP loop.


NOTES
   This function is also called by cleanup() in Z80Loader.c
   This function is part of the IDCMP loop.


SEE ALSO
   CloseZ80SimWindow(), Z80SimSaveMI()

Z80SimGTGUI.c/Z80SimDumpMI()

NAME
   Z80SimDumpMI - Execute the Dump memory menuitem command.


SYNOPSIS
   continue = Z80SimDumpMI( void )


FUNCTION
   Get start & ending addresses from the user, then open a 
   Dump Memory Console.

 RETURNS
   TRUE
 

SEE ALSO
   HandleDumpReq(), Open_Dump_Console()

Z80SimGTGUI.c/Z80SimEditFileMI()

NAME
   Z80SimEditFileMI - Execute an Edit menuitem command.


SYNOPSIS
   continue = Z80SimEditFIleMI( void )


FUNCTION
   Get a filename from the user that the user wants to edit,
   then call EditFile( filename );

 RETURNS
   TRUE


SEE ALSO
   EditFile()


Z80SimGTGUI.c/Z80SimFillMI()

NAME
   Z80SimFillMI - Execute the Fill memory menuitem command.


SYNOPSIS
   continue = Z80SimFillMI( void )


FUNCTION
   Get start, ending addresses & a pattern from the user, then
   Fill the Z80 memory space specified with the pattern.

 RETURNS
   TRUE
 

SEE ALSO
   HandleFillMemReq()

Z80SimGTGUI.c/Z80SimFindCurrentMI()

NAME
   Z80SimFindCurrentMI - Execute the Find Current Inst'
                         menuitem command.


SYNOPSIS
   continue = Z80SimFindCurrentMI( void )


FUNCTION
   Find the current instruction & update the ListView & CurrentInst
   string gadgets accordingly.

 RETURNS
   TRUE

Z80SimGTGUI.c/Z80SimGoMI()

NAME
   Z80SimGoMI - Execute the GO! menuitem command.


SYNOPSIS
   continue = Z80SimGoMI( void )


FUNCTION
   Get a starting address from the user, then set the
   Z80 program counter to this value, then
   Execute_Instruction()'s forever.

 RETURNS
   TRUE
 

SEE ALSO
   decode_mach(), Update_Regs(), checkBkpt(), Execute_Instruction()

Z80SimGTGUI.c/Z80SimInt_MI()

NAME
   Z80SimInt_MI - Execute the INT menuitem command.


SYNOPSIS
   continue = Z80SimInt_MI( void )


FUNCTION
   Determine which interrupt mode is currently set, (0 -> 2):
   For imode == 0:
     Get the RST address (for PC) from the user, then
     Execute_Instruction()'s forever.

   For imode == 1:
     Set the program counter to 0x0038, then
     Execute_Instruction()'s forever.

   For imode == 2:
     Get an interrupt vector value from the user, form
     the program counter from this value & the contents of the
     'I' register, then
     Execute_Instruction()'s forever.

 RETURNS
   TRUE
 

SEE ALSO
   HandleIM0Req(), HandleIM2Req(), Execute_Instruction()

Z80SimGTGUI.c/Z80SimLoadMI()

NAME
   Z80SimLoadMI - load the configuration file specified by the user.


SYNOPSIS
   continue = Z80SimLoadMI( void )


FUNCTION
   Open the Load file ASL requester to get a filename from the
   user, then call File_Loader() to load in a new configuartion
   file if strlen( filename ) > 0.

 RETURNS
   TRUE


Z80SimGTGUI.c/Z80SimNMI_MI()

NAME
   Z80SimNMI_MI - Execute the NMI menuitem command.


SYNOPSIS
   continue = Z80SimNMI_MI( void )


FUNCTION
   Clear the IFF1 register, set the Z80 program counter to 0x0066,
   then Execute_Instruction()'s forever.

 RETURNS
   TRUE
 

SEE ALSO
   Execute_Instruction()

Z80SimGTGUI.c/Z80SimPrtListMI()

NAME
   Z80SimPrtListMI - Execute the Print Listing menuitem command.


SYNOPSIS
   continue = Z80SimPrtListMI( void )


FUNCTION
   Get the output filename, the To & From addresses from the user,
   then Write the dis-assembly from 'FromAddress' to 'ToAddress'
   to the 'filename'.

 RETURNS
   TRUE


SEE ALSO
   PrintFile()

Z80SimGTGUI.c/Z80SimQuitMI()

NAME
   Z80SimQuitMI - The only correct (besides the CloseWindow
                  gadget) for the program.


SYNOPSIS
   continue = Z80SimQuitMI( void )


FUNCTION
   Make sure that the user really wants to quit, then ShutDown()
   exit() the entire program.

 RETURNS
   TRUE if the user was temporarily insane, otherwise, the 
   program is exited here.


Z80SimGTGUI.c/Z80SimRender()

NAME
   Z80SimRender - Draw bevel boxes & draw IText.


SYNOPSIS
   void Z80SimRender( void )


FUNCTION
   Draw bevel boxes around the Z80 registers & add the 
   Flag register IText & display info IText.


Z80SimGTGUI.c/Z80SimRestartMI()

NAME
   Z80SimRestartMI - Execute the Restart menuitem command.


SYNOPSIS
   continue = Z80SimRestartMI( void )


FUNCTION
   Reset the Z80 program counter, then process the Z80 memory 
   byte at the current PC location.

 RETURNS
   TRUE
 

SEE ALSO
   Execute_Instruction()

Z80SimGTGUI.c/Z80SimSaveAsMI()

NAME
   Z80SimSaveAsMI - Save the configuration file.


SYNOPSIS
   continue = Z80SimSaveAsMI( void )


FUNCTION
   Open the save file ASL requester to get a filename from the
   user, then call Save_File() to save a new configuartion
   file if strlen( filename ) > 0.

 RETURNS
   TRUE


Z80SimGTGUI.c/Z80SimSaveMI()

NAME
   Z80SimSaveMI - Save the configuration file.


SYNOPSIS
   continue = Z80SimSaveMI( void )


FUNCTION
   Use the current config filename if it's not empty, otherwise 
   open the save file ASL requester to get a filename from the
   user, then call Save_File() to save a new configuartion
   file if strlen( filename ) > 0.

 RETURNS
   TRUE


Z80SimGTGUI.c/Z80SimSetBreakMI()

NAME
   Z80SimSetBreakMI - Execute the SetBreakPt menuitem command.


SYNOPSIS
   continue = Z80SimSetBreakMI( void )


FUNCTION
   Add a breakpoint to the list via requester.

 RETURNS
   TRUE
 

SEE ALSO
   HandleSetBreakPt()

Z80SimGTGUI.c/Z80SimSetPC_MI()

NAME
   Z80SimSetPC_MI - Execute the Set PC menuitem command.


SYNOPSIS
   continue = Z80SimSetPC_MI( void )


FUNCTION
   Get a starting address from the user, then set
   Z80 program counter to this value, then
   Update the display.

 RETURNS
   TRUE
 

SEE ALSO
   HandleStartAddr(), Update_Regs()

Z80SimGTGUI.c/Z80SimShowBreaksMI()

NAME
   Z80SimShowBreaksMI - Execute the ShowBreakPts menuitem command.


SYNOPSIS
   continue = Z80SimShowBreaksMI( void )


FUNCTION
   Display the Breakpoints.

 RETURNS
   TRUE
 

SEE ALSO
   HandleShowBreakPt()

Z80SimGTGUI.c/Z80SimStackMI()

NAME
   Z80SimStackMI - Execute the Dump Stack menuitem command.


SYNOPSIS
   continue = Z80SimStackMI( void )


FUNCTION
   Get start & ending addresses from the user, then
   open a Dump Console.

 RETURNS
   TRUE
 

SEE ALSO
   HandleStackReq(), Open_Dump_Window()

Z80SimGTGUI.c/Z80SimStepMI()

NAME
   Z80SimStepMI - Execute the Step menuitem command.


SYNOPSIS
   continue = Z80SimStepMI( void )


FUNCTION
   Process the Z80 memory byte at the current PC location.

 RETURNS
   TRUE
 

SEE ALSO
   Execute_Instruction()

Z80SimGTGUI.c/Z80SimTranslateMI()

NAME
   Z80SimTranslateMI - Translate an Intel object file to a 
                       configuration file.


SYNOPSIS
   continue = Z80SimTranslateMI( void )


FUNCTION
   Generate an 'Execute'able string of the form:
   Z80Xlate <Intel_Input >Z80.cfg_OutputFile.

 RETURNS
   TRUE


NOTES
   This function uses InFileName & OutFileName.


Z80SimGTGUI.c/assign_all()

NAME
   assign_all - is part of the configuration file reader.


SYNOPSIS
   void assign_all( char *buffer )


FUNCTION
   Convert the configuration information in buffer to Z80 register
   binary strings.


INPUTS
   'buffer'  - the character string read in from the config file.


NOTES
   assign_all() calls assign_reg() & assign_dreg().

Z80SimGTGUI.c/assign_dreg()

NAME
   assign_dreg - is part of the configuration file reader.


SYNOPSIS
   void assign_dreg( char *buffer, int Dregister_number )


FUNCTION
   Remove the Register designator string from the buffer, then
   convert the next four characters in the buffer to a 16-bit (UWORD)
   value, using get_byte().


INPUTS
   'buffer'  - the character string read in from the configuration file.
   'dregnum' - the reg[] array index equivalent to the
               16-bit Z80 register number. 


NOTES
   'buffer' will be shortened by four char's for the 16-bit value for
   the register as well as the Register designator string 
   (ex: 'SP: ')

Z80SimGTGUI.c/assign_reg()

NAME
   assign_reg - is part of the configuration file reader.


SYNOPSIS
   void assign_reg( char *buffer, int register_number )


FUNCTION
   Remove the Register designator string from the buffer, then
   convert the next two characters in the buffer to an 8-bit (UBYTE)
   value, using get_byte().


INPUTS
   'buffer' - the character string read in from the configuration file.
   'regnum' - the reg[] array index equivalent to the
              Z80 register number 


NOTES
   'buffer' will be shortened by two char's for the 8-bit value for
   the register as well as the Register designator string 
   (ex: 'A: ') 

Z80SimGTGUI.c/findtools()

NAME
   findtools - Get the tools array associated with the filename.


SYNOPSIS
   ToolArray = findtools( char *FileName, BPTR filelock )
    char **


FUNCTION
   Examine the Current Directory for a match to 'FileName',
   then return the toolarray portion of the icon.


INPUTS
   FileName - The Program icon filename.
   filelock - Lock on the program.

 RETURNS
   ToolArray - The array of ToolTypes strings from the icon.


Z80SimGTGUI.c/get_byte()

NAME
   get_byte - is part of the configuration file reader.


SYNOPSIS
   ByteValue = get_byte( char *buffer )


FUNCTION
   convert the first two characters in buffer to an 8-bit (UBYTE)
   value.


INPUTS
   'str' - the character string read in from the configuration file.


RESULT
   the 8-bit equivalent value of the first two characters.


NOTES
   str will be shortened by two char's: 

Z80SimGTGUI.c/getstr()

NAME
   getstr - Get the tools array associated with the filename.


SYNOPSIS
   ToolString = getstr( char **ToolArray, char *ToolName, 
                        char *DefaultToolString )


FUNCTION
   Examine the ToolArray for a match to 'ToolName',
   if NOT found the return the DefaultToolString.


INPUTS
   ToolArray         - the char ** pointer returned from findtools().
   ToolName          - The Tool string to search for.
   DefaultToolString - string to return if the ToolName is NOT
                       found.

 RETURNS
   ToolString - The tool string associated with the ToolName.


Z80SimGTGUI.c/main()

NAME
    Z80Simulator - a program to simulate the Z80 processor.
                   This program is a GadTools-based GUI for
                   the Z80.  This program can be run from 
                   either the CLI or its WorkBench icon.


SYNOPSIS
    Z80Simulator [Z80.cfg]


FUNCTION
    Simulates a Z80 processor with a state machine and 
    graphical display.


INPUTS
    z80.cfg - a configuration file that contains initial register
              values, memory values & breakpoints.

  RETURNS
    RETURN_OK for success, various other error values to 
    indicate various failures.

  TOOLTYPES
    ConfigFile - the name of the configuration file to 
                 initialize the program with (default: Z80.cfg).
    Editor     - The name of the text editor to use on Z80-
                 source code (default: SC:C/SE).
    Translator - The name of the Intel to configuration 
                 file translator (default: Z80XLate).
    Assembler  - The name of the Source to Intel-format 
                 Z80 assembler (default: Z80Asm).
    Macro      - The name of the Macro expander (in case 
                 the assembler doesn't do macros, default: Macro).


HISTORY
    04/17/98 - Modified entire project to use
               GadTools library for the GUI.
    02/08/95 - Added Editor, Translator, Macro, 
               Assembler & ConfigFile string variables.
    02/08/95 - Added ProcessToolTypes() for
               WorkBench support.
    03/03/94 - added assign_all() to main().
               12/25/90


NOTES
    Source machine generated by GadToolsBox V2.0b
    which is (c) Copyright 1991-1993 Jaba Development

    GUI Designed by : Jim Steichen


Z80SimGTGUI.c/main()

NAME
   main - the primary entry point of the program.


SYNOPSIS
   error = main( int argc, char **argv )


FUNCTION
   Setup the environment, then wait for user input via 
   HandleZ80SimIDCMP();


ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿ