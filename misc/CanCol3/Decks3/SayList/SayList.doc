SAYLIST 4.0 DOCUMENTATION

by Frank Keighley and Miles Goodhew, Desktop Utilities, December 1993
for AustBBS Desktop Utilities CanDo User Group Disk 4

SayList allows the user to create lists which can be loaded into the
program and read back at a speed selected by the user.

Requirement: AmigaDOS Say command from AmigaDOS 1.3.

Buttons are provided for the following functions:

Say List - say the list (invoking the Say command)

Choose List - choose a list from disk

Make List - clear the notepad ready for a new list

Save - save the current list to the current filename

Save As - save the list and request user for location/filename

The method used for invoking the AmigaDOS Say command is illustrated in the
Say List script, which is shown below. The speed option has been
incorporated as a variable, which happens to be set in the script at 80. By
setting the variable l to the value of LinesInDocument (a CanDo function),
a value is derived for exit from the loop where each successive line in the
document is read out.  The variable "Tempfile" is used as a holding file
for the current line to be stored in ram for reading out. The
PositionOnLine CanDo command is used to move the cursor to line "n" at each
iteration of the loop, and the variable "Tempfile" is set to the contents
of line "n" before invoking the AmigaDOS Say command each time.

==============================================================

Say List Routine
----------------

The release script for the Say List button is:

WorkWithDocument "List"
MoveCursorTo STARTOF DOCUMENT 
SaveDocument "List","RAM:List.txt"
Let speed = 80
Let WordFromList=TheLine
Let n = 1
Let l = LinesInDocument
Let cmd = "sys:utilities/Say"|||"-x"|||"-s"||speed|||"RAM:Currentword"
While n<=l
	Delay 0,dval,0
	PositionOnLine n
	OpenFile "RAM:CurrentWord","TempFile",WRITEONLY ,NEWFILE 
	FileWriteLine "TempFile",TheLine
	OpenFile "RAM:CurrentWord","TempFile",READONLY ,OLDFILE 
	Dos cmd
	Let n = n+1
	Close "TempFile"
EndLoop

=======================================================================

Choose List Routine
-------------------

The release script for the Choose List button is:

Let WordListFile = AskForFileName(TheCurrentDirectory,"Please choose a wordlist")
If FileOf(WordListFile)=""
	ExitScript
ElseIf FileType(WordListFile)<>"Unknown"
	ExitScript
Else
	LoadDocument WordListFile,"List"
	MoveCursorTo STARTOF DOCUMENT 
	SetObjectState "ListEditor",ON
EndIf
SetCurrentDirectory PathOf(WordListFile)

