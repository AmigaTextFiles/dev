@database "AppEvent.guide"
@$VER: "AppEvent"
@author "Thomas"
@copyright "08/27/99 04:32:09"
@annotation "created with CDK.t5.2 1.25 (13.05.99)  1992 - 1999 by Christian Effenberger"
 
@node MAIN "DECK  AppEvent"
 
    @{B}Deck@{UB} AppEvent
        @{B}Card@{UB} Card#1
            @{"  " link "2 AfterAttachment  "} @{FG HIGHLIGHT}AfterAttachment@{FG TEXT} 
            @{"  " link "3 Window  UserWindow"} @{FG HIGHLIGHT}Window@{FG TEXT} UserWindow
            @{"  " link "4 AreaButton  DrawingArea"} @{FG HIGHLIGHT}AreaButton@{FG TEXT} DrawingArea
 
@endnode
 
@node "2 AfterAttachment  " "AfterAttachment  "
 
@{pari -4}@{lindent 8}@{b}@{fg highlight}AfterAttachment@{fg text}@{ub} 
 
Nop ; we don't want any see thru parts
Transparent Off
Nop ; we want fast drag feedback
FastFeedBack On
Nop ; lets make it so we don't draw on the borders of the window
Let Left =WindowBorderLeft
Let Top  =WindowBorderTop
Let Width=WindowWidth-WindowBorderLeft-WindowBorderRight-1
Let Height=WindowHeight-WindowBorderTop-WindowBorderBottom-1
InstallClipRegion Left,Top,Width,Height,ONLY 
Nop ; lets get an initial brush incase someone draws before
Nop ; dropping an icon on us.  don't forget to fill in offsets
ClipBrush 25,25,1,1,"MyBrush"
Let WidthOffset=0
Let HeightOffset=0
@endnode
 
@node "3 Window  UserWindow" "Window  UserWindow"
 
@{pari -4}@{lindent 8}@{b}@{fg highlight}Window@{fg text}@{ub} UserWindow
 
@{b}Definition@{ub}
	@{fg highlight}Origin@{fg text} 25,25
	@{fg highlight}Size@{fg text} 320,100
	@{fg highlight}Title@{fg text} "Workbench 2.0 AppEvents..."
	@{fg highlight}NumberOfColors@{fg text} 2
	@{fg highlight}DefaultColors@{fg text} 0,1,0
	@{fg highlight}WindowObjects@{fg text} CLOSEBUTTON DEPTHBUTTONS DRAGBAR 
	@{fg highlight}WindowFlags@{fg text} ACTIVATE TOFRONT WORKBENCH 
	@{fg highlight}VisualEffects@{fg text} NONE ,WAIT 
@{b}EndScript@{ub}
@{b}OnCloseButton@{ub}
	Quit
@{b}EndScript@{ub}
@{b}OnAppEvent@{ub}
	Nop ; we get passed thru Arg1 the icons dropped on us
	Nop ; get a clean slate to draw on
	ClearWindow
	Nop ; we need a variable to work with
	Local IconName
	Nop ; parse off the iconname
	Let IconName=GetWord(Arg1,1,Char(10))
	Nop ; a directory maybe?
	If GetChars(IconName,NumberOfChars(IconName),1)="/" ; a directory?
		Nop ; if it is a directory then we need to trim
		Nop ; the '/' off the end of the name or the
		Nop ; icon system will get confused. :-(
		Let IconName=GetChars(IconName,1,NumberOfChars(IconName)-1)
	EndIf
	Nop ; changed the window title to show the iconname
	SetWindowTitle "Icon : "||IconName
	Nop ; load the icon
	LoadIcon IconName,"MyIcon"
	Nop ; clip out the image
	ClipIconImage "MyIcon","MyBrush"
	Nop ; get rid of the icon
	Flush "MyIcon"
	Nop ; figure out the size of the icon image
	GetBufferInfo "MyBrush",Width,Height
	Nop ; we really want to know the center offset of the image
	Let WidthOffset=Width%2
	Let HeightOffset=Height%2
	Nop ; show the icon image where it was dropped
	ShowBrush "MyBrush",MouseX-WidthOffset,MouseY-HeightOffset
@{b}EndScript@{ub}
@endnode
 
@node "4 AreaButton  DrawingArea" "AreaButton  DrawingArea"
 
@{pari -4}@{lindent 8}@{b}@{fg highlight}AreaButton@{fg text}@{ub} DrawingArea
 
@{b}Definition@{ub}
	@{fg highlight}Origin@{fg text} 0,0
	@{fg highlight}Size@{fg text} 320,100
	@{fg highlight}Border@{fg text} NONE ,2,1
	@{fg highlight}Highlight@{fg text} NONE 
	@{fg highlight}ButtonFlags@{fg text} NONE 
@{b}EndScript@{ub}
@{b}OnClick@{ub}
	Nop ; show the image right heerrreee....
	ShowBrush "MyBrush",MouseX-WidthOffset,MouseY-HeightOffset
@{b}EndScript@{ub}
@{b}OnDrag@{ub}
	Nop ; and then show it over here.
	ShowBrush "MyBrush",MouseX-WidthOffset,MouseY-HeightOffset
@{b}EndScript@{ub}
@endnode
 
