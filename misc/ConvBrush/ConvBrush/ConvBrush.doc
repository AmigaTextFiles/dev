
			       ConvBrush v1.1
			       --------------

			    ©1991-94 David Kinder
			    ---------------------

Files
-----
		 ConvBrush	- Program.
		 ConvBrush.info - It's icon.
		 ConvBrush.doc	- This document.

		 ConvBrush.p	- Pascal source code.
		 ConvBrush.i
		 Support.asm
		 Make

		 arp.library	- If present in LIBS: directory, ConvBrush
				  will use its file requester when running
				  under AmigaDOS 1.3.

Introduction
------------

When writing an assembler or C program that uses Intuition, designing all the
image stuctures for graphics can be very time consuming. Wouldn't it be
useful to have a program to convert IFF brushes straight to image structures?
Not the most original idea, I'll admit, but when I actually looked for such
a program in my disk collection the only one I could find was CLI only and
called the Guru whenever it felt like it. Hence I wrote ConvBrush.

ConvBrush converts an IFF brush (from DPaint or similar) into a source code
file which can be included into the source code. ConvBrush is written
in Pascal, and compiled with PCQ Pascal v1.2b, a public domain Pascal
compiler by Patrick Quaid. The source file output from ConvBrush can also be
used in PCQ Pascal code (but more on this later). I chose PCQ Pascal because

 a) I wanted a change from coding in assembler, and
 b) I wanted to see if a program could be written using just a PD compiler,
    instead of paying £100+ for a commercial offering.

If you want to look at PCQ Pascal (which I would recommend), it's on Fish
Disks #503 and #511.

Use
---

To use from the workbench, simply click on the icon, or type 'ConvBrush' at
the CLI. A window will appear containing several gadgets:

Source file	  A string gadget to enter the IFF brush you wish to
		  convert.
Destination	  A string gadget to enter the file you want ConvBrush
		  to send the image data to.
Image Label	  Another gadget containing the string you wish to use as
		  the label in the output defining the Image structure.
File Req	  If this gadget is selected, then when 'Convert IFF Brush'
		  is clicked (see below), then the program will prompt you
		  for the source and destination filenames using either the
		  ARP or ASL file requester (depending on which version of
		  AmigaDOS you are running). If you click 'Okay' in the
		  Requester then that name is used instead of that entered
		  in the string. If you select 'Cancel' then the name in the
		  string is used. If you are running AmigaDOS 1.3 and the
		  arp.library is not in your LIBS: directory then this gadget
		  is ghosted.
Assembler	  Selects Assembler as the output format.
C		  Selects C code as the output format. The output C code has
		  been successfully compiled without modification using the
		  NorthC compiler.
Convert IFF brush Converts the source IFF brush to the destination text file.
		  If an error occurs a requester will tell you the cause of
		  failure, else a message indicating success will appear in
		  in the WorkBench screen title bar.
About		  Credits...

Compilation
-----------

To recreate ConvBrush from its source, you can use the script 'Make'. This
assumes that the ConvBrush source files are in the current path, and that
Pascal, A68k, and Blink are in PCQ:. The source files are:

	ConvBrush.p	The main source code, written in Pascal.
	ConvBrush.i	Several record definitions I need.
	Support.asm	Short assembler code file. Contains image data
			for several gadgets, and several code stubs.

The supplied 'Make' uses T: to store temporary files, which is usually
assigned to ram:t/. However, on a 512K machine I suspect there will not be
enough memory for all the temporary files, so you might have to assign T:
to a floppy disk.

Images in Pascal
----------------

Unfortunately, PCQ Pascal has no mechanism for including Image data into
the pascal source code. My solution is used in ConvBrush, which is:

Use DPaint to design your graphic, then use ConvBrush to convert to an
assembler source file (here assumed to be called 'Support.asm'). Assuming you
wish to call the Image 'MyImage', give ConvBrush an Image Label of 'MyImage'.
Now edit the assembler file by adding the following lines at the start of the
file:
			DATA	AnyNameYouWant,CHIP

			XDEF	_MyImage
_MyImage		dc.l	MyImage

Assemble the file using A68k to 'Support.o'. In your pascal source file (as
an example I'll refer to Main.p) in your var section add

{$SX}
MyImage : address;
{$SN}

to compile, use the calls to Pascal and A68k as described in the PCQ Pascal
documentation, except that Blink should be called with

	Blink Main.o Support.o TO Main LIB PCQ.lib

You may have to change the paths to these files depending on where they are
in your setup.

Now you can use the variable MyImage as a pointer to your image stucture,
for example as in the Intuition call

	DrawImage(w^.RPort,MyImage,0,0);

See 'Pascal.Doc' and 'A68k.Doc', both of which come with PCQ, for more
information on what the above actually means. Take a look at the ConvBrush
source for a practical example of all this (The image structure for the main
gadget is called 'Logo').

David.

History
-------

v1.0	First release.

v1.1	Recompiled under PCQ v1.2b.
	Added support for C language output.
	Changed main gadget graphic.
	Improved appearance of program under AmigaDOS2.
	Now uses asl.library for file requester if available.
	Cleaner appearance for any system font size.
