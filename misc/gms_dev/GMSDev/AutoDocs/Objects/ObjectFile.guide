@DATABASE "ObjectFile"
@AUTHOR   "Paul Manias"
@NODE     "Main" "Object: ObjectFile"

@{b}@{u}OBJECT DOCUMENTATION@{uu}@{ub}
Name:      @{"OBJECTFILE" LINK "Description"}
Date:      October 1998
Author:    Paul Manias
Copyright: DreamWorld Productions, 1996-1998.  All rights reserved.

@{b}@{u}CHANGES VERSION 2@{uu}@{ub}
The Object file format has been redeveloped.

@EndNode
---------------------------------------------------------------------------
@NODE  "Description" "Object: ObjectFile"

@{b}@{u}OBJECT@{uu}@{ub}
Name:    ObjectFile
Version: 2
ID:      ID_OBJECTFILE
Module:  @{"Objects" LINK "GMSDev:AutoDocs/Objects.guide"}
Include: @{"files/objects.h" LINK "GMSDev:Includes/files/objects.h/Main"}
Type:    Complex

@{b}@{u}DESCRIPTION@{uu}@{ub}
The  ObjectFile  is  one  of  the  most powerful and useful objects in this
system,  allowing  your  program  to load object specifications from binary
files.   The  use  of  external  object  definitions allows one significant
advantage:  After your program is compiled you can still make major changes
and enhancements without needing any source code.

This  is  a  major  boon for both developers and users alike.  Lets look at
some  examples  of  what  can  be  acheived  when  your objects are defined
externally:

  * You could set new Screen parameters, such as width, height, colours
    and resolution.

  * External code segments can be written for easy "plug-in" and program
    extensions.

  * New sound effects could be added or old ones replaced.

  * Graphics can be enhanced by other artists to unforeseen levels.  For
    example typical resolutions today are 640x512, but in 3 years your
    game could easily run in 2560x2048 without any recompiling.  Bob sizes
    can also be increased and then redrawn to fit resolution differences.

You  can  probably  think of a lot more examples, depending on what sort of
programs you want to write.

@{b}@{u}How To Create ObjectFiles@{uu}@{ub}
Before you get to use the ObjectFile object in a program, you first need to
create  an object file that you can load.  These can be created in a simple
text editor and saved as a .obj file.

The format for an object file is as follows:

---START----------------------------------

[<ObjectName>]
ID = <NameOfClass>
<Field> = <Data>
<Field> = <Function>
<Field>.<Field> =  <Variable>

...More Objects...

---END------------------------------------

Before  we  move  onto an example lets examine the file format.  Firstly an
object needs a name which you must provide in square brackets [].  You will
need  to  remember  the name of each object when using the PullObject() and
similar  commands.   Following immediately after this is the ID field which
specifies  what type of object it is.  Valid examples include Bob, Picture,
Sound,  JoyData  and Bitmap.  You can get a full list of valid objects from
the Object Registry file (Registry.guide).

Once  the  header  is set up you can start specifying the data you want put
into  the  fields.   This  is  where  it  gets interesting, because you are
expected to supply data in a particular format according to the field type.
The  most  common  data  format is a number, but support exists for numeric
arrays,  flags, file names and even function calls.  The important thing is
to  get  the  format  correct - if you are not sure about this then you can
check the documentation for that object.

Here  follows  an  object  file  that uses all of the features we have just
described:

[Worm]
ID = Bob
GfxCoords = 0,0,32,0,64,0,96,0,128,0,160,0,192,0,224,0,256,0,288,0,-1,-1
Width  = 32
Height = 24
XCoord = 150
YCoord = 150
ClipLX = 32
ClipTY = 32
ClipRX = -32
ClipBY = -32
Attrib = GENMASKS|CLIP|RESTORE
Source = Get(Picture)
Source.Source = "GMS:demos/data/PIC.Rambo"
Source.Bitmap.MemType = BLIT

[SNDRambo]
ID = Sound
Octave = C2S
Volume = 100
Source = "GMS:demos/data/SND.Rambo"
Attrib = STOPLAST

Most  of  this  example  is  fairly explanatory but I will talk on the Worm
object  which  uses the Get() action.  The reason for the presence of Get()
is  because  the  Bob  object  does not provide any children for the Source
field.   This  allows  you to specify any source that you like, for example
you  could  create  a File object here instead of a Picture.  Once you have
specified  the use of Get(), you may step into the child object and set its
fields.   In the above example, Source.Source and Source.Bitmap.MemType are
shown to be using the stepping feature.

The  last  feature  that  has  not  been mentioned is that of arrays.  Some
fields such as GfxCoords (above) are set up for this automatically, but the
object  file format allows you to create arrays for any field that can hold
a  pointer.   If  you  want  to create an explicit array, you can specify a
[BYTE], [WORD] or [LONG] definition before the array itself.  For example:

GfxCoords = [WORD] 0,0,32,0,64,0,96,0,128,0,-1,-1

This  should  cover  most  aspects of object file development.  For further
examples, check out the "GMS:Demos/Data/" directory.

@{b}@{u}FUNCTIONS@{uu}@{ub}
Functions supporting the ObjectFile are:

     @{"PullObject()"     LINK "GMSDev:AutoDocs/Objects.guide/PullObject()"}
     @{"PullObjectList()" LINK "GMSDev:AutoDocs/Objects.guide/PullObjectList()"}

@{b}@{u}ACTIONS@{uu}@{ub}
The ObjectFile object supports the following actions:

     @{"Free()" LINK "GMSDev:AutoDocs/Kernel.guide/Free()"} - Free an ObjectFile.
     @{"Get()" LINK "GMSDev:AutoDocs/Kernel.guide/Get()" }  - Get a new ObjectFile.
     @{"Init()" LINK "GMSDev:AutoDocs/Kernel.guide/Init()"} - Initialise/Load an ObjectFile.
   * @{"Load()" LINK "ObjectFile_Load()"} - Easy loading for ObjectFiles.

@{b}@{u}STRUCTURE@{uu}@{ub}
The ObjectFile structure consists of one public field:

     @{"Source" LINK "OBJ_Source"} Pointer to a file source.

@EndNode
---------------------------------------------------------------------------
@NODE "OBJ_Source" "Object: ObjectFile"

@{b}@{u}FIELD@{uu}@{ub}
Name:        Source
Type:        struct Source *
Inheritance: Must be specified by programmer.
On Change:   Cannot change after initialisation.
Status:      Read/Init

@{b}@{u}DESCRIPTION@{uu}@{ub}
Before  you initialise your ObjectFile you need to have specified a source.
This field accepts pointers to FileNames, MemPtrs, and standard Files.  All
you need to do is make sure that the file is in the correct format.

@EndNode
-----------------------------------------------------------------------------
@NODE "ObjectFile_Load()" "ObjectFile: Load()"

@{b}@{u}ACTION@{uu}@{ub}
Name:   Load(*File, ID_OBJECTFILE)
Object: ObjectFile
Short:  Load an external object file.

@{b}@{u}DESCRIPTION@{uu}@{ub}
Loads  in  a  standard  object file, checks it for validity and returns the
resulting ObjectFile structure back to you.

Once  you  have  called  this  action  you  can  use  the object processing
functions such as PullObject() to obtain your data.  See the information on
Objects for further understanding of these files.

You will need to Free() the ObjectFile ater you have finished using it.

@{b}@{u}SEE ALSO@{uu}@{ub}
Kernel: @{"Load()" LINK "GMSDev:AutoDocs/Kernel.guide/Load()"}

@EndNode
---------------------------------------------------------------------------
