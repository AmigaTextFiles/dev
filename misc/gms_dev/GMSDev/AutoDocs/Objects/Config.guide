@DATABASE "Config"
@AUTHOR   "Paul Manias"
@NODE     "Main" "Config Object Documenation"

@{b}@{u}OBJECT DOCUMENTATION@{uu}@{ub}
Name:      @{"CONFIG" LINK "Description"}
Date:      August 1998
Author:    Paul Manias
Copyright: DreamWorld Productions, 1998.  All rights reserved.

@EndNode
---------------------------------------------------------------------------
@NODE "Description" "Object: Config"

@{b}@{u}OBJECT@{uu}@{ub}
Name:    Config
Version: 1
ID:      ID_CONFIG
Module:  Config
Include: @{"misc/config.h" LINK "GMSDev:Includes/misc/config.h/Main"}
Type:    Simple

@{b}@{u}DESCRIPTION@{uu}@{ub}
The  Config object was created for programs that need to read text editable
data.  The advantage of text based data files is that you can edit the data
in  a  standard  text  editor, then easily read the information back in for
processing.

Config  files  are  very  useful for setting up preference systems for your
programs, reading startup details, or for loading user data.  The following
config file demonstrates how you might set up a file which outlines a tiled
map:

  [Map]
  Terrain=JUNGLE
  X=16
  Y=16
  Width=96
  Height=96

  [MapPack]
  =CQAAIIH//v4f/4H/gAkAACCB//7+H/+f/4H/gA
  =kAACCBAP7+HwCBAIAJAAAggQD+/h8AgQCAf.3F
  ...cut...

Notice  the  text  enclosed  in  square brackets, such as [Map].  These are
referred  to as "Sections" which are responsible for holding Items or Array
data.   An "Item" is defined as a variable which contains string or integer
information.  In the above example, items are defined by the Terrain, X, Y,
Height  and  Width  identifers.  You can also define arrays, as seen in the
[MapPack] section.  When defining arrays, you are allowed to create as much
data as you like which belongs to the Section, but no Item data is allowed.
Notice  how each line begins with an '=' sign when defining array sections,
and  there are no preceeding identifiers.  The array is terminated when the
file ends, or a new Section is encountered.

@{b}@{u}CONFIG I/O@{uu}@{ub}
So  how  do  you read a Config file?  The following source code illustrates
how to load and read the Terrain item from the above file.

  void main()
  {
     BYTE *buffer;
     struct Config *Config;

     if (ConfigMod = OpenModule(MOD_CONFIG,"config.mod")) {
        CNFBase = ConfigMod->ModBase;

        if (Config = InitTags(NULL,
           TAGS_CONFIG, NULL,
           CFA_Source, &FName,
           TAGEND)) {

           if (buffer = ReadConfig(Config,"Map","Terrain")) {
              DPrintF("!MAP:Terrain:","%s",buffer);
           }
        Free(Config);
        }
     Free(ConfigMod);
     }
  }

Searching a Config file is very easy when done through the ReadConfig() and
ReadConfigInt()  functions in the Config module.  However, you may traverse
the Config data yourself, as this loop shows:

  for (i = NULL; i < Config->AmtEntries; i++) {
     if (Config->Entries[i].Item) {
        DPrintF("!Demo:","Section: %s, Item: %s, Data: \"%s\"",Config->Entries[i].Section,Config->Entries[i].Item,Config->Entries[i].Data);
     }
     else {
        DPrintF("!Demo:","Array: %s",Config->Entries[i].Section);
     }
  }

If  you  want  to  save  a  Config  file  you  will need to make use of the
SaveToFile()  action.  Although this feature is not available yet, look out
for it soon.

@{b}@{u}ACTIONS@{uu}@{ub}
The Config object supports the following actions:

     @{"Free()" LINK "GMSDev:AutoDocs/Kernel.guide/Free()"} - Free a Config object.
     @{"Get()" LINK "GMSDev:AutoDocs/Kernel.guide/Get()"}  - Get a new Config object.
     @{"Init()" LINK "GMSDev:AutoDocs/Kernel.guide/Init()"} - Initialises the object.
     @{"Load()" LINK "GMSDev:AutoDocs/Kernel.guide/Load()"} - Load a Config file.

@{b}@{u}FUNCTIONS@{uu}@{ub}
These functions are available for searching Config data:

     @{"ReadConfig()" LINK "GMSDev:AutoDocs/Config.guide/ReadConfig()"}
     @{"ReadConfigInt()" LINK "GMSDev:AutoDocs/Config.guide/ReadConfigInt()"}

@{b}@{u}STRUCTURE@{uu}@{ub}
The Config object consists of the following public fields:

     @{"AmtEntries" LINK "CNF_AmtEntries"} - Amount of available entries.
     @{"Entries" LINK "CNF_Entries"}    - Pointer to Entries array.
     @{"Source" LINK "CNF_Source"}     - The source of the config file.

@EndNode
---------------------------------------------------------------------------
@NODE "CNF_AmtEntries" "Object: Config"

@{b}@{u}FIELD@{uu}@{ub}
Name:        AmtEntries
Type:        LONG
Inheritance: Init()
Status:      Read/*Write

@{b}@{u}DESCRIPTION@{uu}@{ub}
This field defines how many entries are in the Config->Entries array.

@{b}@{u}NOTE@{uu}@{ub}
This  field  is only writable if you Init()ialised the Config object with a
Source  of  NULL.   This  causes the object to go into Write mode, which is
suitable for saving Config files.

@{b}@{u}SEE ALSO@{uu}@{ub}
Field: @{"Entries" LINK "CNF_Entries"}

@EndNode
---------------------------------------------------------------------------
@NODE "CNF_Entries" "Object: Config"

@{b}@{u}FIELD@{uu}@{ub}
Name:        Entries
Type:        struct ConEntry *
Inheritance: Init()
Status:      Read/*Write

@{b}@{u}DESCRIPTION@{uu}@{ub}
This field points to an array of Configuration entries.  Each entry holds a
string  of  data  for every item and array that is found in the file during
the initialisation process.  The ConEntry structure looks like this:

  struct ConEntry {
    BYTE *Section;
    BYTE *Item;
    BYTE *Data;
  };

For  the  example  given  in the introduction, our Map data would look like
this:

  struct ConEntry Entries = {
    "Map","Terrain","JUNGLE",
    "Map","X","16",
    "Map","Y","16",
    "Map","Width","96",
    "Map","Height","96"
  };

@{b}@{u}NOTE@{uu}@{ub}
This  field  is only writable if you Init()ialised the Config object with a
Source  of  NULL.   This  causes the object to go into Write mode, which is
suitable for saving Config files.

@{b}@{u}SEE ALSO@{uu}@{ub}
Field: @{"AmtEntries" LINK "CNF_AmtEntries"}

@EndNode
---------------------------------------------------------------------------
@NODE "CNF_Source" "Object: Config"

@{b}@{u}FIELD@{uu}@{ub}
Name:   Source
Type:   APTR
Status: Read/Init

@{b}@{u}DESCRIPTION@{uu}@{ub}
You will need to supply a FileName or MemPtr source in order to load Config
files.

If  you  wish to create a new Config file which can be saved to disk, leave
this field at NULL to enable the Write/SaveToFile() mode.

@EndNode
