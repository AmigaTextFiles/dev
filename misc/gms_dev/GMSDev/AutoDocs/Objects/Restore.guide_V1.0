@DATABASE "Restore"
@AUTHOR   "Paul Manias"
@NODE     "Main" "Object: Restore"

@{b}@{u}OBJECT DOCUMENTATION@{uu}@{ub}
Name:      @{"RESTORE" LINK "Description"}
Version:   1.0
Date:      March 1998
Author:    Paul Manias
Copyright: DreamWorld Productions, 1996-1998.  All rights reserved.

@EndNode
---------------------------------------------------------------------------
@NODE "Description" "Object: Restore"

@{b}@{u}OBJECT@{uu}@{ub}
Name:    Restore
Version: 1
ID:      ID_RESTORE
Module:  @{"Blitter" LINK "GMSDev:AutoDocs/Blitter.guide/Functions"}
Include: @{"graphics/blitter.h" LINK "GMSDev:Includes/graphics/blitter.h/Main"}
Type:    Complex

@{b}@{u}DESCRIPTION@{uu}@{ub}
A  Restore  object  is  required  whenever you specify the CLEAR or RESTORE
flags in one or more Bob/MBob objects.

Restore  objects are vital in double or triple buffered environments, as it
can be very difficult to keep track of the background areas that need to be
replaced.   By  using  a  Restore  object,  you will eliminate this problem
completely.   A  Restore  object  is list-based, so you can use one Restore
object for as many Bobs as you like.

The  Restore  object is made up of a number of entries, 1 for each Bob that
has  been  blitted to screen.  Each entry currently takes up about 28 bytes
of memory, multiplied by how many buffers there are (eg 56 bytes for double
buffering).   How many entries you require is dependent on the type of game
you  are  writing, but 50 entries will be plenty in most cases.  If you run
out  of entries, the Draw() functions will allocate extra space on the fly.
If  you  find  that this is occuring (your game may slow down when too many
objects  appear  on  screen),  we  recommend that you bump up the number of
entries you are allocating on initialisation.

There  is  a  significant  speed  difference between restoring and clearing
which  you  should  be  aware  of.  CLEARing is fast because the blitter is
using  fewer channels and the CPU can be used more effectively.  RESTOREing
is slower as the blitter has to move data between two different areas, plus
it  has to perform this action twice (once to save the background, and once
to  return  the  background).   Use  the CLEAR option whenever possible (if
background is blank) otherwise you will probably have to use RESTORE.

@{b}@{u}ACTIONS@{ub}@{uu}
The Restore object supports the following actions:

   * @{"Activate()" LINK "Restore_Activate()"} - Restores Bob backgrounds.
     @{"Free()" LINK "GMSDev:AutoDocs/Kernel.guide/Free()"}     - Free a Restore object from the system.
     @{"Get()" LINK "GMSDev:AutoDocs/Kernel.guide/Get()" }      - Get a new Restore object.
     @{"Init()" LINK "GMSDev:AutoDocs/Kernel.guide/Init()"}     - Initialises a Restore object to a Bitmap.
   * @{"Reset()" LINK "Restore_Reset()"}    - Reset a Restore object.

@{b}@{u}STRUCTURE@{uu}@{ub}
The Restore structure consists of the following public fields:

     @{"Buffers" LINK "RST_Buffers"} - Amount of screen buffers.
     @{"Entries" LINK "RST_Entries"} - Amount of entries.
     @{"Owner" LINK "RST_Owner"}   - Owner of the Restore object (must be a bitmap).

@EndNode
---------------------------------------------------------------------------
@NODE "RST_Buffers" "Object: Restore"

@{b}@{u}FIELD@{uu}@{ub}
Name:        Buffers
Type:        WORD
Inheritance: Init() [Container: Screen]
Default:     1
Status:      Read/Init

@{b}@{u}DESCRIPTION@{uu}@{ub}
This  field  specifies the amount of Bitmap buffers that the Restore object
is based around.  It is vital that this value matches the amount of buffers
in  the  given Screen or Bitmap environment.  For example, if the Screen is
double  buffered  then this value will be 2.  If triple buffered the value,
will be 3.

If the value does not match you will get unpredictable results.

@EndNode
---------------------------------------------------------------------------
@NODE "RST_Entries" "Object: Restore"

@{b}@{u}FIELD@{uu}@{ub}
Name:    Entries
Type:    WORD
Default: 1
Status:  Read/Init

@{b}@{u}DESCRIPTION@{uu}@{ub}
This  field specifes the amount of entries that are in the Restore object's
list of Bob buffers.

When  you  first  initialise  your  Restore  object,  you need to specify a
generous  amount  of  entries  here -- 1 entry for every Bob that may be on
screen  at any time.  If you under-estimate this value then everything will
still  work,  but  memory  will  need  to be allocated on the fly to create
enough space for all of your Bobs.

@EndNode
---------------------------------------------------------------------------
@NODE "RST_Owner" "Object: Restore"

@{b}@{u}FIELD@{uu}@{ub}
Name:        Owner
Type:        struct Bitmap *
Inheritance: Init()
Status:      Read Only.

@{b}@{u}DESCRIPTION@{uu}@{ub}
This field references the Bitmap that your Restore object is linked to.  It
is  initially  inherited from the container object that you gave to Init().
If  you  provided  a Screen as the container, a Bitmap will be derived from
that.

@EndNode
---------------------------------------------------------------------------
@NODE "Restore_Activate()" "Restore: Activate()"

@{b}@{u}ACTION@{uu}@{ub}
Name:   @{"Activate()" LINK "GMSDev:AutoDocs/Kernel.guide/Activate()"}
Object: Restore
Short:  Restores all buffered images by clearing or replacing backgrounds.

@{b}@{u}DESCRIPTION@{uu}@{ub}
This  action  will  restore all the backgrounds that have been destroyed by
Bobs that are using the RESTORE and CLEAR flags.

The  positioning  of this function is quite important - it should go BEFORE
any  Draw*()  functions  to  be  effective, otherwise you may get graphical
glitches or even a system crash.

@EndNode
-----------------------------------------------------------------------------
@NODE "Restore_Reset()" "Restore: Reset()"

@{b}@{u}ACTION@{uu}@{ub}
Name:   @{"Reset()" LINK "GMSDev:AutoDocs/Kernel.guide/Reset()"}
Object: Restore
Short:  Resets a Restore object by clearing old image history.

@{b}@{u}DESCRIPTION@{uu}@{ub}
This  action  resets a Restore object's image history so that any currently
buffered  images  are  no longer waiting to be restored.  This is useful in
circumstances  such  as  completely  changing the background imagery and no
longer blitting the previous set of images.

@{b}@{u}SEE ALSO@{uu}@{ub}
Restore: @{"Flush()" LINK "Restore_Flush()"}

@EndNode
-----------------------------------------------------------------------------
