@database "Default"
@author "Paul Manias"
@(c) "Copyright 1997-1998 DreamWorld Productions."
@$VER: 3.0 (August 1998)
@NODE "MAIN" "IceBreaker V3.0"
@{b}
                           I C E   B R E A K E R

                                VERSION 3.0

                              By Paul Manias
@{ub}

                              1. @{"Introduction" LINK "Introduction"}
                              2. @{"Requirements" LINK "Requirements"}
                              3. @{"Usage" LINK "Usage"}
                              4. @{"Example Output" LINK "Example"}
                              5. @{"Programming" LINK "Programming"}
                              6. @{"Copyright" LINK "Copyright"}

@EndNode
***************************************************************************
@Node "Introduction" "Introduction to IceBreaker."
@{b}
                               INTRODUCTION
@{ub}

IceBreaker is the official debugger for GMS programs.  Although very
simple, it is one of the smallest and most powerful run-time debuggers that
you can use on the Amiga.  The power behind IceBreaker is that it does not
have to patch any functions to tell you what your program is doing, instead
the GMS functions are already written to support debug output!  This
removes the unfortunate kludginess of system debuggers like SnoopDOS.
IceBreaker supports all functions except for those used in constant loops
(eg Draw()) and those that are called so often it would become annoying (eg
FindDPKTask()).

IceBreaker also supports detection of errorcodes which are shown in bold if
they occur.  If you run a program that doesn't work and you want to know
why, try running IceBreaker to find out what is wrong.  Often this will be
enough for you to fix the problem.

If you've ever had problems attempting to debug hardware hacking games in
the past, IceBreaker will be a great help to you.  I hope you get a lot out
of its functionality.

@{b}@{u}Registration@{uu}@{ub}
This version of IceBreaker is slightly crippled and requires a keyfile.
When you buy your first GMS developers license you will get the keyfile
that unlocks all of IceBreaker's functionality.

@EndNode
***************************************************************************
@Node "Requirements" "IceBreaker requires..."
@{b}
                               REQUIREMENTS
@{ub}

IceBreaker requires the Games Master System, that's all.  There's no
special installation procedure, just run it from CLI (See Usage section).

@EndNode
***************************************************************************
@Node "Usage" "How to use IceBreaker."
@{b}
                                   USAGE
@{ub}

There are two ways that you can run IceBreaker.  The first is from a shell,
simply by typing "GMSDev:Utils/IceBreaker/IceBreaker".  The other way is to
redirect the debug information to somewhere else.  Here are some examples.

   1.> IceBreaker >HD1:Game.dbg    <Output to a file on hard drive>

   2.> IceBreaker >KCON:           <Output to a scrolling KCON: window>

   3.> IceBreaker >SER:            <Output to a null-modem>

Be aware that if your program crashes while IceBreaker is writing to a file
on disk, it could invalidate the drive if the GMS program crashes.  For
this reason it might be better to write the output to RAM:  or DF0:.

You can also redirect the output out to another machine that is networked
to your computer, either on the parallel or serial ports.  A printer is
also another possibility if you think it will be useful!  The advantage of
remote output is that you can view what is happening as it occurs, even
when the screen is taken over.  Since most GMS programs are screen-based,
it can be a great help.

If you have KingCON then it is highly recommended that you use it for CLI
output, as you will have a scroll bar to view debug history.

As all GMS programs are screen-based, you will have to use LEFT AMIGA+M to
go back to Workbench if you want to view debug output.

@{b}
                                 ARGUMENTS
@{ub}

There are two special arguments that you can use to define how IceBreaker
outputs its data.  Here they are:


  @{b}MAXSTEP <Value>@{ub}

  This argument tells IceBreaker how 'deep' you want to go into the
  functions when debugging.  If you set the value really high, you will see
  just about everything that goes on behind the scenes.  Setting it quite
  low restricts the output, which is useful when you just want a debugging
  overview.


  @{b}SHOWIO@{ub}
  Set this argument to see messages from Read() and Write().


  @{b}SHOWMEM@{ub}

  This argument allows memory functions (AllocMemBlock() and
  FreeMemBlock()) to be printed to the console.


  @{b}SYSTEM@{ub}

  If you specify this argument then all system activity will be printed
  to the debug window.  This includes the opening and expunging of the
  dpkernel.library (which is normally hidden).


  @{b}LOW, MEDIUM, HIGH, EXTREME@{ub}
  These arguments determine the detail factor of your debugging.  If you
  set the detail to low then you will only see important messages, whereas
  a detail of high gives you many messages that you normally don't need to
  see.  The default setting is medium.

@EndNode
***************************************************************************
@Node "Example" "Example Output"
@{b}
                              EXAMPLE OUTPUT
@{ub}

The following example comes from the RamboWorm demo, running with a maximum
debug output of 100 (this output is only possible with the registered
version).

The command line format for this is:

  1> IceBreaker MAXSTEP 100 SHOWMEM SHOWIO HIGH

Type                 | Data
---------------------+---------------------------------------------
PROGRAM OPENED.
CallEventList()       ID: 1, Arg1: $3f9458, Arg2: 0
AllocMemBlock()       $409f80, Size: 52 (Data)
Load()                "GMS:Prefs/Default/general.prefs" as MemBlock
 OpenFile()           Source: $479842, Flags: Read
  Get()               File
   AllocMemBlock()    $3f94c8, Size: 44 (Data|Untracked)
   AllocMemBlock()    $40c640, Size: 82 (Data|Untracked)
  Init()              File: $40c640
  AllocMemBlock()     $40c7e8, Size: 276 (Data)
  Seek()              File: $40c640, Offset: 0, Position: 0
  Read()              File: $40c640, Buffer: $40c7e8, Length: 256
  Read:               94 bytes were read from the file.
  FreeMemBlock()      $40c7e8 Size: 256 (Data)
  Seek()              File: $40c640, Offset: 0, Position: 0
 GetFSize()           File: $40c640, Size: 94
 AllocMemBlock()      $40c888, Size: 114 (Data)
 Seek()               File: $40c640, Offset: 0, Position: 0
 Read()               File: $40c640, Buffer: $40c888, Length: 94
 Read:                94 bytes were read from the file.
 Free()               File: $40c640
  Free:               Freeing file "GMS:Prefs/Default/general.prefs"
  FreeMemBlock()      $40c640 Size: 62 (Data|Untracked)
  FreeMemBlock()      $3f94c8 Size: 24 (Data|Untracked)
FreeMemBlock()        $409f80 Size: 32 (Data)
Init()                Module-Tags: $479868
 Get()                Module
  AllocMemBlock()     $3f94c8, Size: 44 (Data|Untracked)
  AllocMemBlock()     $4130b8, Size: 66 (Data|Untracked)
 Init()               Module: $4130b8
  Init:               Opening the module.
  Screens:            Setting screen preferences.
  AllocMemBlock()     $40c948, Size: 52 (Data)
  Load()              "GMS:Prefs/Default/screens.prefs" as MemBlock
   OpenFile()         Source: $4797da, Flags: Read
    Get()             File
     AllocMemBlock()  $4111b0, Size: 44 (Data|Untracked)
     AllocMemBlock()  $4133a8, Size: 82 (Data|Untracked)
    Init()            File: $4133a8
    AllocMemBlock()   $413508, Size: 276 (Data)
    Seek()            File: $4133a8, Offset: 0, Position: 0
    Read()            File: $4133a8, Buffer: $413508, Length: 256
    Read:             256 bytes were read from the file.
    FreeMemBlock()    $413508 Size: 256 (Data)
    Seek()            File: $4133a8, Offset: 0, Position: 0
   GetFSize()         File: $4133a8, Size: 1100
   AllocMemBlock()    $4798e8, Size: 1120 (Data)
   Seek()             File: $4133a8, Offset: 0, Position: 0
   Read()             File: $4133a8, Buffer: $4798e8, Length: 1100
   Read:              1100 bytes were read from the file.
   Free()             File: $4133a8
    Free:             Freeing file "GMS:Prefs/Default/screens.prefs"
    FreeMemBlock()    $4133a8 Size: 62 (Data|Untracked)
    FreeMemBlock()    $4111b0 Size: 24 (Data|Untracked)
  FreeMemBlock()      $40c948 Size: 32 (Data)
  Init:               27 functions have been detected in the module.
  AllocMemBlock()     $425420, Size: 186 (Code|Untracked)
  Message:            Flushing CPU cache.
Init()                Module-Tags: $479868
 Get()                Module
  AllocMemBlock()     $40c948, Size: 44 (Data|Untracked)
  AllocMemBlock()     $425618, Size: 66 (Data|Untracked)
 Init()               Module: $425618
  Init:               Opening the module.
  Init:               28 functions have been detected in the module.
  AllocMemBlock()     $479e80, Size: 192 (Code|Untracked)
  Message:            Flushing CPU cache.
Init()                Module-Tags: $479868
 Get()                Module
  AllocMemBlock()     $3790d8, Size: 44 (Data|Untracked)
  AllocMemBlock()     $47a158, Size: 66 (Data|Untracked)
 Init()               Module: $47a158
  Init:               Opening the module.
  Init:               5 functions have been detected in the module.
  AllocMemBlock()     $47a2d8, Size: 54 (Code|Untracked)
  Message:            Flushing CPU cache.
Load()                "GMS:demos/data/PIC.Green" as Picture
 OpenFile()           Source: $47875c, Flags: Read
  Get()               File
   AllocMemBlock()    $47a488, Size: 44 (Data|Untracked)
   AllocMemBlock()    $47a508, Size: 82 (Data|Untracked)
  Init()              File: $47a508
  AllocMemBlock()     $47a668, Size: 276 (Data)
  Seek()              File: $47a508, Offset: 0, Position: 0
  Read()              File: $47a508, Buffer: $47a668, Length: 256
  Read:               256 bytes were read from the file.
  FreeMemBlock()      $47a668 Size: 256 (Data)
  Seek()              File: $47a508, Offset: 0, Position: 0
 AllocMemBlock()      $47a918, Size: 276 (Data)
 Seek()               File: $47a508, Offset: 0, Position: 0
 Read()               File: $47a508, Buffer: $47a918, Length: 256
 Read:                256 bytes were read from the file.
 Message:             File identified as Picture
 Init()               Picture-Tags: $479800
  Get()               Picture
   AllocMemBlock()    $47aba8, Size: 44 (Data|Untracked)
   AllocMemBlock()    $47ac28, Size: 62 (Data|Untracked)
   Get()              Bitmap
    AllocMemBlock()   $47acf0, Size: 44 (Data|Untracked)
    AllocMemBlock()   $47ad70, Size: 94 (Data)
  Init()              Picture: $47ac28
   Load()             File: $f0002 as MemBlock
    GetFSize()        File: $47a508, Size: 29874
    AllocMemBlock()   $47aee8, Size: 29894 (Data)
    Seek()            File: $47a508, Offset: 0, Position: 0
    Read()            File: $47a508, Buffer: $47aee8, Length: 29874
    Read:             29874 bytes were read from the file.
   AllocMemBlock()    $482510, Size: 156 (Data)
   Init()             Bitmap: $47ad70
   AllocMemBlock()    $5f37f8, Size: 51220 (Data)
   AllocMemBlock()    $482688, Size: 220 (Data)
   FreeMemBlock()     $482688 Size: 200 (Data)
   FreeMemBlock()     $47aee8 Size: 29874 (Data)
 Free()               File: $47a508
  Free:               Freeing file "GMS:demos/data/PIC.Green"
  FreeMemBlock()      $47a508 Size: 62 (Data|Untracked)
  FreeMemBlock()      $47a488 Size: 24 (Data|Untracked)
 FreeMemBlock()       $47a918 Size: 256 (Data)
Get()                 Screen
 AllocMemBlock()      $47a488, Size: 44 (Data|Untracked)
 AllocMemBlock()      $47afc8, Size: 250 (Data|Untracked)
 Get()                Bitmap
  AllocMemBlock()     $47b0c8, Size: 44 (Data|Untracked)
  AllocMemBlock()     $47b148, Size: 94 (Data)
CopyStructure()       Picture: $47ac28 To Screen: $47afc8
 Get()                Universe
  AllocMemBlock()     $47b280, Size: 44 (Data|Untracked)
  AllocMemBlock()     $47b300, Size: 96 (Data|Untracked)
 CopyStructure()      Bitmap: $47ad70 To Universe: $47b300
 CopyStructure()      Universe: $47b300 To Bitmap: $47b148
 Free()               Universe: $47b300
  FreeMemBlock()      $47b300 Size: 76 (Data|Untracked)
  FreeMemBlock()      $47b280 Size: 24 (Data|Untracked)
Init()                Screen: $47afc8
 Init()               Bitmap: $47b148
 Message:             Allocating the screen bitplanes.
 AllocVideoMem()      $1f37f8, Size: 51220 (Data)
 AllocVideoMem()      $1e6fe0, Size: 51220 (Data)
 AllocVideoMem()      $84560, Size: 632 (Data)
 Message:             Calculating bitplane pointers for copper list.
 Message:             Calculating bitplane pointers for copper list.
Init()                Restore-Tags: $47877c, Screen: $47afc8
 Get()                Restore
  AllocMemBlock()     $47b280, Size: 44 (Data|Untracked)
  AllocMemBlock()     $47b848, Size: 64 (Data)
 Init()               Restore: $47b848, Screen: $47afc8
  AllocMemBlock()     $47b920, Size: 58 (Data|Untracked)
  AllocMemBlock()     $47b9b0, Size: 58 (Data|Untracked)
Init()                Bob-Tags: $478790, Screen: $47afc8
 Get()                Bob
  AllocMemBlock()     $47bac8, Size: 44 (Data|Untracked)
  AllocMemBlock()     $47bb48, Size: 222 (Data|Untracked)
 Message:             Bob trigger received.
 Get()                Picture
  AllocMemBlock()     $47bd00, Size: 44 (Data|Untracked)
  AllocMemBlock()     $47bd80, Size: 62 (Data|Untracked)
  Get()               Bitmap
   AllocMemBlock()    $47be48, Size: 44 (Data|Untracked)
   AllocMemBlock()    $47bec8, Size: 94 (Data)
 Init()               Bob: $47bb48, Screen: $47afc8
  Init:               Initialising Bob from a Picture source.
  CheckInit()         Object: $47bd80
  Init()              Picture: $47bd80
   Load()             "GMS:demos/data/PIC.Rambo" as MemBlock
    OpenFile()        Source: $478854, Flags: Read
     Get()            File
      AllocMemBlock() $47c178, Size: 44 (Data|Untracked)
      AllocMemBlock() $47c1f8, Size: 82 (Data|Untracked)
     Init()           File: $47c1f8
     AllocMemBlock()  $47c398, Size: 276 (Data)
     Seek()           File: $47c1f8, Offset: 0, Position: 0
     Read()           File: $47c1f8, Buffer: $47c398, Length: 256
     Read:            256 bytes were read from the file.
     FreeMemBlock()   $47c398 Size: 256 (Data)
     Seek()           File: $47c1f8, Offset: 0, Position: 0
    GetFSize()        File: $47c1f8, Size: 11772
    AllocMemBlock()   $47c648, Size: 11792 (Data)
    Seek()            File: $47c1f8, Offset: 0, Position: 0
    Read()            File: $47c1f8, Buffer: $47c648, Length: 11772
    Read:             11772 bytes were read from the file.
    Free()            File: $47c1f8
     Free:            Freeing file "GMS:demos/data/PIC.Rambo"
     FreeMemBlock()   $47c1f8 Size: 62 (Data|Untracked)
     FreeMemBlock()   $47c178 Size: 24 (Data|Untracked)
   AllocMemBlock()    $47f600, Size: 156 (Data)
   Init()             Bitmap: $47bec8
   AllocBlitMem()     $84978, Size: 14420 (Blit)
   AllocMemBlock()    $47f728, Size: 220 (Data)
   FreeMemBlock()     $47f728 Size: 200 (Data)
   FreeMemBlock()     $47c648 Size: 11772 (Data)
  Init:               Calling initialisation sub-routines.
  Message:            Setting restore parameters for Bob.
  AllocBlitMem()      $881d0, Size: 1460 (Blit)
  SetBobFrames()      Bob: $47bb48
   Message:           Setting Bob->DirectGfx.
   AllocMemBlock()    $47c7c8, Size: 76 (Data)
   Message:           Setting Bob->DirectMasks.
   AllocMemBlock()    $47c8a8, Size: 76 (Data)
   Message:           Creating Bob->DirectGfx array.
  CreateMasks()       Bob: $47bb48
   AllocBlitMem()     $88788, Size: 6260 (Blit)
Init()                Sound-Tags: $478874
 Get()                Sound
  AllocMemBlock()     $47ca98, Size: 44 (Data|Untracked)
  AllocMemBlock()     $47cb18, Size: 72 (Data|Untracked)
 Init()               Sound: $47cb18
  Message:            Audio channels allocated.
  Init()              File-Tags: $4797d8
   Get()              File
    AllocMemBlock()   $47ccc8, Size: 44 (Data|Untracked)
    AllocMemBlock()   $47cd48, Size: 82 (Data|Untracked)
   Init()             File: $47cd48
    Init:             Read/Write mode detected, automatically calling OpenFile().
    OpenFile()        Source: $47cd48, Flags: Read
     AllocMemBlock()  $47cff8, Size: 276 (Data)
     Seek()           File: $47cd48, Offset: 0, Position: 0
     Read()           File: $47cd48, Buffer: $47cff8, Length: 256
     Read:            256 bytes were read from the file.
     FreeMemBlock()   $47cff8 Size: 256 (Data)
     Seek()           File: $47cd48, Offset: 0, Position: 0
  GetFSize()          File: $47cd48, Size: 4074
  AllocSoundMem()     $8a000, Size: 4094 (Sound)
  Read()              File: $47cd48, Buffer: $8a000, Length: 4074
  Read:               4074 bytes were read from the file.
  Free()              File: $47cd48
   Free:              Freeing file "GMS:demos/data/SND.Rambo"
   FreeMemBlock()     $47cd48 Size: 62 (Data|Untracked)
   FreeMemBlock()     $47ccc8 Size: 24 (Data|Untracked)
  Message:            Processing IFF Sound file.
Get()                 JoyData
 AllocMemBlock()      $47ccc8, Size: 44 (Data|Untracked)
 AllocMemBlock()      $47d448, Size: 74 (Data|Untracked)
Init()                JoyData: $47d448
 JoyPorts:            Initialised to Port 1.
Show()                Screen: $47afc8
 Message:             Entering screen at the beginning of the display list.
 AllocMemBlock()      $47d0e0, Size: 28 (Data)
Free()                JoyData: $47d448
 FreeMemBlock()       $47d448 Size: 54 (Data|Untracked)
 FreeMemBlock()       $47ccc8 Size: 24 (Data|Untracked)
Free()                Sound: $47cb18
 FreeMemBlock()       $8a000 Size: 4074 (Data)
 FreeMemBlock()       $47cb18 Size: 52 (Data|Untracked)
 FreeMemBlock()       $47ca98 Size: 24 (Data|Untracked)
Free()                Bob: $47bb48
 FreeMemBlock()       $881d0 Size: 1440 (Data)
 FreeMemBlock()       $88788 Size: 6240 (Data)
 Free()               Picture: $47bd80
  FreeMemBlock()      $84978 Size: 14400 (Data)
  FreeMemBlock()      $47f600 Size: 136 (Data)
  Free()              Bitmap: $47bec8
   FreeMemBlock()     $47bec8 Size: 74 (Data)
   FreeMemBlock()     $47be48 Size: 24 (Data|Untracked)
  FreeMemBlock()      $47bd80 Size: 42 (Data|Untracked)
  FreeMemBlock()      $47bd00 Size: 24 (Data|Untracked)
 FreeMemBlock()       $47c7c8 Size: 56 (Data)
 FreeMemBlock()       $47c8a8 Size: 56 (Data)
 FreeMemBlock()       $47bb48 Size: 202 (Data|Untracked)
 FreeMemBlock()       $47bac8 Size: 24 (Data|Untracked)
Free()                Restore: $47b848
 FreeMemBlock()       $47b9b0 Size: 38 (Data|Untracked)
 FreeMemBlock()       $47b920 Size: 38 (Data|Untracked)
 FreeMemBlock()       $47b848 Size: 44 (Data)
 FreeMemBlock()       $47b280 Size: 24 (Data|Untracked)
Free()                Picture: $47ac28
 FreeMemBlock()       $5f37f8 Size: 51200 (Data)
 FreeMemBlock()       $482510 Size: 136 (Data)
 Free()               Bitmap: $47ad70
  FreeMemBlock()      $47ad70 Size: 74 (Data)
  FreeMemBlock()      $47acf0 Size: 24 (Data|Untracked)
 FreeMemBlock()       $47ac28 Size: 42 (Data|Untracked)
 FreeMemBlock()       $47aba8 Size: 24 (Data|Untracked)
Free()                Screen: $47afc8
 Hide()               Screen: $47afc8
  FreeMemBlock()      $47d0e0 Size: 8 (Data)
 FreeMemBlock()       $84560 Size: 612 (Data)
 FreeMemBlock()       $1f37f8 Size: 51200 (Data)
 FreeMemBlock()       $1e6fe0 Size: 51200 (Data)
 Free()               Bitmap: $47b148
  FreeMemBlock()      $47b148 Size: 74 (Data)
  FreeMemBlock()      $47b0c8 Size: 24 (Data|Untracked)
 FreeMemBlock()       $47afc8 Size: 230 (Data|Untracked)
 FreeMemBlock()       $47a488 Size: 24 (Data|Untracked)
Free()                Module: $4130b8 (screens.mod)
 Screens:             Freeing screen preferences.
 FreeMemBlock()       $4798e8 Size: 1100 (Data)
 FreeMemBlock()       $425420 Size: 166 (Code|Untracked)
 FreeMemBlock()       $4130b8 Size: 46 (Data|Untracked)
 FreeMemBlock()       $3f94c8 Size: 24 (Data|Untracked)
Free()                Module: $425618 (blitter.mod)
 FreeMemBlock()       $479e80 Size: 172 (Code|Untracked)
 FreeMemBlock()       $425618 Size: 46 (Data|Untracked)
 FreeMemBlock()       $40c948 Size: 24 (Data|Untracked)
Free()                Module: $47a158 (sound.mod)
 FreeMemBlock()       $47a2d8 Size: 34 (Code|Untracked)
 FreeMemBlock()       $47a158 Size: 46 (Data|Untracked)
 FreeMemBlock()       $3790d8 Size: 24 (Data|Untracked)
CloseDPK:             Closing tbis task's link with the dpkernel.
CallEventList()       ID: 2, Arg1: $3f9458, Arg2: 0
Message:              Closing down...
FreeMemBlock()        $40c888 Size: 94 (Data)
PROGRAM CLOSED.

@EndNode
***************************************************************************
@Node "Programming" "How to program with IceBreaker."
@{b}
                                PROGRAMMING
@{ub}


Programming with IceBreaker is EASY and I encourage you to use it.  The
best thing about it is that when you are not running IceBreaker all
messages go straight to an rts, so you do not lose any game speed, ie:

  moveq #ERR_FAILED,d0  
  CALL  ErrCode
        ->       jmp Null    (Library vector)
        -> Null: rts         (Return immediately)
  ...

As you can see your program will return within 2 instructions, so you can
leave your debug messages in the code even when the program is released,
and it runs at 99.99% efficiency.  If something ever does go wrong, a user
can activate IceBreaker and know the answer.  This is very useful for beta
testers.


@{u}Debug Messages and Error Codes@{uu}
The two types of messages detected by IceBreaker are those sent by
DPrintF() and ErrCode().  To send out an error code (eg ERR_NOMEM) just
call ErrCode(ERR_...).  These messages are not very versatile but are very
simple and convenient to use.  If you saw output like this:

AllocMemBlock()   Size: 4040 (Data)
@{b}Error:            NOMEM: No memory available.@{ub}

You would know that AllocMemBlock() failed to allocate 4040 bytes of memory
because there is no memory left in the system.

To send out formatted debug output, use DPrintF().  Its format is almost
identical to the printf() statement, as shown in this example:

  DPrintF("Hello:","My screen address is at $%x.",Screen);

The output of the above statement would look something like:

Hello:            My screen address is at $28942.

For more information on this function, see the debug documentation.

@EndNode
***************************************************************************
@Node "Copyright" "IceBreaker Copyright Notice."
@{b}
                                 COPYRIGHT
@{ub}

     IceBreaker is the copyright of DreamWorld Productions, 1997-1998.
     All rights reserved.  IceBreaker is subject to the same terms and
     conditions as outlined in the GMS:IMPORTANT.TXT file.

@EndNode
***************************************************************************
