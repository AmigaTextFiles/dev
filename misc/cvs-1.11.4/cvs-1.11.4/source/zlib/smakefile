#
# $Id$
#
# :ts=4
#
# AmigaOS wrapper routines for GNU CVS, using the AmiTCP V3 API
# and the SAS/C V6.58 compiler.
#
# Written and adapted by Olaf `Olsen' Barthel <olsen@sourcery.han.de>
#                        Jens Langner <Jens.Langner@htw-dresden.de>
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 2 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program; if not, write to the Free Software
# Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
#

TARGET = z.lib

# Programs

CC  = sc
OML = oml
CP  = copy
RM  = delete quiet

# ignored warnings are:
#  51 C++ comment detected                                 -- we agreed to use them
#  61 undefined struct/union tag "tag-name"                -- in include files
# 120 Integral type mismatch: possible portability problem -- should be used somewhen
# 148 use of incomplete struct/union/enum tag "name"       -- in include files
# 165 use of narrow type in prototype                      -- very unlikely portability problem
# 178 indirect call without indirection operator           -- only old-style support
# 212 item "name" already declared                         -- in include files
# 306 .. function inlined                                  -- disturbs

# Compiler/Linker flags

CPU      =  68020
DEFS     =  DEFINE=HAVE_CONFIG_H
WARN     =  WARN=ALL IGNORE=51,61,120,148,165,178,212,306
INCDIRS  =  IDIR=/ IDIR=/lib IDIR=/src IDIR=/amiga/include IDIR=/amiga IDIR=/amiga/netinclude
CFLAGS   =  OPT OPTTIME OPTSCHEDULE CPU=$(CPU) UTILLIB COMMENTNEST STRUCTUREEQUIVALENCE \
            STRINGMERGE NOSTACKCHECK $(DEFS) $(WARN) $(INCDIRS) DEBUG=LINE

OBJS     =  adler32.o compress.o crc32.o gzio.o uncompr.o deflate.o trees.o \
            zutil.o inflate.o infblock.o inftrees.o infcodes.o infutil.o inffast.o

#

default: $(TARGET)

# Default rule

.c.o:
  @echo "*e[32mCompiling $*.c*e[0m"
  @$(CC) $(CFLAGS) $<

#

$(TARGET): $(OBJS)
  @echo "*e[32mLinking $@*e[0m"
  @$(OML) $@ r $(OBJS)

# leaves TARGET
clean:
  -$(RM) $(OBJS)

#
cleanall: clean
  -$(RM) $(TARGET)

#

adler32.o: zlib.h zconf.h
compress.o: zlib.h zconf.h
crc32.o: zlib.h zconf.h
deflate.o: deflate.h zutil.h zlib.h zconf.h
example.o: zlib.h zconf.h
gzio.o: zutil.h zlib.h zconf.h
infblock.o: infblock.h inftrees.h infcodes.h infutil.h zutil.h zlib.h zconf.h
infcodes.o: zutil.h zlib.h zconf.h
infcodes.o: inftrees.h infblock.h infcodes.h infutil.h inffast.h
inffast.o: zutil.h zlib.h zconf.h inftrees.h
inffast.o: infblock.h infcodes.h infutil.h inffast.h
inflate.o: zutil.h zlib.h zconf.h infblock.h
inftrees.o: zutil.h zlib.h zconf.h inftrees.h
infutil.o: zutil.h zlib.h zconf.h infblock.h inftrees.h infcodes.h infutil.h
minigzip.o:  zlib.h zconf.h
trees.o: deflate.h zutil.h zlib.h zconf.h
uncompr.o: zlib.h zconf.h
zutil.o: zutil.h zlib.h zconf.h
