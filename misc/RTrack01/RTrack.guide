@DATABASE "RTrack Documentation"
@AUTHOR   "Boris Folgmann"
@(C)      "(C) 1995 PROXITY SOFTWORKS"

##
## $Id$
##

@$VER: RTrack.guide 0.1 (15.8.95)
@WORDWRAP
@NODE MAIN "RTrack"

                  @{b}RTrack@{ub} - Resource Tracking Link Library

		   Freeware © 1995 by @{"PROXITY SOFTWORKS" LINK "PSI/PROXITY SOFTWORKS"}

		      Development by @{"Boris Folgmann" LINK "PSI/Boris Folgmann"}


	RTrack 0.1 (15.8.95)	User Manual

	@{" Copyrights          " LINK COPYRIGHTS}	Copyright information
	@{" Disclaimer          " LINK PSI/DISCLAIMER}	Legal stuff

	@{" Description         " LINK DESCRIPTION}	What is it for?
	@{" System requirements " LINK REQUIREMENTS}	What is needed?
	@{" Contents            " LINK CONTENTS}	Archive contents
	@{" Installation        " LINK INSTALLATION}	How to install

	@{" Usage               " LINK USAGE}	How is it used?
	@{" Functions           " LINK FUNCTIONS}	Available functions
	@{" Hints               " LINK HINTS}	Further information
	@{" History             " LINK HISTORY}	What's new?

	@{" Support             " LINK PSI/SUPPORT}	How to contact us
	@{" Update              " LINK PSI/UPDATE}	Where to get new releases
	@{" Credits             " LINK PSI/CREDITS}	Thanks to some persons

@ENDNODE

###########################################################################
@NODE COPYRIGHTS

                                COPYRIGHTS


                   Unless otherwise noted, all files are
                   Freeware © 1995 by @{"PROXITY SOFTWORKS" LINK "PSI/PROXITY SOFTWORKS"}
                           All Rights Reserved.

                     MagicWB © 1994 Martin Huttenloher

                   Kickstart and Workbench are Copyright
                     © 1985-1995 by Amiga Technologies

@ENDNODE

###########################################################################
@NODE DESCRIPTION
              
                                DESCRIPTION


RTrack.lib   is  a  link  library  for  resource  tracking.   All  resource
allocations  are maintained in a linked list and automatically freed before
exiting.   The  linked  list  is  located  in  a  memory pool, so the small
allocations  don't  fragment memory.  One RTrack list node is only 12 Bytes
in  size  and the list handling is so fast that you won't have any overhead
worth mentioning.

This  version  works 100% but the set of supported routines is not complete
yet.   Please  contact  the  author if you need a specific function in your
program.

@ENDNODE

###########################################################################
@NODE REQUIREMENTS

                            SYSTEM REQUIREMENTS


@{"Kickstart" LINK COPYRIGHTS} 2.04
@{"Workbench" LINK COPYRIGHTS} 2.0
amiga.lib V40 for memory pool functions

@ENDNODE

###########################################################################
@NODE CONTENTS

                                 CONTENTS


This software package consists of the following files:

@{fg highlight}RTrack.lib@{fg text}

	The RTrack link library.

@{fg highlight}include/proto/rtrack.h@{fg text}
@{fg highlight}include/clib/rtrack_protos.h@{fg text}

	Headerfiles for using RTrack.lib.

@{fg highlight}test.c@{fg text}
@{fg highlight}SMAKEFILE@{fg text}
@{fg highlight}SCOPTIONS@{fg text}

	Example program.

@{fg highlight}RTrack.guide@{fg text}

	This AmigaGuide document for Multiview.

@{FG HIGHLIGHT}PSI@{FG TEXT}

	@{"Proxity Softworks" LINK "PSI/PROXITY SOFTWORKS"} information text.


Some icons are part of @{"MagicWB" LINK COPYRIGHTS} and included with permission of the author.

@ENDNODE

###########################################################################
@NODE INSTALLATION

                               INSTALLATION

If  you  use  SAS/C simply copy the includes to your INCLUDE: directory and
RTrack.lib to your LIB:  directory.

	@{fg highlight}copy include include: all@{fg text}
	@{fg highlight}copy RTrack.lib lib:@{fg text}

Place this documentation where you want.

@ENDNODE

###########################################################################
@NODE USAGE

                                   USAGE


This version of the link library is in SAS/C object module library format.

RTrack  uses  some auto initialisation and termination functions (beginning
with  _STI and _STD) which are supported by SAS/C only.  Therefore you have
to link with SAS/C startup-code.

If  you  use  no startup-code or your own custom startup-code you must call
_STI_RTrackInit()   before   and  _STD_RTrackCleanup()  after  your  main()
function.   Note  that  _STI_RTrackInit()  returns non zero for failure, in
this  case  you should not call your main function but _STD_RTrackCleanup()
and then exit your program with RETURN_FAIL (returncode 20).

@{FG HIGHLIGHT}int YourProgram()
{
   int rc;

   ... /* Init stuff, open dos etc. */

   if (! _STI_RTrackInit())
      rc = main();
   else
      rc = RETURN_FAIL;

   _STD_RTrackCleanup();

   ... /* Cleanup stuff, close dos etc. */

   return rc;
}@{FG TEXT}

If   you  compile  with  SAS/C  standard  startup-code  this  is  all  done
automatically.     Make    sure   that   dos.library   is   opened   before
_STI_RTrackInit() is called because ERROR_NO_FREE_STORE is set as secondary
result code with SetIoErr() if memory pool allocation fails.

If  you  compile  with  a different ANSI-C compiler which can link with the
SAS/C link library it should work like this:

@{FG HIGHLIGHT}int main(void)
{
   atexit(_STD_RTrackCleanup);	/* Let exit() call the cleanup function! */
				/* Needed for RTracks autoexit function. */

   if (_STI_RTrackInit())	/* exit() on init error */
	exit(RETURN_FAIL);

   ...				/* go on with your stuff */

   return your_rc;		/* _STI_RTrackCleanup is called */
				/* automatically! */
}@{FG TEXT}

@ENDNODE

###########################################################################
@NODE FUNCTIONS

                                 FUNCTIONS


All functions of RTrack.lib begin with 'rk'.

e.g.  allocate some mem:

	@{FG HIGHLIGHT}mem = rkAllocVec(100, MEMF_ANY);@{FG TEXT}

If you want to exit on failures automatically then call at any time:

	@{FG HIGHLIGHT}rkAutoExit(TRUE);@{FG TEXT}

If any RTrack call fails RTrack will not return NULL but call

	@{FG HIGHLIGHT}exit(RETURN_FAIL);@{FG TEXT}

This behaviour can be disabled at any time:

	@{FG HIGHLIGHT}rkAutoExit(FALSE);@{FG TEXT}

You  need  to  have  your  own  exit()  function,  if  you  don't link with
startup-code!   If  you  want to free a resoure manually before exiting use
the appropriate function for explicit freeing:

	@{FG HIGHLIGHT}rkFreeVec(mem);@{FG TEXT}

RTrack  will  not  call  FreeVec()  if  the  supplied pointer is not in the
allocated  resources  list  but  give  an  error  message  and continue the
program.

Have a look at the test.c program.  Compile with:

	@{FG HIGHLIGHT}sc test.c LIB RTrack.lib@{FG TEXT}

RTrackDump()  is for debugging purposes only and prints the contents of the
list.

If   you   use  RTrack  remember  to  only  autofree  resources  which  are
@{u}needed@{uu}  during  the  whole program run.  Others should be freed as
soon as they are no longer needed with the appropriate rkFunction.

If  your executable is linked with catch.o the resources will also be freed
if your program crashes.

@ENDNODE

###########################################################################
@NODE HINTS

                                   HINTS


As a bonus you are able to use RTracks private memory pool from within your
program.   Therefore  you  don't have to handle your own memory pool if you
are  satisfied  with  a pool with MEMF_ANY and a puddle size of 1K (this is
the  current value and may change in the future).  The functions are called
RTrackAllocAny()  and  RTrackFreeAny().   They  are  easy  to use e.g.  for
storing  strings  or  other small data structures.  Don't use it for public
data  which  needs to be shared with other tasks since you need MEMF_PUBLIC
in this case.

Note:   Standard  AllocMem()  and  FreeMem()  are  not  provided  as RTrack
functions since RTrack must keep track of the size of the memory anyway, so
use RTrackAllocVec() and RTrackFreeVec() instead.

@ENDNODE

###########################################################################
@NODE HISTORY

                                  HISTORY


0.1 (15.8.95) Release

First public release.



@ENDNODE
