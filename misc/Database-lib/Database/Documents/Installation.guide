@database database-library_INSTALLATION.guide

@$VER: INSTALLATION.guide (database-library 1.0) (03.05.04)
@author "Peter Riede"
@(c) "Copyright © 2004 by Peter "Noster" Riede"

This is a document in the AmigaGuide format.  To read it, use either
AmigaGuide, MultiView, or any other AmigaGuide compatible hypertext
browser.

@node MAIN "DataBase.library INSTALLATION - Contents"

---------------------------------------------------------------------------
                           @{b}@{fg shine}DataBase.library 1.0@{fg text}@{ub}
                               @{b}INSTALLATION@{ub}

                   A shared runtime library for creating
                           XBase-alike databases
                       @{fg shine}Copyright © 2004 Peter Riede
                           All Rights Reserved.@{fg text}

                           I hope you like it.
---------------------------------------------------------------------------

      @{" Disclaimer                                " link Disclaimer}
      @{" Introduction                              " link Introduction}
         @{" Overview                                  " link Overview}
         @{" Advantages to existing solutions          " link Advantages_to_existing_solutions}
         @{" Disadvantages to other solutions          " link Disadvantages_to_other_solutions}
         @{" Limits                                    " link Limits}
      @{" Requirements                              " link Requirements}
         @{" Destination filesystems                   " link Destination_filesystems}
         @{" Unsupported fileSystems                   " link Unsupported_fileSystems}
      @{" Installation                              " link Installation}
      @{" Benchmarks                                " link Benchmarks}
      @{" Registration & End-User-Licence-Agreement " link Registration}
      @{" Error reports & contact information       " link Error_reports}
      @{" Future                                    " link Future}
      @{" History                                   " link History}
      @{" Glossary                                  " link Glossary}
@endnode

@node Disclaimer "DataBase.library INSTALLATION - Disclaimer"

@{b}@{fg shine} Disclaimer@{fg text}@{ub}

Copyright © 2004 by Peter "Noster" Riede

Many  of  the designations used by manufacturers and sellers to distinguish
their  products are claimed as trademarks.  Where those designations appear
in  this  document  and  the  author  was  aware  of a trademark claim, the
designations  have  been  printed  in  initial caps.  Amiga is a registered
trademark, AmigaOS, AmigaDOS, exec, Intuition, Kickstart, and Workbench are
trademarks  of  Amiga  Incorporated (or whoever has bought these trademarks
from  them).   dBASE  is  a  registered  trademark  of  dBASE Incorporated.
Microsoft  is  a  registered trademark, Windows is a trademark of Microsoft
Corporation  (this  trademark  may be cleared in the future, because it has
been  declared generic, so it cannot be registered as trademark).  SAS/C is
a   registered  trademark  of  SAS  Institute,  Incorporated.   UNIX  is  a
registered trademark of The Open Group.

This  publication may be free released in electronical form, as part of the
Database.library  distribution  archive,  as long as nothing is delete from
the distribution archive, nothing is added, and no part of the distribution
archive  is  changed.   All  further  rights  are  reserved,  it may not be
modified  (including  translation  from one type of media or file format to
another).

WARNING:   The  software  and  the information described in this manual may
contain  errors  or  bugs, and may not function as described.  All software
and  the according information is subject to enhancement or upgrade for any
reason including to fix bugs, add features, or change performance.  As with
all  software  upgrades,  full  compatibility,  although  a goal, cannot be
guranteed, and is in fact unlikely.

DISCLAIMER:   THIS  SOFTWARE  AND DOCUMENTATION IS PROVIDED "AS IS" WITHOUT
WARRANTY  OF  ANY  KIND  EITHER  EXPRESSED  OR  IMPLIED, INCLUDING, BUT NOT
LIMITED  TO,  THE IMPLIED WARRANTIES OR MERCHANTABILITY AND FITNESS FOR ANY
PARTICULAR  PURPOSE.   FURTHER,  THE AUTHOR DOES NOT WARRANT, GUARANTEE, OR
MAKE ANY REPRESENTATION REGARDING THE USE OF, OR THE RESULTS OF THE USE OF,
THE  SOFTWARE AND THE INFORMATION CONTAINED HEREIN IN TERMS OF CORRECTNESS,
ACCURACY, RELIABILITY, CURRENTNESS, OR OTHERWISE; THE ENTIRE RISK AS TO ITS
QUALITY  AND ACCURACY IS ASSUMED SOLEY BY THE USER.  SHOULD THE INFORMATION
PROVE INACCURATE OR THE SOFTWARE BE SOMEHOWERRONEOUS, THE USER (AND NOT THE
AUTHOR)  ASSUMES  THE ENTIRE COST OF ALL NECESSARY CORRECTION.  IN NO EVENT
WILL   THE   AUTHOR   BE  LIABLE  FOR  DIRECT,  INDICRECT,  INCIDENTAL,  OR
CONSEQUENTIAL  DAMAGES  RESULTING  FROM  ANY  DEFECT  OR INACCURACY IN THIS
PUBLICATION, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.  SOME LAWS
DO  NOT  ALLOW  THE  EXCLUSION  OR  LIMITATION  OF  IMPLIED  WARRANTIES  OR
LIABILITIES   FOR  INCIDENTIAL  OR  CONSEQUENTIAL  DAMAGES,  SO  THE  ABOVE
LIMITATION OR EXCLUSION MAY NOT APPLY.
@endnode

@node Introduction "DataBase.library INSTALLATION - Introduction"

@{b}@{fg shine} Introduction@{fg text}@{ub}

This  shared  runtime library and the according link library can be used by
every  application  that  needs  to  store  information in a database.  The
library  contains  all functions that are required to create and edit large
databases of several datatables and their according indexes.

      @{" Overview                         " link Overview}
      @{" Advantages to existing solutions " link Advantages_to_existing_solutions}
      @{" Disadvantages to other solutions " link Disadvantages_to_other_solutions}
      @{" Limits                           " link Limits}
@endnode

@node Overview "DataBase.library INSTALLATION - Introduction"

@{b}@{fg shine} Overview@{fg text}@{ub}

The   datatables  are  organized  like  XBase-datafiles  but  they  are not
compatible   to  the  several  XBase-clones.   I  renounced  to  make  them
compatible because I've missed several options by the XBase-datatables.  So
XBase  doesn't  support  the  basic  numerical  datatypes, XBase use an own
format  for  numerical  values  stored  in  the  datatables.   They  use  a
fixed-point  value but since there is no support for fixed-point algebra in
any  known  (known by me) operating-system/hardware this will always result
in  rounding  errors  when  these  values are converted to a floating-point
value  to  do  any  arithmetics.  So I decided to add support for the basic
numeric  datatypes.   This library can store simple integer types as single
byte-values,  2  byte  words,  4 byte longs, and 8 byte (64-bit) doublelong
values and also floating-point values in single or double precision.
The  datatables  also  support  fixed-point  numerical  values  (simular to
XBase), date and time values, strings of fixed and variable length.

The  library supports simultaneous multiuser access to these files and does
the  required  lockings  so  the  accesses  of  the different instances are
serialized  to avoid conflicts.  The library supports automatically locking
or  manual locking of the records of the datatables.  Automatically locking
will  do  it  for  most  purposes  but  manual  locking may be required for
finetuning of an application.

The  records  of every datatable may be indexed using several indexes.  The
indexes  are  stored  in  own index-files and the keys in these indexes are
automatically  added/changed/removed,  whenever the contents of a record is
changed.   The keys are build according to a key-expression, that has to be
specified  for  every index.  This key-expression allows to combine several
columns of a datatable to a single key-value, e.g.  in an address-datatable
you  may  combine  the columns for the 'name' and 'first name' for an index
that is primary ordered by the 'name' and all entries with equal 'name' are
ordered  by  the  'first  name'.   There  are  also  a  couple of supported
functions that may be used to manipulate the key-values, e.g.  the function
"Upper()"  that  allows  to  create  an index where the case of the strings
doesn't matter for the sorting order.
Nearly  every  column-type  of  the  datatables  may be indexed, except the
columns containg a variable length string (or custom datatypes that are not
representable by a string or a 64-bit integer).
@endnode

@node Advantages_to_existing_solutions "DataBase.library INSTALLATION - Introduction"

@{b}@{fg shine} Advantages to existing solutions@{fg text}@{ub}

What  existing  solutions ?  I know about a mySQL client and several stand-
alone databases like Superbase or Datamat available for AmigaOS.

Superbase  and  Co  have a similar database design, but these databases are
only  accessable  using  their  own  proprietary language and the according
(ugly  and  not very powerful) GUI.  This database.library is accessable by
applications  written  in any language (as long as the programming language
supports  access  to shared runtime libraries) and so you could use any GUI
you wish.

I  really  don't know if Superbase or other simular implementations support
networks  at  all, i.e.  if these databases are able to work in a multiuser
environment.

MySQL  is  very  powerfull, but only useable with a network and fast server
running  the  database-management-system.   This  database.library  doesn't
require a network at all and if used in a network, any computer that shares
its drives with the others will do it as server, even another Amiga.

The design of the database.library allows the easy implementation of custom
datatypes,  stored  in  a table.  You just have to write two functions, one
that  converts the raw data as written into the files into a @{i}human readable @{ui}
(useable)  form  and  vice versa.  So you could easily implement datafields
that  contain  text  that  follows  strict  formating-rules,  or even store
pictures  in  IFF-ILBM  or any other format inside of memo-files (you could
prevent  a  browser  from  displaying  these  non-text columns by setting a
simple flag).
@endnode

@node Disadvantages_to_other_solutions "DataBase.library INSTALLATION - Introduction"

@{b}@{fg shine} Disadvantages to other solutions@{fg text}@{ub}

I  only  know  a  few  small  disadvantages  to the only real concurrenting
database mySQL:

 - The code of the database.library is proprietary, the format of the files
   is  open  and  completely  documented,  but there are currently no other
   tools  available  for  accessing the tables of this database format.  So
   you  could  currently  only  access  these  databases  using an Amiga (a
   Wind**f-version is in work and will be released soon).

 - If  you  place  the database files on a network-device (a Samba-server),
   this  database.library  will  produce  more  network-traffic than a SQL-
   server;  if using a SQL-server, only the datarequest and the response to
   this request are send over the network; this database.library have to do
   the complete I/O over the network (e.g.  to read a record it has to send
   a  lock-request  for  the  record  to  be read, perform a seek, read the
   record, unlock the record again).
   So  if  used  in  a  network,  you should have at least an ethernet with
   10Mbit  per  second  (but I do not know if the database.library will run
   with  a  @{i}Parnet @{ui}, @{i}Pronet @{ui}, or  @{i}Sernet @{ui} at  all -- have a look at section
   @{"Destination  filesystems" link Destination_filesystems}).   And  the  usage of this databases should be
   limited  to  small  nets  with just a few clients accessing the database
   simultaneous.   If  you  plan  to  create  a database for a network of a
   greater  company  with  dozens  of  clients  you should use a SQL-server
   instead (but who plans such a great database with an Amiga ?).

Usually the destination system of databases created using this library will
be  stand-alone  Amiga systems or small networks with one or two Amigas and
maybe  also  one  or two Windoof-PCs.  Perhaps the net will contain a small
Linux  server shared by all computers.  Such a network is used by me and it
works  fine  in  conjunction with this database.library, with the databases
stored on the Linux server -- have a look at section @{"Benchmarks" link Benchmarks}.
@endnode

@node Limits "DataBase.library INSTALLATION - Introduction"

@{b}@{fg shine} Limits@{fg text}@{ub}

The  used  structures  of  the  files written to the destination filesystem
(i.e.   the datatables, indexes, and memo-files) are designed for filesizes
up to 64 TB (1 TB [terra byte] == 1000 GB [giga byte]).
Every  table  could contain over 2 billion (exact 2147483647) records, each
upto  32767 bytes in length.  A single record could contain upto 255 fields
of  data.   Every  entry in a memo-file could be upto 2 GB large.  An index
could  contain  an unlimited number of entries, just limited by the maximum
allowed filesize.  A single key-value could be upto 256 bytes in length.

These  are  theoretical  values,  that  are  not  reached  by  the  current
implementation.   But  these  limits  could  be  implemented  in the future
version without changing the format of the files, so files that are created
using this version will be usable in future version without any change.

The  current  implementation  is limited to filesizes of 2 GB.  But I think
that a version supporting 2 TB large files will be available, if this limit
is  reached  with the databases you create using the current version of the
database.library :-).
@endnode

@node Requirements "DataBase.library INSTALLATION - Requirements"

@{b}@{fg shine} Requirements@{fg text}@{ub}

First you need is an Amiga ;-) -- of course an emulated one will do it, but
it's  not  so  nice  Support  the  few  remaining  hardware  developers  by
purchasing  their products or the Amiga-market will die completely.  Nobody
writes software for an emulated system.).

 - You have to run at least AmigaOS 2.04

 - You should have  1 MB RAM  --  the library doesn't needs much, it should
   also run with less then 1 MB but your system wouldn't be able to do much
   i.e. to start any application accessing a larger database.

 - A  fast  processor  is  recommended  --  but the library runs with every
   68000er,  there is no special turbo-version, it doesn't makes sence, the
   time  is  lost  in  file-I/O,  the  processor is usually idle except for
   processing the indexes

 - A  fast harddisk (and controller) if you are running a local database --
   but  not  the  maximum  transfer-rate  of  the harddisk is relevant, the
   average  seek  time is of quite more interest (I have two IBM DCAS-32160
   2.1GB  drives,  one  with  an Ultra-Interface but running on a SCSI-Con-
   troller  and  the other one with an UW-SCSI interface at a matching con-
   troller.   The UW-SCSI has a transfer-rate that is 5-6 times faster than
   the  other one, but the database runs nearly with the same speed on both
   disks)

 - A   network   interface   for  connecting  to  a  SAMBA-server  using  a
   TCP/IP-network  should  be present to use the multiuser-qualities of the
   database.library.
@endnode

@node Destination_filesystems "DataBase.library INSTALLATION - Requirements"

@{b}@{fg shine} Destination filesystems@{fg text}@{ub}

The  database-files  may  be  either  stored on a local device or a network
device, where the following conditions have to be fulfilled:

Beyond  the AmigaDos functions that are already part of AmigaOS 1.2 and 1.3
and  therefore  supported  by  every filesystem (and if not, how could this
filesystem  be  used  for any purpose ?), the follwing functions have to be
supported:

 - The filesystem has to support the AmigaDos function @{b}@{i}ChangeMode() @{ui}@{ub}respec-
   tively the @{b}ACTION_CHANGE_MODE@{ub} packet.

 - The  filesystem  has  to  support record-locking, the AmigaDos functions
   @{b}@{i}LockRecord() @{ui}@{ub}and @{b}@{i}UnLockRecord() @{ui}@{ub} respectively the @{b}ACTION_LOCK_RECORD@{ub} and
   @{b}ACTION_UNLOCK_RECORD@{ub} packets.

 - The AmigaDos function @{b}@{i}SetFileSize() @{ui}@{ub}respectively the @{b}ACTION_SET_FILE_SIZE@{ub}
   packet  should  be  supported.   There  is  an workaround coded into the
   database.library  if  this  packet-type is not supported, but this work-
   around  leaves  the  structure  used to access the datatable-files in an
   undefined state, if it fails (which would be the case if another process
   fetches  an exclusive lock of the file, while it is closed temporary for
   deletion).

The  according  functionality has been added to the AmigaOS in version 2.0,
so  every  modern  filesystem  for  the Amiga should implement these packet
types,  BUT this is not the case :-( ("Hey you filesystem-developer doesn't
you perform any tests to your work ?").


The following filesystems are known to support the according functions:

 - The  AmigaOS  FastFileSystem  from  AmigaOS 2.04 through 3.9 can be used
   without any restrictions.


 - The  AmigaOS  Ram-Handler  from AmigaOS 2.04 through 3.1 (!) can be used
   for  the  databases;  the AmigaOS 3.5 and 3.9 Ram-Handler has a bug that
   leads to a system crash, if a lock failure appears:

   If  a  record  is  already  locked and another instance of the datatable
   tries  to lock the record again, the Ram-Handler produces a @{b}@{i}Guru @{ui}@{ub}. So if
   you  want  to  use the ram-disk for storing any datatable or index-file,
   take  care  that  your  application,  accessing  these files through the
   database.library,  is  only launched once to avoid the risk of a system-
   crash.  I think you should better use the Ram-Handler from  AmigsOS 3.1,
   by  preventing  this  handler  from being updated by the AmigaOS 3.5/3.9
   SetPatch command in the startup-sequence:

   Change the according line to:

      @{b}SetPatch SKIPROMMODULES ram-handler QUIET@{ub}

   or if you already skip the updating of a module (e.g. of the shell):

      @{b}SetPatch SKIPROMMODULES shell,ram-handler QUIET@{ub}

   I  don't  know  any  benefit  of the AmigaOS 3.5/3.9 Ram-Handler that is
   really  required,  they  are only for beautyness (try the changes to the
   startup-sequence and look if you see any difference.).
   If  you do this change to the startup-sequence: Remember to shut-off the
   Amiga, a simple reboot doesn't suffice.
   Another  bug in each Ram-Handler is, that files could be opened a second
   time,  even if they are already opened exclusive or made exclusive using
   the  function  @{b}@{i}ChangeMode() @{ui}@{ub}- this could lead to very bad errors, if you
   try to reindex an index that is located in the ram-disk and opened twice
   or more.

   @{fg shine}In the coming  AmigaOS 4.0 these bugs (and several more) will be removed
   from the Ram-handler.@{fg text}


 - The Samba-client @{i}smbfs @{ui}in a version 1.60 or better (found in the Aminet)
   can be used to access a database located on a file-server.
   Note  that  the  version  1.60 contains a bug that makes it unuseable in
   conjunction  with  Wind**f-servers (It shows an allergic reaction to the
   @{b}SMBlseek@{ub}  packet.   Why  do  they introduce this packet type to the SMB-
   protocol,  if they don't support it?).  It just works with Samba-servers
   (Linux or Amiga).

   You  should use a newer Samba-server than 2.07, because this server con-
   tains  a  bug that leads the server to use a timeout time of @{i}forever @{ui}for
   record  locking  if  any  timeout value between 1 and about 500 @{i}ticks @{ui}is
   specified.   Any  other value would lead the server to use no timeout at
   all, fail immediately.
   The  database.library use a default timeout value of 750 @{i}ticks @{ui}, a fewer
   value  may  lead  to a deadlock running Samba-server 2.07 and if using a
   newer version of Samba, the timeout must be at least 500 @{i}ticks @{ui}, because
   the  server  looks every 10th second for remaining locks; and if a value
   less  than 500 @{i}ticks @{ui}is used, the timeout will occure, before the Server
   has the chance to try to lock the record a second time.

   A  database-application  using  @{i}smbfs @{ui}for accessing the datafiles should
   not be started twice on the same Amiga. Because of the implementation of
   @{i}smbfs @{ui} the  Samba-server  handles all requests from the Amiga as if they
   came  from  the same process, so the locking mechanism doesn't works, if
   the application runs twice or more on the same Amiga.
   A  workaround  might  be  to  mount  the servers directories twice using
   different  device-names,  e.g.   mount  the destination using the option
   "device=SMB0" and start @{i}smbfs @{ui}a second time using "device=SMB1". To make
   this  work,  your  application  must  support  a  way,  how the user can
   specifify where the database files are found during application start.
@endnode

@node Unsupported_fileSystems "DataBase.library INSTALLATION - Requirements"

@{b}@{fg shine} Unsupported fileSystems@{fg text}@{ub}

The  following  filesystems  completely  fail,  they do not support record-
locking at all:

- The Samba-client @{i}smbfs@{ui} in a version @{b}less@{ub} than 1.60.

- The Samba-client handler @{i}SMB-Handler@{ui} from dmbsoft

- The NFS-client, released with AmiTCP/Genesis

@endnode

@node Installation "DataBase.library INSTALLATION - Installation"

@{b}@{fg shine} Installation@{fg text}@{ub}

Installation  is  so  easy  and  the  users of this package are application
designers  that should be familiar with the system, so I haven't written an
installer-script for this purpose.

You  have to install the "joinOS.library", if you haven't already installed
it.   Therfore you have to copy the "joinOS.library" into "LIBS:" and -- if
you  wish  to  develop  software  using  a  C-compiler  -- the link library
"joinOS.LIB" into your compilers "LIB:" directory.

@{b}User system:@{ub}
   Just copy the "database.library" into "LIBS:"

@{b}Development system:@{ub}
   Copy the "database.library" into "LIBS:" and the directory "joinOS" con-
   taining  the  include files into the "INCLUDE:" directory of your C-com-
   piler. If the includes of the joinOS.library are already installed, just
   copy the new files and directories that aren't already installed in your
   system.
   Copy  the  link library "Database.lib" into the "LIB:" directory of your
   C-compiler.
   Copy  the  documentation,  the examples and their source to wherever you
   want to.

You should look into the section @{"Destination filesystems" link Destination_filesystems} there you can find
additional  information  according  to  the  destination filesystem of your
databases.  Under some circumstances you may require to change your systems
"startup-sequence".
@endnode

@node Benchmarks "DataBase.library INSTALLATION - Benchmarks"

@{b}@{fg shine} Benchmarks@{fg text}@{ub}

The  performance-tests are not very usefull, if you want to use the results
to  compare  them with other databases, but they give a good overview, what
you could expect using the database.library, i.e.  it gives you a chance to
estimate the @{i}time to respond @{ui}of a database using the database.library.

The application used for testing (and the according source-code) is shipped
with the database.library and could be found in the "examples" directory.
The  tests  are  made  under  @{i}real @{ui} conditions,  i.e.  the test-application
performs  realistic  accesses to the database under full multitasking (I've
written  parts of this documentation while some of the longer tests running
on the same machine).

I've tested the database.library using the following Amigas and destination
filesystems:

                                   |  ram-disk  |  Harddisk  |Samba-server|
                                   | (see notes)|    FFS     | smbfs 1.60 |
 ----------------------------------+------------+------------+------------+
 Amiga A3000T AmigaOS 3.9          |            |            |            | 
 CyperstormPPC 68060/50MHz         |            |            |            |
 2MB Chip,8MB Fast,128MB Turbo-Ram |      1     |     2      |      3     |
 UW-SCSI HDD-Controller (cybppc)   |            |            |            |
 2,1GB IBM-DCAS-32160UW            |            |            |            |
 ----------------------------------+------------+------------+------------+
 Amiga A3000T AmigaOS 3.1          |            |            |            |
 A3640 68040/25MHz                 |            |            |            |
 2MB Chip-, 16MB Fast-Ram          |      4     |     5      |     ---    |
 SCSI-I HDD-Controller (on-board)  |            |            |            |
 2,1GB IBM-DCAS-32160U             |            |            |            |
 ----------------------------------+------------+------------+------------+
 Amiga 2000 AmigaOS 2.0            |            |            |            |
 A2630 68030/25MHz (0MB 32bit Ram) |            |            |            |
 1MB Chip-, 4MB Fast-Ram (16 bit)  |      6     |     7      |     ---    |
 8bit-RLL-HDD-Controller (A.L.F.)  |            |            |            |
 32MB-Seagate ST238R               |            |            |            |
 ----------------------------------+------------+------------+------------+

Notes: The AmigaOS 3.1 Ram-Handler is used in the AmigaOS 3.9 system due to
       a bug in the OS 3.9 Ram-Handler -- see "Destination filesystems" for
       details.
       A  Zeus-ConneXion  10Mbit  Ethernet-device is used for connecting to
       the network, using Genesis TCP/IP-Stack and A2065.device.


You  should  have  a  closer look to the test used to produce the following
results.

The following tests are performed:

@{b}Create@{ub}  - Creates  a new datatable, attaches three different indexes to the
          datatable and inserts 5000 records
@{b}ReIndex@{ub} - Creates  a  new index, attaches it to the datatable of the @{b}Create@{ub}
          test  and  reindexes  this  index, i.e.  a key is added for every
          record of the datatable
@{b}Skip 1@{ub}  - Skips  through  the  whole  datatable, from the first to the last
          record using all four indexes, without any further read access to
          the table
@{b}Skip 2@{ub}  - Skips  through  the  whole  datatable, from the first to the last
          record  using  all  four  indexes,  reading the contents of every
          column of every record.
@{b}Change@{ub}  - Add  one  to  an integer column of 2500 records of the datatable.
          The index indexing this column is changed implicit
@{b}Seek 1@{ub}  - Perform 5000 seeks using an alphanumeric key, i.e. searches 5000
          times for records containing the matching string. Every seek uses
          a different keyvalue, of course.
@{b}Seek 2@{ub}  - Perform 5000 seeks using an integer key, i.e. searches 5000 times
          for  records  containing  the matching integer value.  Every seek
          uses a different keyvalue, of course.
@{b}Remove@{ub}  - Removes  the  5000  records and all matching keys in the attached
          indexes, so the datatable and the indexes are empty again.

Every result is the number of seconds required for the test.  The lower the
value, the better the performance.
The numbers in the columnheader specify the testsystem, see the table above
for details.

        |   1    |    2    |    3    |    4    |    5    |    6    |    7
--------+--------+---------+---------+---------+---------+---------+--------
Create  | 33.400 | 471.819 |1345.980 | 104.179 | 517.820 | 548.100 |2485.180
--------+--------+---------+---------+---------+---------+---------+--------
ReIndex | 12.360 | 113.660 | 264.820 |  44.060 | 143.760 | 153.820 | 649.220
--------+--------+---------+---------+---------+---------+---------+--------
Skip 1  |  7.680 |  13.560 | 236.480 |  23.280 |  37.800 | 150.360 | 221.180
--------+--------+---------+---------+---------+---------+---------+--------
Skip 2  | 21.000 |  71.840 | 464.140 |  66.260 | 185.980 | 416.260 |2211.879
--------+--------+---------+---------+---------+---------+---------+--------
Change  | 76.200 | 891.640 |1753.859 | 281.000 |1040.360 |1090.620 |5773.380
--------+--------+---------+---------+---------+---------+---------+--------
Seek 1  | 38.940 | 338.980 | 397.299 | 142.720 | 519.020 | 492.780 |1894.440
--------+--------+---------+---------+---------+---------+---------+--------
Seek 2  |  9.000 |  58.020 | 129.759 |  30.240 |  85.560 | 105.200 | 466.520
--------+--------+---------+---------+---------+---------+---------+--------
Remove  | 75.820 |1073.759 |2347.420 | 263.300 |1184.100 |1115.540 |9579.160
--------+--------+---------+---------+---------+---------+---------+--------

If  you  trust in the stability of your system (and the network, if you use
one  for  your  databases),  you  could  increase  the  speed  of writes to
index-files  by  enabling  @{i}write behind caching @{ui}. In this case, the changes
are not written, until the whole change-operation (insertion or deletion of
a  key)  is  completed, but the performance win stays in no relation to the
loss  of  reliablity -- my opinion -- so this feature is disabled initially
(except  for  reindexing  indexes,  where it is of great benefit and always
enabled).

If  your  application  is  designed for local use only, i.e.  the files are
stored on a local device (harddisk) and the application accessing it should
only  be  started  once,  you could gain at least 10 percent performance by
using an exclusive access-mode without record locking.

The  other locking-modes doesn't really increase the speed of the database,
so you should use shared access-mode with @{i}optimistic locking@{ui} per default.


Here  is  another table with tests using different access-modes and locking
schemas.   There  are  two  more  tests  using software caches to cache the
accesses to the underlying device.  This time all tests have been performed
using the A3000T with OS 3.9 and the CyberstormPPC:

medium: |   RAM    |   HDD    |   SMBFS  |  SMBFS   |   HDD*1  |   FDD*2  
access: |exclusive |exclusive |  shared  |exclusive |  shared  |  shared  
locking:|   none   |   none   |   full   |   none   |optimistic|optimistic
--------+----------+----------+----------+----------+----------+----------
Create  |  30.880  |  309.059 | 1402.419 | 1084.399 |   49.880 | 3171.120 
--------+----------+----------+----------+----------+----------+----------
ReIndex |  11.780  |  113.140 |  272.400 |  252.899 |   14.559 |  341.760 
--------+----------+----------+----------+----------+----------+----------
Skip 1  |   0.960  |    4.940 |  242.260 |    7.339 |   15.000 |    2.939 
--------+----------+----------+----------+----------+----------+----------
Skip 2  |  15.140  |   65.280 |  479.160 |  213.500 |   34.620 |    6.080 
--------+----------+----------+----------+----------+----------+----------
Change  |  79.360  |  793.099 | 1742.319 | 1415.979 |   94.839 | 3704.939 
--------+----------+----------+----------+----------+----------+----------
Seek 1  |  39.060  |  333.979 |  404.820 |  311.880 |   36.180 |    6.700 
--------+----------+----------+----------+----------+----------+----------
Seek 2  |   6.000  |   60.460 |  129.160 |   64.299 |    9.620 |    0.960 
--------+----------+----------+----------+----------+----------+----------
Remove  |  73.200  |  872.040 | 2132.920 | 1816.119 |  134.380 | 5509.520 
--------+----------+----------+----------+----------+----------+----------

*1 Using the disk-cache "FastCache 1.1" (c) Philip D'Ath (read/write cache)
*2 Using  the  fdd-software-cache "CacheIt 1.0" (c) Stefan Hochmuth and 500
   instead of 5000 records (read-cache, write-through).


@{b}@{fg shine} Summary@{fg text}@{ub}

 - Even  the  slowest (of  the above) computers using the slowest medium is
   fast  enough  to  read  at  least 2 records per second -- not very fast,
   especially  if  you use a browser to display 10 or more records per time
   --  but  for  single  record  processing  even this slow machine is fast
   enough.

 - The maximum transfer-rate of the destination medium is not as important,
   as  the  average  access-time (seek time).  A good indicator for this is
   the speed of the database on the 68040 system with the SCSI-I controller
   (theor.   maximum transfer speed 5MB/sec) compared with the 68060 system
   using  an  SCSI-UW controller (theor.  maximum transfer speed 40MB/sec).
   But  both  harddisks  are  the  same,  except  their  interface  and the
   difference  in  the speed of the database on both systems is closer than
   one might expect.

 - The  disk-cache test  and even the FDD-test shows that using a software-
   cache  for  a  local medium result in a very great performance win (I've
   enabled  the  caching-software  permanent,  after  I've seen these test-
   results :-)).
   Using write-behind caching,  the speed of the harddisk is nearly as fast
   as the RAM-disk.

 - If  you  have  a  quite  fast  Amiga  with  at  least  a  10MBit network
   connection,  you  could  use  this  database.library for small databases
   having  acceptable  respond  times  even if you process lists of records
   (browsing).

 - If  your  database  is accessed from multiple users at the same time re-
   quiring  respond  times that allows you to add/change/remove hundreds of
   records  per  minute (e.g.  you have some kind of hardware/software that
   adds  several  records  per second to the database containing any senso-
   rical information), you should use another database-technique -- and you
   should  think  about  a  faster  machine  than  a classic Amiga for that
   purpose ;-).

 - There  seems  to be much space for improvements, look for release 2.0 of
   the database.library :-)

@endnode

@node Registration "DataBase.library INSTALLATION - Registration & End-User-Licence-Agreement (EULA)"

@{b}@{fg shine} Registration & End-User-Licence-Agreement (EULA)@{fg text}@{ub}

There  is  no  End-User-Licence-Agreement  (EULA)  you  have to agree to by
@{i}clicking @{ui} an  @{i}OK-@{ui}button using the mouse.  These agreements are meaningless
and  will  not  stand  for  any  court.   You  have  to  read  the  section
Disclaimer  carefully.  If  you  use the database.library, you declare your
consent to that statements.

The  database.library  has  been  developed  over the period of more than 6
month  (and  the  included joinOS.library has required another half year of
development)  so  I cannot -- to my own regret -- publicity these libraries
and the according documention as freeware or open-source.

The database.library is "Nosterware", in simple words: @{i}I want what you get. @{ui}

The  use  of  the database.library and the joinOS.library is for free, i.e.
you  could  include  these  libraries to the distributions of your software
that make use of these libraries.

Everyone  that  writes  software using the database.library has to mind the
following rules:

 - You have to send me an email (or postcard) so I get some feedback of how
   many Amigans are out there writing software using my libraries.
   You  must at least specify your real name and your email address (if you
   have  one)  and  should specify your postal-address, so I could identify
   you (there might be some more guys named @{i}John Doo @{ui}out there ;-)).

   Every  registered  user  (who has left an email address) will be noticed
   about new versions when they become available.

 - You  have to include the following copyright notice in your applications
   @{i}About @{ui}dialog or banner printed to CLI:

      @{fg shine}Database.library 1.0, Copyright © 2004 by Peter "Noster" Riede@{fg text}

 - This copyright notice has to be placed in your applications docs.

If  you  develop  software  using  the  database.library  you have to pay a
shareware  fee,  according  to  the kind of software you develop using this
library.

 - I want to get a full version of every software written using the library.
   If  the distribution is a commericial software, I want a full package of
   this  software  (incl.   box and printed manual -- if it is part of your
   distribution).   Otherwise you could send me your distribution via email
   (compressed using @{b}"lha"@{ub})  as long as the  whole archive doesn't exceed 2
   megabytes,  in  that  case  you should send it as a CD-rom or contact me
   before mailing the archive.

 - If  your  software  is  released  as  freeware  you  doesn't need to pay
   anything!

 - If you release using any @{i}special @{ui}licenze-model (e.g. @{i}giftware, smurfware @{ui}
   :-),  etc.)  I  would  be  pleased if you also send me such a present (I
   prefer usefull Amiga-parts/-equipment, dreaming of an A1 :-)).

 - If you release your software as shareware, I request you to pay the same
   donation for my work as you get for one registration of your work.

 - If  you  write  commercial  software,  you  have  to  pay  70,-  EUR  as
   registration fee.

This version (1.0) of the software will become unrestricted freeware at the
1th  January  2007.   You  have  not to pay anything to me for any software
using the database.library that is released after this date.

The  donation  has  to  be  payed  at  the latest when you release your own
software.  If you have already payed any sum for the database.library below
70,-  EUR  and release another software as shareware or commercial product,
you have to pay again until the maximum of 70,- EUR is reached.
This  includes  new  versions  of already released software, if they become
more expensive or you request a price for an update.  In this case you have
to  pay  the  difference between the price of your previous version and the
new  version  respectively  the price of the update -- whichever is higher.
If  the  price  stays  even,  respectively  you  don't request money for an
update, you don't have to pay again.

Contact  me to get my bank-account information or if you have any questions
concerning the registration and the payment.

Every  registered  user  that  has payed at least 20,- EUR gets support.  I
will  try  to help you removing any problems in using the database.library.
You will get new versions mailed whenever they are released (until you tell
me that you don't want any updates any more).
Other users may have to wait a long time for an answer, my time is limited,
I have to earn some money ;-)

Unregistered users will not get any support.

@{b}The  Amiga market is very small, I would know if you produce software using
my libraries without registration!@{ub}
@endnode

@node Error_reports "DataBase.library INSTALLATION - Error reports & contact information"

@{b}@{fg shine} Error reports & contact information@{fg text}@{ub}

If you find any error in the database.library or this documentation, please
send  an  error-report  to me, so I could remove the error and spread a new
release.

Before  you send an error-report take care that the error is located in the
database.library  and not anywhere else.  Several filesystems available for
the Amiga are not fully compatible to the AmigaOS FastFileSystem and cannot
be  used  for the files manipulated by the database.library.  So if you are
shure  that  your  code  is  bug-free,  try to run your application using a
harddisk  partition  that  is  formated using FastFileSystem to contain the
database.

Have  a  look  at  the  known bugs and known incompatibilities of available
filesystems.

Your error-report should contain a clear, complete, and concise description
of the error, feel free to send a code-fraqment that contains the code that
fails. So I could easily reproduce the error-conditions and find the bug.
The  report  should  contain  a  telephone number and -- if available -- an
email-address  that  could  be used to get contact with you, if I need more
information.

If  you  have any ideas or announcement you should also feel free to inform
me.

Send your error-reports to:

   Peter Riede
   Eichenweg 13
   23820 Pronstorf
   Germany

or contact me by email:

   Noster-Riede@T-Online.de
@endnode

@node Future "DataBase.library INSTALLATION - Future"

@{b}@{fg shine} Future@{fg text}@{ub}

I  hope  that anyone registers so it is worth to spend further time in this
project.   I  have  some  ideas  how  to speed up accesses to the databases
(especially  reducing unnecessary accesses to the indexes, so the number of
opened indexes is nearly unimportant to the average access time).

A  native PPC version for AmigaOS 4.0 will be released as soon as I get the
money to buy an AmigaOne.

I'm implementing a Windows® version, the work has already started.

I'm  creating  a GUI-packet (GUI = Graphical User Interface), consisting of
several  libraries  for  nearly  any  kind  of  gadget  inclusive  a @{b}@{i}system
independent  multilanguage  GUI-resource  description  file  format @{ui}@{ub}and the
according  font-  and  multilanguage  supporting  GUI-editor.   The work is
nearly  completed  (at  the  Amiga)  but  I  will  need some more month for
documentation and testing before the first release.

The  GUI-editor  will  give  you  the  ability  to create the GUIs for your
applications  in  minutes  instead  of month.  The database.library will be
embedded   in   this  GUI-editor  so  you  could  create  complex  database
applications  in  a graphical way.  You will need to write only a few lines
of code @{i}by hand @{ui}.

There  is  also  a  Winows® version planned that allows you to write system
independent FAST applications inclusive their GUI.

If everything wents fine, Linux versions will also be developed.

As you see, I have a lot to do, support me in registering and sending money
so  I  could  concentrate  in  developing  instead of loitering through the
streets in search for something to eat and power for the computer.
@endnode

@node History "DataBase.library INSTALLATION - History"

@{b}@{fg shine} History@{fg text}@{ub}

   3 May 2004, version 1.0
      First public release
@endnode

@node Glossary "DataBase.library INSTALLATION - Glossary"

@{b}@{fg shine} Glossary@{fg text}@{ub}

This glossary descibes the meaning of words found in this documentation.

@{b}browser@{ub} - a kind of listview, able to show several columns of any number of
        rows of a dataserver simultaneously.

@{b}column@{ub} - the  data of a dataserver is organized in rows and columns.  Every
        record is divide into a fixed number (table-specific) of columns.
        Each column can contain different data of a columnspecific type.

@{b}database@{ub} - a database is a complex structure of several related servers and
        all according orders.

@{b}dataserver@{ub} - a dataserver is an object that serves data

@{b}datatable@{ub} - a datatable is a single entity of a database.

@{b}field@{ub} - a  field  is  a single data of a server, i.e. the field specifies a
        column of a single row.

@{b}index@{ub} - a file-based order used by the datatables. These indexes are imple-
        mented  as  B-Trees  and are used for fast access to the records in
        the  specified sorting order.  They support seeking for a specified
        key-value to get direct access to any record of a DataTable.
        Indexes can work with scopes: By setting a top and a bottom @{i}border @{ui},
        you will only access the records within this scope.  This speeds up
        accessing  the  database  and  makes  it easy to filter the records
        shown to the user (in conjunction with a @{i}browser @{ui})

@{b}joinOS.library@{ub} - a shared runtime library shipped with the database.library.
        This  library  contains  several  functions  that  are  used by the
        database.library and may also be used by any user-application. This
        library  provides functions that aren't available for all operating-
        systems  and  other  usefull functions that aren't available at any
        operating-system.
        Using  this  libraries functions makes it easier to write code that
        can be compiled/run at different operating-system versions.
        There  is  an  @{b}AUTODOC@{ub}-file  that  describes  the  functions of the
        joinOS.library located in the "document" directory shipped with the
        database.library.

@{b}key@{ub} - a key is an object that addresses a single row of a dataserver

@{b}key-entry@{ub} - an  entry  into  an  index, containing the key to a row and the
        according key-value

@{b}key-value@{ub} - is the value that is used to find a key. A key-value is usually
        created  from  the  contents  of  one or more columns of a row of a
        dataserver

@{b}record@{ub} - a  record  is  a row of data in a datatable with an unique record-
        number.

@{b}recordnumber@{ub} - usually the records in a datatable are numbered in the order
        they  have  been  inserted  into  the  datatable, starting with the
        number 1.

@{b}row@{ub} - the  data  of  a  dataserver is organized in rows and columns.  Every
        dataserver  can contain a large number of rows, each of them having
        a fixed number of columns containing individual data.

@{b}seek@{ub} - Seeking  is  the search for a row that matches the key identified by
        the specified key-value. You could either seek for the first occur-
        rence of the key-value or for the next occurrence. You could search
        for  an  exact  match  or  the  first row with a key-value equal or
        greater than the specified one.

@{b}server@{ub} - a server is an object that serves data

@{b}skip@{ub} - Skipping is the sequentiell movement of the current row pointer of a
        dataserver.   You  could either skip single rows (i.e.  move to the
        next or previous row in the active order) or multiple rows at once.
        You  could  also  skip direct to the first and the last rows in the
        active order.

@{b}user@{ub} - There are different forms of users:
       1. The (usually) human-being sitting in front of the computer system
          and handling it (or trying to/thinking he does).
       2. The application designer that uses the database.library to create
          and  handle  a database for an application that should be used by
          users(1).

@{b}XBase@{ub} - Generic term for the dBASE family of database languages.  Coined in
        response  to  threatened  litigation  over  use  of the copyrighted
        trademark 'dBASE'.
@endnode
