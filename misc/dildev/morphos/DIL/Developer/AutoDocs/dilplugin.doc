TABLE OF CONTENTS
dilplugin.dilp/--background--
dilplugin.dilp/dilGetInfo
dilplugin.dilp/dilSetup
dilplugin.dilp/dilCleanup
dilplugin.dilp/dilProcess

dilplugin.dilp.audio/--background--       dilplugin.dilp.audio/--background--

   OVERVIEW

   dil.device calls as the following
   ---------------------------------
   {
      info = dilGetInfo();

      if (dilSetup(params) == TRUE)
      {
         while (running == TRUE && error == FALSE)
         {
            ...

            if (dilProcess(plugin) == FALSE)
               error = TRUE;

            ...
         }
         dilCleanup(params)
      }
   }


dilplugin.dilp/dilGetInfo                           dilplugin.dilp/dilGetInfo

   NAME
   dilGetInfo -- Request plugin-information (V1)

   SYNOPSIS
   tagList = dilGetInfo();
   A0

   struct TagItem *dilGetInfo(void);

   FUNCTION
   Returns informations of a plugin.

   RESULT
   tagList - tags with information of the plugin

   TAGS
   Basic
   -----
   DILI_Name          - STRPTR, OPTIONAL
                        The name of the plugin

   DILI_Description   - STRPTR, MANDATORY
                        A short description of the plugin

   DILI_Warning       - STRPTR, OPTIONAL
                        Maybe a warning to the user

   VerRev
   ------
   DILI_Version       - ULONG, MANDATORY
                        Version number

   DILI_Revision      - ULONG, MANDATORY
                        Revision number

   DILI_OS            - STRPTR, OPTIONAL
                        The target OS string (MorphOS, AmigaOS)

   DILI_CodeType      - STRPTR, OPTIONAL
                        Codetype string (PPC, m68k)

   DILI_SaneID        - STRPTR, MANDATORY
                        The sane id, must point to DIL_SANEID, defined in "devices/dil.h"

   Preferences
   -----------
   DILI_Intervention  - BOOL, MANDATORY
                        If the plugin does intervene into the data stream,
                        or does other processing where the data will be manipulated,
                        this tag must be set to TRUE, else, if the data is'nt
                        touched, just 'monitored', this tag must set to FALSE.

   DILI_GenerateSeed  - BOOL, MANDATORY
                        If the plugin does need a seed, so a passphrase-request,
                        this tag must set to TRUE, else to FALSE.

   DILI_SeedDIL       - BOOL, OPTIONAL
                        Generate a blocksize-bytes long DIL seed.
                        Either DILI_SeedDIL or DILI_SeedSHA must be defined if
                        DILI_GenerateSeed is TRUE.

   DILI_SeedSHA       - BOOL, OPTIONAL
                        Generate a 32 bytes long SHA seed.

   Author
   ------
   DILI_Author        - STRPTR, OPTIONAL
                        Name, email of the author

   DILI_Copyright     - STRPTR, OPTIONAL
                        Copyright note

   DILI_License       - STRPTR, OPTIONAL
                        Licence note

   DILI_URL           - STRPTR, OPTIONAL
                        A URL for the plugin, like for updates, etc...

   SEE ALSO
   <libraries/dilplugin.h>

dilplugin.dilp/dilSetup                               dilplugin.dilp/dilSetup

   NAME
   dilSetup -- Call plugin-setup (V1)

   SYNOPSIS
   success = dilSetup(params);
   D0                 A0

   BOOL dilSetup(struct DILParams *);

   INPUTS
   params - DILParams structure

   FUNCTION
   Calls the plugin setup-function. dilSetup() is called after dilGetInfo()...
   You can use this function to setup your private stuff, needed by your plugin.
   You will receive a initiated "DILParams *" structure in A0.

   Note: Always check, that a pointer is'nt NULL before using it
   Note: All values are read only!

   See devices/dil.h for details...

   RESULT
   success - Must return TRUE if the setup-process was successfull, else FALSE

   SEE ALSO
   <devices/dil.h>, <libraries/dilplugin.h>

dilplugin.dilp/dilCleanup                           dilplugin.dilp/dilCleanup

   NAME
   dilCleanup -- Call plugin-cleanup (V1)

   SYNOPSIS
   dilCleanup();

   void dilCleanup(void);

   FUNCTION
   Calls the plugin cleanup-function. 
   Free your private stuff, allocated in dilSetup() here.

dilplugin.dilp/dilProcess                           dilplugin.dilp/dilProcess

   NAME
   dilProcess -- Call plugin-cleanup (V1)

   SYNOPSIS
   success = dilProcess(plugin);
   D0                   A0

   BOOL dilProcess(struct DILPlugin *);

   INPUTS
   plugin - DILPlugin instance

   FUNCTION
   Calls the plugin process-function. It's called everytime dil.device receives a
   read-/write-request. Do your main-processing here.
   In A0, you will receive a initiated "DILPlugin *" structure looking like this:

   typedef struct DILPlugin
   {
      DILParams *p_Params;      //Pointer to the parameters from dilSetup()

      APTR       p_Source;      //Pointer to the src-buffer
      APTR       p_Destination; //Pointer to the dst-buffer or NULL

      UBYTE     *p_Seed;        //Pointer to the seed or NULL
      ULONG      p_SeedLen;     //Seed length in bytes

      ULONG      p_Block;       //Current block offset (Logical Block Address (LBA))
      ULONG      p_Blocks;      //Current number of blocks

      ULONG      p_Flags;       //Current flags (DILF_#?)
   } DILPlugin;

   Note: All values, except p_Destination are read only!

   p_Flags
   -------
   DILF_READ
     Set if we got a read, data-in request.

   DILF_WRITE
     Write, data-out. Either DILF_READ or DILF_WRITE is set.

   DILF_INTERVENTION
     If the plugin does intervene into the data stream,
     or does other processing where the data will be manipulated,
     this flag is set and p_Destination points to a buffer
     where the data must be written after the manipulation.
     The length of p_Destination is that of p_Source, that is:

     if (p_Flags & DILF_INTERVENTION) /* intervene */
     {
        DILPlugin p;

        APTR s = p.p_Source;      /* == readble   */
        APTR d = p.p_Destination; /* == writeable */
        ULONG len = (p.p_Params->p_DosEnvec.de_SizeBlock << 2) * p.p_Blocks;

        CopyMem(s, d, len); /* just copy, any func can be here */
     }
     else /* no intervene */
     {
        DILPlugin p;

        APTR s = p.p_Source;      /* == readble */
        APTR d = p.p_Destination; /* == NULL !  */
        ULONG len = (p.p_Params->p_DosEnvec.de_SizeBlock << 2) * p.p_Blocks;
     }

   DILF_GENERATESEED
     If the plugin requested a seed, this flag is set and
     p_Seed is not NULL. The length of the seed is the same
     as the current BlockSize. Ie, if the BlockSize == 1024, the
     length of the seed would be 1024 bytes.

     if (p_Flags & DILF_GENERATESEED) /* we have a seed */
     {
         DILPlugin p;

         APTR s = p.p_Seed; /* readable */
         ULONG len = p_Params->p_DosEnvec->de_SizeBlock << 2;
     }
     else /* no seed */
     {
        DILPlugin p;

        APTR s = p.p_Seed; /* == NULL */
     }

   RESULT
   success - Must return TRUE if the process was successfull, else FALSE

   SEE ALSO
   <devices/dil.h>, <libraries/dilplugin.h>

