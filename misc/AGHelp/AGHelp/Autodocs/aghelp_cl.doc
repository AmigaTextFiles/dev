TABLE OF CONTENTS

aghelp_cl/--datasheet--
aghelp_cl/AGH_GetClass
aghelp_cl/AGHM_HELP
aghelp_cl/AGHM_CLOSEHELP
aghelp_cl/AGHM_HANDLEINPUT
aghelp_cl/--datasheet--                               aghelp_cl/--datasheet--

    NAME
	aghelp_cl -- AmigaGuide based help class.

    SUPERCLASS
	rootclass

    DESCRIPTION
	This class provides you with an easy way to add asyncronous
	AmigaGuide help to your application. This part of the AmigaGuide is
	poorly documented, but with the help of this class, all the messy
	details are taken care of. The class should work fine with any
	AmigaGuide version.

	I should be noted that I have heard of some of problems with the
	current versions of amigaguide.library. I do not know the exact
	nature of these problems, as I have not encountered them myself.

	All AGHelp class methods and the callbacks you provide it are run in
	the context of the task you call the AGHelp class from.

    METHODS
	OM_NEW -- Passed to superclass first, then set the attributes.
	    AmigaGuide and related resources are not allocated until needed.

	OM_GET -- Returns requested attributes. Passed on to superclass if
	    needed (i.e. attribute not found).

	OM_SET -- Passed to superclass first. Sets specified attributes.

	OM_UPDATE -- Passed to superclass first. If OPUF_INTERIM isn't set,
	    then set the attributes.

	OM_DISPOSE -- Closes any help window, and frees all resources.
	    Then passed on to superclass

	AGHM_HELP -- Open/change to help for the specified subject.

	AGHM_CLOSEHELP -- Close any open help window, and free the
	    AmigaGuide resources.

	AGHM_HANDLEINPUT -- Handle the AmigaGuide messages.

    ATTRIBUTES
	AGHA_SigMask (ULONG *) (ISG) Pointer specifying where to store the
	    wait mask for the AmigaGuide port created. Later on, when
	    waiting for signals to arrive, OR this in. If the signal was
	    received, then call AGHM_HANDLEINPUT. Example:

	    sigr = Wait( sigw | aghelpmask );

	    if( sigr & aghelpmask )
	    {
	            DoMethod( aghelp, AGHM_HANDLEINPUT );
	    }

	    You don't need to initialize this long. It will immediately be
	    set to the proper value. Later, when the AmigaGuide resources
	    actually have been loaded, the long will be set as well.

	    This tag is required.

	AGHA_Context (STRPTR *) (ISG) - Array of node names, used to
	    specify the node to display. When you wish to show a certain
	    page, pass on the index number in this array for the node name.
	    AmigaGuide will then display the proper node.

	    This tag is required.

	AGHA_GuideName (STRPTR) (ISG) - The name of the AmigaGuide file to
	    use for the help. This can contain the full path, but it is
	    recommended that this isn't used. If used, make the path a
	    configurable item in your application. Don't force the user to
	    place the guide file in a certain drawer.

	    This tag is required.

	AGHA_GuideDirLock (BPTR) (ISG) - Directory lock specifying where
	    the AGHA_GuideName file is to be found. Default is to look in
	    the current drawer, and then the AmigaGuide help path (as
	    specified in the environment variable `AmigaGuide/Path'). As
	    with AGHA_GuideName (and specifying the complete path), make
	    this a configurable item in your application if you use it.
	    Don't force the user to place the guide in a certain drawer.

	AGHA_PubScrName (STRPTR) (ISG) - Name of the public screen the help
	    window should open on. Must already be open.

	    Default is NULL.

	AGHA_Screen (struct Screen *) (ISG) - Screen to open the help
	    window on. Specify NULL for the Workbench screen.

	    Default is NULL.

	AGHA_HostPortName (STRPTR) (ISG) - Name of the applications' ARexx
	    port, or NULL for none. Currently not used (by the current
	    AmigaGuide versions).

	    Default is NULL.

	AGHA_ClientPortName (STRPTR) (ISG) - Base name to use for the
	    databases' ARexx port, or NULL for none.

	    Default is NULL.

	AGHA_BaseName (STRPTR) (ISG) - Basename of the application, or NULL
	    for none.

	    Default is NULL.

	AGHA_Flags (ULONG) (ISG) - Misc. flags. See
	    <libraries/amigaguide.h> for definitions (the public client
	    flags).

	    Default is 0.

	AGHA_ErrorHook (struct Hook *) (ISG) - Hook to handle (read:
	    display) any errors encountered, or NULL for no hook. The hook
	    is called like this:

	    A0 - Hook:    The hook structure.
	    A1 - Message: Message describing the error.
	    A2 - Object:  The AGHelp object in question.

	    The message structure (struct aghError) contains the following
	    fields:

	    agh_Version - Structure version (AGH_ERROR_VERSION), in case the
	        structure is extended in the future. The size will never
	        decrease.
	    agh_Error - AGHelp class error. One of the AGHERR_#? constants.
	    agh_HTError - AmigaGuide (or HyperText) error, in case
	        agh_Error is AGHERR_HTERR.
	    agh_HTErrorString - Pointer to string describing the error. May
	        be localized. Only used for AGHERR_HTERR.

	    Errors can currently occur in the AGHM_HELP and
	    AGHM_HANDLEINPUT methods, and generally indicates that the help
	    couldn't be displayed.

	    By using this error hook rather than method return values, the
	    error handling code for the application is trivial, and is
	    located to a single function in one module. Since the errors
	    aren't serious for the application, there is no need to check
	    for method errors all the time anyway. However, it can be nice
	    to be able to display errors to the user.

	    Default is NULL.

	AGHA_Active (BOOL) (G) - Returns wether the help is active or not
	    (that is, if there is any AMIGAGUIDE context open or not). If
	    TRUE, then any SetAttr()s will not have any effect until after
	    the next AGHM_CLOSEHELP, with the following two exceptions:
	    AGHA_HelpID and AGHA_Continous.

	AGHA_HelpID (ULONG) (ISG) - An alternative way to specify the
	    HelpID for the AGHM_HELP method (to use it, pass AGHA_CURRENTID
	    in AGHM_HELP).

	    On OM_GET, this attribute returns the last used help id. Note
	    that this may have no relevance as to which node is currently
	    displayed, since the user can move around in the guide.

	    Default is 0.

	AGHA_Continous (BOOL) (ISG) - If TRUE, then AGHelp will try to
	    change to the new help id when specifying AGHA_HelpID, either
	    via OM_SET or OM_UPDATE.

	    Note that this behaviour can be annoying at times, so be sure
	    to make this configurable if you decide to use it. Also note
	    that the help must be active for this to happen (AGHA_Active
	    returns TRUE).

	    Important note: It is uncertain if this is actually safe to use
	    together with OM_NOTIFY. The reason is that the method will
	    generally be invoked on the input.device task, and thus, it may
	    not call DOS function. If the relevant AmigaGuide functions
	    (SetAmigaGuideContext() and SendAmigaGuideContext()) are safe
	    in this respect is not documented.

aghelp_cl/AGH_GetClass                                 aghelp_cl/AGH_GetClass

    NAME
	AGH_GetClass -- Get the AGHelp class base pointer.

    SYNOPSIS
	base = AGH_GetClass();
	d0

	struct ClassLibrary *AGH_GetClass( VOID );

    FUNCTION
	Obtains the pointer to the AGHelp class for use with NewObject().
	This function always returns a valid pointer so you do not need to
	check it. The reason is that if the library opens fine, then the
	pointer returned is already setup. (Of course this implies that if
	opening the library fails, you shouldn't be calling this.)

	Note that this function does not create the class, that is done
	when the class library is opened.

	The class base pointer is also available in the ClassLibrary
	structure.

    RESULT
	base - Pointer to the aghelp class.

aghelp_cl/AGHM_HELP                                       aghelp_cl/AGHM_HELP

    NAME
        AGHM_HELP -- Show help for a topic.

    SYNOPSIS
	success = DoMethod( helpobj, AGHM_HELP, id );

    FUNCTION
	Shows help for the specified help id. This id is an index into the
	context array specified in AGHELP_Context.

	This method will open amigaguide.library and the amigaguide file in
	question, if not already open.

    INPUTS
	id - The item (with matching entry in the context array) to show
	    help for.

    RESULT
	success - TRUE if no immediate errors occured. If TRUE is returned,
	    the help window should hopefully open shortly (not before a
	    call to AGHM_HANDLEINPUT though).

aghelp_cl/AGHM_CLOSEHELP                             aghelp_cl/AGHM_CLOSEHELP

    NAME
	AGHM_CLOSEHELP -- Close help window and free resources.

    SYNOPSIS
	DoMethod( helpobj, AGHM_CLOSEHELP );

    FUNCTION
	Closes any open help window, and frees any allocated resources. You
	don't need to call this before disposing the object. The OM_DISPOSE
	method will do it for you.

    RESULT
	Returns 1 to indicate that the method is supported.

aghelp_cl/AGHM_HANDLEINPUT                         aghelp_cl/AGHM_HANDLEINPUT

    NAME
	AGHM_HANDLEINPUT -- Process AmigaGuide messages.

    SYNOPSIS
	DoMethod( helpobj, AGHM_HANDLEINPUT );

    FUNCTION
	Process the AmigaGuide messages arrived. All messages will be
	processed, possibly calling the error hook. Certain (error)
	messages will invoke the AGHM_CLOSEHELP method.

	You only need to call this method if you receive a signal matching
	the signal mask specified via the AGHELP_SigMask attribute.
	Example:

	Object	*help;
	ULONG	helpMask, sigWait = 0;

	help = NewObject( AGHELP_GetClass(), NULL,
	        AGHELP_SigMask,   &helpMask,
	        /* Other tags here... */
	TAG_DONE );

	while( /* something */ )
	{
	    /* Other code... */

	    sigr = Wait( sigWait | aghelpmask );

	    /* Check for other signals as well */

	    if( sigr & aghelpmask )
	    {
	            DoMethod( aghelp, AGHM_HANDLEINPUT );
	    }
	}

	Please note that calling this method properly is currently
	essential for AGHelp.class to function properly. When the AGHM_HELP
	method needs to open amigaguide.library first, it will not actually
	open the help. The open is deferred to this method, when AmigaGuide
	is ready to open the help window.

    RESULT
	Returns 1 to indicate that the method is supported.

