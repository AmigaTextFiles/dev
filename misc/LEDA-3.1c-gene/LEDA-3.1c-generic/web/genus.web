From uhrig@mpi-sb.mpg.de Tue Oct 12 14:34:03 1993
To: stefan
Content-Length: 1815
X-Lines: 80

\documentstyle[11pt,comments]{cweb}

\textwidth=6.5in
\textheight=9in
\oddsidemargin=0in
\topmargin=0in

\begin{document}

\markright{\fbox{\protect\tiny version of \today}}
\pagestyle{myheadings}

@* The Genus of an Embedding.
Let |G| be a graph with a cyclic ordering on the edges incident to each
vertex. We assume |G| to be simple and bidirected. (This precondition
is checked and |-1| is returned if it is violated). We compute the
genus of |G| according to Euler's

\[ g = (m-n-f+c+1)/2\]

Here |n| is the number of vertices of |G|, |m| is the number of 
undirected edges of |G|, |f| is the number of faces of |G| and 
|c| is the number of connected components of |G|. A face can be traced
by starting at an arbitrary edge |e0| and then constructing a path as
follows. When a vertex is entered through edge |e| then it is left
through the successor of reversal of |e|.

@c

int genus(graph&G)

{ edge_array<edge> reversal(G);

  if(!is_simple(G) || !is_bidirected(G,reversal))
  return -1;

  int c;
  @<determine number of components@> @;

  int f= 0;
  @<determine number of faces@> @;

  return((G.number_of_edges()/2-(G.number_of_nodes())-f+c+1)/2);
}

@
The following code computes the number |c| of connected components.

@<determine number of components@>=

  node_array<int> compnum(G);
  c = COMPONENTS(G, compnum);

@
It remains to compute the number |f| of faces.

@<determine number of faces@>=

  edge_array<bool> reached(G, false);
  edge e, e0;

  forall_edges(e0, G)
    if (!reached[e0])
      { f++;
	@<trace face incident to |e0|@> @;
      }

@ 
We trace the face as explained above.

@<trace face incident to |e0|@>=
  e = G.cyclic_adj_succ(reversal[e0]);
  while (e != e0)
   { reached[e] = true; 
     e = G.cyclic_adj_succ(reversal[e]); 
   }
  reached[e0] = true;
  
@
\end{document}

