head	1.3;
access;
symbols
	V2_5:1.3
	V2_4:1.2
	V2_3:1.1
	V2_2:1.1
	V2_1:1.1;
locks; strict;
comment	@# @;


1.3
date	97.01.15.21.16.13;	author heinz;	state Exp;
branches;
next	1.2;

1.2
date	96.09.17.08.34.33;	author heinz;	state Exp;
branches;
next	1.1;

1.1
date	96.03.03.10.59.16;	author heinz;	state Exp;
branches;
next	;


desc
@Amiga SAS/C 6.56 specific smake file for RCS 5.7
@


1.3
log
@Fixed date.
@
text
@# $Id: smakefile 1.2 1996/09/17 08:34:33 heinz Exp heinz $
#
#   Derived from the original RCS 5.6 makefile
#   Adapted for HWGRCS 57
#
#   ©1993-96 by HWG, For Joan Thuesen
#

# default target
def: all

#default :: all

# See README for more information on the configuration section.
# ----- start of configuration section -----

#(Unix

.ONERROR
    say "Error"

 CC = SC

#CC_D = NOOPT DEBUG=sf $(OVERRIDEDBG)
 CC_D = $(OVERRIDEDBG)

 CC_ADD = DEF "PRGVERSIONTEXT=*" Changes ©1993-97 by HWG, For Joan Thuesen*""

 CC_O = RESOPT IGNORE=85,93,149,161,178 DEF=AMIGA=1 DEF=_AMIGA=1\
    ANSI STRICT ERROR=ALL DEF=_STRICT_ANSI UTILLIB\
    DEF=_exit=__exit DEF=has_conf_h=1\
    PARM=R NOSTKCHK PPBUF=16384\
    DEF=USE_BUILTIN_MATH DEF=__USE_SYSBASE\
    DEF=const=\
    $(CC_ADD)\
    OPT

 CC_W = $(SCEXTRA)

 CFLAGS = $(CC_O) $(CC_D) $(CC_W)

HWGRCSGST = hwgrcs.gst

$(HWGRCSGST): rcsbase.h conf.h maketime.h partime.h
    echo >t.c "\#include *"rcsbase.h*""
    -gst unload `cd`/$@@
    -gst list
    -gst unload `cd`/$@@
    $(CC) $(CFLAGS) t.c NOOBJNAME MAKEGST $@@
    -delete t.c

.c.o:
    $(CC) $(CFLAGS) $*.c GST $(HWGRCSGST)

amiga$o: amiga.c smakefile
    $(CC) $(CFLAGS) $* GST $(HWGRCSGST)

 COMPAT2 = 0
#COMPAT2 = 1

 DIFF = $(DIFFPREFIX)diff

 DIFFPREFIX = RCS:# GNU diff -- must be version 1.15 or later

 DIFF_FLAGS = -an# GNU diff

#DIFF_L = 0# traditional diff
 DIFF_L = 1# GNU diff
#DIFF_L = 0# traditional diff

 DIFF_SUCCESS = 0
#DIFF_SUCCESS = EXIT_SUCCESS
 DIFF_FAILURE = 1
#DIFF_FAILURE = EXIT_FAILURE
 DIFF_TROUBLE = 2
#DIFF_TROUBLE = (EXIT_FAILURE*2)

 DIFF3 = $(DIFF)3# GNU diff3

#DIFF3_A = 1# GNU diff 2.1 or later
 DIFF3_A = 0# all other diffs

 DIFF3_BIN = 1# GNU diff
#DIFF3_BIN = 0# traditional diff

 ED = RCS:ked
#ED = /bin/ed

 EXECUTABLE_GROUP =
 EXECUTABLE_PERMISSIONS =
 INSTALL = copy clone
#EXECUTABLE_GROUP = staff# BSD unix installation
#EXECUTABLE_PERMISSIONS = -g $(EXECUTABLE_GROUP) -m 775# BSD unix installation
#INSTALL = install -c $(EXECUTABLE_PERMISSIONS)# BSD unix installation
#INSTALL = cp# traditional Unix installation

 LDFLAGS = LINK LINKWITH LIB:utillib.with MAP MXREF

 LDLIBS = STRT=cres LIB //addlib/hwgunix.lib

 LINK = $(CC) $(LDFLAGS)

 LINT =

 MAKE = SMAKE

 OTHER_OBJECT = amiga.o

 RCSDIR = RCS:

 RCSPREFIX = $(RCSDIR)

 REMOVE = DELETE

 SENDMAIL = "sendmail"

 TESTPREFIX =

 o = .o

 x =

#)
# On non-Unix hosts you must manually create and edit conf.h from conf.heg.

# ----- end of configuration section -----
# You shouldn't have to change anything past this point.


# Avoid brain damage in some versions of 'make'.
SHELL = /bin/sh

# all commands
RCSCOMMANDS = ci$x co$x ident$x merge$x rcs$x rcsdiff$x rcsmerge$x rlog$x rcsclean$x rcsfreeze$x

all : $(HWGRCSGST) $(RCSCOMMANDS)
        say "All done."

bumprev:
    @@co -q -l conf.h.amiga
    @@ci -q -f -l -mAmiga_BUMPREV_Start conf.h.amiga
    @@ci -q -f -u -mAmiga_BUMPREV_End conf.h.amiga
    @@echo "Bumped patch revision"

install : all
        $(INSTALL) ci$x $(DESTDIR)$(RCSDIR)
        $(INSTALL) co$x $(DESTDIR)$(RCSDIR)
        $(INSTALL) ident$x $(DESTDIR)$(RCSDIR)
        $(INSTALL) merge$x $(DESTDIR)$(RCSDIR)
        $(INSTALL) rcs$x $(DESTDIR)$(RCSDIR)
        $(INSTALL) rcsdiff$x $(DESTDIR)$(RCSDIR)
        $(INSTALL) rcsmerge$x $(DESTDIR)$(RCSDIR)
        $(INSTALL) rlog$x $(DESTDIR)$(RCSDIR)
        $(INSTALL) rcsclean$x $(DESTDIR)$(RCSDIR)
        $(INSTALL) rcsfreeze$x $(DESTDIR)$(RCSDIR)

# Install RCS and (if applicable) GNU diff before running these tests.
# To test RCS before installing it, see README.
RCSTEST = PATH=$(RCSDIR):$(DIFFPREFIX).:$$PATH sh $(TESTPREFIX)rcstest
installtest :
        $(RCSTEST)
installdebug :
        $(RCSTEST) -v

clean :
        -$(REMOVE) a.\#? \#?$o \#?.lnk \#?.gst \#?.map conf.h conf.error $(RCSCOMMANDS)

cleancmds :
        -$(REMOVE) $(RCSCOMMANDS)

#(Unix
#conf.h : conf.sh Makefile
#        $(REMOVE) a.*
#        CC='$(CC)' CFLAGS='$(CFLAGS)' \
#        COMPAT2='$(COMPAT2)' \
#        DIFF3='$(DIFF3)' DIFF3_A='$(DIFF3_A)' DIFF3_BIN='$(DIFF3_BIN)' \
#        DIFF='$(DIFF)' DIFF_FLAGS='$(DIFF_FLAGS)' DIFF_L='$(DIFF_L)' \
#        DIFF_SUCCESS='$(DIFF_SUCCESS)' DIFF_FAILURE='$(DIFF_FAILURE)' DIFF_TROUBLE='$(DIFF_TROUBLE)' \
#        ED='$(ED)' \
#        LDFLAGS='$(LDFLAGS)' LDLIBS='$(LDLIBS)' \
#        RCSPREFIX='$(RCSPREFIX)' \
#        SENDMAIL='$(SENDMAIL)' \
#        sh -x conf.sh >a.h 2>conf.error
#        mv a.h $@@
#        $(REMOVE) a.*
#)
conf.h: conf.h.amiga
    copy clone conf.h.amiga conf.h
    protect conf.h +wd

ci = ci$o rcslex$o rcssyn$o rcsgen$o rcsedit$o rcskeys$o rcsmap$o \
        rcsrev$o rcsutil$o rcsfnms$o rcstime$o version$o partime$o maketime$o rcskeep$o \
        rcsfcmp$o $(OTHER_OBJECT)
ci$x : $(ci) $(HWGRCSGST)
        $(LINK) $(ci) $(LDLIBS) TO $@@

co = co$o rcslex$o rcssyn$o rcsgen$o rcsedit$o rcskeys$o rcsmap$o \
        rcsrev$o rcsutil$o rcsfnms$o rcstime$o version$o partime$o maketime$o rcskeep$o $(OTHER_OBJECT)
co$x : $(co) $(HWGRCSGST)
        $(LINK) $(co) $(LDLIBS) TO $@@

ident = ident$o rcsmap$o version$o $(OTHER_OBJECT)
ident$x : $(ident) $(HWGRCSGST)
        $(LINK) $(ident) $(LDLIBS) TO $@@

merge = merge$o merger$o rcsfnms$o rcslex$o \
        rcsmap$o rcsrev$o rcssyn$o rcsutil$o \
        rcskeep$o rcskeys$o version$o rcstime$o maketime$o partime$o $(OTHER_OBJECT)
merge$x : $(merge) $(HWGRCSGST)
        $(LINK) $(merge) $(LDLIBS) TO $@@

rlog = rlog$o rcslex$o rcsmap$o rcssyn$o rcsrev$o rcsutil$o rcstime$o version$o partime$o \
        maketime$o rcsfnms$o rcskeep$o rcskeys$o $(OTHER_OBJECT)
rlog$x : $(rlog) $(HWGRCSGST)
        $(LINK) $(rlog) $(LDLIBS) TO $@@

rcs = rcs$o rcslex$o rcssyn$o rcsrev$o rcsutil$o rcsgen$o rcsedit$o rcskeys$o \
        rcsmap$o rcsfnms$o rcskeep$o version$o rcstime$o maketime$o partime$o $(OTHER_OBJECT)
rcs$x : $(rcs) $(HWGRCSGST)
        $(LINK) $(rcs) $(LDLIBS) TO $@@

rcsclean = rcsclean$o rcsedit$o rcsfcmp$o rcsfnms$o rcsgen$o rcskeys$o \
        rcslex$o rcsmap$o rcsrev$o rcssyn$o rcsutil$o rcskeep$o version$o rcstime$o maketime$o partime$o $(OTHER_OBJECT)
rcsclean$x : $(rcsclean) $(HWGRCSGST)
        $(LINK) $(rcsclean) $(LDLIBS) TO $@@

rcsdiff = rcsdiff$o rcsutil$o rcsfnms$o rcsmap$o rcsrev$o rcssyn$o rcslex$o \
        maketime$o rcstime$o version$o partime$o rcskeep$o rcskeys$o $(OTHER_OBJECT)
rcsdiff$x : $(rcsdiff) $(HWGRCSGST)
        $(LINK) $(rcsdiff) $(LDLIBS) TO $@@

rcsmerge = rcsmerge$o merger$o rcsutil$o rcsfnms$o rcsmap$o rcsrev$o rcssyn$o \
        rcslex$o rcskeep$o rcskeys$o version$o rcstime$o maketime$o partime$o $(OTHER_OBJECT)
rcsmerge$x : $(rcsmerge) $(HWGRCSGST)
        $(LINK) $(rcsmerge) $(LDLIBS) TO $@@

rcsfreeze$x: rcsfreeze.c
    $(CC) RESOPT $* $(CC_ADD) NOSTKCHK OPTIMIZE LINK NOSTARTUP STRMERGE PARM=R MAP MXREF $(CC_D)
    protect rcsfreeze$x +p


SOURCE= ci.c co.c ident.c maketime.c merge.c merger.c partime.c rcs.c \
        rcsclean.c rcsdiff.c rcsedit.c rcsfcmp.c rcsfnms.c rcsgen.c \
        rcskeep.c rcskeys.c rcslex.c rcsmap.c rcsmerge.c rcsrev.c rcssyn.c \
        rcstime.c rcsutil.c rlog.c version.c
OBJECT= ci$o co$o ident$o maketime$o merge$o merger$o partime$o rcs$o \
        rcsclean$o rcsdiff$o rcsedit$o rcsfcmp$o rcsfnms$o rcsgen$o \
        rcskeep$o rcskeys$o rcslex$o rcsmap$o rcsmerge$o rcsrev$o rcssyn$o \
        rcstime$o rcsutil$o rlog$o version$o

lint : conf.h
        $(LINT) $(CC_D) -Dlint=1 $(SOURCE)

conf_h = conf.h
#$(OBJECT) : $(conf_h) rcsbase.h

# smake doesn't seem to work right without this.
ci$o:       ci.c       $(conf_h) rcsbase.h $(HWGRCSGST)
co$o:       co.c       $(conf_h) rcsbase.h $(HWGRCSGST)
ident$o:    ident.c    $(conf_h) rcsbase.h $(HWGRCSGST)
maketime$o: maketime.c $(conf_h) rcsbase.h $(HWGRCSGST)
merge$o:    merge.c    $(conf_h) rcsbase.h $(HWGRCSGST)
merger$o:   merger.c   $(conf_h) rcsbase.h $(HWGRCSGST)
partime$o:  partime.c  $(conf_h) rcsbase.h $(HWGRCSGST)
rcs$o:      rcs.c      $(conf_h) rcsbase.h $(HWGRCSGST)
rcsclean$o: rcsclean.c $(conf_h) rcsbase.h $(HWGRCSGST)
rcsdiff$o:  rcsdiff.c  $(conf_h) rcsbase.h $(HWGRCSGST)
rcsedit$o:  rcsedit.c  $(conf_h) rcsbase.h $(HWGRCSGST)
rcsfcmp$o:  rcsfcmp.c  $(conf_h) rcsbase.h $(HWGRCSGST)
rcsfnms$o:  rcsfnms.c  $(conf_h) rcsbase.h $(HWGRCSGST)
rcsgen$o:   rcsgen.c   $(conf_h) rcsbase.h $(HWGRCSGST)
rcskeep$o:  rcskeep.c  $(conf_h) rcsbase.h $(HWGRCSGST)
rcskeys$o:  rcskeys.c  $(conf_h) rcsbase.h $(HWGRCSGST)
rcslex$o:   rcslex.c   $(conf_h) rcsbase.h $(HWGRCSGST)
rcsmap$o:   rcsmap.c   $(conf_h) rcsbase.h $(HWGRCSGST)
rcsmerge$o: rcsmerge.c $(conf_h) rcsbase.h $(HWGRCSGST)
rcsrev$o:   rcsrev.c   $(conf_h) rcsbase.h $(HWGRCSGST)
rcssyn$o:   rcssyn.c   $(conf_h) rcsbase.h $(HWGRCSGST)
rcstime$o:  rcstime.c  $(conf_h) rcsbase.h $(HWGRCSGST)
rcsutil$o:  rcsutil.c  $(conf_h) rcsbase.h $(HWGRCSGST)
rlog$o:     rlog.c     $(conf_h) rcsbase.h $(HWGRCSGST)
version$o:  version.c  $(conf_h) rcsbase.h $(HWGRCSGST)


@


1.2
log
@Moved the const cleanup into the smakefile
@
text
@d1 1
a1 1
# $Id: smakefile 1.1 1996/03/03 10:59:16 heinz Exp heinz $
d27 1
a27 1
 CC_ADD = DEF "PRGVERSIONTEXT=*" Changes ©1993-96 by HWG, For Joan Thuesen*""
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
# $Id: smakefile,v 1.26 1995/06/24 18:47:44 heinz Exp $
d34 1
@
