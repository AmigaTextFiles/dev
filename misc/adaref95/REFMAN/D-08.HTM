<html>
<head>
<title>Ada 95 RM - D.8 Monotonic Time</title>
<link rev="made" href="mailto:Magnus.Kempe@di.epfl.ch">
</head>

<body>
<h4><a href="D-07.htm"><img src="left.gif" alt="Prev"></a> | <a href="D.htm"><img src="up.gif" alt="Up"></a> | <a href="D-09.htm"><img src="right.gif" alt="Next"></a> | <a href="D-07.htm"><img src="back.gif" alt="Back"></a> | <a href="D-09.htm"><img src="forward.gif" alt="Forward"></a><br>   <a href="toc.htm">TOC --</a> / <a href="toc-l1.htm">--.--</a> / <a href="toc-l2.htm">--.--.--</a> | <a href="index.htm">Index</a> | <a href="search.htm">Search</a> | <a href="syntax.htm">Syntax</a> | <a href="help.htm">Help</a></h4>

<hr>

<h2><a name="0">D.8 Monotonic Time</a></h2>
<dl><dt><a name="1">(1)</a><dd>This clause specifies a high-resolution, monotonic clock package.
</dl><h5 align="center">Static Semantics</h5>
<dl><dt><a name="2">(2)</a><dd>The following language-defined library package exists:
</dl><pre><a name="3">(3)</a>
       package Ada.Real_Time is
<a name="4">(4)</a>
         type Time is private;
         Time_First : constant Time;
         Time_Last : constant Time;
         Time_Unit : constant := implementation-defined-real-number;
<a name="5">(5)</a>
         <em>-- (blank)</em>

<a name="6">(6)</a>
         type Time_Span is private;
         Time_Span_First : constant Time_Span;
         Time_Span_Last : constant Time_Span;
         Time_Span_Zero : constant Time_Span;
         Time_Span_Unit : constant Time_Span;
<a name="7">(7)</a>

         Tick : constant Time_Span;
         function Clock return Time;
<a name="8">(8)</a>

         function "+" (Left : Time; Right : Time_Span) return Time;
         function "+" (Left : Time_Span; Right : Time) return Time;
         function "-" (Left : Time; Right : Time_Span) return Time;
         function "-" (Left : Time; Right : Time) return Time_Span;
<a name="9">(9)</a>

         function "&lt;" (Left, Right : Time) return Boolean;
         function "&lt;="(Left, Right : Time) return Boolean;
         function "&gt;" (Left, Right : Time) return Boolean;
         function "&gt;="(Left, Right : Time) return Boolean;
<a name="10">(10)</a>

         function "+" (Left, Right : Time_Span) return Time_Span;
         function "-" (Left, Right : Time_Span) return Time_Span;
         function "-" (Right : Time_Span) return Time_Span;
         function "*" (Left : Time_Span; Right : Integer) return Time_Span;
         function "*" (Left : Integer; Right : Time_Span) return Time_Span;
         function "/" (Left, Right : Time_Span) return Integer;
         function "/" (Left : Time_Span; Right : Integer) return Time_Span;
<a name="11">(11)</a>
         function "abs"(Right : Time_Span) return Time_Span;
<a name="12">(12)</a>

         function "&lt;" (Left, Right : Time_Span) return Boolean;
         function "&lt;="(Left, Right : Time_Span) return Boolean;
         function "&gt;" (Left, Right : Time_Span) return Boolean;
         function "&gt;="(Left, Right : Time_Span) return Boolean;
<a name="13">(13)</a>

         function To_Duration (TS : Time_Span) return Duration;
         function To_Time_Span (D : Duration) return Time_Span;
<a name="14">(14)</a>

         function Nanoseconds  (NS : Integer) return Time_Span;
         function Microseconds (US : Integer) return Time_Span;
         function Milliseconds (MS : Integer) return Time_Span;
<a name="15">(15)</a>
         type Seconds_Count is range implementation-defined;
<a name="16">(16)</a>
         procedure Split(T : in Time; SC : out Seconds_Count; TS : out Time_Span);
         function Time_Of(SC : Seconds_Count; TS : Time_Span) return Time;
<a name="17">(17)</a>
       private
          ... <em>-- not specified by the language</em>
       end Ada.Real_Time;
</pre><dl><dt><a name="18">(18)</a><dd>In this Annex, real time is defined to be the physical time as observed
in the external environment.  The type Time is a time type as defined by <a href="09-06.htm">9.6</a>;
values of this type may be used in a delay_until_statement.  Values of this
type represent segments of an ideal time line.  The set of values of the type
Time corresponds one-to-one with an implementation-defined range of
mathematical integers.
<dt><a name="19">(19)</a><dd>The Time value I represents the half-open real time interval that starts
with E+I*Time_Unit and is limited by E+(I+1)*Time_Unit, where Time_Unit is an
implementation-defined real number and E is an unspecified origin point, the
epoch, that is the same for all values of the type Time.  It is not specified
by the language whether the time values are synchronized with any standard
time reference.  For example, E can correspond to the time of system
initialization or it can correspond to the epoch of some time standard.
<dt><a name="20">(20)</a><dd>Values of the type Time_Span represent length of real time duration.
The set of values of this type corresponds one-to-one with an
implementation-defined range of mathematical integers.  The Time_Span value
corresponding to the integer I represents the real-time duration I*Time_Unit.
<dt><a name="21">(21)</a><dd>Time_First and Time_Last are the smallest and largest values of the Time
type, respectively.  Similarly, Time_Span_First and Time_Span_Last are the
smallest and largest values of the Time_Span type, respectively.
<dt><a name="22">(22)</a><dd>A value of type Seconds_Count represents an elapsed time, measured in
seconds, since the epoch.
</dl><h5 align="center">Dynamic Semantics</h5>
<dl><dt><a name="23">(23)</a><dd>Time_Unit is the smallest amount of real time representable by the Time
type; it is expressed in seconds.  Time_Span_Unit is the difference between
two successive values of the Time type.  It is also the smallest positive
value of type Time_Span.  Time_Unit and Time_Span_Unit represent the same
real time duration.  A clock tick is a real time interval during which the
clock value (as observed by calling the Clock function) remains constant.
Tick is the average length of such intervals.
<dt><a name="24">(24)</a><dd>The function To_Duration converts the value TS to a value of type
Duration.  Similarly, the function To_Time_Span converts the value D to a
value of type Time_Span.  For both operations, the result is rounded to the
nearest exactly representable value (away from zero if exactly halfway
between two exactly representable values).
<dt><a name="25">(25)</a><dd>To_Duration(Time_Span_Zero) returns 0.0, and To_Time_Span(0.0) returns
Time_Span_Zero.
<dt><a name="26">(26)</a><dd>The functions Nanoseconds, Microseconds, and Milliseconds convert the
input parameter to a value of the type Time_Span.  NS, US, and MS are
interpreted as a number of nanoseconds, microseconds, and milliseconds
respectively.  The result is rounded to the nearest exactly representable
value (away from zero if exactly halfway between two exactly representable
values).
<dt><a name="27">(27)</a><dd>The effects of the operators on Time and Time_Span are as for the
operators defined for integer types.
<dt><a name="28">(28)</a><dd>The function Clock returns the amount of time since the epoch.
<dt><a name="29">(29)</a><dd>The effects of the Split and Time_Of operations are defined as follows,
treating values of type Time, Time_Span, and Seconds_Count as mathematical
integers.  The effect of Split(T,SC,TS) is to set SC and TS to values such
that T*Time_Unit = SC*1.0 + TS*Time_Unit, and 0.0 &lt;= TS*Time_Unit &lt; 1.0.  The
value returned by Time_Of(SC,TS) is the value T such that T*Time_Unit =
SC*1.0 + TS*Time_Unit.
</dl><h5 align="center">Implementation Requirements</h5>
<dl><dt><a name="30">(30)</a><dd>The range of Time values shall be sufficient to uniquely represent the
range of real times from program start-up to 50 years later.  Tick shall be
no greater than 1 millisecond.  Time_Unit shall be less than or equal to 20
microseconds.
<dt><a name="31">(31)</a><dd>Time_Span_First shall be no greater than -3600 seconds, and Time_Span_Last shall be no less than 3600 seconds.
<dt><a name="32">(32)</a><dd>A clock jump is the difference between two successive distinct values of
the clock (as observed by calling the Clock function).  There shall be no
backward clock jumps.
</dl><h5 align="center">Documentation Requirements</h5>
<dl><dt><a name="33">(33)</a><dd>The implementation shall document the values of Time_First, Time_Last,
Time_Span_First, Time_Span_Last, Time_Span_Unit, and Tick.
<dt><a name="34">(34)</a><dd>The implementation shall document the properties of the underlying time
base used for the clock and for type Time, such as the range of values
supported and any relevant aspects of the underlying hardware or operating
system facilities used.
<dt><a name="35">(35)</a><dd>The implementation shall document whether or not there is any
synchronization with external time references, and if such synchronization
exists, the sources of synchronization information, the frequency of
synchronization, and the synchronization method applied.
<dt><a name="36">(36)</a><dd>The implementation shall document any aspects of the the external
environment that could interfere with the clock behavior as defined in this
clause.
</dl><h5 align="center">Metrics</h5>
<dl><dt><a name="37">(37)</a><dd>For the purpose of the metrics defined in this clause, real time is
defined to be the International Atomic Time (TAI).
<dt><a name="38">(38)</a><dd>The implementation shall document the following metrics:
<dt><a name="39">(39)</a><dd><ul><li>An upper bound on the real-time duration of a clock tick.  This
is a value D such that if t1 and t2 are any real times such that
t1 &lt; t2 and Clock[t1] = Clock[t2] then t2 - t1 &lt;= D.
</ul><dt><a name="40">(40)</a><dd><ul><li>An upper bound on the size of a clock jump.
</ul><dt><a name="41">(41)</a><dd><ul><li>An upper bound on the drift rate of Clock with respect to real
time.  This is a real number D such that
</ul></dl><pre><a name="42">(42)</a>
            E*(1-D) &lt;= (Clock[t+E] - Clock[t]) &lt;= E*(1+D)
                    provided that: Clock[t] + E*(1+D) &lt;= Time_Last.
</pre><dl><dt><a name="43">(43)</a><dd><ul><li>where Clock[t] is the value of Clock at time t, and E is a real
time duration not less than 24 hours.  The value of E used for
this metric shall be reported.
</ul><dt><a name="44">(44)</a><dd><ul><li>An upper bound on the execution time of a call to the Clock
function, in processor clock cycles.
</ul><dt><a name="45">(45)</a><dd><ul><li>Upper bounds on the execution times of the operators of the types
Time and Time_Span, in processor clock cycles.
</ul></dl><h5 align="center">Implementation Permissions</h5>
<dl><dt><a name="46">(46)</a><dd>Implementations targeted to machines with word size smaller than 32 bits
need not support the full range and granularity of the Time and Time_Span
types.
</dl><h5 align="center">Implementation Advice</h5>
<dl><dt><a name="47">(47)</a><dd>When appropriate, implementations should provide configuration
mechanisms to change the value of Tick.
<dt><a name="48">(48)</a><dd>It is recommended that Calendar.Clock and Real_Time.Clock be implemented
as transformations of the same time base.
<dt><a name="49">(49)</a><dd>It is recommended that the ``best'' time base which exists in the
underlying system be available to the application through Clock.  ``Best''
may mean highest accuracy or largest range.
<p><dt><dd><ul>NOTES</ul>
<dt><a name="50">(50)</a><dd><ul>(30) The rules in this clause do not imply that the implementation can
protect the user from operator or installation errors which could result
in the clock being set incorrectly.
</ul><dt><a name="51">(51)</a><dd><ul>(31) Time_Unit is the granularity of the Time type.  In contrast, Tick
represents the granularity of Real_Time.Clock.  There is no requirement
that these be the same.
</ul></dl><p>
<hr>
<h4><a href="D-07.htm"><img src="left.gif" alt="Prev"></a> | <a href="D.htm"><img src="up.gif" alt="Up"></a> | <a href="D-09.htm"><img src="right.gif" alt="Next"></a> | <a href="D-07.htm"><img src="back.gif" alt="Back"></a> | <a href="D-09.htm"><img src="forward.gif" alt="Forward"></a><br>   <a href="toc.htm">TOC --</a> / <a href="toc-l1.htm">--.--</a> / <a href="toc-l2.htm">--.--.--</a> | <a href="index.htm">Index</a> | <a href="search.htm">Search</a> | <a href="syntax.htm">Syntax</a> | <a href="help.htm">Help</a></h4>

<p>
<a href="http://lglwww.epfl.ch/Ada/"><img src="la-icon.gif" alt="Ada WWW Home"></a>
 -- Email comments, additions, corrections, gripes, kudos, etc. to:
<address>
<a href="author.htm">Magnus Kempe</a>
 -- <a href="mailto:Magnus.Kempe@di.epfl.ch">Magnus.Kempe@di.epfl.ch</a><br>
<a href="cright.htm">Copyright statement</a><br>
Page last generated: 95-03-12
</address>
</body>
</html>
