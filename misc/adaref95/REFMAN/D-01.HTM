<html>
<head>
<title>Ada 95 RM - D.1 Task Priorities</title>
<link rev="made" href="mailto:Magnus.Kempe@di.epfl.ch">
</head>

<body>
<h4><img src="noleft.gif" alt="____"> | <a href="D.htm"><img src="up.gif" alt="Up"></a> | <a href="D-02.htm"><img src="right.gif" alt="Next"></a> | <a href="D.htm"><img src="back.gif" alt="Back"></a> | <a href="D-02.htm"><img src="forward.gif" alt="Forward"></a><br>   <a href="toc.htm">TOC --</a> / <a href="toc-l1.htm">--.--</a> / <a href="toc-l2.htm">--.--.--</a> | <a href="index.htm">Index</a> | <a href="search.htm">Search</a> | <a href="syntax.htm">Syntax</a> | <a href="help.htm">Help</a></h4>

<hr>

<h2><a name="0">D.1 Task Priorities</a></h2>
<dl><dt><a name="1">(1)</a><dd>This clause specifies the priority model for real-time systems.  In
addition, the methods for specifying priorities are defined.
</dl><h5 align="center"><a name="syntax">Syntax</a></h5>
<dl><dt><a name="2">(2)</a><dd><ul><li>The form of a pragma Priority is as follows:
</ul></dl><pre><a name="3">(3)</a>
         pragma Priority(expression);
</pre><dl><dt><a name="4">(4)</a><dd><ul><li>The form of a pragma Interrupt_Priority is as follows:
</ul></dl><pre><a name="5">(5)</a>
         pragma Interrupt_Priority[(expression)];
</pre><h5 align="center">Name Resolution Rules</h5>
<dl><dt><a name="6">(6)</a><dd>The expected type for the expression in a Priority or Interrupt_Priority
pragma is Integer.
</dl><h5 align="center">Legality Rules</h5>
<dl><dt><a name="7">(7)</a><dd>A Priority pragma is allowed only immediately within a task_definition, a
protected_definition, or the declarative_part of a subprogram_body.  An
Interrupt_Priority pragma is allowed only immediately within a task_definition or a protected_definition.  At most one such pragma shall appear
within a given construct.
<dt><a name="8">(8)</a><dd>For a Priority pragma that appears in the declarative_part of a
subprogram_body, the expression shall be static, and its value shall be in
the range of System.Priority.
</dl><h5 align="center">Static Semantics</h5>
<dl><dt><a name="9">(9)</a><dd>The following declarations exist in package System:
</dl><pre><a name="10">(10)</a>
       subtype Any_Priority is Integer range implementation-defined;
       subtype Priority is Any_Priority range Any_Priority'First .. implementation-defined;
       subtype Interrupt_Priority is Any_Priority range Priority'Last+1 .. Any_Priority'Last;
<a name="11">(11)</a>
       Default_Priority : constant Priority := (Priority'First + Priority'Last)/2;
</pre><dl><dt><a name="12">(12)</a><dd>The full range of priority values supported by an implementation is
specified by the subtype Any_Priority.  The subrange of priority values that
are high enough to require the blocking of one or more interrupts is
specified by the subtype Interrupt_Priority.  The subrange of priority values
below System.Interrupt_Priority'First is specified by the subtype
System.Priority.
<dt><a name="13">(13)</a><dd>The priority specified by a Priority or Interrupt_Priority pragma is the
value of the expression in the pragma, if any.  If there is no expression in
an Interrupt_Priority pragma, the priority value is Interrupt_Priority'Last.
</dl><h5 align="center">Dynamic Semantics</h5>
<dl><dt><a name="14">(14)</a><dd>A Priority pragma has no effect if it occurs in the declarative_part of
the subprogram_body of a subprogram other than the main subprogram.
<dt><a name="15">(15)</a><dd>A task priority is an integer value that indicates a degree of urgency
and is the basis for resolving competing demands of tasks for resources.
Unless otherwise specified, whenever tasks compete for processors or other
implementation-defined resources, the resources are allocated to the task
with the highest priority value.  The base priority of a task is the priority
with which it was created, or to which it was later set by Dynamic_Priorities.Set_Priority <a href="D-05.htm">(see D.5)</a>.  At all times, a task also has an active
priority, which generally reflects its base priority as well as any priority
it inherits from other sources.  Priority inheritance is the process by which
the priority of a task or other entity (e.g. a protected object; <a href="D-03.htm">see D.3)</a> is
used in the evaluation of another task's active priority.
<dt><a name="16">(16)</a><dd>The effect of specifying such a pragma in a protected_definition is
discussed in <a href="D-03.htm">D.3</a>.
<dt><a name="17">(17)</a><dd>The expression in a Priority or Interrupt_Priority pragma that appears
in a task_definition is evaluated for each task object <a href="09-01.htm">(see 9.1)</a>.  For a
Priority pragma, the value of the expression is converted to the subtype
Priority; for an Interrupt_Priority pragma, this value is converted to the
subtype Any_Priority.  The priority value is then associated with the task
object whose task_definition contains the pragma.
<dt><a name="18">(18)</a><dd>Likewise, the priority value is associated with the environment task if
the pragma appears in the declarative_part of the main subprogram.
<dt><a name="19">(19)</a><dd>The initial value of a task's base priority is specified by default or
by means of a Priority or Interrupt_Priority pragma.  After a task is
created, its base priority can be changed only by a call to Dynamic_Priorities.Set_Priority <a href="D-05.htm">(see D.5)</a>.  The initial base priority of a task in
the absence of a pragma is the base priority of the task that creates it at
the time of creation <a href="09-01.htm">(see 9.1)</a>.  If a pragma Priority does not apply to the
main subprogram, the initial base priority of the environment task is
System.Default_Priority.  The task's active priority is used when the task
competes for processors.  Similarly, the task's active priority is used to
determine the task's position in any queue when Priority_Queuing is specified
<a href="D-04.htm">(see D.4)</a>.
<dt><a name="20">(20)</a><dd>At any time, the active priority of a task is the maximum of all the
priorities the task is inheriting at that instant.  For a task that is not
held <a href="D-11.htm">(see D.11)</a>, its base priority is always a source of priority
inheritance.  Other sources of priority inheritance are specified under the
following conditions:
<dt><a name="21">(21)</a><dd><ul><li>During activation, a task being activated inherits the active
priority of the its activator <a href="09-02.htm">(see 9.2)</a>.
</ul><dt><a name="22">(22)</a><dd><ul><li>During rendezvous, the task accepting the entry call inherits the
active priority of the caller <a href="09-05-03.htm">(see 9.5.3)</a>.
</ul><dt><a name="23">(23)</a><dd><ul><li>During a protected action on a protected object, a task inherits
the ceiling priority of the protected object <a href="09-05.htm">(see 9.5</a> and <a href="D-03.htm">D.3)</a>.
</ul><dt><a name="24">(24)</a><dd>In all of these cases, the priority ceases to be inherited as soon as
the condition calling for the inheritance no longer exists.
</dl><h5 align="center">Implementation Requirements</h5>
<dl><dt><a name="25">(25)</a><dd>The range of System.Interrupt_Priority shall include at least one value.
<dt><a name="26">(26)</a><dd>The range of System.Priority shall include at least 30 values.
<p><dt><dd><ul>NOTES</ul>
<dt><a name="27">(27)</a><dd><ul>(4) The priority expression can include references to discriminants of
the enclosing type.
</ul><dt><a name="28">(28)</a><dd><ul>(5) It is a consequence of the active priority rules that at the point
when a task stops inheriting a priority from another source, its active
priority is re-evaluated.  This is in addition to other instances
described in this Annex for such re-evaluation.
</ul><dt><a name="29">(29)</a><dd><ul>(6) An implementation may provide a non-standard mode in which tasks
inherit priorities under conditions other than those specified above.
</ul></dl><p>
<hr>
<h4><img src="noleft.gif" alt="____"> | <a href="D.htm"><img src="up.gif" alt="Up"></a> | <a href="D-02.htm"><img src="right.gif" alt="Next"></a> | <a href="D.htm"><img src="back.gif" alt="Back"></a> | <a href="D-02.htm"><img src="forward.gif" alt="Forward"></a><br>   <a href="toc.htm">TOC --</a> / <a href="toc-l1.htm">--.--</a> / <a href="toc-l2.htm">--.--.--</a> | <a href="index.htm">Index</a> | <a href="search.htm">Search</a> | <a href="syntax.htm">Syntax</a> | <a href="help.htm">Help</a></h4>

<p>
<a href="http://lglwww.epfl.ch/Ada/"><img src="la-icon.gif" alt="Ada WWW Home"></a>
 -- Email comments, additions, corrections, gripes, kudos, etc. to:
<address>
<a href="author.htm">Magnus Kempe</a>
 -- <a href="mailto:Magnus.Kempe@di.epfl.ch">Magnus.Kempe@di.epfl.ch</a><br>
<a href="cright.htm">Copyright statement</a><br>
Page last generated: 95-03-12
</address>
</body>
</html>
