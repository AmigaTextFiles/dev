<html>
<head>
<title>Ada 95 RM - 9.11 Example of Tasking and Synchronization</title>
<link rev="made" href="mailto:Magnus.Kempe@di.epfl.ch">
</head>

<body>
<h4><a href="09-10.htm"><img src="left.gif" alt="Prev"></a> | <a href="09.htm"><img src="up.gif" alt="Up"></a> | <img src="noright.gif" alt="____"> | <a href="09-10.htm"><img src="back.gif" alt="Back"></a> | <a href="10.htm"><img src="forward.gif" alt="Forward"></a><br>   <a href="toc.htm">TOC --</a> / <a href="toc-l1.htm">--.--</a> / <a href="toc-l2.htm">--.--.--</a> | <a href="index.htm">Index</a> | <a href="search.htm">Search</a> | <a href="syntax.htm">Syntax</a> | <a href="help.htm">Help</a></h4>

<hr>

<h2><a name="0">9.11 Example of Tasking and Synchronization</a></h2>
<h5 align="center">Examples</h5>
<dl><dt><a name="1">(1)</a><dd>The following example defines a buffer protected object to smooth
variations between the speed of output of a producing task and the speed of
input of some consuming task.  For instance, the producing task might have
the following structure:
</dl><pre><a name="2">(2)</a>
       task Producer;
<a name="3">(3)</a>
       task body Producer is
          Char : Character;
       begin
          loop
             ... <em>--  produce the next character Char</em>
             Buffer.Write(Char);
             exit when Char = ASCII.EOT;
          end loop;
       end Producer;
</pre><dl><dt><a name="4">(4)</a><dd>and the consuming task might have the following structure:
</dl><pre><a name="5">(5)</a>
       task Consumer;
<a name="6">(6)</a>
       task body Consumer is
          Char : Character;
       begin
          loop
             Buffer.Read(Char);
             exit when Char = ASCII.EOT;
             ... <em>--  consume the character Char</em>
          end loop;
       end Consumer;
</pre><dl><dt><a name="7">(7)</a><dd>The buffer object contains an internal pool of characters managed in a
round-robin fashion.  The pool has two indices, an In_Index denoting the
space for the next input character and an Out_Index denoting the space for
the next output character.
</dl><pre><a name="8">(8)</a>
       protected Buffer is
          entry Read (C : out Character);
          entry Write(C : in  Character);
       private
          Pool      : String(1 .. 100);
          Count     : Natural := 0;
          In_Index, Out_Index : Positive := 1;
       end Buffer;
<a name="9">(9)</a>
       protected body Buffer is
          entry Write(C : in Character)
             when Count &lt; Pool'Length is
          begin
             Pool(In_Index) := C;
             In_Index := (In_Index mod Pool'Length) + 1;
             Count    := Count + 1;
          end Write;
<a name="10">(10)</a>
          entry Read(C : out Character)
             when Count &gt; 0 is
          begin
             C := Pool(Out_Index);
             Out_Index := (Out_Index mod Pool'Length) + 1;
             Count     := Count - 1;
          end Read;
       end Buffer;
</pre><p>
<hr>
<h4><a href="09-10.htm"><img src="left.gif" alt="Prev"></a> | <a href="09.htm"><img src="up.gif" alt="Up"></a> | <img src="noright.gif" alt="____"> | <a href="09-10.htm"><img src="back.gif" alt="Back"></a> | <a href="10.htm"><img src="forward.gif" alt="Forward"></a><br>   <a href="toc.htm">TOC --</a> / <a href="toc-l1.htm">--.--</a> / <a href="toc-l2.htm">--.--.--</a> | <a href="index.htm">Index</a> | <a href="search.htm">Search</a> | <a href="syntax.htm">Syntax</a> | <a href="help.htm">Help</a></h4>

<p>
<a href="http://lglwww.epfl.ch/Ada/"><img src="la-icon.gif" alt="Ada WWW Home"></a>
 -- Email comments, additions, corrections, gripes, kudos, etc. to:
<address>
<a href="author.htm">Magnus Kempe</a>
 -- <a href="mailto:Magnus.Kempe@di.epfl.ch">Magnus.Kempe@di.epfl.ch</a><br>
<a href="cright.htm">Copyright statement</a><br>
Page last generated: 95-03-12
</address>
</body>
</html>
