<html>
<head>
<title>Ada 95 RM - E.4.2 Example of Use of a Remote Access-to-Class-Wide Type</title>
<link rev="made" href="mailto:Magnus.Kempe@di.epfl.ch">
</head>

<body>
<h4><a href="E-04-01.htm"><img src="left.gif" alt="Prev"></a> | <a href="E-04.htm"><img src="up.gif" alt="Up"></a> | <img src="noright.gif" alt="____"> | <a href="E-04-01.htm"><img src="back.gif" alt="Back"></a> | <a href="E-05.htm"><img src="forward.gif" alt="Forward"></a><br>   <a href="toc.htm">TOC --</a> / <a href="toc-l1.htm">--.--</a> / <a href="toc-l2.htm">--.--.--</a> | <a href="index.htm">Index</a> | <a href="search.htm">Search</a> | <a href="syntax.htm">Syntax</a> | <a href="help.htm">Help</a></h4>

<hr>
<h3><a name="0">E.4.2 Example of Use of a Remote Access-to-Class-Wide Type</a></h3>
<h5 align="center">Examples</h5>
<dl><dt><a name="1">(1)</a><dd><em>Example of using a remote access-to-class-wide type to achieve dynamic
binding across active partitions:
</em>
</dl><pre><a name="2">(2)</a>
       package Tapes is
          pragma Pure(Tapes);
          type Tape is abstract tagged limited private;
          <em>-- Primitive dispatching operations where</em>
          <em>-- Tape is controlling operand</em>
          procedure Copy (From, To : access Tape; Num_Recs : in Natural) is abstract;
          procedure Rewind (T : access Tape) is abstract;
          <em>-- More operations</em>
       private
          type Tape is ...
       end Tapes;
<a name="3">(3)</a>
       with Tapes;
       package Name_Server is
          pragma Remote_Call_Interface;
          <em>-- Dynamic binding to remote operations is achieved</em>
          <em>-- using the access-to-limited-class-wide type Tape_Ptr</em>
          type Tape_Ptr is access all Tapes.Tape'Class;
          <em>-- The following statically bound remote operations</em>
          <em>-- allow for a name-server capability in this example</em>
          function  Find     (Name : String) return Tape_Ptr;
          procedure Register (Name : in String; T : in Tape_Ptr);
          procedure Remove   (T : in Tape_Ptr);
          <em>-- More operations</em>
       end Name_Server;
<a name="4">(4)</a>
       package Tape_Driver is
         <em>-- Declarations are not shown, they are irrelevant here</em>
       end Tape_Driver;
<a name="5">(5)</a>
       with Tapes, Name_Server;
       package body Tape_Driver is
          type New_Tape is new Tapes.Tape with ...
          procedure Copy
           (From, To : access New_Tape; Num_Recs: in Natural) is
          begin
            . . .
          end Copy;
          procedure Rewind (T : access New_Tape) is
          begin
             . . .
          end Rewind;
          <em>-- Objects remotely accessible through use</em>
          <em>-- of Name_Server operations</em>
          Tape1, Tape2 : aliased New_Tape;
       begin
          Name_Server.Register ("NINE-TRACK",  Tape1'Access);
          Name_Server.Register ("SEVEN-TRACK", Tape2'Access);
       end Tape_Driver;
<a name="6">(6)</a>
       with Tapes, Name_Server;
       <em>-- Tape_Driver is not needed and thus not mentioned in the with_clause</em>
       procedure Tape_Client is
          T1, T2 : Name_Server.Tape_Ptr;
       begin
          T1 := Name_Server.Find ("NINE-TRACK");
          T2 := Name_Server.Find ("SEVEN-TRACK");
          Tapes.Rewind (T1);
          Tapes.Rewind (T2);
          Tapes.Copy (T1, T2, 3);
       end Tape_Client;
</pre><dl><dt><a name="7">(7)</a><dd>Notes on the example:
<dt><a name="8">(8)</a><dd>(blank)
<dt><a name="9">(9)</a><dd><ul><li>The package Tapes provides the necessary declarations of the type
and its primitive operations.
</ul><dt><a name="10">(10)</a><dd><ul><li>Name_Server is a remote call interface package and is elaborated
in a separate active partition to provide the necessary naming
services (such as Register and Find) to the entire distributed
program through remote subprogram calls.
</ul><dt><a name="11">(11)</a><dd><ul><li>Tape_Driver is a normal package that is elaborated in a partition
configured on the processing node that is connected to the tape
device(s). The abstract operations are overridden to support the
locally declared tape devices (Tape1, Tape2). The package is not
visible to its clients, but it exports the tape devices (as
remote objects) through the services of the Name_Server. This
allows for tape devices to be dynamically added, removed or
replaced without requiring the modification of the clients' code.
</ul><dt><a name="12">(12)</a><dd><ul><li>The Tape_Client procedure references only declarations in the
Tapes and Name_Server packages.  Before using a tape for the
first time, it needs to query the Name_Server for a system-wide
identity for that tape. From then on, it can use that identity to
access the tape device.
</ul><dt><a name="13">(13)</a><dd><ul><li>Values of remote access type Tape_Ptr include the necessary
information to complete the remote dispatching operations that
result from dereferencing the controlling operands T1 and T2.
</ul></dl><hr>
<h4><a href="E-04-01.htm"><img src="left.gif" alt="Prev"></a> | <a href="E-04.htm"><img src="up.gif" alt="Up"></a> | <img src="noright.gif" alt="____"> | <a href="E-04-01.htm"><img src="back.gif" alt="Back"></a> | <a href="E-05.htm"><img src="forward.gif" alt="Forward"></a><br>   <a href="toc.htm">TOC --</a> / <a href="toc-l1.htm">--.--</a> / <a href="toc-l2.htm">--.--.--</a> | <a href="index.htm">Index</a> | <a href="search.htm">Search</a> | <a href="syntax.htm">Syntax</a> | <a href="help.htm">Help</a></h4>

<p>
<a href="http://lglwww.epfl.ch/Ada/"><img src="la-icon.gif" alt="Ada WWW Home"></a>
 -- Email comments, additions, corrections, gripes, kudos, etc. to:
<address>
<a href="author.htm">Magnus Kempe</a>
 -- <a href="mailto:Magnus.Kempe@di.epfl.ch">Magnus.Kempe@di.epfl.ch</a><br>
<a href="cright.htm">Copyright statement</a><br>
Page last generated: 95-03-12
</address>
</body>
</html>
