<html>
<head>
<title>Ada 95 RM - F.3.2 Edited Output Generation</title>
<link rev="made" href="mailto:Magnus.Kempe@di.epfl.ch">
</head>

<body>
<h4><a href="F-03-01.htm"><img src="left.gif" alt="Prev"></a> | <a href="F-03.htm"><img src="up.gif" alt="Up"></a> | <a href="F-03-03.htm"><img src="right.gif" alt="Next"></a> | <a href="F-03-01.htm"><img src="back.gif" alt="Back"></a> | <a href="F-03-03.htm"><img src="forward.gif" alt="Forward"></a><br>   <a href="toc.htm">TOC --</a> / <a href="toc-l1.htm">--.--</a> / <a href="toc-l2.htm">--.--.--</a> | <a href="index.htm">Index</a> | <a href="search.htm">Search</a> | <a href="syntax.htm">Syntax</a> | <a href="help.htm">Help</a></h4>

<hr>
<h3><a name="0">F.3.2 Edited Output Generation</a></h3>
<h5 align="center">Dynamic Semantics</h5>
<dl><dt><a name="1">(1)</a><dd>The contents of an edited output string are based on:
<dt><a name="2">(2)</a><dd><ul><li>A value, Item, of some decimal type Num,
</ul><dt><a name="3">(3)</a><dd><ul><li>An expanded picture String Pic_String,
</ul><dt><a name="4">(4)</a><dd><ul><li>A Boolean value, Blank_When_Zero,
</ul><dt><a name="5">(5)</a><dd><ul><li>A Currency string,
</ul><dt><a name="6">(6)</a><dd><ul><li>A Fill character,
</ul><dt><a name="7">(7)</a><dd><ul><li>A Separator character, and
</ul><dt><a name="8">(8)</a><dd><ul><li>A Radix_Mark character.
</ul><dt><a name="9">(9)</a><dd>The combination of a True value for Blank_When_Zero and a '*' character
in Pic_String is inconsistent; no edited output string is defined.
<dt><a name="10">(10)</a><dd>A layout error is identified in the rules below if leading non-zero
digits of Item, character values of the Currency string, or a negative sign
would be truncated; in such cases no edited output string is defined.
<dt><a name="11">(11)</a><dd>The edited output string has lower bound 1 and upper bound N where N =
Pic_String'Length + Currency_Length_Adjustment - Radix_Adjustment, and
<dt><a name="12">(12)</a><dd><ul><li>Currency_Length_Adjustment = Currency'Length - 1 if there is some
occurrence of '$' in Pic_String, and 0 otherwise.
</ul><dt><a name="13">(13)</a><dd><ul><li>Radix_Adjustment = 1 if there is an occurrence of 'V' or 'v' in
Pic_Str, and 0 otherwise.
</ul><dt><a name="14">(14)</a><dd>Let the magnitude of Item be expressed as a base-10 number
I[p]***I[1].F[1]***F[q], called the displayed magnitude of Item, where:
<dt><a name="15">(15)</a><dd><ul><li>q = Min(Max(Num'Scale, 0), n) where n is 0 if Pic_String has no
radix and is otherwise the number of digit positions following
radix in Pic_String, where a digit position corresponds to an
occurrence of '9', a zero_suppression_char (for an all_zero_suppression_number), a currency_char (for an all_currency_number), or a sign_char (for an all_sign_number).
</ul><dt><a name="16">(16)</a><dd><ul><li>I[p] /= 0 if p&gt;0.
</ul><dt><a name="17">(17)</a><dd>If n &lt; Num'Scale, then the above number is the result of rounding (away
from 0 if exactly midway between values).
<dt><a name="18">(18)</a><dd>If Blank_When_Zero = True and the displayed magnitude of Item is zero,
then the edited output string comprises all space character values.
Otherwise, the picture String is treated as a sequence of instances of
syntactic categories based on the rules <a href="F-03-01.htm">in F.3.1</a>, and the edited output
string is the concatenation of string values derived from these categories
according to the following mapping rules.
<dt><a name="19">(19)</a><dd>Table F-1 shows the mapping from a sign control symbol to a
corresponding character or string in the edited output.  In the columns
showing the edited output, a lower-case 'b' represents the space character.
If there is no sign control symbol but the value of Item is negative, a
layout error occurs and no edited output string is produced.
<pre>         <em>-----------------------------------------------------------------</em>
         |                                                               |
         |       Table F-1: Edited Output for Sign Control Symbols       |
         |                                                               |
         |<em>-------------------------------------------------------------- |</em>
         |                     |                     |                   |
         |                     |  Edited Output for  | Edited Output for |
         | Sign Control Symbol | Non-Negative Number |  Negative Number  |
         |                     |                     |                   |
         |<em>---------------------------------------------------------------|</em>
         |                     |                     |                   |
         |         '+'         |         '+'         |        '-'        |
         |                     |                     |                   |
         |         '-'         |         'b'         |        '-'        |
         |                     |                     |                   |
         |         '&lt;'         |         'b'         |        '('        |
         |                     |                     |                   |
         |         '&gt;'         |         'b'         |        ')'        |
         |                     |                     |                   |
         |        "CR"         |        "bb"         |       "CR"        |
         |                     |                     |                   |
         |        "DB"         |        "bb"         |       "DB"        |
         |                     |                     |                   |
         <em>-----------------------------------------------------------------</em>
</pre><dt><a name="20">(20)</a><dd>An instance of fixed_LHS_sign maps to a character as shown in Table F-1.
<dt><a name="21">(21)</a><dd>An instance of fixed_$_char maps to Currency.
<dt><a name="22">(22)</a><dd>An instance of direct_insertion maps to Separator if direct_insertion =
'_', and to the direct_insertion Character otherwise.
<dt><a name="23">(23)</a><dd>An instance of number maps to a string integer_part &amp; radix_part &amp;
fraction_part where:
<dt><a name="24">(24)</a><dd><ul><li>The string for integer_part is obtained as follows:
</ul><dt><a name="25">(25)</a><dd><ul><ul><li>Occurrences of '9' in fore_digits of number are replaced
from right to left with the decimal digit character values
for I[1], ..., I[p], respectively.
</ul></ul><dt><a name="26">(26)</a><dd><ul><ul><li>Each occurrence of '9' in fore_digits to the left of the
leftmost '9' replaced according to rule 1 is replaced with
'0'.
</ul></ul><dt><a name="27">(27)</a><dd><ul><ul><li>If p exceeds the number of occurrences of '9' in fore_digits of number, then the excess leftmost digits are
eligible for use in the mapping of an instance of zero_suppression, floating_LHS_sign, floating_$_currency, or
floating_#_currency to the left of number; if there is no
such instance, then a layout error occurs and no edited
output string is produced.
</ul></ul><dt><a name="28">(28)</a><dd><ul><li>The radix_part is:
</ul><dt><a name="29">(29)</a><dd><ul><ul><li>"" if number does not include a radix, if radix = 'V', or
if radix = 'v'
</ul></ul><dt><a name="30">(30)</a><dd><ul><ul><li>Radix_Mark if number includes '.' as radix
</ul></ul><dt><a name="31">(31)</a><dd><ul><li>The string for fraction_part is obtained as follows:
</ul><dt><a name="32">(32)</a><dd><ul><ul><li>Occurrences of '9' in aft_digits of number are replaced
from left to right with the decimal digit character values
for F[1], ... F[q].
</ul></ul><dt><a name="33">(33)</a><dd><ul><ul><li>Each occurrence of '9' in aft_digits to the right of the
rightmost '9' replaced according to rule 1 is replaced by
'0'.
</ul></ul><dt><a name="34">(34)</a><dd>An instance of zero_suppression maps to the string obtained as follows:
<dt><a name="35">(35)</a><dd><ul><li>The rightmost 'Z', 'z', or '*' Character values are replaced with
the excess digits (if any) from the integer_part of the mapping
of the number to the right of the zero_suppression instance,
</ul><dt><a name="36">(36)</a><dd><ul><li>A context_sensitive_insertion Character is replaced as though it
were a direct_insertion Character, if it occurs to the right of
some 'Z', 'z', or '*' in zero_suppression that has been mapped to
an excess digit,
</ul><dt><a name="37">(37)</a><dd><ul><li>Each Character to the left of the leftmost Character replaced
according to rule 1 above is replaced by:
</ul><dt><a name="38">(38)</a><dd><ul><ul><li>the space character if the zero suppression Character is
'Z' or 'z', or
</ul></ul><dt><a name="39">(39)</a><dd><ul><ul><li>the Fill character if the zero suppression Character is
'*'.
</ul></ul><dt><a name="40">(40)</a><dd><ul><li>A layout error occurs if some excess digits remain after all 'Z',
'z', and '*' Character values in zero_suppression have been
replaced via rule 1; no edited output string is produced.
</ul><dt><a name="41">(41)</a><dd>An instance of RHS_sign maps to a character or string as shown in Table
F-1.
<dt><a name="42">(42)</a><dd>An instance of floating_LHS_sign maps to the string obtained as follows.
<dt><a name="43">(43)</a><dd><ul><li>Up to all but one of the rightmost LHS_Sign Character values are
replaced by the excess digits (if any) from the integer_part of
the mapping of the number to the right of the floating_LHS_sign
instance.
</ul><dt><a name="44">(44)</a><dd><ul><li>The next Character to the left is replaced with the character
given by the entry in Table F-1 corresponding to the LHS_Sign
Character.
</ul><dt><a name="45">(45)</a><dd><ul><li>A context_sensitive_insertion Character is replaced as though it
were a direct_insertion Character, if it occurs to the right of
the leftmost LHS_Sign character replaced according to rule 1.
</ul><dt><a name="46">(46)</a><dd><ul><li>Any other Character is replaced by the space character..
</ul><dt><a name="47">(47)</a><dd><ul><li>A layout error occurs if some excess digits remain after
replacement via rule 1; no edited output string is produced.
</ul><dt><a name="48">(48)</a><dd>An instance of fixed_#_currency maps to the Currency string with n space
character values concatenated on the left (if the instance does not follow a
radix) or on the right (if the instance does follow a radix), where n is the
difference between the length of the fixed_#_currency instance and
Currency'Length.  A layout error occurs if Currency'Length exceeds the length
of the fixed_#_currency instance; no edited output string is produced.
<dt><a name="49">(49)</a><dd>An instance of floating_$_currency maps to the string obtained as
follows:
<dt><a name="50">(50)</a><dd><ul><li>Up to all but one of the rightmost '$' Character values are
replaced with the excess digits (if any) from the integer_part of
the mapping of the number to the right of the floating_$_currency
instance.
</ul><dt><a name="51">(51)</a><dd><ul><li>The next Character to the left is replaced by the Currency
string.
</ul><dt><a name="52">(52)</a><dd><ul><li>A context_sensitive_insertion Character is replaced as though it
were a direct_insertion Character, if it occurs to the right of
the leftmost '$' Character replaced via rule 1.
</ul><dt><a name="53">(53)</a><dd><ul><li>Each other Character is replaced by the space character.
</ul><dt><a name="54">(54)</a><dd><ul><li>A layout error occurs if some excess digits remain after
replacement by rule 1; no edited output string is produced.
</ul><dt><a name="55">(55)</a><dd>An instance of floating_#_currency maps to the string obtained as
follows:
<dt><a name="56">(56)</a><dd><ul><li>Up to all but one of the rightmost '#' Character values are
replaced with the excess digits (if any) from the integer_part of
the mapping of the number to the right of the floating_#_currency
instance.
</ul><dt><a name="57">(57)</a><dd><ul><li>The substring whose last Character occurs at the position
immediately preceding the leftmost Character replaced via rule 1,
and whose length is Currency'Length, is replaced by the Currency
string.
</ul><dt><a name="58">(58)</a><dd><ul><li>A context_sensitive_insertion Character is replaced as though it
were a direct_insertion Character, if it occurs to the right of
the leftmost '#' replaced via rule 1.
</ul><dt><a name="59">(59)</a><dd><ul><li>Any other Character is replaced by the space character.
</ul><dt><a name="60">(60)</a><dd><ul><li>A layout error occurs if some excess digits remain after
replacement rule 1, or if there is no substring with the required
length for replacement rule 2; no edited output string is
produced.
</ul><dt><a name="61">(61)</a><dd>An instance of all_zero_suppression_number maps to:
<dt><a name="62">(62)</a><dd><ul><li>a string of all spaces if the displayed magnitude of Item is
zero, the zero_suppression_char is 'Z' or 'z', and the instance
of all_zero_suppression_number does not have a radix at its last
character position;
</ul><dt><a name="63">(63)</a><dd><ul><li>a string containing the Fill character in each position except
for the character (if any) corresponding to radix, if zero_suppression_char = '*' and the displayed magnitude of Item is
zero;
</ul><dt><a name="64">(64)</a><dd><ul><li>otherwise, the same result as if each zero_suppression_char in
all_zero_suppression_aft were '9', interpreting the instance of
all_zero_suppression_number as either zero_suppression number (if
a radix and all_zero_suppression_aft are present), or as zero_suppression otherwise.
</ul><dt><a name="65">(65)</a><dd>An instance of all_sign_number maps to:
<dt><a name="66">(66)</a><dd><ul><li>a string of all spaces if the displayed magnitude of Item is zero
and the instance of all_sign_number does not have a radix at its
last character position;
</ul><dt><a name="67">(67)</a><dd><ul><li>otherwise, the same result as if each sign_char in all_sign_number_aft were '9', interpreting the instance of all_sign_number
as either floating_LHS_sign number (if a radix and all_sign_number_aft are present), or as floating_LHS_sign otherwise.
</ul><dt><a name="68">(68)</a><dd>An instance of all_currency_number maps to:
<dt><a name="69">(69)</a><dd><ul><li>a string of all spaces if the displayed magnitude of Item is zero
and the instance of all_currency_number does not have a radix at
its last character position;
</ul><dt><a name="70">(70)</a><dd><ul><li>otherwise, the same result as if each currency_char in all_currency_number_aft were '9', interpreting the instance of all_currency_number as floating_$_currency number or
floating_#_currency number (if a radix and all_currency_number_aft are present), or as floating_$_currency or
floating_#_currency otherwise.
</ul></dl><h5 align="center">Examples</h5>
<dl><dt><a name="71">(71)</a><dd>In the result string values shown below, 'b' represents the space
character.
</dl><pre><a name="72">(72)</a>
       Item:         Picture and Result Strings:
<a name="73">(73)</a>
       123456.78     Picture:  "-###**_***_**9.99"
                               "bbb$***123,456.78"
                               "bbFF***123.456,78" (currency = "FF",
                                                    separator = '.',
                                                    radix mark = ',')
<a name="74">(74)</a>
       123456.78     Picture:  "-$$$**_***_**9.99"
                     Result:   "bbb$***123,456.78"
                              "bbbFF***123.456,78" (currency = "FF",
                                                    separator = '.',
                                                    radix mark = ',')
<a name="75">(75)</a>
       0.0          Picture: "-$$$$$$.$$"
                    Result:  "bbbbbbbbbb"
<a name="76">(76)</a>
       0.20         Picture: "-$$$$$$.$$"
                    Result:  "bbbbbb$.20"
<a name="77">(77)</a>
       -1234.565    Picture: "&lt;&lt;&lt;&lt;_&lt;&lt;&lt;.&lt;&lt;###&gt;"
                    Result:  "bb(1,234.57DMb)"  (currency = "DM")
<a name="78">(78)</a>
       12345.67     Picture: "###_###_##9.99"
                    Result:  "bbCHF12,345.67"   (currency = "CHF")
</pre><hr>
<h4><a href="F-03-01.htm"><img src="left.gif" alt="Prev"></a> | <a href="F-03.htm"><img src="up.gif" alt="Up"></a> | <a href="F-03-03.htm"><img src="right.gif" alt="Next"></a> | <a href="F-03-01.htm"><img src="back.gif" alt="Back"></a> | <a href="F-03-03.htm"><img src="forward.gif" alt="Forward"></a><br>   <a href="toc.htm">TOC --</a> / <a href="toc-l1.htm">--.--</a> / <a href="toc-l2.htm">--.--.--</a> | <a href="index.htm">Index</a> | <a href="search.htm">Search</a> | <a href="syntax.htm">Syntax</a> | <a href="help.htm">Help</a></h4>

<p>
<a href="http://lglwww.epfl.ch/Ada/"><img src="la-icon.gif" alt="Ada WWW Home"></a>
 -- Email comments, additions, corrections, gripes, kudos, etc. to:
<address>
<a href="author.htm">Magnus Kempe</a>
 -- <a href="mailto:Magnus.Kempe@di.epfl.ch">Magnus.Kempe@di.epfl.ch</a><br>
<a href="cright.htm">Copyright statement</a><br>
Page last generated: 95-03-12
</address>
</body>
</html>
