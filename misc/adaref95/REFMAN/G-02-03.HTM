<html>
<head>
<title>Ada 95 RM - G.2.3 Model of Fixed Point Arithmetic</title>
<link rev="made" href="mailto:Magnus.Kempe@di.epfl.ch">
</head>

<body>
<h4><a href="G-02-02.htm"><img src="left.gif" alt="Prev"></a> | <a href="G-02.htm"><img src="up.gif" alt="Up"></a> | <a href="G-02-04.htm"><img src="right.gif" alt="Next"></a> | <a href="G-02-02.htm"><img src="back.gif" alt="Back"></a> | <a href="G-02-04.htm"><img src="forward.gif" alt="Forward"></a><br>   <a href="toc.htm">TOC --</a> / <a href="toc-l1.htm">--.--</a> / <a href="toc-l2.htm">--.--.--</a> | <a href="index.htm">Index</a> | <a href="search.htm">Search</a> | <a href="syntax.htm">Syntax</a> | <a href="help.htm">Help</a></h4>

<hr>
<h3><a name="0">G.2.3 Model of Fixed Point Arithmetic</a></h3>
<dl><dt><a name="1">(1)</a><dd>In the strict mode, the predefined arithmetic operations of a fixed point
type shall satisfy the accuracy requirements specified here and shall avoid
or signal overflow in the situations described.
</dl><h5 align="center">Implementation Requirements</h5>
<dl><dt><a name="2">(2)</a><dd>The accuracy requirements for the predefined fixed point arithmetic
operations and conversions, and the results of relations on fixed point
operands, are given below.
<dt><a name="3">(3)</a><dd>The operands of the fixed point adding operators, absolute value, and
comparisons have the same type.  These operations are required to yield exact
results, unless they overflow.
<dt><a name="4">(4)</a><dd>Multiplications and divisions are allowed between operands of any two
fixed point types; the result has to be (implicitly or explicitly) converted
to some other numeric type.  For purposes of defining the accuracy rules, the
multiplication or division and the conversion are treated as a single
operation whose accuracy depends on three types (those of the operands and
the result).  For decimal fixed point types, the attribute T'Round may be
used to imply explicit conversion with rounding <a href="03-05-10.htm">(see 3.5.10)</a>.
<dt><a name="5">(5)</a><dd>When the result type is a floating point type, the accuracy is as given
<a href="G-02-01.htm">in G.2.1</a>.  For some combinations of the operand and result types in the
remaining cases, the result is required to belong to a small set of values
called the perfect result set; for other combinations, it is required merely
to belong to a generally larger and implementation-defined set of values
called the close result set.  When the result type is a decimal fixed point
type, the perfect result set contains a single value; thus, operations on
decimal types are always fully specified.
<dt><a name="6">(6)</a><dd>When one operand of a fixed-fixed multiplication or division is of type
universal_real, that operand is not implicitly converted in the usual sense,
since the context does not determine a unique target type, but the accuracy
of the result of the multiplication or division (i.e., whether the result has
to belong to the perfect result set or merely the close result set) depends
on the value of the operand of type universal_real and on the types of the
other operand and of the result.
<dt><a name="7">(7)</a><dd>For a fixed point multiplication or division whose (exact) mathematical
result is v, and for the conversion of a value v to a fixed point type, the
perfect result set and close result set are defined as follows:
<dt><a name="8">(8)</a><dd><ul><li>If the result type is an ordinary fixed point type with a small
of s,
</ul><dt><a name="9">(9)</a><dd><ul><ul><li>if v is an integer multiple of s, then the perfect result
set contains only the value v;
</ul></ul><dt><a name="10">(10)</a><dd><ul><ul><li>otherwise, it contains the integer multiple of s just
below v and the integer multiple of s just above v.
</ul></ul><dt><a name="11">(11)</a><dd><ul>The close result set is an implementation-defined set of
consecutive integer multiples of s containing the perfect result
set as a subset.
</ul><dt><a name="12">(12)</a><dd><ul><li>If the result type is a decimal type with a small of s,
</ul><dt><a name="13">(13)</a><dd><ul><ul><li>if v is an integer multiple of s, then the perfect result
set contains only the value v;
</ul></ul><dt><a name="14">(14)</a><dd><ul><ul><li>otherwise, if truncation applies then it contains only the
integer multiple of s in the direction toward zero,
whereas if rounding applies then it contains only the
nearest integer multiple of s (with ties broken by
rounding away from zero).
</ul></ul><dt><a name="15">(15)</a><dd><ul>The close result set is an implementation-defined set of
consecutive integer multiples of s containing the perfect result
set as a subset.
</ul><dt><a name="16">(16)</a><dd><ul><li>If the result type is an integer type,
</ul><dt><a name="17">(17)</a><dd><ul><ul><li>if v is an integer, then the perfect result set contains
only the value v;
</ul></ul><dt><a name="18">(18)</a><dd><ul><ul><li>otherwise, it contains the integer nearest to the value v
(if v lies equally distant from two consecutive integers,
the perfect result set contains the one that is further
from zero).
</ul></ul><dt><a name="19">(19)</a><dd><ul>The close result set is an implementation-defined set of
consecutive integers containing the perfect result set as a
subset.
</ul><dt><a name="20">(20)</a><dd>The result of a fixed point multiplication or division shall belong
either to the perfect result set or to the close result set, as described
below, if overflow does not occur.  In the following cases, if the result
type is a fixed point type, let s be its small; otherwise, i.e. when the
result type is an integer type, let s be 1.0.
<dt><a name="21">(21)</a><dd><ul><li>For a multiplication or division neither of whose operands is of
type universal_real, let l and r be the smalls of the left and
right operands.  For a multiplication, if (l*r)/s is an integer
or the reciprocal of an integer (the smalls are said to be
``compatible'' in this case), the result shall belong to the
perfect result set; otherwise, it belongs to the close result
set.  For a division, if l/(r*s) is an integer or the reciprocal
of an integer (i.e., the smalls are compatible), the result shall
belong to the perfect result set; otherwise, it belongs to the
close result set.
</ul><dt><a name="22">(22)</a><dd><ul><li>For a multiplication or division having one universal_real
operand with a value of v, note that it is always possible to
factor v as an integer multiple of a ``compatible'' small, but
the integer multiple may be ``too big.''  If there exists a
factorization in which that multiple is less than some
implementation-defined limit, the result shall belong to the
perfect result set; otherwise, it belongs to the close result
set.
</ul><dt><a name="23">(23)</a><dd>A multiplication P * Q of an operand of a fixed point type F by an
operand of an integer type I, or vice-versa, and a division P / Q of an
operand of a fixed point type F by an operand of an integer type I, are also
allowed.  In these cases, the result has a type of F; explicit conversion of
the result is never required.  The accuracy required in these cases is the
same as that required for a multiplication F(P * Q) or a division F(P / Q)
obtained by interpreting the operand of the integer type to have a fixed
point type with a small of 1.0.
<dt><a name="24">(24)</a><dd>The accuracy of the result of a conversion from an integer or fixed
point type to a fixed point type, or from a fixed point type to an integer
type, is the same as that of a fixed point multiplication of the source value
by a fixed point operand having a small of 1.0 and a value of 1.0, as given
by the foregoing rules.  The result of a conversion from a floating point
type to a fixed point type shall belong to the close result set.  The result
of a conversion of a universal_real operand to a fixed point type shall
belong to the perfect result set.
<dt><a name="25">(25)</a><dd>The possibility of overflow in the result of a predefined arithmetic
operation or conversion yielding a result of a fixed point type T is
analogous to that for floating point types, except for being related to the
base range instead of the safe range.  If all of the permitted results belong
to the base range of T, then the implementation shall deliver one of the
permitted results; otherwise,
<dt><a name="26">(26)</a><dd><ul><li>if T'Machine_Overflows is True, the implementation shall either
deliver one of the permitted results or raise Constraint_Error;
</ul><dt><a name="27">(27)</a><dd><ul><li>if T'Machine_Overflows is False, the result is implementation
defined.
</ul></dl><hr>
<h4><a href="G-02-02.htm"><img src="left.gif" alt="Prev"></a> | <a href="G-02.htm"><img src="up.gif" alt="Up"></a> | <a href="G-02-04.htm"><img src="right.gif" alt="Next"></a> | <a href="G-02-02.htm"><img src="back.gif" alt="Back"></a> | <a href="G-02-04.htm"><img src="forward.gif" alt="Forward"></a><br>   <a href="toc.htm">TOC --</a> / <a href="toc-l1.htm">--.--</a> / <a href="toc-l2.htm">--.--.--</a> | <a href="index.htm">Index</a> | <a href="search.htm">Search</a> | <a href="syntax.htm">Syntax</a> | <a href="help.htm">Help</a></h4>

<p>
<a href="http://lglwww.epfl.ch/Ada/"><img src="la-icon.gif" alt="Ada WWW Home"></a>
 -- Email comments, additions, corrections, gripes, kudos, etc. to:
<address>
<a href="author.htm">Magnus Kempe</a>
 -- <a href="mailto:Magnus.Kempe@di.epfl.ch">Magnus.Kempe@di.epfl.ch</a><br>
<a href="cright.htm">Copyright statement</a><br>
Page last generated: 95-03-12
</address>
</body>
</html>
