<html>
<head>
<title>Ada 95 RM - 3.8.1 Variant Parts and Discrete Choices</title>
<link rev="made" href="mailto:Magnus.Kempe@di.epfl.ch">
</head>

<body>
<h4><img src="noleft.gif" alt="____"> | <a href="03-08.htm"><img src="up.gif" alt="Up"></a> | <img src="noright.gif" alt="____"> | <a href="03-08.htm"><img src="back.gif" alt="Back"></a> | <a href="03-09.htm"><img src="forward.gif" alt="Forward"></a><br>   <a href="toc.htm">TOC --</a> / <a href="toc-l1.htm">--.--</a> / <a href="toc-l2.htm">--.--.--</a> | <a href="index.htm">Index</a> | <a href="search.htm">Search</a> | <a href="syntax.htm">Syntax</a> | <a href="help.htm">Help</a></h4>

<hr>
<h3><a name="0">3.8.1 Variant Parts and Discrete Choices</a></h3>
<dl><dt><a name="1">(1)</a><dd>A record type with a variant_part specifies alternative lists of
components.  Each variant defines the components for the value or values of
the discriminant covered by its discrete_choice_list.
</dl><h5 align="center"><a name="syntax">Syntax</a></h5>
<pre><a name="2">(2)</a>
       variant_part ::=
          case discriminant_direct_name is
              variant
             {variant}
          end case;
<a name="3">(3)</a>
       variant ::=
          when discrete_choice_list =&gt;
             component_list
<a name="4">(4)</a>
       discrete_choice_list ::= discrete_choice {| discrete_choice}
<a name="5">(5)</a>
       discrete_choice ::= expression | discrete_range | others
</pre><h5 align="center">Name Resolution Rules</h5>
<dl><dt><a name="6">(6)</a><dd>The discriminant_direct_name shall resolve to denote a discriminant
(called the discriminant of the variant_part) specified in the known_discriminant_part of the full_type_declaration that contains the variant_part.  The expected type for each discrete_choice in a variant is the type of
the discriminant of the variant_part.
</dl><h5 align="center">Legality Rules</h5>
<dl><dt><a name="7">(7)</a><dd>The discriminant of the variant_part shall be of a discrete type.
<dt><a name="8">(8)</a><dd>The expressions and discrete_ranges given as discrete_choices in a
variant_part shall be static.  The discrete_choice others shall appear alone
in a discrete_choice_list, and such a discrete_choice_list, if it appears,
shall be the last one in the enclosing construct.
<dt><a name="9">(9)</a><dd>A discrete_choice is defined to cover a value in the following cases:
<dt><a name="10">(10)</a><dd><ul><li>A discrete_choice that is an expression covers a value if the
value equals the value of the expression converted to the
expected type.
</ul><dt><a name="11">(11)</a><dd><ul><li>A discrete_choice that is a discrete_range covers all values
(possibly none) that belong to the range.
</ul><dt><a name="12">(12)</a><dd><ul><li>The discrete_choice others covers all values of its expected type
that are not covered by previous discrete_choice_lists of the
same construct.
</ul><dt><a name="13">(13)</a><dd>A discrete_choice_list covers a value if one of its discrete_choices
covers the value.
<dt><a name="14">(14)</a><dd>The possible values of the discriminant of a variant_part shall be
covered as follows:
<dt><a name="15">(15)</a><dd><ul><li>If the discriminant is of a static constrained scalar subtype,
then each non-others discrete_choice shall cover only values in
that subtype, and each value of that subtype shall be covered by
some discrete_choice (either explicitly or by others);
</ul><dt><a name="16">(16)</a><dd><ul><li>If the type of the discriminant is a descendant of a generic
formal scalar type then the variant_part shall have an others
discrete_choice;
</ul><dt><a name="17">(17)</a><dd><ul><li>Otherwise, each value of the base range of the type of the
discriminant shall be covered (either explicitly or by others).
</ul><dt><a name="18">(18)</a><dd>Two distinct discrete_choices of a variant_part shall not cover the same
value.
</dl><h5 align="center">Static Semantics</h5>
<dl><dt><a name="19">(19)</a><dd>If the component_list of a variant is specified by null, the variant has
no components.
<dt><a name="20">(20)</a><dd>The discriminant of a variant_part is said to govern the variant_part
and its variants.  In addition, the discriminant of a derived type governs a
variant_part and its variants if it corresponds <a href="03-07.htm">(see 3.7)</a> to the discriminant
of the variant_part.
</dl><h5 align="center">Dynamic Semantics</h5>
<dl><dt><a name="21">(21)</a><dd>A record value contains the values of the components of a particular
variant only if the value of the discriminant governing the variant is
covered by the discrete_choice_list of the variant.  This rule applies in
turn to any further variant that is, itself, included in the component_list
of the given variant.
<dt><a name="22">(22)</a><dd>The elaboration of a variant_part consists of the elaboration of the
component_list of each variant in the order in which they appear.
</dl><h5 align="center">Examples</h5>
<dl><dt><a name="23">(23)</a><dd><em>Example of record type with a variant part:
</em>
</dl><pre><a name="24">(24)</a>
       type Device is (Printer, Disk, Drum);
       type State  is (Open, Closed);
<a name="25">(25)</a>
       type Peripheral(Unit : Device := Disk) is
          record
             Status : State;
             case Unit is
                when Printer =&gt;
                   Line_Count : Integer range 1 .. Page_Size;
                when others =&gt;
                   Cylinder   : Cylinder_Index;
                   Track      : Track_Number;
                end case;
             end record;
</pre><dl><dt><a name="26">(26)</a><dd><em>Examples of record subtypes:
</em>
</dl><pre><a name="27">(27)</a>
       subtype Drum_Unit is Peripheral(Drum);
       subtype Disk_Unit is Peripheral(Disk);
</pre><dl><dt><a name="28">(28)</a><dd><em>Examples of constrained record variables:
</em>
</dl><pre><a name="29">(29)</a>
       Writer   : Peripheral(Unit  =&gt; Printer);
       Archive  : Disk_Unit;
</pre><hr>
<h4><img src="noleft.gif" alt="____"> | <a href="03-08.htm"><img src="up.gif" alt="Up"></a> | <img src="noright.gif" alt="____"> | <a href="03-08.htm"><img src="back.gif" alt="Back"></a> | <a href="03-09.htm"><img src="forward.gif" alt="Forward"></a><br>   <a href="toc.htm">TOC --</a> / <a href="toc-l1.htm">--.--</a> / <a href="toc-l2.htm">--.--.--</a> | <a href="index.htm">Index</a> | <a href="search.htm">Search</a> | <a href="syntax.htm">Syntax</a> | <a href="help.htm">Help</a></h4>

<p>
<a href="http://lglwww.epfl.ch/Ada/"><img src="la-icon.gif" alt="Ada WWW Home"></a>
 -- Email comments, additions, corrections, gripes, kudos, etc. to:
<address>
<a href="author.htm">Magnus Kempe</a>
 -- <a href="mailto:Magnus.Kempe@di.epfl.ch">Magnus.Kempe@di.epfl.ch</a><br>
<a href="cright.htm">Copyright statement</a><br>
Page last generated: 95-03-12
</address>
</body>
</html>
