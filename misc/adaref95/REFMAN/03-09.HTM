<html>
<head>
<title>Ada 95 RM - 3.9 Tagged Types and Type Extensions</title>
<link rev="made" href="mailto:Magnus.Kempe@di.epfl.ch">
</head>

<body>
<h4><a href="03-08.htm"><img src="left.gif" alt="Prev"></a> | <a href="03.htm"><img src="up.gif" alt="Up"></a> | <a href="03-10.htm"><img src="right.gif" alt="Next"></a> | <a href="03-08-01.htm"><img src="back.gif" alt="Back"></a> | <a href="03-09-01.htm"><img src="forward.gif" alt="Forward"></a><br>   <a href="toc.htm">TOC --</a> / <a href="toc-l1.htm">--.--</a> / <a href="toc-l2.htm">--.--.--</a> | <a href="index.htm">Index</a> | <a href="search.htm">Search</a> | <a href="syntax.htm">Syntax</a> | <a href="help.htm">Help</a></h4>

<hr>

<h2><a name="0">3.9 Tagged Types and Type Extensions</a>
 -- <a href="toc03-09.htm">TOC</a>
</h2>
<dl><dt><a name="1">(1)</a><dd>Tagged types and type extensions support object-oriented programming,
based on inheritance with extension and run-time polymorphism via dispatching
operations.
</dl><h5 align="center">Static Semantics</h5>
<dl><dt><a name="2">(2)</a><dd>A record type or private type that has the reserved word tagged in its
declaration is called a tagged type.  When deriving from a tagged type,
additional components may be defined.  As for any derived type, additional
primitive subprograms may be defined, and inherited primitive subprograms may
be overridden.  The derived type is called an extension of the ancestor type,
or simply a type extension.  Every type extension is also a tagged type, and
is either a record extension or a private extension of some other tagged
type.  A record extension is defined by a derived_type_definition with a
record_extension_part.  A private extension, which is a partial view of a
record extension, can be declared in the visible part of a package <a href="07-03.htm">(see 7.3)</a>
or in a generic formal part <a href="12-05-01.htm">(see 12.5.1)</a>.
<dt><a name="3">(3)</a><dd>An object of a tagged type has an associated (run-time) tag that
identifies the specific tagged type used to create the object originally.
The tag of an operand of a class-wide tagged type T'Class controls which
subprogram body is to be executed when a primitive subprogram of type T is
applied to the operand <a href="03-09-02.htm">(see 3.9.2)</a>; using a tag to control which body to
execute is called dispatching.
<dt><a name="4">(4)</a><dd>The tag of a specific tagged type identifies the full_type_declaration of
the type.  If a declaration for a tagged type occurs within a generic_package_declaration, then the corresponding type declarations in distinct
instances of the generic package are associated with distinct tags.  For a
tagged type that is local to a generic package body, the language does not
specify whether repeated instantiations of the generic body result in
distinct tags.
<dt><a name="5">(5)</a><dd>The following language-defined library package exists:
</dl><pre><a name="6">(6)</a>
       package Ada.Tags is
           type Tag is private;
<a name="7">(7)</a>
           function Expanded_Name(T : Tag) return String;
           function External_Tag(T : Tag) return String;
           function Internal_Tag(External : String) return Tag;
<a name="8">(8)</a>
           Tag_Error : exception;
<a name="9">(9)</a>
       private
          ... <em>-- not specified by the language</em>
       end Ada.Tags;
</pre><dl><dt><a name="10">(10)</a><dd>The function Expanded_Name returns the full expanded name of the first
subtype of the specific type identified by the tag, in upper case, starting
with a root library unit.  The result is implementation defined if the type
is declared within an unnamed block_statement.
<dt><a name="11">(11)</a><dd>The function External_Tag returns a string to be used in an external
representation for the given tag.  The call External_Tag(S'Tag) is equivalent
to the attribute_reference S'External_Tag <a href="13-03.htm">(see 13.3)</a>.
<dt><a name="12">(12)</a><dd>The function Internal_Tag returns the tag that corresponds to the given
external tag, or raises Tag_Error if the given string is not the external tag
for any specific type of the partition.
<dt><a name="13">(13)</a><dd>For every subtype S of a tagged type T (specific or class-wide), the
following attributes are defined:
<dt><a name="14">(14)</a><dd>S'Class
<ul>S'Class denotes a subtype of the class-wide type (called
T'Class in this International Standard) for the class rooted
at T (or if S already denotes a class-wide subtype, then
S'Class is the same as S).
</ul><dt><a name="15">(15)</a><dd><ul>S'Class is unconstrained.  However, if S is constrained,
then the values of S'Class are only those that when converted
to the type T belong to S.
</ul><dt><a name="16">(16)</a><dd>S'Tag
<ul>S'Tag denotes the tag of the type T (or if T is class-wide,
the tag of the root type of the corresponding class).  The
value of this attribute is of type Tag.
</ul><dt><a name="17">(17)</a><dd>Given a prefix X that is of a class-wide tagged type (after any implicit
dereference), the following attribute is defined:
<dt><a name="18">(18)</a><dd>X'Tag
<ul>X'Tag denotes the tag of X. The value of this attribute is of
type Tag.
</ul></dl><h5 align="center">Dynamic Semantics</h5>
<dl><dt><a name="19">(19)</a><dd>The tag associated with an object of a tagged type is determined as
follows:
<dt><a name="20">(20)</a><dd><ul><li>The tag of a stand-alone object, a component, or an aggregate of
a specific tagged type T identifies T.
</ul><dt><a name="21">(21)</a><dd><ul><li>The tag of an object created by an allocator for an access type
with a specific designated tagged type T, identifies T.
</ul><dt><a name="22">(22)</a><dd><ul><li>The tag of an object of a class-wide tagged type is that of its
initialization expression.
</ul><dt><a name="23">(23)</a><dd><ul><li>The tag of the result returned by a function whose result type is
a specific tagged type T identifies T.
</ul><dt><a name="24">(24)</a><dd><ul><li>The tag of the result returned by a function with a class-wide
result type is that of the return expression.
</ul><dt><a name="25">(25)</a><dd>The tag is preserved by type conversion and by parameter passing.  The
tag of a value is the tag of the associated object <a href="06-02.htm">(see 6.2)</a>.
</dl><h5 align="center">Implementation Permissions</h5>
<dl><dt><a name="26">(26)</a><dd>The implementation of the functions in Ada.Tags may raise Tag_Error if
no specific type corresponding to the tag passed as a parameter exists in the
partition at the time the function is called.
<p><dt><dd><ul>NOTES</ul>
<dt><a name="27">(27)</a><dd><ul>(62) A type declared with the reserved word tagged should normally be
declared in a package_specification, so that new primitive subprograms
can be declared for it.
</ul><dt><a name="28">(28)</a><dd><ul>(63) Once an object has been created, its tag never changes.
</ul><dt><a name="29">(29)</a><dd><ul>(64) Class-wide types are defined to have unknown discriminants <a href="03-07.htm">(see 3.7)</a>.  This means that objects of a class-wide type have to be
explicitly initialized (whether created by an object_declaration or an
allocator), and that aggregates have to be explicitly qualified with a
specific type when their expected type is class-wide.
</ul><dt><a name="30">(30)</a><dd><ul>(65) If S denotes an untagged private type whose full type is tagged,
then S'Class is also allowed before the full type definition, but only
in the private part of the package in which the type is declared <a href="07-03-01.htm">(see 7.3.1)</a>.  Similarly, the Class attribute is defined for incomplete types
whose full type is tagged, but only within the library unit in which the
incomplete type is declared <a href="03-10-01.htm">(see 3.10.1)</a>.
</ul></dl><h5 align="center">Examples</h5>
<dl><dt><a name="31">(31)</a><dd><em>Examples of tagged record types:
</em>
</dl><pre><a name="32">(32)</a>
       type Point is tagged
         record
           X, Y : Real := 0.0;
         end record;
<a name="33">(33)</a>
       type Expression is tagged null record;
         <em>-- Components will be added by each extension</em>
</pre><hr><h3>Subclauses</h3>
<ol>
<li><a href="03-09-01.htm">Type Extensions</a>
<li><a href="03-09-02.htm">Dispatching Operations of Tagged Types</a>
<li><a href="03-09-03.htm">Abstract Types and Subprograms</a>
</ol>
<p>
<hr>
<h4><a href="03-08.htm"><img src="left.gif" alt="Prev"></a> | <a href="03.htm"><img src="up.gif" alt="Up"></a> | <a href="03-10.htm"><img src="right.gif" alt="Next"></a> | <a href="03-08-01.htm"><img src="back.gif" alt="Back"></a> | <a href="03-09-01.htm"><img src="forward.gif" alt="Forward"></a><br>   <a href="toc.htm">TOC --</a> / <a href="toc-l1.htm">--.--</a> / <a href="toc-l2.htm">--.--.--</a> | <a href="index.htm">Index</a> | <a href="search.htm">Search</a> | <a href="syntax.htm">Syntax</a> | <a href="help.htm">Help</a></h4>

<p>
<a href="http://lglwww.epfl.ch/Ada/"><img src="la-icon.gif" alt="Ada WWW Home"></a>
 -- Email comments, additions, corrections, gripes, kudos, etc. to:
<address>
<a href="author.htm">Magnus Kempe</a>
 -- <a href="mailto:Magnus.Kempe@di.epfl.ch">Magnus.Kempe@di.epfl.ch</a><br>
<a href="cright.htm">Copyright statement</a><br>
Page last generated: 95-03-12
</address>
</body>
</html>
