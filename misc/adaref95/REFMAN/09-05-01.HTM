<html>
<head>
<title>Ada 95 RM - 9.5.1 Protected Subprograms and Protected Actions</title>
<link rev="made" href="mailto:Magnus.Kempe@di.epfl.ch">
</head>

<body>
<h4><img src="noleft.gif" alt="____"> | <a href="09-05.htm"><img src="up.gif" alt="Up"></a> | <a href="09-05-02.htm"><img src="right.gif" alt="Next"></a> | <a href="09-05.htm"><img src="back.gif" alt="Back"></a> | <a href="09-05-02.htm"><img src="forward.gif" alt="Forward"></a><br>   <a href="toc.htm">TOC --</a> / <a href="toc-l1.htm">--.--</a> / <a href="toc-l2.htm">--.--.--</a> | <a href="index.htm">Index</a> | <a href="search.htm">Search</a> | <a href="syntax.htm">Syntax</a> | <a href="help.htm">Help</a></h4>

<hr>
<h3><a name="0">9.5.1 Protected Subprograms and Protected Actions</a></h3>
<dl><dt><a name="1">(1)</a><dd>A protected subprogram is a subprogram declared immediately within a
protected_definition.  Protected procedures provide exclusive read-write
access to the data of a protected object; protected functions provide
concurrent read-only access to the data.
</dl><h5 align="center">Static Semantics</h5>
<dl><dt><a name="2">(2)</a><dd>Within the body of a protected function (or a function declared
immediately within a protected_body), the current instance of the enclosing
protected unit is defined to be a constant (that is, its subcomponents may be
read but not updated).  Within the body of a protected procedure (or a
procedure declared immediately within a protected_body), and within an entry_body, the current instance is defined to be a variable (updating is
permitted).
</dl><h5 align="center">Dynamic Semantics</h5>
<dl><dt><a name="3">(3)</a><dd>For the execution of a call on a protected subprogram, the evaluation of
the name or prefix and of the parameter associations, and any assigning back
of in out or out parameters, proceeds as for a normal subprogram call <a href="06-04.htm">(see 6.4)</a>.  If the call is an internal call <a href="09-05.htm">(see 9.5)</a>, the body of the subprogram
is executed as for a normal subprogram call.  If the call is an external
call, then the body of the subprogram is executed as part of a new protected
action on the target protected object; the protected action completes after
the body of the subprogram is executed.  A protected action can also be
started by an entry call <a href="09-05-03.htm">(see 9.5.3)</a>.
<dt><a name="4">(4)</a><dd>A new protected action is not started on a protected object while another
protected action on the same protected object is underway, unless both
actions are the result of a call on a protected function.  This rule is
expressible in terms of the execution resource associated with the protected
object:
<dt><a name="5">(5)</a><dd><ul><li>Starting a protected action on a protected object corresponds to
acquiring the execution resource associated with the protected
object, either for concurrent read-only access if the protected
action is for a call on a protected function, or for exclusive
read-write access otherwise;
</ul><dt><a name="6">(6)</a><dd><ul><li>Completing the protected action corresponds to releasing the
associated execution resource.
</ul><dt><a name="7">(7)</a><dd>After performing an operation on a protected object other than a call on
a protected function, but prior to completing the associated protected
action, the entry queues (if any) of the protected object are serviced <a href="09-05-03.htm">(see 9.5.3)</a>.
</dl><h5 align="center">Bounded (Run-Time) Errors</h5>
<dl><dt><a name="8">(8)</a><dd>During a protected action, it is a bounded error to invoke an operation
that is potentially blocking.  The following are defined to be potentially
blocking operations:
<dt><a name="9">(9)</a><dd><ul><li>a select_statement;
</ul><dt><a name="10">(10)</a><dd><ul><li>an accept_statement;
</ul><dt><a name="11">(11)</a><dd><ul><li>an entry_call_statement;
</ul><dt><a name="12">(12)</a><dd><ul><li>a delay_statement;
</ul><dt><a name="13">(13)</a><dd><ul><li>an abort_statement;
</ul><dt><a name="14">(14)</a><dd><ul><li>task creation or activation;
</ul><dt><a name="15">(15)</a><dd><ul><li>an external call on a protected subprogram (or an external
requeue) with the same target object as that of the protected
action;
</ul><dt><a name="16">(16)</a><dd><ul><li>a call on a subprogram whose body contains a potentially blocking
operation.
</ul><dt><a name="17">(17)</a><dd>If the bounded error is detected, Program_Error is raised.  If not
detected, the bounded error might result in deadlock or a (nested) protected
action on the same target object.
<dt><a name="18">(18)</a><dd>Certain language-defined subprograms are potentially blocking.  In
particular, the subprograms of the language-defined input-output packages
that manipulate files (implicitly or explicitly) are potentially blocking.
Other potentially blocking subprograms are identified where they are defined.
When not specified as potentially blocking, a language-defined subprogram is
nonblocking.
<p><dt><dd><ul>NOTES</ul>
<dt><a name="19">(19)</a><dd><ul>(18) If two tasks both try to start a protected action on a protected
object, and at most one is calling a protected function, then only one
of the tasks can proceed.  Although the other task cannot proceed, it is
not considered blocked, and it might be consuming processing resources
while it awaits its turn.  There is no language-defined ordering or
queuing presumed for tasks competing to start a protected action -- on a
multiprocessor such tasks might use busy-waiting; for monoprocessor
considerations, <a href="D-03.htm">see D.3</a>, ``Priority Ceiling Locking''.
</ul><dt><a name="20">(20)</a><dd><ul>(19) The body of a protected unit may contain declarations and bodies
for local subprograms.  These are not visible outside the protected
unit.
</ul><dt><a name="21">(21)</a><dd><ul>(20) The body of a protected function can contain internal calls on
other protected functions, but not protected procedures, because the
current instance is a constant.  On the other hand, the body of a
protected procedure can contain internal calls on both protected
functions and procedures.
</ul><dt><a name="22">(22)</a><dd><ul>(21) From within a protected action, an internal call on a protected
subprogram, or an external call on a protected subprogram with a
different target object is not considered a potentially blocking
operation.
</ul></dl><h5 align="center">Examples</h5>
<dl><dt><a name="23">(23)</a><dd><em>Examples of protected subprogram calls <a href="09-04.htm">(see 9.4)</a>:
</em>
</dl><pre><a name="24">(24)</a>
       Shared_Array.Set_Component(N, E);
       E := Shared_Array.Component(M);
       Control.Release;
</pre><hr>
<h4><img src="noleft.gif" alt="____"> | <a href="09-05.htm"><img src="up.gif" alt="Up"></a> | <a href="09-05-02.htm"><img src="right.gif" alt="Next"></a> | <a href="09-05.htm"><img src="back.gif" alt="Back"></a> | <a href="09-05-02.htm"><img src="forward.gif" alt="Forward"></a><br>   <a href="toc.htm">TOC --</a> / <a href="toc-l1.htm">--.--</a> / <a href="toc-l2.htm">--.--.--</a> | <a href="index.htm">Index</a> | <a href="search.htm">Search</a> | <a href="syntax.htm">Syntax</a> | <a href="help.htm">Help</a></h4>

<p>
<a href="http://lglwww.epfl.ch/Ada/"><img src="la-icon.gif" alt="Ada WWW Home"></a>
 -- Email comments, additions, corrections, gripes, kudos, etc. to:
<address>
<a href="author.htm">Magnus Kempe</a>
 -- <a href="mailto:Magnus.Kempe@di.epfl.ch">Magnus.Kempe@di.epfl.ch</a><br>
<a href="cright.htm">Copyright statement</a><br>
Page last generated: 95-03-12
</address>
</body>
</html>
