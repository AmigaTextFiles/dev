<html>
<head>
<title>Ada 95 RM - 9.7.1 Selective Accept</title>
<link rev="made" href="mailto:Magnus.Kempe@di.epfl.ch">
</head>

<body>
<h4><img src="noleft.gif" alt="____"> | <a href="09-07.htm"><img src="up.gif" alt="Up"></a> | <a href="09-07-02.htm"><img src="right.gif" alt="Next"></a> | <a href="09-07.htm"><img src="back.gif" alt="Back"></a> | <a href="09-07-02.htm"><img src="forward.gif" alt="Forward"></a><br>   <a href="toc.htm">TOC --</a> / <a href="toc-l1.htm">--.--</a> / <a href="toc-l2.htm">--.--.--</a> | <a href="index.htm">Index</a> | <a href="search.htm">Search</a> | <a href="syntax.htm">Syntax</a> | <a href="help.htm">Help</a></h4>

<hr>
<h3><a name="0">9.7.1 Selective Accept</a></h3>
<dl><dt><a name="1">(1)</a><dd>This form of the select_statement allows a combination of waiting for,
and selecting from, one or more alternatives.  The selection may depend on
conditions associated with each alternative of the selective_accept.
</dl><h5 align="center"><a name="syntax">Syntax</a></h5>
<pre><a name="2">(2)</a>
       selective_accept ::=
         select
          [guard]
            select_alternative
       { or
          [guard]
            select_alternative }
       [ else
          sequence_of_statements ]
         end select;
<a name="3">(3)</a>
       guard ::= when condition =&gt;
<a name="4">(4)</a>
       select_alternative ::=
          accept_alternative
         | delay_alternative
         | terminate_alternative
<a name="5">(5)</a>
       accept_alternative ::=
         accept_statement [sequence_of_statements]
<a name="6">(6)</a>
       delay_alternative ::=
         delay_statement [sequence_of_statements]
<a name="7">(7)</a>
       terminate_alternative ::= terminate;
</pre><dl><dt><a name="8">(8)</a><dd><ul><li>A selective_accept shall contain at least one accept_alternative.  In
addition, it can contain:
</ul><dt><a name="9">(9)</a><dd><ul><ul><li>a terminate_alternative (only one); or
</ul></ul>10  one or more delay_alternatives; or
11  an else part (the reserved word else followed by a
sequence_of_statements).
<dt><a name="12">(12)</a><dd><ul>These three possibilities are mutually exclusive.
</ul></dl><h5 align="center">Legality Rules</h5>
<dl><dt><a name="13">(13)</a><dd>If a selective_accept contains more than one delay_alternative, then all
shall be delay_relative_statements, or all shall be delay_until_statements
for the same time type.
</dl><h5 align="center">Dynamic Semantics</h5>
<dl><dt><a name="14">(14)</a><dd>A select_alternative is said to be open if it is not immediately
preceded by a guard, or if the condition of its guard evaluates to True.  It
is said to be closed otherwise.
<dt><a name="15">(15)</a><dd>For the execution of a selective_accept, any guard conditions are
evaluated; open alternatives are thus determined.  For an open delay_alternative, the delay_expression is also evaluated.  Similarly, for an open
accept_alternative for an entry of a family, the entry_index is also
evaluated.  These evaluations are performed in an arbitrary order, except
that a delay_expression or entry_index is not evaluated until after
evaluating the corresponding condition, if any.  Selection and execution of
one open alternative, or of the else part, then completes the execution of
the selective_accept; the rules for this selection are described below.
<dt><a name="16">(16)</a><dd>Open accept_alternatives are first considered.  Selection of one such
alternative takes place immediately if the corresponding entry already has
queued calls.  If several alternatives can thus be selected, one of them is
selected according to the entry queuing policy in effect <a href="09-05-03.htm">(see 9.5.3</a> and <a href="D-04.htm">D.4)</a>.
When such an alternative is selected, the selected call is removed from its
entry queue and the handled_sequence_of_statements (if any) of the
corresponding accept_statement is executed; after the rendezvous completes
any subsequent sequence_of_statements of the alternative is executed.  If no
selection is immediately possible (in the above sense) and there is no else
part, the task blocks until an open alternative can be selected.
<dt><a name="17">(17)</a><dd>Selection of the other forms of alternative or of an else part is
performed as follows:
<dt><a name="18">(18)</a><dd><ul><li>An open delay_alternative is selected when its expiration time is
reached if no accept_alternative or other delay_alternative can
be selected prior to the expiration time.  If several delay_alternatives have this same expiration time, one of them is
selected according to the queuing policy in effect <a href="D-04.htm">(see D.4)</a>; the
default queuing policy chooses arbitrarily among the delay_alternatives whose expiration time has passed.
</ul><dt><a name="19">(19)</a><dd><ul><li>The else part is selected and its sequence_of_statements is
executed if no accept_alternative can immediately be selected; in
particular, if all alternatives are closed.
</ul><dt><a name="20">(20)</a><dd><ul><li>An open terminate_alternative is selected if the conditions
stated at the end of <a href="09-03.htm">clause 9.3</a> are satisfied.
</ul><dt><a name="21">(21)</a><dd>The exception Program_Error is raised if all alternatives are closed and
there is no else part.
<p><dt><dd><ul>NOTES</ul>
<dt><a name="22">(22)</a><dd><ul>(36) A selective_accept is allowed to have several open delay_alternatives.  A selective_accept is allowed to have several open
accept_alternatives for the same entry.
</ul></dl><h5 align="center">Examples</h5>
<dl><dt><a name="23">(23)</a><dd><em>Example of a task body with a selective accept:
</em>
</dl><pre><a name="24">(24)</a>
       task body Server is
          Current_Work_Item : Work_Item;
       begin
          loop
             select
                accept Next_Work_Item(WI : in Work_Item) do
                   Current_Work_Item := WI;
                 end;
                 Process_Work_Item(Current_Work_Item);
             or
                accept Shut_Down;
                exit;       <em>-- Premature shut down requested</em>
             or
                terminate;  <em>-- Normal shutdown at end of scope</em>
             end select;
          end loop;
       end Server;
</pre><hr>
<h4><img src="noleft.gif" alt="____"> | <a href="09-07.htm"><img src="up.gif" alt="Up"></a> | <a href="09-07-02.htm"><img src="right.gif" alt="Next"></a> | <a href="09-07.htm"><img src="back.gif" alt="Back"></a> | <a href="09-07-02.htm"><img src="forward.gif" alt="Forward"></a><br>   <a href="toc.htm">TOC --</a> / <a href="toc-l1.htm">--.--</a> / <a href="toc-l2.htm">--.--.--</a> | <a href="index.htm">Index</a> | <a href="search.htm">Search</a> | <a href="syntax.htm">Syntax</a> | <a href="help.htm">Help</a></h4>

<p>
<a href="http://lglwww.epfl.ch/Ada/"><img src="la-icon.gif" alt="Ada WWW Home"></a>
 -- Email comments, additions, corrections, gripes, kudos, etc. to:
<address>
<a href="author.htm">Magnus Kempe</a>
 -- <a href="mailto:Magnus.Kempe@di.epfl.ch">Magnus.Kempe@di.epfl.ch</a><br>
<a href="cright.htm">Copyright statement</a><br>
Page last generated: 95-03-12
</address>
</body>
</html>
