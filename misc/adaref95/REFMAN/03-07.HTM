<html>
<head>
<title>Ada 95 RM - 3.7 Discriminants</title>
<link rev="made" href="mailto:Magnus.Kempe@di.epfl.ch">
</head>

<body>
<h4><a href="03-06.htm"><img src="left.gif" alt="Prev"></a> | <a href="03.htm"><img src="up.gif" alt="Up"></a> | <a href="03-08.htm"><img src="right.gif" alt="Next"></a> | <a href="03-06-03.htm"><img src="back.gif" alt="Back"></a> | <a href="03-07-01.htm"><img src="forward.gif" alt="Forward"></a><br>   <a href="toc.htm">TOC --</a> / <a href="toc-l1.htm">--.--</a> / <a href="toc-l2.htm">--.--.--</a> | <a href="index.htm">Index</a> | <a href="search.htm">Search</a> | <a href="syntax.htm">Syntax</a> | <a href="help.htm">Help</a></h4>

<hr>

<h2><a name="0">3.7 Discriminants</a>
 -- <a href="toc03-07.htm">TOC</a>
</h2>
<dl><dt><a name="1">(1)</a><dd>A composite type (other than an array type) can have discriminants, which
parameterize the type.  A known_discriminant_part specifies the discriminants
of a composite type.  A discriminant of an object is a component of the
object, and is either of a discrete type or an access type.  An unknown_discriminant_part in the declaration of a partial view of a type specifies
that the discriminants of the type are unknown for the given view; all
subtypes of such a partial view are indefinite subtypes.
</dl><h5 align="center"><a name="syntax">Syntax</a></h5>
<pre><a name="2">(2)</a>
       discriminant_part ::= unknown_discriminant_part | known_discriminant_part
<a name="3">(3)</a>
       unknown_discriminant_part ::= (&lt;&gt;)
<a name="4">(4)</a>
       known_discriminant_part ::=
          (discriminant_specification {; discriminant_specification})
<a name="5">(5)</a>
       discriminant_specification ::=
          defining_identifier_list : subtype_mark [:= default_expression]
        | defining_identifier_list : access_definition [:= default_expression]
<a name="6">(6)</a>
       default_expression ::= expression
</pre><h5 align="center">Name Resolution Rules</h5>
<dl><dt><a name="7">(7)</a><dd>The expected type for the default_expression of a discriminant_specification is that of the corresponding discriminant.
</dl><h5 align="center">Legality Rules</h5>
<dl><dt><a name="8">(8)</a><dd>A known_discriminant_part is only permitted in a declaration for a
composite type that is not an array type (this includes generic formal
types); a type declared with a known_discriminant_part is called a
discriminated type, as is a type that inherits (known) discriminants.
<dt><a name="9">(9)</a><dd>The subtype of a discriminant may be defined by a subtype_mark, in which
case the subtype_mark shall denote a discrete or access subtype, or it may be
defined by an access_definition (in which case the subtype_mark of the
access_definition may denote any kind of subtype).  A discriminant that is
defined by an access_definition is called an access discriminant and is of an
anonymous general access-to-variable type whose designated subtype is denoted
by the subtype_mark of the access_definition.
<dt><a name="10">(10)</a><dd>A discriminant_specification for an access discriminant shall appear
only in the declaration for a task or protected type, or for a type with the
reserved word limited in its (full) definition or in that of one of its
ancestors.  In addition to the places where Legality Rules normally apply
<a href="12-03.htm">(see 12.3)</a>, this rule applies also in the private part of an instance of a
generic unit.
<dt><a name="11">(11)</a><dd>Default_expressions shall be provided either for all or for none of the
discriminants of a known_discriminant_part.  No default_expressions are
permitted in a known_discriminant_part in a declaration of a tagged type or a
generic formal type.
<dt><a name="12">(12)</a><dd>For a type defined by a derived_type_definition, if a known_discriminant_part is provided in its declaration, then:
<dt><a name="13">(13)</a><dd><ul><li>The parent subtype shall be constrained;
</ul><dt><a name="14">(14)</a><dd><ul><li>If the parent type is not a tagged type, then each discriminant
of the derived type shall be used in the constraint defining the
parent subtype;
</ul><dt><a name="15">(15)</a><dd><ul><li>If a discriminant is used in the constraint defining the parent
subtype, the subtype of the discriminant shall be statically
compatible <a href="04-09-01.htm">(see 4.9.1)</a> with the subtype of the corresponding
parent discriminant.
</ul><dt><a name="16">(16)</a><dd>The type of the default_expression, if any, for an access discriminant
shall be convertible to the anonymous access type of the discriminant <a href="04-06.htm">(see 4.6)</a>.
</dl><h5 align="center">Static Semantics</h5>
<dl><dt><a name="17">(17)</a><dd>A discriminant_specification declares a discriminant; the subtype_mark
denotes its subtype unless it is an access discriminant, in which case the
discriminant's subtype is the anonymous access-to-variable subtype defined by
the access_definition.
<dt><a name="18">(18)</a><dd>For a type defined by a derived_type_definition, each discriminant of
the parent type is either inherited, constrained to equal some new
discriminant of the derived type, or constrained to the value of an
expression.  When inherited or constrained to equal some new discriminant,
the parent discriminant and the discriminant of the derived type are said to
correspond.  Two discriminants also correspond if there is some common
discriminant to which they both correspond.  A discriminant corresponds to
itself as well.  If a discriminant of a parent type is constrained to a
specific value by a derived_type_definition, then that discriminant is said
to be specified by that derived_type_definition.
<dt><a name="19">(19)</a><dd>A constraint that appears within the definition of a discriminated type
depends on a discriminant of the type if it names the discriminant as a bound
or discriminant value.  A component_definition depends on a discriminant if
its constraint depends on the discriminant, or on a discriminant that
corresponds to it.
<dt><a name="20">(20)</a><dd>A component depends on a discriminant if:
<dt><a name="21">(21)</a><dd><ul><li>Its component_definition depends on the discriminant; or
</ul><dt><a name="22">(22)</a><dd><ul><li>It is declared in a variant_part that is governed by the
discriminant; or
</ul><dt><a name="23">(23)</a><dd><ul><li>It is a component inherited as part of a derived_type_definition,
and the constraint of the parent_subtype_indication depends on
the discriminant; or
</ul><dt><a name="24">(24)</a><dd><ul><li>It is a subcomponent of a component that depends on the
discriminant.
</ul><dt><a name="25">(25)</a><dd>Each value of a discriminated type includes a value for each component
of the type that does not depend on a discriminant; this includes the
discriminants themselves.  The values of discriminants determine which other
component values are present in the value of the discriminated type.
<dt><a name="26">(26)</a><dd>A type declared with a known_discriminant_part is said to have known
discriminants; its first subtype is unconstrained.  A type declared with an
unknown_discriminant_part is said to have unknown discriminants.  A type
declared without a discriminant_part has no discriminants, unless it is a
derived type; if derived, such a type has the same sort of discriminants
(known, unknown, or none) as its parent (or ancestor) type.  A tagged
class-wide type also has unknown discriminants.  Any subtype of a type with
unknown discriminants is an unconstrained and indefinite subtype <a href="03-02.htm">(see 3.2</a> and
3.3).
</dl><h5 align="center">Dynamic Semantics</h5>
<dl><dt><a name="27">(27)</a><dd>An access_definition is elaborated when the value of a corresponding
access discriminant is defined, either by evaluation of its default_expression or by elaboration of a discriminant_constraint.  The elaboration
of an access_definition creates the anonymous access type.  When the
expression defining the access discriminant is evaluated, it is converted to
this anonymous access type <a href="04-06.htm">(see 4.6)</a>.
<p><dt><dd><ul>NOTES</ul>
<dt><a name="28">(28)</a><dd><ul>(50) If a discriminated type has default_expressions for its
discriminants, then unconstrained variables of the type are permitted,
and the values of the discriminants can be changed by an assignment to
such a variable.  If defaults are not provided for the discriminants,
then all variables of the type are constrained, either by explicit
constraint or by their initial value; the values of the discriminants of
such a variable cannot be changed after initialization.
</ul><dt><a name="29">(29)</a><dd><ul>(51) The default_expression for a discriminant of a type is evaluated
when an object of an unconstrained subtype of the type is created.
</ul><dt><a name="30">(30)</a><dd><ul>(52) Assignment to a discriminant of an object (after its
initialization) is not allowed, since the name of a discriminant is a
constant; neither assignment_statements nor assignments inherent in
passing as an in out or out parameter are allowed.  Note however that
the value of a discriminant can be changed by assigning to the enclosing
object, presuming it is an unconstrained variable.
</ul><dt><a name="31">(31)</a><dd><ul>(53) A discriminant that is of a named access type is not called an
access discriminant; that term is used only for discriminants defined by
an access_definition.
</ul></dl><h5 align="center">Examples</h5>
<dl><dt><a name="32">(32)</a><dd><em>Examples of discriminated types:
</em>
</dl><pre><a name="33">(33)</a>
       type Buffer(Size : Buffer_Size := 100)  is        <em>-- <a href="03-05-04.htm">see 3.5.4</a></em>
          record
             Pos   : Buffer_Size := 0;
             Value : String(1 .. Size);
          end record;
<a name="34">(34)</a>
       type Matrix_Rec(Rows, Columns : Integer) is
          record
             Mat : Matrix(1 .. Rows, 1 .. Columns);       <em>-- <a href="03-06.htm">see 3.6</a></em>
          end record;
<a name="35">(35)</a>
       type Square(Side : Integer) is new Matrix_Rec(Rows =&gt; Side, Columns =&gt; Side);
<a name="36">(36)</a>
       type Double_Square(Number : Integer) is
          record
             Left  : Square(Number);
             Right : Square(Number);
          end record;
<a name="37">(37)</a>
       type Item(Number : Positive) is
          record
             Content : Integer;
             <em>--  no component depends on the discriminant</em>
          end record;
</pre><hr><h3>Subclauses</h3>
<ol>
<li><a href="03-07-01.htm">Discriminant Constraints</a>
<li><a href="03-07-02.htm">Operations of Discriminated Types</a>
</ol>
<p>
<hr>
<h4><a href="03-06.htm"><img src="left.gif" alt="Prev"></a> | <a href="03.htm"><img src="up.gif" alt="Up"></a> | <a href="03-08.htm"><img src="right.gif" alt="Next"></a> | <a href="03-06-03.htm"><img src="back.gif" alt="Back"></a> | <a href="03-07-01.htm"><img src="forward.gif" alt="Forward"></a><br>   <a href="toc.htm">TOC --</a> / <a href="toc-l1.htm">--.--</a> / <a href="toc-l2.htm">--.--.--</a> | <a href="index.htm">Index</a> | <a href="search.htm">Search</a> | <a href="syntax.htm">Syntax</a> | <a href="help.htm">Help</a></h4>

<p>
<a href="http://lglwww.epfl.ch/Ada/"><img src="la-icon.gif" alt="Ada WWW Home"></a>
 -- Email comments, additions, corrections, gripes, kudos, etc. to:
<address>
<a href="author.htm">Magnus Kempe</a>
 -- <a href="mailto:Magnus.Kempe@di.epfl.ch">Magnus.Kempe@di.epfl.ch</a><br>
<a href="cright.htm">Copyright statement</a><br>
Page last generated: 95-03-12
</address>
</body>
</html>
