<html>
<head>
<title>Ada 95 RM - D.5 Dynamic Priorities</title>
<link rev="made" href="mailto:Magnus.Kempe@di.epfl.ch">
</head>

<body>
<h4><a href="D-04.htm"><img src="left.gif" alt="Prev"></a> | <a href="D.htm"><img src="up.gif" alt="Up"></a> | <a href="D-06.htm"><img src="right.gif" alt="Next"></a> | <a href="D-04.htm"><img src="back.gif" alt="Back"></a> | <a href="D-06.htm"><img src="forward.gif" alt="Forward"></a><br>   <a href="toc.htm">TOC --</a> / <a href="toc-l1.htm">--.--</a> / <a href="toc-l2.htm">--.--.--</a> | <a href="index.htm">Index</a> | <a href="search.htm">Search</a> | <a href="syntax.htm">Syntax</a> | <a href="help.htm">Help</a></h4>

<hr>

<h2><a name="0">D.5 Dynamic Priorities</a></h2>
<dl><dt><a name="1">(1)</a><dd>This clause specifies how the base priority of a task can be modified or
queried at run time.
</dl><h5 align="center">Static Semantics</h5>
<dl><dt><a name="2">(2)</a><dd>The following language-defined library package exists:
</dl><pre><a name="3">(3)</a>
       with System;
       with Ada.Task_Identification; <em>-- <a href="C-07-01.htm">See C.7.1</a></em>
       package Ada.Dynamic_Priorities is
<a name="4">(4)</a>
           procedure Set_Priority(Priority : in System.Any_Priority;
                                               T : in Ada.Task_Identification.Task_ID :=
                                               Ada.Task_Identification.Current_Task);
<a name="5">(5)</a>
           function Get_Priority (T : Ada.Task_Identification.Task_ID :=
                                               Ada.Task_Identification.Current_Task)
                                               return System.Any_Priority;
<a name="6">(6)</a>
       end Ada.Dynamic_Priorities;
</pre><h5 align="center">Dynamic Semantics</h5>
<dl><dt><a name="7">(7)</a><dd>The procedure Set_Priority sets the base priority of the specified task
to the specified Priority value.  Set_Priority has no effect if the task is
terminated.
<dt><a name="8">(8)</a><dd>The function Get_Priority returns T's current base priority.  Tasking_Error is raised if the task is terminated.
<dt><a name="9">(9)</a><dd>Program_Error is raised by Set_Priority and Get_Priority if T is equal to
Null_Task_ID.
<dt><a name="10">(10)</a><dd>Setting the task's base priority to the new value takes place as soon as
is practical but not while the task is performing a protected action.  This
setting occurs no later then the next abort completion point of the task T
<a href="09-08.htm">(see 9.8)</a>.
</dl><h5 align="center">Bounded (Run-Time) Errors</h5>
<dl><dt><a name="11">(11)</a><dd>If a task is blocked on a protected entry call, and the call is queued,
it is a bounded error to raise its base priority above the ceiling priority
of the corresponding protected object.  When an entry call is cancelled, it
is a bounded error if the priority of the calling task is higher than the
ceiling priority of the corresponding protected object.  In either of these
cases, either Program_Error is raised in the task that called the entry, or
its priority is temporarily lowered, or both, or neither.
</dl><h5 align="center">Erroneous Execution</h5>
<dl><dt><a name="12">(12)</a><dd>If any subprogram in this package is called with a parameter T that
specifies a task object that no longer exists, the execution of the program
is erroneous.
</dl><h5 align="center">Metrics</h5>
<dl><dt><a name="13">(13)</a><dd>The implementation shall document the following metric:
<dt><a name="14">(14)</a><dd><ul><li>The execution time of a call to Set_Priority, for the
nonpreempting case, in processor clock cycles.  This is measured
for a call that modifies the priority of a ready task that is not
running (which cannot be the calling one), where the new base
priority of the affected task is lower than the active priority
of the calling task, and the affected task is not on any entry
queue and is not executing a protected operation.
</ul><p><dt><dd><ul>NOTES</ul>
<dt><a name="15">(15)</a><dd><ul>(22) Setting a task's base priority affects task dispatching.  First, it
can change the task's active priority.  Second, under the standard task
dispatching policy it always causes the task to move to the tail of the
ready queue corresponding to its active priority, even if the new base
priority is unchanged.
</ul><dt><a name="16">(16)</a><dd><ul>(23) Under the priority queuing policy, setting a task's base priority
has an effect on a queued entry call if the task is blocked waiting for
the call.  That is, setting the base priority of a task causes the
priority of a queued entry call from that task to be updated and the
call to be removed and then reinserted in the entry queue at the new
priority <a href="D-04.htm">(see D.4)</a>, unless the call originated from the triggering_statement of an asynchronous_select.
</ul><dt><a name="17">(17)</a><dd><ul>(24) The effect of two or more Set_Priority calls executed in parallel
on the same task is defined as executing these calls in some serial
order.
</ul><dt><a name="18">(18)</a><dd><ul>(25) The rule for when Tasking_Error is raised for Set_Priority or Get_Priority is different from the rule for when Tasking_Error is raised on
an entry call <a href="09-05-03.htm">(see 9.5.3)</a>.  In particular, setting or querying the
priority of a completed or an abnormal task is allowed, so long as the
task is not yet terminated.
</ul><dt><a name="19">(19)</a><dd><ul>(26) Changing the priorities of a set of tasks can be performed by a
series of calls to Set_Priority for each task separately.  For this to
work reliably, it should be done within a protected operation that has
high enough ceiling priority to guarantee that the operation completes
without being preempted by any of the affected tasks.
</ul></dl><p>
<hr>
<h4><a href="D-04.htm"><img src="left.gif" alt="Prev"></a> | <a href="D.htm"><img src="up.gif" alt="Up"></a> | <a href="D-06.htm"><img src="right.gif" alt="Next"></a> | <a href="D-04.htm"><img src="back.gif" alt="Back"></a> | <a href="D-06.htm"><img src="forward.gif" alt="Forward"></a><br>   <a href="toc.htm">TOC --</a> / <a href="toc-l1.htm">--.--</a> / <a href="toc-l2.htm">--.--.--</a> | <a href="index.htm">Index</a> | <a href="search.htm">Search</a> | <a href="syntax.htm">Syntax</a> | <a href="help.htm">Help</a></h4>

<p>
<a href="http://lglwww.epfl.ch/Ada/"><img src="la-icon.gif" alt="Ada WWW Home"></a>
 -- Email comments, additions, corrections, gripes, kudos, etc. to:
<address>
<a href="author.htm">Magnus Kempe</a>
 -- <a href="mailto:Magnus.Kempe@di.epfl.ch">Magnus.Kempe@di.epfl.ch</a><br>
<a href="cright.htm">Copyright statement</a><br>
Page last generated: 95-03-12
</address>
</body>
</html>
