<html>
<head>
<title>Ada 95 RM - G.2.6 Accuracy Requirements for Complex Arithmetic</title>
<link rev="made" href="mailto:Magnus.Kempe@di.epfl.ch">
</head>

<body>
<h4><a href="G-02-05.htm"><img src="left.gif" alt="Prev"></a> | <a href="G-02.htm"><img src="up.gif" alt="Up"></a> | <img src="noright.gif" alt="____"> | <a href="G-02-05.htm"><img src="back.gif" alt="Back"></a> | <a href="H.htm"><img src="forward.gif" alt="Forward"></a><br>   <a href="toc.htm">TOC --</a> / <a href="toc-l1.htm">--.--</a> / <a href="toc-l2.htm">--.--.--</a> | <a href="index.htm">Index</a> | <a href="search.htm">Search</a> | <a href="syntax.htm">Syntax</a> | <a href="help.htm">Help</a></h4>

<hr>
<h3><a name="0">G.2.6 Accuracy Requirements for Complex Arithmetic</a></h3>
<dl><dt><a name="1">(1)</a><dd>In the strict mode, the performance of Numerics.Generic_Complex_Types and
Numerics.Generic_Complex_Elementary_Functions shall be as specified here.
</dl><h5 align="center">Implementation Requirements</h5>
<dl><dt><a name="2">(2)</a><dd>When an exception is not raised, the result of evaluating a real function
of an instance CT of Numerics.Generic_Complex_Types (i.e., a function that
yields a value of subtype CT.Real'Base or CT.Imaginary) belongs to a result
interval defined as for a real elementary function <a href="G-02-04.htm">(see G.2.4)</a>.
<dt><a name="3">(3)</a><dd>When an exception is not raised, each component of the result of
evaluating a complex function of such an instance, or of an instance of
Numerics.Generic_Complex_Elementary_Functions obtained by instantiating the
latter with CT (i.e., a function that yields a value of subtype CT.Complex),
also belongs to a result interval.  The result intervals for the components
of the result are either defined by a maximum relative error bound or by a
maximum box error bound.  When the result interval for the real (resp.,
imaginary) component is defined by maximum relative error, it is defined as
for that of a real function, relative to the exact value of the real (resp.,
imaginary) part of the result of the corresponding mathematical function.
When defined by maximum box error, the result interval for a component of the
result is the smallest model interval of CT.Real that contains all the values
of the corresponding part of f*(1.0+d), where f is the exact complex value of
the corresponding mathematical function at the given parameter values, d is
complex, and |d| is less than or equal to the given maximum box error.  The
function delivers a value that belongs to the result interval (or a value
both of whose components belong to their respective result intervals) when
both bounds of the result interval(s) belong to the safe range of CT.Real;
otherwise,
<dt><a name="4">(4)</a><dd><ul><li>if CT.Real'Machine_Overflows is True, the function either
delivers a value that belongs to the result interval (or a value
both of whose components belong to their respective result
intervals) or raises Constraint_Error, signaling overflow;
</ul><dt><a name="5">(5)</a><dd><ul><li>if CT.Real'Machine_Overflows is False, the result is implementation defined.
</ul><dt><a name="6">(6)</a><dd>The error bounds for particular complex functions are tabulated below.
In the table, the error bound is given as the coefficient of CT.Real'Model_Epsilon.
</dl><pre><a name="7">(7)</a>
    <em>---------------------------------------------------------------------------</em>
    |                                                                         |
    |              Error Bounds for Particular Complex Functions              |
    |                                                                         |
    |<em>------------------------------------------------------------------------ |</em>
    |                             |           |                 |             |
    |                             | Nature of |    Nature of    |             |
    |    Function or Operator     |  Result   |      Bound      | Error Bound |
    |                             |           |                 |             |
    |<em>-------------------------------------------------------------------------|</em>
    |                             |           |                 |             |
    |           Modulus           |   real    | max. rel. error |     3.0     |
    |                             |           |                 |             |
    |          Argument           |   real    | max. rel. error |     4.0     |
    |                             |           |                 |             |
    |     Compose_From_Polar      |  complex  | max. rel. error |     3.0     |
    |                             |           |                 |             |
    | "*" (both operands complex) |  complex  | max. box error  |     5.0     |
    |                             |           |                 |             |
    | "/" (right operand complex) |  complex  | max. box error  |    13.0     |
    |                             |           |                 |             |
    |            Sqrt             |  complex  | max. rel. error |     6.0     |
    |                             |           |                 |             |
    |             Log             |  complex  | max. box error  |    13.0     |
    |                             |           |                 |             |
    |   Exp (complex parameter)   |  complex  | max. rel. error |     7.0     |
    |                             |           |                 |             |
    |  Exp (imaginary parameter)  |  complex  | max. rel. error |     2.0     |
    |                             |           |                 |             |
    |  Sin, Cos, Sinh, and Cosh   |  complex  | max. rel. error |    11.0     |
    |                             |           |                 |             |
    |  Tan, Cot, Tanh, and Coth   |  complex  | max. rel. error |    35.0     |
    |                             |           |                 |             |
    |    inverse trigonometric    |  complex  | max. rel. error |    14.0     |
    |                             |           |                 |             |
    |     inverse hyperbolic      |  complex  | max. rel. error |    14.0     |
    |                             |           |                 |             |
    <em>---------------------------------------------------------------------------</em>
</pre><dl><dt><a name="8">(8)</a><dd>The maximum relative error given above applies throughout the domain of
the Compose_From_Polar function when the Cycle parameter is specified.  When
the Cycle parameter is omitted, the maximum relative error applies only when
the absolute value of the parameter Argument is less than or equal to the
angle threshold <a href="G-02-04.htm">(see G.2.4)</a>.  For the Exp function, and for the forward
hyperbolic (resp., trigonometric) functions, the maximum relative error given
above likewise applies only when the absolute value of the imaginary (resp.,
real) component of the parameter X (or the absolute value of the parameter
itself, in the case of the Exp function with a parameter of pure-imaginary
type) is less than or equal to the angle threshold.  For larger angles, the
accuracy is implementation defined.
<dt><a name="9">(9)</a><dd>The prescribed results specified <a href="G-01-02.htm">in G.1.2</a> for certain functions at
particular parameter values take precedence over the error bounds;
effectively, they narrow to a single value the result interval allowed by the
error bounds for a component of the result.  Additional rules with a similar
effect are given below for certain inverse trigonometric and inverse
hyperbolic functions, at particular parameter values for which a component of
the mathematical result is transcendental.  In each case, the accuracy rule,
which takes precedence over the error bounds, is that the result interval for
the stated result component is the model interval of CT.Real associated with
the component's exact mathematical value.  The cases in question are as
follows:
<dt><a name="10">(10)</a><dd><ul><li>When the parameter X has the value zero, the real (resp.,
imaginary) component of the result of the Arccot (resp., Arccoth)
function is in the model interval of CT.Real associated with the
value Pi/2.0.
</ul><dt><a name="11">(11)</a><dd><ul><li>When the parameter X has the value one, the real component of the
result of the Arcsin function is in the model interval of CT.Real
associated with the value Pi/2.0.
</ul><dt><a name="12">(12)</a><dd><ul><li>When the parameter X has the value -1.0, the real component of
the result of the Arcsin (resp., Arccos) function is in the model
interval of CT.Real associated with the value -Pi/2.0 (resp.,
Pi).
</ul><dt><a name="13">(13)</a><dd>The amount by which a component of the result of an inverse
trigonometric or inverse hyperbolic function is allowed to spill over into a
quadrant adjacent to the one corresponding to the principal branch, as given
<a href="G-01-02.htm">in G.1.2</a>, is limited.  The rule is that the result belongs to the smallest
model interval of CT.Real that contains both boundaries of the quadrant
corresponding to the principal branch.  This rule also takes precedence to
the maximum error bounds, effectively narrowing the result interval allowed
by them.
<dt><a name="14">(14)</a><dd>Finally, the results allowed by the error bounds are narrowed by one
further rule: The absolute value of each component of the result of the Exp
function, for a pure-imaginary parameter, never exceeds one.
</dl><h5 align="center">Implementation Advice</h5>
<dl><dt><a name="15">(15)</a><dd>The version of the Compose_From_Polar function without a Cycle parameter
should not be implemented by calling the corresponding version with a Cycle
parameter of 2.0*Numerics.Pi, since this will not provide the required
accuracy in some portions of the domain.
</dl><hr>
<h4><a href="G-02-05.htm"><img src="left.gif" alt="Prev"></a> | <a href="G-02.htm"><img src="up.gif" alt="Up"></a> | <img src="noright.gif" alt="____"> | <a href="G-02-05.htm"><img src="back.gif" alt="Back"></a> | <a href="H.htm"><img src="forward.gif" alt="Forward"></a><br>   <a href="toc.htm">TOC --</a> / <a href="toc-l1.htm">--.--</a> / <a href="toc-l2.htm">--.--.--</a> | <a href="index.htm">Index</a> | <a href="search.htm">Search</a> | <a href="syntax.htm">Syntax</a> | <a href="help.htm">Help</a></h4>

<p>
<a href="http://lglwww.epfl.ch/Ada/"><img src="la-icon.gif" alt="Ada WWW Home"></a>
 -- Email comments, additions, corrections, gripes, kudos, etc. to:
<address>
<a href="author.htm">Magnus Kempe</a>
 -- <a href="mailto:Magnus.Kempe@di.epfl.ch">Magnus.Kempe@di.epfl.ch</a><br>
<a href="cright.htm">Copyright statement</a><br>
Page last generated: 95-03-12
</address>
</body>
</html>
