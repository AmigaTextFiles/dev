
##############################################################################
#
#	TEKlib - Elate Tool library
#
##############################################################################

CC = vpcc
ASM = asm
RM = rm -f
CP = cp

INCL = -I /lang/cc/include -I /lib
OUTFILE = -o
OUTSUF = .00

DEBUG = -g -DKNEXECDEBUG=10 -DKNSOCKDEBUG=10 -DKNVISDEBUG=10 -DTDEBUG=10

FLAGS = -T -O3 -Wall $(DEBUG)
MAINFLAGS = -O3 -Wall $(DEBUG)

##############################################################################
#
#	platform independent
#
##############################################################################

include		build/Makefile_main


##############################################################################
#
#	elate kernel interface
#
##############################################################################

KNOBJS=	kn/exec/initlock$(OUTSUF)	\
		kn/exec/destroylock$(OUTSUF)	\
		kn/exec/lock$(OUTSUF)	\
		kn/exec/unlock$(OUTSUF)	\
		kn/exec/initevent$(OUTSUF)	\
		kn/exec/destroyevent$(OUTSUF)	\
		kn/exec/doevent$(OUTSUF)	\
		kn/exec/waitevent$(OUTSUF)	\
		kn/exec/timedwaitevent$(OUTSUF)	\
		kn/exec/alloc$(OUTSUF)	\
		kn/exec/alloc0$(OUTSUF)	\
		kn/exec/realloc$(OUTSUF)	\
		kn/exec/free$(OUTSUF)	\
		kn/exec/getsize$(OUTSUF)	\
		kn/exec/memcopy$(OUTSUF)	\
		kn/exec/memset$(OUTSUF)	\
		kn/exec/memcopy32$(OUTSUF)	\
		kn/exec/memset32$(OUTSUF)	\
		kn/exec/initbasecontext$(OUTSUF)	\
		kn/exec/destroybasecontext$(OUTSUF)	\
		kn/exec/initthread$(OUTSUF)	\
		kn/exec/deinitthread$(OUTSUF)	\
		kn/exec/destroythread$(OUTSUF)	\
		kn/exec/findself$(OUTSUF)	\
		kn/exec/dispatch$(OUTSUF)	\
		kn/exec/inittimer$(OUTSUF)	\
		kn/exec/destroytimer$(OUTSUF)	\
		kn/exec/querytimer$(OUTSUF)	\
		kn/exec/resettimer$(OUTSUF)	\
		kn/exec/timedelay$(OUTSUF)	\
		kn/exec/getrandomseed$(OUTSUF)	\
		kn/sock/cmpsockname$(OUTSUF)	\
		kn/sock/createclientsock$(OUTSUF)	\
		kn/sock/createservsock$(OUTSUF)	\
		kn/sock/destroyclientsock$(OUTSUF)	\
		kn/sock/destroyservsock$(OUTSUF)	\
		kn/sock/destroysockname$(OUTSUF)	\
		kn/sock/dupsockname$(OUTSUF)	\
		kn/sock/getclientsockmsg$(OUTSUF)	\
		kn/sock/getservsockmsg$(OUTSUF)	\
		kn/sock/getsockname$(OUTSUF)	\
		kn/sock/getsockport$(OUTSUF)	\
		kn/sock/initsockname$(OUTSUF)	\
		kn/sock/itoa$(OUTSUF)	\
		kn/sock/putclientsockmsg$(OUTSUF)	\
		kn/sock/returnservsockmsg$(OUTSUF)	\
		kn/sock/waitclientsock$(OUTSUF)	\
		kn/sock/waitservsock$(OUTSUF)	\
		kn/sock/waitselect$(OUTSUF)	\
		kn/sock/getsockerrno$(OUTSUF)

KNVISOBJS = kn/visual/createvisual$(OUTSUF)	\
			kn/visual/destroyvisual$(OUTSUF)	\
			kn/visual/getnextinput$(OUTSUF)	\
			kn/visual/setinputmask$(OUTSUF)	\
			kn/visual/allocpen$(OUTSUF)	\
			kn/visual/freepen$(OUTSUF)	\
			kn/visual/setfgpen$(OUTSUF)	\
			kn/visual/setbgpen$(OUTSUF)	\
			kn/visual/line$(OUTSUF)	\
			kn/visual/rect$(OUTSUF)	\
			kn/visual/frect$(OUTSUF)	\
			kn/visual/plot$(OUTSUF)	\
			kn/visual/getparameters$(OUTSUF)	\
			kn/visual/scroll$(OUTSUF)	\
			kn/visual/drawtext$(OUTSUF)	\
			kn/visual/getevent$(OUTSUF)	\
			kn/visual/waitvisual$(OUTSUF)	\
			kn/visual/flush$(OUTSUF)	\
			kn/visual/drawrgb$(OUTSUF)

kn/exec/initlock$(OUTSUF): kn/elate/exec/initlock.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/exec/initlock$(OUTSUF) kn/elate/exec/initlock.c
kn/exec/destroylock$(OUTSUF): kn/elate/exec/destroylock.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/exec/destroylock$(OUTSUF) kn/elate/exec/destroylock.c
kn/exec/lock$(OUTSUF): kn/elate/exec/lock.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/exec/lock$(OUTSUF) kn/elate/exec/lock.c
kn/exec/unlock$(OUTSUF): kn/elate/exec/unlock.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/exec/unlock$(OUTSUF) kn/elate/exec/unlock.c
kn/exec/initevent$(OUTSUF): kn/elate/exec/initevent.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/exec/initevent$(OUTSUF) kn/elate/exec/initevent.c
kn/exec/destroyevent$(OUTSUF): kn/elate/exec/destroyevent.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/exec/destroyevent$(OUTSUF) kn/elate/exec/destroyevent.c
kn/exec/doevent$(OUTSUF): kn/elate/exec/doevent.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/exec/doevent$(OUTSUF) kn/elate/exec/doevent.c
kn/exec/waitevent$(OUTSUF): kn/elate/exec/waitevent.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/exec/waitevent$(OUTSUF) kn/elate/exec/waitevent.c
kn/exec/timedwaitevent$(OUTSUF): kn/elate/exec/timedwaitevent.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/exec/timedwaitevent$(OUTSUF) kn/elate/exec/timedwaitevent.c
kn/exec/alloc$(OUTSUF): kn/elate/exec/alloc.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/exec/alloc$(OUTSUF) kn/elate/exec/alloc.c
kn/exec/alloc0$(OUTSUF): kn/elate/exec/alloc0.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/exec/alloc0$(OUTSUF) kn/elate/exec/alloc0.c
kn/exec/realloc$(OUTSUF): kn/elate/exec/realloc.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/exec/realloc$(OUTSUF) kn/elate/exec/realloc.c
kn/exec/free$(OUTSUF): kn/elate/exec/free.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/exec/free$(OUTSUF) kn/elate/exec/free.c
kn/exec/getsize$(OUTSUF): kn/elate/exec/getsize.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/exec/getsize$(OUTSUF) kn/elate/exec/getsize.c
kn/exec/memcopy$(OUTSUF): kn/elate/exec/memcopy.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/exec/memcopy$(OUTSUF) kn/elate/exec/memcopy.c
kn/exec/memset$(OUTSUF): kn/elate/exec/memset.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/exec/memset$(OUTSUF) kn/elate/exec/memset.c
kn/exec/memcopy32$(OUTSUF): kn/elate/exec/memcopy32.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/exec/memcopy32$(OUTSUF) kn/elate/exec/memcopy32.c
kn/exec/memset32$(OUTSUF): kn/elate/exec/memset32.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/exec/memset32$(OUTSUF) kn/elate/exec/memset32.c
kn/exec/inittimer$(OUTSUF): kn/elate/exec/inittimer.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/exec/inittimer$(OUTSUF) kn/elate/exec/inittimer.c
kn/exec/destroytimer$(OUTSUF): kn/elate/exec/destroytimer.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/exec/destroytimer$(OUTSUF) kn/elate/exec/destroytimer.c
kn/exec/querytimer$(OUTSUF): kn/elate/exec/querytimer.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/exec/querytimer$(OUTSUF) kn/elate/exec/querytimer.c
kn/exec/resettimer$(OUTSUF): kn/elate/exec/resettimer.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/exec/resettimer$(OUTSUF) kn/elate/exec/resettimer.c
kn/exec/timedelay$(OUTSUF): kn/elate/exec/timedelay.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/exec/timedelay$(OUTSUF) kn/elate/exec/timedelay.c
kn/exec/initthread$(OUTSUF): kn/elate/exec/initthread.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/exec/initthread$(OUTSUF) kn/elate/exec/initthread.c
kn/exec/deinitthread$(OUTSUF): kn/elate/exec/deinitthread.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/exec/deinitthread$(OUTSUF) kn/elate/exec/deinitthread.c
kn/exec/destroythread$(OUTSUF): kn/elate/exec/destroythread.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/exec/destroythread$(OUTSUF) kn/elate/exec/destroythread.c
kn/exec/initbasecontext$(OUTSUF): kn/elate/exec/initbasecontext.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/exec/initbasecontext$(OUTSUF) kn/elate/exec/initbasecontext.c
kn/exec/destroybasecontext$(OUTSUF): kn/elate/exec/destroybasecontext.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/exec/destroybasecontext$(OUTSUF) kn/elate/exec/destroybasecontext.c
kn/exec/findself$(OUTSUF): kn/elate/exec/findself.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/exec/findself$(OUTSUF) kn/elate/exec/findself.c
kn/exec/getrandomseed$(OUTSUF): kn/elate/exec/getrandomseed.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/exec/getrandomseed$(OUTSUF) kn/elate/exec/getrandomseed.c
kn/exec/dispatch$(OUTSUF): kn/elate/exec/dispatch.c
	$(CC) $(MAINFLAGS) $(INCL) $(OUTFILE) kn/exec/dispatch$(OUTSUF) kn/elate/exec/dispatch.c

kn/sock/$(OUTSUF): kn/elate/sock/.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/sock/$(OUTSUF) kn/elate/sock/.c
kn/sock/cmpsockname$(OUTSUF): kn/elate/sock/cmpsockname.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/sock/cmpsockname$(OUTSUF) kn/elate/sock/cmpsockname.c
kn/sock/createclientsock$(OUTSUF): kn/elate/sock/createclientsock.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/sock/createclientsock$(OUTSUF) kn/elate/sock/createclientsock.c
kn/sock/createservsock$(OUTSUF): kn/elate/sock/createservsock.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/sock/createservsock$(OUTSUF) kn/elate/sock/createservsock.c
kn/sock/destroyclientsock$(OUTSUF): kn/elate/sock/destroyclientsock.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/sock/destroyclientsock$(OUTSUF) kn/elate/sock/destroyclientsock.c
kn/sock/destroyservsock$(OUTSUF): kn/elate/sock/destroyservsock.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/sock/destroyservsock$(OUTSUF) kn/elate/sock/destroyservsock.c
kn/sock/destroysockname$(OUTSUF): kn/elate/sock/destroysockname.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/sock/destroysockname$(OUTSUF) kn/elate/sock/destroysockname.c
kn/sock/dupsockname$(OUTSUF): kn/elate/sock/dupsockname.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/sock/dupsockname$(OUTSUF) kn/elate/sock/dupsockname.c
kn/sock/getclientsockmsg$(OUTSUF): kn/elate/sock/getclientsockmsg.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/sock/getclientsockmsg$(OUTSUF) kn/elate/sock/getclientsockmsg.c
kn/sock/getservsockmsg$(OUTSUF): kn/elate/sock/getservsockmsg.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/sock/getservsockmsg$(OUTSUF) kn/elate/sock/getservsockmsg.c
kn/sock/getsockname$(OUTSUF): kn/elate/sock/getsockname.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/sock/getsockname$(OUTSUF) kn/elate/sock/getsockname.c
kn/sock/getsockport$(OUTSUF): kn/elate/sock/getsockport.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/sock/getsockport$(OUTSUF) kn/elate/sock/getsockport.c
kn/sock/initsockname$(OUTSUF): kn/elate/sock/initsockname.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/sock/initsockname$(OUTSUF) kn/elate/sock/initsockname.c
kn/sock/itoa$(OUTSUF): kn/elate/sock/itoa.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/sock/itoa$(OUTSUF) kn/elate/sock/itoa.c
kn/sock/putclientsockmsg$(OUTSUF): kn/elate/sock/putclientsockmsg.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/sock/putclientsockmsg$(OUTSUF) kn/elate/sock/putclientsockmsg.c
kn/sock/returnservsockmsg$(OUTSUF): kn/elate/sock/returnservsockmsg.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/sock/returnservsockmsg$(OUTSUF) kn/elate/sock/returnservsockmsg.c
kn/sock/waitclientsock$(OUTSUF): kn/elate/sock/waitclientsock.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/sock/waitclientsock$(OUTSUF) kn/elate/sock/waitclientsock.c
kn/sock/waitservsock$(OUTSUF): kn/elate/sock/waitservsock.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/sock/waitservsock$(OUTSUF) kn/elate/sock/waitservsock.c
kn/sock/waitselect$(OUTSUF): kn/elate/sock/waitselect.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/sock/waitselect$(OUTSUF) kn/elate/sock/waitselect.c
kn/sock/getsockerrno$(OUTSUF): kn/elate/sock/getsockerrno.asm
	$(ASM) kn/elate/sock/getsockerrno.asm

kn/visual/createvisual$(OUTSUF): kn/elate/visual/createvisual.asm
	$(ASM) kn/elate/visual/createvisual.asm
kn/visual/destroyvisual$(OUTSUF): kn/elate/visual/destroyvisual.asm
	$(ASM) kn/elate/visual/destroyvisual.asm
kn/visual/getnextinput$(OUTSUF): kn/elate/visual/getnextinput.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/visual/getnextinput$(OUTSUF) kn/elate/visual/getnextinput.c
kn/visual/setinputmask$(OUTSUF): kn/elate/visual/setinputmask.asm
	$(ASM) kn/elate/visual/setinputmask.asm
kn/visual/allocpen$(OUTSUF): kn/elate/visual/allocpen.asm
	$(ASM) kn/elate/visual/allocpen.asm
kn/visual/freepen$(OUTSUF): kn/elate/visual/freepen.asm
	$(ASM) kn/elate/visual/freepen.asm
kn/visual/setfgpen$(OUTSUF): kn/elate/visual/setfgpen.asm
	$(ASM) kn/elate/visual/setfgpen.asm
kn/visual/setbgpen$(OUTSUF): kn/elate/visual/setbgpen.asm
	$(ASM) kn/elate/visual/setbgpen.asm
kn/visual/line$(OUTSUF): kn/elate/visual/line.asm
	$(ASM) kn/elate/visual/line.asm
kn/visual/rect$(OUTSUF): kn/elate/visual/rect.asm
	$(ASM) kn/elate/visual/rect.asm
kn/visual/frect$(OUTSUF): kn/elate/visual/frect.asm
	$(ASM) kn/elate/visual/frect.asm
kn/visual/plot$(OUTSUF): kn/elate/visual/plot.asm
	$(ASM) kn/elate/visual/plot.asm
kn/visual/getparameters$(OUTSUF): kn/elate/visual/getparameters.asm
	$(ASM) kn/elate/visual/getparameters.asm
kn/visual/scroll$(OUTSUF): kn/elate/visual/scroll.asm
	$(ASM) kn/elate/visual/scroll.asm
kn/visual/drawtext$(OUTSUF): kn/elate/visual/drawtext.asm
	$(ASM) kn/elate/visual/drawtext.asm
kn/visual/getevent$(OUTSUF): kn/elate/visual/getevent.asm
	$(ASM) kn/elate/visual/getevent.asm
kn/visual/waitvisual$(OUTSUF): kn/elate/visual/waitvisual.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/visual/waitvisual$(OUTSUF) kn/elate/visual/waitvisual.c
kn/visual/flush$(OUTSUF): kn/elate/visual/flush.asm
	$(ASM) kn/elate/visual/flush.asm
kn/visual/drawrgb$(OUTSUF): kn/elate/visual/drawrgb.asm
	$(ASM) kn/elate/visual/drawrgb.asm


##############################################################################
#
#	teklib
#
##############################################################################

kn:			$(KNOBJS)

knvis:		$(KNVISOBJS)

list:		$(LISTOBJS)

mem:		$(MEMOBJS)

util:		$(UTILOBJS)

task:		$(TASKOBJS)

sock:		$(SOCKOBJS)

msg:		$(MSGOBJS)

array:		$(ARRAYOBJS)

visual:		$(VISUALOBJS)

teklib:			kn list mem util task sock msg array

teklibvisual:	kn knvis list mem util task sock msg array visual

##############################################################################
#
#	clean
#
##############################################################################

clean:
		-$(RM) kn/exec/*$(OUTSUF)
		-$(RM) kn/sock/*$(OUTSUF)
		-$(RM) kn/visual/*$(OUTSUF)
		-$(RM) list/*$(OUTSUF)
		-$(RM) mem/*$(OUTSUF)
		-$(RM) util/*$(OUTSUF)
		-$(RM) task/*$(OUTSUF)
		-$(RM) sock/*$(OUTSUF)
		-$(RM) msg/*$(OUTSUF)
		-$(RM) array/*$(OUTSUF)
		-$(RM) visual/*$(OUTSUF)
		-$(RM) examples/*$(OUTSUF)

