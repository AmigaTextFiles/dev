
##############################################################################
#
#	TEKlib - Linux 32bit - gcc
#
##############################################################################

RM = rm -f
CC = gcc
CAT = cat
AR = ar r

INCL = -I ../
OUTFILE = -c -o
OUTSUF = .o

DEBUG = -g -DKNEXECDEBUG=5 -DKNSOCKDEBUG=5 -DKNVISDEBUG=10 -DTDEBUG=10
#PROFILE = -pg

KNFLAGS = -Wall -O3 $(DEBUG) -DTEKLIB_PTHREADS_FLAW
FLAGS = -Wall -ansi -pedantic -O3 $(DEBUG) $(PROFILE) -DTEKLIB_PTHREADS_FLAW
MONSTERFLAGS = -Wall -O3 -DTEKLIB_PTHREADS_FLAW

##############################################################################
#
#	linux specific
#
##############################################################################

KNOBJS=		kn/linux/exec.o	\
			kn/linux/sock.o
			
VISKNOBJS=	kn/linux/visual.o

kn/linux/exec.o: kn/linux/exec.c
	$(CC) $(KNFLAGS) $(INCL) $(OUTFILE) kn/linux/exec.o kn/linux/exec.c
kn/linux/sock.o: kn/linux/sock.c
	$(CC) $(KNFLAGS) $(INCL) $(OUTFILE) kn/linux/sock.o kn/linux/sock.c
kn/linux/visual.o: kn/linux/visual.c
	$(CC) $(KNFLAGS) $(INCL) $(OUTFILE) kn/linux/visual.o kn/linux/visual.c


##############################################################################
#
#	platform independent
#
##############################################################################

include		build/Makefile_main


##############################################################################
#
#	teklib
#
##############################################################################

kn:			$(KNOBJS)
viskn:		$(KNOBJS) $(VISKNOBJS)

list:		$(LISTOBJS)

mem:		$(MEMOBJS)

util:		$(UTILOBJS)

task:		$(TASKOBJS)

msg:		$(MSGOBJS)

sock:		$(SOCKOBJS)

array:		$(ARRAYOBJS)

visual:		$(VISUALOBJS)

teklib:		kn list mem util task msg sock array
			-$(RM) libtek.a
			$(AR) libtek.a $(KNOBJS) $(LISTOBJS) $(MEMOBJS) $(UTILOBJS) $(TASKOBJS) $(MSGOBJS) $(SOCKOBJS) $(ARRAYOBJS)

teklibvisual:	viskn list mem util task msg sock array visual
				-$(RM) libtek.a
				$(AR) libtek.a $(KNOBJS) $(VISKNOBJS) $(LISTOBJS) $(MEMOBJS) $(UTILOBJS) $(TASKOBJS) $(MSGOBJS) $(SOCKOBJS) $(ARRAYOBJS) $(VISUALOBJS)

teklibmonster:
			$(CAT) kn/linux/exec.c kn/linux/sock.c list/*.c mem/*.c > linuxmonster.c
			$(CAT) util/*.c task/*.c msg/*.c sock/*.c array/*.c >> linuxmonster.c
			$(CC) linuxmonster.c $(MONSTERFLAGS) $(INCL) -c -o libtek.a

teklibvisualmonster:
			$(CAT) kn/linux/*.c list/*.c mem/*.c > linuxmonster.c
			$(CAT) util/*.c task/*.c msg/*.c sock/*.c array/*.c visual/*.c >> linuxmonster.c
			$(CC) linuxmonster.c $(MONSTERFLAGS) $(INCL) -c -o libtek.a

##############################################################################
#
#	clean
#
##############################################################################

clean:
		-$(RM) libtek.a
		-$(RM) kn/linux/*.o
		-$(RM) list/*.o
		-$(RM) mem/*.o
		-$(RM) util/*.o
		-$(RM) task/*.o
		-$(RM) msg/*.o
		-$(RM) sock/*.o
		-$(RM) array/*.o
		-$(RM) visual/*.o
		-$(RM) linuxmonster.c
