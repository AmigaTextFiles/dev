
##############################################################################
#
#	TEKlib - gcc as crosscompiler for MorphOS
#	- experimental
#
##############################################################################

RM = rm -f
CC = /gg/bin/gcc -noixemul -mcpu=603e -mmultiple -fomit-frame-pointer
CAT = cat
AR = /gg/bin/ar r

INCL = -I ../ -I /gg/os-include/netinclude/
OUTFILE = -c -o
OUTSUF = .o

#DEBUG = -g -DKNEXECDEBUG=0 -DKNSOCKDEBUG=0 -DKNVISDEBUG=0 -DTDEBUG=0
#PROFILE = -pg

FLAGS = -Wall -O2 $(DEBUG) $(PROFILE) 
MONSTERFLAGS = -Wall -O2

##############################################################################
#
#	amiga specific
#
##############################################################################

KNOBJS=		kn/amiga/exec.o	\
			kn/amiga/sock.o
			
VISKNOBJS=	kn/amiga/visual.o

kn/amiga/exec.o: kn/amiga/exec.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/amiga/exec.o kn/amiga/exec.c
kn/amiga/sock.o: kn/amiga/sock.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/amiga/sock.o kn/amiga/sock.c
kn/amiga/visual.o: kn/amiga/visual.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/amiga/visual.o kn/amiga/visual.c


##############################################################################
#
#	platform independent
#
##############################################################################

include		build/Makefile_main


##############################################################################
#
#	teklib
#
##############################################################################

kn:			$(KNOBJS)
viskn:		$(KNOBJS) $(VISKNOBJS)

list:		$(LISTOBJS)

mem:		$(MEMOBJS)

util:		$(UTILOBJS)

task:		$(TASKOBJS)

msg:		$(MSGOBJS)

sock:		$(SOCKOBJS)

array:		$(ARRAYOBJS)

visual:		$(VISUALOBJS)

teklib:		kn list mem util task msg sock array
			-$(RM) libtek.a
			$(AR) libtek.a $(KNOBJS) $(LISTOBJS) $(MEMOBJS) $(UTILOBJS) $(TASKOBJS) $(MSGOBJS) $(SOCKOBJS) $(ARRAYOBJS)

teklibvisual:	viskn list mem util task msg sock array visual
				-$(RM) libtek.a
				$(AR) libtek.a $(KNOBJS) $(VISKNOBJS) $(LISTOBJS) $(MEMOBJS) $(UTILOBJS) $(TASKOBJS) $(MSGOBJS) $(SOCKOBJS) $(ARRAYOBJS) $(VISUALOBJS)

teklibmonster:
			$(CAT) kn/amiga/exec.c kn/amiga/sock.c list/*.c mem/*.c > amimonster.c
			$(CAT) util/*.c task/*.c msg/*.c sock/*.c array/*.c >> amimonster.c
			$(CC) amimonster.c $(MONSTERFLAGS) $(INCL) -c -o libtek.a

teklibvisualmonster:
			$(CAT) kn/amiga/*.c list/*.c mem/*.c > amimonster.c
			$(CAT) util/*.c task/*.c msg/*.c sock/*.c array/*.c visual/*.c >> amimonster.c
			$(CC) amimonster.c $(MONSTERFLAGS) $(INCL) -c -o libtek.a

##############################################################################
#
#	clean
#
##############################################################################

clean:
		-$(RM) libtek.a
		-$(RM) kn/amiga/*.o
		-$(RM) list/*.o
		-$(RM) mem/*.o
		-$(RM) util/*.o
		-$(RM) task/*.o
		-$(RM) msg/*.o
		-$(RM) sock/*.o
		-$(RM) array/*.o
		-$(RM) visual/*.o
		-$(RM) amimonster.c
