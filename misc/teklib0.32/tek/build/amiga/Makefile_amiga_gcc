
##############################################################################
#
#	TEKlib - gcc as crosscompiler for AmigaOS3.x
#	- experimental
#
##############################################################################

RM = rm -f
CC = /home/amidev/gg/m68k-amigaos/bin/gcc -noixemul -msmall-code -fomit-frame-pointer -m68060
CAT = cat
AR = /home/amidev/gg/m68k-amigaos/bin/ar r

INCL = -I ../
OUTFILE = -c -o
OUTSUF = .o

DEBUG = -g -DKNEXECDEBUG=10 -DKNSOCKDEBUG=10 -DKNVISDEBUG=10 -DTDEBUG=10

FLAGS = -Wall -O2 $(DEBUG) $(PROFILE) 
MONSTERFLAGS = -Wall -O2

##############################################################################
#
#	amiga specific
#
##############################################################################

KNOBJS=		kn/amiga/exec.o	\
			kn/amiga/sock.o
			
VISKNOBJS=	kn/amiga/visual.o

kn/amiga/exec.o: kn/amiga/exec.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/amiga/exec.o kn/amiga/exec.c
kn/amiga/sock.o: kn/amiga/sock.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/amiga/sock.o kn/amiga/sock.c
kn/amiga/visual.o: kn/amiga/visual.c
	$(CC) $(FLAGS) $(INCL) $(OUTFILE) kn/amiga/visual.o kn/amiga/visual.c


##############################################################################
#
#	platform independent
#
##############################################################################

include		build/Makefile_main


##############################################################################
#
#	teklib
#
##############################################################################

kn:			$(KNOBJS)
viskn:		$(KNOBJS) $(VISKNOBJS)

list:		$(LISTOBJS)

mem:		$(MEMOBJS)

util:		$(UTILOBJS)

task:		$(TASKOBJS)

msg:		$(MSGOBJS)

sock:		$(SOCKOBJS)

array:		$(ARRAYOBJS)

visual:		$(VISUALOBJS)

teklib:		kn list mem util task msg sock array
			-$(RM) libtek.a
			$(AR) libtek.a $(KNOBJS) $(LISTOBJS) $(MEMOBJS) $(UTILOBJS) $(TASKOBJS) $(MSGOBJS) $(SOCKOBJS) $(ARRAYOBJS)

teklibvisual:	viskn list mem util task msg sock array visual
				-$(RM) libtek.a
				$(AR) libtek.a $(KNOBJS) $(VISKNOBJS) $(LISTOBJS) $(MEMOBJS) $(UTILOBJS) $(TASKOBJS) $(MSGOBJS) $(SOCKOBJS) $(ARRAYOBJS) $(VISUALOBJS)

teklibmonster:
			$(CAT) kn/amiga/exec.c kn/amiga/sock.c list/*.c mem/*.c > amimonster.c
			$(CAT) util/*.c task/*.c msg/*.c sock/*.c array/*.c >> amimonster.c
			$(CC) amimonster.c $(MONSTERFLAGS) $(INCL) -c -o libtek.a

teklibvisualmonster:
			$(CAT) kn/amiga/*.c list/*.c mem/*.c > amimonster.c
			$(CAT) util/*.c task/*.c msg/*.c sock/*.c array/*.c visual/*.c >> amimonster.c
			$(CC) amimonster.c $(MONSTERFLAGS) $(INCL) -c -o libtek.a

##############################################################################
#
#	clean
#
##############################################################################

clean:
		-$(RM) libtek.a kn/amiga/*.o list/*.o mem/*.o util/*.o task/*.o sock/*.o msg/*.o array/*.o visual/*.o
