# setup several paths (directories must already exist!)
LIB_DIR = data:services/lib/
INCLUDE_TOPDIR = data:services/include/
INCLUDE_DIR = $(INCLUDE_TOPDIR)dialog/
DOC_DIR = doc:programming/
ARC_DIR = arc:

ARCHIVER = lha
ARC_CMD = r
ARC_EXT = lha

HDR = dialog.h gtsup.h
SRC = run.c setuphook.c element.c gtsup.c\
	 root.c vstack.c hstack.c vcons.c hcons.c hbumper.c vbumper.c hspring.c vspring.c\
	 display.c button.c checkbox.c entry.c listview.c mx.c cycle.c
OBJ = run.o setuphook.o element.o gtsup.o\
	 root.o vstack.o hstack.o vcons.o hcons.o hbumper.o vbumper.o hspring.o vspring.o\
	 display.o button.o checkbox.o entry.o listview.o mx.o cycle.o

all: dialog.lib

$(SRC): $(HDR)

dialog.lib: $(OBJ)
	oml $@ r $(OBJ)

$(LIB_DIR)dialog.lib: dialog.lib
	copy dialog.lib $(LIB_DIR)

$(INCLUDE_DIR)dialog.h:	dialog.h
	copy dialog.h $(INCLUDE_DIR)

$(DOC_DIR)dialog.doc: dialog.doc
	copy dialog.doc $(DOC_DIR)

PUBLIC =	$(LIB_DIR)dialog.lib\
			$(INCLUDE_DIR)dialog.h\
			$(DOC_DIR)dialog.doc

public: $(PUBLIC)

clean:
	-delete \#?.o

BIN_ARCHIVE = dialog.lib
SRC_ARCHIVE = $(SRC) $(HDR) smakefile SCOPTIONS dialog.doc
XMP_ARCHIVE = examples/examples.lha

$(ARC_DIR)dialoglib.$(ARC_EXT): $(BIN_ARCHIVE)
	$(ARCHIVER) $(ARC_CMD) $(ARC_DIR)dialoglib $(BIN_ARCHIVE) $(SRC_ARCHIVE) $(XMP_ARCHIVE)

archive: $(ARC_DIR)dialoglib.$(ARC_EXT)
