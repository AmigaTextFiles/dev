@database makelib

@node main "makelib - Dokumentation"

@{b}makelib 1.0 (29.6.1999)@{ub}

Dieses Dokument beinhaltet die folgenden Kapitel:

  @{" Einführung    " link intro   } Was ist es? Und wozu brauche ich es?
  @{" Installation  " link install }
  @{" Argumente     " link args    } Wie benutze ich es?
  @{" Konfiguration " link config  } Wie sage ich ihm, was es tun soll?
  @{" Zu beachten   " link remark  } Wieso tut es nicht?
  @{" Autor         " link author  } Mit Kontaktadresse
  @{" Urheberrecht  " link distr   } Rechtliches & Hinweise zur Distribution
  @{" History       " link history }

Außerdem enthält es zusätzlich die Übersetzung obiger Texte in:
  @{" English " link e_main}

Copyright ©1999 pinc Software. Alle Rechte vorbehalten.

@endnode


@node intro "makelib - Einführung"

"makelib" ist ein kleines Programm, daß aus dem C-Source eines Library-
Projektes die Funktionsköpfe herausextrahiert und daraus folgende
Dateien automatisch erstellt:

 - clib/mylib_protos.h
 - pragmas/mylib_pragmas.h
 - proto/mylib.h
 - mylib_lib.fd

Mal abgesehen von dem erheblichen Wartungsaufwand, den dieses Programm
spart, sorgt es damit auch für die Vermeidung von Fehlern und ein ein-
heitliches Aussehen (mit Kommentaren) der obigen Dateien.

Die erstellten Dateien sind kompatibel mit den Original-Includes von
Commodore bzw. Amiga Inc.. D.h. einige C-Compiler könnten Probleme
mit ihnen haben, da einige SAS/C-Spezialitäten benutzt werden (diverse
#pragma-Anweisungen).

Andere Programmiersprachen können nur zum Teil eingebunden werden; die
Funktionsköpfe kann man auch in der @{"Konfigurationsdatei" link config} definieren -
den Library-Funktionsvektor allerdings nicht.
Da makelib nur C-Kommentare versteht, könnte man da vielleicht noch
ein wenig tricksen.

@endnode


@node install "makelib - Installation"

Zur Installation wird das Programm einfach z.B. ins C-Verzeichnis kopiert
(sinnvollerweise ein im Pfad liegendes Verzeichnis).

Zur Konfiguration wird eine @{"eigene Datei" link config} für jedes Projekt benutzt.

"makelib" setzt mindestens OS 3.0 voraus, sollte aber auch mit höheren
Versionen funktionieren.

@endnode


@node config "makelib - Konfiguration"

Die eigentliche Konfiguration von makelib wird über eine eigene Datei für
jedes Projekt geregelt. Voreingestellt bezieht sich makelib auf "makelib.with"
im aktuellen Verzeichnis.

In einer Konfigurationsdatei wird zwischen zeilenabhängigen und globalen
Kommandos unterschieden, die beide mit einem Punkt ('.') in der ersten
Spalte eingeleitet werden (z.B. ".bias 30").
Außerdem werden die Kommandos case-sensitive behandelt, sie müssen also
klein geschrieben werden.

Es gibt folgende globale Kommandos:

@{b}base@{ub} Name         Name der Library-Base, z.B. MyLibBase

@{b}bias@{ub} Offset       Dezimaler Offset zur ersten richtigen Funktion.
                  Voreingestellt ist 30.

@{b}func@{ub} Prototype    C-Prototype einer Funktion, die z.B. nur in Assembler
                  vorliegt.

@{b}libvectors@{ub} Symbol Legt das C-Symbol fest, das für den Library-
                  Funktionsvektor benutzt wird.
                  Voreingestellt ist "LibVectors".

@{b}table@{ub} Symbol      Synonym für libvectors.

@{b}decimals@{ub}          Legt fest, daß die Funktionsoffsets als Dezimal-
                  zahlen interpretiert werden (sonst Hexadezimal).

@{b}protoheader@{ub}       Ein "Prolog" für die mylib_protos.h-Datei, in der
                  bspw. benötigte C-Header eingebunden werden.
                  Die folgenden Zeilen bis zum nächsten Kommando werden
                  diesem Kommando zugedacht.

Bei den zeilenabhängigen Kommandos steht nach dem Punkt erstmal eine
Hexadezimalzahl (Dezimalzahl mit @{b}decimals@{ub}), die angibt, um welchen
Offset es geht. Diese Angaben sind mit den (positiven) LVOs bzw. den Zahlen
in der #pragma-Anweisung in den pragmas-Dateien identisch.
Eine solche Zeile sieht z.B. so aus: ".36 private mylibprivate1".

@{b}private@{ub} Symbol    Definiert eine private Funktion, das angegebene
                           Symbol wird in der fd-Datei benutzt.

@{b}tagcall@{ub} Symbol    Fügt zur eigentlichen Funktion ein #pragma tagcall
                           mit dem angegebenen Symbol ein.

@{b}rem@{ub}               Fügt den Text in den folgenden Zeilen als Kommentar
                           in die jeweiligen Dateien ein.


Im beigefügten @{"Beispiel" link example/makelib.with/main} können die meisten dieser Kommandos in der Praxis
begutachtet werden.
Falls die Kommentare in den Dateien mal nicht so gut aussehen, es gibt
Editoren (wie z.B. den GoldED von Dietmar Eilert), die die Leerzeichen
am Ende einer Zeile automatisch entfernen.

@endnode


@node args "makelib - Argumente"

Die Argumente werden bei makelib benutzt, um Datei-spezifische Dinge
festzulegen. Für inhaltliche Dinge ist die @{"Konfigurationsdatei" link config} zu benutzen.

@{b}W=WITH/K@{ub}    Legt die zu benutzende Konfigurationsdatei fest. Standardmäßig
            wird "makelib.with" im aktuellen Verzeichnis benutzt.

@{b}FILE/A/M@{ub}    Die nach Funktionsköpfen, Prototypen und Library-Einsprungtabellen
            zu durchsuchenden Dateien (Muster erlaubt).

@{b}ALL/S@{ub}       auch Unterverzeichnisse werden durchsucht.

@{b}TO/K@{ub}        gibt das Basisverzeichnis für die zu erstellenden Dateien an.
            Z.B. "include:". Funktioniert nur, wenn NAME angegeben ist.

@{b}NAME/K@{ub}      legt den Basis-Namen der zu erstellenden Dateien fest, z.B.
            "mylib". Sorgt grundsätzlich dafür, daß die Dateien in "clib/",
            "pragmas/" und "proto/" angelegt werden.

@{b}FD/K@{ub}        legt den Namen der .fd-Datei an. Z.B. "fd:mylib_lib.fd". Die
            Datei wird nur erstellt, wenn diese Option gesetzt ist.

@{b}V=VERBOSE/S@{ub} Gibt ein paar zusätzliche Informationen aus.

@{b}Q=QUIET/S@{ub}   Gibt keinen Versionstext aus (Fehler und Warnungen werden nicht
            unterdrückt.

@{b}PROTOS/S@{ub}    Legt fest, daß nicht nur Funktionsköpfe, sondern auch Prototypes
            gescannt werden sollen.


Ein Beispielaufruf könnte so aussehen:

makelib gtdrag_includes.h gtdrag_lib.c to=include name=gtdrag fd=gtdrag_lib.fd protos

@endnode


@node remark "makelib - Zu beachten"

@{b}Funktionsköpfe@{ub} müssen in einer Zeile stehen und die Argumente müssen
  auch bei Prototypes benannt sein, damit makelib damit arbeiten kann
  (andernfalls wird gewarnt).
  Bislang werden die C-Schlüsselwörter "static" und "const" nicht erkannt,
  das kann sich aber bei diesbezüglichen Problemen durchaus noch ändern.

@{b}Library-Vektoren (Arrays)@{ub} werden erkannt, wenn das angegebene Symbol
  gefolgt von "[]", einer beliebigen Anzahl an White-Spaces und einem "="
  in einer Zeile steht (im äußersten Block).
  Die Elemente im folgenden Block werden als Definition dieses Library-Vektors
  benutzt.
  Im beigefügten @{"Beispiel" link example/gtdrag_lib.c/main} ist eine gültige Defition enthalten.

@endnode


@node author "makelib - Autor & Adresse"

Die Adresse für Bug-Reports, Ideen und andere Dinge:

@{b}Per Post:@{ub}
  pinc Software / Axel Dörfler
  Im Wiesengrund 3
  49205 Hasbergen

@{b}eMail-Adresse:@{ub}
  axeld@bigfoot.de (Axel Dörfler)
  (adoerfle@rz.uni-osnabrueck.de)

@{b}WWW:@{ub}
  www-lehre.informatik.uni-osnabrueck.de/~adoerfle/
  www.pinc-software.de/

Postkarten und andere Vergütungen sind natürlich erwünscht.

@endnode


@node distr "makelib - Urheberrecht & Distribution"

Das Urheberrecht an der Software und des gesamten Paketes liegt bei mir,
Axel Dörfler.

Zum jetzigen Zeitpunkt handelt es sich bei @{b}pinc Software@{ub} (siehe Info-Text)
nicht um eine juristische Person, sondern wird lediglich stellvertretend
genannt.

Die Software darf, solange kein kommerzielles Interesse gegeben ist und ihr dieses
Dokument beiliegt, frei kopiert und weitergegeben werden. Das schließt z.B. eine
Verbreitung über Aminet-CDs oder über das Internet ein.
Zuwiderhandlungen werden nach Inkenntnisnahme strafrechtlich verfolgt.

Für technische oder persönliche Probleme in Zusammenhang mit makelib kann ich
nicht haftbar gemacht werden. Sie benutzen das Programm auf ihr eigenes Risiko.

@endnode


@node history "makelib - History"

@{b}Version 1.0 (29.6.1999)@{ub}
 · erste Version


@endnode


@node e_main "makelib - Documentation"

@{b}makelib 1.3 (29.6.1999)@{ub}

Table of Contents:

  @{" Introduction     " link e_intro   } What's all about?
  @{" Installation     " link e_install }
  @{" Arguments        " link e_args    } how to use it
  @{" Configuration    " link e_config  } dto. :-)
  @{" Remarks          " link e_remark  } why it doesn't work
  @{" Author           " link e_author  } with address
  @{" Copyright Notice " link e_distr   }
  @{" History          " link e_history }

This document contains furthermore the following translations of the above:
  @{" Deutsch " link main}


Copyright ©1999 pinc Software. All Rights Reserved.

@endnode


@node e_intro "makelib - Introduction"
"makelib" is a small tool which extracts function headers and prototypes
out of standard ANSI-C-Source and automatically creates the following
files (replace mylib with your one of your project names):

 - clib/mylib_protos.h
 - pragmas/mylib_pragmas.h
 - proto/mylib.h
 - mylib_lib.fd

This reduce maintenance of these files and dependent errors to a
minimum. Furthermore, it provides a uniform look with the same
comments for all files.

The created files are compatible to the original includes made by
Commodore/Amiga Inc.. This includes SAS/C specific behaviour (several
#pragma commands).

Other programming languages may be used only in parts: the function
headers may be put into the @{"configuration file" link e_config}, the library vector
must not.
Since makelib only supports C-comments, you may find a way to work
around this.

@endnode


@node e_install "makelib - Installation"
To install the programme you simply copy it in the drawer you want it
to have. It's quite useful to choose one which is in the system path
like C:.

To use this programme within one of your projects, you also need to
make a configuration file for it.

The makelib requires OS 3.0 or higher. I test and developed it under
OS 3.0 where it runs perfectly (at least on my system :-).

@endnode


@node e_config "makelib - Configuration"
makelib will be configured with a special file for every project you use
it for. This file defaults to be "makelib.with" in the working directory.

They are two different kinds of commands, the global ones and the line-
dependent ones. Both of them are introduced with a point ('.') in the
first row of a line (e.g. ".bias 30").
Furthermore, the commands are scanned case-sensitive; they must be written
in lower case.

There are the following global commands:

@{b}base@{ub} name         Name of the Library-Base, e.g. MyLibBase

@{b}bias@{ub} offset       Decimal offset to the first function. Defaults to 30.

@{b}func@{ub} prototype    C-Prototype of a function which is implemented in
                  e.g. assembler only.

@{b}libvectors@{ub} symbol Specifies the C-symbol which is used for the library
                  function array. Defaults to "LibVectors".

@{b}table@{ub} symbol      Synonym for libvectors.

@{b}decimals@{ub}          If set, the function offset (in this file) are interpreted
                  as decimals rather than hexadecimals.

@{b}protoheader@{ub}       An "Introduction" for the mylib_protos.h-file in which
                  you may include C-Headers or the like.
                  The following lines to the next command will be used
                  for this.

The line-dependent commands are preceded by a hexadecimal (or a decimal, if
the @{b}decimals@{ub} command is set) number representing the function offset.
This number is identical to the LVO or the number in a #pragma-command.
Such a command may look like this: ".36 private mylibprivate1".

@{b}private@{ub} symbol    Defines a private function; the symbol will be used in
                           the fd-file.

@{b}tagcall@{ub} symbol    Adds a "#pragma tagcall" with the symbol to the normal
                  function.

@{b}rem@{ub}               Inserts the following lines as comments in every file.


You may have a look at the includes @{"example" link example/makelib.with/main} which makes use of most of the
the existing commands.
If your comments doesn't look nice in the created files, it may your
editor which cuts the succeding blanks of a line (e.g. Dietmar Eilert's
GoldED).

@endnode


@node e_args "makelib - Arguments"

"makelib" use the command line arguments to specify file-dependent things.
You use the @{"configuration-file" link e_config} for content-dependent things.

@{b}W=WITH/K@{ub}    Specifies the configuration file. Defaults to "makelib.with"
            in the current directory.

@{b}FILE/A/M@{ub}    The files being searched for function-headers, prototypes and
            library-vectors (patterns allowed).

@{b}ALL/S@{ub}       scans through sub-directories.

@{b}TO/K@{ub}        specifies the base directory for the files being created, e.g.
            "include:". Works only if NAME is specified.

@{b}NAME/K@{ub}      specifies the base name for the files being created, e.g.
            "mylib". Enables the creation of files in "clib/", "pragmas/",
            and "proto/".

@{b}FD/K@{ub}        specifies the name of the .fd-file, e.g. "fd:mylib_lib.fd". This
            file will be created only, if this option is set.

@{b}V=VERBOSE/S@{ub} prints out additional informations.

@{b}Q=QUIET/S@{ub}   Suppresses the version banner. (Errors and warnings are printed
            further on.)

@{b}PROTOS/S@{ub}    Set this flag if you want makelib to scan prototypes, too.


An example call may look like this:

makelib gtdrag_includes.h gtdrag_lib.c to=include name=gtdrag fd=gtdrag_lib.fd protos

@endnode


@node e_remark "makelib - Remarks"

@{b}Function-headers@{ub} must fit in one line. The arguments must be
  named even at prototypes to let makelib work with them (otherwise
  you will be warned).
  The C-keywords "static" and "const" aren't yet supported; this may
  change if you have problems with it.

@{b}Library-vectors (arrays)@{ub} are recognised if the specified symbol
  followed by "[]", a white-space and a "=" are in one row (in the outer
  block).
  The elements in the following block are presumed to be the library symbols
  used by this vector.
  You may have a look at this @{"example" link example/gtdrag_lib.c/main} where you can find a valid definition.

@endnode


@node e_author "makelib - Author & Address"

The Address for bug-reports, ideas and other hopefully useful things:

@{b}Via snail-mail:@{ub}
  pinc Software / Axel Dörfler
  Im Wiesengrund 3
  49205 Hasbergen

@{b}eMail-Address:@{ub}
  axeld@bigfoot.de (Axel Dörfler)
  (adoerfle@uni-osnabrueck.de)

@{b}WWW:@{ub}
  www-lehre.informatik.uni-osnabrueck.de/~adoerfle/
  www.pinc-software.de/

If you want to send small donations or cards - be welcome :)

@endnode


@node e_distr "makelib - Copyright Notice & Distribution"
The package is ©1999 by Axel Dörfler. All rights reserved.

As I wrote this, @{b}pinc Software@{ub} is not an existing
juristical person; it stands representively for me and no
other person.

You are allowed to copy it to BBS, Aminet and other free
shareware-pools as long as this documentation is included and
you are not following any commercial interest.

The usage of catool is at your own risk - I am not liable
for any problems you might have with it.

If you aren't sure what I try to tell you, please refer to the @{"German" link distr} part.

@endnode


@node e_history "makelib - History"

@{b}Version 1.0 (29.6.1999)@{ub}
 · initial version


@endnode

