@database file.stream.guide
@rem Source: class.c
@rem Generated with RoboDoc v3.1a (Jul  3 2005)
@rem RoboDoc is copyright 1994-1997 by Maverick Software Development
@node Main file.stream.guide
@{jcenter}
@{fg highlight}@{b}TABLE OF CONTENTS@{ub}@{fg text}

@{"file.stream/background        " Link "background"}
@{"file.stream/MMA_StreamLength  " Link "MMA_StreamLength"}
@{"file.stream/MMA_StreamMode    " Link "MMA_StreamMode"}
@{"file.stream/MMA_StreamName    " Link "MMA_StreamName"}
@{"file.stream/MMA_StreamPosBytes" Link "MMA_StreamPosBytes"}
@{"file.stream/MMA_StreamSeekable" Link "MMA_StreamSeekable"}
@{"file.stream/MMA_TaskPriority  " Link "MMA_TaskPriority"}
@{"file.stream/MMM_Pull          " Link "MMM_Pull"}
@{"file.stream/MMM_Push          " Link "MMM_Push"}
@{"file.stream/MMM_Seek          " Link "MMM_Seek"}
@{jleft}
@endnode
@Node "background" "file.stream/background"
@{fg shine}file.stream/background@{fg text}

@{b}DESCRIPTION@{ub}
       The class provides streams API for disk files on local and networked
       (for example SMBFS) filesystems. Every object of file.stream class
       creates a separate task. The task is acessing files using
       asyncio.library efficiently freeing the application of I/O load.
       A file.stream object can be safely shared between tasks (all
       operations are semaphore protected) with one important exception:
       object must be disposed by the task which created it. An object has
       only one port (number 0), it is input in write streams and output in
       read streams. Port format is MMF_STREAM.

       Object construction failure reasons

       @{"MMA_ErrorCode" Link "multimedia.class.guide/MMA_ErrorCode"} == MMERR_WRONG_ARGUMENTS:
       - no @{"MMA_StreamName" Link "MMA_StreamName"} specified.
       - unknown @{"MMA_StreamMode" Link "MMA_StreamMode"} specified.
       - specified MMA_TaskPriotity out of <-128, +127> range.

       @{"MMA_ErrorCode" Link "multimedia.class.guide/MMA_ErrorCode"} == MMERR_OUT_OF_MEMORY:
       - no memory for name string copy.

       @{"MMA_ErrorCode" Link "multimedia.class.guide/MMA_ErrorCode"} = MMERR_RESOURCE_MISSING:
       - message port creation failed.
       - subprocess creation failed.
       - no multimedia.class.
       - no asyncio.library.
       - no dos.library.

       @{"MMA_ErrorCode" Link "multimedia.class.guide/MMA_ErrorCode"} == MMERR_NO_STREAM:
       - specified file cannot be opened.


@{b}NEW ATTRIBUTES@{ub}
       Attributes applicability:
         I - may be set at creation time.
         S - may be set on an existing object.
         G - may be get from an object.
         P - may be set for an object's port.
         Q - may be queried from an object's port.

       @{"MMA_StreamLength" Link "MMA_StreamLength"}        (V50) [..G.Q], UQUAD*
       @{"MMA_TaskPriority" Link "MMA_TaskPriority"}        (V50) [ISG..], BYTE, optional on init
       @{"MMA_StreamName" Link "MMA_StreamName"}          (V50) [I.G.Q], STRPTR, required on init
       @{"MMA_StreamMode" Link "MMA_StreamMode"}          (V50) [I.G.Q], ULONG, optional on init
       @{"MMA_StreamSeekable" Link "MMA_StreamSeekable"}      (V50) [..G.Q], BOOL
       @{"MMA_ErrorCode" Link "multimedia.class.guide/MMA_ErrorCode"}           (V51) [ISG..], ULONG, optional on init
       @{"MMA_StreamPosBytes" Link "MMA_StreamPosBytes"}      (V51) [..G.Q], UQUAD*


@{b}NEW METHODS@{ub}
       @{"MMM_Pull" Link "MMM_Pull"}(port, buffer, length)      (V50)
       @{"MMM_Push" Link "MMM_Push"}(port, buffer, length)      (V50)
       @{"MMM_Seek" Link "MMM_Seek"}(port, type, position)      (V50)


@{b}NOTES@{ub}
       MMA_StreamHandle is not supported for file streams.


@endnode
@Node "MMA_StreamLength" "file.stream/MMA_StreamLength"
@{fg shine}file.stream/MMA_StreamLength@{fg text}

@{b}NAME@{ub}
       @{b}MMA_StreamLength@{ub} (V50) [..G.Q], UQUAD*


@{b}FUNCTION@{ub}
       Returns current file length in bytes.


@{b}NOTES@{ub}
       File length changes while writing. The attribute returns the file
       length at the time of query as returned by the filesystem.


@endnode
@Node "MMA_StreamMode" "file.stream/MMA_StreamMode"
@{fg shine}file.stream/MMA_StreamMode@{fg text}

@{b}NAME@{ub}
       @{b}MMA_StreamMode@{ub} (V50) [I.G.Q], ULONG


@{b}FUNCTION@{ub}
       Stream access mode. It can be MMA_StreamMode_Read (read only stream)
       or MMA_StreamMode_Write (write only stream).


@endnode
@Node "MMA_StreamName" "file.stream/MMA_StreamName"
@{fg shine}file.stream/MMA_StreamName@{fg text}

@{b}NAME@{ub}
       @{b}MMA_StreamName@{ub} (V50) [I.G.Q], STRPTR


@{b}FUNCTION@{ub}
       Name of file.stream is just path to a file. If @{"MMA_StreamMode" Link "MMA_StreamMode"} is
       MMA_StreamMode_Read, the file must exist already. For write mode the
       file may already exist (it will be overwritten) or not (it will be
       created). The path may be absolute, starting from volume name, or
       relative to application current dir (launched subtrhead inherits
       current directory). The name string is copied, so it may be passed
       as a local or dynamic variable.


@{b}NOTES@{ub}
       Using stream.class on not file oriented DOS devices (like CON: for
       example) is not recommended. It  will probably not work, or give
       unexpected results.


@endnode
@Node "MMA_StreamPosBytes" "file.stream/MMA_StreamPosBytes"
@{fg shine}file.stream/MMA_StreamPosBytes@{fg text}

@{b}NAME@{ub}
       @{b}MMA_StreamPosBytes@{ub} (V50) [..G.Q], UQUAD*


@{b}FUNCTION@{ub}
       Returns current stream pointer in bytes.


@{b}NOTES@{ub}
       64-bit attribute, in OM_GET pass a pointer to an UQUAD variable, in
       @{"MMM_GetPort" Link "multimedia.class.guide/MMM_GetPort"} pass pointer to UQUAD as well or use MediaGetPort64()
       macro.


@endnode
@Node "MMA_StreamSeekable" "file.stream/MMA_StreamSeekable"
@{fg shine}file.stream/MMA_StreamSeekable@{fg text}

@{b}NAME@{ub}
       @{b}MMA_StreamSeekable@{ub} (V50) [..G.Q], BOOL


@{b}FUNCTION@{ub}
       Returns TRUE if the stream is seekable, FALSE otherwise. All
       file.stream objects return TRUE here.


@endnode
@Node "MMA_TaskPriority" "file.stream/MMA_TaskPriority"
@{fg shine}file.stream/MMA_TaskPriority@{fg text}

@{b}NAME@{ub}
       @{b}MMA_TaskPriority@{ub} (V50) [ISG..], BYTE


@{b}FUNCTION@{ub}
       Priority of object's subtask. Defaults to 0.


@{b}NOTES@{ub}
       Do not change without a reason.


@endnode
@Node "MMM_Pull" "file.stream/MMM_Pull"
@{fg shine}file.stream/MMM_Pull@{fg text}

@{b}NAME@{ub}
       @{b}MMM_Pull@{ub} -- Reads a block of data from stream to a buffer. (V50)


@{b}SYNOPSIS@{ub}
       bytes = DoMethod(obj, @{b}MMM_Pull@{ub}, ULONG port, APTR buffer, ULONG
         length);


@{b}FUNCTION@{ub}
       Loads specified number of bytes into a buffer starting from current
       read pointer. This method works only for streams opened in read mode.


@{b}INPUTS@{ub}
       - obj, object to perform the method on.
       - port, must be 0, as it is the only port of a file.stream object.
       - buffer, a memory buffer for read data, must be allocated with
         MediaAllocMem().
       - length, amount of data to be read in bytes.


@{b}RESULT@{ub}
       - bytes, number of bytes read actually.

       Secondary error information available via @{"MMA_ErrorCode" Link "multimedia.class.guide/MMA_ErrorCode"} attribute:
       - MMERR_WRONG_ARGUMENTS - port is not 0, NULL buffer.
       - MMERR_RESOURCE_MISSING - message to the subtask cannot be sent.
       - MMERR_NOT_IMPLEMENTED - pulling from write-only stream.
       - MMERR_IO_ERROR - write operation failed.


@endnode
@Node "MMM_Push" "file.stream/MMM_Push"
@{fg shine}file.stream/MMM_Push@{fg text}

@{b}NAME@{ub}
       @{b}MMM_Push@{ub} -- Writes a block of data to stream from a buffer. (V50)


@{b}SYNOPSIS@{ub}
       bytes = DoMethod(obj, @{b}MMM_Push@{ub}, ULONG port, APTR buffer, ULONG
         length);


@{b}FUNCTION@{ub}
       Writes specified number of bytes into the stream.


@{b}INPUTS@{ub}
       - obj, object to perform the method on.
       - port, ignored.
       - buffer, a memory buffer containing data to be written, must be
         allocated with MediaAllocMem().
       - length, amount of data to write in bytes.


@{b}RESULT@{ub}
       - bytes, number of bytes written actually.
       Secondary error information available via @{"MMA_ErrorCode" Link "multimedia.class.guide/MMA_ErrorCode"} attribute:
       - MMERR_WRONG_ARGUMENTS - port is not 0, NULL buffer.
       - MMERR_RESOURCE_MISSING - message to the subtask cannot be sent.
       - MMERR_NOT_IMPLEMENTED - pushing to read-only stream.
       - MMERR_IO_ERROR - write operation failed.


@endnode
@Node "MMM_Seek" "file.stream/MMM_Seek"
@{fg shine}file.stream/MMM_Seek@{fg text}

@{b}NAME@{ub}
       @{b}MMM_Seek@{ub} -- Seeks in a file to specified absolute position. (V50)


@{b}SYNOPSIS@{ub}
       result = DoMethod(obj, @{b}MMM_Seek@{ub}, ULONG port, ULONG type,
       UQUAD *position);


@{b}FUNCTION@{ub}
       Seeks in a file to specified absolute position. Seeks past the end of
       file are truncated and MMERR_END_OF_DATA is reported. File.stream
       understand MMM_SEEK_BYTES type only.


@{b}INPUTS@{ub}
       - obj, object to perform the method on.
       - port, always 0, as it is the only port in a file.stream object.
       - type, MMM_SEEK_BYTES.
       - position, pointer to UQUAD variable containing desired position in
         the file.


@{b}RESULT@{ub}
       - result, boolean.
       Secondary error information available via @{"MMA_ErrorCode" Link "multimedia.class.guide/MMA_ErrorCode"} attribute:
       - MMERR_WRONG_ARGUMENTS - port is not 0, seek position out of LONG
         range.
       - MMERR_RESOURCE_MISSING - message to the subtask cannot be sent.
       - MMERR_SEEK_ERROR - seeking failed.


@endnode

