@database memory.stream.guide
@rem Source: class.c
@rem Generated with RoboDoc v3.1a (Jul  3 2005)
@rem RoboDoc is copyright 1994-1997 by Maverick Software Development
@node Main memory.stream.guide
@{jcenter}
@{fg highlight}@{b}TABLE OF CONTENTS@{ub}@{fg text}

@{"memory.stream/background        " Link "background"}
@{"memory.stream/MMA_StreamHandle  " Link "MMA_StreamHandle"}
@{"memory.stream/MMA_StreamLength  " Link "MMA_StreamLength"}
@{"memory.stream/MMA_StreamMode    " Link "MMA_StreamMode"}
@{"memory.stream/MMA_StreamName    " Link "MMA_StreamName"}
@{"memory.stream/MMA_StreamPosBytes" Link "MMA_StreamPosBytes"}
@{"memory.stream/MMA_StreamSeekable" Link "MMA_StreamSeekable"}
@{"memory.stream/MMM_Pull          " Link "MMM_Pull"}
@{"memory.stream/MMM_Push          " Link "MMM_Push"}
@{"memory.stream/MMM_Seek          " Link "MMM_Seek"}
@{jleft}
@endnode
@Node "background" "memory.stream/background"
@{fg shine}memory.stream/background@{fg text}

@{b}DESCRIPTION@{ub}
       The class allows for using a memory area as Reggae stream, so data
       can be accessed with common methods. Useful for example for media
       data embedded into executable file, or for streams generated by
       software. Memory.stream object has one port. This port has always
       number 0 and is output for read streams, input for write streams.

       Object construction failure reasons

       @{"MMA_ErrorCode" Link "multimedia.class.guide/MMA_ErrorCode"} == MMERR_WRONG_ARGUMENTS
       - @{"MMA_StreamName" Link "MMA_StreamName"} content is not a hexadecimal number,
       - @{"MMA_StreamName" Link "MMA_StreamName"}/@{"MMA_StreamHandle" Link "MMA_StreamHandle"} do not point to existing memory,
       - @{"MMA_StreamMode" Link "MMA_StreamMode"} is neither MMA_StreamMode_Read nor
         MMA_StreamMode_Write,
       - @{"MMA_StreamLength" Link "MMA_StreamLength"} greater than 2 GB,
       - @{"MMA_StreamLength" Link "MMA_StreamLength"} specified as 0,
       - @{"MMA_StreamLength" Link "MMA_StreamLength"} not specified at all,
       - Neither @{"MMA_StreamName" Link "MMA_StreamName"} nor @{"MMA_StreamHandle" Link "MMA_StreamHandle"} specified.

       @{"MMA_ErrorCode" Link "multimedia.class.guide/MMA_ErrorCode"} == MMERR_OUT_OF_MEMORY
       - @{"MMA_StreamName" Link "MMA_StreamName"} was specified and there is no memory for a local
         copy of it.



@{b}NEW ATTRIBUTES@{ub}
       Attributes applicability:
         I - may be set at creation time.
         S - may be set on an existing object.
         G - may be get from an object.
         P - may be set for an object's port.
         Q - may be queried from an object's port.

       @{"MMA_StreamName" Link "MMA_StreamName"}         (V50) [I.G.Q], STRPTR, required on init (1)
       @{"MMA_StreamHandle" Link "MMA_StreamHandle"}       (V50) [I.G.Q], ULONG, required on init (2)
       @{"MMA_StreamLength" Link "MMA_StreamLength"}       (V50) [I.G.Q], UQUAD*, required on init
       @{"MMA_StreamMode" Link "MMA_StreamMode"}         (V50) [I.G.Q], ULONG, optional on init
       @{"MMA_StreamPosBytes" Link "MMA_StreamPosBytes"}     (V50) [..G.Q], UQUAD*, optional on init
       @{"MMA_StreamSeekable" Link "MMA_StreamSeekable"}     (V51) [..G.Q], BOOL

       (1) required if @{"MMA_StreamHandle" Link "MMA_StreamHandle"} not specified
       (2) required if @{"MMA_StreamName" Link "MMA_StreamName"} not specified


@{b}NEW METHODS@{ub}
       @{"MMM_Pull" Link "MMM_Pull"}(port, buffer, length)            (V50)
       @{"MMM_Push" Link "MMM_Push"}(port, buffer, length)            (V50)
       @{"MMM_Seek" Link "MMM_Seek"}(port, type, position)            (V51)


@endnode
@Node "MMA_StreamHandle" "memory.stream/MMA_StreamHandle"
@{fg shine}memory.stream/MMA_StreamHandle@{fg text}

@{b}NAME@{ub}
       @{b}MMA_StreamHandle@{ub} [I.G.Q], ULONG


@{b}FUNCTION@{ub}
       Memory stream handle is just the address of memory buffer to be used
       as stream data. This address must not be random, especially in
       write mode. As there is no full memory protection, doing nasty things
       with a memory stream may cause system hang-up. Use static tables or
       memory allocated dynamically as stream data. One of @{b}MMA_StreamHandle@{ub}
       or @{"MMA_StreamName" Link "MMA_StreamName"} must be specified at object creation time. If both
       are specified, the name has the precedence. The attribute has no
       default value.


@{b}SEE ALSO@{ub}
       @{"MMA_StreamName" Link "MMA_StreamName"}, @{"MMA_StreamLength" Link "MMA_StreamLength"}


@endnode
@Node "MMA_StreamLength" "memory.stream/MMA_StreamLength"
@{fg shine}memory.stream/MMA_StreamLength@{fg text}

@{b}NAME@{ub}
       @{b}MMA_StreamLength@{ub} [I.G.Q], UQUAD*


@{b}FUNCTION@{ub}
       Unlike other streams, memory stream has no natural end (except of
       limit of CPU address space). That is why @{b}MMA_StreamLength@{ub} must be
       specified at object creation time. The value passed must be lower or
       equal to buffer size, so unallocated memory area is not damaged. The
       class ensures only specified memory area will be read or written.


@{b}EXAMPLE@{ub}
       Some examples of safe memory streams:

       UBYTE tab[1000];    (global variable)
       UQUAD len = 1000;
       ...
       @{"MMA_StreamHandle" Link "MMA_StreamHandle"}, (ULONG)tab, @{b}MMA_StreamLength@{ub}, (ULONG)&len,

       UBYTE *buf;
       UQUAD len = 2048;
       buf = AllocMem(2048, MEMF_ANY);
       ...
       @{"MMA_StreamHandle" Link "MMA_StreamHandle"}, (ULONG)buf, @{b}MMA_StreamLength@{ub}, (ULONG)&len,


@{b}NOTES@{ub}
       You can theoretically use local table as memory stream, but you must
       remember that this stream is valid only in the scope of this local
       table. It can easily become tricky and is not recommended.

       This attribute is 64-bit and as such is passed as a pointer to the
       actual value.


@{b}SEE ALSO@{ub}
       @{"MMA_StreamName" Link "MMA_StreamName"}, @{"MMA_StreamHandle" Link "MMA_StreamHandle"}


@endnode
@Node "MMA_StreamMode" "memory.stream/MMA_StreamMode"
@{fg shine}memory.stream/MMA_StreamMode@{fg text}

@{b}NAME@{ub}
       @{b}MMA_StreamMode@{ub} [I.G.Q], ULONG


@{b}FUNCTION@{ub}
       The attribute decides if data are to be read from a memory buffer,
       (MMA_StreamMode_Read), or written to it (MMA_StreamMode_Write). The
       default value of this attribute is MMA_StreamMode_Read, so it can be
       ommited for read streams.


@endnode
@Node "MMA_StreamName" "memory.stream/MMA_StreamName"
@{fg shine}memory.stream/MMA_StreamName@{fg text}

@{b}NAME@{ub}
       @{b}MMA_StreamName@{ub} [I.G.Q], STRPTR


@{b}FUNCTION@{ub}
       Name of a memory stream contains hexadecimal string of address of
       memory area to be used as stream data. This string should not contain
       prefixes like '0x' or '$'. Leading whitespaces are allowed, all
       spaces, tabs, CR and LF characters are stripped. Leading zeros are
       optional. This string is case insensitive for 'a' to 'f' digits (case
       may be mixed in one name too). One of @{b}MMA_StreamName@{ub} or
       @{"MMA_StreamHandle" Link "MMA_StreamHandle"} must be specified at object creation time. If both
       are specified, the name has the precedence. The attribute has no
       default value.


@{b}NOTES@{ub}
       A local copy of the passed string is made, so the string can be local
       variable or dynamic.


@{b}SEE ALSO@{ub}
       @{"MMA_StreamHandle" Link "MMA_StreamHandle"}


@endnode
@Node "MMA_StreamPosBytes" "memory.stream/MMA_StreamPosBytes"
@{fg shine}memory.stream/MMA_StreamPosBytes@{fg text}

@{b}NAME@{ub}
       @{b}MMA_StreamPosBytes@{ub} [..G.Q], UQUAD*


@{b}FUNCTION@{ub}
       Returns current stream read or write position in bytes.


@{b}NOTES@{ub}
       This attribute is 64-bit, storage should point to UQUAD variable.


@endnode
@Node "MMA_StreamSeekable" "memory.stream/MMA_StreamSeekable"
@{fg shine}memory.stream/MMA_StreamSeekable@{fg text}

@{b}NAME@{ub}
       @{b}MMA_StreamSeekable@{ub} (V50) [..G.Q], BOOL


@{b}FUNCTION@{ub}
       Returns TRUE if the stream is seekable, FALSE otherwise. All memory
        streams opened for reading are seekable, while opened for writing are
       not seekable.


@{b}SEE ALSO@{ub}
       @{"MMA_StreamMode" Link "MMA_StreamMode"}


@endnode
@Node "MMM_Pull" "memory.stream/MMM_Pull"
@{fg shine}memory.stream/MMM_Pull@{fg text}

@{b}NAME@{ub}
       @{b}MMM_Pull@{ub} -- Reads a data block from a stream. (V50)


@{b}SYNOPSIS@{ub}
       ULONG DoMethod(Object *obj, @{b}MMM_Pull@{ub}, ULONG port, APTR buffer, ULONG
         length);


@{b}FUNCTION@{ub}
       The method reads a block of data of given length from a port of
       specified object starting from current peek pointer position. Data
       may be pulled only from port 0 (as it is the only port existing in a
       memory.stream object), and only if @{"MMA_StreamMode" Link "MMA_StreamMode"} is set to
       MMA_StreamMode_Read. Pulls beyond stream length are cut and
       MMERR_END_OF_DATA is set as @{"MMA_ErrorCode" Link "multimedia.class.guide/MMA_ErrorCode"}.


@{b}INPUTS@{ub}
       obj - object to perform method on.
       port - memory.stream has only port 0.
       buffer - address of buffer for pulled data.
       length - number of bytes to pull.


@{b}RESULT@{ub}
       Number of bytes pulled actually. @{"MMA_ErrorCode" Link "multimedia.class.guide/MMA_ErrorCode"} contains secondary
       error information:
       - MMERR_END_OF_DATA if the end of stream has been reached.
       - MMERR_WRONG_ARGUMENTS if passed buffer is NULL.
       - MMERR_NOT_IMPLEMENTED if stream is in write mode.


@endnode
@Node "MMM_Push" "memory.stream/MMM_Push"
@{fg shine}memory.stream/MMM_Push@{fg text}

@{b}NAME@{ub}
       @{b}MMM_Push@{ub} -- Writes a data block to a stream. (V50)


@{b}SYNOPSIS@{ub}
       ULONG DoMethod(Object *obj, @{b}MMM_Push@{ub}, ULONG port, APTR buffer, ULONG
         length);


@{b}FUNCTION@{ub}
       The method writes a block of data of given length to a stream via
       port 0. Works only if memory stream object is created in write mode.
       If the block of data extends beyond stream length specified with
       @{"MMA_StreamLength" Link "MMA_StreamLength"} attribute, the write operation is cut at the stream
       end and @{"MMA_ErrorCode" Link "multimedia.class.guide/MMA_ErrorCode"} is set to MMERR_END_OF_DATA.


@{b}INPUTS@{ub}
       obj - object to perform method on.
       port - memory.stream has only port 0.
       buffer - address of buffer with data to be pushed
       length - number of bytes to push (0 is OK and means no-op).


@{b}RESULT@{ub}
       Number of bytes pushed actually. @{"MMA_ErrorCode" Link "multimedia.class.guide/MMA_ErrorCode"} contains secondary
       error information:
       - MMERR_END_OF_DATA if the end of stream has been reached.
       - MMERR_WRONG_ARGUMENTS if passed buffer is NULL.
       - MMERR_NOT_IMPLEMENTED if stream is in read mode.


@endnode
@Node "MMM_Seek" "memory.stream/MMM_Seek"
@{fg shine}memory.stream/MMM_Seek@{fg text}

@{b}NAME@{ub}
       @{b}MMM_Seek@{ub} -- Moves stream read pointer. (V51)


@{b}SYNOPSIS@{ub}
       ULONG DoMethod(Object *obj, @{b}MMM_Seek@{ub}, ULONG port, ULONG type,
         UQUAD *position);


@{b}FUNCTION@{ub}
       The method may be performed only if @{"MMA_StreamMode" Link "MMA_StreamMode"} is set to read
       mode. The read pointer of the stream is moved to the specified
       position, following @{"MMM_Pull" Link "MMM_Pull"} will read from there.


@{b}INPUTS@{ub}
       obj - object to perform method on.
       port - memory.stream has only port 0, so set to 0.
       type - type of seek, memory stream understands only MMM_SEEK_BYTES.
       position - a pointer to UQUAD variable containing new position.


@{b}RESULT@{ub}
       TRUE or FALSE if seek cannot be done. @{"MMA_ErrorCode" Link "multimedia.class.guide/MMA_ErrorCode"} contains
       secondary error information:
       - MMERR_END_OF_DATA - seek beyond @{"MMA_StreamLength" Link "MMA_StreamLength"}.
       - MMERR_WRONG_ARGUMENTS - port is not 0, not known type.
       - MMERR_NOT_IMPLEMENTED - type known, but not MMM_SEEK_BYTES.


@endnode

