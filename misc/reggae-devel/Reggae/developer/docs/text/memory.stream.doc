TABLE OF CONTENTS
0001 memory.stream/background
0002 memory.stream/MMA_StreamHandle
0003 memory.stream/MMA_StreamLength
0004 memory.stream/MMA_StreamMode
0005 memory.stream/MMA_StreamName
0006 memory.stream/MMA_StreamPosBytes
0007 memory.stream/MMA_StreamSeekable
0008 memory.stream/MMM_Pull
0009 memory.stream/MMM_Push
0010 memory.stream/MMM_Seek
memory.stream/background

DESCRIPTION
       The class allows for using a memory area as Reggae stream, so data
       can be accessed with common methods. Useful for example for media
       data embedded into executable file, or for streams generated by
       software. Memory.stream object has one port. This port has always
       number 0 and is output for read streams, input for write streams.

       Object construction failure reasons

       MMA_ErrorCode == MMERR_WRONG_ARGUMENTS
       - MMA_StreamName content is not a hexadecimal number,
       - MMA_StreamName/MMA_StreamHandle do not point to existing memory,
       - MMA_StreamMode is neither MMA_StreamMode_Read nor
         MMA_StreamMode_Write,
       - MMA_StreamLength greater than 2 GB,
       - MMA_StreamLength specified as 0,
       - MMA_StreamLength not specified at all,
       - Neither MMA_StreamName nor MMA_StreamHandle specified.

       MMA_ErrorCode == MMERR_OUT_OF_MEMORY
       - MMA_StreamName was specified and there is no memory for a local
         copy of it.



NEW ATTRIBUTES
       Attributes applicability:
         I - may be set at creation time.
         S - may be set on an existing object.
         G - may be get from an object.
         P - may be set for an object's port.
         Q - may be queried from an object's port.

       MMA_StreamName         (V50) [I.G.Q], STRPTR, required on init (1)
       MMA_StreamHandle       (V50) [I.G.Q], ULONG, required on init (2)
       MMA_StreamLength       (V50) [I.G.Q], UQUAD*, required on init
       MMA_StreamMode         (V50) [I.G.Q], ULONG, optional on init
       MMA_StreamPosBytes     (V50) [..G.Q], UQUAD*, optional on init
       MMA_StreamSeekable     (V51) [..G.Q], BOOL

       (1) required if MMA_StreamHandle not specified
       (2) required if MMA_StreamName not specified


NEW METHODS
       MMM_Pull(port, buffer, length)            (V50)
       MMM_Push(port, buffer, length)            (V50)
       MMM_Seek(port, type, position)            (V51)


memory.stream/MMA_StreamHandle

NAME
       MMA_StreamHandle [I.G.Q], ULONG


FUNCTION
       Memory stream handle is just the address of memory buffer to be used
       as stream data. This address must not be random, especially in
       write mode. As there is no full memory protection, doing nasty things
       with a memory stream may cause system hang-up. Use static tables or
       memory allocated dynamically as stream data. One of MMA_StreamHandle
       or MMA_StreamName must be specified at object creation time. If both
       are specified, the name has the precedence. The attribute has no
       default value.


SEE ALSO
       MMA_StreamName, MMA_StreamLength


memory.stream/MMA_StreamLength

NAME
       MMA_StreamLength [I.G.Q], UQUAD*


FUNCTION
       Unlike other streams, memory stream has no natural end (except of
       limit of CPU address space). That is why MMA_StreamLength must be
       specified at object creation time. The value passed must be lower or
       equal to buffer size, so unallocated memory area is not damaged. The
       class ensures only specified memory area will be read or written.


EXAMPLE
       Some examples of safe memory streams:

       UBYTE tab[1000];    (global variable)
       UQUAD len = 1000;
       ...
       MMA_StreamHandle, (ULONG)tab, MMA_StreamLength, (ULONG)&len,

       UBYTE *buf;
       UQUAD len = 2048;
       buf = AllocMem(2048, MEMF_ANY);
       ...
       MMA_StreamHandle, (ULONG)buf, MMA_StreamLength, (ULONG)&len,


NOTES
       You can theoretically use local table as memory stream, but you must
       remember that this stream is valid only in the scope of this local
       table. It can easily become tricky and is not recommended.

       This attribute is 64-bit and as such is passed as a pointer to the
       actual value.


SEE ALSO
       MMA_StreamName, MMA_StreamHandle


memory.stream/MMA_StreamMode

NAME
       MMA_StreamMode [I.G.Q], ULONG


FUNCTION
       The attribute decides if data are to be read from a memory buffer,
       (MMA_StreamMode_Read), or written to it (MMA_StreamMode_Write). The
       default value of this attribute is MMA_StreamMode_Read, so it can be
       ommited for read streams.


memory.stream/MMA_StreamName

NAME
       MMA_StreamName [I.G.Q], STRPTR


FUNCTION
       Name of a memory stream contains hexadecimal string of address of
       memory area to be used as stream data. This string should not contain
       prefixes like '0x' or '$'. Leading whitespaces are allowed, all
       spaces, tabs, CR and LF characters are stripped. Leading zeros are
       optional. This string is case insensitive for 'a' to 'f' digits (case
       may be mixed in one name too). One of MMA_StreamName or
       MMA_StreamHandle must be specified at object creation time. If both
       are specified, the name has the precedence. The attribute has no
       default value.


NOTES
       A local copy of the passed string is made, so the string can be local
       variable or dynamic.


SEE ALSO
       MMA_StreamHandle


memory.stream/MMA_StreamPosBytes

NAME
       MMA_StreamPosBytes [..G.Q], UQUAD*


FUNCTION
       Returns current stream read or write position in bytes.


NOTES
       This attribute is 64-bit, storage should point to UQUAD variable.


memory.stream/MMA_StreamSeekable

NAME
       MMA_StreamSeekable (V50) [..G.Q], BOOL


FUNCTION
       Returns TRUE if the stream is seekable, FALSE otherwise. All memory
      	streams opened for reading are seekable, while opened for writing are
       not seekable.


SEE ALSO
       MMA_StreamMode


memory.stream/MMM_Pull

NAME
       MMM_Pull -- Reads a data block from a stream. (V50)


SYNOPSIS
       ULONG DoMethod(Object *obj, MMM_Pull, ULONG port, APTR buffer, ULONG
         length);


FUNCTION
       The method reads a block of data of given length from a port of
       specified object starting from current peek pointer position. Data
       may be pulled only from port 0 (as it is the only port existing in a
       memory.stream object), and only if MMA_StreamMode is set to
       MMA_StreamMode_Read. Pulls beyond stream length are cut and
       MMERR_END_OF_DATA is set as MMA_ErrorCode.


INPUTS
       obj - object to perform method on.
       port - memory.stream has only port 0.
       buffer - address of buffer for pulled data.
       length - number of bytes to pull.


RESULT
       Number of bytes pulled actually. MMA_ErrorCode contains secondary
       error information:
       - MMERR_END_OF_DATA if the end of stream has been reached.
       - MMERR_WRONG_ARGUMENTS if passed buffer is NULL.
       - MMERR_NOT_IMPLEMENTED if stream is in write mode.


memory.stream/MMM_Push

NAME
       MMM_Push -- Writes a data block to a stream. (V50)


SYNOPSIS
       ULONG DoMethod(Object *obj, MMM_Push, ULONG port, APTR buffer, ULONG
         length);


FUNCTION
       The method writes a block of data of given length to a stream via
       port 0. Works only if memory stream object is created in write mode.
       If the block of data extends beyond stream length specified with
       MMA_StreamLength attribute, the write operation is cut at the stream
       end and MMA_ErrorCode is set to MMERR_END_OF_DATA.


INPUTS
       obj - object to perform method on.
       port - memory.stream has only port 0.
       buffer - address of buffer with data to be pushed
       length - number of bytes to push (0 is OK and means no-op).


RESULT
       Number of bytes pushed actually. MMA_ErrorCode contains secondary
       error information:
       - MMERR_END_OF_DATA if the end of stream has been reached.
       - MMERR_WRONG_ARGUMENTS if passed buffer is NULL.
       - MMERR_NOT_IMPLEMENTED if stream is in read mode.


memory.stream/MMM_Seek

NAME
       MMM_Seek -- Moves stream read pointer. (V51)


SYNOPSIS
       ULONG DoMethod(Object *obj, MMM_Seek, ULONG port, ULONG type,
         UQUAD *position);


FUNCTION
       The method may be performed only if MMA_StreamMode is set to read
       mode. The read pointer of the stream is moved to the specified
       position, following MMM_Pull will read from there.


INPUTS
       obj - object to perform method on.
       port - memory.stream has only port 0, so set to 0.
       type - type of seek, memory stream understands only MMM_SEEK_BYTES.
       position - a pointer to UQUAD variable containing new position.


RESULT
       TRUE or FALSE if seek cannot be done. MMA_ErrorCode contains
       secondary error information:
       - MMERR_END_OF_DATA - seek beyond MMA_StreamLength.
       - MMERR_WRONG_ARGUMENTS - port is not 0, not known type.
       - MMERR_NOT_IMPLEMENTED - type known, but not MMM_SEEK_BYTES.


