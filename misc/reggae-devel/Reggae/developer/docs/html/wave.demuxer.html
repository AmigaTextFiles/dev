<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML><HEAD>
<TITLE>wave.demuxer.html</TITLE>
<!-- Source: class.c -->
<!-- Generated with RoboDoc v3.1a (Jul  3 2005) -->
<!-- RoboDoc is copyright 1994-1997 by Maverick Software Development -->
</HEAD><BODY>
<H1 ALIGN="center">TABLE OF CONTENTS</H1>
<OL>
<LI><A HREF="#background">wave.demuxer/background</A>
<LI><A HREF="#MMA_BlockAlign">wave.demuxer/MMA_BlockAlign</A>
<LI><A HREF="#MMA_DataFormat">wave.demuxer/MMA_DataFormat</A>
<LI><A HREF="#MMA_MediaType">wave.demuxer/MMA_MediaType</A>
<LI><A HREF="#MMA_Sound_BitsPerSample">wave.demuxer/MMA_Sound_BitsPerSample</A>
<LI><A HREF="#MMA_Sound_Channels">wave.demuxer/MMA_Sound_Channels</A>
<LI><A HREF="#MMA_Sound_FrameCount">wave.demuxer/MMA_Sound_FrameCount</A>
<LI><A HREF="#MMA_Sound_SampleRate">wave.demuxer/MMA_Sound_SampleRate</A>
<LI><A HREF="#MMA_Sound_Volume">wave.demuxer/MMA_Sound_Volume</A>
<LI><A HREF="#MMA_StreamPosFrames">wave.demuxer/MMA_StreamPosFrames</A>
<LI><A HREF="#MMA_StreamPosTime">wave.demuxer/MMA_StreamPosTime</A>
<LI><A HREF="#MMM_Pull">wave.demuxer/MMM_Pull</A>
<LI><A HREF="#MMM_Seek">wave.demuxer/MMM_Seek</A>
</OL>
<HR>

<H2><A NAME="background">wave.demuxer/background</A></H2>

<FONT SIZE="+1">DESCRIPTION</FONT>
<PRE>   The class is a Reggae demultiplexer for WAVE (*.wav) sounds. WAVE format
   has many subformats and wave.demuxer will select matching decoder. The
   demuxer extracts header information ans passes sound data to the next
   processing stage. The demuxer recognizes following subformats:
     - type 1, uncompressed integer PCM,
     - type 3, uncompressed floating point PCM,
     - type 6, CCITT A-law PCM,
     - type 7, CCITT mu-law PCM,
     - type 17, IMA/DVI ADPCM,
     - type 85, MPEG-1 Audio Layer III.

   Port 0 (input) accepts MMF_STREAM.
   Port 1 (output) produces one of:
     - MMF_AUDIO_PCM8U (type 1, 8-bit)
     - MMF_AUDIO_PCM16LE (type 1, 16-bit)
     - MMF_AUDIO_PCM24LE (type 1, 24-bit)
     - MMF_AUDIO_PCM32LE (type 1, 32-bit)
     - MMF_AUDIO_PCMF32LE (type 3)
     - MMF_AUDIO_ALAW (type 6)
     - MMF_AUDIO_MULAW (type 7)
     - MMF_AUDIO_IMA_ADPCM (type 17)
     - MMF_AUDIO_MPEG (type 85)

   wave.demuxer is direct subclass of multimedia.class.

</PRE><FONT SIZE="+1">NEW ATTRIBUTES</FONT>
<PRE>   Attributes applicability:
     I - may be set at creation time.
     S - may be set on an existing object.
     G - may be get from an object.
     P - may be set for an object's port.
     Q - may be queried from an object's port.

   <A HREF="#MMA_DataFormat">MMA_DataFormat</A>           (V50) [..G.Q], STRPTR
   <A HREF="#MMA_MediaType">MMA_MediaType</A>            (V51) [..G.Q], ULONG
   <A HREF="#MMA_Sound_BitsPerSample">MMA_Sound_BitsPerSample</A>  (V50) [..G.Q], ULONG
   <A HREF="#MMA_Sound_Channels">MMA_Sound_Channels</A>       (V50) [..G.Q], ULONG
   <A HREF="#MMA_Sound_FrameCount">MMA_Sound_FrameCount</A>     (V50) [..G.Q], UQUAD*
   <A HREF="#MMA_Sound_SampleRate">MMA_Sound_SampleRate</A>     (V50) [..G.Q], ULONG
   <A HREF="#MMA_Sound_Volume">MMA_Sound_Volume</A>         (V50) [..G.Q], ULONG
   <A HREF="#MMA_StreamPosFrames">MMA_StreamPosFrames</A>      (V51) [..G.Q], UQUAD*
   <A HREF="#MMA_StreamPosTime">MMA_StreamPosTime</A>        (V51) [..G.Q], UQUAD*
   <A HREF="#MMA_BlockAlign">MMA_BlockAlign</A>           (V51) [..G.Q], ULONG

</PRE><FONT SIZE="+1">NEW METHODS</FONT>
<PRE>   <A HREF="#MMM_Pull">MMM_Pull</A>(port, buffer, length)  (V50)
   <A HREF="#MMM_Seek">MMM_Seek</A>(port, type, position)  (V51)

</PRE><FONT SIZE="+1">HISTORY</FONT>
<PRE>   51.5  (18.11.2006)
   - Added support for IMA ADPCM subformat.
   - Added <A HREF="#MMA_BlockAlign">MMA_BlockAlign</A> internal attribute.

   51.4  (08.01.2006)
   - Fixed seeking bug in SeekChunk(): current chunk position was not
     updated.

   51.3  (15.11.2005)
   - Fixed error forwarding in <A HREF="#MMM_Pull">MMM_Pull</A>.
   - Fix in ReadChunkBytes(), <A HREF="#MMM_Pull">MMM_Pull</A> is not called if data size is 0.

   51.2  (06.06.2005)
   - Added support for type 6 (CCITT A-law PCM) and type 7 (CCITT mu-law
     PCM).

   51.1  (05.06.2005)
   - Type 3 (floating point PCM) streams return 32 as
     <A HREF="#MMA_Sound_BitsPerSample">MMA_Sound_BitsPerSample</A>, 25 was misleading, as it didn't represent
     dynamic range properly.
   - Seeking implemented.

   50.5  (08.12.2004)
   - Separate MMM_Setup for every port.

   50.4  (26.11.2004)
   - Support for WAVE type 3 (floating point PCM).

   50.3  (22.11.2004)
   - WAVE MPEG-s are handled (using mpegaudio.decoder).

   50.2  (16.11.2004)
   - Implemented <A HREF="#MMA_DataFormat">MMA_DataFormat</A>.

   50.1  (23.10.2004)
   - Initial revision.

</PRE>
<HR>

<H2><A NAME="MMA_BlockAlign">wave.demuxer/MMA_BlockAlign</A></H2>

<FONT SIZE="+1">NAME</FONT>
<PRE>   <B>MMA_BlockAlign</B> (V51) [..G.Q], ULONG

</PRE><FONT SIZE="+1">FUNCTION</FONT>
<PRE>   Additional information for some of subformats. Used internally by
   some decoders.

</PRE>
<HR>

<H2><A NAME="MMA_DataFormat">wave.demuxer/MMA_DataFormat</A></H2>

<FONT SIZE="+1">NAME</FONT>
<PRE>   <B>MMA_DataFormat</B> (V50) [..G.Q], STRPTR

</PRE><FONT SIZE="+1">FUNCTION</FONT>
<PRE>   Returns read-only textual NULL-terminated description of decoded format.
   The description depends on WAVE subformat.

</PRE>
<HR>

<H2><A NAME="MMA_MediaType">wave.demuxer/MMA_MediaType</A></H2>

<FONT SIZE="+1">NAME</FONT>
<PRE>   <B>MMA_MediaType</B> (V51) [..G.Q], ULONG

</PRE><FONT SIZE="+1">FUNCTION</FONT>
<PRE>   Returns media type of object. All objects of wave.demuxer class return
   MMT_SOUND always.

</PRE>
<HR>

<H2><A NAME="MMA_Sound_BitsPerSample">wave.demuxer/MMA_Sound_BitsPerSample</A></H2>

<FONT SIZE="+1">NAME</FONT>
<PRE>   <B>MMA_Sound_BitsPerSample</B> (V50) [..G.Q], ULONG

</PRE><FONT SIZE="+1">FUNCTION</FONT>
<PRE>   Specifies number of significant bits in a single sound sample as found in
   the header.

</PRE>
<HR>

<H2><A NAME="MMA_Sound_Channels">wave.demuxer/MMA_Sound_Channels</A></H2>

<FONT SIZE="+1">NAME</FONT>
<PRE>   <B>MMA_Sound_Channels</B> (V50) [..G.Q], ULONG

</PRE><FONT SIZE="+1">FUNCTION</FONT>
<PRE>   Specifies number of channels in WAVE stream as found in the header.
   Reggae can process up to 256 channels (streams with more channels will be
   rejected). Subformat channel limit is usually lower than that.

</PRE>
<HR>

<H2><A NAME="MMA_Sound_FrameCount">wave.demuxer/MMA_Sound_FrameCount</A></H2>

<FONT SIZE="+1">NAME</FONT>
<PRE>   <B>MMA_Sound_FrameCount</B> (V50) [..G.Q], UQUAD*

</PRE><FONT SIZE="+1">FUNCTION</FONT>
<PRE>   Returns number of sample frames in the stream as specified in the header.

</PRE><FONT SIZE="+1">NOTES</FONT>
<PRE>   This is a 64-bit attribute passed by pointer to UQUAD variable, not by
   value.

</PRE>
<HR>

<H2><A NAME="MMA_Sound_SampleRate">wave.demuxer/MMA_Sound_SampleRate</A></H2>

<FONT SIZE="+1">NAME</FONT>
<PRE>   <B>MMA_Sound_SampleRate</B> (V50) [..G.Q], ULONG

</PRE><FONT SIZE="+1">FUNCTION</FONT>
<PRE>   Specifies sampling rate of WAVE stream as found in the header, measured
   in sample frames per seconds. Any integer value is accepted, but note
   that output devices (as well as many filters) may not accept extremely
   high values.

</PRE>
<HR>

<H2><A NAME="MMA_Sound_Volume">wave.demuxer/MMA_Sound_Volume</A></H2>

<FONT SIZE="+1">NAME</FONT>
<PRE>   <B>MMA_Sound_Volume</B> (V50) [..G.Q], ULONG

</PRE><FONT SIZE="+1">FUNCTION</FONT>
<PRE>   Specifies default sound volume relative to the maximum one. Range of this
   attribute is from 0 (silence) to 65536 including (full volume). Current
   version of wave.demuxer does not recognize any WAVE chunks containing
   volume information so this attribute returns 65536 always.

</PRE>
<HR>

<H2><A NAME="MMA_StreamPosFrames">wave.demuxer/MMA_StreamPosFrames</A></H2>

<FONT SIZE="+1">NAME</FONT>
<PRE>   <B>MMA_StreamPosFrames</B> (V51) [..G.Q], UQUAD*

</PRE><FONT SIZE="+1">FUNCTION</FONT>
<PRE>   Returns current absolute stream position in sample frames.

</PRE><FONT SIZE="+1">NOTES</FONT>
<PRE>   This is a 64-bit attribute passed by pointer to UQUAD variable, not by
   value.

</PRE>
<HR>

<H2><A NAME="MMA_StreamPosTime">wave.demuxer/MMA_StreamPosTime</A></H2>

<FONT SIZE="+1">NAME</FONT>
<PRE>   <B>MMA_StreamPosTime</B> (V51) [..G.Q], UQUAD*

</PRE><FONT SIZE="+1">FUNCTION</FONT>
<PRE>   Returns absolute stream time position in microseconds. This time position
   is strictly based on <A HREF="#MMA_Sound_SampleRate">MMA_Sound_SampleRate</A>, and reflects only the whole
   sample frames already pulled from the object output. The exact formula
   is:

   time_pos = whole_frames_pulled / <A HREF="#MMA_Sound_SampleRate">MMA_Sound_SampleRate</A>

</PRE><FONT SIZE="+1">NOTES</FONT>
<PRE>   This is a 64-bit attribute passed by pointer to UQUAD variable, not by
   value.

   Returned time is not in any way related to playback time for two reasons:
   firstly, there can be an unknown number of buffers between the
   demultiplexer and the output, secondly, playback samplerate may be
   different than those specified in the stream header.

</PRE><FONT SIZE="+1">SEE ALSO</FONT>
<PRE>   <A HREF="#MMA_Sound_SampleRate">MMA_Sound_SampleRate</A>

</PRE>
<HR>

<H2><A NAME="MMM_Pull">wave.demuxer/MMM_Pull</A></H2>

<FONT SIZE="+1">NAME</FONT>
<PRE>   <B>MMM_Pull</B> -- Loads a block of encoded data to a buffer. (V50)

</PRE><FONT SIZE="+1">SYNOPSIS</FONT>
<PRE>   bytes = DoMethod(obj, <B>MMM_Pull</B>, ULONG port, APTR buffer, ULONG length);

</PRE><FONT SIZE="+1">FUNCTION</FONT>
<PRE>   Loads specified number of bytes of WAVE encoded data into the buffer. As
   the class does not process the data, it does not copy them, just passes
   them through.

</PRE><FONT SIZE="+1">INPUTS</FONT>
<PRE>   - obj, object to perform the method on.
   - port, number of port is always 1 (the output port).
   - buffer, a memory buffer for pulled data, must be aligned to 16-byte
     boundary (preferrably allocated with <A HREF="multimedia.class.html#MediaAllocVec">MediaAllocVec</A>()).
   - length, amount of pulled data in bytes.

</PRE><FONT SIZE="+1">RESULT</FONT>
<PRE>   - bytes, number of bytes pulled actually.

</PRE><FONT SIZE="+1">SEE ALSO</FONT>
<PRE>   multimedia.class/<A HREF="multimedia.class.html#MediaAllocVec">MediaAllocVec</A>()

</PRE>
<HR>

<H2><A NAME="MMM_Seek">wave.demuxer/MMM_Seek</A></H2>

<FONT SIZE="+1">NAME</FONT>
<PRE>   <B>MMM_Seek</B> (V51)

</PRE><FONT SIZE="+1">SYNOPSIS</FONT>
<PRE>   success = DoMethod(obj, <B>MMM_Seek</B>, ULONG port, ULONG type, UQUAD*
   position);

</PRE><FONT SIZE="+1">FUNCTION</FONT>
<PRE>   Performs seek in PCM stream as found in WAVE file. As wave.demuxer object
   knows samplerate and frame size, only frame seek and time seek are
   supported.

</PRE><FONT SIZE="+1">INPUTS</FONT>
<PRE>   - obj, object to perform the method on.
   - port, number of port is always 1 (the output port).
   - type, seek type (MMM_SEEK_FRAMES, MMM_SEEK_TIME).
   - position, new, absolute position in the stream. For frame seek it is in
     frames, for time seek in microseconds. It is 64-bit parameter passed by
     a pointer to the value. Note that it is not playback time, see
     <A HREF="#MMA_StreamPosTime">MMA_StreamPosTime</A> for explanation.

</PRE><FONT SIZE="+1">RESULT</FONT>
<PRE>   TRUE if success, FALSE otherwise. Check <A HREF="multimedia.class.html#MMA_ErrorCode">MMA_ErrorCode</A> for detailed
   information.

</PRE><FONT SIZE="+1">SEE ALSO</FONT>
<PRE>   <A HREF="#MMA_Sound_SampleRate">MMA_Sound_SampleRate</A>, <A HREF="#MMA_StreamPosFrames">MMA_StreamPosFrames</A>, <A HREF="#MMA_StreamPosTime">MMA_StreamPosTime</A>,
   <A HREF="multimedia.class.html#MMA_ErrorCode">MMA_ErrorCode</A>

</PRE>
</BODY></HTML>
