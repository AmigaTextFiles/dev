<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML><HEAD>
<TITLE>file.stream.html</TITLE>
<!-- Source: class.c -->
<!-- Generated with RoboDoc v3.1a (Jul  3 2005) -->
<!-- RoboDoc is copyright 1994-1997 by Maverick Software Development -->
</HEAD><BODY>
<H1 ALIGN="center">TABLE OF CONTENTS</H1>
<OL>
<LI><A HREF="#background">file.stream/background</A>
<LI><A HREF="#MMA_StreamLength">file.stream/MMA_StreamLength</A>
<LI><A HREF="#MMA_StreamMode">file.stream/MMA_StreamMode</A>
<LI><A HREF="#MMA_StreamName">file.stream/MMA_StreamName</A>
<LI><A HREF="#MMA_StreamPosBytes">file.stream/MMA_StreamPosBytes</A>
<LI><A HREF="#MMA_StreamSeekable">file.stream/MMA_StreamSeekable</A>
<LI><A HREF="#MMA_TaskPriority">file.stream/MMA_TaskPriority</A>
<LI><A HREF="#MMM_Pull">file.stream/MMM_Pull</A>
<LI><A HREF="#MMM_Push">file.stream/MMM_Push</A>
<LI><A HREF="#MMM_Seek">file.stream/MMM_Seek</A>
</OL>
<HR>

<H2><A NAME="background">file.stream/background</A></H2>

<FONT SIZE="+1">DESCRIPTION</FONT>
<PRE>       The class provides streams API for disk files on local and networked
       (for example SMBFS) filesystems. Every object of file.stream class
       creates a separate task. The task is acessing files using
       asyncio.library efficiently freeing the application of I/O load.
       A file.stream object can be safely shared between tasks (all
       operations are semaphore protected) with one important exception:
       object must be disposed by the task which created it. An object has
       only one port (number 0), it is input in write streams and output in
       read streams. Port format is MMF_STREAM.

       Object construction failure reasons

       <A HREF="multimedia.class.html#MMA_ErrorCode">MMA_ErrorCode</A> == MMERR_WRONG_ARGUMENTS:
       - no <A HREF="#MMA_StreamName">MMA_StreamName</A> specified.
       - unknown <A HREF="#MMA_StreamMode">MMA_StreamMode</A> specified.
       - specified MMA_TaskPriotity out of &lt;-128, +127&gt; range.

       <A HREF="multimedia.class.html#MMA_ErrorCode">MMA_ErrorCode</A> == MMERR_OUT_OF_MEMORY:
       - no memory for name string copy.

       <A HREF="multimedia.class.html#MMA_ErrorCode">MMA_ErrorCode</A> = MMERR_RESOURCE_MISSING:
       - message port creation failed.
       - subprocess creation failed.
       - no multimedia.class.
       - no asyncio.library.
       - no dos.library.

       <A HREF="multimedia.class.html#MMA_ErrorCode">MMA_ErrorCode</A> == MMERR_NO_STREAM:
       - specified file cannot be opened.

</PRE><FONT SIZE="+1">NEW ATTRIBUTES</FONT>
<PRE>       Attributes applicability:
         I - may be set at creation time.
         S - may be set on an existing object.
         G - may be get from an object.
         P - may be set for an object's port.
         Q - may be queried from an object's port.

       <A HREF="#MMA_StreamLength">MMA_StreamLength</A>        (V50) [..G.Q], UQUAD*
       <A HREF="#MMA_TaskPriority">MMA_TaskPriority</A>        (V50) [ISG..], BYTE, optional on init
       <A HREF="#MMA_StreamName">MMA_StreamName</A>          (V50) [I.G.Q], STRPTR, required on init
       <A HREF="#MMA_StreamMode">MMA_StreamMode</A>          (V50) [I.G.Q], ULONG, optional on init
       <A HREF="#MMA_StreamSeekable">MMA_StreamSeekable</A>      (V50) [..G.Q], BOOL
       <A HREF="multimedia.class.html#MMA_ErrorCode">MMA_ErrorCode</A>           (V51) [ISG..], ULONG, optional on init
       <A HREF="#MMA_StreamPosBytes">MMA_StreamPosBytes</A>      (V51) [..G.Q], UQUAD*

</PRE><FONT SIZE="+1">NEW METHODS</FONT>
<PRE>       <A HREF="#MMM_Pull">MMM_Pull</A>(port, buffer, length)      (V50)
       <A HREF="#MMM_Push">MMM_Push</A>(port, buffer, length)      (V50)
       <A HREF="#MMM_Seek">MMM_Seek</A>(port, type, position)      (V50)

</PRE><FONT SIZE="+1">NOTES</FONT>
<PRE>       MMA_StreamHandle is not supported for file streams.

</PRE>
<HR>

<H2><A NAME="MMA_StreamLength">file.stream/MMA_StreamLength</A></H2>

<FONT SIZE="+1">NAME</FONT>
<PRE>       <B>MMA_StreamLength</B> (V50) [..G.Q], UQUAD*

</PRE><FONT SIZE="+1">FUNCTION</FONT>
<PRE>       Returns current file length in bytes.

</PRE><FONT SIZE="+1">NOTES</FONT>
<PRE>       File length changes while writing. The attribute returns the file
       length at the time of query as returned by the filesystem.

</PRE>
<HR>

<H2><A NAME="MMA_StreamMode">file.stream/MMA_StreamMode</A></H2>

<FONT SIZE="+1">NAME</FONT>
<PRE>       <B>MMA_StreamMode</B> (V50) [I.G.Q], ULONG

</PRE><FONT SIZE="+1">FUNCTION</FONT>
<PRE>       Stream access mode. It can be MMA_StreamMode_Read (read only stream)
       or MMA_StreamMode_Write (write only stream).

</PRE>
<HR>

<H2><A NAME="MMA_StreamName">file.stream/MMA_StreamName</A></H2>

<FONT SIZE="+1">NAME</FONT>
<PRE>       <B>MMA_StreamName</B> (V50) [I.G.Q], STRPTR

</PRE><FONT SIZE="+1">FUNCTION</FONT>
<PRE>       Name of file.stream is just path to a file. If <A HREF="#MMA_StreamMode">MMA_StreamMode</A> is
       MMA_StreamMode_Read, the file must exist already. For write mode the
       file may already exist (it will be overwritten) or not (it will be
       created). The path may be absolute, starting from volume name, or
       relative to application current dir (launched subtrhead inherits
       current directory). The name string is copied, so it may be passed
       as a local or dynamic variable.

</PRE><FONT SIZE="+1">NOTES</FONT>
<PRE>       Using stream.class on not file oriented DOS devices (like CON: for
       example) is not recommended. It  will probably not work, or give
       unexpected results.

</PRE>
<HR>

<H2><A NAME="MMA_StreamPosBytes">file.stream/MMA_StreamPosBytes</A></H2>

<FONT SIZE="+1">NAME</FONT>
<PRE>       <B>MMA_StreamPosBytes</B> (V50) [..G.Q], UQUAD*

</PRE><FONT SIZE="+1">FUNCTION</FONT>
<PRE>       Returns current stream pointer in bytes.

</PRE><FONT SIZE="+1">NOTES</FONT>
<PRE>       64-bit attribute, in OM_GET pass a pointer to an UQUAD variable, in
       <A HREF="multimedia.class.html#MMM_GetPort">MMM_GetPort</A> pass pointer to UQUAD as well or use MediaGetPort64()
       macro.

</PRE>
<HR>

<H2><A NAME="MMA_StreamSeekable">file.stream/MMA_StreamSeekable</A></H2>

<FONT SIZE="+1">NAME</FONT>
<PRE>       <B>MMA_StreamSeekable</B> (V50) [..G.Q], BOOL

</PRE><FONT SIZE="+1">FUNCTION</FONT>
<PRE>       Returns TRUE if the stream is seekable, FALSE otherwise. All
       file.stream objects return TRUE here.

</PRE>
<HR>

<H2><A NAME="MMA_TaskPriority">file.stream/MMA_TaskPriority</A></H2>

<FONT SIZE="+1">NAME</FONT>
<PRE>       <B>MMA_TaskPriority</B> (V50) [ISG..], BYTE

</PRE><FONT SIZE="+1">FUNCTION</FONT>
<PRE>       Priority of object's subtask. Defaults to 0.

</PRE><FONT SIZE="+1">NOTES</FONT>
<PRE>       Do not change without a reason.

</PRE>
<HR>

<H2><A NAME="MMM_Pull">file.stream/MMM_Pull</A></H2>

<FONT SIZE="+1">NAME</FONT>
<PRE>       <B>MMM_Pull</B> -- Reads a block of data from stream to a buffer. (V50)

</PRE><FONT SIZE="+1">SYNOPSIS</FONT>
<PRE>       bytes = DoMethod(obj, <B>MMM_Pull</B>, ULONG port, APTR buffer, ULONG
         length);

</PRE><FONT SIZE="+1">FUNCTION</FONT>
<PRE>       Loads specified number of bytes into a buffer starting from current
       read pointer. This method works only for streams opened in read mode.

</PRE><FONT SIZE="+1">INPUTS</FONT>
<PRE>       - obj, object to perform the method on.
       - port, must be 0, as it is the only port of a file.stream object.
       - buffer, a memory buffer for read data, must be allocated with
         MediaAllocMem().
       - length, amount of data to be read in bytes.

</PRE><FONT SIZE="+1">RESULT</FONT>
<PRE>       - bytes, number of bytes read actually.

       Secondary error information available via <A HREF="multimedia.class.html#MMA_ErrorCode">MMA_ErrorCode</A> attribute:
       - MMERR_WRONG_ARGUMENTS - port is not 0, NULL buffer.
       - MMERR_RESOURCE_MISSING - message to the subtask cannot be sent.
       - MMERR_NOT_IMPLEMENTED - pulling from write-only stream.
       - MMERR_IO_ERROR - write operation failed.

</PRE>
<HR>

<H2><A NAME="MMM_Push">file.stream/MMM_Push</A></H2>

<FONT SIZE="+1">NAME</FONT>
<PRE>       <B>MMM_Push</B> -- Writes a block of data to stream from a buffer. (V50)

</PRE><FONT SIZE="+1">SYNOPSIS</FONT>
<PRE>       bytes = DoMethod(obj, <B>MMM_Push</B>, ULONG port, APTR buffer, ULONG
         length);

</PRE><FONT SIZE="+1">FUNCTION</FONT>
<PRE>       Writes specified number of bytes into the stream.

</PRE><FONT SIZE="+1">INPUTS</FONT>
<PRE>       - obj, object to perform the method on.
       - port, ignored.
       - buffer, a memory buffer containing data to be written, must be
         allocated with MediaAllocMem().
       - length, amount of data to write in bytes.

</PRE><FONT SIZE="+1">RESULT</FONT>
<PRE>       - bytes, number of bytes written actually.
       Secondary error information available via <A HREF="multimedia.class.html#MMA_ErrorCode">MMA_ErrorCode</A> attribute:
       - MMERR_WRONG_ARGUMENTS - port is not 0, NULL buffer.
       - MMERR_RESOURCE_MISSING - message to the subtask cannot be sent.
       - MMERR_NOT_IMPLEMENTED - pushing to read-only stream.
       - MMERR_IO_ERROR - write operation failed.

</PRE>
<HR>

<H2><A NAME="MMM_Seek">file.stream/MMM_Seek</A></H2>

<FONT SIZE="+1">NAME</FONT>
<PRE>       <B>MMM_Seek</B> -- Seeks in a file to specified absolute position. (V50)

</PRE><FONT SIZE="+1">SYNOPSIS</FONT>
<PRE>       result = DoMethod(obj, <B>MMM_Seek</B>, ULONG port, ULONG type,
       UQUAD *position);

</PRE><FONT SIZE="+1">FUNCTION</FONT>
<PRE>       Seeks in a file to specified absolute position. Seeks past the end of
       file are truncated and MMERR_END_OF_DATA is reported. File.stream
       understand MMM_SEEK_BYTES type only.

</PRE><FONT SIZE="+1">INPUTS</FONT>
<PRE>       - obj, object to perform the method on.
       - port, always 0, as it is the only port in a file.stream object.
       - type, MMM_SEEK_BYTES.
       - position, pointer to UQUAD variable containing desired position in
         the file.

</PRE><FONT SIZE="+1">RESULT</FONT>
<PRE>       - result, boolean.
       Secondary error information available via <A HREF="multimedia.class.html#MMA_ErrorCode">MMA_ErrorCode</A> attribute:
       - MMERR_WRONG_ARGUMENTS - port is not 0, seek position out of LONG
         range.
       - MMERR_RESOURCE_MISSING - message to the subtask cannot be sent.
       - MMERR_SEEK_ERROR - seeking failed.

</PRE>
</BODY></HTML>
