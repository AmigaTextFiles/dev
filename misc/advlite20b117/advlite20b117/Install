; $Id: AutodocViewerLite_Installer v2.0 (9 November 1999)
; $VER: AutodocViewerLite_Installer v2.0 Copyright © 1994-1999 Ronny Tennebekk (9 November 1999)

(set @default-dest "SYS:")
(set #AutodocViewer "AutodocViewer Lite")
(set #Version "2.0")
(set #Date "12.11.1999")
(set #MinSystemVersion 39)
(set #AutodocViewerDirName "AutodocViewer")
(set #DocumentationDirName "Docs")
(set #ImagesDirName "Images")

;------------------------------------------------------------
; English strings
;------------------------------------------------------------

	; Message
		(set #Message
			(cat	"\nThank you very much for using\n\n"
				"--->>»» " #AutodocViewer " " #Version " ««<<---\n\n"
				"AutodocViewer is the most powerfull help tool for your\n"
				"Amiga developement environment\n"
				"by Ronny Tennebekk.\n\n\n\n"
				"Installscript ©1999 by Ronny Tennebekk\n\n"
			)
		)

		(set #EndMessage
			(cat
				"\nThe installation is now complete.\n\n"
				"If you have any problems, please check for help:\n\n"
				"http://home.c2i.net/regulus/\n"
				"email:autodocviewer@c2i.net\n"
			)
		)


	; Errors
		(set #Err-Bad-Kick
			(cat	"You need at least KickStart 3.0 to run " #AutodocViewer "!"
			)
		)

		(set #Err-Bad-CPU
			(cat	"You need at least a Motorola MC68020 CPU to run " #AutodocViewer "!"
			)
		)

	; Ask Paths
		(set #AskAdvPath
			(cat	"Where do you want to install " #AutodocViewer "?\n"
				"A directory called AutodocViewer will be created!"
			)
		)

		(set #AskLibPath "Where do you want to install the libraries?")
;		(set #AskDocPath "Where do you want to install the documentation?\nA directory called Docs will be created!")

	; Help
		(set #AskLibPathHelp
			(cat	"The directory where you have your libraries installed.\n"
				"Normally, this is the LIBS: directory.\n"
			)
		)

;		(set #AskDocPathHelp "The directory where you want to install the documentation\n")

		(set #AskAdvPathHelp
			(cat	"The directory where you want to install " #AutodocViewer "!\n"
				"This can be anywhere you want, a directory called "
				"AutodocViewer will be created.\n"
			)
		)

	; Information
;		(set #_SettingsChanged
;			(cat	"\n\nYour old settings file 'autodocviewer.settings',\n"
;				"has been renamed to 'autodocviewer.settings.old'.\n"
;			)
;		)


;------------------------------------------------------------
; Procedures Get Paths
;------------------------------------------------------------

(procedure proc_AskAdvPath
	(set #_advpath "SYS:")
	(set #_advpath
		(askdir	(prompt #AskAdvPath)
			(help #AskAdvPathHelp)
			(default #_advpath)
		)
	)
	(set #_advpath (tackon #_advpath #AutodocViewerDirName))
	(set #_imgpath (tackon #_advpath #ImagesDirName))
)

(procedure proc_AskLibPath
	(set #_libpath "LIBS:")
	(set #_libpath
		(askdir	(prompt #AskLibPath)
			(help #AskLibPathHelp)
			(default #_libpath)
		)
	)
)

;(procedure proc_AskDocPath
;	(set #_docpath #_advpath)
;	(set #_docpath
;		(askdir	(prompt #AskDocPath)
;			(help #AskDocPathHelp)
;			(default #_docpath)
;		)
;	)
;	(set #_docpath (tackon #_docpath #DocumentationDirName))
;)

;------------------------------------------------------------
; Main procdure
;------------------------------------------------------------

(message #Message (all))

(if
	(< (getversion) (* #MinSysVersion 65536))
	(abort #Err-Bad-Kick)
)

(if
	(patmatch "(68000|68010)" (database "cpu"))
	(abort #Err-Bad-Cpu)
)

(complete 10)

(proc_AskAdvPath)

(complete 15)

(if (= (exists #_advpath (noreq)) 0)
	(makedir #_advpath)
)

(complete 20)

(if (= (exists #_imgpath (noreq)) 0)
	(makedir #_imgpath)
)

(complete 25)

(proc_AskLibPath)

;(proc_AskDocPath)

;(if (= (exists #_docpath (noreq)) 0)
;	(makedir #_docpath)
;)

(complete 30)

(copyfiles
	(source "AutodocViewer")
	(dest #_advpath)
	(infos)
)

(complete 40)

(copyfiles
	(prompt "Copying images...")
	(source "images")
	(dest #_imgpath)
	(all)
)

(complete 85)

;(copyfiles
;	(prompt "Copying documentation...")
;	(source "Documentation")
;	(dest #_docpath)
;	(all)
;)

(complete 90)

(copylib
	(prompt "Copying autodoc.library...")
	(help @copylib-help)
	(source "libs/autodoc.library")
	(dest #_libpath)
	(confirm)
)

(if (= (exists (tackon #_advpath "autodocviewer.settings")))
	(rename (tackon #_advpath "autodocviewer.settings") (tackon #_advpath "autodocviewer.settings.old"))
;	(message #_SettingsChanged (all))
)

;------------------------------------------------------------
; Installization complete
;------------------------------------------------------------

(complete 100)
(exit #EndMessage)
