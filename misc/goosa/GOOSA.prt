Deck "GOOSA_deck"
   ;made with DECK2ASCII DEMO:, (c) 1996 by Christian Effenberger - and cando.library 3.008, (c) 1994 by INOVAtronics Inc.

   Routine "CheckForAttribute"
      ; ------------------------------------------------
      ; CheckForAttribute( Array, Number ) Subroutine.
      ; ------------------------------------------------
      
      Let LastAttrib = LastArrayIndex( Arg1.AttrArray )
      Let Count      = 0
      
      While Count < LastAttrib
         If Arg1.AttrArray[Count] = Arg2
            WorkWithDocument "ReturnList"
            Clear DOCUMENT 
            Type "TRUE",NEWLINE              ;Attribute already exists!
            ExitScript TRUE
         EndIf
         
         Let Count = Count + 1
      EndLoop
      
      WorkWithDocument "ReturnList"
      Clear DOCUMENT 
      Type "FALSE",NEWLINE 
      
      ExitScript FALSE
   EndScript
   Routine "CleanOffName"
      ; ---------------------------------------------
      ; CleanOffName( name ) Subroutine.
      ; ---------------------------------------------
      
      Let Strng = Arg1
      Let Loc   = FindChars( Strng, ":", 1 )
      Let Strng = RemoveChars( Strng, 1, Loc )
      
      Do "DEBUG","Strng -->"||Strng||"<-- Arg1 -->"||Arg1||"<--"
      
      Let Arg1  = TrimString( Strng )
   EndScript
   Routine "DrawRaisedBox"
      ; ----------------------------------------
      ; DrawRaisedBox( x, y, w, h ) SubRoutine.
      ; ----------------------------------------
      
      DrawBorder Arg1,Arg2,Arg3,Arg4,BEVEL ,2,1
      
   EndScript
   Routine "HandleARexxError"
      ; -----------------------------------------
      ; HandleARexxError() subroutine.
      ; -----------------------------------------
      
      WorkWithDocument "ARexxError"
      
      SetPen 2 ; RED!                          ;Expand later to include
      
      Type "Error Received!",NEWLINE            ;decoding error codes from
      
      Type "Error Code is: "||Arg1,NEWLINE      ;datamanager!
      
      Type "Message: "||TheMessage,NEWLINE 
      
      Do "DEBUG","ARexx Error = "||Arg1,2
   EndScript
   Routine "PrintToPAR"
      ; ------------------------------------------------
      ;PrintToPAR( docname ) subroutine.
      ; ------------------------------------------------
      
      Local maxline
      Local index
      
      SetFileBufferSize 8
      
      OpenFile "PAR:","OutBuffer",WRITEONLY ,NEWFILE 
      
      WorkWithDocument Arg1
      MoveCursorTo STARTOF DOCUMENT 
      
      Let maxline = LinesInDocument
      Let index   = 0
      
      FileWriteLine "OutBuffer",""
      FileWriteLine "OutBuffer",""
      FileWriteLine "OutBuffer",""
      
      While index < maxline
         If index = PageSize - 3
            FileWriteLine "OutBuffer",""   ;PageBreak!
            FileWriteLine "OutBuffer",""
            FileWriteLine "OutBuffer",""
            FileWriteLine "OutBuffer",""
            FileWriteLine "OutBuffer",""
            FileWriteLine "OutBuffer",""
         EndIf
         
         FileWriteLine "OutBuffer",TheLine
         MoveCursor DOWN 
         
         Let index = index + 1
      EndLoop
      
      Close "OutBuffer"
   EndScript
   Routine "PrintToSER"
      ; ------------------------------------
      ; PrintToSER( docname ) subroutine.
      ; ------------------------------------
      
      Local maxline
      Local index
      
      SetFileBufferSize 8
      
      OpenFile "SER:","OutBuffer",WRITEONLY ,NEWFILE 
      
      WorkWithDocument Arg1
      MoveCursorTo STARTOF DOCUMENT 
      
      Let maxline = LinesInDocument
      Let index   = 0
      
      FileWriteLine "OutBuffer",""
      FileWriteLine "OutBuffer",""
      FileWriteLine "OutBuffer",""
      
      While index < maxline
         If index = PageSize - 3
            FileWriteLine "OutBuffer",""
            FileWriteLine "OutBuffer",""
            FileWriteLine "OutBuffer",""
            FileWriteLine "OutBuffer",""
            FileWriteLine "OutBuffer",""
            FileWriteLine "OutBuffer",""
         EndIf
         
         FileWriteLine "OutBuffer",TheLine
         MoveCursor DOWN 
         
         Let index = index + 1
      EndLoop
      
      Close "OutBuffer"
   EndScript
   Routine "SendARexxMessage"
      ; -----------------------------------------
      ; SendARexxMessage() SubRoutine.
      ; -----------------------------------------
      
      If CurrentPortName <> NOTHING
         Let ToBeSent = TextFrom( "MessageField" )
         
         If ExpectResults = FALSE
            SendMessage ToBeSent,NORESULTS 
            
            If MessageErrorCode <> 0
               Do "HandleARexxError"
            EndIf
         Else
            SendMessage ToBeSent
            
            If MessageErrorCode <> 0
               Do "HandleARexxError"
            EndIf
         EndIf
         
         WorkWithDocument "ARexxResult"
         MoveCursorTo ENDOF DOCUMENT 
         Type ToBeSent,NEWLINE 
         Type MessageErrorCode||":"||MessageReturned,NEWLINE 
      EndIf
   EndScript
   Routine "SendARexxMsg"
      ; --------------------------------
      ; SendARexxMsg() Subroutine.
      ; --------------------------------
      
      Do "SendArexxMessage"
      
      If MessageErrorCode <> 0
         Do "HandleARexxError"
      EndIf
      
      WorkWithDocument "ARexxResult"
      Type MessageReturned,NEWLINE 
      Type TheMessage,NEWLINE 
   EndScript
   Routine "SetARexxPortList"
      ; ---------------------------------------
      ; SetARexxPortList() subroutine.
      ; ---------------------------------------
      
      WorkWithDocument "ARexxPortList"
      Clear DOCUMENT 
      InsertMessagePortList
      
      SortDocument NOCASE 
      
      Loop
         Delete LINE 
      Until TrimString( TheLine ) <> NOTHING
      
      SetWordDelimiters ""
      
      If CurrentPortName <> NOTHING
         SearchFor CurrentPortName,BYWORD 
         Do "SetSpeakAddress"
      EndIf
   EndScript
   Routine "SetSpeakAddress"
      ; -------------------------------
      ; SetSpeakAddress() subroutine.
      ; -------------------------------
      
      WorkWithDocument "ARexxPortList"
      
      If TheLine <> NOTHING AND CurrentPortName <> TheLine
         Let CurrentPortName = TheLine
         SpeakTo TheLine
         
         IfError
            Do "HandleARexxError"
            ExitScript
         EndIf
         
         SetText "CurrentPort",TheLine
         WorkWithDocument "ARexxResult"
         Clear DOCUMENT 
      EndIf
   EndScript
   Routine "SpaceOutTab"
      ; --------------------------------------
      ; SpaceOutTab( outstring ) subroutine.
      ; --------------------------------------
      
      Local count
      
      Let count = 0
      
      While count < TabSize
         Let Arg1  = Arg1||" "
         Let count = count + 1
      EndLoop
   EndScript
   Routine "CorrectFileName"
      ; --------------------------------------------
      ; CorrectFileName( filename, ext ) Subroutine
      ; --------------------------------------------
      
      Local msg
      Local ttl
      Local ans
      
      Let ttl = "User ERROR:"
      Let msg = "File name "||Arg1||Char(10)
      Let msg = msg||" did NOT have extension "||Arg2||Char(10)||Char(10)
      Let msg = msg||"    Should I combine them?"
      
      Let ans = AskForResponse( msg, ttl, "YES!|NO!" )
      
      If ans = 1
         Let ans = Arg1||Arg2
      Else
         Let ans = NOTHING
      EndIf
      
      ExitScript ans
   EndScript
   Routine "ReadInAll"
      ; --------------------------------------------------
      ; ReadInAll( database_filename ) SubRoutine.
      ; --------------------------------------------------
      
      Local filename
      
      Let filename = Arg1||".Assocs"
      
      If Exists( filename ) AND filename <> NOTHING
         SetWindowTitle "Reading in Associations..."
         Delay 0,0,5
         Let Association = LoadVariable( filename )
         Let C_Assoc     = FirstArrayIndex( Association )
      EndIf
      
      Let filename = Arg1||".Attrs"
      
      If Exists( filename ) AND filename <> NOTHING
         SetWindowTitle "Reading in Attributes..."
         Delay 0,0,5
         Let Attribute = LoadVariable( filename )
         Let C_Attr    = FirstArrayIndex( Attribute )
      EndIf
      
      Let filename = Arg1||".BDEs"
      
      If Exists( filename ) AND filename <> NOTHING
         SetWindowTitle "Reading in Behavior Descriptive Entries..."
         Delay 0,0,5
         Let BDE   = LoadVariable( filename )
         Let C_BDE = FirstArrayIndex( BDE )
      EndIf
      
      Let filename = Arg1||".Caps"
      
      If Exists( filename ) AND filename <> NOTHING
         SetWindowTitle "Reading in Capabilities..."
         Delay 0,0,5
         Let Capability = LoadVariable( filename )
         Let C_Cap      = FirstArrayIndex( Capability )
      EndIf
      
      Let filename = Arg1||".CDEs"
      
      If Exists( filename ) AND filename <> NOTHING
         SetWindowTitle "Reading in Context Descriptive Entries..."
         Delay 0,0,5
         Let CDE   = LoadVariable( filename )
         Let C_CDE = FirstArrayIndex( CDE )
      EndIf
      
      Let filename = Arg1||".Comps"
      
      If Exists( filename ) AND filename <> NOTHING
         SetWindowTitle "Reading in Composite Objects..."
         Delay 0,0,5
         Let Composite = LoadVariable( filename )
         Let C_Comp    = FirstArrayIndex( Composite )
      EndIf
      
      Let filename = Arg1||".IDEs"
      
      If Exists( filename ) AND filename <> NOTHING
         SetWindowTitle "Reading in Information Descriptive Entries..."
         Delay 0,0,5
         Let IDE   = LoadVariable( filename )
         
         SortArray IDE,INTEGER ASCENDING ,".NUMBER"
         
         Let C_IDE = FirstArrayIndex( IDE )
      EndIf
      
      Let filename = Arg1||".Norms"
      
      If Exists( filename ) AND filename <> NOTHING
         SetWindowTitle "Reading in Normal Objects..."
         Delay 0,0,5
         Let Normal = LoadVariable( filename )
         Let C_Norm = FirstArrayIndex( Normal )
      EndIf
      
      Let filename = Arg1||".OCTs"
      
      If Exists( filename ) AND filename <> NOTHING
         SetWindowTitle "Reading in Object Communication Tables..."
         Delay 0,0,5
         Let OCT   = LoadVariable( filename )
         Let C_OCT = FirstArrayIndex( OCT )
      EndIf
      
      Let filename = Arg1||".PDEs"
      
      If Exists( filename ) AND filename <> NOTHING
         SetWindowTitle "Reading in Process Descriptive Entries..."
         Delay 0,0,5
         Let PDE   = LoadVariable( filename )
         Let C_PDE = FirstArrayIndex( PDE )
      EndIf
      
      Let filename = Arg1||".Procs"
      
      If Exists( filename ) AND filename <> NOTHING
         SetWindowTitle "Reading in Processes..."
         Delay 0,0,5
         Let Process = LoadVariable( filename )
         Let C_Proc  = FirstArrayIndex( Process )
      EndIf
      
      Let filename = Arg1||".Rels"
      
      If Exists( filename ) AND filename <> NOTHING
         SetWindowTitle "Reading in Object Relationships..."
         Delay 0,0,5
         Let Relation = LoadVariable( filename )
         Let C_Rel    = FirstArrayIndex( Relation )
      EndIf
      
      Let filename = Arg1||".Reqs"
      
      If Exists( filename ) AND filename <> NOTHING
         SetWindowTitle "Reading in User Requirements..."
         Delay 0,0,5
         Let Requirement = LoadVariable( filename )
         Let C_Req       = FirstArrayIndex( Requirement )
      EndIf
      
      Let filename = Arg1||".States"
      
      If Exists( filename ) AND filename <> NOTHING
         SetWindowTitle "Reading in States..."
         Delay 0,0,5
         Let State   = LoadVariable( filename )
         Let C_State = FirstArrayIndex( State )
      EndIf
      
      Let filename = Arg1||".Supers"
      
      If Exists( filename ) AND filename <> NOTHING
         SetWindowTitle "Reading in SuperType Objects..."
         Delay 0,0,5
         Let Supertype = LoadVariable( filename )
         Let C_Super   = FirstArrayIndex( Supertype )
      EndIf
      
      Let filename = Arg1||".Subs"
      
      If Exists( filename ) AND filename <> NOTHING
         SetWindowTitle "Reading in SubType Objects..."
         Delay 0,0,5
         Let Subtype = LoadVariable( filename )
         Let C_Sub   = FirstArrayIndex( Subtype )
      EndIf
      
      Let filename = Arg1||".TechNotes"
      
      If Exists( filename ) AND filename <> NOTHING
         SetWindowTitle "Reading in Technical Notes..."
         Delay 0,0,5
         Let UReq     = LoadVariable( filename )
         Let C_UReq   = FirstArrayIndex( UReq )
      EndIf
      
      SetWindowTitle Arg2 ; Restore Window Title.
   EndScript
   Routine "PrintToFile"
      ; --------------------------------------------
      ; PrintToFile( prompt, docname ) subroutine.
      ; --------------------------------------------
      
      Local maxline
      Local index
      Local filename
      Local linecnt
      Local pgcnt
      
      Let filename = AskForFileName( StartupPath, Arg1, 10, 13 )
      
      SetFileBufferSize 8
      
      If filename = NOTHING
         ExitScript
      EndIf
      
      OpenFile filename,"OutBuffer",WRITEONLY ,NEWFILE 
      WorkWithDocument Arg2
      MoveCursorTo STARTOF DOCUMENT 
      
      Let maxline = LinesInDocument
      Let index   = 0
      
      FileWriteLine "OutBuffer",""
      FileWriteLine "OutBuffer",""
      FileWriteLine "OutBuffer",""
      
      Let linecnt = 3
      Let pgcnt   = 1
      
      While index < maxline
         
         If linecnt = PageSize - 3
            FileWriteLine "OutBuffer","" ;PageBreak!
            FileWriteLine "OutBuffer","     <Page "||pgcnt||">"
            FileWriteLine "OutBuffer",""
            FileWriteLine "OutBuffer",""
            FileWriteLine "OutBuffer",""
            FileWriteLine "OutBuffer",""
            
            Let linecnt = 0
            Let pgcnt   = pgcnt + 1
         EndIf
         
         FileWriteLine "OutBuffer",TheLine
         MoveCursor DOWN 
         
         Let index   = index + 1
         Let linecnt = linecnt + 1
      EndLoop
      
      Close "OutBuffer"
   EndScript
   Routine "EmptyString"
      ; --------------------------------------------
      ; EmptyString( strvariable ) SubFunction.
      ; See if the variable is an empty string.
      ; --------------------------------------------
      
      If TrimString( Arg1 ) = NOTHING
         ExitScript TRUE
      Else
         ExitScript FALSE
      EndIf
   EndScript
   Routine "DEBUG"
      ; ------------------------------------------
      ; DEBUG( msg, delay ) Subroutine.
      ; ------------------------------------------
      
      Local title
      
      Let title = WindowTitle
      
      SetWindowTitle Arg1
      
      If Arg2 <> 0
         Delay 0,Arg2,0
      Else
         Delay 0,1,30
      EndIf
      
      SetWindowTitle title
   EndScript
   Routine "HandleInternalError"
      ; --------------------------------------------
      ; HandleInternalError SubRoutine.
      ; --------------------------------------------
      
      Local cr
      Local ans
      Local msg
      
      Let DeathCount = DeathCount + 1
      
      Let cr  = Char( 10 )
      
      Let msg = DeckName||" internal error encountered!"||cr
      Let msg = msg||"Line      #:  "||ErrorLineNumber||cr
      Let msg = msg||"Script Name:  "||ErrorScriptName||cr
      Let msg = msg||"Error  Code:  "||ErrorCode||cr
      Let msg = msg||"Error  Text:  "||ErrorText||cr
      Let msg = msg||"Line:  "||ErrorSourceLine||cr
      Let msg = msg||"Make a note & report it to the Author!"||cr||cr
      Let msg = msg||"Do you want to continue?"
      
      Let ans = AskForResponse( msg, "Program ERROR:", "CONTINUE|ABORT!")
      
      If Supervised = TRUE AND DeathCount > 2
         Let DeathCount = 0
         StopScript -1
      EndIf
      
      If ans = 2
         Do "RestoreOldColors"
         Quit
      EndIf
   EndScript
   Routine "SaveGraphic"
      ; ----------------------------------------------
      ; SaveGraphic( asltitle,x,y,w,h ) SubRoutine.
      ; ----------------------------------------------
      
      Local fname
      Local ttl
      Local ans
      Local msg
      
      Let fname = AskForFileName( TheCurrentDirectory, Arg1, 50, 16 )
      
      If Exists( fname ) AND fname <> NOTHING
         Let msg = "filename "||fname||" will be OVER-WRITTEN!"||Char(10)
         Let msg = msg||"  Continue?"
         Let ttl = "User WARNING:"
         
         Let ans = AskForResponse( msg, ttl, "Over-Write!|CANCEL!" )
         
         If ans = 2
            ExitScript
         Else
            ClipBrush Arg2,Arg3,Arg4,Arg5,"savebrush"
            SaveBrush "savebrush",fname
         EndIf
      Else
         ClipBrush Arg2,Arg3,Arg4,Arg5,"savebrush"
         SaveBrush "savebrush",fname
      EndIf
   EndScript
   Routine "TypeCapStrings"
      ; ----------------------------------------------
      ; TypeCapStrings( Objects[].ID ) subroutine
      ; ----------------------------------------------
      
      Local idx
      Local i
      
      Let idx = FirstArrayIndex( IST )
      
      While idx <= LastArrayIndex( IST )
         If IST[idx].ObjectName = Arg1
            
            If NumberOfChars( TheLine ) + NumberOfChars( IST[idx].CapString ) <= LineLength
               Type IST[idx].CapString||", "
            Else
               Type "",NEWLINE 
               Type IST[idx].CapString||", "
            EndIf
            
         EndIf
         
         Let idx = idx + 1
      EndLoop
      
      Type "",NEWLINE 
      Type "",NEWLINE 
   EndScript
   Routine "TypeQuestionStrings"
      ; ------------------------------------------------
      ; TypeQuestionStrings( whichgroup ) SubRoutine
      ; ------------------------------------------------
      
      Local col
      Local row
      
      Let col = 4 * Arg1               ; 0, 4, 8,... = MinColumn
      Let row = FirstArrayIndex( IST )   ; Type Questions:
      
      While row <= LastArrayIndex( IST )
         If QStr[col,row] = ""
            Type LeftJustify( "-", LineLength - 56 )||" "
            
            If QStr[col+1,row] = ""
               Type LeftJustify( "-", LineLength - 56 )||" "
               
               If QStr[col+2,row] = ""
                  Type LeftJustify( "-", LineLength - 56 )||" "
                  
                  If QStr[col+3,row] = ""
                     Delete LINE 
                     
                     Let row = row + 1
                  Else
                     Type LeftJustify( QStr[col+3,row], LineLength - 55 ),NEWLINE 
                     
                     Let row = row + 1
                  EndIf
               Else
                  Type LeftJustify( QStr[col+2,row], LineLength - 56 )||" "
                  Type LeftJustify( QStr[col+3,row], LineLength - 55 ),NEWLINE 
                  
                  Let row = row + 1
               EndIf
            Else
               Type LeftJustify( QStr[col+1,row], LineLength - 56 )||" "
               Type LeftJustify( QStr[col+2,row], LineLength - 56 )||" "
               Type LeftJustify( QStr[col+3,row], LineLength - 55 ),NEWLINE 
               
               Let row = row + 1
            EndIf
         Else
            Type LeftJustify( QStr[col,row], LineLength - 56 )||" "
            Type LeftJustify( QStr[col+1,row], LineLength - 56 )||" "
            Type LeftJustify( QStr[col+2,row], LineLength - 56 )||" "
            Type LeftJustify( QStr[col+3,row], LineLength - 55 ),NEWLINE 
            
            Let row = row + 1
         EndIf
      EndLoop
   EndScript
   Routine "TypeISTAttributeNames"
      ; -------------------------------------------------------------
      ; TypeISTAttributeNames( j - 1, Objects[].ID ) subroutine.
      ; -------------------------------------------------------------
      
      Local index
      Local i
      Local name
      
      Let i     = Arg1
      Let name  = Arg2
      Let index = FirstArrayIndex( Objects )
      
      While index <= LastArrayIndex( Objects )
         If Objects[index].ID = name AND name <> NOTHING
            
            If Objects[index].AttrName[i] <> ""
               Type LeftJustify( Objects[index].AttrName[i], LineLength - 56 )||" "
            Else
               Type "",NEWLINE 
            EndIf
            
            If Objects[index].AttrName[i + 1] <> "" AND Objects[index].AttrName[i+1] <> Objects[index].AttrName[i]
               Type LeftJustify( Objects[index].AttrName[i + 1], LineLength - 56 )||" "
            Else
               Type "",NEWLINE 
            EndIf
            
            If Objects[index].AttrName[i + 2] <> "" AND Objects[index].AttrName[i+2] <> Objects[index].AttrName[i+1]
               Type LeftJustify( Objects[index].AttrName[i + 2], LineLength - 56 )||" "
            Else
               Type "",NEWLINE 
            EndIf
            
            If Objects[index].AttrName[i + 3] <> "" AND Objects[index].AttrName[i + 3] <> Objects[index].AttrName[i + 2]
               Type Objects[index].AttrName[i + 3],NEWLINE 
            Else
               Type "",NEWLINE 
            EndIf
            ExitScript
         EndIf
         
         Let index = index + 1
      EndLoop
   EndScript
   Routine "SetupQuestionStrings"
      ; -----------------------------------------------------------------
      ; SetupQuestionStrings( ArraySize, NumLines, ObjIndex) subroutine.
      ; -----------------------------------------------------------------
      
      Local qa
      Local qi      ;Arg1 = MAX_Q ==> Array Size.
      Local row      ;Arg2 = numlines ==> howmany attributes * 4
      Local end      ;Arg3 = Objects index
      Local obj_num
      
      Let qa = 0
      
      While qa < Arg1      ;NULL out the QStr array:
         Let qi = 0
         
         While qi < Arg1
            Let QStr[qa,qi] = ""
            Let qi = qi + 1
         EndLoop
         
         Let qa = qa + 1
      EndLoop                  ;End Of NULLING!
      
      Let obj_num = Integer( GetChars( Objects[Arg3].Number,2,NumberOfChars( Objects[Arg3].Number )))
      Let qa = 0                     ; MakeQStrings!
      
      While qa < (4 * Arg2)   ; 4,8,12,16,... = Max Column #!
         Let qi = FirstArrayIndex( IST )
         
         While qi <= Arg1
            
            If IST[qi].OutObjectNum = obj_num
               Let row = obj_num
               
               If IST[qi].OutAttributeNum = qa
                  Let end = FindChars( IST[qi].CapString, ":", 1 ) - 1
                  Let QStr[qa - 1,row] = GetChars( IST[qi].CapString, 1, end )
                  
                  If NumberOfChars( QStr[qa - 1,row] ) > 0
                     Let QStr[qa - 1,row] = QStr[qa - 1,row]||"] "
                  Else
                     ExitLoop
                  EndIf
                  
                  Do "DEBUG","QStr["||qa||","||row||"] = "||QStr[qa-1,row],3
               EndIf
            EndIf
            
            Let qi = qi + 1
         EndLoop
         
         Let qa = qa + 1
      EndLoop
   EndScript
   Routine "SetupIDE"
      ; ----------------------------------
      ; SetupIDE() subroutine.
      ; ----------------------------------
      
      Local index
      Local str
      Local end
      Local chr
      Local j
      Local end1
      Local end2
      Local stpt1
      Local stpt2
      
      WorkWithDocument "IDTable"
      Clear DOCUMENT 
      
      Let index = FirstArrayIndex( IDE )
      
      While index <= LastArrayIndex( IDE )
         
         If Do( "EmptyString", IDE[index].Name ) = TRUE
            Let index = index + 1
            GotoEndLoop
         EndIf
         
         Let str = TrimString( String( IDE[index].Number ) )
         
         Type LeftJustify( str, LineLength - 72 )||": "
         Type LeftJustify( "OBJECT NAME: "||IDE[index].Name,LineLength - 15 ),NEWLINE 
         Type "",NEWLINE 
         Type "   ATTRIBUTE SUMMARY:",NEWLINE 
         Type "",NEWLINE 
         Type "   "||TrimString( IDE[index].AttrSummary ),NEWLINE 
         Type "",NEWLINE 
         Type "   IDENTIFIERS:",NEWLINE 
         Type "",NEWLINE 
         Type "   "||TrimString( IDE[index].Identifiers ),NEWLINE 
         Type "",NEWLINE 
         Type "",NEWLINE 
         Type "   OBJECT DESCRIPTION:",NEWLINE 
         Type "",NEWLINE 
         Type "   "
         
         Let end = NumberOfChars( IDE[index].Description )
         Let j   = 0
         
         While j < end   ;Output the Object description:
            Let chr = GetChars( IDE[index].Description, j + 1, 1 )
            
            If chr = Char( 10 )
               Type String( chr )||"   "
               Let j   = j + 1
               Let chr = GetChars( IDE[index].Description, j + 1, 1 )
            EndIf
            
            Type String( chr )
            
            Let j = j + 1
         EndLoop
         
         Type "",NEWLINE 
         Type "",NEWLINE 
         
         WorkWithDocument "AttribDescription"
         Clear DOCUMENT 
         
         Type IDE[index].AttrDescription
         Let end1 = LinesInDocument
         
         WorkWithDocument "AttribDomain"
         Clear DOCUMENT 
         
         Type IDE[index].Domain
         
         Let end2 = LinesInDocument
         Let stpt1 = 0
         Let stpt2 = 0
         
         While stpt1 <= end1   ;Output Attributes & description.
            WorkWithDocument "AttribDescription"
            MoveCursorTo STARTOF DOCUMENT 
            
            If NumberOfChars( TheLine ) > 2
               Let str = TheLine
               WorkWithDocument "IDTable"
               Type "   "||str,NEWLINE 
               WorkWithDocument "AttribDescription"
               Delete LINE 
               Let stpt1 = stpt1 + 1
            Else
               Delete LINE 
               Let stpt1 = stpt1 + 1 ;Output the Domain of the Attr:
               
               While stpt2 <= end2
                  WorkWithDocument "AttribDomain"
                  MoveCursorTo STARTOF DOCUMENT 
                  
                  If NumberOfChars( TheLine ) > 2
                     Let str = TheLine
                     WorkWithDocument "IDTable"
                     Type "     DOMAIN:  "||str,NEWLINE 
                     WorkWithDocument "AttribDomain"
                     Delete LINE 
                     Let stpt2 = stpt2 + 1
                  Else
                     Delete LINE 
                     Let stpt2 = stpt2 + 1
                     WorkWithDocument "IDTable"
                     Type "",NEWLINE 
                     ExitLoop
                  EndIf
               EndLoop
            EndIf
         EndLoop
         
         WorkWithDocument "IDTable"
         
         Let index = index + 1
         
         Type CenterString( "+", LineLength, "+" ),NEWLINE 
         Type "",NEWLINE 
      EndLoop
      
      Type CenterString( "* END OF IDEs! *",LineLength, "*" )
      MoveCursorTo STARTOF DOCUMENT 
   EndScript
   Routine "SetupIST"
      ; --------------------------
      ; SetupIST() subroutine
      ; --------------------------
      
      Local numchars
      Local numlines
      Local n
      Local obj
      Local ObjNum
      Local atrnum
      Local MAX_Q
      Local o_idx
      
      Do "MakeObjectsArray"
      
      Let o_idx = FirstArrayIndex( Capability )
      
      While Capability[o_idx].String <> "" AND o_idx <= LastArrayIndex( Capability )
         Do "ParseCapabilityStrings",o_idx
         
         Let o_idx = o_idx + 1
      EndLoop
      
      Let MAX_Q = LastArrayIndex( Objects ) * (LastArrayIndex( IST ) + 1)
      
      WorkWithDocument "IST_List"
      Clear DOCUMENT 
      
      Let o_idx = FirstArrayIndex( Objects )
      
      While o_idx <= LastArrayIndex( Objects )
         Type "",NEWLINE 
         
         Let ObjNum = Objects[o_idx].Number
         
         Type LeftJustify( String( ObjNum ), LineLength - 70 )||". "
         
         Let obj = Objects[o_idx].ID
         
         Type obj,NEWLINE 
         Type "",NEWLINE 
         
         Do "TypeCapStrings",obj
         
         Let atrnum   = Objects[o_idx].AttrCount
         Let numlines = atrnum % 4
         
         If numlines * 4 < atrnum
            Let numlines = numlines + 1
         EndIf
         
         Do "SetupQuestionStrings",MAX_Q,numlines,o_idx
         Let n = 0
         
         While n < numlines            ;Type 4 attributes across:
            Do "TypeQuestionStrings",n
            Do "TypeISTAttributeNames",4 * n,Objects[o_idx].ID
            
            Type CenterString( "~", LineLength, "~" ),NEWLINE 
            
            Let n = n + 1
         EndLoop
         
         Let o_idx = o_idx + 1
      EndLoop
      
      MoveCursorTo STARTOF DOCUMENT 
   EndScript
   Routine "SetupProcess"
      ; -----------------------------------------
      ; SetupProcess() subroutine.
      ; -----------------------------------------
      
      Local index
      Local end1
      Local end2
      Local i
      Local j
      Local chr
      Local outerloop
      Local stpt1
      Local stpt2
      Local lines_out
      Local offset
      
      WorkWithDocument "ProcessList"
      Clear DOCUMENT 
      
      Type CenterString( "** PROCESSES: **",LineLength, "*" ),NEWLINE 
      Type "",NEWLINE 
      Let index = FirstArrayIndex( Process )
      
      While index <= LastArrayIndex( Process )
         
         WorkWithDocument "DataNumsList"
         Clear DOCUMENT 
         
         Type Process[index].DataNums
         Let lines_out = LinesInDocument
         
         WorkWithDocument "DataStoresList"
         Clear DOCUMENT 
         Type Process[index].DataStores
         
         If lines_out < LinesInDocument
            Let lines_out = LinesInDocument
         EndIf
         
         WorkWithDocument "ProcessList"
         Type "PROC' #:  "||Process[index].Number,NEWLINE 
         
         Type LeftJustify( "SPEC': "||Process[index].Spec, 20 )
         Type LeftJustify( " PROCESS: "||Process[index].Name, 30 )
         Type LeftJustify( " IS GIVEN: "||Process[index].InputEvent, 30 ),NEWLINE 
         
         Type "",NEWLINE 
         
         Type LeftJustify( "   TO PRODUCE: "||Process[index].Output, 40 ),NEWLINE 
         Type LeftJustify( "   FROM:", 15 ),NEWLINE 
         
         Let stpt1     = 0
         Let stpt2     = 0
         Let outerloop = 1
         Let end1      = NumberOfChars( Process[index].DataNums )
         Let end2      = NumberOfChars( Process[index].DataStores )
         
         While outerloop <= lines_out
            Type "         "
            Let i    = stpt1
            
            While i <= end1
               Let chr = GetChars( Process[index].DataNums, i + 1, 1 )
               
               If chr = Char( 10 ) OR chr = Char( 13 )
                  Let stpt1   = i + 1
                  ExitLoop
               EndIf
               
               Type String( chr )
               Let i       = i + 1
               Let stpt1   = i
            EndLoop      ;End of printing DataNums loop.
            
            Type "   "
            Let offset = 19
            MoveCursorTo STARTOF LINE 
            
            While TheColumnNumber < offset
               If TheCharacter <> ""
                  MoveCursor RIGHT ,1
               Else
                  Type " "
               EndIf
            EndLoop
            
            Let i = stpt2
            
            While i <= end2
               Let chr = GetChars( Process[index].DataStores, i + 1, 1 )
               
               If chr = Char( 10 )
                  Let stpt2 = i + 1
                  ExitLoop
               EndIf
               
               Type String( chr )
               Let i = i + 1
            EndLoop      ;End of printing DataStores loop.
            
            Type "",NEWLINE 
            Let outerloop = outerloop + 1
         EndLoop
         
         Type CenterString( "=", LineLength, "=" ),NEWLINE 
         Type "",NEWLINE 
         Let index = index + 1
      EndLoop
      
      Type CenterString( "** END PROCESSES! **",LineLength, "*" )
      MoveCursorTo STARTOF DOCUMENT 
   EndScript
   Routine "SetupBDE"
      ; ----------------------------
      ; SetupBDE() subroutine.
      ; ----------------------------
      
      Local index
      Local end
      Local j
      Local str
      Local chr
      
      WorkWithDocument "ThreadsList"
      Clear DOCUMENT 
      
      Let index = FirstArrayIndex( BDE )
      
      While index <= LastArrayIndex( BDE )
         
         If Do( "EmptyString", BDE[index].Number ) = FALSE
            
            Type TrimString( BDE[index].ThreadNum )
            
            Let str = TrimString( String( BDE[index].Number ))
            
            Type LeftJustify( str, LineLength - 70 )
            Type LeftJustify( TrimString( BDE[index].State ), LineLength - 10 ),NEWLINE 
            
            Type "",NEWLINE 
            
            Type LeftJustify( TrimString( BDE[index].Source ), LineLength - 60 )||" "
            Type LeftJustify( TrimString( BDE[index].Event ), LineLength - 60 )||" "
            Type LeftJustify( TrimString( BDE[index].Destination), LineLength - 25),NEWLINE 
            
            Type "",NEWLINE 
            
            Type "           "
            
            Type LeftJustify( TrimString( BDE[index].ActionNum )||".",LineLength - 60)||" "
            Type LeftJustify( TrimString( BDE[index].ActionDescription ), LineLength - 35),NEWLINE 
            
            Type "                        "
            
            Let end = NumberOfChars( BDE[index].ActionDetails )
            Let j   = 0
            
            While j < end
               Let chr = GetChars( BDE[index].ActionDetails, j + 1, 1 )
               
               If chr = Char( 10 )
                  Type String( chr )
                  Type "                        "
                  Let j = j + 1
                  Let chr = GetChars( BDE[index].ActionDetails, j + 1, 1 )
               EndIf
               
               Type String( chr )
               
               Let j = j + 1
            EndLoop
            
            Type "",NEWLINE 
            Type "                      GOTO "
            Type TrimString( BDE[index].TransitionTo )
            Type " END",NEWLINE 
            
            Type CenterString( "-", LineLength, "-" ),NEWLINE 
            
            Let index = index + 1
            Type "",NEWLINE 
         EndIf
      EndLoop
   EndScript
   Routine "ReflowText"
      ; ----------------------------------------------------------
      ; ReflowText( docname, listview ) SubRoutine.
      ; ----------------------------------------------------------
      
      Local COUNT
      Local WORDSINALINE
      Local CHARSINALINE
      Local CHAROFFSET
      
      WorkWithDocument Arg1
      
      ; InsertDocument Arg2
      
      MoveCursorTo STARTOF DOCUMENT 
      MoveCursorTo STARTOF LINE 
      
      ;DisableObject Arg2 ; The ListView Gadget.
      
      Loop
         Let CHARSINALINE = NumberOfChars( TheLine )
         
         If CHARSINALINE > MaxCharsInALine
            Let COUNT        = 0
            Let WORDSINALINE = NumberOfWords( TheLine, THEWORDDELIMITERS )
            
            Loop
               Let TheLimit   = Limit( 1, WORDSINALINE, WORDSINALINE - COUNT )
               Let CHAROFFSET = PositionOfWord( TheLine, TheLimit, THEWORDDELIMITERS)
               Let COUNT      = COUNT + 1
               
               Let CHARSINALINE = NumberOfChars( GetChars( TheLine,1,CHAROFFSET))
               
            Until (CHARSINALINE <= MaxCharsInALine) OR ((WORDSINALINE - COUNT) <= 1)
            
            If (WORDSINALINE - COUNT) <= 1
               GetTextFit TheLine,(MaxCharsInALine * FONTWIDTH),CHAROFFSET
            EndIf
            
            MoveCursorTo STARTOF LINE 
            MoveCursor RIGHT ,CHAROFFSET - 1
            SplitLine
            MoveCursorTo STARTOF LINE 
         Else
            MoveCursor DOWN 
            MoveCursorTo STARTOF LINE 
         EndIf
         
         If TheLineNumber = VisualLinesInDoc
            RefreshObject Arg2                ; The ListView Gadget.
         EndIf
         
      Until TheLineNumber = LinesInDocument
      
      MoveCursorTo STARTOF DOCUMENT 
      MoveCursorTo STARTOF LINE 
      
      ;EnableObject Arg2 ; The ListView Gadget.
      
   EndScript
   Routine "SetupTechNotes"
      ; ------------------------------------------
      ; SetupTechNotes() subroutine.
      ; ------------------------------------------
      
      Local index
      Local str
      Local safety
      
      WorkWithDocument "UserNoteMemo"
      Clear DOCUMENT 
      
      Let index = FirstArrayIndex( UReq )
      
      While index <= LastArrayIndex( UReq )
         
         If Do( "EmptyString", UReq[index].Name ) = FALSE
            Type LeftJustify( "Note #: "||UReq[index].Number, LineLength - 63 )
            Type LeftJustify( " Name: "||UReq[index].Name, LineLength - 40 )
            Type LeftJustify( "Cross Ref: "||UReq[index].CrossRef, LineLength - 40 )
            
            Type "",NEWLINE 
            Type "",NEWLINE 
            
            Let str = UReq[index].Notes
            
            Type str,NEWLINE 
            Type "",NEWLINE 
            
            Type CenterString( "+",LineLength,"+" ),NEWLINE 
            Type "",NEWLINE 
         EndIf
         
         Let index = index + 1
      EndLoop
      
      Type CenterString( "* END OF TECHNICAL NOTES! *", LineLength, "*" )
      MoveCursorTo STARTOF DOCUMENT 
   EndScript
   Routine "SetupSTT"
      ; ----------------------------------
      ; SetupSTT() subroutine.
      ; ----------------------------------
      
      Local index
      Local str
      
      Let index = FirstArrayIndex( State )
      
      WorkWithDocument "STTTable"
      Clear DOCUMENT 
      
      Type LeftJustify( "#",        LineLength - 70 )||": "
      Type LeftJustify( "NAME:",    LineLength - 60)
      Type LeftJustify( " EVENT:",  LineLength - 55)
      Type LeftJustify( " ACTION:", LineLength - 55)
      Type LeftJustify( " NEXT:",   LineLength - 55),NEWLINE 
      
      Type CenterString( ".",LineLength,"." ),NEWLINE 
      
      While index <= LastArrayIndex( State )
         
         If Do( "EmptyString", State[index].Name ) = FALSE
            Let str = String( State[index].Number )
            Type LeftJustify( str, LineLength - 70 )||": "
            
            Let str = TrimString( State[index].Name )
            Type LeftJustify( str, LineLength - 60 )||" "
            
            Let str = TrimString( State[index].TriggerEvent )
            Type LeftJustify( str, LineLength - 55 )
            
            Let str = TrimString( State[index].Action )
            Type LeftJustify( str, LineLength - 55 )
            
            Let str = TrimString( State[index].NextState )
            Type LeftJustify( str, LineLength - 55 ),NEWLINE 
         EndIf
         
         Let index = index + 1
      EndLoop
      
      Type CenterString( "* END OF STATE TRANSITION TABLE! *",LineLength,"*" )
      MoveCursorTo STARTOF DOCUMENT 
   EndScript
   Routine "SetupOCT"
      ; -------------------------------
      ; SetupOCT() subroutine.
      ; -------------------------------
      
      Local index
      
      WorkWithDocument "OCTable"
      Clear DOCUMENT 
      
      Let index = FirstArrayIndex( OCT )
      
      While index <= LastArrayIndex( OCT )
         
         If Do( "EmptyString", OCT[index].EventDescription ) = FALSE
            Type "EVENT  #: "||TrimString( String( OCT[index].Number ))
            Type "  DESCRIPTION: "||TrimString( OCT[index].EventDescription ),NEWLINE 
            Type "",NEWLINE 
            
            Type "  SOURCE: "||TrimString( OCT[index].EventSource ),NEWLINE 
            Type "  SINK  : "||TrimString( OCT[index].EventSink ),NEWLINE 
            Type "  DATA  : "||TrimString( OCT[index].EventData ),NEWLINE 
            
            Type CenterString( "+",LineLength,"+" ),NEWLINE 
            Type "",NEWLINE 
         EndIf
         
         Let index = index + 1
      EndLoop
      
      Type CenterString( "* END OF OBJECT COMMUNICATION TABLE! *",LineLength,"*" )
      
   EndScript
   Routine "DoA_TabKey"
      ; ----------------------------------
      ; DoA_TabKey( DocName ) subroutine.
      ; ----------------------------------
      
      Local count
      
      Let count = 0
      
      If Arg1 = NOTHING
         WorkWithDocument "Report" ; S/B Arg1
      Else
         WorkWithDocument Arg1
      EndIf
      
      While count < TabSize
         Type " "
         Let count = count + 1
      EndLoop
   EndScript
   Routine "SetupRequirements"
      ; -----------------------------------------
      ; SetupRequirements() Subroutine.
      ; -----------------------------------------
      
      Local index
      Local str
      
      WorkWithDocument "RequirementsList"
      Clear DOCUMENT 
      
      Type LeftJustify( "#", LineLength - 66 )||":"
      Type LeftJustify( " INPUT:", LineLength - 39 )
      Type LeftJustify( " OUTPUT:", LineLength - 35 ),NEWLINE 
      
      Type CenterString( "-", LineLength, "-" ),NEWLINE 
      
      Let index = FirstArrayindex( Requirement )
      
      While index <= LastArrayIndex( Requirement )
         
         If Do( "EmptyString", Requirement[index].Number ) = FALSE
            Let str = String( Requirement[index].Number )
            Type LeftJustify( str, LineLength - 66 )||": "
            
            Let str = TrimString( Requirement[index].InObject )||"."
            Let str = str||TrimString( Requirement[index].InAttribute )||" "
            Type LeftJustify( str, LineLength - 40 )||" "
            
            Let str = TrimString( Requirement[index].OutObject )||"."
            Let str = str||TrimString( Requirement[index].OutAttribute )
            Type LeftJustify( str, LineLength - 35 ),NEWLINE 
            
            Type CenterString( "+", LineLength, "+" ),NEWLINE 
            Type "",NEWLINE 
         EndIf
         
         Let index = index + 1
      EndLoop
      
      Type CenterString( "* END OF REQUIREMENTS! *", LineLength, "*" )
      MoveCursorTo STARTOF DOCUMENT 
   EndScript
   Routine "SetupCapabilities"
      ; ----------------------------------------
      ; SetupCapabilities() subroutine.
      ; ----------------------------------------
      
      Local index
      Local str
      
      WorkWithDocument "SysCapsList"
      Clear DOCUMENT 
      
      Type CenterString( "* CAPABILITIES: *", LineLength, "*")
      Type CenterString( "-", LineLength, "-" ),NEWLINE 
      
      Let index = FirstArrayIndex( Capability )
      
      While index <= LastArrayIndex( Capability )
         
         If Do( "EmptyString", Capability[index].Number ) = FALSE
            Type "CAP_#: "
            Type LeftJustify( TrimString( Capability[index].Number ), LineLength - 65 )
            
            Type " CAPABILITY:   "
            Type LeftJustify( TrimString( Capability[index].CString ), LineLength - 42 ),NEWLINE 
            
            Type "DESC':",NEWLINE 
            Type LeftJustify( TrimString( Capability[index].Description ), LineLength ),NEWLINE 
            Type "",NEWLINE 
            
            Type "REQ_#: "
            Type LeftJustify( TrimString( Capability[index].ReqNumber ), LineLength - 65 )
            
            Type " REQUIREMENT:  "
            Type LeftJustify( TrimString( Capability[index].ReqString ), LineLength - 45 ),NEWLINE 
            
            Type "DESC':",NEWLINE 
            Type LeftJustify( TrimString( Capability[index].ReqDescription ), LineLength ),NEWLINE 
            
            Type CenterString( "-", LineLength, "-" ),NEWLINE 
            Type "",NEWLINE 
         EndIf
         
         Let index = index + 1
      EndLoop
      
      Type CenterString( "* END OF CAPABILITIES! *",LineLength, "*")
      MoveCursorTo STARTOF DOCUMENT 
   EndScript
   Routine "SetupCDE"
      ; -----------------------------------
      ; SetupCDE() Subroutine.
      ; -----------------------------------
      
      Local index
      Local str
      
      Let index = FirstArrayIndex( CDE )
      
      WorkWithDocument "CDEList"
      Clear DOCUMENT 
      
      Type "SYSTEM TITLE:  "
      Type CenterString( CDE[index].SystemTitle, LineLength - 30 ),NEWLINE 
      Type "",NEWLINE 
      
      Type CenterString( "TERMINATORS:", LineLength ),NEWLINE 
      Type CenterString( ".",LineLength,"." ),NEWLINE 
      
      While index <= LastArrayIndex( CDE )
         
         If Do( "EmptyString", CDE[index].TerminatorName ) = FALSE
            Type "NAME:  "
            Type TrimString( CDE[index].TerminatorName ),NEWLINE 
            Type "",NEWLINE 
            
            Type "TYPE:  "
            
            If CDE[index].SourceFlag = TRUE
               Type "Source",NEWLINE 
            ElseIf CDE[index].SinkFlag = TRUE
               Type "Sink",NEWLINE 
            Else
               Type "Source & Sink",NEWLINE 
            EndIf
            
            Type "",NEWLINE 
            Type LeftJustify( "RELATIONSHIP:", LineLength - 37 ),NEWLINE 
            Type LeftJustify( TrimString( CDE[index].TerminatorDescription ), LineLength),NEWLINE 
            
            Type CenterString( "+",LineLength,"+" ),NEWLINE 
            Type "",NEWLINE 
         EndIf
         
         Let index = index + 1
      EndLoop
      
      Type CenterString( "* END OF TERMINATOR LIST! *",LineLength,"*")
      MoveCursorTo STARTOF DOCUMENT 
   EndScript
   Routine "SetupObjectList"
      ; ----------------------------------------------
      ; SetupObjectList() subroutine.
      ; ----------------------------------------------
      
      Local index
      WorkWithDocument "ObjectList"
      Clear DOCUMENT 
      
      Type CenterString( "*** NORMALS: ***",LineLength - 25),NEWLINE 
      Type "",NEWLINE 
      Let index = FirstArrayIndex( Normal )
      
      While index <= LastArrayIndex( Normal )
         Type LeftJustify( String( index + 1 ), 4)||": "
         Type LeftJustify( Normal[index].ID, LineLength - 45 )||" TYPE: NORMAL",NEWLINE 
         
         If Normal[index].ID = NOTHING
            Let index = index + 1
            GotoEndLoop
         EndIf
         
         Let index = index  + 1
      EndLoop
      
      Type CenterString( "-",LineLength,"-" ),NEWLINE 
      Type CenterString( "*** SUPERTYPES: ***",LineLength - 25),NEWLINE 
      Type "",NEWLINE 
      Let index = FirstArrayIndex( Supertype )
      
      While index <= LastArrayIndex( Supertype )
         Type LeftJustify( String( index +1 ), 4)||": "
         Type LeftJustify( Supertype[index].Name, LineLength - 45 )||" TYPE: SUPERTYPE",NEWLINE 
         
         If Supertype[index].Name = NOTHING
            Let index = index + 1
            GotoEndLoop
         EndIf
         
         Let index = index  + 1
      EndLoop
      
      Type CenterString( "-",LineLength,"-" ),NEWLINE 
      Type CenterString( "*** SUBTYPES: ***",LineLength - 25),NEWLINE 
      Type "",NEWLINE 
      Let index = FirstArrayIndex( Subtype )
      
      While index <= LastArrayIndex( Subtype )
         Type LeftJustify( String( index + 1 ), 4)||": "
         Type LeftJustify( Subtype[index].Name, LineLength - 45 )||" TYPE: SUBTYPE",NEWLINE 
         
         If Subtype[index].Name = NOTHING
            Let index = index + 1
            GotoEndLoop
         EndIf
         
         Let index = index + 1
      EndLoop
      
      Type CenterString( "-",LineLength,"-" ),NEWLINE 
      Type CenterString( "*** COMPOSITES: ***",LineLength - 25),NEWLINE 
      Type "",NEWLINE 
      Let index = FirstArrayIndex( Composite )
      
      While index <= LastArrayIndex( Composite )
         Type LeftJustify( String( index + 1 ), 4)||": "
         Type LeftJustify( Composite[index].Name, LineLength - 45 )||" TYPE: COMPOSITE",NEWLINE 
         
         If Composite[index].Name = NOTHING
            Let index = index + 1
            GotoEndLoop
         EndIf
         
         Let index = index + 1
      EndLoop
      
      Type CenterString( "-",LineLength,"-" ),NEWLINE 
      Type CenterString( "*** ASSOCIATIONS: ***",LineLength - 25),NEWLINE 
      Type "",NEWLINE 
      Let index = FirstArrayIndex( Association )
      
      While index <= LastArrayIndex( Association )
         Type LeftJustify( String( index +1 ), 4)||": "
         Type LeftJustify( Association[index].Name, LineLength - 45 )||" TYPE: ASSOCIATION",NEWLINE 
         
         If Association[index].Name = NOTHING
            Let index = index + 1
            GotoEndLoop
         EndIf
         
         Let index = index + 1
      EndLoop
      
      Type CenterString( "-",LineLength,"-" ),NEWLINE 
      Type CenterString( "*** RELATIONS: ***",LineLength - 25),NEWLINE 
      Type "",NEWLINE 
      Let index = FirstArrayIndex( Relation )
      
      While index <= LastArrayIndex( Relation )
         Type LeftJustify( String( index + 1 ), 4)||": "
         Type LeftJustify( Relation[index].Spec, LineLength - 45 )||" TYPE: RELATION",NEWLINE 
         
         If Relation[index].Name = NOTHING
            Let index = index + 1
            GotoEndLoop
         EndIf
         
         Let index = index + 1
      EndLoop
      
      MoveCursorTo STARTOF DOCUMENT 
      MoveCursor DOWN ,2
   EndScript
   Routine "SortRecords"
      ; ------------------------------------------------------------
      ; SortRecords( RecArray, key, direction, x, y ) SubRoutine.
      ; ------------------------------------------------------------
      
      Local key       ; String like:  ".Number" or ".EventDescription"
      Local direction
      Local first
      
      SetPen 7
      PrintText "Sorting...",Arg4,Arg5
      Delay 0,0,5
      
      Let key       = Arg2
      Let direction = Arg3
      
      If UpperCase( Arg1 ) = "SUBTYPE"
         Let first = FirstArrayIndex( SubType )
         
         If first = LastArrayIndex( Subtype )
            SetPen 0
            PrintText "Sorting...",Arg4,Arg5
            ExitScript
         EndIf
         
         If direction = 1
            SortArray Subtype,NOCASE STRING ASCENDING ,key
         ElseIf direction = 2
            SortArray Subtype,NOCASE STRING DESCENDING ,key
         Else
            SortArray Subtype,NOCASE STRING ASCENDING ,key
         EndIf
         
      ElseIf UpperCase( Arg1 ) = "SUPERTYPE"
         Let first = FirstArrayIndex( SuperType )
         
         If first = LastArrayIndex( Supertype )
            SetPen 0
            PrintText "Sorting...",Arg4,Arg5
            ExitScript
         EndIf
         
         If direction = 1
            SortArray Supertype,NOCASE STRING ASCENDING ,key
         ElseIf direction = 2
            SortArray Supertype,NOCASE STRING DESCENDING ,key
         Else
            SortArray Supertype,NOCASE STRING ASCENDING ,key
         EndIf
         
      ElseIf UpperCase( Arg1 ) = "COMPOSITE"
         Let first = FirstArrayIndex( Composite )
         
         If first = LastArrayIndex( Composite )
            SetPen 0
            PrintText "Sorting...",Arg4,Arg5
            ExitScript
         EndIf
         
         If direction = 1
            SortArray Composite,NOCASE STRING ASCENDING ,key
         ElseIf direction = 2
            SortArray Composite,NOCASE STRING DESCENDING ,key
         Else
            SortArray Composite,NOCASE STRING ASCENDING ,key
         EndIf
         
      ElseIf UpperCase( Arg1 ) = "ASSOCIATION"
         Let first = FirstArrayIndex( Association )
         
         If first = LastArrayIndex( Association )
            SetPen 0
            PrintText "Sorting...",Arg4,Arg5
            ExitScript
         EndIf
         
         If direction = 1
            SortArray Association,NOCASE STRING ASCENDING ,key
         ElseIf direction = 2
            SortArray Association,NOCASE STRING DESCENDING ,key
         Else
            SortArray Association,NOCASE STRING ASCENDING ,key
         EndIf
         
      ElseIf UpperCase( Arg1 ) = "RELATION"
         Let first = FirstArrayIndex( Relation )
         
         If first = LastArrayIndex( Relation )
            SetPen 0
            PrintText "Sorting...",Arg4,Arg5
            ExitScript
         EndIf
         
         If direction = 1
            SortArray Relation,NOCASE STRING ASCENDING ,key
         ElseIf direction = 2
            SortArray Relation,NOCASE STRING DESCENDING ,key
         Else
            SortArray Relation,NOCASE STRING ASCENDING ,key
         EndIf
         
      ElseIf UpperCase( Arg1 ) = "NORMAL"
         Let first = FirstArrayIndex( Normal )
         
         If first = LastArrayIndex( Normal )
            SetPen 0
            PrintText "Sorting...",Arg4,Arg5
            ExitScript
         EndIf
         
         If direction = 1
            SortArray Normal,NOCASE STRING ASCENDING ,key
         ElseIf direction = 2
            SortArray Normal,NOCASE STRING DESCENDING ,key
         Else
            SortArray Normal,NOCASE STRING ASCENDING ,key
         EndIf
         
      ElseIf UpperCase( Arg1 ) = "ATTRIBUTE"
         Let first = FirstArrayIndex( Attribute )
         
         If first = LastArrayIndex( Attribute )
            SetPen 0
            PrintText "Sorting...",Arg4,Arg5
            ExitScript
         EndIf
         
         If direction = 1
            SortArray Attribute,NOCASE STRING ASCENDING ,key
         ElseIf direction = 2
            SortArray Attribute,NOCASE STRING DESCENDING ,key
         Else
            SortArray Attribute,NOCASE STRING ASCENDING ,key
         EndIf
         
      ElseIf UpperCase( Arg1 ) = "STATE"
         Let first = FirstArrayIndex( State )
         
         If first = LastArrayIndex( State )
            SetPen 0
            PrintText "Sorting...",Arg4,Arg5
            ExitScript
         EndIf
         
         If direction = 1
            SortArray State,NOCASE STRING ASCENDING ,key
         ElseIf direction = 2
            SortArray State,NOCASE STRING DESCENDING ,key
         Else
            SortArray State,NOCASE STRING ASCENDING ,key
         EndIf
         
      ElseIf UpperCase( Arg1 ) = "OCT"
         Let first = FirstArrayIndex( OCT )
         
         If first = LastArrayIndex( OCT )
            SetPen 0
            PrintText "Sorting...",Arg4,Arg5
            ExitScript
         EndIf
         
         If direction = 1
            SortArray OCT,NOCASE STRING ASCENDING ,key
         ElseIf direction = 2
            SortArray OCT,NOCASE STRING DESCENDING ,key
         Else
            SortArray OCT,NOCASE STRING ASCENDING ,key
         EndIf
         
      ElseIf UpperCase( Arg1 ) = "CDE"
         Let first = FirstArrayIndex( CDE )
         
         If first = LastArrayIndex( CDE )
            SetPen 0
            PrintText "Sorting...",Arg4,Arg5
            ExitScript
         EndIf
         
         If direction = 1
            SortArray CDE,NOCASE STRING ASCENDING ,key
         ElseIf direction = 2
            SortArray CDE,NOCASE STRING DESCENDING ,key
         Else
            SortArray CDE,NOCASE STRING ASCENDING ,key
         EndIf
         
      ElseIf UpperCase( Arg1 ) = "PROCESS"
         Let first = FirstArrayIndex( Process )
         
         If first = LastArrayIndex( Process )
            SetPen 0
            PrintText "Sorting...",Arg4,Arg5
            ExitScript
         EndIf
         
         If direction = 1
            SortArray Process,NOCASE STRING ASCENDING ,key
         ElseIf direction = 2
            SortArray Process,NOCASE STRING DESCENDING ,key
         Else
            SortArray Process,NOCASE STRING ASCENDING ,key
         EndIf
         
      ElseIf UpperCase( Arg1 ) = "PDE"
         Let first = FirstArrayIndex( PDE )
         
         If first = LastArrayIndex( PDE )
            SetPen 0
            PrintText "Sorting...",Arg4,Arg5
            ExitScript
         EndIf
         
         If direction = 1
            SortArray PDE,NOCASE STRING ASCENDING ,key
         ElseIf direction = 2
            SortArray PDE,NOCASE STRING DESCENDING ,key
         Else
            SortArray PDE,NOCASE STRING ASCENDING ,key
         EndIf
         
      ElseIf UpperCase( Arg1 ) = "BDE"
         Let first = FirstArrayIndex( BDE )
         
         If first = LastArrayIndex( BDE )
            SetPen 0
            PrintText "Sorting...",Arg4,Arg5
            ExitScript
         EndIf
         
         If direction = 1
            SortArray BDE,NOCASE STRING ASCENDING ,key
         ElseIf direction = 2
            SortArray BDE,NOCASE STRING DESCENDING ,key
         Else
            SortArray BDE,NOCASE STRING ASCENDING ,key
         EndIf
         
      ElseIf UpperCase( Arg1 ) = "IDE"
         Let first = FirstArrayIndex( IDE )
         
         If first = LastArrayIndex( IDE )
            SetPen 0
            PrintText "Sorting...",Arg4,Arg5
            ExitScript
         EndIf
         
         If direction = 1
            SortArray IDE,NOCASE STRING ASCENDING ,key
         ElseIf direction = 2
            SortArray IDE,NOCASE STRING DESCENDING ,key
         Else
            SortArray IDE,NOCASE STRING ASCENDING ,key
         EndIf
         
      ElseIf UpperCase( Arg1 ) = "CAPABILITY"
         Let first = FirstArrayIndex( Capability )
         
         If first = LastArrayIndex( Capability )
            SetPen 0
            PrintText "Sorting...",Arg4,Arg5
            ExitScript
         EndIf
         
         If direction = 1
            SortArray Capability,NOCASE STRING ASCENDING ,key
         ElseIf direction = 2
            SortArray Capability,NOCASE STRING DESCENDING ,key
         Else
            SortArray Capability,NOCASE STRING ASCENDING ,key
         EndIf
         
      ElseIf UpperCase( Arg1 ) = "REQUIREMENT"
         Let first = FirstArrayIndex( Requirement )
         
         If first = LastArrayIndex( Requirement )
            SetPen 0
            PrintText "Sorting...",Arg4,Arg5
            ExitScript
         EndIf
         
         If direction = 1
            SortArray Requirement,NOCASE STRING ASCENDING ,key
         ElseIf direction = 2
            SortArray Requirement,NOCASE STRING DESCENDING ,key
         Else
            SortArray Requirement,NOCASE STRING ASCENDING ,key
         EndIf
         
      ElseIf UpperCase( Arg1 ) = "UREQ"
         Let first = FirstArrayIndex( UReq )
         
         If first = LastArrayIndex( UReq )
            SetPen 0
            PrintText "Sorting...",Arg4,Arg5
            ExitScript
         EndIf
         
         If direction = 1
            SortArray UReq,NOCASE STRING ASCENDING ,key
         ElseIf direction = 2
            SortArray UReq,NOCASE STRING DESCENDING ,key
         Else
            SortArray UReq,NOCASE STRING ASCENDING ,key
         EndIf
         
      ElseIf UpperCase( Arg1 ) = "OBJECTS"
         Let first = FirstArrayIndex( Objects )
         
         If first = LastArrayIndex( Objects )
            SetPen 0
            PrintText "Sorting...",Arg4,Arg5
            ExitScript
         EndIf
         
         If direction = 1
            SortArray Objects,NOCASE STRING ASCENDING ,key
         ElseIf direction = 2
            SortArray Objects,NOCASE STRING DESCENDING ,key
         Else
            SortArray Objects,NOCASE STRING ASCENDING ,key
         EndIf
         
      ElseIf UpperCase( Arg1 ) = "IST"
         Let first = FirstArrayIndex( IST )
         
         If first = LastArrayIndex( IST )
            SetPen 0
            PrintText "Sorting...",Arg4,Arg5
            ExitScript
         EndIf
         
         If direction = 1
            SortArray IST,NOCASE STRING ASCENDING ,key
         ElseIf direction = 2
            SortArray IST,NOCASE STRING DESCENDING ,key
         Else
            SortArray IST,NOCASE STRING ASCENDING ,key
         EndIf
      EndIf
      
      SetPen 0
      PrintText "Sorting...",Arg4,Arg5
      
   EndScript
   Routine "CheckForNormal"
      ; -----------------------------------------
      ; CheckForNormal( ID ) Subroutine.
      ; -----------------------------------------
      
      Local Count
      
      Let Count = FirstArrayIndex( Normal )
      
      While Count <= LastArrayIndex( Normal )
         
         If Normal[Count].ID = Arg1
            ExitScript TRUE
         EndIf
         
         Let Count = Count + 1
      EndLoop
      
      ExitScript FALSE
   EndScript
   Routine "ReadInAssociations"
      ; ------------------------------------------------------
      ; ReadInAssociations( filename.Assocs ) Subroutine.
      ; ------------------------------------------------------
      
      Local filename
      
      If Arg1 = NOTHING
         Let filename = DefaultDBase||".Assocs"
      Else
         Let filename = Arg1
      EndIf
      
      If Exists( filename ) AND filename <> NOTHING
         Dispose Association
         
         Let Association = LoadVariable( filename )
         Let C_Assoc     = FirstArrayIndex( Association )
         Let GotAssocs   = TRUE
      EndIf
   EndScript
   Routine "ReadInAttributes"
      ; -----------------------------------------------
      ; ReadInAttributes( filename.Attrs ) Subroutine.
      ; -----------------------------------------------
      
      Local filename
      
      If Arg1 = NOTHING
         Let filename = DefaultDBase||".Attrs"
      Else
         Let filename = Arg1
      EndIf
      
      If Exists( filename ) AND filename <> NOTHING
         Dispose Attribute
         
         Let Attribute = LoadVariable( filename )
         Let C_Attr    = FirstArrayIndex( Attribute )
         Let GotAttrs  = TRUE
      EndIf
      
   EndScript
   Routine "ReadInBDEs"
      ; ---------------------------------------
      ; ReadInBDEs( filename.BDEs ) Subroutine.
      ; ---------------------------------------
      
      Local filename
      
      If Arg1 = NOTHING
         Let filename = DefaultDBase||".BDEs"
      Else
         Let filename = Arg1
      EndIf
      
      If Exists( filename ) AND filename <> NOTHING
         Dispose BDE
         
         Let BDE     = LoadVariable( filename )
         Let C_BDE   = FirstArrayIndex( BDE )
         Let GotBDEs = TRUE
      EndIf
   EndScript
   Routine "ReadInCapabilities"
      ; --------------------------------------------------
      ; ReadInCapabilities( filename.Caps ) Subroutine.
      ; --------------------------------------------------
      
      Local filename
      
      If Arg1 = NOTHING
         Let filename = DefaultDBase||".Caps"
      Else
         Let filename = Arg1
      EndIf
      
      If Exists( filename ) AND filename <> NOTHING
         Dispose Capability
         
         Let Capability = LoadVariable( filename )
         Let C_Cap      = FirstArrayIndex( Capability )
         Let GotCaps    = TRUE
      EndIf
   EndScript
   Routine "ReadInCDEs"
      ; -------------------------------------------
      ; ReadInCDEs( filename.CDEs ) Subroutine.
      ; -------------------------------------------
      
      Local filename
      
      If Arg1 = NOTHING
         Let filename = DefaultDBase||".CDEs"
      Else
         Let filename = Arg1
      EndIf
      
      If Exists( filename ) AND filename <> NOTHING
         Dispose CDE
         
         Let CDE     = LoadVariable( filename )
         Let C_CDE   = FirstArrayIndex( CDE )
         Let GotCDEs = TRUE
      EndIf
   EndScript
   Routine "ReadInComposites"
      ; -------------------------------------------------
      ; ReadInComposites( filename.Comps ) Subroutine.
      ; -------------------------------------------------
      
      Local filename
      
      If Arg1 = NOTHING
         Let filename = DefaultDBase||".Comps"
      Else
         Let filename = Arg1
      EndIf
      
      If Exists( filename ) AND filename <> NOTHING
         Dispose Composite
         
         Let Composite = LoadVariable( filename )
         Let C_Comp    = FirstArrayIndex( Composite )
         Let GotComps  = TRUE
      EndIf
   EndScript
   Routine "ReadInIDEs"
      ; -----------------------------------------
      ; ReadInIDEs( filename.IDEs ) Subroutine.
      ; -----------------------------------------
      
      Local filename
      
      If Arg1 = NOTHING
         Let filename = DefaultDBase||".IDEs"
      Else
         Let filename = Arg1
      EndIf
      
      If Exists( filename ) AND filename <> NOTHING
         Dispose IDE
         
         Let IDE   = LoadVariable( filename )
         SortArray IDE,STRING ASCENDING ,".NUMBER"
         
         Let C_IDE   = FirstArrayIndex( IDE )
         Let GotIDEs = TRUE
      EndIf
   EndScript
   Routine "ReadInISTs"
      ; ----------------------------------------------
      ; ReadInISTs( filename ) Subroutine.
      ; Currently There is NO DataBase file for ISTs.
      ; ----------------------------------------------
      
      Local filename
      
      If TrimString( Arg1 ) = NOTHING
         Let filename = DefaultDBase||".ISTs"
      Else
         Let filename = TrimString( Arg1 )
      EndIf
      
      If Exists( filename ) AND filename <> NOTHING
         Dispose IST
         
         Let IST     = LoadVariable( filename )
         Let C_IST   = FirstArrayIndex( IST )
         ;Let GotISTs = TRUE
         
         ;Else
         ;   Do "ShowError","filename "||filename||" -> NOT Found!!",3
      EndIf
   EndScript
   Routine "ReadInNormals"
      ; ----------------------------------------------
      ; ReadInNormals( filename.Norms ) Subroutine.
      ; ----------------------------------------------
      
      Local filename
      
      If Arg1 = NOTHING
         Let filename = DefaultDBase||".Norms"
      Else
         Let filename = Arg1
      EndIf
      
      If Exists( filename ) AND filename <> NOTHING
         Dispose Normal
         
         Let Normal   = LoadVariable( filename )
         Let C_Norm   = FirstArrayIndex( Normal )
         Let GotNorms = TRUE
      EndIf
   EndScript
   Routine "ReadInOCTs"
      ; -----------------------------------------
      ; ReadInOCTs( filename.OCTs ) Subroutine.
      ; -----------------------------------------
      
      Local filename
      
      If Arg1 = NOTHING
         Let filename = DefaultDBase||".OCTs"
      Else
         Let filename = Arg1
      EndIf
      
      If Exists( filename ) AND filename <> NOTHING
         Dispose OCT
         
         Let OCT     = LoadVariable( filename )
         Let C_OCT   = FirstArrayIndex( OCT )
         Let GotOCTs = TRUE
      EndIf
   EndScript
   Routine "ReadInPDEs"
      ; -----------------------------------------
      ; ReadInPDEs( filename.PDEs ) Subroutine.
      ; -----------------------------------------
      
      Local filename
      
      If Arg1 = NOTHING
         Let filename = DefaultDBase||".PDEs"
      Else
         Let filename = Arg1
      EndIf
      
      If Exists( filename ) AND filename <> NOTHING
         Dispose PDE
         
         Let PDE     = LoadVariable( filename )
         Let C_PDE   = FirstArrayIndex( PDE )
         Let GotPDEs = TRUE
      EndIf
   EndScript
   Routine "ReadInProcesses"
      ; -------------------------------------------------
      ; ReadInProcesses( filename.Procs ) Subroutine.
      ; -------------------------------------------------
      
      Local filename
      
      If Arg1 = NOTHING
         Let filename = DefaultDBase||".Procs"
      Else
         Let filename = Arg1
      EndIf
      
      If Exists( filename ) AND filename <> NOTHING
         Dispose Process
         
         Let Process  = LoadVariable( filename )
         Let C_Proc   = FirstArrayIndex( Process )
         Let GotProcs = TRUE
      EndIf
   EndScript
   Routine "ReadInRelations"
      ; ----------------------------------------------
      ; ReadInRelations( filename.Rels ) Subroutine.
      ; ----------------------------------------------
      
      Local filename
      
      If TrimString( Arg1 ) = NOTHING
         Let filename = DefaultDBase||".Rels"
      Else
         Let filename = TrimString( Arg1 )
      EndIf
      
      If Exists( filename ) AND filename <> NOTHING
         Dispose Relation
         
         Let Relation = LoadVariable( filename )
         Let C_Rel    = FirstArrayIndex( Relation )
         Let GotRels  = TRUE
      EndIf
   EndScript
   Routine "ReadInRequirements"
      ; -------------------------------------------------
      ; ReadInRequirements( filename.Reqs ) Subroutine.
      ; -------------------------------------------------
      
      Local filename
      
      If TrimString( Arg1 ) = NOTHING
         Let filename = DefaultDBase||".Reqs"
      Else
         Let filename = TrimString( Arg1 )
      EndIf
      
      If Exists( filename ) AND filename <> NOTHING
         Dispose Requirement
         
         Let Requirement = LoadVariable( filename )
         Let C_Req       = FirstArrayIndex( Requirement )
         Let GotReqs     = TRUE
      EndIf
   EndScript
   Routine "ReadInStates"
      ; ------------------------------------------------
      ; ReadInStates( filename.States ) Subroutine.
      ; ------------------------------------------------
      
      Local filename
      
      If TrimString( Arg1 ) = NOTHING
         Let filename = DefaultDBase||".States"
      Else
         Let filename = TrimString( Arg1 )
      EndIf
      
      If Exists( filename ) AND filename <> NOTHING
         Dispose State
         
         Let State     = LoadVariable( filename )
         Let C_State   = FirstArrayIndex( State )
         Let GotStates = TRUE
      EndIf
   EndScript
   Routine "ReadInSubs"
      ; ------------------------------------
      ; ReadInSubs( filename ) Subroutine.
      ; ------------------------------------
      
      Local filename
      
      If TrimString( Arg1 ) = NOTHING
         Let filename = DefaultDBase||".Subs"
      Else
         Let filename = TrimString( Arg1 )
      EndIf
      
      If Exists( filename ) AND filename <> NOTHING
         Dispose Subtype
         
         Let Subtype = LoadVariable( filename )
         Let C_Sub   = FirstArrayIndex( Subtype )
         Let GotSubs = TRUE
      EndIf
   EndScript
   Routine "ReadInSupers"
      ; --------------------------------------
      ; ReadInSupers( filename ) Subroutine.
      ; --------------------------------------
      
      Local filename
      
      If TrimString( Arg1 ) = NOTHING
         Let filename = DefaultDBase||".Supers"
      Else
         Let filename = TrimString( Arg1 )
      EndIf
      
      If Exists( filename ) AND filename <> NOTHING
         Dispose Supertype
         
         Let Supertype = LoadVariable( filename )
         Let C_Super   = FirstArrayIndex( Supertype )
         Let GotSupers = TRUE
      EndIf
      
   EndScript
   Routine "ReadInUserReqNotes"
      ; ------------------------------------------------------
      ; ReadInUserReqNotes( filename.TechNotes ) Subroutine.
      ; ------------------------------------------------------
      
      Local filename
      
      If TrimString( Arg1 ) = NOTHING
         Let filename = DefaultDBase||".TechNotes"
      Else
         Let filename = TrimString( Arg1 )
      EndIf
      
      If Exists( filename ) AND filename <> NOTHING
         Dispose UReq
         
         Let UReq     = LoadVariable( filename )
         Let C_UReq   = FirstArrayIndex( UReq )
         Let GotUReqs = TRUE
      EndIf
   EndScript
   Routine "Check_WriteIDE"
      ; -----------------------------------------------------------
      ; Check_WriteIDE( C_Norm, Normal[ C_Norm ].ID ) SubRoutine.
      ; -----------------------------------------------------------
      
      Local count
      Local i
      Local j
      Local NotFound
      Local txt
      Local object
      Local summ
      Local desc
      Local filename
      Local Tb
      
      Let Tb     = "   "
      Let summ   = ""
      Let desc   = ""
      Let object = LowerCase( TrimString( Arg2 ))
      Let count  = IntegerFrom( ".AttrCount" )
      Let i      = 0
      
      While i <= LastArrayIndex( IDE )
         If LowerCase( TrimString( IDE[ i ].Name )) EQUALS object
            Let NotFound = FALSE
            ExitLoop
         Else
            Let NotFound = TRUE
         EndIf
         
         Let i = i + 1
      EndLoop
      
      If NotFound = TRUE
         Do "DEBUG","Adding "||Arg2||" to IDE's!",2
         InsertArrayEntry IDE,C_IDE
         
         Let i                    = C_IDE
         Let IDE[ i ].ParentName  = Normal[Arg1].ParentName
         Let IDE[ i ].ParentNmbr  = 0
         Let IDE[ i ].Name        = Normal[Arg1].ID
         Let IDE[ i ].Number      = Normal[Arg1].Number
         Let IDE[ i ].Description = "   To Be Determined."
         
         WorkWithDocument "AttributeList"
         MoveCursorTo STARTOF DOCUMENT 
         
         Let txt                  = TrimString( TheLine )
         Let IDE[ i ].Identifiers = "1."|||txt|||"(*)"
         Let summ = TrimString( String( Normal[Arg1].Number ))
         Let summ = summ||"."|||Normal[ Arg1 ].ID||Char( 10 )
         Let summ = summ||Tb||"  ("
         Let summ = summ||"1."|||txt|||"(*) +"||Char( 10 )
         Let desc = Normal[Arg1].Number||".1"
         Let desc = desc|||Normal[Arg1].ID||"."||txt||Char( 10 )
         Let desc = desc||"   To Be Determined."||Char( 10 )||Char( 10 )
         Let IDE[ i ].Domain = "UNKNOWN."||Char( 10 )||Char( 10 )
         
         MoveCursor DOWN 
         
         Let j = 2
         
         While j <= count
            Let txt  = TrimString( TheLine )
            Let summ = Tb||summ||String( j )||". "
            
            If j < count
               Let summ = summ||txt|||"+"||Char( 10 )
            Else
               Let summ = summ||txt
            EndIf
            
            Let desc = desc||Normal[Arg1].Number||"."||String( j )||" "
            Let desc = desc||Normal[Arg1].ID||"."||txt||Char( 10 )
            Let desc = desc||"   To Be Determined."||Char( 10 )||Char( 10 )
            Let IDE[ i ].Domain = IDE[ i ].Domain||"UNKNOWN."||Char( 10 )||Char( 10 )
            
            MoveCursor DOWN 
            Let j    = j + 1
         EndLoop
         
         Let summ                     = summ||")"
         Let IDE[ i ].AttrSummary     = summ
         Let IDE[ i ].AttrDescription = desc
         
         Let filename = DefaultDBase||".IDEs"
         SaveVariable IDE,filename
      EndIf
   EndScript
   Routine "DeleteEmptyLines"
      ; --------------------------------
      ; DeleteEmptyLines() SubRoutine.
      ; --------------------------------
      
      Local safety
      Local diff
      Local cnt
      
      MoveCursorTo STARTOF DOCUMENT 
      
      Let safety = LinesInDocument
      Let cnt    = safety
      Let diff   = 0
      
      While Do( "EmptyString", TheLine ) <> TRUE AND cnt > 0
         Let cnt  = cnt - 1
         Let diff = diff + 1
      EndLoop
      
      MoveCursorTo STARTOF DOCUMENT 
      
      If safety > diff
         
         While safety > 0
            
            If Do( "EmptyString", TheLine ) = TRUE
               Delete LINE 
            Else
               MoveCursor DOWN 
            EndIf
            
            Let safety = safety - 1
         EndLoop
      EndIf
      
      MoveCursorTo STARTOF DOCUMENT 
      
   EndScript
   Routine "DisplayISTArrays"
      ; ------------------------------------------------------
      ; DisplayISTArrays( delay ) Subroutine.
      ; ------------------------------------------------------
      
      Local i
      Local index
      Let index = FirstArrayIndex( IST )
      
      While index <= LastArrayIndex( IST )
         
         SetPen 7 ; RED
         PrintText "Index = "||index,50,180
         PrintText " ObjectName: "||IST[index].ObjectName,275,180
         PrintText "CapType: "||IST[index].CapType||" CapString: "||IST[index].CapString,50,191
         PrintText "QuestionNum: "||IST[index].QuestionNum||" OutObjectNum: "||IST[index].OutObjectNum,50,202
         PrintText "OutAttributeNum: "||IST[index].OutAttributeNum||" OutIDFlag: "||IST[index].OutIDFlag,50,213
         
         Let i = 0
         
         While i < 4
            PrintText "InObjectNum["||i||"] = "||IST[index].InObjectNum[i],70,224
            PrintText "InAttributeNum["||i||"] = "||IST[index].InAttributeNum[i],70,235
            PrintText "ObjectIDFlag["||i||"] = "||IST[index].ObjectIDFlag[i],70,246
            Delay 0,4,0
            
            SetPen 0
            PrintText "InObjectNum["||i||"] = "||IST[index].InObjectNum[i],70,224
            PrintText "InAttributeNum["||i||"] = "||IST[index].InAttributeNum[i],70,235
            PrintText "ObjectIDFlag["||i||"] = "||IST[index].ObjectIDFlag[i],70,246
            SetPen 4
            
            Let i = i + 1
         EndLoop
         
         Delay 0,0,Arg1
         
         SetPen 0
         PrintText "Index = "||index,50,180
         PrintText " ObjectName: "||IST[index].ObjectName,275,180
         PrintText "CapType: "||IST[index].CapType||" CapString: "||IST[index].CapString,50,191
         PrintText "QuestionNum: "||IST[index].QuestionNum||" OutObjectNum: "||IST[index].OutObjectNum,50,202
         PrintText "OutAttributeNum: "||IST[index].OutAttributeNum||" OutIDFlag: "||IST[index].OutIDFlag,50,213
         
         Let index = index + 1
      EndLoop
   EndScript
   Routine "MakeObjectsArray"
      ; -----------------------------------------
      ; MakeObjectsArray() subroutine.
      ; -----------------------------------------
      
      Local index
      Local i
      Local a
      
      Let i     = 0
      
      If GotNorms = FALSE
         Do "ReadInNormals"
      EndIf
      
      Let index = FirstArrayIndex( Normal )
      
      While index <= LastArrayIndex( Normal )
         Let Objects[i].ID         = Normal[index].ID
         Let Objects[i].Number     = Normal[index].Number
         Let Objects[i].AttrCount  = Normal[index].AttrCount
         Let Objects[i].ParentName = Normal[index].ParentName
         Let Objects[i].Type       = "NORMAL"
         
         Let a = 0
         
         WorkWithDocument "AttributeList"
         Clear DOCUMENT 
         Type Normal[index].AttrName
         
         MoveCursorTo STARTOF DOCUMENT 
         
         While a <= LinesInDocument
            Let Objects[i].AttrName[a] = TheLine
            MoveCursor DOWN 
            Let a = a + 1
         EndLoop
         
         Let index = index + 1
         Let i     = i + 1
      EndLoop
      
      If GotAssocs = FALSE
         Do "ReadInAssociations"
      EndIf
      
      Let index = FirstArrayIndex( Association )
      
      While index <= LastArrayIndex( Association )
         Let Objects[i].ID         = Association[index].Name
         Let Objects[i].Number     = Association[index].Number
         Let Objects[i].AttrCount  = Association[index].AttrCount
         Let Objects[i].ParentName = Association[index].ParentName
         Let Objects[i].Type       = "ASSOCIATION"
         
         Let a = 0
         
         WorkWithDocument "AttributeList"
         Clear DOCUMENT 
         Type Association[index].AttrName
         
         MoveCursorTo STARTOF DOCUMENT 
         
         While a <= LinesInDocument
            Let Objects[i].AttrName[a] = TheLine
            MoveCursor DOWN 
            Let a = a + 1
         EndLoop
         
         Let index = index + 1
         Let i     = i + 1
      EndLoop
      
      If GotComps = FALSE
         Do "ReadInComposites"
      EndIf
      
      Let index = FirstArrayIndex( Composite )
      
      While index <= LastArrayIndex( Composite )
         Let Objects[i].ID         = Composite[index].Name
         Let Objects[i].Number     = Composite[index].Number
         Let Objects[i].AttrCount  = Composite[index].AttrCount
         Let Objects[i].ParentName = Composite[index].ParentName
         Let Objects[i].Type       = "COMPOSITE"
         
         Let a = 0
         
         WorkWithDocument "AttributeList"
         Clear DOCUMENT 
         Type Composite[index].AttrName
         
         MoveCursorTo STARTOF DOCUMENT 
         
         While a <= LinesInDocument
            Let Objects[i].AttrName[a] = TheLine
            MoveCursor DOWN 
            Let a = a + 1
         EndLoop
         
         Let index = index + 1
         Let i     = i + 1
      EndLoop
      
      If GotRels = FALSE
         Do "ReadInRelations"
      EndIf
      
      Let index = FirstArrayIndex( Relation )
      
      While index <= LastArrayIndex( Relation )
         Let Objects[i].ID         = Relation[index].Spec
         Let Objects[i].Number     = Relation[index].Number
         Let Objects[i].AttrCount  = Relation[index].AttrCount
         Let Objects[i].ParentName = Relation[index].ParentName
         Let Objects[i].Type       = "RELATION"
         
         Let a = 0
         
         WorkWithDocument "AttributeList"
         Clear DOCUMENT 
         Type Relation[index].AttrName
         
         MoveCursorTo STARTOF DOCUMENT 
         
         While a <= LinesInDocument
            Let Objects[i].AttrName[a] = TheLine
            MoveCursor DOWN 
            Let a = a + 1
         EndLoop
         
         Let index = index + 1
         Let i     = i + 1
      EndLoop
      
      If GotSupers = FALSE
         Do "ReadInSupers"
      EndIf
      
      Let index = FirstArrayIndex( Supertype )
      
      While index <= LastArrayIndex( Supertype )
         Let Objects[i].ID         = Supertype[index].Name
         Let Objects[i].Number     = Supertype[index].Number
         Let Objects[i].AttrCount  = Supertype[index].AttrCount
         Let Objects[i].ParentName = Supertype[index].ParentName
         Let Objects[i].Type       = "SUPER"
         
         Let a = 0
         
         WorkWithDocument "AttributeList"
         Clear DOCUMENT 
         Type Supertype[index].AttrName
         
         MoveCursorTo STARTOF DOCUMENT 
         
         While a <= LinesInDocument
            Let Objects[i].AttrName[a] = TheLine
            MoveCursor DOWN 
            Let a = a + 1
         EndLoop
         
         Let index = index + 1
         Let i     = i + 1
      EndLoop
      
      If GotSubs = FALSE
         Do "ReadInSubs"
      EndIf
      
      Let index = FirstArrayIndex( Subtype )
      
      While index <= LastArrayIndex( Subtype )
         Let Objects[i].ID         = Subtype[index].Name
         Let Objects[i].Number     = Subtype[index].Number
         Let Objects[i].AttrCount  = Subtype[index].AttrCount
         Let Objects[i].ParentName = Subtype[index].ParentName
         Let Objects[i].Type       = "SUB"
         
         Let a = 0
         
         WorkWithDocument "AttributeList"
         Clear DOCUMENT 
         Type Subtype[index].AttrName
         
         MoveCursorTo STARTOF DOCUMENT 
         
         While a <= LinesInDocument
            Let Objects[i].AttrName[a] = TheLine
            MoveCursor DOWN 
            Let a = a + 1
         EndLoop
         
         Let index = index + 1
         Let i     = i + 1
      EndLoop
      
      Let LastObj = i
   EndScript
   Routine "ParseCapabilityStrings"
      ; --------------------------------------------------------
      ; ParseCapabilityStrings( CapArrayIndex  ) SubRoutine.
      ; --------------------------------------------------------
      
      Local start
      Local end      ;Arg1 = Capability array index!
      Local capstring ;[S|C|A|R|N#Q#: O#.A#{*},...]
      Local reqstring ;O#.A#{*}
      
      Local i
      Local instr
      Local obj_num
      
      Let LastIST             = Arg1
      Let capstring           = Capability[Arg1].CString
      Let IST[Arg1].CapString = capstring
      Let reqstring           = Capability[Arg1].ReqString
      
      Let start     = FindChars( capstring, "[", 1 ) + 1
      Let end       = FindChars( capstring, "]", 1 )
      Let capstring = GetChars( capstring, start, end - start )
      
      If FindChars( capstring, "A", 1 ) > 0
         Let IST[Arg1].CapType = "ASSOCIATION"
      ElseIf FindChars( capstring, "R", 1 ) > 0
         Let IST[Arg1].CapType = "RELATION"
      ElseIf FindChars( capstring, "C", 1 ) > 0
         Let IST[Arg1].CapType = "COMPOSITE"
      ElseIf FindChars( capstring, "S", 1 ) > 0
         Let IST[Arg1].CapType = "SUPERTYPE"
      Else
         Let IST[Arg1].CapType = "NORMAL"
      EndIf
      
      Let end     = FindChars( capstring, "Q", 1 )
      Let obj_num = GetChars( capstring, 1, end - 1 )
      Let i       = FirstArrayIndex( Objects )
      Let start   = SearchArray( Objects, obj_num, ".Number", i )
      
      If SearchFound
         Let IST[Arg1].ObjectName = Objects[start].ID
      Else
         Do "DEBUG","Didn't find "||obj_num,4
      EndIf
      
      Let start = FindChars( capstring, "Q", 1 ) + 1
      Let end   = FindChars( capstring, ":", 1 )
      Let instr = GetChars( capstring, start, end - start )
      
      Let IST[Arg1].QuestionNum = Integer( instr )
      
      Let start = end
      Let end   = NumberOfChars( capstring )
      
      Let capstring = GetChars( capstring, start + 1, end - start )
      Let capstring = TrimString( capstring )
      
      Let i = 0
      
      While i < 128      ;Zero out the Input Array #'s
         Let IST[Arg1].InObjectNum[i]    = 0
         Let IST[Arg1].InAttributeNum[i] = 0
         Let IST[Arg1].ObjectIDFlag[i]   = 0
         
         Let i = i + 1
      EndLoop
      
      Let i = 0
      Let WordDelimiters = ".*,"
      
      While NumberOfChars( capstring ) > 0
         Let instr = GetWord( capstring, 1, WordDelimiters )
         
         Let IST[Arg1].InObjectNum[i] = Integer( instr )
         
         Let capstring = RemoveChars( capstring, 1, NumberOfChars( instr ) + 1)
         Let instr     = GetWord( capstring, 1, WordDelimiters )
         
         Let IST[Arg1].InAttributeNum[i] = Integer( instr )
         
         Let capstring = RemoveChars( capstring, 1, NumberOfChars( instr ) + 1)
         
         If IST[Arg1].InAttributeNum[i] = 1
            Let IST[Arg1].ObjectIDFlag[i] = 1
            Let capstring = GetChars( capstring, 2, NumberOfChars( capstring ))
         Else
            Let IST[Arg1].ObjectIDFlag[i] = 0
         EndIf
         
         Let i = i + 1
      EndLoop
      
      Let IST[Arg1].InSortKey = IST[Arg1].InObjectNum[0] * 10 + IST[Arg1].InAttributeNum[0]
      
      Let WordDelimiters         = "."
      Let instr                  = GetWord( reqstring, 1, WordDelimiters)
      Let IST[Arg1].OutObjectNum = Integer( instr )
      Let end                    = FindChars( reqstring, "*", 1 )
      
      If end > 0
         Let IST[Arg1].OutIDFlag = 1
         Let reqstring           = GetChars( reqstring, 1, end - 1 )
      Else
         Let IST[Arg1].OutIDFlag = 0
      EndIf
      
      Let start     = Findchars( reqstring, ".", 1 )
      Let end       = NumberOfChars( reqstring )
      Let reqstring = GetChars( reqstring, start + 1, end - start )
      
      Let IST[Arg1].OutAttributeNum = Integer( reqstring )
      
      Let IST[Arg1].OutSortKey = IST[Arg1].OutObject * 10 + IST[Arg1].OutAttribute
   EndScript
   Routine "SaveAll"
      ; ------------------------------------------------------
      ; SaveAll( database_filename, windowtitle ) Subroutine.
      ; ------------------------------------------------------
      
      Local filename
      
      SetWindowTitle "Saving Object Associations..."
      Delay 0,0,5
      
      Let filename = Arg1||".Assocs"
      
      Do "SaveAssociations",filename
      
      SetWindowTitle "Saving Behavior Descriptive Entries..."
      Delay 0,0,5
      
      Let filename = Arg1||".BDEs"
      Do "SaveBDEs",filename
      
      SetWindowTitle "Saving System Capabilities..."
      Delay 0,0,5
      
      Let filename = Arg1||".Caps"
      Do "SaveCapabilities",filename
      
      SetWindowTitle "Saving Context Descriptive Entries..."
      Delay 0,0,5
      
      Let filename = Arg1||".CDEs"
      Do "SaveCDEs",filename
      
      SetWindowTitle "Saving Composite Objects..."
      Delay 0,0,5
      
      Let filename = Arg1||".Comps"
      Do "SaveComposites",filename
      
      SetWindowTitle "Saving Information Descriptive Entries..."
      Delay 0,0,5
      
      Let filename = Arg1||".IDEs"
      Do "SaveIDEs",filename
      
      SetWindowTitle "Saving Normal Objects..."
      Delay 0,0,5
      
      Let filename = Arg1||".Norms"
      Do "SaveObjects",filename
      
      SetWindowTitle "Saving Object Communication Table Entries..."
      Delay 0,0,5
      
      Let filename = Arg1||".OCTs"
      Do "SaveOCTs",filename
      
      SetWindowTitle "Saving Process Descriptive Entries..."
      Delay 0,0,5
      
      Let filename = Arg1||".PDEs"
      Do "SavePDEs",filename
      
      SetWindowTitle "Saving Processes..."
      Delay 0,0,5
      Let filename = Arg1||".Procs"
      
      Do "SaveProcesses",filename
      
      SetWindowTitle "Saving User Requirements..."
      Delay 0,0,5
      
      Let filename = Arg1||".Reqs"
      Do "SaveRequirements",filename
      
      SetWindowTitle "Saving SubType Objects..."
      Delay 0,0,5
      
      Let filename = Arg1||".Subs"
      Do "SaveSubTypes",filename
      
      SetWindowTitle "Saving Super Objects..."
      Delay 0,0,5
      
      Let filename = Arg1||".Supers"
      Do "SaveSuperTypes",filename
      
      SetWindowTitle "Saving Technical Notes..."
      Delay 0,0,5
      
      Let filename = Arg1||".TechNotes"
      Do "SaveUReqs",filename
      
      SetWindowTitle Arg2
   EndScript
   Routine "Search"
      ; -------------------------------------------
      ; Search( searchstr, caseflag ) Subroutine.
      ; -------------------------------------------
      
      Local safety
      Local str
      
      Let str = Arg1
      
      MoveCursorTo STARTOF DOCUMENT 
      Let safety = LinesInDocument
      
      If Arg2 = 0 ; Case-sensitive search:
         
         While FindChars( TheLine, str, 1 ) <= 0 AND safety > 0
            MoveCursor DOWN 
            Let safety = safety - 1
         EndLoop
      Else
         Let str = UpperCase( Arg1 )
         
         While FindChars( UpperCase( TheLine ), str, 1 ) <= 0 AND safety > 0
            MoveCursor DOWN 
            Let safety = safety - 1
         EndLoop
      EndIf
   EndScript
   Routine "SendTempListToFile"
      ; -------------------------------------------------------
      ; SendTempListToFile( bufname, pgbrkcount ) subroutine.
      ; -------------------------------------------------------
      
      Local index
      Local howmany
      Local pagebreak
      Local linecount
      
      Let pagebreak = Arg2
      
      WorkWithDocument "TempList"
      MoveCursorTo STARTOF DOCUMENT 
      
      Let howmany   = LinesInDocument
      Let index     = 0
      Let linecount = 1
      
      While index < howmany
         
         If linecount = pagebreak
            FileWriteChars Arg1,Char( 12 ),1 ; FormFeed character.
            
            FileWriteLine Arg1,""
            FileWriteLine Arg1,""
            FileWriteLine Arg1,""
            
            Let linecount = 3
         EndIf
         
         FileWriteLine Arg1,TheLine
         MoveCursor DOWN 
         
         Let linecount = linecount + 1
         Let index     = index + 1
      EndLoop
   EndScript
   Routine "RestoreOldColors"
      ; -------------------------------
      ; RestoreOldColors SubRoutine.
      ; -------------------------------
      
      Local i
      Let i = 0
      
      While i < ScreenColors       ; 16
         SetRGB i,R[i],G[i],B[i]
         Let i = i + 1
      EndLoop
   EndScript
   Routine "SetUpColors"
      ; -----------------------------
      ; SetupColors()
      ; -----------------------------
      
      SetRGB 0,168,168,168 ;Gray1
      SetRGB 1,0,0,0 ;BLACK
      SetRGB 2,236,236,236 ;WHITE
      SetRGB 3,100,136,152 ;BLUE1
      SetRGB 4,220,0,220 ;MAGENTA
      SetRGB 5,168,52,152 ;PURPLE
      SetRGB 6,200,152,52 ;GOLD
      SetRGB 7,184,16,16 ;RED
      SetRGB 8,0,52,116 ;DK BLUE
      SetRGB 9,84,84,84 ;Gray2
      SetRGB 10,136,136,136 ;Gray3
      SetRGB 11,200,152,116 ;TAN
      SetRGB 12,52,136,52 ;DK GREEN
      SetRGB 13,52,52,52 ;DK GRAY
      SetRGB 14,220,220,220 ;LT GRAY
      SetRGB 15,100,136,184 ;BLUE2
      
   EndScript
   Routine "CheckUserSanity"
      ; --------------------------------
      ; CheckUserSanity() SubRoutine.
      ; --------------------------------
      
      Local t
      Local m
      Local c
      Local a
      
      Let c = Char( 10 )
      
      Let t = "User SANITY CHECK:"
      Let m = "The action you've selected to perform could lead to"||c
      Let m = m||"LOSS of Data, (if you select 'SAVE' or 'SAVE AS'"||c
      Let m = m||"at a later time!), do you wish to proceed?"
      
      Let a = AskForResponse( m, t, "I Know what I'm doing!|CANCEL!" )
      
      If a = 1
         ExitScript TRUE
      Else
         ExitScript FALSE
      EndIf
   EndScript
   Routine "InitStructures"
      ; ---------------------------------------
      ; InitStructures() SubRoutine.
      ;
      ; Last Changed on 22-Oct-2000
      ;    Added AttrCode[] strings.
      ;    Changed .Number fields to Strings.
      ; ---------------------------------------
      
      Let Requirement[0].InObject     = ""   ; Record Code = 1
      Let Requirement[0].OutObject    = ""
      Let Requirement[0].InAttribute  = ""
      Let Requirement[0].OutAttribute = ""
      Let Requirement[0].Number       = ""
      
      ; Record Code = 2
      
      Let Capability[0].CString        = "" ; Input [O#.q#] O#.A#
      Let Capability[0].ReqString      = "" ; Output O#.A#
      Let Capability[0].Number         = "" ; Capability #
      Let Capability[0].ReqNumber      = ""
      Let Capability[0].Description    = ""
      Let Capability[0].ReqDescription = "" ; Requirment
      
      Let Supertype[0].Number      = "" ; Record Code = 3
      Let Supertype[0].NumChildren = 0
      Let Supertype[0].Name        = ""
      Let Supertype[0].Child       = ""
      Let Supertype[0].ParentName  = ""
      Let Supertype[0].AttrCount   = 0
      Let Supertype[0].AttrName    = ""
      Let Supertype[0].AttrNumber  = 0
      
      Let Subtype[0].Number     = ""    ; Record Code = 4
      Let Subtype[0].ParentName = ""
      Let Subtype[0].Name       = ""
      Let Subtype[0].NextChild  = ""
      Let Subtype[0].AttrCount  = 0
      Let Subtype[0].AttrName   = ""
      Let Subtype[0].AttrNumber = 0
      
      Let Attribute[0].ParentName       = "" ; Record Code = 6
      Let Attribute[0].ParentNmbr       = ""
      Let Attribute[0].AttributeName    = ""
      Let Attribute[0].NextAttribName   = ""
      Let Attribute[0].Number           = ""
      Let Attribute[0].ParentAttribCode = ""
      
      Let Relation[0].Spec         = "" ; Record Code = 7
      Let Relation[0].Relator      = ""
      Let Relation[0].Related      = ""
      Let Relation[0].ByAction     = ""
      Let Relation[0].Number       = ""
      Let Relation[0].AttrCount    = 0
      Let Relation[0].AttrName     = ""
      Let Relation[0].AttrNumber   = 0
      Let Relation[0].RelatorCount = ""
      Let Relation[0].RelatedCount = ""
      Let Relation[0].ParentName   = ""
      
      Let Association[0].Name       = "" ; Record Code = 8
      Let Association[0].Number     = ""
      Let Association[0].NextObject = ""
      Let Association[0].Count      = 0
      Let Association[0].AttrCount  = 0
      Let Association[0].AttrName   = ""
      Let Association[0].AttrNumber = 0
      Let Association[0].ParentName = ""
      
      Let Composite[0].Name       = "" ; Record Code = 9
      Let Composite[0].Number     = ""
      Let Composite[0].NextObject = ""
      Let Composite[0].Count      = 0  ; Component Count.
      Let Composite[0].AttrCount  = 0
      Let Composite[0].AttrName   = ""
      Let Composite[0].AttrNumber = 0
      Let Composite[0].ParentName = ""
      
      Let Process[0].ParentName = ""  ; Record Code = 10
      Let Process[0].Name       = ""
      Let Process[0].InputEvent = ""
      Let Process[0].DataStores = ""   ;Problemo ([0])
      Let Process[0].DataNums   = ""   ;Problemo ([0])
      Let Process[0].Number     = ""
      Let Process[0].Spec       = ""
      Let Process[0].ObjectNum  = 0
      Let Process[0].Output     = ""
      
      Let State[0].Name         = ""  ; Record Code = 11
      Let State[0].Number       = ""
      Let State[0].TriggerEvent = ""  ; Same as OCT[].EventDescription
      Let State[0].NextState    = ""
      Let State[0].Action       = ""
      
      Let CDE[0].SystemTitle           = ""  ; Record Code = 12
      Let CDE[0].TerminatorDescription = ""
      Let CDE[0].SourceFlag            = TRUE
      Let CDE[0].SinkFlag              = FALSE
      Let CDE[0].SrcSinkFlag           = FALSE
      Let CDE[0].TerminatorName        = ""
      Let CDE[0].ObjectNums            = ""
      Let CDE[0].Number                = ""
      
      Let IDE[0].Identifiers     = ""        ; Record Code = 13
      Let IDE[0].Name            = ""
      Let IDE[0].AttrSummary     = ""   ;Problemo w/ [0]
      Let IDE[0].Description     = ""
      Let IDE[0].AttrDescription = ""
      Let IDE[0].Domain          = ""    ;Problemo w/ [0]
      Let IDE[0].Number          = ""
      
      Let BDE[0].State             = "" ; Record Code = 14
      Let BDE[0].Event             = ""
      Let BDE[0].Source            = ""
      Let BDE[0].Destination       = ""
      Let BDE[0].ActionDescription = ""
      Let BDE[0].TransitionTo      = ""
      Let BDE[0].ThreadNum         = ""
      Let BDE[0].ActionNum         = ""
      Let BDE[0].ActionDetails     = ""
      Let BDE[0].Number            = ""
      
      ; Record Code = 15
      
      Let OCT[0].EventDescription  = "" ; Same as State[].TriggerEvent
      Let OCT[0].EventSource       = ""
      Let OCT[0].EventSink         = ""
      Let OCT[0].EventData         = ""
      Let OCT[0].Number            = ""
      
      Let PDE[0].ObjectName        = "" ; Record Code = 16
      Let PDE[0].ObjectNum         = 0
      Let PDE[0].Name              = "" ; Process Name!
      Let PDE[0].ActivityName      = ""
      Let PDE[0].ActionName        = ""
      Let PDE[0].ActionNum         = ""
      Let PDE[0].ActivityNum       = ""
      Let PDE[0].Number            = ""
      Let PDE[0].Description       = "" ;Process Description!
      
      Let Normal[0].ID             = "" ; Record Code = 17
      Let Normal[0].ParentName     = ""
      Let Normal[0].AttrName       = ""
      Let Normal[0].AttrNumber     = 0
      Let Normal[0].AttrCount      = 0
      Let Normal[0].Number         = ""
      
      Let UReq[0].Name             = "" ; Record Code = 18
      Let UReq[0].Number           = ""
      Let UReq[0].CrossRef         = ""
      Let UReq[0].Notes            = ""
      
      Let Objects[0].ID            = "" ;used with ISTCard only!
      Let Objects[0].Number        = ""
      Let Objects[0].AttrCount     = 0
      Let Objects[0].Type          = ""
      Let Objects[0].ParentName    = ""
      Let Objects[0].AttrName[0]   = ""
      Let Objects[0].AttrNumber[0] = 0
      
      Global QStr[0,0]
      
      Let QStr[0,0]                = "" ;Only used in ISTCard!
      
      Let IST[0].ObjectName        = "" ;Not used to write records,
      Let IST[0].InObjectNum[0]    = 0  ;Visible only inside GOOSA!
      Let IST[0].ObjectIDFlag[0]   = 0
      Let IST[0].InAttributeNum[0] = 0
      Let IST[0].QuestionNum       = ""
      Let IST[0].CapType           = ""
      Let IST[0].CapString         = ""
      Let IST[0].OutObjectNum      = 0
      Let IST[0].OutAttributeNum   = 0
      Let IST[0].OutIDFlag         = 0
      Let IST[0].InSortKey         = 0 ;10 * InObjectNum[0] + InAttributeNum[0]
      Let IST[0].OutSortKey        = 0 ;10 * OUtObjectNum + OutAttributeNum
      
      Let C_Req   = 0   ;Indices into the structure arrays
      Let C_Cap   = 0 ;which point to the current array element.
      Let C_Super = 0
      Let C_Sub   = 0
      Let C_Attr  = 0
      Let C_Rel   = 0
      Let C_Assoc = 0
      Let C_Comp  = 0
      Let C_Proc  = 0
      Let C_State = 0
      Let C_CDE   = 0
      Let C_IDE   = 0
      Let C_BDE   = 0
      Let C_OCT   = 0
      Let C_PDE   = 0
      Let C_Norm  = 0
      Let C_UReq  = 0
      
      Let C_IST   = 0      ;used by ISTCard only!
      Let C_Obj   = 0      ;used by ISTCard only!
      Let LastObj = 0      ;used by ISTCard only!
      
      MakeDocument "DebugResult"
      
      Let GotReqs   = FALSE ;Flags which tell GOOSA which
      Let GotCaps   = FALSE ;database records have been read in.
      Let GotSupers = FALSE
      Let GotSubs   = FALSE
      Let GotRels   = FALSE
      Let GotAssocs = FALSE
      Let GotComps  = FALSE
      Let GotStates = FALSE
      Let GotCDEs   = FALSE
      Let GotOCTs   = FALSE
      Let GotIDEs   = FALSE
      Let GotBDEs   = FALSE
      Let GotPDEs   = FALSE
      Let GotProcs  = FALSE
      Let GotUReqs  = FALSE
      Let GotNorms  = FALSE
      Let GotAttrs  = FALSE
      
      ; Used on EidtAttributes card:
      
      Let AttrCode[0]    = "REQUIREMENT"
      Let AttrCode[1]    = "CAPABILITY"
      Let AttrCode[2]    = "SUPERTYPE"
      Let AttrCode[3]    = "SUBTYPE"
      Let AttrCode[4]    = "NOT_USED"      ; Not used yet!
      Let AttrCode[5]    = "ATTRIBUTE"
      Let AttrCode[6]    = "RELATIONSHIP"
      Let AttrCode[7]    = "ASSOCIATION"
      Let AttrCode[8]    = "COMPOSITE"
      Let AttrCode[9]    = "PROCESS"
      Let AttrCode[10]   = "STATE"
      Let AttrCode[11]   = "CDE"
      Let AttrCode[12]   = "IDE"
      Let AttrCode[13]   = "BDE"
      Let AttrCode[14]   = "OCT"
      Let AttrCode[15]   = "PDE"
      Let AttrCode[16]   = "NORMAL OBJ'"
      Let AttrCode[17]   = "USER REQ'"
      
      Global WTTL    ; Titles for the various windows:
      
      Let WTTL[0]  = "G.O.O.S.A.  ---- Object-Oriented System Analysis & Design:"
      Let WTTL[1]  = "DataBase Record Keeping:"
      Let WTTL[2]  = "View & Print Report(s):"
      Let WTTL[3]  = "Edit G.O.O.S.A.  Tool Types:"
      Let WTTL[4]  = "ARexx  Interface:"
      Let WTTL[5]  = "User Technical Notes on Requirements:"
      Let WTTL[6]  = "User Requirements:"
      Let WTTL[7]  = "Edit User Requirements:"
      Let WTTL[8]  = "System Capabilities:"
      Let WTTL[9]  = "Edit System Capabilities:"
      Let WTTL[10] = "Requirements Traceability Matrix:"
      Let WTTL[11] = "Context Descriptive Entry(s):"
      Let WTTL[12] = "Edit Context Descriptive Entry(s):"
      Let WTTL[13] = "Information Descriptive Entry(s):"
      Let WTTL[14] = "Edit Information Descriptive Entry(s):"
      Let WTTL[15] = "Behavior Descriptive Entry(s):"
      Let WTTL[16] = "Edit Behavior Descriptive Entry(s):"
      Let WTTL[17] = "Process Descriptive Entry(s):"
      Let WTTL[18] = "Edit Process Descriptive Entry(s):"
      Let WTTL[19] = "Processes:"
      Let WTTL[20] = "Edit Processes:"
      Let WTTL[21] = "Context System Table:"
      Let WTTL[22] = "Edit Context System Table Entry(s):"
      Let WTTL[23] = "Information Structure Table (Derived, Editable data):"
      Let WTTL[24] = "Object Communication Table:"
      Let WTTL[25] = "Edit Object Communication Table Entry(s):"
      Let WTTL[26] = "State Transition Table:"
      Let WTTL[27] = "Edit State Transition Table Entry(s):"
      Let WTTL[28] = "Context System Diagram:"
      Let WTTL[29] = "Information Structure Diagram:"
      Let WTTL[30] = "State Transition Diagram:"
      Let WTTL[31] = "Object Communication Diagram:"
      Let WTTL[32] = "Process Flow Diagram:"
      Let WTTL[33] = "Edit Object Attribute(s):"
      Let WTTL[34] = "Edit Normal Object(s) & Attibute(s):"
      Let WTTL[35] = "Edit Relationship(s):"
      Let WTTL[36] = "Edit Object Association(s):"
      Let WTTL[37] = "Edit Composite Objects:"
      Let WTTL[38] = "Edit Super Object(s):"
      Let WTTL[39] = "Edit SubType Object(s):"
      Let WTTL[40] = "List of Currently Defined Object(s):"
   EndScript
   Routine "GetParentNumber"
      ; ---------------------------------------------------
      ; GetParentNumber( name, attrcode ) SubRoutine.
      ; ---------------------------------------------------
      
      Local i
      Local code
      Local name
      Local rval
      
      Let code = TrimString( Arg2 )
      Let name = TrimString( Arg1 )
      
      If code = 0
         Let rval = "ATTRCODE_ERROR!"
         
      ElseIf code = 1
         Let i = FirstArrayIndex( Requirement )
         
         While i <= LastArrayIndex( Requirement )
            If FindChars( Requirement[i].InObject, name, 1 ) > 0
               ExitScript TrimString( Requirement[i].Number )
            EndIf
            
            Let i = i + 1
         EndLoop
         Let rval = "Unknown_REQ!"
         
      ElseIf code = 2
         Let i = FirstArrayIndex( Capability )
         
         While i <= LastArrayIndex( Capability )
            If FindChars( Capability[i].String, name, 1 ) > 0
               ExitScript TrimString( Capability[i].Number )
            EndIf
            
            Let i = i + 1
         EndLoop
         Let rval = "Unknown_CAP!"
         
      ElseIf code = 3
         Let i = FirstArrayIndex( Supertype )
         
         While i <= LastArrayIndex( Supertype )
            If FindChars( Supertype[i].Name, name, 1 ) > 0
               ExitScript TrimString( Supertype[i].Number )
            EndIf
            
            Let i = i + 1
         EndLoop
         Let rval = "Unknown_SUPER!"
         
      ElseIf code = 4
         Let i = FirstArrayIndex( Subtype )
         
         While i <= LastArrayIndex( Subtype )
            If FindChars( Subtype[i].Name, name, 1 ) > 0
               ExitScript TrimString( Subtype[i].Number )
            EndIf
            
            Let i = i + 1
         EndLoop
         Let rval = "Unknown_SUB!"
         
      ElseIf code = 5
         Let rval = "ATTRCODE_ERROR!"
         
      ElseIf code = 6
         Let i = FirstArrayIndex( Attribute )
         
         While i <= LastArrayIndex( Attribute )
            If FindChars( Attribute[i].AttributeName, name, 1 ) > 0
               ExitScript TrimString( Attribute[i].Number )
            EndIf
            
            Let i = i + 1
         EndLoop
         Let rval = "Unknown_ATTR!"
         
      ElseIf code = 7
         Let i = FirstArrayIndex( Relation )
         
         While i <= LastArrayIndex( Relation )
            If FindChars( Relation[i].Spec, name, 1 ) > 0
               ExitScript TrimString( Relation[i].Number )
            EndIf
            
            Let i = i + 1
         EndLoop
         Let rval = "Unknown_REL!"
         
      ElseIf code = 8
         Let i = FirstArrayIndex( Association )
         
         While i <= LastArrayIndex( Association )
            If FindChars( Association[i].Name, name, 1 ) > 0
               ExitScript TrimString( Association[i].Number )
            EndIf
            
            Let i = i + 1
         EndLoop
         Let rval = "Unknown_ASSOC!"
         
      ElseIf code = 9
         Let i = FirstArrayIndex( Composite )
         
         While i <= LastArrayIndex( Composite )
            If FindChars( Composite[i].Name, name, 1 ) > 0
               ExitScript TrimString( Composite[i].Number )
            EndIf
            
            Let i = i + 1
         EndLoop
         Let rval = "Unknown_COMP!"
         
      ElseIf code = 10
         Let i = FirstArrayIndex( Process )
         
         While i <= LastArrayIndex( Process )
            If FindChars( Process[i].Name, name, 1 ) > 0
               ExitScript TrimString( Process[i].Number )
            EndIf
            
            Let i = i + 1
         EndLoop
         Let rval = "Unknown_PROC!"
         
      ElseIf code = 11
         Let i = FirstArrayIndex( State )
         
         While i <= LastArrayIndex( State )
            If FindChars( State[i].Name, name, 1 ) > 0
               ExitScript TrimString( State[i].Number )
            EndIf
            
            Let i = i + 1
         EndLoop
         Let rval = "Unknown_STATE!"
         
      ElseIf code = 12
         Let i = FirstArrayIndex( CDE )
         
         While i <= LastArrayIndex( CDE )
            If FindChars( CDE[i].TerminatorName, name, 1 ) > 0
               ExitScript TrimString( CDE[i].Number )
            EndIf
            
            Let i = i + 1
         EndLoop
         Let rval = "Unknown_CDE!"
         
      ElseIf code = 13
         Let i = FirstArrayIndex( IDE )
         
         While i <= LastArrayIndex( IDE )
            If FindChars( IDE[i].Name, name, 1 ) > 0
               ExitScript TrimString( IDE[i].Number )
            EndIf
            
            Let i = i + 1
         EndLoop
         Let rval = "Unknown_IDE!"
         
      ElseIf code = 14
         Let i = FirstArrayIndex( BDE )
         
         While i <= LastArrayIndex( BDE )
            If FindChars( BDE[i].ThreadNum, name, 1 ) > 0
               ExitScript TrimString( BDE[i].Number )
            EndIf
            
            Let i = i + 1
         EndLoop
         Let rval = "Unknown_BDE!"
         
      ElseIf code = 15
         Let i = FirstArrayIndex( OCT )
         
         While i <= LastArrayIndex( OCT )
            If FindChars( OCT[i].EventDescription, name, 1 ) > 0
               ExitScript TrimString( OCT[i].Number )
            EndIf
            
            Let i = i + 1
         EndLoop
         Let rval = "Unknown_OCT!"
         
      ElseIf code = 16
         Let i = FirstArrayIndex( PDE )
         
         While i <= LastArrayIndex( PDE )
            If FindChars( PDE[i].Name, name, 1 ) > 0
               ExitScript TrimString( PDE[i].Number )
            EndIf
            
            Let i = i + 1
         EndLoop
         Let rval = "Unknown_PDE!"
         
      ElseIf code = 17
         Let i = FirstArrayIndex( Normal )
         
         While i <= LastArrayIndex( Normal )
            If FindChars( Normal[i].ID, name, 1 ) > 0
               ExitScript TrimString( Normal[i].Number )
            EndIf
            
            Let i = i + 1
         EndLoop
         Let rval = "Unknown_NORM!"
         
      ElseIf code = 18
         Let i = FirstArrayIndex( UReq )
         
         While i <= LastArrayIndex( UReq )
            If FindChars( UReq[i].Name, name, 1 ) > 0
               ExitScript TrimString( UReq[i].Number )
            EndIf
            
            Let i = i + 1
         EndLoop
         Let rval = "Unknown_UREQ!"
      Else
         Let rval = "UNKNOWN_ATTRCODE!"
      EndIf
      
      ExitScript rval
      
   EndScript
   Routine "ShowInfoReq"
      ; ---------------------------------------
      ; ShowInfoReq( msg, title ) SubRoutine.
      ; ---------------------------------------
      
      Local ans
      
      Let title = Arg2
      Let ans   = AskForResponse( Arg1, title, "OKAY!" )
      
      ExitScript ans
   EndScript
   Routine "ShowError"
      ; ------------------------------------------
      ; ShowError( msg, buttons ) SubRoutine.
      ; ------------------------------------------
      
      Local title
      Local ans
      
      Let title = "User ERROR:"
      Let ans   = AskForResponse( Arg1, title, Arg2 )
      
      ExitScript ans
   EndScript
   Routine "SetupCST"
      ; --------------------------------
      ; SetupCST() Subroutine.
      ; --------------------------------
      
      Local index
      Local str
      
      WorkWithDocument "CSTable"
      Clear DOCUMENT 
      
      Let index = FirstArrayIndex( CDE )
      
      Type "SYSTEM TITLE:  "
      Type CenterString( CDE[index].SystemTitle, LineLength - 30 ),NEWLINE 
      Type "",NEWLINE 
      Type CenterString( "TERMINATORS:", LineLength ),NEWLINE 
      Type CenterString( "-",LineLength,"-"),NEWLINE 
      
      While index <= LastArrayIndex( CDE )
         
         If Do( "EmptyString", CDE[index].TerminatorName ) = FALSE
            
            Let str = LeftJustify( TrimString( CDE[index].TerminatorName ), LineLength - 55 )
            Type "NAME: "||str||" "
            
            If CDE[index].SourceFlag = TRUE
               Type "TYPE: "||LeftJustify( "SOURCE", 15 )
            ElseIf CDE[index].SinkFlag = TRUE
               Type "TYPE: "||LeftJustify( "SINK",15 )
            Else
               Type "TYPE: "||LeftJustify( "SOURCE & SINK",15 )
            EndIf
            
            Let str = LeftJustify( TrimString( CDE[index].ObjectNums ), LineLength - 60)
            Type "OBJ' #s: "||str,NEWLINE 
            
            Type "",NEWLINE 
            Type LeftJustify( CDE[index].TerminatorDescription, LineLength, " " ),NEWLINE 
            
            ;      Type "",NEWLINE
            Type CenterString( "-",LineLength,"-"),NEWLINE 
            
         EndIf
         
         Let index = index + 1
      EndLoop
      
      Type CenterString( "* END OF CONTEXT SYSTEM TABLE! *",LineLength,"*")
      MoveCursorTo STARTOF DOCUMENT 
      
      
   EndScript
   Routine "SaveProcesses"
      ; ----------------------------------------------
      ; SaveProcesses( filename.Procs ) SubRoutine.
      ; ----------------------------------------------
      
      Local filename
      
      If Do( "EmptyString", Arg1 ) = FALSE
         Let filename = DefaultDBase||".Procs"
      Else
         Let filename = TrimString( Arg1 )
      EndIf
      
      Let C_Proc = FirstArrayIndex( Process )
      Do "DisplayProcess"
      
      While C_Proc <= LastArrayIndex( Process )
         
         Let Process[C_Proc] = GetDBObjects
         
         If Do( "EmptyString", Process[C_Proc].Name ) = FALSE
            SaveVariable Process,filename
         EndIf
         
         Let C_Proc = C_Proc + 1
         Do "DisplayProcess"
      EndLoop
      
      Let C_Proc = FirstArrayIndex( Process )
      Do "DisplayProcess"
   EndScript
   Routine "SaveAssociations"
      ; --------------------------------------------------
      ; SaveAssociations( filename.Assocs ) subroutine.
      ; --------------------------------------------------
      
      Local filename
      
      If Do( "EmptyString", Arg1 ) = TRUE
         Let filename = DefaultDBase||".Assocs"
      Else
         Let filename = TrimString( Arg1 )
      EndIf
      
      Let C_Assoc = FirstArrayIndex( Association )
      Do "DisplayAssociation"
      
      While C_Assoc <= LastArrayIndex( Association )
         Let Association[C_Assoc] = GetDBObjects
         
         If Do( "EmptyString", Association[C_Assoc].Name ) = FALSE
            SaveVariable Association,filename
         EndIf
         
         Let C_Assoc = C_Assoc + 1
         Do "DisplayAssociation"
      EndLoop
      
      Let C_Assoc = FirstArrayIndex( Association )
      Do "DisplayAssociation"
   EndScript
   Routine "SaveBDEs"
      ; ----------------------------------------
      ; SaveBDEs( filename.BDEs ) SubRoutine.
      ; ----------------------------------------
      
      Local filename
      
      If Do( "EmptyString", Arg1 ) = TRUE
         Let filename = DefaultDBase||".BDEs"
      Else
         Let filename = TrimString( Arg1 )
      EndIf
      
      Let C_BDE = FirstArrayIndex( BDE )
      Do "DisplayBDE"
      
      While C_BDE <= LastArrayIndex( BDE )
         Let BDE[C_BDE] = GetDBObjects
         
         If Do( "EmptyString", BDE[C_BDE].Number ) = FALSE
            SaveVariable BDE,filename
         EndIf
         
         Let C_BDE = C_BDE + 1
         Do "DisplayBDE"
      EndLoop
      
      Let C_BDE = FirstArrayIndex( BDE )
      Do "DisplayBDE"
   EndScript
   Routine "SaveCapabilities"
      ; -----------------------------------------------
      ; SaveCapabilities( filename.Caps ) SubRoutine.
      ; -----------------------------------------------
      
      Local filename
      
      If Do( "EmptyString", Arg1 ) = TRUE
         Let filename = DefaultDBase||".Caps"
      Else
         Let filename = TrimString( Arg1 )
      EndIf
      
      Let C_Cap = FirstArrayIndex( Capability )
      Do "DisplayCapability"
      
      While C_Cap <= LastArrayIndex( Capability )
         
         Let Capability[C_Cap] = GetDBObjects
         
         If Do( "EmptyString", Capability[C_Cap].Number ) = FALSE
            SaveVariable Capability,filename
         EndIf
         
         Let C_Cap = C_Cap + 1
         Do "DisplayCapability"
      EndLoop
      
      Let C_Cap = FirstArrayIndex( Capability )
      Do "DisplayCapability"
   EndScript
   Routine "SaveCDEs"
      ; --------------------------------------
      ; SaveCDEs( filename.CDEs ) subroutine.
      ; --------------------------------------
      
      Local filename
      
      If Do( "EmptyString", Arg1 ) = TRUE
         Let filename = DefaultDBase||".CDEs"
      Else
         Let filename = TrimString( Arg1 )
      EndIf
      
      Let C_CDE = FirstArrayIndex( CDE )
      Do "DisplayCDE"
      Delay 0,0,5
      
      
      While C_CDE <= LastArrayIndex( CDE )
         Let CDE[C_CDE] = GetDBObjects
         
         If Do( "EmptyString", CDE[C_CDE].Name ) = FALSE
            SaveVariable CDE,filename
         EndIf
         
         Let C_CDE = C_CDE + 1
         Do "DisplayCDE"
      EndLoop
      
      Let C_CDE = FirstArrayIndex( CDE )
      Do "DisplayCDE"
   EndScript
   Routine "SaveComposites"
      ; -----------------------------------------------
      ; SaveComposites( filename.Comps ) subroutine.
      ; -----------------------------------------------
      
      Local filename
      
      If Do( "EmptyString", Arg1 ) = TRUE
         Let filename = DefaultDBase||".Comps"
      Else
         Let filename = TrimString( Arg1 )
      EndIf
      
      Let C_Comp = FirstArrayIndex( Composite )
      Do "DisplayComposite"
      
      While C_Comp <= LastArrayIndex( Composite )
         Let Composite[C_Comp] = GetDBObjects
         
         If Do( "EmptyString", Composite[C_Comp].Name ) = FALSE
            SaveVariable Composite,filename
         EndIf
         
         Let C_Comp = C_Comp + 1
         Do "DisplayComposite"
      EndLoop
      
      Let C_Comp = FirstArrayIndex( Composite )
      Do "DisplayComposite"
   EndScript
   Routine "SaveIDEs"
      ; ---------------------------------------
      ; SaveIDEs( filename.IDEs ) subroutine.
      ; ---------------------------------------
      
      Local filename
      
      Let filename = TrimString( Arg1 )
      
      SetFileRequestMode SAVEFILEMODE ,REJECTICONS 
      SetFileRequestPattern "#?","#?.IDEs"
      
      Let C_IDE = FirstArrayIndex( IDE )
      Do "DisplayIDE"
      
      If Do( "EmptyString", filename ) = TRUE
         Let filename = AskForFileName( DBasePath, "Save IDEs:",10,16 )
         
         If filename = NOTHING
            ExitScript ; User must have cancelled!
         EndIf
      EndIf
      
      If filename <> NOTHING
         
         If FindChars( filename, ".IDEs", 1 ) > 0
            Let C_IDE = FirstArrayIndex( IDE )
            Do "DisplayIDE"
            
            While C_IDE <= LastArrayIndex( IDE )
               Let IDE[C_IDE] = GetDBObjects
               
               If Do( "EmptyString", IDE[C_IDE].Name ) = FALSE
                  SaveVariable IDE,filename
               EndIf
               
               Let C_IDE = C_IDE + 1
               Do "DisplayIDE"
            EndLoop
         Else
            Let filename = Do( "CorrectFileName", filename, ".IDEs" )
            
            If FindChars( filename, ".IDEs", 1 ) > 0
               Let C_IDE = FirstArrayIndex( IDE )
               Do "DisplayIDE"
               
               While C_IDE <= LastArrayIndex( IDE )
                  Let IDE[C_IDE] = GetDBObjects
                  
                  If Do( "EmptyString", IDE[C_IDE].Name ) = FALSE
                     SaveVariable IDE,filename
                  EndIf
                  
                  Let C_IDE = C_IDE + 1
                  Do "DisplayIDE"
               EndLoop
            EndIf
         EndIf
      EndIf
      
      Let C_IDE = FirstArrayIndex( IDE )
      Do "DisplayIDE"
   EndScript
   Routine "SaveObjects"
      ; -------------------------------------------
      ; SaveObjects( filename.Norms ) SubRoutine.
      ; -------------------------------------------
      
      Local filename
      
      If Do( "EmptyString", Arg1 ) = TRUE
         Let filename = DefaultDBase||".Norms"
      Else
         Let filename = TrimString( Arg1 )
      EndIf
      
      Let C_Norm = FirstArrayIndex( Normal )
      Do "DisplayNormal"
      
      While C_Norm <= LastArrayIndex( Normal )
         Let Normal[C_Norm] = GetDBObjects
         
         If Normal[C_Norm].ID <> NOTHING
            SaveVariable Normal,filename
         EndIf
         
         Do "Check_WriteIDE",C_Norm,Normal[ C_Norm ].ID
         
         Let C_Norm = C_Norm + 1
         Do "DisplayNormal"
      EndLoop
      
      Let C_Norm = FirstArrayIndex( Normal )
      Do "DisplayNormal"
   EndScript
   Routine "SaveOCTs"
      ; ---------------------------------------
      ; SaveOCTs( filename.OCTs ) SubRoutine.
      ; ---------------------------------------
      
      Local filename
      
      If Do( "EmptyString", Arg1 ) = TRUE
         Let filename = DefaultDBase||".OCTs"
      Else
         Let filename = TrimString( Arg1 )
      EndIf
      
      Let C_OCT = FirstArrayIndex( OCT )
      Do "DisplayOCT"
      Delay 0,0,5
      
      While C_OCT <= LastArrayIndex( OCT )
         Let OCT[C_OCT] = GetDBObjects
         
         If Do( "EmptyString", OCT[C_OCT].Name ) = FALSE
            SaveVariable OCT,filename
         EndIf
         
         Let C_OCT = C_OCT + 1
         Do "DisplayOCT"
      EndLoop
      
      Let C_OCT = FirstArrayIndex( OCT )
      Do "DisplayOCT"
   EndScript
   Routine "SavePDEs"
      ; ----------------------------------------
      ; SavePDEs( filename.PDEs ) SubRoutine.
      ; ----------------------------------------
      
      Local filename
      
      If Do( "EmptyString", Arg1 ) = TRUE
         Let filename = DefaultDBase||".PDEs"
      Else
         Let filename = TrimString( Arg1 )
      EndIf
      
      Let C_PDE = FirstArrayIndex( PDE )
      Do "DisplayPDE"
      Delay 0,0,5
      
      While C_PDE <= LastArrayIndex( PDE )
         Let PDE[C_PDE] = GetDBObjects
         
         If Do( "EmptyString", PDE[C_PDE].Name ) = TRUE
            SaveVariable PDE,filename
         EndIf
         
         Let C_PDE = C_PDE + 1
         Do "DisplayPDE"
      EndLoop
      
      Let C_PDE = FirstArrayIndex( PDE )
      Do "DisplayPDE"
   EndScript
   Routine "SaveRequirements"
      ; -----------------------------------------------
      ; SaveRequirements( filename.Reqs ) subroutine.
      ; -----------------------------------------------
      
      Local filename
      
      If Do( "EmptyString", Arg1 ) = FALSE
         Let filename = DefaultDBase||".Reqs"
      Else
         Let filename = TrimString( Arg1 )
      EndIf
      
      Let C_Req = FirstArrayIndex( Requirement )
      Do "DisplayRequirement"
      
      While C_Req <= LastArrayIndex( Requirement )
         Let Requirement[C_Req] = GetDBObjects
         
         If Do( "EmptyString", Requirement[C_Req].Number ) = FALSE
            SaveVariable Requirement,filename
         EndIf
         
         Let C_Req = C_Req + 1
         Do "DisplayRequirement"
      EndLoop
      
      Let C_Req = FirstArrayIndex( Requirement )
      Do "DisplayRequirement"
   EndScript
   Routine "SaveSubTypes"
      ; -------------------------------------------
      ; SaveSubtypes( filename.Subs ) subroutine.
      ; -------------------------------------------
      
      Local filename
      
      If Do( "EmptyString", Arg1 ) = TRUE
         Let filename = DefaultDBase||".Subs"
      Else
         Let filename = TrimString( Arg1 )
      EndIf
      
      Let C_Sub = FirstArrayIndex( Subtype )
      Do "DisplaySubType"
      
      While C_Sub <= LastArrayIndex( Subtype )
         Let Subtype[C_Sub] = GetDBObjects
         
         If Do( "EmptyString", Subtype[C_Sub].Name ) = FALSE
            SaveVariable Subtype,filename
         EndIf
         
         Let C_Sub = C_Sub + 1
         Do "DisplaySubType"
      EndLoop
      
      Let C_Sub = FirstArrayIndex( Subtype )
      Do "DisplaySubType"
   EndScript
   Routine "SaveSuperTypes"
      ; -------------------------------------------
      ; SaveSupers( filename.Supers ) SubRoutine.
      ; -------------------------------------------
      
      Local filename
      
      If Do( "EmptyString", Arg1 ) = TRUE
         Let filename = DefaultDBase||".Supers"
      Else
         Let filename = TrimString( Arg1 )
      EndIf
      
      Let C_Super = FirstArrayIndex( Supertype )
      Do "DisplaySuperType"
      
      While C_Super <= LastArrayIndex( Supertype )
         Let Super[C_Super] = GetDBObjects
         
         If Do( "EmptyString", Supertype[C_Super].Name ) = FALSE
            SaveVariable Supertype,filename
         EndIf
         
         Let C_Super = C_Super + 1
         Do "DisplaySuperType"
      EndLoop
      
      Let C_Super = FirstArrayIndex( Supertype )
      Do "DisplaySuperType"
   EndScript
   Routine "SetupPDE"
      ; ------------------------------
      ; SetupPDE() subroutine.
      ; ------------------------------
      
      Local index
      Local str
      Local safety
      
      WorkWithDocument "PDEntry"
      Clear DOCUMENT 
      
      Let index = FirstArrayIndex( PDE )
      
      Type CenterString( "-",LineLength,"-" ),NEWLINE 
      
      While index <= LastArrayIndex( PDE )
         If Do( "EmptyString", PDE[index].Name ) = FALSE
            
            Type LeftJustify( "PDE #: "||PDE[index].Number,LineLength - 64 )
            Type LeftJustify( " OBJECT: "||PDE[index].ObjectName,LineLength - 40 )
            
            Let str = PDE[index].ActivityNum||" "||PDE[index].ActivityName
            
            Type LeftJustify( " ACTIVITY: "||str, LineLength - 40 ),NEWLINE 
            Type "",NEWLINE 
            
            Let str = PDE[index].ActionNum||" "||PDE[index].ActionName
            
            Type " ACTION: "||str,NEWLINE 
            Type "",NEWLINE 
            
            Type "  PROCESS: "||PDE[index].Name,NEWLINE 
            
            WorkWithDocument "PDEDescList"
            Clear DOCUMENT 
            
            Type PDE[index].Description
            MoveCursorTo STARTOF DOCUMENT 
            
            Let safety = 1
            
            While TheLine <> "" AND safety <= LinesInDocument
               Let str = "   "||TheLine
               
               WorkWithDocument "PDEntry"
               Type LeftJustify( str, LineLength, " " ),NEWLINE 
               
               WorkWithDocument "PDEDescList"
               MoveCursor DOWN 
               
               Let safety = safety + 1
            EndLoop
            
         EndIf
         
         WorkWithDocument "PDEntry"
         
         Let index = index + 1
         
         Type CenterString( "-",LineLength,"-" ),NEWLINE 
         Type "",NEWLINE 
      EndLoop
   EndScript
   Routine "SetupRTM"
      ; ------------------------------------------
      ; SetupRTM() subroutine
      ; ------------------------------------------
      
      Local index
      Local saveindex
      Local start
      Local num
      
      WorkWithDocument "RTMTable"
      Clear DOCUMENT 
      
      Type LeftJustify( "REQ #", LineLength - 68 )||":"
      Type LeftJustify( " REQUIREMENT:",LineLength - 44 )
      Type LeftJustify( " CAP #", LineLength - 67 )||":"
      Type LeftJustify( " CAPABILITY:", LineLength - 45 ),NEWLINE 
      Type CenterString( "-", LineLength, "-" ),NEWLINE 
      
      Let start = FirstArrayIndex( Capability )
      Let index = FirstArrayIndex( Requirement )
      
      While index < 65536
         
         Let saveindex = index
         Let num       = Requirement[index].Number
         
         If index <= LastArrayIndex( Requirement )
            Type LeftJustify( String( num ), LineLength - 68 )||": "
         Else
            Type LeftJustify( "NO REQ!", LineLength - 68 )||": "
         EndIf
         
         ;                        Record,     Data,  Key,        index
         
         Let index = SearchArray( Capability, num, ".REQNUMBER", start )
         
         If NOT SearchFound
            Type LeftJustify( "Capability doesn't have ->"||num||"<-", LineLength - 45 )||" "
            Type LeftJustify( TrimString( Capability[saveindex].Number ), LineLength - 67 )||" "
            Type LeftJustify( TrimString( Capability[saveindex].CString ), LineLength - 45 ),NEWLINE 
         Else
            Type LeftJustify( TrimString( Capability[saveindex].ReqString ), LineLength - 45 )||" "
            Type LeftJustify( TrimString( Capability[saveindex].Number ), LineLength - 67 )||" "
            Type LeftJustify( TrimString( Capability[saveindex].CString ), LineLength - 45 ),NEWLINE 
         EndIf
         
         Let index = saveindex + 1
         
         If Capability[index].CString = "" AND Requirement[index].InObject = ""
            ExitLoop ; Here's our early way out!
         EndIf
         
         Type CenterString( "-", LineLength, "-" ),NEWLINE 
         Type "",NEWLINE 
      EndLoop
      
      Type CenterString( "* END OF REQUIREMENTS TRACEABILITY MATRIX! *", 80, "*" )
      MoveCursorTo STARTOF DOCUMENT 
   EndScript
   Routine "SaveUReqs"
      ; -----------------------------------------
      ; SaveUReqs( filename.UReqs ) SubRoutine.
      ; -----------------------------------------
      
      Local filename
      
      If Do( "EmptyString", Arg1 ) = TRUE
         Let filename = DefaultDBase||".TechNotes"
      Else
         Let filename = TrimString( Arg1 )
      EndIf
      
      If LastArrayIndex( UReq ) < 10
         Let C_UReq = FirstArrayIndex( UReq )
         Do "DisplayUReq"
         
         While C_UReq <= LastArrayIndex( UReq )
            Let UReq[C_UReq] = GetDBObjects
            
            If Do( "EmptyString", UReq[C_UReq].Name ) = FALSE
               SaveVariable UReq,filename
            EndIf
            
            Let C_UReq = C_UReq + 1
            Do "DisplayUReq"
         EndLoop
         
         Let C_UReq = FirstArrayIndex( UReq )
         Do "DisplayUReq"
      Else
         SaveVariable UReq,filename
         Let C_UReq = FirstArrayIndex( UReq )
      EndIf
   EndScript
   Card "TitleCard"
      Routine "GetPicFile"
         ; ------------------------------------
         ; filename = GetPicFile() subroutine
         ; ------------------------------------
         
         Local ans
         Local ttl
         
         Let ttl = "Where's the 'GOOSATitle.iff' file?"
         
         Let ans = AskForFileName( TheCurrentDirectory, ttl, 50, 16 )
         
         ExitScript ans
      EndScript
      Routine "GetIconFileName"
         ; --------------------------------------------
         ; GetIconFileName( filename ) Subroutine
         ; --------------------------------------------
         
         Local msg
         Local ttl
         Local ans
         
         Let ttl = "User ERROR:"
         Let msg = "File name "||Arg1||".info NOT found"||Char(10)
         Let msg = msg||"    Should I find it?"
         
         Let ans = AskForResponse( msg, ttl, "YES!|NO!" )
         
         If ans = 1
            Let ttl = "Find "||Arg1||".info file..."
            Let ans = AskForFileName( TheCurrentDirectory, ttl, 50, 16)
         Else
            Let ans = NOTHING
         EndIf
         
         If FindChars( ans, ".info" , 1 ) > 0
            
            SetWordDelimiters "."
            
            Let ans = GetWord( ans, 1, ".info" )
         EndIf
         
         ; Let d = Do( "ShowError", "File is "||ans, "OKAY" )
         
         ExitScript ans
      EndScript
      Routine "SetupDisplay"
         ; -----------------------------------
         ; SetupDisplay() Subroutine.
         ; -----------------------------------
         
         
      EndScript
      Routine "InitializeProgram"
         ; -------------------------------------
         ; InitializeProgram() Subroutine.
         ; -------------------------------------
         
         Global FileSavedFlag
         
         Let FileSavedFlag = 0
         
         Do "InitStructures"
         Do "LoadDefaultDBase"
         
         SetFileRequestMode REGULARMODE ,PATTERNFIELD 
         
         SetDrawMode NORMAL 
         
         SetPen 1
         SetPrintFont "topaz",8
         SetPrintStyle PLAIN 
         
      EndScript
      Routine "StartProgramBtScript"
         ; --------------------------------------------
         ; StartProgramBtScript() SubRoutine.
         ; --------------------------------------------
         
         Local ttl
         Local ans
         
         Let ttl = "Select/Enter a DataBase to load:"
         
         If NOT Exists( DefaultDBase||".Reqs" ) OR DefaultDBase = NOTHING
            Let ans = AskForFileName( TheCurrentDirectory, ttl, 50, 16 )
            
            If Exists( ans ) AND ans <> NOTHING
               Let ans = GetWord( ans, 1, "." ) ; Strip off extensions
               
               If Exists( "FONTS:Topaz/11")
                  SetPrintFont "Fonts:Topaz",11
               EndIf
               
               SetPrintStyle BOLD ,1,1
               SetDrawMode COMPLEMENT 
               PrintText "DBase       = "||DefaultDBase,8,170
               PrintText "DBasePath   = "||DBasePath,8,181
               
               Let DefaultDBase = ans
               Let DBasePath    = PathOf( ans )
               
               SetPen 2,1
               SetDrawMode JAM1 
               PrintText "DBase       = "||DefaultDBase,8,170
               PrintText "DBasePath   = "||DBasePath,8,181
               
               Do "InitializeProgram"
               GotoCard "Maincard"
               
            Else
               Let ttl = "You did NOT supply a DataBase to load!"||Char(10)
               Let ttl = ttl||DeckName||" might not work correctly,"||Char(10)
               Let ttl = ttl||"  Should I quit (recommended)?"
               
               Let ans = Do( "ShowError", ttl, "QUIT!|CONTINUE" )
               
               If ans = 1
                  Do "InitializeProgram"
                  GotoCard "MainCard"
               Else
                  Quit
               EndIf
            EndIf
            
         EndIf
         
         Do "InitializeProgram"
         GotoCard "MainCard"
      EndScript
      Routine "ParseToolList"
         ; -----------------------------------------
         ; ParseToolList() Subroutine.
         ; -----------------------------------------
         
         Local Cmd1
         
         If Exists( DeckName||".info" )
            LoadIcon DeckName
            MakeDocument "ToolTypesList"
            InsertToolTypeList DeckName
            Let PgmName = DeckName
         Else
            Let PgmName = Do( "GetIconFileName", DeckName )
            
            If Exists( PgmName ) AND PgmName <> NOTHING
               LoadIcon PgmName
               MakeDocument "ToolTypesList"
               InsertToolTypeList PgmName
            Else
               ExitScript ; What a BoneHead user!
            EndIf
         EndIf
         
         Do "Search","RUNAREXX=",1
         If TheLine <> NOTHING
            Let Cmd1 = RemoveChars( TheLine, 1, NumberOfChars( "RunARexx=" ))
            Let Cmd1 = UpperCase( TrimString( Cmd1 ))
            If Cmd1 <> "NO"
               Dos "Run >NIL: "||Cmd1
            EndIf
         EndIf
         
         Do "Search","HELPVIEWER=",1
         If TheLine <> NOTHING
            Let Cmd1 = RemoveChars( TheLine, 1, NumberOfChars( "HelpViewer=" ))
            Let Cmd1 = TrimString( Cmd1 )
            Let HelpViewer = Cmd1
         EndIf
         
         Do "Search","RUNDBASE=",1
         If TheLine <> NOTHING
            Let Cmd1 = RemoveChars( TheLine, 1, NumberOfChars( "RunDBase=" ))
            Let Cmd1 = UpperCase( TrimString( Cmd1 ))
            If Cmd1 <> "NO"
               Dos "Run >NIL: "||Cmd1
            EndIf
         EndIf
         
         Do "Search","STARTUPPATH=",1
         If TheLine <> NOTHING
            Let Cmd1 = RemoveChars( TheLine, 1, NumberOfChars( "StartUpPath=" ))
            Let Cmd1 = TrimString( Cmd1 )
            Let StartupPath = Cmd1
         EndIf
         
         If TheOriginDirectory <> StartupPath AND StartupPath <> NOTHING
            Let AssignDOS = "Assign GOOSA: "||StartupPath
            Dos AssignDOS
         Else
            Dos "Assign GOOSA: DH0:"
         EndIf
         
         SetCurrentDirectory "GOOSA:"
         
         Do "Search","AREXXPORTNAME=",1
         If TheLine <> NOTHING
            Let Cmd1 = RemoveChars( TheLine, 1, NumberOfChars( "ARexxPortName=" ))
            Let Cmd1 = TrimString( Cmd1 )
            
            If Cmd1 <> ""
               Let ARexxPortName = Cmd1
            EndIf
         EndIf
         
         Do "Search","DBASEAREXXPORT=",1
         If TheLine <> NOTHING
            Let Cmd1 = RemoveChars( TheLine, 1, NumberOfChars( "DBaseARexxPort=" ))
            Let Cmd1 = TrimString( Cmd1 )
            
            If Cmd1 <> ""
               Let DBaseARexxPort = Cmd1
            EndIf
         EndIf
         
         Do "Search","HELPPATH=",1
         If TheLine <> NOTHING
            Let Cmd1 = RemoveChars( TheLine, 1, NumberOfChars( "HelpPath=" ))
            Let Cmd1 = TrimString( Cmd1 )
            Let HelpPath = Cmd1
         EndIf
         
         Do "Search","DBASEPATH=",1
         If TheLine <> NOTHING
            Let Cmd1 = RemoveChars( TheLine, 1, NumberOfChars( "DBasePath=" ))
            Let Cmd1 = TrimString( Cmd1 )
            Let DBasePath = Cmd1
         EndIf
         
         Do "Search","DEFAULTDBASE=",1
         If TheLine <> NOTHING
            Let Cmd1 = RemoveChars( TheLine, 1, NumberOfChars( "DefaultDBase=" ))
            Let Cmd1 = TrimString( Cmd1 )
            Let DefaultDBase = DBasePath||Cmd1
         EndIf
         
         Do "Search","REPORTCONFIG=",1
         If TheLine <> NOTHING
            Let Cmd1 = RemoveChars( TheLine, 1, NumberOfChars( "ReportConfig=" ))
            Let Cmd1 = TrimString( Cmd1 )
            Let ReportConfig = Cmd1
         EndIf
         
         Do "Search","TABSIZE=",1
         If TheLine <> NOTHING
            Let Cmd1 = RemoveChars( TheLine, 1, NumberOfChars( "TabSize=" ))
            Let TabSize = Integer( TrimString( Cmd1 ))
         EndIf
         
         Do "Search","PAGESIZE=",1
         If TheLine <> NOTHING
            Let Cmd1 = RemoveChars( TheLine, 1, NumberOfChars( "PageSize=" ))
            Let PageSize = Integer( TrimString( Cmd1 ))
         EndIf
         
         Do "Search","LINELENGTH=",1
         If TheLine <> NOTHING
            Let Cmd1 = RemoveChars( TheLine, 1, NumberOfChars( "LineLength=" ))
            Let LineLength = Integer( TrimString( Cmd1 ))
         EndIf
         
         Do "Search","PRINTERRESET=",1
         If TheLine <> NOTHING
            Let Cmd1 = RemoveChars( TheLine, 1, NumberOfChars( "PrinterReset=" ))
            Let PrinterReset = TrimString( Cmd1 )
         EndIf
         
         Do "Search","NLQOFF=",1
         If TheLine <> NOTHING
            Let Cmd1 = RemoveChars( TheLine, 1, NumberOfChars( "NLQOff=" ))
            Let NLQOFF = TrimString( Cmd1 )
         EndIf
         
         Do "Search","NLQON=",1
         If TheLine <> NOTHING
            Let Cmd1 = RemoveChars( TheLine, 1, NumberOfChars( "NLQOn=" ))
            Let NLQON = TrimString( Cmd1 )
         EndIf
         
         Do "Search","TYPE=",1
         If TheLine <> NOTHING
            Let Cmd1 = RemoveChars( TheLine, 1, NumberOfChars( "Type=" ))
            Let TypeSize = TrimString( Cmd1 )
            
            If FindChars( UpperCase( TypeSize ), "ELITE;", 1 ) <> 0
               Let TypeSize = RemoveChars( TypeSize, 1, 6 )
            EndIf
         EndIf
      EndScript
      Routine "LoadDefaultDBase"
         ; ----------------------------------------------
         ; LoadDefaultDbase() Subroutine.
         ; ----------------------------------------------
         
         ; DefaultDBase won't have any extensions, so this test won't work:
         ; If Exists( DefaultDBase ) AND DefaultDBase <> NOTHING
         
         If NumberOfChars( DefaultDBase ) > 0
            SetDrawMode COMPLEMENT 
            SetPen 2,1
            PrintText "Reading in Default DataBase...",340,110
            
            Do "ReadInAssociations"
            Do "ReadInBDEs"
            Do "ReadInCapabilities"
            Do "ReadInCDEs"
            Do "ReadInComposites"
            Do "ReadInIDEs"
            Do "ReadInNormals"
            Do "ReadInOCTs"
            Do "ReadInPDEs"
            Do "ReadInProcesses"
            Do "ReadInRelations"
            Do "ReadInRequirements"
            Do "ReadInStates"
            Do "ReadInSupers"
            Do "ReadInSubs"
            Do "ReadInUserReqNotes"
            Do "ReadInAttributes"
            
            PrintText "Reading in Default DataBase...",340,110
            Delay 0,0,5
         EndIf
         
         ;SetPen 2
         ;SetDrawMode COMPLEMENT
         ;PrintText "Please wait, creating ISTs!",340,110
         ;Delay 0,1,0
         
         ;Nop ;Do "SetupIST"
         
         ; SetPen 0
         ;PrintText "Please wait, creating ISTs!",340,110
         
         SetPen 1
         SetDrawMode NORMAL 
      EndScript
      Routine "LoadUpISTs"
         ; ---------------------------------------
         ; LoadUpISTs() subroutine
         ; ---------------------------------------
         
         Local o_idx
         
         Do "MakeObjectsArray"
         
         Let o_idx = FirstArrayIndex( Capability )
         
         While Capability[o_idx].CString <> "" AND o_idx <= LastArrayIndex( Capability )
            Do "ParseCapabilityStrings",o_idx
            
            Let o_idx = o_idx + 1
         EndLoop
      EndScript
      Routine "SaveOldColors"
         ; -------------------------------
         ; SaveOldColors SubRoutine.
         ; -------------------------------
         
         Global R[0]
         Global G[0]
         Global B[0]
         
         Local i
         
         Let i = 0
         
         While i <= ScreenColors       ; 16
            GetRGB i,R[i],G[i],B[i]
            Let i = i + 1
         EndLoop
      EndScript
      Routine "SetupProgram"
         ; -------------------------------------------
         ; SetupProgram() Subroutine. GOOSA
         ; -------------------------------------------
         
         Local cmd
         
         ; ToolTypes: --------------------------------------
         
         Global PageSize
         Global LineLength
         Global TabSize
         Global PrinterReset
         Global NLQON
         Global NLQOFF
         Global TypeSize
         Global StartupPath
         Global ARexxPortName
         Global DBaseARexxPort
         Global HelpPath
         Global HelpViewer
         Global DBasePath
         Global DefaultDBase
         Global ReportConfig
         ; -------------------------------------------------
         
         Global DeathCount    ; For running under Supervision only!
         Global PgmName
         Global VersionNumber
         
         Let DeathCount     = 0
         Let PgmName        = DeckName
         Let VersionNumber  = "2.0"
         
         ; Setup ToolTypes: --------------------------------
         
         Let StartupPath    = TheOriginDirectory
         Let DBaseARexxPort = "GoosaDBase"
         Let HelpViewer     = "MultiView"
         Let PageSize       = 66
         Let LineLength     = 80
         Let TabSize        = 3
         Let PrinterReset   = "^@"
         Let NLQON          = "^x1"
         Let NLQOFF         = "^x0"
         Let TypeSize       = "ELITE;^M"
         Let LastObjNumber  = 0 ;might not be needed!!
         
         Do "ParseToolList"
         ; -------------------------------------------------
         
         MakeDocument "StateList"
         MakeDocument "TransitionList"
         
         Do "SaveOldColors"
         
         ; Formerly in SetupDisplay(): ---------------------
         
         SetPen 0
         AreaRectangle 4,2,632,281 ; Erase any old display stuff
         
         
         Do "DisplayTitle"
         
         Do "SetupColors"
         ; -------------------------------------------------
         
         If Exists( "FONTS:Topaz/11" )
            SetPrintFont "Fonts:Topaz",11
         EndIf
         
         SetPrintStyle BOLD ,1,1
         
         ; SetPen 3; BLUE1!
         PrintText "StartupPath = "||StartupPath,8,159
         PrintText "DBase       = "||DefaultDBase,8,170
         PrintText "DBasePath   = "||DBasePath,8,181
         PrintText "PageSize    = "||PageSize,8,192
         PrintText "LineLength  = "||LineLength,8,203
         
         If ARexxPortName <> NOTHING
            ListenTo ARexxPortName
            SpeakTo ARexxPortName
         EndIf
         
      EndScript
      AfterAttachment
         ; Do "SetupDisplay"
         Do "SetupProgram"
      EndScript
      Routine "DisplayTitle"
         ; ----------------------------
         ; Displaytitle()
         ; ----------------------------
         
         Local picfile
         
         Let picfile = TheCurrentDirectory||"GOOSATitle.iff"
         
         If Exists( picfile ) AND picfile <> NOTHING
            LoadBrush picfile,"TitleScreen"
            ShowBrush "TitleScreen",0,0 ; ,BRUSHPALETTE
         Else
            Let picfile = Do( "GetPicFile" )
            
            If Exists( picfile ) AND picfile <> NOTHING
               LoadBrush picfile,"TitleScreen"
               ShowBrush "TitleScreen",0,0 ; ,BRUSHPALETTE
               
               SetCurrentDirectory PathOf( picfile )
            Else
               SetPrintFont "Fonts:Topaz",11
               SetPrintStyle BOLD ,1,1
               SetPen 2,1
               
               PrintText "START!",402,136
               Do "DrawRaisedBox",390,130,80,25
               PrintText "Press & release the 'START!' button...",99,259
               
               Do "DrawRaisedBox",486,130,59,25
               PrintText "HELP",493,136
            EndIf
         EndIf
         
         If Exists( "FONTS:Times/24" )
            SetPrintFont "Fonts:Times",24
         EndIf
         
         SetPrintStyle BOLD SHADOW ,1,1
         SetPen 2,1
         PrintText "Version:  "||VersionNumber,459,16
         
      EndScript
      Window "UserWindow"
         Definition
            Origin 0,32
            WindowLimits 250,15,640,200
            Size 640,285
            WindowFlags ACTIVATE TOFRONT WORKBENCH 
            VisualEffects NONE ,WAIT 
         EndScript
         OnActivated
            ; Do "SetupDisplay"
            
         EndScript
      EndObj
      AreaButton "StartButton"
         Definition
            Origin 390,131
            Size 80,24
         EndScript
         OnRelease
            Do "StartProgramBtScript"
            
         EndScript
      EndObj
      AKey "TitleHelpKey"
         Definition
            QualifiersPressed NONE 
            KeyPressed HELP 
         EndScript
         OnUp
            Dos HelpViewer|||HelpPath||"GOOSA.guide TitleCard"
            
         EndScript
      EndObj
      TextMenu "MI"
         Definition
            AttachTo MENU ,"USER INSTRUCTIONS"
            Text "Press the 'Start!' Button."
            Highlight NONE 
            Font "Times",24
            Style PLAIN ,2,1
            TextColors 7,252,JAM1 
         EndScript
      EndObj
      ErrorTrap "UserError_1"
         Occurred
            Do "HandleInternalError"
            
         EndScript
      EndObj
      AreaButton "HelpButton"
         Definition
            Origin 486,130
            Size 59,24
         EndScript
         OnRelease
            Let d = AskForHelp( HelpPath||"GOOSA.guide", "Main" )
            
         EndScript
      EndObj
   EndObj
   Card "MainCard"
      NoAttach
      Routine "SetupStateList"
         Local index      ;SetupStateList Script.
         SetPen 4
         PrintText "Setting up State List...",290,170
         If FirstState = 0
            Let FirstState = 1
         EndIf
         WorkWithDocument "StateList"
         Clear DOCUMENT 
         Let index = FirstState
         While index <= LastState
            Type State[index].Name,NEWLINE 
            Let index = index + 1
         EndLoop
         SetPen 0
         PrintText "Setting up State List...",290,170
         SetPen 4
         PrintText "Setting up Transition List...",290,170
         WorkWithDocument "TransitionList"
         Clear DOCUMENT 
         Let index = FirstState
         While index <= LastState
            Type index||" : "||State[index].Name
            Type " : "||State[index].TriggerEvent
            Type " : "||State[index].Action
            Type " : "||State[index].NextState,NEWLINE 
            Let index = index + 1
         EndLoop
         SetPen 0
         PrintText "Setting up Transition List...",290,170
      EndScript
      Routine "ReadInObjects"
         Local index
         Local LastRec
         Do "Send_Check","OpenDBase "||DefaultDBase
         Do "Send_Check","GetDBaseInfo"
         Let LastRec = Integer( MessageReturned )
         Let index   = 1
         While index <= LastRec
            Do "Send_Check","GetRecord "||index
            Do "Send_Check","ReadField AttribCode"
            If MessageReturned = 17
               Do "AddToObjectList"
            EndIf
            Let index = index + 1
         EndLoop
         Let GotObjs = TRUE
         Do "Send_Check","CloseDBase "||DefaultDBase
      EndScript
      Routine "ReadInAttributes"
         Local index
         Local LastRec
         Do "Send_Check","OpenDBase "||DefaultDBase
         Do "Send_Check","GetDBaseInfo"
         Let LastRec = Integer( MessageReturned )
         Let index   = 1
         While index <= LastRec
            Do "Send_Check","GetRecord "||index
            Do "Send_Check","ReadField AttribCode"
            If MessageReturned = 6
               Do "AddAttribute"
            EndIf
            Let index = index + 1
         EndLoop
         Let GotAttrs = TRUE
         Do "Send_Check","CloseDBase "||DefaultDBase
      EndScript
      Routine "MakeObjectList"
         Local index
         Local lastobj
         Let lastobj = NumberOfArrayEntries( ObjectArray )
         Let index = 0
         WorkWithDocument "ObjectList"
         Clear DOCUMENT 
         While ObjectArray[index].ID <> "" AND index < lastobj
            Type LeftJustify( String(index + 1), 4)||": "
            Type LeftJustify( ObjectArray[index].ID, 20 )||" TYPE: "
            Type ObjectArray[index].Type,NEWLINE 
            Let index = index + 1
         EndLoop
      EndScript
      Routine "SaveAll"
         Nop   ;SaveAll SubRoutine.
      EndScript
      Routine "SanityCheck"
         ; -------------------------------------
         ; SanityCheck() Function.
         ; -------------------------------------
         
         Local answer
         Local ttl
         Local msg
         Local cr
         
         Let cr  = Char( 10 )
         Let ttl = "User SANITY CHECK:"
         
         Let msg = "Are you SURE that you're done with "||PgmName||"?"
         
         Let answer = AskForResponse( msg, ttl, "YES|NO!" )
         
         ExitScript answer
         
      EndScript
      Routine "QuitCheck"
         ; ------------------------------------
         ; QuitCheck() Subroutine.
         ; ------------------------------------
         
         Local answer
         
         Let answer = 0
         
         Let answer = Do( "SanityCheck" )
         
         If answer = 1
            If FileSavedFlag = 1
               Do "RestoreOldColors"
               
               Quit
            Else
               Do "SaveAll",DefaultDBase,WTTL[0]
               
               Nop ;Do "Send_Check","KillDataManager"
               
               Do "RestoreOldColors"
               Quit
            EndIf
         EndIf
      EndScript
      Routine "MainLoadDataBase"
         ; -----------------------------------
         ; MainLoadDataBase() SubRoutine.
         ; -----------------------------------
         
         SetFileRequestMode REGULARMODE ,PATTERNFIELD 
         
         SetFileRequestPattern "#?","#?","#?.info"
         
         Let filename = AskForFileName( StartupPath, "Load a DataBase File...",10,12 )
         
         If Exists( filename ) AND filename <> NOTHING
            
            If FindChars( filename, ".", 1 ) > 0
               ; Remove any extensions to the filename:
               Let filename = GetWord( filename, 1, "." )
            EndIf
            
            Let d = AskForResponse( "Database is "||filename, "User INFORMATION:", "OKAY!" )
            
            Let DefaultDBase = filename
            
            DisposeAll               ;Throw out previous environment!
            
            Do "InitStructures"
            
            Do "ReadInAll",DefaultDBase,WTTL[0]
            
            Let FileSavedFlag = 0
         Else
            Let d = AskForResponse( "File "||filename||" does NOT exist!", "User ERROR:", "Aaarrgghh!!")
         EndIf
         
      EndScript
      Routine "SaveNewDBase"
         ; --------------------------------------
         ; SaveNewDBase( filename ) Subroutine.
         ; --------------------------------------
         
         If Exists( Arg1 ) AND Arg1 <> NOTHING
         Else
            If Arg1 <> NOTHING
               SaveVariable Association,Arg1||".Assocs"
               SaveVariable Attribute,Arg1||".Attrs"
               SaveVariable BDE,Arg1||".BDEs"
               SaveVariable CDE,Arg1||".CDEs"
               SaveVariable Capability,Arg1||".Caps"
               SaveVariable Composite,Arg1||".Comps"
               SaveVariable IDE,Arg1||".IDEs"
               SaveVariable IST,Arg1||".ISTs"
               SaveVariable Normal,Arg1||".Norms"
               SaveVariable OCT,Arg1||".OCTs"
               SaveVariable PDE,Arg1||".PDEs"
               SaveVariable Process,Arg1||".Procs"
               SaveVariable Relation,Arg1||".Rels"
               SaveVariable Requirement,Arg1||".Reqs"
               SaveVariable State,Arg1||".States"
               SaveVariable Subtype,Arg1||".Subs"
               SaveVariable Supertype,Arg1||".Supers"
               SaveVariable UReq,Arg1||".UReqs"
            EndIf
         EndIf
      EndScript
      Routine "MainSaveAsScript"
         ; ------------------------------------
         ; MainSaveAsScript() SubRoutine.
         ; ------------------------------------
         
         Local filename
         Local ttl
         Local msg
         
         SetFileRequestMode SAVEFILEMODE ,REJECTICONS PATTERNFIELD 
         
         SetFileRequestPattern "#?","#?" ;, "#?.#?"
         
         Let filename = AskForFileName( StartupPath, "Save File as...", 10, 12 )
         
         If FindChars( filename, ".", 1 ) > 0
            
            Let ttl = "User input ERROR:"
            Let msg = "Filename "||filename||Char(10)||Char(10)
            Let msg = msg||" has a period (.) in it.  Everything after"||Char(10)
            Let msg = msg||"the period & the period will be removed."||Char(10)
            Let msg = msg||"Is this okay?"
            
            Let ans = AskForResponse( msg, ttl, "YES|NO!" )
            
            If ans = 1
               Let filename = GetWord( filename, 1, "." )
            Else
               Let ans = AskForResponse( "DataBase NOT saved!", "User Information:","OKAY" )
               SetFileRequestMode REGULARMODE ,PATTERNFIELD 
               ExitScript
            EndIf
         EndIf
         
         If filename <> NOTHING
            Do "SaveNewDBase",filename
         Else
            Do "SaveNewDBase",DefaultDBase
         EndIf
         
         SetFileRequestMode REGULARMODE ,PATTERNFIELD 
      EndScript
      BeforeAttachment
         Let ObjectNumber = 0   ;set up counter variables
         Let AttribNumber = 0
         Let EventNumber  = 0
         
         Let TransitionNumber = 0
      EndScript
      AfterAttachment
         SetWindowTitle WTTL[0]
         
         Do "SetUpColors"
         
         Let SaveThisObject     = ""
         Let SaveThisCompObject = ""
         
         If Supervised = FALSE
            DisableObject "STDGadget"
            DisableObject "PFDGadget"
            DisableObject "OCDGadget"
         EndIf
      EndScript
      Window "UserWindow"
         Definition
            Origin 40,16
            Title "  G.O.O.S.A. ----    Object-Oriented System Analysis & Design"
            WindowObjects DEPTHBUTTONS DRAGBAR 
            WindowLimits 250,15,640,200
            WindowZoom 0,16,250,15
            Size 540,330
            WindowFlags ACTIVATE TOFRONT WORKBENCH 
            VisualEffects NONE ,WAIT 
         EndScript
         OnCloseButton
            Nop ;Do "SanityCheck","Are you sure you want to quit?"
            If answer = TRUE
               If FileSavedFlag = 0
                  Do "SaveAll",DefaultDBase
               EndIf
               Quit
            EndIf
         EndScript
         OnActivated
            Do "SetUpColors"
            
            DisableObject "STDGadget"
            DisableObject "PFDGadget"
            DisableObject "OCDGadget"
            
         EndScript
         OnResized
            Do "SetUpColors"
            DisableObject "STDGadget"
            DisableObject "PFDGadget"
            DisableObject "OCDGadget"
            
         EndScript
      EndObj
      AreaButton "IDEGadget"
         Definition
            Origin 8,18
            Border BEVEL 
            Text " Information Descriptive Entry "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 7,0,JAM1 
            Size 252,12
         EndScript
         OnRelease
            ;Let GotIDEs = FALSE
            
            GotoCard "IDECard"
            
         EndScript
      EndObj
      AreaButton "ISDGadget"
         Definition
            Origin 8,36
            Border BEVEL 
            Text " Information Structure Diagram "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 7,0,JAM1 
            Size 252,12
         EndScript
         OnRelease
            GotoCard "ISDCard"
         EndScript
      EndObj
      AreaButton "ISTGadget"
         Definition
            Origin 8,54
            Border BEVEL 
            Text "  Information Structure Table  "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 7,0,JAM1 
            Size 252,12
         EndScript
         OnRelease
            GotoCard "ISTCard"
         EndScript
      EndObj
      AreaButton "CDEGadget"
         Definition
            Origin 9,82
            Border BEVEL 
            Text " Context     Descriptive Entry "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 5,0,JAM1 
            Size 252,12
         EndScript
         OnRelease
            ;Let GotCDEs = FALSE
            
            GotoCard "CDECard"
            
         EndScript
      EndObj
      AreaButton "CSDGadget"
         Definition
            Origin 9,100
            Border BEVEL 
            Text " Context     System   Diagram  "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 5,0,JAM1 
            Size 252,12
         EndScript
         OnRelease
            GotoCard "CSDCard"
         EndScript
      EndObj
      AreaButton "CSTGadget"
         Definition
            Origin 9,118
            Border BEVEL 
            Text " Context     System   Table    "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 5,0,JAM1 
            Size 252,12
         EndScript
         OnRelease
            GotoCard "CSTCard"
         EndScript
      EndObj
      AreaButton "RTMGadget"
         Definition
            Origin 9,199
            Border BEVEL 
            Text " Requirements Traceability Matrix "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 7,0,JAM1 
            Size 276,12
         EndScript
         OnRelease
            ;Let GotReqs = FALSE
            GotoCard "RTMCard"
            
         EndScript
      EndObj
      AreaButton "OCDGadget"
         Definition
            Origin 272,18
            Border BEVEL 
            Text " Object Communication Diagram "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 13,0,JAM1 
            Size 244,12
         EndScript
         OnRelease
            GotoCard "OCDCard"
         EndScript
      EndObj
      AreaButton "OCTGadget"
         Definition
            Origin 272,36
            Border BEVEL 
            Text " Object Communication Table   "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 13,0,JAM1 
            Size 244,12
         EndScript
         OnRelease
            ;Let GotOCTs = FALSE
            
            GotoCard "OCTCard"
            
         EndScript
      EndObj
      AreaButton "STDGadget"
         Definition
            Origin 272,82
            Border BEVEL 
            Text "  State Transition Diagram    "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 12,0,JAM1 
            Size 244,12
         EndScript
         OnRelease
            GotoCard "STDCard"
         EndScript
      EndObj
      AreaButton "STTGadget"
         Definition
            Origin 272,100
            Border BEVEL 
            Text "  State Transition Table      "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 12,0,JAM1 
            Size 244,12
         EndScript
         OnRelease
            ;Let GotStates = FALSE
            
            GotoCard "STTCard"
            
         EndScript
      EndObj
      AreaButton "BDEGadget"
         Definition
            Origin 273,223
            Border BEVEL 
            Text "  Behavior Descriptive Entry  "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 7,0,JAM1 
            Size 244,12
         EndScript
         OnRelease
            ;Let GotBDEs = FALSE
            
            GotoCard "BDECard"
            
         EndScript
      EndObj
      AreaButton "PFDGadget"
         Definition
            Origin 272,140
            Border BEVEL 
            Text "  Process  Flow    Diagram    "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 2,0,JAM1 
            Size 244,12
         EndScript
         OnRelease
            GotoCard "PFDCard"
         EndScript
      EndObj
      AreaButton "PDEGadget"
         Definition
            Origin 272,159
            Border BEVEL 
            Text "  Process  Descriptive Entry  "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 2,0,JAM1 
            Size 244,12
         EndScript
         OnRelease
            ;Let GotPDEs = FALSE
            
            GotoCard "PDECard"
            
         EndScript
      EndObj
      AreaButton "SysCapGadget"
         Definition
            Origin 9,159
            Border BEVEL 
            Text " System  Capabilities "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 7,0,JAM1 
            Size 180,12
         EndScript
         OnRelease
            ;Let GotCaps = FALSE
            
            GotoCard "SysCapsCard"
            
         EndScript
      EndObj
      AreaButton "UserReqsGadget"
         Definition
            Origin 9,178
            Border BEVEL 
            Text " User    Requirements "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 7,0,JAM1 
            Size 180,12
         EndScript
         OnRelease
            ;Let GotUReqs = FALSE
            
            GotoCard "UserReqsCard"
            
         EndScript
      EndObj
      TextMenu "Load"
         Definition
            AttachTo MENU ,"PROJECT    "
            Text "Load a DataBase..."
            ShortCutKey "L"
         EndScript
         Occurred
            Do "MainLoadDataBase"
            
         EndScript
      EndObj
      TextMenu "Save"
         Definition
            AttachTo MENU ,"PROJECT    "
            Text "Save"
            ShortCutKey "S"
         EndScript
         Occurred
            Do "SaveAll",DefaultDBase,WTTL[0]
            
         EndScript
      EndObj
      TextMenu "Save As"
         Definition
            AttachTo MENU ,"PROJECT    "
            Text "Save As..."
            ShortCutKey "A"
         EndScript
         Occurred
            Do "MainSaveAsScript"
            
         EndScript
      EndObj
      TextMenu "DataBase"
         Definition
            AttachTo MENU ,"PROJECT    "
            Text "DataBase..."
         EndScript
         Occurred
            GotoCard "RecordKeeper"
         EndScript
      EndObj
      TextMenu "Print"
         Definition
            AttachTo MENU ,"PROJECT    "
            Text "Print "
         EndScript
      EndObj
      TextMenu "Quit"
         Definition
            AttachTo MENU ,"PROJECT    "
            Text "Quit"
            ShortCutKey "Q"
         EndScript
         Occurred
            Do "QuitCheck"
            
         EndScript
      EndObj
      TextMenu "Edit_CDE"
         Definition
            AttachTo MENU ,"EDITORS"
            Text "Edit  CDE...  "
            ShortCutKey "C"
         EndScript
         Occurred
            Do "ReadInCDEs",DefaultDBase||".CDEs"
            
            GotoCard "EditCDE"
            
         EndScript
      EndObj
      TextMenu "Edit_IDE"
         Definition
            AttachTo MENU ,"EDITORS"
            Text "Edit  IDE...   "
            ShortCutKey "I"
         EndScript
         Occurred
            Do "ReadInIDEs",DefaultDBase||".IDEs"
            
            GotoCard "EditIDE"
            
         EndScript
      EndObj
      TextMenu "Edit_UR"
         Definition
            AttachTo MENU ,"EDITORS"
            Text "Edit User Req'..."
            ShortCutKey "U"
         EndScript
         Occurred
            Do "ReadInRequirements",DefaultDBase||".Reqs"
            
            GotoCard "EditUserReq"
            
         EndScript
      EndObj
      AreaButton "TechNotesGadget"
         Definition
            Origin 9,140
            Border BEVEL 
            Text " Technical      Notes "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 8,0,JAM1 
            Size 180,12
         EndScript
         OnRelease
            GotoCard "UserReqNotesCard"
         EndScript
      EndObj
      AreaButton "ProcGadget"
         Definition
            Origin 272,178
            Border BEVEL 
            Text "            Process           "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 2,0,JAM1 
            Size 244,12
         EndScript
         OnRelease
            ;Let GotProcs = FALSE
            
            GotoCard "ProcessCard"
            
         EndScript
      EndObj
      AreaButton "ObjectGadget"
         Definition
            Origin 326,248
            Border BEVEL 
            Text "Object      Editor"
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 12,0,JAM1 
            Size 148,12
         EndScript
         OnRelease
            ;Let GotNorms = FALSE
            ;Let GotAttrs = FALSE
            
            GotoCard "EditNormalObject"
            
         EndScript
      EndObj
      TextMenu "Edit_BDE"
         Definition
            AttachTo MENU ,"EDITORS"
            Text "Edit Behavior..."
            ShortCutKey "B"
         EndScript
         Occurred
            Do "ReadInBDEs",DefaultDBase||".BDEs"
            
            GotoCard "EditBDE"
            
         EndScript
      EndObj
      TextMenu "Edit_PDE"
         Definition
            AttachTo MENU ,"EDITORS"
            Text "Edit  PDE..."
            ShortCutKey "R"
         EndScript
         Occurred
            Do "ReadInPDEs",DefaultDBase||".PDEs"
            
            GotoCard "EditPDE"
            
         EndScript
      EndObj
      AKey "HelpKey"
         Definition
            QualifiersPressed NONE 
            KeyPressed HELP 
         EndScript
         OnUp
            Let d = AskForHelp( HelpPath||"GOOSA.guide", "MainCard" )
            
         EndScript
      EndObj
      TextMenu "ToolTypesEditor"
         Definition
            AttachTo MENU ,"BEHAVIOR"
            Text "Edit Tool Types..."
         EndScript
         Occurred
            GotoCard "EditToolTypes"
         EndScript
      EndObj
      TextMenu "ToFile"
         Definition
            AttachTo OBJECT ,"Print"
            Text "To File!"
            ShortCutKey "F"
         EndScript
         Occurred
            Do "PrintAllToFile",DefaultDBase,WTTL[0]
         EndScript
      EndObj
      TextMenu "ToPAR"
         Definition
            AttachTo OBJECT ,"Print"
            Text "To Parallel (printer) port (PAR)!"
            ShortCutKey "P"
         EndScript
         Occurred
            Do "PrintAllToParallel",DefaultDBase,WTTL[0]
         EndScript
      EndObj
      TextMenu "ToSER"
         Definition
            AttachTo OBJECT ,"Print"
            Text "To Serial (printer) port (SER)!"
         EndScript
         Occurred
            Do "PrintAllToSerial",DefaultDBase,WTTL[0]
         EndScript
      EndObj
      AreaButton "AssocGadget"
         Definition
            Origin 326,267
            Border BEVEL 
            Text "Association Editor"
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 12,0,JAM1 
            Size 148,12
         EndScript
         OnRelease
            ;Let GotAssocs = FALSE
            
            GotoCard "EditObjectAssoc"
            
         EndScript
      EndObj
      AreaButton "RelationGadget"
         Definition
            Origin 169,248
            Border BEVEL 
            Text "Relation    Editor"
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 12,0,JAM1 
            Size 148,12
         EndScript
         OnRelease
            ;Let GotRels = FALSE
            
            GotoCard "EditRelation"
            
         EndScript
      EndObj
      AreaButton "CompositeGadget"
         Definition
            Origin 169,267
            Border BEVEL 
            Text "Composite   Editor"
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 12,0,JAM1 
            Size 148,12
         EndScript
         OnRelease
            ;Let GotComps = FALSE
            
            GotoCard "EditComposite"
            
         EndScript
      EndObj
      AreaButton "SuperGadget"
         Definition
            Origin 169,286
            Border BEVEL 
            Text "SuperType   Editor"
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 12,0,JAM1 
            Size 148,12
         EndScript
         OnRelease
            ;Let GotSupers = FALSE
            
            GotoCard "EditSuper"
            
         EndScript
      EndObj
      AreaButton "SubGadget"
         Definition
            Origin 169,305
            Border BEVEL 
            Text "SubType     Editor"
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 12,0,JAM1 
            Size 148,12
         EndScript
         OnRelease
            ;Let GotSubs = FALSE
            
            GotoCard "EditSub"
            
         EndScript
      EndObj
      AreaButton "AttributeGadget"
         Definition
            Origin 326,286
            Border BEVEL 
            Text "Attribute   Editor"
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 12,0,JAM1 
            Size 148,12
         EndScript
         OnRelease
            ;Let GotAttrs = FALSE
            
            GotoCard "EditAttributes"
            
         EndScript
      EndObj
      AreaButton "ReportMaker"
         Definition
            Origin 9,219
            Border BEVEL 
            Text " Make a Report "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 8,0,JAM1 
            Size 124,12
         EndScript
         OnRelease
            GotoCard "ReportMakerCard"
         EndScript
      EndObj
      AKey "ARexxCard"
         Definition
            QualifiersPressed RIGHTAMIGA 
            KeyPressed X 
         EndScript
         OnUp
            GotoCard "ARexxInterface","MainCard"
            
         EndScript
      EndObj
      ErrorTrap "UserError_1"
         Occurred
            Do "HandleInternalError"
         EndScript
      EndObj
   EndObj
   Card "RecordKeeper"
      NoAttach
      Routine "CloseDBase"
         Do "SendDBaseCommand","Close"
      EndScript
      Routine "SendDBaseCommand"
         ; ------------------------------------------------
         ; SendDBaseCommand( commandstring ) SubRoutine.
         ; ------------------------------------------------
         
         Local cmd
         
         Let cmd = TrimString( Arg1 )
         
         SpeakTo DBaseARexxPort
         
         IfError
            Do "HandleARexxError",1
         EndIf
         
         ListenTo DBaseARexxPort
         
         IfError
            Do "HandleARexxError",2
         EndIf
         
         SendMessage cmd
         
         IfError
            Do "HandleARexxError",3
         EndIf
      EndScript
      Routine "KillDBaseManager"
         ; ---------------------------------
         ; KillDBaseManager() SubRoutine.
         ; ---------------------------------
         
         Do "SendDBaseCommand","KillDBaseManager"
         
         SpeakTo "AREXX"
         ListenTo "AREXX"
      EndScript
      Routine "CreateDBase"
         ; -------------------------------
         ; CreateDBase() Subroutine.
         ; -------------------------------
         
         Local filename
         Let filename = TrimString( TextFrom( "FileName" ))
         
         If filename = ""
            Let filename = AskForFileName( TheCurrentDirectory, "Enter File to Create...",50,16)
            
            If filename = ""
               ExitScript
            EndIf
            
            SetText "Filename",filename
         EndIf
         
         If NOT Exists( filename )
            Do "SendDBaseCommand","CREATE"|||filename
            SetText "Filename",filename
         EndIf
      EndScript
      Routine "GetFirstInternalRecord"
         ; ---------------------------------------
         ; GetFirstInternalRecord() SubRoutine.
         ; ---------------------------------------
         
         Let rindex = 0
         
         If aindex = 0   ;Requirement type of record.
            Let rindex = FirstArrayIndex( Requirement )
         ElseIf aindex = 1
            Let rindex = FirstArrayIndex( Capability )
         ElseIf aindex = 2
            Let rindex = FirstArrayIndex( SuperType )
         ElseIf aindex = 3
            Let rindex = FirstArrayIndex( SubType )
         ElseIf aindex = 4   ;Unused type of record.
            Let rindex = 0
         ElseIf aindex = 5
            Let rindex = FirstArrayIndex( Attribute )
         ElseIf aindex = 6
            Let rindex = FirstArrayIndex( Relation )
         ElseIf aindex = 7
            Let rindex = FirstArrayIndex( Association )
         ElseIf aindex = 8
            Let rindex = FirstArrayIndex( Composite )
         ElseIf aindex = 9
            Let rindex = FirstArrayIndex( Process )
         ElseIf aindex = 10
            Let rindex = FirstArrayIndex( State )
         ElseIf aindex = 11
            Let rindex = FirstArrayIndex( CDE )
         ElseIf aindex = 12
            Let rindex = FirstArrayIndex( IDE )
         ElseIf aindex = 13
            Let rindex = FirstArrayIndex( BDE )
         ElseIf aindex = 14
            Let rindex = FirstArrayIndex( OCT )
         ElseIf aindex = 15
            Let rindex = FirstArrayIndex( PDE )
         ElseIf aindex = 16
            Let rindex = FirstArrayIndex( Normal )
         ElseIf aindex = 17
            Let rindex = FirstArrayIndex( UReq )
         EndIf
         
         Do "DisplayInternalRecord",rindex
      EndScript
      Routine "GetLastInternalRecord"
         ; ----------------------------------------
         ; GetLastInternalRecord() SubRoutine.
         ; ----------------------------------------
         
         Let rindex = 0
         
         If aindex = 0   ;Requirement type of record.
            Let rindex = LastArrayIndex( Requirement )
         ElseIf aindex = 1
            Let rindex = LastArrayIndex( Capability )
         ElseIf aindex = 2
            Let rindex = LastArrayIndex( SuperType )
         ElseIf aindex = 3
            Let rindex = LastArrayIndex( SubType )
         ElseIf aindex = 4   ;Unused type of record.
            Let rindex = 0
         ElseIf aindex = 5
            Let rindex = LastArrayIndex( Attribute )
         ElseIf aindex = 6
            Let rindex = LastArrayIndex( Relation )
         ElseIf aindex = 7
            Let rindex = LastArrayIndex( Association )
         ElseIf aindex = 8
            Let rindex = LastArrayIndex( Composite )
         ElseIf aindex = 9
            Let rindex = LastArrayIndex( Process )
         ElseIf aindex = 10
            Let rindex = LastArrayIndex( State )
         ElseIf aindex = 11
            Let rindex = LastArrayIndex( CDE )
         ElseIf aindex = 12
            Let rindex = LastArrayIndex( IDE )
         ElseIf aindex = 13
            Let rindex = LastArrayIndex( BDE )
         ElseIf aindex = 14
            Let rindex = LastArrayIndex( OCT )
         ElseIf aindex = 15
            Let rindex = LastArrayIndex( PDE )
         ElseIf aindex = 16
            Let rindex = LastArrayIndex( Normal )
         ElseIf aindex = 17
            Let rindex = LastArrayIndex( UReq )
         EndIf
         
         Do "DisplayInternalRecord",rindex
      EndScript
      Routine "GetPrevInternalRecord"
         ; ---------------------------------------
         ; GetPrevInternalRecord() SubRoutine.
         ; ---------------------------------------
         
         If aindex = 0   ;Requirement type of record.
            Let rindex = PreviousArrayIndex( Requirement, rindex )
         ElseIf aindex = 1
            Let rindex = PreviousArrayIndex( Capability, rindex )
         ElseIf aindex = 2
            Let rindex = PreviousArrayIndex( SuperType, rindex )
         ElseIf aindex = 3
            Let rindex = PreviousArrayIndex( SubType, rindex )
         ElseIf aindex = 4   ;Unused type of record.
            Let rindex = 0
         ElseIf aindex = 5
            Let rindex = PreviousArrayIndex( Attribute, rindex )
         ElseIf aindex = 6
            Let rindex = PreviousArrayIndex( Relation, rindex )
         ElseIf aindex = 7
            Let rindex = PreviousArrayIndex( Association, rindex )
         ElseIf aindex = 8
            Let rindex = PreviousArrayIndex( Composite, rindex )
         ElseIf aindex = 9
            Let rindex = PreviousArrayIndex( Process, rindex )
         ElseIf aindex = 10
            Let rindex = PreviousArrayIndex( State, rindex )
         ElseIf aindex = 11
            Let rindex = PreviousArrayIndex( CDE, rindex )
         ElseIf aindex = 12
            Let rindex = PreviousArrayIndex( IDE, rindex )
         ElseIf aindex = 13
            Let rindex = PreviousArrayIndex( BDE, rindex )
         ElseIf aindex = 14
            Let rindex = PreviousArrayIndex( OCT, rindex )
         ElseIf aindex = 15
            Let rindex = PreviousArrayIndex( PDE, rindex )
         ElseIf aindex = 16
            Let rindex = PreviousArrayIndex( Normal, rindex )
         ElseIf aindex = 17
            Let rindex = PreviousArrayIndex( UReq, rindex )
         EndIf
         
         Do "DisplayInternalRecord",rindex
      EndScript
      Routine "ReadField"
         ; ---------------------------------------
         ; ReadField( buffer, dest ) SubRoutine.
         ; ---------------------------------------
         
         Local buffer
         Local dest
         Local ch
         
         Let buffer = Arg1
         Let dest   = Arg2
         Let ch     = " "
         
         While ch <> Char( 28 )
            FileReadChars buffer,ch,1
            
            Let dest = dest + ch
         EndLoop
      EndScript
      Routine "WriteRecord"
         ; -------------------------------
         ; WriteRecord() SubRoutine.
         ; -------------------------------
         
         Local tfilename
         Local AttributeCode
         
         Let tfilename     = "RAM:DBaseTempFile"
         Let AttributeCode = aindex + 1
         
         Do "WriteFile",tfilename
         
         Do "SendDBaseCommand","Write"|||tfilename|||AttributeCode
      EndScript
      Routine "OpenDBase"
         ; ------------------------------------
         ; OpenDBase() Subroutine.
         ; ------------------------------------
         
         Local filename
         
         SetFileRequestMode REGULARMODE ,PATTERNFIELD 
         SetFileRequestPattern "#?","#?.#?","#?.info"
         
         Let filename = TrimString( TextFrom( "FileName" ))
         
         If filename = ""
            Let filename = AskForFileName( TheCurrentDirectory, "Enter File to Open...",50,16)
            
            If filename = ""
               ExitScript
            EndIf
            
            SetText "Filename",filename
         EndIf
         
         Do "SendDBaseCommand","Open"|||filename
         
         SetText "Filename",filename
      EndScript
      Routine "ReadRecord"
         ; ------------------------------------
         ; ReadRecord() Subroutine.
         ; ------------------------------------
         
         Local filename
         Local code
         Local ident
         Local ans
         Local safety
         
         Let filename = "RAM:TempDBaseFile"
         Let ident    = TrimString( TextFrom( "Identifier" ))
         Let safety   = 10
         
         SetWindowTitle "Reading "||AttrCode[aindex]||", ID:  "||ident||"..."
         
         Do "SendDBaseCommand","Read"|||filename|||AttrCode[aindex]|||ident
         Delay 0,4,0
         
         While NOT Exists( filename ) AND safety > 0
            Delay 0,1,0
            Let safety = safety - 1
         EndLoop
         
         If safety = 0 AND NOT Exists( filename )
            Let ans = AskForResponse( "Didn't read in the record!", "Program ERROR:", "Arrrggghhh!" )
            ExitScript
         EndIf
         
         Let code = aindex + 1
         
         Do "SetFields",code,filename
         
         SetWindowTitle WTTL[1]
      EndScript
      Routine "SetupTypeList"
         ; -----------------------------
         ; SetupTypeList() SubRoutine.
         ; -----------------------------
         
         Local i
         
         Let AttrCode[0]    = "REQ";        = Requirement"
         Let AttrCode[1]    = "CAP";        = Capability"
         Let AttrCode[2]    = "SUPER";      = Supertype"
         Let AttrCode[3]    = "SUB";        = Subtype"
         Let AttrCode[4]    = "NOT_USED";   = NOT_USED"
         Let AttrCode[5]    = "ATTRIBUTE";  = Attribute"
         Let AttrCode[6]    = "RELATION";  = Relationship"
         Let AttrCode[7]    = "ASSOC";     = Association"
         Let AttrCode[8]    = "COMP";      = Composite"
         Let AttrCode[9]    = "PROC";      = Process"
         Let AttrCode[10]   = "STATE";     = State"
         Let AttrCode[11]   = "CDE";       = Context Desc' Entry"
         Let AttrCode[12]   = "IDE";       = Info' Desc' Entry"
         Let AttrCode[13]   = "BDE";       = Behavior Desc' Entry"
         Let AttrCode[14]   = "OCT";       = Object Comm' Entry"
         Let AttrCode[15]   = "PDE";       = Process Desc' Entry"
         Let AttrCode[16]   = "NORMAL";    = Normal Object"
         Let AttrCode[17]   = "USERREQ";   = Technical Note(s)"
         
         WorkWithDocument "RecTypesList"
         Clear DOCUMENT 
         Let i = 0
         
         While i < 18
            Type AttrCode[i],NEWLINE 
            Let i = i + 1
         EndLoop
         
         MoveCursorTo STARTOF DOCUMENT 
         
      EndScript
      Routine "RecordTypeSelected"
         ; ----------------------------------
         ; RecordTypeSelected() SubRoutine.
         ; ----------------------------------
         
         Local str
         Local i
         
         WorkWithDocument "RecTypesList"
         Let str = TrimString( TheLine )
         Let i   = 0
         
         While i < 18
            
            If AttrCode[i] = str
               Let aindex = i
               ExitLoop
            EndIf
            
            Let i = i + 1
         EndLoop
         
         SetInteger "TypeCode",i + 1
      EndScript
      Routine "WriteFile"
         ; -----------------------------------------
         ; WriteFile( tempfilename ) SubRoutine.
         ; -----------------------------------------
         
         Local outfile
         Local FS
         
         Let FS      = Char( 28 )   ;Record Field Separator value.
         
         Let outfile = TrimString( Arg1 )
         
         OpenFile outfile,"OutBuffer",WRITEONLY ,NEWFILE 
         
         If aindex = 0
            FileWriteChars "OutBuffer","1"||FS
            FileWriteChars "OutBuffer",Requirement[rindex].InObject||FS
            FileWriteChars "OutBuffer",Requirement[rindex].OutObject||FS
            FileWriteChars "OutBuffer",Requirement[rindex].InAttribute||FS
            FileWriteChars "OutBuffer",Requirement[rindex].OutAttribute||FS
            FileWriteChars "OutBuffer",Requirement[rindex].Number||FS
            
         ElseIf aindex = 1
            FileWriteChars "OutBuffer","2"||FS
            FileWriteChars "OutBuffer",Capability[rindex].Description||FS
            FileWriteChars "OutBuffer",Capability[rindex].ReqDescription||FS
            FileWriteChars "OutBuffer",Capability[rindex].String||FS
            FileWriteChars "OutBuffer",Capability[rindex].ReqString||FS
            FileWriteChars "OutBuffer",Capability[rindex].Number||FS
            FileWriteChars "OutBuffer",Capability[rindex].ReqNumber||FS
            
         ElseIf aindex = 2
            FileWriteChars "OutBuffer",SuperType[rindex].ParentName||FS
            FileWriteChars "OutBuffer","3"||FS
            FileWriteChars "OutBuffer",SuperType[rindex].Name||FS
            FileWriteChars "OutBuffer",SuperType[rindex].AttrCount||FS
            FileWriteChars "OutBuffer",SuperType[rindex].Number||FS
            FileWriteChars "OutBuffer",SuperType[rindex].NumChildren||FS
            FileWriteChars "OutBuffer",SuperType[rindex].AttrName||FS
            FileWriteChars "OutBuffer",SuperType[rindex].AttrNumber||FS
            FileWriteChars "OutBuffer",SuperType[rindex].Child||FS
            
         ElseIf aindex = 3
            FileWriteChars "OutBuffer",SubType[rindex].ParentName||FS
            FileWriteChars "OutBuffer","4"||FS
            FileWriteChars "OutBuffer",SubType[rindex].Name||FS
            FileWriteChars "OutBuffer",SubType[rindex].NextChild||FS
            FileWriteChars "OutBuffer",SubType[rindex].AttrCount||FS
            FileWriteChars "OutBuffer",SubType[rindex].Number||FS
            FileWriteChars "OutBuffer",SubType[rindex].AttrName||FS
            FileWriteChars "OutBuffer",SubType[rindex].AttrNumber||FS
            
         ElseIf aindex = 4
            Close "OutBuffer"
            ExitScript
            
         ElseIf aindex = 5
            FileWriteChars "OutBuffer",Attribute[rindex].ParentName||FS
            FileWriteChars "OutBuffer",Attribute[rindex].ParentNmbr||FS
            FileWriteChars "OutBuffer","6"||FS
            FileWriteChars "OutBuffer",Attribute[rindex].AttributeName||FS
            FileWriteChars "OutBuffer",Attribute[rindex].NextAttributeName||FS
            FileWriteChars "OutBuffer",Attribute[rindex].Number||FS
            FileWriteChars "OutBuffer",Attribute[rindex].ParentAttribCode||FS
            
         ElseIf aindex = 6
            FileWriteChars "OutBuffer",Relation[rindex].ParentName||FS
            FileWriteChars "OutBuffer","7"||FS
            FileWriteChars "OutBuffer",Relation[rindex].ByAction||FS
            FileWriteChars "OutBuffer",Relation[rindex].Spec||FS
            FileWriteChars "OutBuffer",Relation[rindex].Relator||FS
            FileWriteChars "OutBuffer",Relation[rindex].Related||FS
            FileWriteChars "OutBuffer",Relation[rindex].RelatorCount||FS
            FileWriteChars "OutBuffer",Relation[rindex].AttrCount||FS
            FileWriteChars "OutBuffer",Relation[rindex].Number||FS
            FileWriteChars "OutBuffer",Relation[rindex].RelatedCount||FS
            FileWriteChars "OutBuffer",Relation[rindex].AttrName||FS
            FileWriteChars "OutBuffer",Relation[rindex].AttrNumber||FS
            
         ElseIf aindex = 7
            FileWriteChars "OutBuffer",Association[rindex].ParentName||FS
            FileWriteChars "OutBuffer","8"||FS
            FileWriteChars "OutBuffer",Association[rindex].Name||FS
            FileWriteChars "OutBuffer",Association[rindex].NextObject||FS
            FileWriteChars "OutBuffer",Association[rindex].AttrCount||FS
            FileWriteChars "OutBuffer",Association[rindex].Number||FS
            FileWriteChars "OutBuffer",Association[rindex].Count||FS
            FileWriteChars "OutBuffer",Association[rindex].AttrName||FS
            FileWriteChars "OutBuffer",Association[rindex].AttrNumber||FS
            
         ElseIf aindex = 8
            FileWriteChars "OutBuffer",Composite[rindex].ParentName||FS
            FileWriteChars "OutBuffer","9"||FS
            FileWriteChars "OutBuffer",Composite[rindex].Name||FS
            FileWriteChars "OutBuffer",Composite[rindex].NextObject||FS
            FileWriteChars "OutBuffer",Composite[rindex].AttrCount||FS
            FileWriteChars "OutBuffer",Composite[rindex].Number||FS
            FileWriteChars "OutBuffer",Composite[rindex].Count||FS
            FileWriteChars "OutBuffer",Composite[rindex].AttrName||FS
            FileWriteChars "OutBuffer",Composite[rindex].AttrNumber||FS
            
         ElseIf aindex = 9
            FileWriteChars "OutBuffer",Process[rindex].ParentName||FS
            FileWriteChars "OutBuffer","10"||FS
            FileWriteChars "OutBuffer",Process[rindex].Name||FS
            FileWriteChars "OutBuffer",Process[rindex].InputEvent||FS
            FileWriteChars "OutBuffer",Process[rindex].Spec||FS
            FileWriteChars "OutBuffer",Process[rindex].Output||FS
            FileWriteChars "OutBuffer",Process[rindex].Number||FS
            FileWriteChars "OutBuffer",Process[rindex].ObjectNum||FS
            FileWriteChars "OutBuffer",Process[rindex].DataStores||FS
            FileWriteChars "OutBuffer",Process[rindex].DataNums||FS
            
         ElseIf aindex = 10
            FileWriteChars "OutBuffer","11"||FS
            FileWriteChars "OutBuffer",State[rindex].Name||FS
            FileWriteChars "OutBuffer",State[rindex].NextState||FS
            FileWriteChars "OutBuffer",State[rindex].TriggerEvent||FS
            FileWriteChars "OutBuffer",State[rindex].Action||FS
            FileWriteChars "OutBuffer",State[rindex].Number||FS
            
         ElseIf aindex = 11
            FileWriteChars "OutBuffer","12"||FS
            FileWriteChars "OutBuffer",CDE[rindex].SystemTitle||FS
            FileWriteChars "OutBuffer",CDE[rindex].TerminatorDescription||FS
            FileWriteChars "OutBuffer",CDE[rindex].TerminatorName||FS
            FileWriteChars "OutBuffer",CDE[rindex].ObjectNums||FS
            FileWriteChars "OutBuffer",CDE[rindex].Number||FS
            
            If CDE[rindex].SourceFlag = TRUE
               FileWriteChars "OutBuffer","SOURCE"||FS
            ElseIf CDE[rindex].SinkFlag = TRUE
               FileWriteChars "OutBuffer","SINK"||FS
            Else
               FileWriteChars "OutBuffer","SRC&SINK"||FS
            EndIf
            
         ElseIf aindex = 12
            FileWriteChars "OutBuffer","13"||FS
            FileWriteChars "OutBuffer",IDE[rindex].Name||FS
            FileWriteChars "OutBuffer",IDE[rindex].Identifiers||FS
            FileWriteChars "OutBuffer",IDE[rindex].Number||FS
            FileWriteChars "OutBuffer",IDE[rindex].AttrSummary||FS
            FileWriteChars "OutBuffer",IDE[rindex].Description||FS
            FileWriteChars "OutBuffer",IDE[rindex].AttrDescription||FS
            FileWriteChars "OutBuffer",IDE[rindex].Domain||FS
            
         ElseIf aindex = 13
            FileWriteChars "OutBuffer",BDE[rindex].ThreadNum||FS
            FileWriteChars "OutBuffer","14"||FS
            FileWriteChars "OutBuffer",BDE[rindex].State||FS
            FileWriteChars "OutBuffer",BDE[rindex].Event||FS
            FileWriteChars "OutBuffer",BDE[rindex].Source||FS
            FileWriteChars "OutBuffer",BDE[rindex].Destination||FS
            FileWriteChars "OutBuffer",BDE[rindex].ActionDescription||FS
            FileWriteChars "OutBuffer",BDE[rindex].TransitionTo||FS
            FileWriteChars "OutBuffer",BDE[rindex].Number||FS
            FileWriteChars "OutBuffer",BDE[rindex].ActionNum||FS
            FileWriteChars "OutBuffer",BDE[rindex].ActionDetails||FS
            
         ElseIf aindex = 14
            FileWriteChars "OutBuffer","15"||FS
            FileWriteChars "OutBuffer",OCT[rindex].EventDescription||FS
            FileWriteChars "OutBuffer",OCT[rindex].EventSource||FS
            FileWriteChars "OutBuffer",OCT[rindex].EventSink||FS
            FileWriteChars "OutBuffer",OCT[rindex].EventData||FS
            FileWriteChars "OutBuffer",OCT[rindex].Number||FS
            
         ElseIf aindex = 15
            FileWriteChars "OutBuffer","16"||FS
            FileWriteChars "OutBuffer",PDE[rindex].Name||FS
            FileWriteChars "OutBuffer",PDE[rindex].ActivityName||FS
            FileWriteChars "OutBuffer",PDE[rindex].ActionName||FS
            FileWriteChars "OutBuffer",PDE[rindex].ObjectName||FS
            FileWriteChars "OutBuffer",PDE[rindex].ActivityNum||FS
            FileWriteChars "OutBuffer",PDE[rindex].ActionNum||FS
            FileWriteChars "OutBuffer",PDE[rindex].Number||FS
            FileWriteChars "OutBuffer",PDE[rindex].ObjectNum||FS
            FileWriteChars "OutBuffer",PDE[rindex].Description||FS
            
         ElseIf aindex = 16
            FileWriteChars "OutBuffer",Normal[rindex].ParentName||FS
            FileWriteChars "OutBuffer","17"||FS
            FileWriteChars "OutBuffer",Normal[rindex].ID||FS
            FileWriteChars "OutBuffer",Normal[rindex].Number||FS
            FileWriteChars "OutBuffer",Normal[rindex].AttrCount||FS
            FileWriteChars "OutBuffer",Normal[rindex].AttrName||FS
            FileWriteChars "OutBuffer",Normal[rindex].AttrNumber||FS
            
         ElseIf aindex = 17
            FileWriteChars "OutBuffer","18"||FS
            FileWriteChars "OutBuffer",UReq[rindex].Name||FS
            FileWriteChars "OutBuffer",UReq[rindex].CrossRef||FS
            FileWriteChars "OutBuffer",UReq[rindex].Number||FS
            FileWriteChars "OutBuffer",UReq[rindex].Notes||FS
         EndIf
         
         Close "OutBuffer"
      EndScript
      Routine "GetNextInternalRecord"
         ; ----------------------------------------
         ; GetNextInternalRecord() SubRoutine.
         ; ----------------------------------------
         
         If aindex = 0   ;Requirement type of record.
            Let rindex = NextArrayIndex( Requirement, rindex )
         ElseIf aindex = 1
            Let rindex = NextArrayIndex( Capability, rindex )
         ElseIf aindex = 2
            Let rindex = NextArrayIndex( SuperType, rindex )
         ElseIf aindex = 3
            Let rindex = NextArrayIndex( SubType, rindex )
         ElseIf aindex = 4   ;Unused type of record.
            Let rindex = 0
         ElseIf aindex = 5
            Let rindex = NextArrayIndex( Attribute, rindex )
         ElseIf aindex = 6
            Let rindex = NextArrayIndex( Relation, rindex )
         ElseIf aindex = 7
            Let rindex = NextArrayIndex( Association, rindex )
         ElseIf aindex = 8
            Let rindex = NextArrayIndex( Composite, rindex )
         ElseIf aindex = 9
            Let rindex = NextArrayIndex( Process, rindex )
         ElseIf aindex = 10
            Let rindex = NextArrayIndex( State, rindex )
         ElseIf aindex = 11
            Let rindex = NextArrayIndex( CDE, rindex )
         ElseIf aindex = 12
            Let rindex = NextArrayIndex( IDE, rindex )
         ElseIf aindex = 13
            Let rindex = NextArrayIndex( BDE, rindex )
         ElseIf aindex = 14
            Let rindex = NextArrayIndex( OCT, rindex )
         ElseIf aindex = 15
            Let rindex = NextArrayIndex( PDE, rindex )
         ElseIf aindex = 16
            Let rindex = NextArrayIndex( Normal, rindex )
         ElseIf aindex = 17
            Let rindex = NextArrayIndex( UReq, rindex )
         EndIf
         
         Do "DisplayInternalRecord",rindex
      EndScript
      Routine "DisplayInternalRecord"
         ; -------------------------------------------------------
         ; DisplayInternalRecord( index ) SubRoutine.
         ; -------------------------------------------------------
         
         Local i
         
         Let i = Arg1
         
         SetInteger "RecNum",i
         
         WorkWithDocument "OutputRecord"
         Clear DOCUMENT 
         
         If aindex = 0
            SetText "Identifier",Requirement[i].Number
            Type "1",NEWLINE 
            Type Requirement[i].InObject,NEWLINE 
            Type Requirement[i].OutObject,NEWLINE 
            Type Requirement[i].InAttribute,NEWLINE 
            Type Requirement[i].OutAttribute,NEWLINE 
            Type Requirement[i].Number
            
         ElseIf aindex = 1
            SetText "Identifier",Capability[i].Number
            Type "2",NEWLINE 
            Type Capability[i].Description,NEWLINE 
            Type Capability[i].ReqDescription,NEWLINE 
            Type Capability[i].String,NEWLINE 
            Type Capability[i].ReqString,NEWLINE 
            Type Capability[i].Number,NEWLINE 
            Type Capability[i].ReqNumber
            
         ElseIf aindex = 2
            SetText "Identifier",SuperType[i].Number
            Type "PARENT  :  "||SuperType[i].ParentName,NEWLINE 
            Type "TYPECODE:  3",NEWLINE 
            Type "NAME    :  "||SuperType[i].Name,NEWLINE 
            Type "# ATTRS :  "||String( SuperType[i].AttrCount ),NEWLINE 
            Type "NUMBER  :  "||SuperType[i].Number,NEWLINE 
            Type "ATTRIBUTE NAMES:",NEWLINE 
            Type SuperType[i].AttrName,NEWLINE 
            Type "ATTRIBUTE NUMBERS:",NEWLINE 
            Type SuperType[i].AttrNumber,NEWLINE 
            Type "CHILDREN:",NEWLINE 
            Type SuperType[i].Child
            
         ElseIf aindex = 3
            SetText "Identifier",SubType[i].Number
            Type SubType[i].ParentName,NEWLINE 
            Type "4",NEWLINE 
            Type SubType[i].Name,NEWLINE 
            Type SubType[i].NextChild,NEWLINE 
            Type String( SubType[i].AttrCount ),NEWLINE 
            Type SubType[i].Number,NEWLINE 
            Type SubType[i].AttrName,NEWLINE 
            Type SubType[i].AttrNumber
            
         ElseIf aindex = 4
            SetWindowTitle "Unused Attribute Code!"
            Delay 0,4,0
            SetWindowTitle WTTL[1]
            ExitScript
            
         ElseIf aindex = 5
            SetText "Identifier",Attribute[i].Number
            Type Attribute[i].ParentName,NEWLINE 
            Type Attribute[i].ParentNmbr,NEWLINE 
            Type "6",NEWLINE 
            Type Attribute[i].AttributeName,NEWLINE 
            Type Attribute[i].NextAttributeName,NEWLINE 
            Type Attribute[i].Number,NEWLINE 
            Type Attribute[i].AttribCode
            
         ElseIf aindex = 6
            SetText "Identifier",Relation[i].Number
            Type Relation[i].ParentName,NEWLINE 
            Type "7",NEWLINE 
            Type Relation[i].ByAction,NEWLINE 
            Type Relation[i].Spec,NEWLINE 
            Type Relation[i].Relator,NEWLINE 
            Type Relation[i].Related,NEWLINE 
            Type Relation[i].RelatorCount,NEWLINE 
            Type String( Relation[i].AttrCount ),NEWLINE 
            Type Relation[i].Number,NEWLINE 
            Type Relation[i].RelatedCount,NEWLINE 
            Type Relation[i].AttrName,NEWLINE 
            Type Relation[i].AttrNumber
            
         ElseIf aindex = 7
            SetText "Identifier",Association[i].Number
            Type Association[i].ParentName,NEWLINE 
            Type "8",NEWLINE 
            Type Association[i].Name,NEWLINE 
            Type Association[i].NextObject,NEWLINE 
            Type String( Association[i].AttrCount ),NEWLINE 
            Type Association[i].Number,NEWLINE 
            Type String( Association[i].Count ),NEWLINE 
            Type Association[i].AttrName,NEWLINE 
            Type Association[i].AttrNumber
            
         ElseIf aindex = 8
            SetText "Identifier",Composite[i].Number
            Type Composite[i].ParentName,NEWLINE 
            Type "9",NEWLINE 
            Type Composite[i].Name,NEWLINE 
            Type Composite[i].NextObject,NEWLINE 
            Type String( Composite[i].AttrCount ),NEWLINE 
            Type Composite[i].Number,NEWLINE 
            Type String( Composite[i].Count ),NEWLINE 
            Type Composite[i].AttrName,NEWLINE 
            Type Composite[i].AttrNumber
            
         ElseIf aindex = 9
            SetText "Identifier",Process[i].Number
            Type Process[i].ParentName,NEWLINE 
            Type "10",NEWLINE 
            Type Process[i].Name,NEWLINE 
            Type Process[i].InputEvent,NEWLINE 
            Type Process[i].Spec,NEWLINE 
            Type Process[i].Output,NEWLINE 
            Type Process[i].Number,NEWLINE 
            Type Process[i].ObjectNum,NEWLINE 
            Type Process[i].DataStores,NEWLINE 
            Type Process[i].DataNums
            
         ElseIf aindex = 10
            SetText "Identifier",State[i].Number
            Type "11",NEWLINE 
            Type State[i].Name,NEWLINE 
            Type State[i].NextState,NEWLINE 
            Type State[i].TriggerEvent,NEWLINE 
            Type State[i].Action,NEWLINE 
            Type State[i].Number
            
         ElseIf aindex = 11
            SetText "Identifier",CDE[i].Number
            Type "12",NEWLINE 
            Type CDE[i].SystemTitle,NEWLINE 
            Type CDE[i].TerminatorDescription,NEWLINE 
            Type CDE[i].TerminatorName,NEWLINE 
            Type CDE[i].ObjectNums,NEWLINE 
            Type CDE[i].Number,NEWLINE 
            If CDE[i].SourceFlag = TRUE
               Type "SOURCE"
            ElseIf CDE[i].SinkFlag = TRUE
               Type "SINK"
            Else
               Type "SRC & SINK"
            EndIf
            
         ElseIf aindex = 12
            SetText "Identifier",IDE[i].Number
            Type "13",NEWLINE 
            Type IDE[i].Name,NEWLINE 
            Type IDE[i].Identifiers,NEWLINE 
            Type IDE[i].Number,NEWLINE 
            Type IDE[i].AttrSummary,NEWLINE 
            Type IDE[i].Description,NEWLINE 
            Type IDE[i].AttrDescription,NEWLINE 
            Type IDE[i].Domain
            
         ElseIf aindex = 13
            SetText "Identifier",BDE[i].Number
            Type BDE[i].ThreadNum,NEWLINE 
            Type "14",NEWLINE 
            Type BDE[i].State,NEWLINE 
            Type BDE[i].Event,NEWLINE 
            Type BDE[i].Source,NEWLINE 
            Type BDE[i].Destination,NEWLINE 
            Type BDE[i].ActionDescription,NEWLINE 
            Type BDE[i].TransitionTo,NEWLINE 
            Type BDE[i].Number,NEWLINE 
            Type BDE[i].ActionNum,NEWLINE 
            Type BDE[i].ActionDetails
            
         ElseIf aindex = 14
            SetText "Identifier",OCT[i].Number
            Type "15",NEWLINE 
            Type OCT[i].EventDescription,NEWLINE 
            Type OCT[i].EventSource,NEWLINE 
            Type OCT[i].EventSink,NEWLINE 
            Type OCT[i].EventData,NEWLINE 
            Type OCT[i].Number
            
         ElseIf aindex = 15
            SetText "Identifier",PDE[i].Number
            Type "16",NEWLINE 
            Type PDE[i].Name,NEWLINE 
            Type PDE[i].ActivityName,NEWLINE 
            Type PDE[i].ActionName,NEWLINE 
            Type PDE[i].ObjectName,NEWLINE 
            Type PDE[i].ActivityNum,NEWLINE 
            Type PDE[i].ActionNum,NEWLINE 
            Type PDE[i].Number,NEWLINE 
            Type PDE[i].ObjectNum,NEWLINE 
            Type PDE[i].Description
            
         ElseIf aindex = 16
            SetText "Identifier",Normal[i].Number
            Type Normal[i].ParentName,NEWLINE 
            Type "17",NEWLINE 
            Type Normal[i].ID,NEWLINE 
            Type Normal[i].Number,NEWLINE 
            Type String( Normal[i].AttrCount ),NEWLINE 
            Type Normal[i].AttrName,NEWLINE 
            Type Normal[i].AttrNumber
            
         ElseIf aindex = 17
            SetText "Identifier",UReq[i].Number
            Type "18",NEWLINE 
            Type UReq[i].Name,NEWLINE 
            Type UReq[i].CrossRef,NEWLINE 
            Type UReq[i].Number,NEWLINE 
            Type UReq[i].Notes
         EndIf
         
         MoveCursorTo STARTOF DOCUMENT 
         SetWindowTitle WTTL[1]
      EndScript
      Routine "SetupDisplay"
         ; ---------------------------
         ; SetupDisplay() SubRoutine
         ; ---------------------------
         
         SetInteger "TypeCode",aindex + 1
         
         Do "DrawRaisedBox",11,228,244,26
         
      EndScript
      Routine "SetFields"
         ; -----------------------------------------------
         ; SetFields( attrcode, filename ) SubRoutine.
         ; -----------------------------------------------
         
         Local code
         Local filename
         Local ident
         Local i
         Local str
         
         Let str[0]   = ""
         Let code     = Arg1
         Let ident    = TrimString( TextFrom( "Identifier" ))
         Let filename = Arg2
         
         ; ------------------ Read in the record:
         
         WorkWithDocument "InputRecord"
         Clear DOCUMENT 
         
         OpenFile filename,"Tempo",READONLY ,OLDFILE 
         
         Let ch = " "
         While ch <> Char( 28 )
            FileReadChars "Tempo",ch,1
            Let str[0] = str[0]||ch
         EndLoop
         
         Let ch = " "
         While ch <> Char( 28 )
            FileReadChars "Tempo",ch,1
            Let str[1] = str[1]||ch
         EndLoop
         
         Let ch = " "
         While ch <> Char( 28 )
            FileReadChars "Tempo",ch,1
            Let str[2] = str[2]||ch
         EndLoop
         
         Let ch = " "
         While ch <> Char( 28 )
            FileReadChars "Tempo",ch,1
            Let str[3] = str[3]||ch
         EndLoop
         
         Let ch = " "
         While ch <> Char( 28 )
            FileReadChars "Tempo",ch,1
            Let str[4] = str[4]||ch
         EndLoop
         
         Let ch = " "
         While ch <> Char( 28 )
            FileReadChars "Tempo",ch,1
            Let str[5] = str[5]||ch
         EndLoop
         
         Let ch = " "
         While ch <> Char( 28 )
            FileReadChars "Tempo",ch,1
            Let str[6] = str[6]||ch
         EndLoop
         
         Let ch = " "
         While ch <> Char( 28 )
            FileReadChars "Tempo",ch,1
            Let str[7] = str[7]||ch
         EndLoop
         
         Let ch = " "
         While ch <> Char( 28 )
            FileReadChars "Tempo",ch,1
            Let str[8] = str[8]||ch
         EndLoop
         
         Let ch = " "
         While ch <> Char( 28 )
            FileReadChars "Tempo",ch,1
            Let str[9] = str[9]||ch
         EndLoop
         
         Let ch = " "
         While ch <> Char( 28 )
            FileReadChars "Tempo",ch,1
            Let str[10] = str[10]||ch
         EndLoop
         
         Let ch = " "
         While ch <> Char( 28 )
            FileReadChars "Tempo",ch,1
            Let str[11] = str[11]||ch
         EndLoop
         
         Let ch = " "
         While ch <> Char( 28 )
            FileReadChars "Tempo",ch,1
            Let str[12] = str[12]||ch
         EndLoop
         
         Let ch = " "
         While ch <> Char( 28 )
            FileReadChars "Tempo",ch,1
            Let str[13] = str[13]||ch
         EndLoop
         
         Let ch = " "
         While ch <> Char( 28 )
            FileReadChars "Tempo",ch,1
            Let str[14] = str[14]||ch
         EndLoop
         
         Close "Tempo"
         
         ; --------------------  Next, place the str[]'s into the Record:
         If code = 1
            Let i = FirstArrayIndex( Requirement )
            
            While i <= LastArrayIndex( Requirement )
               If Requirement[i].Number = ident
                  ExitLoop
               EndIf
               
               Let i = i + 1
            EndLoop
            
            Let Requirement[i].InObject     = TrimString( str[3] )
            Let Requirement[i].OutObject    = TrimString( str[4] )
            Let Requirement[i].InAttribute  = TrimString( str[5] )
            Let Requirement[i].OutAttribute = TrimString( str[6] )
            Let Requirement[i].Number       = TrimString( str[9] )
            SetDBObjects Requirement[i]
            
         ElseIf code = 2
            Let i = FirstArrayIndex( Capability )
            
            While i <= LastArrayIndex( Capability )
               If Capability[i].Number = ident
                  ExitLoop
               EndIf
               
               Let i = i + 1
            EndLoop
            
            Let Capability[i].Description    = TrimString( str[3] )
            Let Capability[i].ReqDescription = TrimString( str[4] )
            Let Capability[i].String         = TrimString( str[5] )
            Let Capability[i].ReqString      = TrimString( str[6] )
            Let Capability[i].Number         = TrimString( str[9] )
            Let Capability[i].ReqNumber      = TrimString( str[10] )
            
         ElseIf code = 3
            Let i = FirstArrayIndex( SuperType )
            
            While i <= LastArrayIndex( SuperType )
               If SuperType[i].Number = ident
                  ExitLoop
               EndIf
               
               Let i = i + 1
            EndLoop
            
            Let SuperType[i].ParentName  = TrimString( str[0] )
            Let SuperType[i].Name        = TrimString( str[3] )
            Let SuperType[i].AttrCount   = TrimString( str[8] )
            Let SuperType[i].Number      = TrimString( str[9] )
            Let SuperType[i].NumChildren = TrimString( str[10] )
            Let SuperType[i].AttrName    = TrimString( str[11] )
            Let SuperType[i].AttrNumber  = TrimString( str[12] )
            Let SuperType[i].Child       = TrimString( str[13] )
            
         ElseIf code = 4
            Let i = FirstArrayIndex( SubType )
            
            While i <= LastArrayIndex( SubType )
               If SubType[i].Number = ident
                  ExitLoop
               EndIf
               
               Let i = i + 1
            EndLoop
            
            Let SubType[i].ParentName  = TrimString( str[0] )
            Let SubType[i].Name        = TrimString( str[3] )
            Let SubType[i].NextChild   = TrimString( str[4] )
            Let SubType[i].AttrCount   = TrimString( str[8] )
            Let SubType[i].Number      = TrimString( str[9] )
            Let SubType[i].AttrName    = TrimString( str[11] )
            Let SubType[i].AttrNumber  = TrimString( str[12] )
            
         ElseIf code = 5
            ExitScript   ;Unused Attribute Code!
            
         ElseIf code = 6
            Let i = FirstArrayIndex( Attribute )
            
            While i <= LastArrayIndex( Attribute )
               If Attribute[i].Number = ident
                  ExitLoop
               EndIf
               
               Let i = i + 1
            EndLoop
            
            Let Attribute[i].ParentName       = TrimString( str[0] )
            Let Attribute[i].ParentNmbr       = TrimString( str[1] )
            Let Attribute[i].AttributeName    = TrimString( str[3] )
            Let Attribute[i].NextAttribName   = TrimString( str[4] )
            Let Attribute[i].Number           = TrimString( str[9] )
            Let Attribute[i].ParentAttribCode = TrimString( str[10] )
            
         ElseIf code = 7
            Let i = FirstArrayIndex( Relation )
            
            While i <= LastArrayIndex( Relation )
               If Relation[i].Number = ident
                  ExitLoop
               EndIf
               
               Let i = i + 1
            EndLoop
            
            Let Relation[i].ParentName   = TrimString( str[0] )
            Let Relation[i].ByAction     = TrimString( str[3] )
            Let Relation[i].Spec         = TrimString( str[4] )
            Let Relation[i].Relator      = TrimString( str[5] )
            Let Relation[i].Related      = TrimString( str[6] )
            Let Relation[i].RelatorCount = TrimString( str[7] )
            Let Relation[i].AttrCount    = TrimString( str[8] )
            Let Relation[i].Number       = TrimString( str[9] )
            Let Relation[i].RelatedCount = TrimString( str[10] )
            Let Relation[i].AttrName     = TrimString( str[11] )
            Let Relation[i].AttrNumber   = TrimString( str[12] )
            
         ElseIf code = 8
            Let i = FirstArrayIndex( Association )
            
            While i <= LastArrayIndex( Association )
               If Association[i].Number = ident
                  ExitLoop
               EndIf
               
               Let i = i + 1
            EndLoop
            
            Let Association[i].ParentName = TrimString( str[0] )
            Let Association[i].Name       = TrimString( str[3] )
            Let Association[i].NextObject = TrimString( str[4] )
            Let Association[i].AttrCount  = TrimString( str[8] )
            Let Association[i].Number     = TrimString( str[9] )
            Let Association[i].Count      = TrimString( str[10] )
            Let Association[i].AttrName   = TrimString( str[11] )
            Let Association[i].AttrNumber = TrimString( str[12] )
            
         ElseIf code = 9
            Let i = FirstArrayIndex( Composite )
            
            While i <= LastArrayIndex( Composite )
               If Composite[i].Number = ident
                  ExitLoop
               EndIf
               
               Let i = i + 1
            EndLoop
            
            Let Composite[i].ParentName   = TrimString( str[0] )
            Let Composite[i].Name         = TrimString( str[3] )
            Let Composite[i].NextObject   = TrimString( str[4] )
            Let Composite[i].AttrCount    = TrimString( str[8] )
            Let Composite[i].Number       = TrimString( str[9] )
            Let Composite[i].Count        = TrimString( str[10] )
            Let Composite[i].AttrName     = TrimString( str[11] )
            Let Composite[i].AttrNumber   = TrimString( str[12] )
            
         ElseIf code = 10
            Let i = FirstArrayIndex( Process )
            
            While i <= LastArrayIndex( Process )
               If Process[i].Number = ident
                  ExitLoop
               EndIf
               
               Let i = i + 1
            EndLoop
            
            Let Process[i].ParentName = TrimString( str[0] )
            Let Process[i].Name       = TrimString( str[3] )
            Let Process[i].InputEvent = TrimString( str[4] )
            Let Process[i].Spec       = TrimString( str[5] )
            Let Process[i].Output     = TrimString( str[6] )
            Let Process[i].Number     = TrimString( str[9] )
            Let Process[i].ObjectNum  = TrimString( str[10] )
            Let Process[i].DataStores = TrimString( str[11] )
            Let Process[i].DataNums   = TrimString( str[12] )
            
         ElseIf code = 11
            Let i = FirstArrayIndex( State )
            
            While i <= LastArrayIndex( State )
               If State[i].Number = ident
                  ExitLoop
               EndIf
               
               Let i = i + 1
            EndLoop
            
            Let State[i].Name         = TrimString( str[3] )
            Let State[i].NextState    = TrimString( str[4] )
            Let State[i].TriggerEvent = TrimString( str[5] )
            Let State[i].Action       = TrimString( str[6] )
            Let State[i].Number       = TrimString( str[9] )
            
         ElseIf code = 12
            Let i = FirstArrayIndex( CDE )
            
            While i <= LastArrayIndex( CDE )
               If CDE[i].Number = ident
                  ExitLoop
               EndIf
               
               Let i = i + 1
            EndLoop
            
            Let CDE[i].SystemTitle           = TrimString( str[3] )
            Let CDE[i].TerminatorDescription = TrimString( str[4] )
            Let CDE[i].TerminatorName        = TrimString( str[5] )
            Let CDE[i].ObjectNums            = TrimString( str[6] )
            Let CDE[i].Number                = TrimString( str[9] )
            
            If UpperCase( TrimString( str[10] )) = "SOURCE"
               Let CDE[i].SourceFlag = TRUE
            ElseIf UpperCase( TrimString( str[10] )) = "SINK"
               Let CDE[i].SinkFlag = TRUE
            Else
               Let CDE[i].SrcSinkFlag = TRUE
            EndIf
            
         ElseIf code = 13
            Let i = FirstArrayIndex( IDE )
            
            While i <= LastArrayIndex( IDE )
               If IDE[i].Number = ident
                  ExitLoop
               EndIf
               
               Let i = i + 1
            EndLoop
            
            Let IDE[i].Name            = TrimString( str[3] )
            Let IDE[i].Identifiers     = TrimString( str[4] )
            Let IDE[i].Number          = TrimString( str[9] )
            Let IDE[i].AttrSummary     = TrimString( str[11] )
            Let IDE[i].Description     = TrimString( str[12] )
            Let IDE[i].AttrDescription = TrimString( str[13] )
            Let IDE[i].Domain          = TrimString( str[14] )
            
         ElseIf code = 14
            Let i = FirstArrayIndex( BDE )
            
            While i <= LastArrayIndex( BDE )
               If BDE[i].Number = ident
                  ExitLoop
               EndIf
               
               Let i = i + 1
            EndLoop
            
            Let BDE[i].ThreadNum         = TrimString( str[0] )
            Let BDE[i].State             = TrimString( str[3] )
            Let BDE[i].Event             = TrimString( str[4] )
            Let BDE[i].Source            = TrimString( str[5] )
            Let BDE[i].Destination       = TrimString( str[6] )
            Let BDE[i].ActionDescription = TrimString( str[7] )
            Let BDE[i].TransitionTo      = TrimString( str[8] )
            Let BDE[i].Number            = TrimString( str[9] )
            Let BDE[i].ActionNum         = TrimString( str[10] )
            Let BDE[i].ActionDetails     = TrimString( str[11] )
            
         ElseIf code = 15
            Let i = FirstArrayIndex( OCT )
            
            While i <= LastArrayIndex( OCT )
               If OCT[i].Number = ident
                  ExitLoop
               EndIf
               
               Let i = i + 1
            EndLoop
            
            Let OCT[i].EventDescription = TrimString( str[4] )
            Let OCT[i].EventSource      = TrimString( str[5] )
            Let OCT[i].EventSink        = TrimString( str[6] )
            Let OCT[i].EventData        = TrimString( str[7] )
            Let OCT[i].Number           = TrimString( str[9] )
            
         ElseIf code = 16
            Let i = FirstArrayIndex( PDE )
            
            While i <= LastArrayIndex( PDE )
               If PDE[i].Number = ident
                  ExitLoop
               EndIf
               
               Let i = i + 1
            EndLoop
            
            Let PDE[i].Name         = TrimString( str[3] )
            Let PDE[i].ActivityName = TrimString( str[4] )
            Let PDE[i].ActionName   = TrimString( str[5] )
            Let PDE[i].ObjectName   = TrimString( str[6] )
            Let PDE[i].ActivityNum  = TrimString( str[7] )
            Let PDE[i].ActionNum    = TrimString( str[8] )
            Let PDE[i].Number       = TrimString( str[9] )
            Let PDE[i].ObjectNum    = TrimString( str[10] )
            Let PDE[i].Description  = TrimString( str[11] )
            
         ElseIf code = 17
            Let i = FirstArrayIndex( Normal )
            
            While i <= LastArrayIndex( Normal )
               If Normal[i].Number = ident
                  ExitLoop
               EndIf
               
               Let i = i + 1
            EndLoop
            
            Let Normal[i].ParentName   = TrimString( str[0] )
            Let Normal[i].ID           = TrimString( str[3] )
            Let Normal[i].Number       = TrimString( str[9] )
            Let Normal[i].AttrCount    = TrimString( str[10] )
            Let Normal[i].AttrName     = TrimString( str[11] )
            Let Normal[i].AttrNumber   = TrimString( str[12] )
            
         ElseIf code = 18
            Let i = FirstArrayIndex( UReq )
            
            While i <= LastArrayIndex( UReq )
               If UReq[i].Number = ident
                  ExitLoop
               EndIf
               
               Let i = i + 1
            EndLoop
            
            Let UReq[i].Name     = TrimString( str[3] )
            Let UReq[i].CrossRef = TrimString( str[4] )
            Let UReq[i].Number   = TrimString( str[9] )
            Let UReq[i].Notes    = TrimString( str[11] )
            SetDBObjects UReq[i]
            
         EndIf
         
         ;  ------- then type the Record into the Document "InputRecord":
         
         Do "RewriteRecord",code,i
      EndScript
      Routine "RewriteRecord"
         ; ------------------------------------------
         ; RewriteRecord( code, number ) SubRoutine.
         ; ------------------------------------------
         
         Local code
         Local num
         
         Let code = Arg1
         Let num  = Arg2
         
         WorkWithDocument "InputRecord"
         Clear DOCUMENT 
         
         If code = 1
            Let Requirement[num] = GetDBObjects
            Type String( code ),NEWLINE 
            Type Requirement[num].InObject,NEWLINE 
            Type Requirement[num].OutObject,NEWLINE 
            Type Requirement[num].InAttribute,NEWLINE 
            Type Requirement[num].OutAttribute,NEWLINE 
            Type Requirement[num].Number
         ElseIf code = 2
            Type String( code ),NEWLINE 
            Type Capability[num].Description,NEWLINE 
            Type Capability[num].ReqDescription,NEWLINE 
            Type Capability[num].String,NEWLINE 
            Type Capability[num].ReqString,NEWLINE 
            Type Capability[num].Number,NEWLINE 
            Type Capability[num].ReqNumber
         ElseIf code = 3
            Type SuperType[num].ParentName,NEWLINE 
            Type String( code ),NEWLINE 
            Type SuperType[num].Name,NEWLINE 
            Type SuperType[num].AttrCount,NEWLINE 
            Type SuperType[num].Number,NEWLINE 
            Type SuperType[num].NumChildren,NEWLINE 
            Type SuperType[num].AttrName,NEWLINE 
            Type SuperType[num].AttrNumber,NEWLINE 
            Type SuperType[num].Child
         ElseIf code = 4
            Type SubType[num].ParentName,NEWLINE 
            Type String( code ),NEWLINE 
            Type SubType[num].Name,NEWLINE 
            Type SubType[num].NextChild,NEWLINE 
            Type SubType[num].AttrCount,NEWLINE 
            Type SubType[num].Number,NEWLINE 
            Type SubType[num].AttrName,NEWLINE 
            Type SubType[num].AttrNumber
         ElseIf code = 5
            Nop   ;No Record of this type!!
         ElseIf code = 6
            Type Attribute[num].ParentName,NEWLINE 
            Type Attribute[num].ParentNmbr,NEWLINE 
            Type String( code ),NEWLINE 
            Type Attribute[num].AttributeName,NEWLINE 
            Type Attribute[num].NextAttributeName,NEWLINE 
            Type Attribute[num].Number,NEWLINE 
            Type Attribute[num].ParentAttribCode
         ElseIf code = 7
            Type Relation[num].ParentName,NEWLINE 
            Type String( code ),NEWLINE 
            Type Relation[num].ByAction,NEWLINE 
            Type Relation[num].Spec,NEWLINE 
            Type Relation[num].Relator,NEWLINE 
            Type Relation[num].Related,NEWLINE 
            Type Relation[num].RelatorCount,NEWLINE 
            Type Relation[num].AttrCount,NEWLINE 
            Type Relation[num].Number,NEWLINE 
            Type Relation[num].RelatedCount,NEWLINE 
            Type Relation[num].AttrName,NEWLINE 
            Type Relation[num].AttrNumber
         ElseIf code = 8
            Type Association[num].ParentName,NEWLINE 
            Type String( code ),NEWLINE 
            Type Association[num].Name,NEWLINE 
            Type Association[num].NextObject,NEWLINE 
            Type Association[num].AttrCount,NEWLINE 
            Type Association[num].Number,NEWLINE 
            Type Association[num].Count,NEWLINE 
            Type Association[num].AttrName,NEWLINE 
            Type Association[num].AttrNumber
         ElseIf code = 9
            Type Composite[num].ParentName,NEWLINE 
            Type String( code ),NEWLINE 
            Type Composite[num].Name,NEWLINE 
            Type Composite[num].NextObject,NEWLINE 
            Type Composite[num].AttrCount,NEWLINE 
            Type Composite[num].Number,NEWLINE 
            Type Composite[num].Count,NEWLINE 
            Type Composite[num].AttrName,NEWLINE 
            Type Composite[num].AttrNumber
         ElseIf code = 10
            Type Process[num].ParentName,NEWLINE 
            Type String( code ),NEWLINE 
            Type Process[num].Name,NEWLINE 
            Type Process[num].InputEvent,NEWLINE 
            Type Process[num].Spec,NEWLINE 
            Type Process[num].Output,NEWLINE 
            Type Process[num].Number,NEWLINE 
            Type Process[num].ObjectNum,NEWLINE 
            Type Process[num].DataStores,NEWLINE 
            Type Process[num].DataNums
         ElseIf code = 11
            Type String( code ),NEWLINE 
            Type State[num].Name,NEWLINE 
            Type State[num].NextState,NEWLINE 
            Type State[num].TriggerEvent,NEWLINE 
            Type State[num].Action,NEWLINE 
            Type State[num].Number
         ElseIf code = 12
            Type String( code ),NEWLINE 
            Type CDE[num].SystemTitle,NEWLINE 
            Type CDE[num].TerminatorDescription,NEWLINE 
            Type CDE[num].TerminatorName,NEWLINE 
            Type CDE[num].ObjectNums,NEWLINE 
            Type CDE[num].Number,NEWLINE 
            
            If CDE[num].SourceFlag = TRUE
               Type "SOURCE"
            ElseIf CDE[num].SinkFlag = TRUE
               Type "SINK"
            Else
               Type "SRC&SINK"
            EndIf
            
         ElseIf code = 13
            Type String( code ),NEWLINE 
            Type IDE[num].Name,NEWLINE 
            Type IDE[num].Identifiers,NEWLINE 
            Type IDE[num].Number,NEWLINE 
            Type IDE[num].AttrSummary,NEWLINE 
            Type IDE[num].Description,NEWLINE 
            Type IDE[num].AttrDescription,NEWLINE 
            Type IDE[num].Domain
         ElseIf code = 14
            Type BDE[num].ParentName,NEWLINE 
            Type String( code ),NEWLINE 
            Type BDE[num].State,NEWLINE 
            Type BDE[num].Event,NEWLINE 
            Type BDE[num].Source,NEWLINE 
            Type BDE[num].Destination,NEWLINE 
            Type BDE[num].ActionDescription,NEWLINE 
            Type BDE[num].TransitionTo,NEWLINE 
            Type BDE[num].Number,NEWLINE 
            Type BDE[num].ActionNum,NEWLINE 
            Type BDE[num].ActionDetails
         ElseIf code = 15
            Type String( code ),NEWLINE 
            Type OCT[num].EventDescription,NEWLINE 
            Type OCT[num].EventSource,NEWLINE 
            Type OCT[num].EventSink,NEWLINE 
            Type OCT[num].EventData,NEWLINE 
            Type OCT[num].Number
         ElseIf code = 16
            Type String( code ),NEWLINE 
            Type PDE[num].Name,NEWLINE 
            Type PDE[num].ActivityName,NEWLINE 
            Type PDE[num].ActionName,NEWLINE 
            Type PDE[num].ObjectName,NEWLINE 
            Type PDE[num].ActivityNum,NEWLINE 
            Type PDE[num].ActionNum,NEWLINE 
            Type PDE[num].Number,NEWLINE 
            Type PDE[num].ObjectNum,NEWLINE 
            Type PDE[num].Description
         ElseIf code = 17
            Type Normal[num].ParentName,NEWLINE 
            Type String( code ),NEWLINE 
            Type Normal[num].ID,NEWLINE 
            Type Normal[num].Number,NEWLINE 
            Type Normal[num].AttrCount,NEWLINE 
            Type Normal[num].AttrName,NEWLINE 
            Type Normal[num].AttrNumber
            
         ElseIf code = 18
            Let UReq[num] = GetDBObjects
            Type String( code ),NEWLINE 
            Type UReq[num].Name,NEWLINE 
            Type UReq[num].CrossRef,NEWLINE 
            Type UReq[num].Number,NEWLINE 
            Type UReq[num].Notes
         EndIf
         
         MoveCursorTo STARTOF DOCUMENT 
      EndScript
      BeforeAttachment
         Let aindex = 0   ;Record Type index, Attribute Code.
         Let rindex = 0   ;Record index.
      EndScript
      AfterAttachment
         SetWindowTitle WTTL[1]
         
         Do "SetUpColors"
         Do "SetupTypeList"
         
         If Supervised = FALSE
            Do "SetupDisplay"
         EndIf
      EndScript
      Window "UserWindow"
         Definition
            Origin 0,16
            Title "DataBase Record Keeping:"
            WindowObjects CLOSEBUTTON DEPTHBUTTONS DRAGBAR 
            WindowLimits 250,15,640,480
            WindowZoom 0,16,250,15
            Size 640,400
            WindowFlags ACTIVATE TOFRONT WORKBENCH 
            VisualEffects NONE ,WAIT 
         EndScript
         OnCloseButton
            Do "CleanupRecords"
            
            GotoCard "MainCard"
            
         EndScript
         OnActivated
            Do "SetUpColors"
            Do "SetupDisplay"
            
         EndScript
         OnResized
            Do "SetUpColors"
            Do "SetupDisplay"
         EndScript
      EndObj
      AKey "HelpKey"
         Definition
            QualifiersPressed NONE 
            KeyPressed HELP 
         EndScript
         OnUp
            Let d = AskForHelp( HelpPath||"GOOSA.guide", "RecordKeeperCard" )
            
         EndScript
      EndObj
      TextMenu "Create"
         Definition
            AttachTo MENU ,"PROJECT  "
            Text "Create..."
            ShortCutKey "C"
         EndScript
         Occurred
            Do "CreateDBase"
            
         EndScript
      EndObj
      TextMenu "Open"
         Definition
            AttachTo MENU ,"PROJECT  "
            Text "Open..."
            ShortCutKey "L"
         EndScript
         Occurred
            Do "OpenDBase"
            
         EndScript
      EndObj
      TextField "Filename"
         Definition
            InitialText ""
            Origin 85,22
            Size 473,12
            Border DOUBLEBEVEL 
            Label "Filename:",HIGHLIGHT 
            Justification CENTER 
            MaxFieldLength 255
         EndScript
         OnClick
            SetText "Filename",""
         EndScript
      EndObj
      TextField "Identifier"
         Definition
            InitialText ""
            Origin 441,235
            Size 160,12
            Border DOUBLEBEVEL 
            Label "ID:",HIGHLIGHT 
            Justification CENTER 
            MaxFieldLength 255
         EndScript
      EndObj
      TextMenu "Close"
         Definition
            AttachTo MENU ,"PROJECT  "
            Text "Close"
            ShortCutKey "S"
         EndScript
         Occurred
            Do "CloseDBase"
            
         EndScript
      EndObj
      TextMenu "Search"
         Definition
            AttachTo MENU ,"PROJECT  "
            Text "Search"
         EndScript
         Occurred
            Do "SearchDBase"
         EndScript
      EndObj
      TextMenu "Read"
         Definition
            AttachTo MENU ,"PROJECT  "
            Text "Read"
         EndScript
         Occurred
            Do "ReadRecord"
            
         EndScript
      EndObj
      TextMenu "Write"
         Definition
            AttachTo MENU ,"PROJECT  "
            Text "Write"
         EndScript
         Occurred
            Do "WriteRecord"
         EndScript
      EndObj
      TextMenu "Delete"
         Definition
            AttachTo MENU ,"PROJECT  "
            Text "Delete"
         EndScript
         Occurred
            Do "DeleteRecord"
         EndScript
      EndObj
      TextMenu "UnDelete"
         Definition
            AttachTo MENU ,"PROJECT  "
            Text "UnDelete"
         EndScript
         Occurred
            Do "UnDeleteRecord"
         EndScript
      EndObj
      TextMenu "ShutDown"
         Definition
            AttachTo MENU ,"PROJECT  "
            Text "Shut Down"
         EndScript
         Occurred
            Do "KillDBaseManager"
         EndScript
      EndObj
      TextMenu "First"
         Definition
            AttachTo MENU ,"RECORDS"
            Text "First"
            ShortCutKey "T"
         EndScript
         Occurred
            Do "FirstRecord"
         EndScript
      EndObj
      TextMenu "Next"
         Definition
            AttachTo MENU ,"RECORDS"
            Text "Next"
            ShortCutKey "N"
         EndScript
         Occurred
            Do "NextRecord"
         EndScript
      EndObj
      TextMenu "Prev"
         Definition
            AttachTo MENU ,"RECORDS"
            Text "Prev"
            ShortCutKey "P"
         EndScript
         Occurred
            Do "PrevRecord"
         EndScript
      EndObj
      TextMenu "Last"
         Definition
            AttachTo MENU ,"RECORDS"
            Text "Last"
            ShortCutKey "B"
         EndScript
         Occurred
            Do "LastRecord"
         EndScript
      EndObj
      Memo "OutRecord"
         Definition
            MemoDocument "OutputRecord"
            ScrollBars RIGHT BOTTOM 
            Origin 11,264
            Size 616,131
            Border BEVEL 
            Label "Write Buffer:",ABOVE 
            Font "topaz",8
            TextColors 1,0,JAM2 
            Style PLAIN ,2,3
         EndScript
      EndObj
      AreaButton "LastGoosa"
         Definition
            Origin 218,235
            Border BEVEL 
            Text ">|"
            Font "topaz",8
            Style PLAIN ,2,3
            TextColors 8,0,JAM1 
            Size 30,12
         EndScript
         OnRelease
            Do "GetLastInternalRecord"
         EndScript
      EndObj
      AreaButton "PrevGoosa"
         Definition
            Origin 52,235
            Border BEVEL 
            Text " PREV "
            Font "topaz",8
            Style PLAIN ,2,3
            TextColors 8,0,JAM1 
            Size 52,12
         EndScript
         OnRelease
            Do "GetPrevInternalRecord"
         EndScript
      EndObj
      AreaButton "NextGoosa"
         Definition
            Origin 162,235
            Border BEVEL 
            Text " NEXT "
            Font "topaz",8
            Style PLAIN ,2,3
            TextColors 8,0,JAM1 
            Size 52,12
         EndScript
         OnRelease
            Do "GetNextInternalRecord"
            
         EndScript
      EndObj
      AreaButton "FirstGoosa"
         Definition
            Origin 18,235
            Border BEVEL 
            Text "|<"
            Font "topaz",8
            Style PLAIN ,2,3
            TextColors 8,0,JAM1 
            Size 30,12
         EndScript
         OnRelease
            Do "GetFirstInternalRecord"
         EndScript
      EndObj
      ErrorTrap "UserError_1"
         Occurred
            Do "HandleInternalError"
         EndScript
      EndObj
      List "RecTypes"
         Definition
            ListDocument "RecTypesList"
            Origin 12,58
            Size 145,161
            Border INVERT BEVEL 
            Label "Record Types:",ABOVE 
            Font "topaz",8
         EndScript
         OnRelease
            Do "RecordTypeSelected"
            
         EndScript
      EndObj
      IntegerField "TypeCode"
         Definition
            Limits 0,999999999
            InitialInteger 0
            Origin 134,42
            Size 30,13
            Justification CENTER 
            MaxFieldLength 5
         EndScript
         OnRelease
            SetInteger "TypeCode",aindex + 1
         EndScript
      EndObj
      IntegerField "RecNum"
         Definition
            Limits 0,999999999
            InitialInteger 0
            Origin 108,235
            Size 50,12
            Border INVERT BEVEL 
            Justification CENTER 
            MaxFieldLength 10
         EndScript
         OnRelease
            SetInteger "RecNum",rindex + 1
         EndScript
      EndObj
      TextField ".InObject"
         Definition
            InitialText ""
            Origin 610,61
            Size 1,1
            MaxFieldLength 32
         EndScript
      EndObj
      TextField ".OutObject"
         Definition
            InitialText ""
            Origin 610,61
            Size 1,1
            MaxFieldLength 32
         EndScript
      EndObj
      TextField ".InAttribute"
         Definition
            InitialText ""
            Origin 610,61
            Size 1,1
            MaxFieldLength 32
         EndScript
      EndObj
      TextField ".OutAttribute"
         Definition
            InitialText ""
            Origin 610,61
            Size 1,1
            MaxFieldLength 32
         EndScript
      EndObj
      TextField ".Number"
         Definition
            InitialText ""
            Origin 615,61
            Size 1,1
            MaxFieldLength 32
         EndScript
      EndObj
      TextField ".Name"
         Definition
            InitialText ""
            Origin 615,61
            Size 1,1
            MaxFieldLength 32
         EndScript
      EndObj
      TextField ".CrossRef"
         Definition
            InitialText ""
            Origin 615,61
            Size 1,1
            MaxFieldLength 32
         EndScript
      EndObj
      TextField ".Notes"
         Definition
            InitialText ""
            Origin 615,61
            Size 1,1
            MaxFieldLength 32
         EndScript
      EndObj
      List "InRecord"
         Definition
            ListDocument "InputRecord"
            Origin 168,58
            Size 459,161
            Border INVERT BEVEL 
            Label "DBase Record:",ABOVE 
            Font "topaz",8
            TextColors 1,0,JAM2 
            Style PLAIN ,2,3
         EndScript
      EndObj
   EndObj
   Card "ReportMakerCard"
      NoAttach
      Routine "ClearReportMenu"
         SetObjectState "UserRequirements",FALSE
         SetObjectState "TechnicalNotes",FALSE
         SetObjectState "CST",FALSE
         SetObjectState "CDE",FALSE
         SetObjectState "IST",FALSE
         SetObjectState "IDE",FALSE
         SetObjectState "OCT",FALSE
         SetObjectState "STT",FALSE
         SetObjectState "BDE",FALSE
         SetObjectState "PDE",FALSE
         SetObjectState "PROC",FALSE
         SetObjectState "RTM",FALSE
         SetObjectState "Objects",FALSE
      EndScript
      Routine "SetupPrinter"
         Local buf  ;SetupPrinter, buffer  SubRoutine.
         Local PR
         Let buf  = TrimString( Arg1 )
         If FindChars( PrinterReset, "^", 1 ) <> 0      ;Send PrinterReset
            FileWriteChars buf,Char( 27  )            ;Send <ESC> char
            Let PR = RemoveChars( PrinterReset, 1, 1 )
            FileWriteChars buf,PR
         EndIf
         If ObjectState( "LetterQuality" ) = TRUE       ;Send NLQOn cmd
            If FindChars( NLQON, "^", 1 ) <> 0
               FileWriteChars buf,Char( 27 )         ;Send <ESC> char
               Let PR = RemoveChars( NLQON, 1, 1 )
               FileWriteChars buf,PR
            EndIf
         ElseIf ObjectState( "NLQOff" ) = TRUE          ;Send NLQOff cmd
            If FindChars( NLQOFF, "^", 1 ) <> 0
               FileWriteChars buf,Char( 27 )         ;Send <ESC> char
               Let PR = RemoveChars( NLQOFF, 1, 1 )
               FileWriteChars buf,PR
            EndIf
         EndIf
         If FindChars( TypeSize, "^", 1 ) <> 0      ;Set Type size.
            FileWriteChars buf,Char( 27 )         ;Send <ESC> char
            Let PR = RemoveChars( TypeSize, 1, 1 )
            FileWriteChars buf,PR
         EndIf
      EndScript
      Routine "PrintToSER"
         Local maxline      ;PrintToSER  subroutine.
         Local index
         Local linecount
         Local size
         Local sizeofpage
         Local workline
         Local title
         SetFileBufferSize 8
         Let title = WindowTitle
         SetWindowTitle "Printing to SER:..."
         OpenFile "SER:","OutBuffer",WRITEONLY ,NEWFILE 
         WorkWithDocument "TempList"
         Clear DOCUMENT 
         WorkWithDocument "Report"
         MoveCursorTo STARTOF DOCUMENT 
         If PageSize > (LinesInDocument + 6)
            Let sizeofpage = LinesInDocument + 6
         Else
            Let sizeofpage = PageSize
         EndIf
         Let maxline = LinesInDocument
         Do "SetupPrinter","OutBuffer"  ;Send Reset & NLQ on or off.
         Let index   = 0
         While index < maxline
            Let linecount = 1
            While linecount < sizeofpage
               WorkWithDocument "Report"
               MoveCursorTo STARTOF LINE 
               Let size = NumberOfChars( TheLine )
               Let workline = TheLine
               WorkWithDocument "TempList"
               If size >= LineLength
                  Type GetChars( workline, 1, LineLength ),NEWLINE 
               Else
                  Type workline,NEWLINE 
               EndIf
               WorkWithDocument "Report"
               If FindChars( TheLine, "END OF REPORT!", 1 ) > 0
                  Do "SendTempListToFile","OutBuffer",sizeofpage - 6
                  Close "OutBuffer"
                  SetWindowTitle title
                  ExitScript
               EndIf
               MoveCursor DOWN 
               Let linecount = linecount + 1
            EndLoop
            Let index = index + linecount
         EndLoop
         Do "SendTempListToFile","OutBuffer"
         Close "OutBuffer"
         SetWindowTitle title
      EndScript
      Routine "PrintToPAR"
         Local maxline      ;PrintToPar subroutine.
         Local title
         Local index
         Local linecount
         Local size
         Local sizeofpage
         Local workline
         Let title = WindowTitle
         If LineLength < 80
            Let LineLength = 80
         EndIf
         SetFileBufferSize 8
         SetWindowTitle "Printing to PAR:..."
         OpenFile "PAR:","OutBuffer",WRITEONLY ,NEWFILE 
         WorkWithDocument "TempList"
         Clear DOCUMENT 
         WorkWithDocument "Report"
         MoveCursorTo STARTOF DOCUMENT 
         If PageSize > (LinesInDocument + 6)
            Let sizeofpage = LinesInDocument + 6
         Else
            Let sizeofpage = PageSize
         EndIf
         Let maxline = LinesInDocument
         Do "SetupPrinter","OutBuffer"  ;Send Reset & NLQ on or off.
         Let index   = 0
         While index < maxline
            Let linecount = 1
            While linecount < sizeofpage
               WorkWithDocument "Report"
               MoveCursorTo STARTOF LINE 
               Let size = NumberOfChars( TheLine )
               Let workline = TheLine
               WorkWithDocument "TempList"
               If size >= LineLength
                  Type GetChars( workline, 1, LineLength ),NEWLINE 
               Else
                  Type workline,NEWLINE 
               EndIf
               WorkWithDocument "Report"
               If FindChars( TheLine, "END OF REPORT!", 1 ) > 0
                  Do "SendTempListToFile","OutBuffer",sizeofpage - 6
                  Close "OutBuffer"
                  SetWindowTitle title
                  ExitScript
               EndIf
               MoveCursor DOWN 
               Let linecount = linecount + 1
            EndLoop
            Let index = index + linecount
         EndLoop
         Do "SendTempListToFile","OutBuffer"
         Close "OutBuffer"
         SetWindowTitle title
      EndScript
      Routine "FileReport"
         Local maxline      ;FileReport subroutine.
         Local index
         Local filename
         Local linecount
         Local size
         Local sizeofpage
         Local workline
         Local title
         Let title = WindowTitle
         Let filename = AskForFileName( StartupPath, "Save a Report!", 10, 10 )
         SetFileBufferSize 8
         If filename = NOTHING
            ExitScript
         EndIf
         SetWindowTitle "Printing to "||filename||"..."
         OpenFile filename,"OutBuffer",WRITEONLY ,NEWFILE 
         WorkWithDocument "TempList"
         Clear DOCUMENT 
         WorkWithDocument "Report"
         MoveCursorTo STARTOF DOCUMENT 
         If PageSize > (LinesInDocument + 6)
            Let sizeofpage = LinesInDocument + 6   ;Less than a Page!
         Else
            Let sizeofpage = PageSize
         EndIf
         Let maxline = LinesInDocument
         Let index   = 0
         While index < maxline
            Let linecount = 1
            While linecount < sizeofpage
               WorkWithDocument "Report"
               MoveCursorTo STARTOF LINE 
               Let size = NumberOfChars( TheLine )
               Let workline = TheLine
               WorkWithDocument "TempList"
               If size >= LineLength
                  Type GetChars( workline, 1, LineLength ),NEWLINE 
               Else
                  Type workline,NEWLINE 
               EndIf
               WorkWithDocument "Report"
               If FindChars( TheLine, "END OF REPORT!", 1 ) > 0
                  Do "SendTempListToFile","OutBuffer",sizeofpage - 6
                  Close "OutBuffer"
                  SetWindowTitle title
                  ExitScript
               EndIf
               MoveCursor DOWN 
               Let linecount = linecount + 1
            EndLoop
            Let index = index + linecount
         EndLoop
         Do "SendTempListToFile","OutBuffer"
         Close "OutBuffer"
         SetWindowTitle title
      EndScript
      Routine "SetMenuItem"
         If UpperCase( Arg1 ) = "UR"    ;SetMenuItem for ReportMakerCard
            SetObjectState "UserRequirements",TRUE
         ElseIf UpperCase( Arg1 ) = "URTN"
            SetObjectState "TechnicalNotes",TRUE
         ElseIf UpperCase( Arg1 ) = "CST"
            SetObjectState "CST",TRUE
         ElseIf UpperCase( Arg1 ) = "CDE"
            SetObjectState "CDE",TRUE
         ElseIf UpperCase( Arg1 ) = "IST"
            SetObjectState "IST",TRUE
         ElseIf UpperCase( Arg1 ) = "IDE"
            SetObjectState "IDE",TRUE
         ElseIf UpperCase( Arg1 ) = "OCT"
            SetObjectState "OCT",TRUE
         ElseIf UpperCase( Arg1 ) = "STT"
            SetObjectState "STT",TRUE
         ElseIf UpperCase( Arg1 ) = "BDE"
            SetObjectState "BDE",TRUE
         ElseIf UpperCase( Arg1 ) = "PDE"
            SetObjectState "PDE",TRUE
         ElseIf UpperCase( Arg1 ) = "PROC"
            SetObjectState "PROC",TRUE
         ElseIf UpperCase( Arg1 ) = "RTM"
            SetObjectState "RTM",TRUE
         ElseIf UpperCase( Arg1 ) = "OBJ"
            SetObjectState "Objects",TRUE
         EndIf
      EndScript
      Routine "ParseReportConfig"
         Local temp
         Local delimiter
         Local menu_item
         Local safety
         Let temp = TrimString( ReportConfig )||"|"
         Let safety = 1
         While NumberOfChars( temp ) > 0 AND safety < 17
            Let delimiter = FindChars( temp, "|", 2 )
            Let menu_item = GetChars( temp, 1, delimiter - 1 )
            Let temp      = RemoveChars( temp, 1, delimiter )
            Do "SetMenuItem",menu_item
            Let safety = safety + 1
         EndLoop
      EndScript
      Routine "PreviewReport"
         ; ------------------------------------------
         ; PreviewReport() subroutine.
         ; ------------------------------------------
         
         Local index
         Let index = 0
         
         WorkWithDocument "Report"
         Clear DOCUMENT 
         
         Type "",NEWLINE 
         Type "",NEWLINE 
         Type "",NEWLINE 
         
         If ObjectState( "UserRequirements" ) = TRUE
            Type CenterString( " USER REQUIREMENTS: ", LineLength,"*" ),NEWLINE 
            Type CenterString( "-",LineLength,"-" ),NEWLINE 
            Do "SetupRequirements"
            WorkWithDocument "Report"
            InsertDocument "RequirementsList",1
            Type "",NEWLINE 
         EndIf
         
         If ObjectState( "CST" ) = TRUE
            Type CenterString( "-",LineLength,"-" ),NEWLINE 
            Type CenterString( " CONTEXT SYSTEM TABLE: ", LineLength,"*" ),NEWLINE 
            Type CenterString( "-",LineLength,"-" ),NEWLINE 
            Do "SetupCST"
            WorkWithDocument "Report"
            InsertDocument "CSTable",1
            Type "",NEWLINE 
         EndIf
         
         If ObjectState( "CDE" ) = TRUE
            Type CenterString( "-",LineLength,"-" ),NEWLINE 
            Type CenterString( " CONTEXT DESCRIPTIVE ENTRY(S): ", LineLength,"*" ),NEWLINE 
            Type CenterString( "-",LineLength,"-" ),NEWLINE 
            Do "SetupCDE"
            WorkWithDocument "Report"
            InsertDocument "CDEList",1
            Type "",NEWLINE 
         EndIf
         
         If ObjectState( "IST" ) = TRUE
            Type CenterString( "-",LineLength,"-" ),NEWLINE 
            Type CenterString( " INFORMATION STRUCTURE TABLE: ", LineLength,"*" ),NEWLINE 
            Type CenterString( "-",LineLength,"-" ),NEWLINE 
            Do "SetupIST"
            WorkWithDocument "Report"
            InsertDocument "IST_List",1
            Type "",NEWLINE 
         EndIf
         
         If ObjectState( "IDE" ) = TRUE
            Type CenterString( "-",LineLength,"-" ),NEWLINE 
            Type CenterString( " INFORMATION DESCRIPTIVE ENTRY(S): ", LineLength,"*" ),NEWLINE 
            Type CenterString( "-",LineLength,"-" ),NEWLINE 
            Do "SetupIDE"
            WorkWithDocument "Report"
            InsertDocument "IDTable",1
            Type "",NEWLINE 
         EndIf
         
         If ObjectState( "OCT" ) = TRUE
            Type CenterString( "-",LineLength,"-" ),NEWLINE 
            Type CenterString( " OBJECT COMMUNICATION TABLE: ", LineLength,"*" ),NEWLINE 
            Type CenterString( "-",LineLength,"-" ),NEWLINE 
            Do "SetupOCT"
            WorkWithDocument "Report"
            InsertDocument "OCTable",1
            Type "",NEWLINE 
         EndIf
         
         If ObjectState( "STT" ) = TRUE
            Type CenterString( "-",LineLength,"-" ),NEWLINE 
            Type CenterString( " STATE TRANSITION TABLE: ", LineLength,"*" ),NEWLINE 
            Type CenterString( "-",LineLength,"-" ),NEWLINE 
            Do "SetupSTT"
            WorkWithDocument "Report"
            InsertDocument "STTTable",1
            Type "",NEWLINE 
         EndIf
         
         If ObjectState( "BDE" ) = TRUE
            Type CenterString( "-",LineLength,"-" ),NEWLINE 
            Type CenterString( " BEHAVIOR DESCRIPTIVE ENTRY(S): ", LineLength,"*" ),NEWLINE 
            Type CenterString( "-",LineLength,"-" ),NEWLINE 
            Do "SetupBDE"
            WorkWithDocument "Report"
            InsertDocument "ThreadsList",1
            Type "",NEWLINE 
         EndIf
         
         If ObjectState( "PDE" ) = TRUE
            Type CenterString( "-",LineLength,"-" ),NEWLINE 
            Type CenterString( " PROCESS DESCRIPTIVE ENTRY(S): ", LineLength,"*" ),NEWLINE 
            Type CenterString( "-",LineLength,"-" ),NEWLINE 
            Do "SetupPDE"
            WorkWithDocument "Report"
            InsertDocument "PDEntry",1
            Type "",NEWLINE 
         EndIf
         
         If ObjectState( "PROC" ) = TRUE
            Type CenterString( "-",LineLength,"-" ),NEWLINE 
            Do "SetupProcess"
            WorkWithDocument "Report"
            InsertDocument "ProcessList",1
            Type "",NEWLINE 
         EndIf
         
         If ObjectState( "RTM" ) = TRUE
            Type CenterString( "-",LineLength,"-" ),NEWLINE 
            Type CenterString( " REQUIREMENTS TRACEABILITY MATRIX: ", LineLength,"*" ),NEWLINE 
            Type CenterString( "-",LineLength,"-" ),NEWLINE 
            Do "SetupRTM"
            WorkWithDocument "Report"
            InsertDocument "RTMTable",1
         EndIf
         
         If ObjectState( "TechnicalNotes" ) = TRUE
            Type CenterString( "-",LineLength,"-" ),NEWLINE 
            Type CenterString( " TECHNICAL NOTES: ", LineLength,"*" ),NEWLINE 
            Type CenterString( "-",LineLength,"-" ),NEWLINE 
            Do "SetupTechNotes"
            WorkWithDocument "Report"
            InsertDocument "UserNoteMemo",1
         EndIf
         
         If ObjectState( "Objects" ) = TRUE
            Type CenterString( "-",LineLength,"-" ),NEWLINE 
            Type CenterString( " SYSTEM OBJECTS: ", LineLength,"*" ),NEWLINE 
            Type CenterString( "-",LineLength,"-" ),NEWLINE 
            Do "SetupObjectList"
            WorkWithDocument "Report"
            InsertDocument "ObjectList",1
         EndIf
         
         Type "",NEWLINE 
         Type CenterString( " END OF REPORT! ",LineLength,"-" ),NEWLINE 
         MoveCursorTo STARTOF DOCUMENT 
      EndScript
      AfterAttachment
         SetWindowTitle WTTL[2]
         
         Let FirstString = PrinterReset
         
         Do "SetUpColors"
      EndScript
      Window "UserWindow"
         Definition
            Origin 0,16
            Title "View & Print Report(s)"
            WindowObjects CLOSEBUTTON 
            Size 640,380
            WindowFlags ACTIVATE TOFRONT WORKBENCH 
            VisualEffects NONE ,WAIT 
         EndScript
         OnActivated
            Do "SetUpColors"
            Do "ParseReportConfig"
            
         EndScript
         OnCloseButton
            GotoCard "MainCard"
         EndScript
      EndObj
      Memo "ReportDisplay"
         Definition
            MemoDocument "Report"
            ScrollBars RIGHT BOTTOM 
            Origin 9,35
            Size 619,300
            Border BEVEL 
            Label "Report:",ABOVE 
            Font "topaz",8
            TextColors 1,0,JAM1 
            Style PLAIN ,2,3
         EndScript
      EndObj
      TextMenu "Preview"
         Definition
            AttachTo MENU ,"PROJECT    "
            Text "Preview"
         EndScript
         Occurred
            SetPen 8
            PrintText "Creating Report, please wait...",190,339
            
            Do "PreviewReport"
            Delay 0,1,0
            
            SetPen 0
            PrintText "Creating Report, please wait...",190,339
            
         EndScript
      EndObj
      TextMenu "Print"
         Definition
            AttachTo MENU ,"PROJECT    "
            Text "Print "
         EndScript
      EndObj
      AKey "HelpKey"
         Definition
            QualifiersPressed NONE 
            KeyPressed HELP 
         EndScript
         OnUp
            Dos HelpViewer|||HelpPath||"GOOSA.guide ReportMakerCard"
            
         EndScript
      EndObj
      TextField "SearchString"
         Definition
            InitialText "String to Search For..."
            Origin 97,358
            Size 190,12
            Border DOUBLEBEVEL 
            Label "Search for:"
            Justification CENTER 
            MaxFieldLength 256
            Font "topaz",8
         EndScript
         OnClick
            SetText "SearchString",""
         EndScript
      EndObj
      TextField "ReplaceString"
         Definition
            InitialText "Replacement String..."
            Origin 438,358
            Size 190,12
            Border DOUBLEBEVEL 
            Label "Replace with:"
            Justification CENTER 
            MaxFieldLength 256
            Font "topaz",8
         EndScript
         OnClick
            SetText "ReplaceString",""
         EndScript
      EndObj
      TextMenu "Reset"
         Definition
            AttachTo MENU ,"PROJECT    "
            Text "Reset Report Menu"
            ShortCutKey "R"
         EndScript
         Occurred
            Do "ClearReportMenu"
            Do "ParseReportConfig"
         EndScript
      EndObj
      TextMenu "Clear"
         Definition
            AttachTo MENU ,"PROJECT    "
            Text "Clear Report Menu"
            ShortCutKey "C"
         EndScript
         Occurred
            Do "ClearReportMenu"
         EndScript
      EndObj
      TextMenu "Search"
         Definition
            AttachTo MENU ,"EDITOR"
            Text "Search "
         EndScript
      EndObj
      TextMenu "Replace"
         Definition
            AttachTo MENU ,"EDITOR"
            Text "Replace "
         EndScript
      EndObj
      TextMenu "ReplaceAll"
         Definition
            AttachTo MENU ,"EDITOR"
            Text "Replace All "
         EndScript
      EndObj
      ImageMenu "VPRSep1"
         Definition
            AttachTo MENU ,"EDITOR"
            BarImage
         EndScript
      EndObj
      TextMenu "Top"
         Definition
            AttachTo MENU ,"EDITOR"
            Text "Top of Report"
            ShortCutKey "T"
         EndScript
         Occurred
            WorkWithDocument "Report"
            MoveCursorTo STARTOF DOCUMENT 
         EndScript
      EndObj
      TextMenu "Bottom"
         Definition
            AttachTo MENU ,"EDITOR"
            Text "Bottom of Report"
            ShortCutKey "B"
         EndScript
         Occurred
            WorkWithDocument "Report"
            MoveCursorTo ENDOF DOCUMENT 
         EndScript
      EndObj
      TextMenu "Next"
         Definition
            AttachTo MENU ,"EDITOR"
            Text "Next Page"
            ShortCutKey "N"
         EndScript
         Occurred
            Local index
            Let index = 0
            WorkWithDocument "Report"
            While index < 34
               MoveCursor DOWN 
               Let index = index + 1
            EndLoop
         EndScript
      EndObj
      TextMenu "Prev"
         Definition
            AttachTo MENU ,"EDITOR"
            Text "Prev Page"
            ShortCutKey "P"
         EndScript
         Occurred
            Local index
            Let index = 0
            WorkWithDocument "Report"
            While index < 34
               MoveCursor UP 
               Let index = index + 1
            EndLoop
         EndScript
      EndObj
      TextMenu "Delete"
         Definition
            AttachTo MENU ,"EDITOR"
            Text "Delete to EOL"
            ShortCutKey "Y"
         EndScript
         Occurred
            Delete TOENDOFLINE 
         EndScript
      EndObj
      TextMenu "Kill"
         Definition
            AttachTo MENU ,"EDITOR"
            Text "Delete Line"
            ShortCutKey "K"
         EndScript
         Occurred
            Delete LINE 
         EndScript
      EndObj
      TextMenu "UserRequirements"
         Definition
            AttachTo MENU ,"REPORT(S)"
            Text "User Requirements"
            MenuFlags CHECKABLE 
         EndScript
      EndObj
      TextMenu "RTM"
         Definition
            AttachTo MENU ,"REPORT(S)"
            Text "Req's Traceability Matrix"
            MenuFlags CHECKABLE 
         EndScript
      EndObj
      TextMenu "Objects"
         Definition
            AttachTo MENU ,"REPORT(S)"
            Text "List System Objects"
            MenuFlags CHECKABLE 
         EndScript
      EndObj
      TextMenu "TechnicalNotes"
         Definition
            AttachTo MENU ,"REPORT(S)"
            Text "Technical Notes"
            MenuFlags CHECKABLE 
         EndScript
      EndObj
      TextMenu "ContextModel"
         Definition
            AttachTo MENU ,"REPORT(S)"
            Text "Context     Model "
         EndScript
      EndObj
      TextMenu "CST"
         Definition
            AttachTo OBJECT ,"ContextModel"
            Text "Context System Table"
            MenuFlags CHECKABLE 
         EndScript
      EndObj
      TextMenu "CDE"
         Definition
            AttachTo OBJECT ,"ContextModel"
            Text "Context Descrip' Entry"
            MenuFlags CHECKABLE 
         EndScript
      EndObj
      TextMenu "InformationModel"
         Definition
            AttachTo MENU ,"REPORT(S)"
            Text "Information Model "
         EndScript
      EndObj
      TextMenu "IST"
         Definition
            AttachTo OBJECT ,"InformationModel"
            Text "Information Structure Table"
            MenuFlags CHECKABLE 
         EndScript
      EndObj
      TextMenu "IDE"
         Definition
            AttachTo OBJECT ,"InformationModel"
            Text "Information Descrip' Entry"
            MenuFlags CHECKABLE 
         EndScript
      EndObj
      TextMenu "BehaviorModel"
         Definition
            AttachTo MENU ,"REPORT(S)"
            Text "Behavior    Model "
         EndScript
      EndObj
      TextMenu "OCT"
         Definition
            AttachTo OBJECT ,"BehaviorModel"
            Text "Object Communication Table"
            MenuFlags CHECKABLE 
         EndScript
      EndObj
      TextMenu "STT"
         Definition
            AttachTo OBJECT ,"BehaviorModel"
            Text "State Transition Table"
            MenuFlags CHECKABLE 
         EndScript
      EndObj
      TextMenu "BDE"
         Definition
            AttachTo OBJECT ,"BehaviorModel"
            Text "Behavior Descrip' Entry"
            MenuFlags CHECKABLE 
         EndScript
      EndObj
      TextMenu "PDE"
         Definition
            AttachTo OBJECT ,"BehaviorModel"
            Text "Process Descrip' Entry"
            MenuFlags CHECKABLE 
         EndScript
      EndObj
      TextMenu "PROC"
         Definition
            AttachTo OBJECT ,"BehaviorModel"
            Text "Processes"
            MenuFlags CHECKABLE 
         EndScript
      EndObj
      TextMenu "WholeWord"
         Definition
            AttachTo OBJECT ,"Search"
            Text "By Whole Word"
         EndScript
         Occurred
            WorkWithDocument "Report"
            MoveCursorTo STARTOF DOCUMENT 
            SearchFor TextFrom( "SearchString" ),BYWORD 
         EndScript
      EndObj
      TextMenu "Whole_Ignore"
         Definition
            AttachTo OBJECT ,"Search"
            Text "By Whole Word, Ignore Case"
         EndScript
         Occurred
            WorkWithDocument "Report"
            MoveCursorTo STARTOF DOCUMENT 
            SearchFor TextFrom( "SearchString" ),BYWORD NOCASE 
         EndScript
      EndObj
      TextMenu "IgnoreCase"
         Definition
            AttachTo OBJECT ,"Search"
            Text "Ignore Case only!"
         EndScript
         Occurred
            WorkWithDocument "Report"
            MoveCursorTo STARTOF DOCUMENT 
            SearchFor TextFrom( "SearchString" ),NOCASE 
         EndScript
      EndObj
      TextMenu "DefaultSearch"
         Definition
            AttachTo OBJECT ,"Search"
            Text "Default"
         EndScript
         Occurred
            WorkWithDocument "Report"
            MoveCursorTo STARTOF DOCUMENT 
            SearchFor TextFrom( "SearchString" )
         EndScript
      EndObj
      TextMenu "Whole_Replace"
         Definition
            AttachTo OBJECT ,"Replace"
            Text "By Whole Word"
         EndScript
         Occurred
            WorkWithDocument "Report"
            Replace TextFrom( "SearchString" ),TextFrom( "ReplaceString" ),BYWORD 
         EndScript
      EndObj
      TextMenu "Whole_Ignore_Replace"
         Definition
            AttachTo OBJECT ,"Replace"
            Text "By Whole Word, Ignore Case"
         EndScript
         Occurred
            WorkWithDocument "Report"
            Replace TextFrom( "SearchString" ),TextFrom( "ReplaceString" ),BYWORD NOCASE 
         EndScript
      EndObj
      TextMenu "Ignore_Replace"
         Definition
            AttachTo OBJECT ,"Replace"
            Text "Ignore Case only!"
         EndScript
         Occurred
            WorkWithDocument "Report"
            Replace TextFrom( "SearchString" ),TextFrom( "ReplaceString" ),NOCASE 
         EndScript
      EndObj
      TextMenu "Default_Replace"
         Definition
            AttachTo OBJECT ,"Replace"
            Text "Default"
         EndScript
         Occurred
            WorkWithDocument "Report"
            Replace TextFrom( "SearchString" ),TextFrom( "ReplaceString" )
         EndScript
      EndObj
      TextMenu "RA_WholeWord"
         Definition
            AttachTo OBJECT ,"ReplaceAll"
            Text "By Whole Word"
         EndScript
         Occurred
            WorkWithDocument "Report"
            MoveCursorTo STARTOF DOCUMENT 
            Replace TextFrom( "SearchString" ),TextFrom( "ReplaceString" ),BYWORD GLOBAL 
         EndScript
      EndObj
      TextMenu "RA_WholeIgnore"
         Definition
            AttachTo OBJECT ,"ReplaceAll"
            Text "By Whole Word, Ignore Case"
         EndScript
         Occurred
            WorkWithDocument "Report"
            MoveCursorTo STARTOF DOCUMENT 
            Replace TextFrom( "SearchString" ),TextFrom( "ReplaceString" ),BYWORD NOCASE GLOBAL 
         EndScript
      EndObj
      TextMenu "RA_Ignore"
         Definition
            AttachTo OBJECT ,"ReplaceAll"
            Text "Ignore Case only!"
         EndScript
         Occurred
            WorkWithDocument "Report"
            MoveCursorTo STARTOF DOCUMENT 
            Replace TextFrom( "SearchString" ),TextFrom( "ReplaceString" ),NOCASE GLOBAL 
         EndScript
      EndObj
      TextMenu "RA_Default"
         Definition
            AttachTo OBJECT ,"ReplaceAll"
            Text "Default"
         EndScript
         Occurred
            WorkWithDocument "Report"
            MoveCursorTo STARTOF DOCUMENT 
            Replace TextFrom( "SearchString" ),TextFrom( "ReplaceString" ),GLOBAL 
         EndScript
      EndObj
      TextMenu "LetterQuality"
         Definition
            AttachTo OBJECT ,"Print"
            Text "NLQ on"
            MenuFlags CHECKABLE 
         EndScript
         Occurred
            Let FirstString = PrinterReset||NLQON
         EndScript
      EndObj
      TextMenu "NLQOff"
         Definition
            AttachTo OBJECT ,"Print"
            Text "NLQ off"
            MenuFlags CHECKABLE 
         EndScript
         Occurred
            Let FirstString = PrinterReset||NLQOFF
         EndScript
      EndObj
      ImageMenu "PrSep1"
         Definition
            AttachTo OBJECT ,"Print"
            BarImage
         EndScript
      EndObj
      TextMenu "ToFile"
         Definition
            AttachTo OBJECT ,"Print"
            Text "To File"
         EndScript
         Occurred
            Do "FileReport"
         EndScript
      EndObj
      TextMenu "ToPar"
         Definition
            AttachTo OBJECT ,"Print"
            Text "To Parallel (Printer) Port "
         EndScript
         Occurred
            Do "PrintToPAR"
         EndScript
      EndObj
      TextMenu "ToSer"
         Definition
            AttachTo OBJECT ,"Print"
            Text "To Serial (Printer) Port "
         EndScript
         Occurred
            Do "PrintToSER"
         EndScript
      EndObj
      AKey "TabKey"
         Definition
            QualifiersPressed NONE 
            KeyPressed TAB 
         EndScript
         OnUp
            Do "DoA_TabKey"
         EndScript
      EndObj
      ErrorTrap "UserError_1"
         Occurred
            Do "HandleInternalError"
         EndScript
      EndObj
   EndObj
   Card "EditToolTypes"
      NoAttach
      Routine "DisplayCapability"
         SetDBObjects Capability[C_Cap]      ;Display subroutine.
         SetWindowTitle "Define System Capability:  Entry #: "||C_Cap+1
      EndScript
      Routine "SetupDisplay"
         ; ---------------------------------------------------
         ; Setupdisplay() Subroutine - EditToolTypes Card.
         ; ---------------------------------------------------
         
         Do "SetUpColors"
         
         WorkWithDocument "ToolTypesList"
         Clear DOCUMENT 
         InsertToolTypeList "GOOSA"
         MoveCursorTo STARTOF DOCUMENT 
      EndScript
      AfterAttachment
         SetWindowTitle WTTL[3]
         
         Do "SetUpColors"
      EndScript
      Routine "LoadIconInfo"
         ; ----------------------------------
         ; LoadIconInfo() SubRoutine
         ; ----------------------------------
         
         Local filename
         Local dot
         
         SetFileRequestPattern "#?","#?.info"
         
         Let filename = AskForFileName( StartupPath, "Load the Icon...",10,12 )
         
         If FindChars( filename, ".info", 1 ) > 0
            Let dot      = FindChars( filename, ".info", 1 )
            Let filename = GetChars( filename, dot - 5, NumberOfChars( filename )-dot+1 )
            
            WorkWithDocument "ToolTypesList"
            Clear DOCUMENT 
            
            LoadIcon filename
            InsertToolTypeList "GOOSA"
         Else
            SetWindowTitle "File Name is NOT "||DeckName||".info!!"
            Delay 0,4,0
         EndIf
         
         SetWindowTitle WTTL[3]
      EndScript
      Routine "SaveToolTypes"
         ; -------------------------------
         ; SaveToolTypes() subroutine.
         ; -------------------------------
         
         WorkWithDocument "ToolTypesList"
         
         If LinesInDocument >= 1
            SetToolTypeList "GOOSA","ToolTypesList"
            SaveIcon "GOOSA",StartupPath||"GOOSA"
         Else
            SetWindowTitle "WARNING: Tool Types List is empty, saving anyway!"
            Delay 0,3,0
            
            SetToolTypeList "GOOSA","ToolTypesList"
            SaveIcon "GOOSA",StartupPath||"GOOSA"
            
            SetWindowTitle WTTL[3]
         EndIf
      EndScript
      Routine "Check_SaveToolTypes"
         ; ----------------------------------
         ; Check_SaveToolTypes() SubRoutine.
         ; ----------------------------------
         
         Local ttl
         Local ans
         Local msg
         
         Let ttl = "User WARNING:"
         Let msg = "Any changes you've made have to be saved to be"||Char(10)
         Let msg = msg||"made permanent, Should they be saved?"
         
         Let ans = AskForResponse( msg, ttl, "Save them!|NO!" )
         
         If ans = 2
            ExitScript
         EndIf
         
         Do "SaveToolTypes"
      EndScript
      Window "UserWindow"
         Definition
            Origin 30,16
            Title "Edit G.O.O.S.A. Tool Types:"
            WindowObjects CLOSEBUTTON DEPTHBUTTONS DRAGBAR 
            WindowLimits 250,15,640,480
            WindowZoom 0,13,250,15
            Size 545,230
            WindowFlags ACTIVATE TOFRONT WORKBENCH 
            VisualEffects NONE ,WAIT 
         EndScript
         OnCloseButton
            Do "Check_SaveToolTypes"
            
            GotoCard "MainCard"
            
         EndScript
         OnActivated
            Do "SetupDisplay"
         EndScript
         OnResized
            Do "SetupDisplay"
         EndScript
      EndObj
      AKey "HelpKey"
         Definition
            QualifiersPressed NONE 
            KeyPressed HELP 
         EndScript
         OnUp
            Dos HelpViewer|||HelpPath||"GOOSA.guide EditToolTypesCard"
            
         EndScript
      EndObj
      Memo "ToolList"
         Definition
            MemoDocument "ToolTypesList"
            ScrollBars RIGHT 
            Origin 10,35
            Size 526,185
            Border BEVEL 
            Label "Current ToolTypes:",ABOVE 
            Font "topaz",8
         EndScript
      EndObj
      TextMenu "Load"
         Definition
            AttachTo MENU ,"PROJECT  "
            Text "Load.."
            ShortCutKey "L"
         EndScript
         Occurred
            Do "LoadIconInfo"
            
         EndScript
      EndObj
      TextMenu "Save"
         Definition
            AttachTo MENU ,"PROJECT  "
            Text "Save"
            ShortCutKey "S"
         EndScript
         Occurred
            Do "SaveToolTypes"
         EndScript
      EndObj
      ErrorTrap "UserError_1"
         Occurred
            Do "HandleInternalError"
         EndScript
      EndObj
   EndObj
   Card "ARexxInterface"
      NoAttach
      Routine "SetupDisplay"
         ; -----------------------------------------
         ; SetupDisplay() Subroutine - ARexx Card.
         ; -----------------------------------------
         
         Do "SetUpColors"
         
      EndScript
      AfterAttachment
         SetWindowTitle WTTL[4]
         
         Do "SetupColors"
      EndScript
      Window "UserWindow"
         Definition
            Origin 0,16
            Title "ARexx  Interface"
            WindowObjects CLOSEBUTTON DEPTHBUTTONS DRAGBAR 
            WindowLimits 250,15,640,480
            WindowZoom 0,13,250,15
            Size 640,400
            WindowFlags ACTIVATE TOFRONT WORKBENCH 
            VisualEffects NONE ,WAIT 
         EndScript
         OnActivated
            Do "SetupDisplay"
            
         EndScript
         OnCloseButton
            GotoCard "MainCard"
         EndScript
         OnResized
            Do "SetupDisplay"
         EndScript
      EndObj
      TextField "CurrentPort"
         Definition
            InitialText ""
            Origin 140,20
            Size 333,12
            Border DOUBLEBEVEL 
            Label "Current Port:"
            MaxFieldLength 80
            Font "topaz",8
         EndScript
      EndObj
      List "Port_List"
         Definition
            ListDocument "ARexxPortList"
            Origin 10,69
            Size 428,153
            Border INVERT BEVEL 
            Label "ARexx Ports List:",ABOVE 
            Font "topaz",8
         EndScript
         OnClick
            Do "SetSpeakAddress"
         EndScript
      EndObj
      TextField "MessageField"
         Definition
            InitialText ""
            Origin 140,37
            Size 333,12
            Border DOUBLEBEVEL 
            Label "Send Message:"
            MaxFieldLength 80
            Font "topaz",8
         EndScript
      EndObj
      Memo "Result"
         Definition
            MemoDocument "ARexxResult"
            ScrollBars RIGHT 
            InputStyle LOCKEDOUT 
            Origin 9,245
            Size 285,150
            Border INVERT BEVEL 
            Label "ARexx Results:",ABOVE 
            Font "topaz",8
         EndScript
      EndObj
      Memo "Error"
         Definition
            MemoDocument "ARexxError"
            ScrollBars RIGHT 
            InputStyle LOCKEDOUT 
            Origin 309,245
            Size 285,150
            Border INVERT BEVEL 
            Label "ARexx Errors:",ABOVE 
            Font "topaz",8
         EndScript
      EndObj
      AreaButton "SendButton"
         Definition
            Origin 491,20
            Border EMBOSSED 
            Text "Send Message!"
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 8,0,JAM1 
            Size 108,14
         EndScript
         OnRelease
            Do "SendARexxMsg"
         EndScript
      EndObj
      AreaButton "RescanButton"
         Definition
            Origin 451,90
            Border EMBOSSED 
            Text "RESCAN!"
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 8,0,JAM1 
            Size 60,14
         EndScript
         OnRelease
            Do "SetARexxPortList"
         EndScript
      EndObj
      ErrorTrap "UserError_1"
         Occurred
            Do "HandleInternalError"
         EndScript
      EndObj
      AKey "HelpKey"
         Definition
            QualifiersPressed NONE 
            KeyPressed HELP 
         EndScript
         OnUp
            Let d = AskForHelp( HelpPath||"GOOSA.guide", "ARexxCard" )
            
         EndScript
      EndObj
      TextMenu "None"
         Definition
            AttachTo MENU ,"HELP_GOOSA"
            Text "No ARexx Commands yet!"
            Highlight NONE 
         EndScript
      EndObj
      TextMenu "Commands"
         Definition
            AttachTo MENU ,"HELP_DBASEMANAGER"
            Text "Commands for DBaseManager are:"
            Highlight NONE 
            Font "topaz",11
            Style PLAIN ,2,1
            TextColors 7,2,JAM1 
         EndScript
      EndObj
      ImageMenu "HDBSep1"
         Definition
            AttachTo MENU ,"HELP_DBASEMANAGER"
            BarImage
         EndScript
      EndObj
      TextMenu "Create"
         Definition
            AttachTo MENU ,"HELP_DBASEMANAGER"
            Text "CREATE 'filename'"
            Highlight NONE 
         EndScript
      EndObj
      TextMenu "Open"
         Definition
            AttachTo MENU ,"HELP_DBASEMANAGER"
            Text "OPEN 'filename'"
            Highlight NONE 
         EndScript
      EndObj
      TextMenu "Close"
         Definition
            AttachTo MENU ,"HELP_DBASEMANAGER"
            Text "CLOSE"
            Highlight NONE 
         EndScript
      EndObj
      TextMenu "Search"
         Definition
            AttachTo MENU ,"HELP_DBASEMANAGER"
            Text "SEARCH 'key' 'contents'"
            Highlight NONE 
         EndScript
      EndObj
      ImageMenu "HDBSep4"
         Definition
            AttachTo MENU ,"HELP_DBASEMANAGER"
            BarImage
         EndScript
      EndObj
      TextMenu "Write"
         Definition
            AttachTo MENU ,"HELP_DBASEMANAGER"
            Text "WRITE 'filename' attribcode [record #]"
            Highlight NONE 
         EndScript
      EndObj
      TextMenu "Read"
         Definition
            AttachTo MENU ,"HELP_DBASEMANAGER"
            Text "READ 'filename' attribcode identifier"
            Highlight NONE 
         EndScript
      EndObj
      TextMenu "Delete"
         Definition
            AttachTo MENU ,"HELP_DBASEMANAGER"
            Text "DELETE 'key'"
            Highlight NONE 
         EndScript
      EndObj
      TextMenu "UnDelete"
         Definition
            AttachTo MENU ,"HELP_DBASEMANAGER"
            Text "UNDELETE 'key'"
            Highlight NONE 
         EndScript
      EndObj
      ImageMenu "HDBSep2"
         Definition
            AttachTo MENU ,"HELP_DBASEMANAGER"
            BarImage
         EndScript
      EndObj
      TextMenu "Next"
         Definition
            AttachTo MENU ,"HELP_DBASEMANAGER"
            Text "NEXT"
            Highlight NONE 
         EndScript
      EndObj
      TextMenu "Prev"
         Definition
            AttachTo MENU ,"HELP_DBASEMANAGER"
            Text "PREV"
            Highlight NONE 
         EndScript
      EndObj
      TextMenu "First"
         Definition
            AttachTo MENU ,"HELP_DBASEMANAGER"
            Text "FIRST"
            Highlight NONE 
         EndScript
      EndObj
      TextMenu "Last"
         Definition
            AttachTo MENU ,"HELP_DBASEMANAGER"
            Text "LAST"
            Highlight NONE 
         EndScript
      EndObj
      ImageMenu "HDBSep3"
         Definition
            AttachTo MENU ,"HELP_DBASEMANAGER"
            BarImage
         EndScript
      EndObj
      TextMenu "Kill"
         Definition
            AttachTo MENU ,"HELP_DBASEMANAGER"
            Text "KILLDBASEMANAGER"
            Highlight NONE 
         EndScript
      EndObj
   EndObj
   Card "UserReqNotesCard"
      NoAttach
      Routine "PrintUReqsToSER"
         Local maxline      ;PrintUReqsToSER subroutine.
         Local index
         Local str
         Local linecount
         Local size
         Local sizeofpage
         Local workline
         SetFileBufferSize 8
         OpenFile "SER:","OutBuffer",WRITEONLY ,NEWFILE 
         WorkWithDocument "UserNoteMemo"
         MoveCursorTo STARTOF DOCUMENT 
         Let C_UReq = FirstArrayIndex( UReq )
         Do "DisplayUReq"
         While C_UReq <= LastArrayIndex( UReq )
            Let index   = 0
            While index < PageSize
               If index = 0
                  FileWriteLine "OutBuffer",""
                  FileWriteLine "OutBuffer",""
                  FileWriteLine "OutBuffer",""
                  Let index = 3
               EndIf
               If TextFrom( ".Name" ) = ""
                  FileWriteLine "OutBuffer",CenterString( "* END OF TECHNICAL NOTES! *",LineLength,"*" )
                  Close "OutBuffer"
                  ExitScript
               EndIf
               Let str = TrimString( TextFrom( ".Number" ) )||". "
               Let str = str||TrimString( TextFrom( ".Name" ) )||" CROSSREF:  "
               Let str = str||TrimString( TextFrom( ".CrossRef" ) )
               FileWriteLine "OutBuffer",str
               FileWriteLine "OutBuffer",""
               Let index = index + 2
               WorkWithDocument "TempList"
               Clear DOCUMENT 
               WorkWithDocument "UserNoteMemo"
               MoveCursorTo STARTOF DOCUMENT 
               Let linecount = 0
               While linecount < LinesInDocument
                  If index = PageSize - 3
                     FileWriteLine "OutBuffer",""      ;PageBreak!
                     FileWriteLine "OutBuffer",""
                     FileWriteLine "OutBuffer",""
                     FileWriteLine "OutBuffer",""
                     FileWriteLine "OutBuffer",""
                     FileWriteLine "OutBuffer",""
                     Let index = 3
                  EndIf
                  Let size = NumberOfChars( TheLine )
                  Let workline = TheLine
                  WorkWithDocument "TempList"
                  If size >= LineLength
                     Type GetChars( workline, 1, LineLength ),NEWLINE 
                     Type GetChars( workline, LineLength + 1,size - LineLength - 1),NEWLINE 
                     Let index = index + 2
                  Else
                     Type workline,NEWLINE 
                     Let index = index + 1
                  EndIf
                  WorkWithDocument "UserNoteMemo"
                  MoveCursor DOWN 
                  MoveCursorTo STARTOF LINE 
                  Let linecount = linecount + 1
               EndLoop
               Do "SendTempListToFile","OutBuffer"
               If index = PageSize - 3
                  FileWriteLine "OutBuffer",""
                  FileWriteLine "OutBuffer",""
                  FileWriteLine "OutBuffer",""
                  Let index = 0
               Else
                  FileWriteLine "OutBuffer",CenterString( "~",LineLength,"~" )
                  Let index  = index + 1
                  Let C_UReq = C_UReq + 1
                  Do "DisplayUReq"
               EndIf
            EndLoop
            Let C_UReq = C_UReq + 1
            Do "DisplayUReq"
         EndLoop
         FileWriteLine "OutBuffer",CenterString( "* END OF TECHNICAL NOTES! *",LineLength,"*" )
         Close "OutBuffer"
      EndScript
      Routine "PrintUReqs"
         Local maxline      ;PrintUReqs To File subroutine.
         Local index
         Local filename
         Local str
         Local linecount
         Local size
         Local sizeofpage
         Local workline
         Let filename = AskForFileName( StartupPath, "Save Tech' Notes in a file:", 10, 13 )
         SetFileBufferSize 8
         If filename = NOTHING
            Do "CorrectFileName"
         EndIf
         OpenFile filename,"OutBuffer",WRITEONLY ,NEWFILE 
         WorkWithDocument "UserNoteMemo"
         MoveCursorTo STARTOF DOCUMENT 
         Let C_UReq = FirstArrayIndex( UReq )
         Do "DisplayUReq"
         While C_UReq <= LastArrayIndex( UReq )
            Let index   = 0
            While index < PageSize
               If index = 0
                  FileWriteLine "OutBuffer",""
                  FileWriteLine "OutBuffer",""
                  FileWriteLine "OutBuffer",""
                  Let index = 3
               EndIf
               If TextFrom( ".Name" ) = ""
                  FileWriteLine "OutBuffer",CenterString( "* END OF TECHNICAL NOTES! *",LineLength,"*" )
                  Close "OutBuffer"
                  ExitScript
               EndIf
               Let str = TrimString( TextFrom( ".Number" ) )||". "
               Let str = str||TrimString( TextFrom( ".Name" ) )||" CROSSREF:  "
               Let str = str||TrimString( TextFrom( ".CrossRef" ) )
               FileWriteLine "OutBuffer",str
               FileWriteLine "OutBuffer",""
               Let index = index + 2
               WorkWithDocument "TempList"
               Clear DOCUMENT 
               WorkWithDocument "UserNoteMemo"
               MoveCursorTo STARTOF DOCUMENT 
               Let linecount = 0
               While linecount < LinesInDocument
                  If index = PageSize - 3
                     FileWriteLine "OutBuffer",""      ;PageBreak!
                     FileWriteLine "OutBuffer",""
                     FileWriteLine "OutBuffer",""
                     FileWriteLine "OutBuffer",""
                     FileWriteLine "OutBuffer",""
                     FileWriteLine "OutBuffer",""
                     Let index = 3
                  EndIf
                  Let size = NumberOfChars( TheLine )
                  Let workline = TheLine
                  WorkWithDocument "TempList"
                  If size >= LineLength
                     Type GetChars( workline, 1, LineLength ),NEWLINE 
                     Type GetChars( workline, LineLength + 1,size - LineLength - 1),NEWLINE 
                     Let index = index + 2
                  Else
                     Type workline,NEWLINE 
                     Let index = index + 1
                  EndIf
                  WorkWithDocument "UserNoteMemo"
                  MoveCursor DOWN 
                  MoveCursorTo STARTOF LINE 
                  Let linecount = linecount + 1
               EndLoop
               Do "SendTempListToFile","OutBuffer"
               If index = PageSize - 3
                  FileWriteLine "OutBuffer",""
                  FileWriteLine "OutBuffer",""
                  FileWriteLine "OutBuffer",""
                  Let index = 0
               Else
                  FileWriteLine "OutBuffer",CenterString( "~",LineLength,"~" )
                  Let index  = index + 1
                  Let C_UReq = C_UReq + 1
                  Do "DisplayUReq"
               EndIf
            EndLoop
            Let C_UReq = C_UReq + 1
            Do "DisplayUReq"
         EndLoop
         FileWriteLine "OutBuffer",CenterString( "* END OF TECHNICAL NOTES! *",LineLength,"*" )
         Close "OutBuffer"
      EndScript
      Routine "ReadInRequirementNotes"
         Local index                ;ReadInRequirementNotes
         Local LastRec
         Do "Send_Check","OpenDBase "||DefaultDBase
         Do "Send_Check","GetFileInfo"
         Let LastRec = MessageReturned
         Let index   = 1
         While index <= LastRec
            Do "Send_Check","GetRecord "||index
            Do "Send_Check","ReadField AttribCode"
            If MessageReturned = 18
               Do "AddToUReqNoteList"
            EndIf
            Let index = index + 1
         EndLoop
         Let GotUReqs = TRUE
         Do "Send_Check","CloseDBase "||DefaultDBase
      EndScript
      Routine "PrintUReqsToPAR"
         Local maxline      ;PrintUReqsToPAR subroutine.
         Local index
         Local str
         Local linecount
         Local howmanylines
         Local size
         Local sizeofpage
         Local workline
         SetFileBufferSize 8
         OpenFile "PAR:","OutBuffer",WRITEONLY ,NEWFILE 
         WorkWithDocument "UserNoteMemo"
         MoveCursorTo STARTOF DOCUMENT 
         Let C_UReq = FirstArrayIndex( UReq )
         Do "DisplayUReq"
         While C_UReq <= LastArrayIndex( UReq )
            Let index   = 0
            While index < PageSize
               If index = 0
                  FileWriteLine "OutBuffer",""  ;Header!
                  FileWriteLine "OutBuffer",""
                  FileWriteLine "OutBuffer",""
                  Let index = 3
               EndIf
               If TextFrom( ".Name" ) = ""
                  FileWriteLine "OutBuffer",CenterString( "* END OF TECHNICAL NOTES! *",LineLength,"*" )
                  Close "OutBuffer"
                  ExitScript
               EndIf
               Let str = TrimString( TextFrom( ".Number" ) )||". "
               Let str = str||TrimString( TextFrom( ".Name" ) )||" CROSSREF:  "
               Let str = str||TrimString( TextFrom( ".CrossRef" ) )
               FileWriteLine "OutBuffer",str
               FileWriteLine "OutBuffer",""
               Let index = index + 2
               WorkWithDocument "TempList"
               Clear DOCUMENT 
               WorkWithDocument "UserNoteMemo"
               MoveCursorTo STARTOF DOCUMENT 
               Let howmanylines = LinesInDocument
               Let linecount    = 0
               While linecount < howmanylines
                  If index = PageSize - 3
                     FileWriteLine "OutBuffer",""      ;PageBreak!
                     FileWriteLine "OutBuffer",""
                     FileWriteLine "OutBuffer",""
                     FileWriteLine "OutBuffer",""
                     FileWriteLine "OutBuffer",""
                     FileWriteLine "OutBuffer",""
                     Let index = 3
                  EndIf
                  Let size = NumberOfChars( TheLine )
                  Let workline = TheLine
                  WorkWithDocument "TempList"
                  If size >= LineLength
                     Type GetChars( workline, 1, LineLength ),NEWLINE 
                     Type GetChars( workline, LineLength + 1,size - LineLength - 1),NEWLINE 
                     Let index = index + 2
                  Else
                     Type workline,NEWLINE 
                     Let index = index + 1
                  EndIf
                  WorkWithDocument "UserNoteMemo"
                  MoveCursor DOWN 
                  MoveCursorTo STARTOF LINE 
                  Let linecount = linecount + 1
               EndLoop
               Do "SendTempListToFile","OutBuffer"
               If index = PageSize - 3
                  FileWriteLine "OutBuffer",""  ;Footer!
                  FileWriteLine "OutBuffer",""
                  FileWriteLine "OutBuffer",""
                  Let index = 0
               Else
                  FileWriteLine "OutBuffer",CenterString( "~",LineLength,"~" )
                  Let index  = index + 1
                  Let C_UReq = C_UReq + 1
                  Do "DisplayUReq"
               EndIf
            EndLoop
            Let C_UReq = C_UReq + 1
            Do "DisplayUReq"
         EndLoop
         FileWriteLine "OutBuffer",CenterString( "* END OF TECHNICAL NOTES! *",LineLength,"*" )
         Close "OutBuffer"
      EndScript
      Routine "AddToUReqNoteList"
         ; ----------------------------------
         ; AddToUReqNoteList() SubRoutine.
         ; ----------------------------------
         
         Local count
         
         Let count = 0 ;FirstUReq is zeroed in BeforeAttachment.
         
         While UReq[count].Name <> "" AND count < 32768
            Let count = count + 1
         EndLoop
         
         Let LastUReq = count
         Do "Send_Check","ReadField LongName1"
         
         Let UReq[count].Name = MessageReturned
         Do "Send_Check","ReadField ShortName1"
         
         Let UReq[count].Number = Integer( MessageReturned )
         Do "Send_Check","ReadField ShortName2"
         
         Let UReq[count].CrossRef = Integer( MessageReturned )
         Do "Send_Check","ReadField Memo1"
         
         Do "ReadUReqMemo","TempMemo1.txt",count
      EndScript
      Routine "DeleteUReq"
         ; -------------------------
         ; DeleteUReq() SubRoutine.
         ; -------------------------
         
         DeleteArrayEntry UReq,C_UReq
         
         If VarType( UReq[C_UReq] ) = "Nothing"
            Let C_UReq = LastArrayIndex( UReq )
         EndIf
         
         Do "DisplayUReq"
         Do "MakeNotesList"
         
      EndScript
      Routine "NextUReq"
         ; -----------------------
         ; NextUReq() SubRoutine.
         ; -----------------------
         
         Let UReq[C_UReq] = GetDBObjects
         
         Let C_UReq = NextArrayIndex( UReq, C_UReq )
         
         If NOT SearchFound
            Let C_UReq = FirstArrayIndex( UReq )
         EndIf
         
         Do "DisplayUReq"
         Do "HighlightNotesList"
      EndScript
      Routine "PrevUReq"
         ; -----------------------
         ; PrevUReq() SubRoutine.
         ; -----------------------
         
         Let UReq[C_UReq] = GetDBObjects
         
         Let C_UReq = PreviousArrayIndex( UReq, C_UReq )
         
         If NOT SearchFound
            Let C_UReq = LastArrayIndex( UReq )
         EndIf
         
         Do "DisplayUReq"
         Do "HighlightNotesList"
         
      EndScript
      Routine "HighlightNotesList"
         ; -----------------------------------
         ; HightlightNotesList() SubRoutine.
         ; -----------------------------------
         
         Local i
         Local num
         
         Let i = FirstArrayIndex( UReq )
         
         WorkWithDocument "NotesList"
         MoveCursorTo STARTOF DOCUMENT 
         Let num = TrimString( GetWord( TheLine, 1, ":" ))
         
         While i < LastArrayIndex( UReq )
            
            If TrimString( UReq[C_UReq].Number ) = num
               ExitLoop
            EndIf
            
            Let i = i + 1
            MoveCursor DOWN 
            Let num = TrimString( GetWord( TheLine, 1, ":" ))
         EndLoop
      EndScript
      Routine "AddUReq"
         ; -----------------------
         ; AddUReq() SubRoutine.
         ; -----------------------
         
         Local save
         
         Let UReq[C_UReq] = GetDBObjects
         Let save         = C_UReq
         
         If C_UReq < LastArrayIndex( UReq )
            Let C_UReq = C_UReq + 1
         Else
            Let C_UReq = LastArrayIndex( UReq )
         EndIf
         
         InsertArrayEntry UReq,C_UReq
         
         Let UReq[C_UReq].Name     = "COPY_"||UReq[save].Name
         Let UReq[C_UReq].CrossRef = "COPY_"||UReq[save].CrossRef
         Let UReq[C_UReq].Number   = UReq[save].Number||"_COPY"
         Let UReq[C_UReq].Notes    = "COPY_"||UReq[save].Notes
         
         Do "DisplayUReq"
         
         WorkWithDocument ".Notes"
         MoveCursorTo STARTOF DOCUMENT 
         Type "******* COPY! ***********",NEWLINE 
         
         MoveCursorTo STARTOF DOCUMENT 
         Do "MakeNotesList"
         Do "HighlightNotesList"
         
      EndScript
      Routine "MakeNotesList"
         ; -----------------------------
         ; MakeNotesList() SubRoutine.
         ; -----------------------------
         
         Local i
         
         Let i = FirstArrayIndex( UReq )
         
         WorkWithDocument "NotesList"
         Clear DOCUMENT 
         
         While i <= LastArrayIndex( UReq )
            
            If UReq[i].Name <> NOTHING
               Type UReq[i].Number||": "||UReq[i].Name,NEWLINE 
            EndIf
            
            Let i = i + 1
         EndLoop
         
         MoveCursorTo STARTOF DOCUMENT 
      EndScript
      Routine "LoadTechNotes"
         ; -----------------------------
         ; LoadTechNotes() SubRoutine.
         ; -----------------------------
         
         Local filename
         
         SetFileRequestMode REGULARMODE ,PATTERNFIELD 
         SetFileRequestPattern "#?","#?.TechNotes"
         
         Let filename = AskForFileName( DBasePath, "Load Technical Notes:",10,16 )
         
         If filename <> NOTHING
            
            If FindChars( filename, ".TechNotes", 1 ) > 0
               Dispose UReq
               Let UReq   = LoadVariable( filename )
               Let C_UReq = FirstArrayIndex( UReq )
               
               Do "DisplayUReq"
               
               Let GotUReqs = TRUE
            Else
               Let filename = Do( "CorrectFileName", filename, ".TechNotes" )
               
               If Exists( filename ) AND filename <> NOTHING
                  Dispose UReq
                  
                  Let UReq   = LoadVariable( filename )
                  Let C_UReq = FirstArrayIndex( UReq )
                  
                  Do "DisplayUReq"
                  
                  Let GotUReqs = TRUE
               EndIf
            EndIf
         EndIf
         
      EndScript
      Routine "NoteSelected"
         ; ----------------------------
         ; NoteSelected() SubRoutine
         ; ----------------------------
         
         Local i
         Local num
         
         WorkWithDocument "NotesList"
         Let num = TrimString( GetWord( TheLine, 1, ":" ))
         
         Let i = FirstArrayIndex( UReq )
         
         While i <= LastArrayIndex( UReq )
            
            If TrimString( UReq[i].Number ) = num
               Let C_UReq = i
               ExitLoop
            EndIf
            
            Let i = i + 1
         EndLoop
         
         Do "DisplayUReq"
         
      EndScript
      Routine "SaveAsUReq"
         ; --------------------------------
         ; SaveAsUReq() SubRoutine.
         ; --------------------------------
         
         Local filename
         
         SetFileRequestMode SAVEFILEMODE ,REJECTICONS 
         SetFileRequestPattern "#?","#?.TechNotes"
         
         Let filename = AskForFileName( DBasePath, "Save Tech' Notes:",10,16 )
         
         If filename <> NOTHING
            If FindChars( filename, ".TechNotes", 1 ) > 0
               Let C_UReq = FirstArrayIndex( UReq )
               Do "DisplayUReq"
               
               While C_UReq <= LastArrayIndex( UReq )
                  Let UReq[C_UReq] = GetDBObjects
                  
                  If Do( "EmptyString", UReq[C_UReq].Name ) = FALSE
                     SaveVariable UReq,filename
                  EndIf
                  
                  Let C_UReq = C_UReq + 1
                  Do "DisplayUReq"
               EndLoop
               
               Let GotUReqs = FALSE
            Else
               Let filename = Do( "CorrectFileName",filename,".TechNotes")
               
               If filename <> NOTHING
                  Let C_UReq = FirstArrayIndex( UReq )
                  Do "DisplayUReq"
                  
                  While C_UReq <= LastArrayIndex( UReq )
                     Let UReq[C_UReq] = GetDBObjects
                     
                     If Do( "EmptyString", UReq[C_UReq].Name ) = FALSE
                        SaveVariable UReq,filename
                     EndIf
                     
                     Let C_UReq = C_UReq + 1
                     Do "DisplayUReq"
                  EndLoop
                  
                  Let GotUReqs = FALSE
               EndIf
            EndIf
         EndIf
         
      EndScript
      Routine "ModifyUReq"
         ; --------------------------
         ; ModifyUReq() SubRoutine.
         ; --------------------------
         
         Let UReq[C_UReq] = GetDBObjects
         
         Do "DisplayUReq"
         Do "MakeNotesList"
         Do "HighlightNotesList"
         
      EndScript
      Routine "DisplayUReq"
         ; ----------------------------
         ; DisplayUReq() SubRoutine.
         ; ----------------------------
         
         SetDBObjects UReq[C_UReq]
         RefreshObject ".Notes"
         
         If FirstArrayIndex( UReq ) = 0
            SetInteger "EntryNum",C_UReq + 1
         Else
            SetInteger "EntryNum",C_UReq
         EndIf
         
         Do "SetTotalField"
      EndScript
      Routine "SetupDisplay"
         ; --------------------------------------
         ; SetupDisplay() Subroutine.
         ; --------------------------------------
         
         Do "SetUpColors"
         Do "DrawRaisedBox",247,363,180,31
         
         If GotUReqs = FALSE
            Let GotUReqs = TRUE
            Do "ReadInUserReqNotes"
            Let GotUReqs = TRUE
         EndIf
         
         Do "SetTotalField"
         
         If FirstArrayIndex( UReq ) = 0
            SetInteger "EntryNum",C_UReq + 1
         Else
            SetInteger "EntryNum",C_UReq
         EndIf
         
         Do "MakeNotesList"
         
         Do "DisplayUReq"
         Do "HighlightNotesList"
         
      EndScript
      Routine "SetTotalField"
         ; ------------------------------
         ; SetTotalField() SubRoutine.
         ; ------------------------------
         
         If FirstArrayIndex( UReq ) = 0
            SetInteger "TotalNotes",LastArrayIndex( UReq ) + 1
         Else
            SetInteger "TotalNotes",LastArrayIndex( UReq )
         EndIf
         
      EndScript
      Routine "SortUReq"
         ; ----------------------------------------
         ; SortUReq( key, direction ) SubRoutine.
         ; ----------------------------------------
         
         Do "SortRecords","UREQ",Arg1,Arg2,100,19
         
         Let C_UReq = FirstArrayIndex( UReq )
         
         Do "MakeNotesList"
         
         Do "DisplayUReq"
         Do "HighlightNotesList"
         
      EndScript
      Routine "Check_SaveUReqs"
         ; -----------------------------------------
         ; Check_SaveUReqs( filename ) SubRoutine.
         ; -----------------------------------------
         
         Local ttl
         Local ans
         Local msg
         Local fname
         
         If Do( "EmptyString", Arg1 ) = TRUE
            Let fname = DefaultDBase||".TechNotes"
         Else
            Let fname = TrimString( Arg1 )
         EndIf
         
         Let ttl = "User WARNING:"
         Let msg = "Any changes you've made have to be saved to be"||Char(10)
         Let msg = msg||"made permanent, Should they be saved?"
         
         Let ans = AskForResponse( msg, ttl, "Save them!|NO!" )
         
         If ans = 2
            ExitScript
         EndIf
         
         Do "SaveUReqs",fname
      EndScript
      AfterAttachment
         SetWindowTitle WTTL[5]
         
         Do "SetUpColors"
         
         If Supervised = FALSE
            Do "SetupDisplay"
         EndIf
      EndScript
      BeforeDetachment
         If Supervised = FALSE
            If GotUReqs = TRUE
               Do "Check_SaveUReqs"
               Let GotUReqs = FALSE
            EndIf
         EndIf
      EndScript
      Window "UserWindow"
         Definition
            Origin 0,16
            Title "User Technical Notes on Requirements:"
            WindowObjects CLOSEBUTTON DEPTHBUTTONS DRAGBAR 
            WindowLimits 250,15,640,480
            WindowZoom 0,13,250,15
            Size 640,415
            WindowFlags ACTIVATE TOFRONT WORKBENCH 
            VisualEffects NONE ,WAIT 
         EndScript
         OnActivated
            Do "SetupDisplay"
         EndScript
         OnCloseButton
            Do "Check_SaveUReqs"
            
            GotoCard "MainCard"
            
         EndScript
         OnResized
            Do "SetupDisplay"
         EndScript
      EndObj
      Memo ".Notes"
         Definition
            MemoDocument "UserNoteMemo"
            ScrollBars RIGHT 
            Origin 7,35
            Size 624,191
            Border BEVEL 
            Label "Note:",HIGHLIGHT ABOVE 
            Font "topaz",8
         EndScript
      EndObj
      AreaButton "ReturnGadget"
         Definition
            Origin 489,373
            Border BEVEL 
            Text " Return To Main "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 8,0,JAM1 
            Size 132,12
         EndScript
         OnRelease
            GotoCard "MainCard"
         EndScript
      EndObj
      TextMenu "Load"
         Definition
            AttachTo MENU ,"PROJECT    "
            Text "Load..."
            ShortCutKey "L"
         EndScript
         Occurred
            Do "LoadTechNotes"
            
         EndScript
      EndObj
      TextMenu "Save"
         Definition
            AttachTo MENU ,"PROJECT    "
            Text "Save"
            ShortCutKey "S"
         EndScript
         Occurred
            Do "SaveUReqs"
            Let GotUReqs = FALSE
         EndScript
      EndObj
      TextMenu "Save As"
         Definition
            AttachTo MENU ,"PROJECT    "
            Text "Save As..."
            ShortCutKey "A"
         EndScript
         Occurred
            Do "SaveAsUReq"
            
         EndScript
      EndObj
      TextMenu "Print"
         Definition
            AttachTo MENU ,"PROJECT    "
            Text "Print "
         EndScript
      EndObj
      AreaButton "SysCapGadget"
         Definition
            Origin 489,393
            Border BEVEL 
            Text " System Cap's "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 8,0,JAM1 
            Size 116,12
         EndScript
         OnRelease
            GotoCard "SysCapsCard"
         EndScript
      EndObj
      AKey "HelpKey"
         Definition
            QualifiersPressed NONE 
            KeyPressed HELP 
         EndScript
         OnUp
            Let d = AskForHelp( HelpPath||"GOOSA.guide", "UserReqNotesCard" )
            
         EndScript
      EndObj
      TextField ".Name"
         Definition
            InitialText "Name of the requirement"
            Origin 389,237
            Size 240,12
            Border DOUBLEBEVEL 
            Label "Requirement Title:",HIGHLIGHT 
            Justification CENTER 
            MaxFieldLength 256
            Font "topaz",8
         EndScript
      EndObj
      TextField ".Number"
         Definition
            InitialText "Number string..."
            Origin 389,258
            Size 240,12
            Border DOUBLEBEVEL 
            Label "Tech' Note #:",HIGHLIGHT 
            Justification CENTER 
            MaxFieldLength 256
            Font "topaz",8
         EndScript
      EndObj
      AreaButton "NextUReq"
         Definition
            Origin 369,372
            Border BEVEL 
            Text " NEXT "
            Font "topaz",8
            Style PLAIN ,2,3
            TextColors 12,0,JAM1 
            Size 52,12
         EndScript
         OnRelease
            Do "NextUReq"
            
         EndScript
      EndObj
      AreaButton "PrevUReq"
         Definition
            Origin 253,372
            Border BEVEL 
            Text " PREV "
            Font "topaz",8
            Style PLAIN ,2,3
            TextColors 12,0,JAM1 
            Size 52,12
         EndScript
         OnRelease
            Do "PrevUReq"
            
         EndScript
      EndObj
      AreaButton "AddUReq"
         Definition
            Origin 246,303
            Border BEVEL 
            Text " ADD "
            Font "topaz",8
            Style PLAIN ,2,3
            TextColors 5,0,JAM1 
            Size 44,12
         EndScript
         OnRelease
            Do "AddUReq"
            
         EndScript
      EndObj
      TextField ".CrossRef"
         Definition
            InitialText "Requirement Reference"
            Origin 389,279
            Size 240,12
            Border DOUBLEBEVEL 
            Label "Cross-Reference:",HIGHLIGHT 
            Justification CENTER 
            MaxFieldLength 256
            Font "topaz",8
         EndScript
      EndObj
      AreaButton "ModifyUReq"
         Definition
            Origin 246,321
            Border BEVEL 
            Text " MODIFY "
            Font "topaz",8
            Style PLAIN ,2,3
            TextColors 2,0,JAM1 
            Size 68,12
         EndScript
         OnRelease
            Do "ModifyUReq"
            
         EndScript
      EndObj
      AreaButton "DeleteUReq"
         Definition
            Origin 246,339
            Border BEVEL 
            Text " DELETE "
            Font "topaz",8
            Style PLAIN ,2,3
            TextColors 7,0,JAM1 
            Size 68,12
         EndScript
         OnRelease
            Do "DeleteUReq"
            
         EndScript
      EndObj
      TextMenu "ToFile"
         Definition
            AttachTo OBJECT ,"Print"
            Text "To File"
            ShortCutKey "F"
         EndScript
         Occurred
            Do "PrintUReqs"
         EndScript
      EndObj
      TextMenu "ToPar"
         Definition
            AttachTo OBJECT ,"Print"
            Text "To PAR:"
            ShortCutKey "P"
         EndScript
         Occurred
            Do "PrintUReqsToPAR"
         EndScript
      EndObj
      TextMenu "ToSer"
         Definition
            AttachTo OBJECT ,"Print"
            Text "To SER:"
         EndScript
         Occurred
            Do "PrintUReqsToSER"
         EndScript
      EndObj
      TextMenu "Search"
         Definition
            AttachTo MENU ,"EDITOR"
            Text "Search     "
         EndScript
      EndObj
      TextMenu "WholeWord"
         Definition
            AttachTo OBJECT ,"Search"
            Text "By Whole Word"
         EndScript
         Occurred
            WorkWithDocument "UserNoteMemo"
            
            MoveCursorTo STARTOF DOCUMENT 
            
            SearchFor TextFrom( "SearchString" ),BYWORD 
            
         EndScript
      EndObj
      TextMenu "Whole_Ignore"
         Definition
            AttachTo OBJECT ,"Search"
            Text "By Whole Word, Ignore Case"
         EndScript
         Occurred
            WorkWithDocument "UserNoteMemo"
            
            MoveCursorTo STARTOF DOCUMENT 
            
            SearchFor TextFrom( "SearchString" ),BYWORD NOCASE 
            
         EndScript
      EndObj
      TextMenu "IgnoreCase"
         Definition
            AttachTo OBJECT ,"Search"
            Text "Ignore Case only!"
         EndScript
         Occurred
            WorkWithDocument "UserNoteMemo"
            
            MoveCursorTo STARTOF DOCUMENT 
            
            SearchFor TextFrom( "SearchString" ),NOCASE 
            
         EndScript
      EndObj
      TextMenu "DefaultSearch"
         Definition
            AttachTo OBJECT ,"Search"
            Text "Default"
         EndScript
         Occurred
            WorkWithDocument "UserNoteMemo"
            
            MoveCursorTo STARTOF DOCUMENT 
            
            SearchFor TextFrom( "SearchString" )
            
         EndScript
      EndObj
      TextMenu "Replace"
         Definition
            AttachTo MENU ,"EDITOR"
            Text "Replace     "
         EndScript
      EndObj
      TextMenu "Whole_Replace"
         Definition
            AttachTo OBJECT ,"Replace"
            Text "By Whole Word"
         EndScript
         Occurred
            WorkWithDocument "UserNoteMemo"
            Replace TextFrom( "SearchString" ),TextFrom( "ReplaceString" ),BYWORD 
            
         EndScript
      EndObj
      TextMenu "Whole_Ignore_Replace"
         Definition
            AttachTo OBJECT ,"Replace"
            Text "By Whole Word, Ignore Case"
         EndScript
         Occurred
            WorkWithDocument "UserNoteMemo"
            
            Replace TextFrom( "SearchString" ),TextFrom( "ReplaceString" ),BYWORD NOCASE 
            
         EndScript
      EndObj
      TextMenu "Ignore_Replace"
         Definition
            AttachTo OBJECT ,"Replace"
            Text "Ignore Case only!"
         EndScript
         Occurred
            WorkWithDocument "UserNoteMemo"
            
            Replace TextFrom( "SearchString" ),TextFrom( "ReplaceString" ),NOCASE 
            
         EndScript
      EndObj
      TextMenu "Default_Replace"
         Definition
            AttachTo OBJECT ,"Replace"
            Text "Default"
         EndScript
         Occurred
            WorkWithDocument "UserNoteMemo"
            
            Replace TextFrom( "SearchString" ),TextFrom( "ReplaceString" )
            
         EndScript
      EndObj
      TextMenu "ReplaceAll"
         Definition
            AttachTo MENU ,"EDITOR"
            Text "Replace All "
         EndScript
      EndObj
      TextMenu "RA_WholeWord"
         Definition
            AttachTo OBJECT ,"ReplaceAll"
            Text "By Whole Word"
         EndScript
         Occurred
            WorkWithDocument "UserNoteMemo"
            
            MoveCursorTo STARTOF DOCUMENT 
            
            Replace TextFrom( "SearchString" ),TextFrom( "ReplaceString" ),BYWORD GLOBAL 
            
         EndScript
      EndObj
      TextMenu "RA_WholeIgnore"
         Definition
            AttachTo OBJECT ,"ReplaceAll"
            Text "By Whole Word, Ignore Case"
         EndScript
         Occurred
            WorkWithDocument "UserNoteMemo"
            
            MoveCursorTo STARTOF DOCUMENT 
            
            Replace TextFrom( "SearchString" ),TextFrom( "ReplaceString" ),BYWORD NOCASE GLOBAL 
            
         EndScript
      EndObj
      TextMenu "RA_Ignore"
         Definition
            AttachTo OBJECT ,"ReplaceAll"
            Text "Ignore Case only!"
         EndScript
         Occurred
            WorkWithDocument "UserNoteMemo"
            
            MoveCursorTo STARTOF DOCUMENT 
            
            Replace TextFrom( "SearchString" ),TextFrom( "ReplaceString" ),NOCASE GLOBAL 
            
         EndScript
      EndObj
      TextMenu "RA_Default"
         Definition
            AttachTo OBJECT ,"ReplaceAll"
            Text "Default"
         EndScript
         Occurred
            WorkWithDocument "UserNoteMemo"
            
            MoveCursorTo STARTOF DOCUMENT 
            
            Replace TextFrom( "SearchString" ),TextFrom( "ReplaceString" ),GLOBAL 
            
         EndScript
      EndObj
      ImageMenu "UTNSep1"
         Definition
            AttachTo MENU ,"EDITOR"
            BarImage
         EndScript
      EndObj
      TextMenu "Delete"
         Definition
            AttachTo MENU ,"EDITOR"
            Text "Delete to EOL"
            ShortCutKey "Y"
         EndScript
         Occurred
            WorkWithDocument "UserNoteMemo"
            
            Delete TOENDOFLINE 
            
            Let UReq[C_UReq] = GetDBObjects ; From -> Do "ModifyUReq"
            
         EndScript
      EndObj
      TextMenu "Kill"
         Definition
            AttachTo MENU ,"EDITOR"
            Text "Delete Line"
            ShortCutKey "K"
         EndScript
         Occurred
            WorkWithDocument "UserNoteMemo"
            
            Delete LINE 
            
            Let UReq[C_UReq] = GetDBObjects ; From -> Do "ModifyUReq"
            
         EndScript
      EndObj
      TextField "SearchString"
         Definition
            InitialText "String to Search For..."
            Origin 489,301
            Size 140,12
            Border DOUBLEBEVEL 
            Label "Search for:"
            Justification CENTER 
            MaxFieldLength 256
            Font "topaz",8
         EndScript
         OnClick
            SetText "SearchString",""
         EndScript
      EndObj
      TextField "ReplaceString"
         Definition
            InitialText "Replacement String..."
            Origin 489,323
            Size 140,12
            Border DOUBLEBEVEL 
            Label "Replace with:"
            Justification CENTER 
            MaxFieldLength 256
            Font "topaz",8
         EndScript
         OnClick
            SetText "ReplaceString",""
         EndScript
      EndObj
      AKey "TabKey"
         Definition
            QualifiersPressed NONE 
            KeyPressed TAB 
         EndScript
         OnUp
            Do "DoA_TabKey",".Notes"
            
         EndScript
      EndObj
      TextMenu "Alpha_Name"
         Definition
            AttachTo MENU ,"SORTS"
            Text "By Name "
         EndScript
      EndObj
      TextMenu "Ascending"
         Definition
            AttachTo OBJECT ,"Alpha_Name"
            Text "Ascending"
         EndScript
         Occurred
            Do "SortUReq",".NAME",1
            
         EndScript
      EndObj
      TextMenu "Descending"
         Definition
            AttachTo OBJECT ,"Alpha_Name"
            Text "Descending"
         EndScript
         Occurred
            Do "SortUReq",".NAME",2
         EndScript
      EndObj
      TextMenu "Number"
         Definition
            AttachTo MENU ,"SORTS"
            Text "By Req' Number "
         EndScript
      EndObj
      TextMenu "UNAscending"
         Definition
            AttachTo OBJECT ,"Number"
            Text "Ascending"
         EndScript
         Occurred
            Do "SortUReq",".NUMBER",1
            
         EndScript
      EndObj
      TextMenu "UNDescending"
         Definition
            AttachTo OBJECT ,"Number"
            Text "Descending"
         EndScript
         Occurred
            Do "SortUReq",".NUMBER",2
         EndScript
      EndObj
      TextMenu "Alpha_CrossRef"
         Definition
            AttachTo MENU ,"SORTS"
            Text "By Cross Reference "
         EndScript
      EndObj
      TextMenu "CR_Ascending"
         Definition
            AttachTo OBJECT ,"Alpha_CrossRef"
            Text "Ascending"
         EndScript
         Occurred
            Do "SortUReq",".CROSSREF",1
            
         EndScript
      EndObj
      TextMenu "CR_Descending"
         Definition
            AttachTo OBJECT ,"Alpha_CrossRef"
            Text "Descending"
         EndScript
         Occurred
            Do "SortUReq",".CROSSREF",2
         EndScript
      EndObj
      IntegerField "TotalNotes"
         Definition
            Limits 0,99999999
            InitialInteger 0
            Origin 557,347
            Size 65,14
            Border INVERT BEVEL 
            Label "Total Notes:"
            FieldFlags NOTABCYCLE 
            Justification CENTER 
            MaxFieldLength 32
         EndScript
      EndObj
      ErrorTrap "UserError_1"
         Occurred
            Do "HandleInternalError"
         EndScript
      EndObj
      List "FullNotes"
         Definition
            ListDocument "NotesList"
            Origin 8,246
            Size 226,163
            Border INVERT BEVEL 
            Label "Notes List:",ABOVE 
            Font "topaz",8
         EndScript
         OnRelease
            Do "NoteSelected"
         EndScript
      EndObj
      IntegerField "EntryNum"
         Definition
            Limits 0,999999999
            InitialInteger 0
            Origin 312,370
            Size 50,16
            Border INVERT BEVEL 
            Justification CENTER 
            MaxFieldLength 10
         EndScript
         OnRelease
            SetInteger "EntryNum",C_UReq
         EndScript
      EndObj
   EndObj
   Card "UserReqsCard"
      NoAttach
      Routine "LoadRequirementsMI"
         ; ----------------------------------
         ; LoadRequirementsMI() SubRoutine.
         ; ----------------------------------
         
         Local filename
         
         SetFileRequestMode REGULARMODE ,PATTERNFIELD 
         SetFileRequestPattern "#?","#?.Reqs"
         
         Let filename = AskForFileName( DBasePath, "Load Requirements:",10,16 )
         
         If filename <> NOTHING
            
            If FindChars( filename, ".Reqs", 1 ) > 0
               Dispose Requirement
               Let Requirement = LoadVariable( filename )
               Let C_Req       = FirstArrayIndex( Requirement )
               Do "DisplayRequirement"
               Let GotReqs = TRUE
            Else
               Let filename = Do( "CorrectFileName", filename, ".Reqs" )
               
               If Exists( filename ) AND filename <> NOTHING
                  Dispose Requirement
                  Let Requirement = LoadVariable( filename )
                  Let C_Req       = FirstArrayIndex( Requirement )
                  Do "DisplayRequirement"
                  Let GotReqs = TRUE
               EndIf
            EndIf
         EndIf
         
      EndScript
      Routine "RequirementSelected"
         ; ------------------------------------------
         ; RequirementSelected( reqnum ) SubRoutine.
         ; ------------------------------------------
         
         Local i
         Local str
         
         If Do( "EmptyString", Arg1 ) = TRUE
            WorkWithDocument "RequirementsList"
            Let str = TrimString( GetWord( TheLine, 1, ":" ))
         Else
            Let str = TrimString( Arg1 )
         EndIf
         
         Let i = FirstArrayIndex( Requirement )
         
         While i <= LastArrayIndex( Requirement )
            
            If TrimString( Requirement[i].Number ) = str
               Let C_Req = i
               ExitLoop
            EndIf
            
            Let i = i + 1
         EndLoop
         
         If FirstArrayIndex( Requirement ) = 0
            SetInteger "EntryNum",C_Req + 1
         Else
            SetInteger "EntryNum",C_Req
         EndIf
         
      EndScript
      Routine "DisplayRequirement"
         ; -----------------------------------------
         ; DisplayRequirement() Subroutine.
         ; -----------------------------------------
         
         Local index
         Local str
         
         WorkWithDocument "RequirementsList"
         Clear DOCUMENT 
         
         Type LeftJustify( "#",LineLength - 66 )||":"
         Type LeftJustify( " INPUT:",LineLength - 65 )
         Type LeftJustify( " OUTPUT:",LineLength - 35 ),NEWLINE 
         Type CenterString( "-", LineLength, "-" ),NEWLINE 
         
         Let index = FirstArrayIndex( Requirement )
         
         While index <= LastArrayIndex( Requirement )
            
            Let str = String( Requirement[index].Number )
            Type LeftJustify( str, LineLength - 66 )||": "
            
            Let str = TrimString( Requirement[index].InObject )||"."
            Let str = str||TrimString( Requirement[index].InAttribute )
            Type LeftJustify( str, LineLength - 65 )
            
            Let str = TrimString( Requirement[index].OutObject )||"."
            Let str = str||TrimString( Requirement[index].OutAttribute )
            Type LeftJustify( str, LineLength - 35 ),NEWLINE 
            
            Type CenterString( "+", LineLength, "+" ),NEWLINE 
            Type "",NEWLINE 
            
            Let index = index + 1
         EndLoop
         
         Type CenterString( "* END OF REQUIREMENTS! *", LineLength, "*" )
         MoveCursorTo STARTOF DOCUMENT 
      EndScript
      Routine "SetupDisplay"
         ; ------------------------------------------
         ; SetupDisplay() Subroutine - UserReqsCard.
         ; ------------------------------------------
         
         Local safety
         Local str
         
         Do "SetUpColors"
         
         If GotReqs = FALSE
            Do "ReadInRequirements"
            Let GotReqs = TRUE
         EndIf
         
         Do "SetupRequirements"
         
         If FirstArrayIndex( Requirement ) = 0
            SetInteger "EntryNum",C_Req + 1
         Else
            SetInteger "EntryNum",C_Req
         EndIf
         
         WorkWithDocument "RequirementsList"
         MoveCursorTo STARTOF DOCUMENT 
         Let safety = LinesInDocument
         Let str    = trimString( GetWord( TheLine, 1, " :-*#" ))
         
         While safety > 0
            
            If TrimString( Requirement[C_Req].Number ) = str
               ExitLoop
            EndIf
            
            Let safety = safety - 1
            MoveCursor DOWN 
            Let str = trimString( GetWord( TheLine, 1, " :-*#" ))
         EndLoop
      EndScript
      AfterAttachment
         SetWindowTitle WTTL[6]
         
         Do "SetUpColors"
         
         If Supervised = FALSE
            Do "SetupDisplay"
         EndIf
      EndScript
      Window "UserWindow"
         Definition
            Origin 0,16
            Title "User Requirements:"
            WindowObjects DEPTHBUTTONS DRAGBAR 
            WindowLimits 250,15,640,480
            WindowZoom 0,13,250,15
            Size 640,390
            WindowFlags ACTIVATE TOFRONT WORKBENCH 
            VisualEffects NONE ,WAIT 
         EndScript
         OnActivated
            Do "SetupDisplay"
         EndScript
         OnCloseButton
            Quit
         EndScript
         OnResized
            Do "SetupDisplay"
         EndScript
      EndObj
      List "UserReqsList"
         Definition
            ListDocument "RequirementsList"
            Origin 9,22
            Size 622,319
            Border INVERT BEVEL 
            Font "topaz",8
         EndScript
         OnRelease
            Do "RequirementSelected"
         EndScript
      EndObj
      AreaButton "ReturnGadget"
         Definition
            Origin 20,372
            Border BEVEL 
            Text " Return To Main "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 8,0,JAM1 
            Size 132,12
         EndScript
         OnRelease
            GotoCard "MainCard"
         EndScript
      EndObj
      AreaButton "SysCapGadget"
         Definition
            Origin 160,372
            Border BEVEL 
            Text " System Capabilities "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 8,0,JAM1 
            Size 172,12
         EndScript
         OnRelease
            GotoCard "SysCapsCard"
         EndScript
      EndObj
      AreaButton "RTMGadget"
         Definition
            Origin 340,372
            Border BEVEL 
            Text " Req's Traceability Matrix "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 8,0,JAM1 
            Size 220,12
         EndScript
         OnRelease
            GotoCard "RTMCard"
         EndScript
      EndObj
      AreaButton "GotoEditor"
         Definition
            Origin 413,351
            Border BEVEL 
            Text " Make an Entry... "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 8,0,JAM1 
            Size 148,12
         EndScript
         OnRelease
            GotoCard "EditUserReq"
         EndScript
      EndObj
      AKey "HelpKey"
         Definition
            QualifiersPressed NONE 
            KeyPressed HELP 
         EndScript
         OnUp
            Let d = AskForHelp( HelpPath||"GOOSA.guide", "UserReqsCard" )
            
         EndScript
      EndObj
      TextMenu "Load"
         Definition
            AttachTo MENU ,"PROJECT    "
            Text "Load..."
            ShortCutKey "L"
         EndScript
         Occurred
            Do "LoadRequirementsMI"
            
         EndScript
      EndObj
      TextMenu "Print"
         Definition
            AttachTo MENU ,"PROJECT    "
            Text "Print "
         EndScript
      EndObj
      TextMenu "ToFile"
         Definition
            AttachTo OBJECT ,"Print"
            Text "To File"
            ShortCutKey "F"
         EndScript
         Occurred
            Do "PrintToFile","Print Requirements to file:","RequirementsList"
            
         EndScript
      EndObj
      TextMenu "ToPar"
         Definition
            AttachTo OBJECT ,"Print"
            Text "To PAR:"
            ShortCutKey "P"
         EndScript
         Occurred
            Do "PrintToPAR","RequirementsList"
         EndScript
      EndObj
      TextMenu "ToSer"
         Definition
            AttachTo OBJECT ,"Print"
            Text "To SER:"
         EndScript
         Occurred
            Do "PrintToSER","RequirementsList"
         EndScript
      EndObj
      ErrorTrap "UserError_1"
         Occurred
            Do "HandleInternalError"
         EndScript
      EndObj
      IntegerField "EntryNum"
         Definition
            Limits 0,999999999
            InitialInteger 0
            Origin 578,347
            Size 60,13
            Justification CENTER 
            MaxFieldLength 10
         EndScript
         OnRelease
            SetInteger "EntryNum",C_Req
         EndScript
      EndObj
   EndObj
   Card "EditUserReq"
      NoAttach
      Routine "SetCapNumber"
         ; -------------------------------
         ; SetCapNumber() Subroutine.
         ; -------------------------------
         
         Local first
         Local last
         
         Let first = FirstArrayIndex( Capability )
         Let last  = LastArrayIndex(  Capability )
         
         If first = 0
            Let last = last + 1
         EndIf
         
         SetInteger "NumberOfCaps",last - first
      EndScript
      Routine "UpdateAttributeList"
         ; --------------------------------------------
         ; UpdateAttributeList( ObjectID ) Subroutine.
         ; --------------------------------------------
         
         Local i
         Let i = FirstArrayIndex( Normal )
         
         While i <= LastArrayIndex( Normal )
            If Arg1 = Normal[i].ID
               WorkWithDocument "AttributeList"
               Clear DOCUMENT 
               Type Normal[i].AttrName
               MoveCursorTo STARTOF DOCUMENT 
               ExitScript
            Else
               Let i = i + 1
            EndIf
         EndLoop
         
         Let i = FirstArrayIndex( Supertype )
         While i <= LastArrayIndex( Supertype )
            If Arg1 = Supertype[i].Name
               WorkWithDocument "AttributeList"
               Clear DOCUMENT 
               Type Supertype[i].AttrName
               MoveCursorTo STARTOF DOCUMENT 
               ExitScript
            Else
               Let i = i + 1
            EndIf
         EndLoop
         
         Let i = FirstArrayIndex( Subtype )
         While i <= LastArrayIndex( Subtype )
            If Arg1 = Subtype[i].Name
               WorkWithDocument "AttributeList"
               Clear DOCUMENT 
               Type Subtype[i].AttrName
               MoveCursorTo STARTOF DOCUMENT 
               ExitScript
            Else
               Let i = i + 1
            EndIf
         EndLoop
         
         Let i = FirstArrayIndex( Relation )
         While i <= LastArrayIndex( Relation )
            If Arg1 = Relation[i].Relator
               WorkWithDocument "AttributeList"
               Clear DOCUMENT 
               Type Relation[i].AttrName
               MoveCursorTo STARTOF DOCUMENT 
               ExitScript
            Else
               Let i = i + 1
            EndIf
         EndLoop
         
         Let i = FirstArrayIndex( Association )
         While i <= LastArrayIndex( Association )
            If Arg1 = Association[i].Name
               WorkWithDocument "AttributeList"
               Clear DOCUMENT 
               Type Association[i].AttrName
               MoveCursorTo STARTOF DOCUMENT 
               ExitScript
            Else
               Let i = i + 1
            EndIf
         EndLoop
         
         Let i = FirstArrayIndex( Composite )
         While i <= LastArrayIndex( Composite )
            If Arg1 = Composite[i].Name
               WorkWithDocument "AttributeList"
               Clear DOCUMENT 
               Type Composite[i].AttrName
               MoveCursorTo STARTOF DOCUMENT 
               ExitScript
            Else
               Let i = i + 1
            EndIf
         EndLoop
      EndScript
      Routine "Check_SaveReqs"
         ; ---------------------------------------
         ; Check_SaveReqs( filename ) SubRoutine.
         ; ---------------------------------------
         
         Local ttl
         Local ans
         Local msg
         Local fname
         
         If Do( "EmptyString", Arg1 ) = TRUE
            Let fname = DefaultDBase||".Reqs"
         Else
            Let fname = TrimString( Arg1 )
         EndIf
         
         Let ttl = "User WARNING:"
         Let msg = "Any changes you've made have to be saved to be"||Char(10)
         Let msg = msg||"made permanent, Should they be saved?"
         
         Let ans = AskForResponse( msg, ttl, "Save them!|NO!" )
         
         If ans = 2
            ExitScript
         EndIf
         
         Do "SaveRequirements",fname
      EndScript
      Routine "DisplayRequirement"
         SetDBObjects Requirement[C_Req]
         
         SetWindowTitle WTTL[7]
         
         If FirstArrayIndex( Requirement ) = 0
            SetInteger "EntryNum",C_Req + 1
         Else
            SetInteger "EntryNum",C_Req
         EndIf
      EndScript
      Routine "HighlightReq"
         ; ---------------------------
         ; HighlightReq() SubRoutine.
         ; ---------------------------
         
         WorkWithDocument "ReqList"
         MoveCursorTo STARTOF DOCUMENT 
         
         Let i   = FirstArrayIndex( Requirement )
         Let num = TrimString( GetWord( TheLine, 1, ":" ))
         
         While i <= LastArrayIndex( Requirement )
            
            If num = TrimString( Requirement[C_Req].Number )
               ExitLoop
            EndIf
            
            Let i = i + 1
            MoveCursor DOWN 
            Let num = TrimString( GetWord( TheLine, 1, ":" ))
         EndLoop
         
      EndScript
      Routine "DeleteRequirement"
         ; ---------------------------------
         ; DeleteRequirement() SubRoutine.
         ; ---------------------------------
         
         DeleteArrayEntry Requirement,C_Req
         
         If VarType( Requirement[C_Req] ) = "Nothing"
            Let C_Req = LastArrayIndex( Requirement )
         EndIf
         
         Do "SetReqNumber"
         Do "DisplayRequirement"
         Do "SetupReqList"
      EndScript
      Routine "ModifyRequirement"
         ; ---------------------------------
         ; ModifyRequirement() SubRoutine.
         ; ---------------------------------
         
         Let Requirement[C_Req] = GetDBObjects
         
         Do "DisplayRequirement"
         Do "SetupReqList"
      EndScript
      Routine "AddRequirement"
         ; ------------------------------
         ; AddRequirement() SubRoutine.
         ; ------------------------------
         
         Local save
         
         Let save = C_Req
         
         Let Requirement[C_Req] = GetDBObjects
         
         If C_Req < LastArrayIndex( Requirement )
            Let C_Req = C_Req + 1
         Else
            Let C_Req = LastArrayIndex( Requirement )
         EndIf
         
         InsertArrayEntry Requirement,C_Req
         
         Let Requirement[C_Req].InObject     = "COPY_"||Requirement[save].InObject
         Let Requirement[C_Req].OutObject    = "COPY_"||Requirement[save].OutObject
         Let Requirement[C_Req].InAttribute  = "COPY_"||Requirement[save].InAttribute
         Let Requirement[C_Req].OutAttribute = "COPY_"||Requirement[save].OutAttribute
         Let Requirement[C_Req].Number       = Requirement[save].Number||"_COPY"
         
         Do "SetReqNumber"
         Do "DisplayRequirement"
         Do "SetupReqList"
      EndScript
      Routine "SetReqNumber"
         ; -------------------------------
         ; SetReqNumber() Subroutine.
         ; -------------------------------
         
         Local first
         Local last
         
         Let first = FirstArrayIndex( Requirement )
         Let last  = LastArrayIndex(  Requirement )
         
         If first = 0
            SetInteger "NumberOfReqs",last + 1
         Else
            SetInteger "NumberOfReqs",last
         EndIf
         
         
      EndScript
      Routine "SaveAsReqFile"
         ; -----------------------------
         ; SaveAsReqFile() SubRoutine.
         ; -----------------------------
         
         Local filename
         
         SetFileRequestMode SAVEFILEMODE ,REJECTICONS 
         SetFileRequestPattern "#?","#?.Reqs"
         
         Let filename = AskForFileName( DBasePath, "Save Requirements:",10,16 )
         
         If filename <> NOTHING
            If FindChars( filename, ".Reqs", 1 ) > 0
               Let C_Req = FirstArrayIndex( Requirement )
               Do "DisplayRequirement"
               
               While C_Req <= LastArrayIndex( Requirement )
                  Let Requirement[C_Req] = GetDBObjects
                  
                  If Do( "EmptyString", Requirement[C_Req].Number ) = FALSE
                     SaveVariable Requirement,filename
                  EndIf
                  
                  Let C_Req = C_Req + 1
                  Do "DisplayRequirement"
               EndLoop
               
               Let GotReqs = FALSE
            Else
               Let filename = Do( "CorrectFileName", filename, ".Reqs" )
               If FindChars( filename, ".Reqs", 1 ) > 0
                  Let C_Req = FirstArrayIndex( Requirement )
                  Do "DisplayRequirement"
                  
                  While C_Req <= LastArrayIndex( Requirement )
                     Let Requirement[C_Req] = GetDBObjects
                     
                     If Do( "EmptyString", Requirement[C_Req].Number ) = FALSE
                        SaveVariable Requirement,filename
                     EndIf
                     
                     Let C_Req = C_Req + 1
                     Do "DisplayRequirement"
                  EndLoop
                  
                  Let GotReqs = FALSE
               EndIf
            EndIf
         EndIf
         
         Let C_Req = FirstArrayIndex( Requirement )
         Do "DisplayRequirement"
         Do "HighlightReq"
         
      EndScript
      Routine "SelectAttribute"
         ; ---------------------------------------
         ; SelectAttribute() Subroutine.
         ; ---------------------------------------
         
         Local ttl
         Local msg
         Local ans
         Local atr
         
         Let ttl = "GOOSA Helper:"
         
         WorkWithDocument "AttributeList"
         Let atr = TrimString( TheLine )
         
         Let msg = "Place "||atr||" attribute in:"
         
         Let ans = AskForResponse( msg, ttl, "InAttribute|NEITHER!|OutAttribute" )
         
         If ans = 1
            SetText ".InAttribute",TheLine
         ElseIf ans = 3
            SetText ".OutAttribute",TheLine
         EndIf
         
      EndScript
      Routine "SelectObject"
         ; -----------------------------------------
         ; SelectObject() Subroutine.
         ;
         ; Update the Attribute List based on which Object in
         ; ObjectList is selected.
         ; -----------------------------------------
         
         Local SelObject
         Local count
         Local loc
         Local NumAttrs
         
         Let SelObject = TheLine
         
         Let loc       = 1 + FindChars( SelObject, ":", 1 )
         Let SelObject = RemoveChars( TheLine, 1, loc )
         Let SelObject = TrimString( SelObject )
         
         Let loc       = FindChars( SelObject, ":", 1 ) - 5
         Let SelObject = GetChars( SelObject, 1, loc )
         Let SelObject = TrimString( SelObject )
         
         Do "UpdateAttributeList",SelObject
         
      EndScript
      Routine "HighlightObject"
         ; ---------------------------------------
         ; HighlightObject( objname ) SubRoutine.
         ; ---------------------------------------
         
         Local safety
         
         WorkWithDocument "ObjectList"
         MoveCursorTo STARTOF DOCUMENT 
         Let safety = LinesInDocument
         
         While safety > 0
            
            If FindChars( TheLine, Arg1, 1 ) > 0
               ExitLoop
            EndIf
            
            Let safety = safety - 1
            MoveCursor DOWN 
         EndLoop
         
      EndScript
      Routine "SetupDisplay"
         ; -------------------------------------------------
         ; SetupDisplay() Subroutine - UserReqEditor Card.
         ; -------------------------------------------------
         
         Local firstobject
         
         Do "SetUpColors"
         Do "DrawRaisedBox",275,252,82,62
         
         Do "DisplayRequirement"
         Do "SetReqNumber"
         Do "SetCapNumber"
         Do "SetupReqList"
         Do "SetupObjectList"
         
         Let firstobject = Requirement[C_Req].InObject
         
         Do "HighlightObject",firstobject
         Do "UpdateAttributeList",firstobject
         
      EndScript
      Routine "RequirementSelected"
         ; -----------------------------------
         ; RequirementSelected() SubRoutine.
         ; -----------------------------------
         
         Local i
         
         WorkWithDocument "ReqList"
         
         Let num = TrimString( GetWord( TheLine, 1, ":" ))
         Let i   = FirstArrayIndex( Requirement )
         
         While i <= LastArrayIndex( Requirement )
            
            If num = TrimString( Requirement[i].Number )
               Let C_Req = i
               ExitLoop
            EndIf
            
            Let i = i + 1
         EndLoop
         
         Do "DisplayRequirement"
         
         Do "HighlightObject",Requirement[i].InObject
         Do "UpdateAttributeList",Requirement[i].InObject
      EndScript
      Routine "PrevRequirement"
         ; ------------------------------
         ; PrevRequirement() SubRoutine.
         ; ------------------------------
         
         Let Requirement[C_Req] = GetDBObjects
         
         Let C_Req = PreviousArrayIndex( Requirement, C_Req )
         
         If NOT SearchFound
            Let C_Req = LastArrayIndex( Requirement )
         EndIf
         
         Do "DisplayRequirement"
         Do "HighlightReq"
         
         Do "HighlightObject",Requirement[C_Req].InObject
         Do "UpdateAttributeList",Requirement[C_Req].InObject
      EndScript
      Routine "NextRequirement"
         ; -------------------------------
         ; NextRequirement() SubRoutine.
         ; -------------------------------
         
         Let Requirement[C_Req] = GetDBObjects
         
         Let C_Req = NextArrayIndex( Requirement, C_Req )
         
         If NOT SearchFound
            Let C_Req = FirstArrayIndex( Requirement )
         EndIf
         
         Do "DisplayRequirement"
         Do "HighlightReq"
         
         Do "HighlightObject",Requirement[C_Req].InObject
         Do "UpdateAttributeList",Requirement[C_Req].InObject
         
         
      EndScript
      Routine "SortReqs"
         ; ---------------------------------------
         ; SortReqs( key, direction ) Subroutine.
         ; ---------------------------------------
         
         Do "SortRecords","Requirement",Arg1,Arg2,262,235
         
         Let C_Req = FirstArrayIndex( Requirement )
         
         Do "SetupDisplay"
         
         SetWindowTitle WTTL[7]
      EndScript
      Routine "SetupReqList"
         ; ----------------------------
         ; SetupReqList() SubRoutine.
         ; ----------------------------
         
         Local i
         
         Let i = FirstArrayIndex( Requirement )
         
         WorkWithDocument "ReqList"
         Clear DOCUMENT 
         
         While i <= LastArrayIndex( Requirement )
            
            If Do( "EmptyString", Requirement[i].Number ) = FALSE
               Type Requirement[i].Number||": "
               Type Requirement[i].InObject||"->"
               Type Requirement[i].OutAttribute,NEWLINE 
            EndIf
            
            Let i = i + 1
         EndLoop
         
         Do "HighlightReq"
         
      EndScript
      AfterAttachment
         SetWindowTitle WTTL[7]
         
         Do "SetUpColors"
         
         If Supervised = FALSE
            Do "SetupReqList"
            Do "SetupDisplay"
         EndIf
      EndScript
      Window "UserWindow"
         Definition
            Origin 0,16
            Title "Make a User Requirement:"
            WindowObjects CLOSEBUTTON DEPTHBUTTONS DRAGBAR 
            WindowLimits 250,15,640,480
            WindowZoom 0,13,250,15
            Size 640,410
            WindowFlags ACTIVATE TOFRONT WORKBENCH 
            VisualEffects NONE ,WAIT 
         EndScript
         OnActivated
            Do "SetupDisplay"
         EndScript
         OnCloseButton
            Do "Check_SaveReqs"
            
            GotoCard "UserReqsCard"
            
         EndScript
         OnResized
            Do "SetupDisplay"
         EndScript
      EndObj
      TextField ".InObject"
         Definition
            InitialText "User supplies..."
            Origin 101,20
            Size 200,12
            Border DOUBLEBEVEL 
            Label "Input Object:",HIGHLIGHT 
            Justification CENTER 
            MaxFieldLength 256
            Font "topaz",8
         EndScript
      EndObj
      TextField ".OutObject"
         Definition
            InitialText "System supplies..."
            Origin 101,38
            Size 200,12
            Border DOUBLEBEVEL 
            Label "Output Object:",HIGHLIGHT 
            Justification CENTER 
            MaxFieldLength 256
            Font "topaz",8
         EndScript
      EndObj
      List "UserReqObjects"
         Definition
            ListDocument "ObjectList"
            Origin 9,75
            Size 619,153
            Border INVERT BEVEL 
            Label "Objects:",ABOVE 
            Font "topaz",8
         EndScript
         OnClick
            WorkWithDocument "ObjectList"
         EndScript
         OnRelease
            Do "SelectObject" ; Update the attribute list from selected object.
            
         EndScript
      EndObj
      List "UserReqAttrib"
         Definition
            ListDocument "AttributeList"
            Origin 9,254
            Size 244,150
            Border INVERT BEVEL 
            Label "Attributes:",ABOVE 
            Font "topaz",8
         EndScript
         OnRelease
            Do "SelectAttribute"
         EndScript
      EndObj
      AreaButton "NextReq"
         Definition
            Origin 290,295
            Border BEVEL 
            Text " NEXT "
            Font "topaz",8
            Style PLAIN ,2,3
            TextColors 12,0,JAM1 
            Size 52,12
         EndScript
         OnRelease
            Do "NextRequirement"
            
         EndScript
      EndObj
      AreaButton "PrevReq"
         Definition
            Origin 290,259
            Border BEVEL 
            Text " PREV "
            Font "topaz",8
            Style PLAIN ,2,3
            TextColors 12,0,JAM1 
            Size 52,12
         EndScript
         OnRelease
            Do "PrevRequirement"
            
         EndScript
      EndObj
      AreaButton "AddReq"
         Definition
            Origin 263,327
            Border BEVEL 
            Text " ADD "
            Font "topaz",8
            Style PLAIN ,2,3
            TextColors 5,0,JAM1 
            Size 44,12
         EndScript
         OnRelease
            Do "AddRequirement"
            
         EndScript
      EndObj
      AreaButton "DeleteReq"
         Definition
            Origin 263,367
            Border BEVEL 
            Text " DELETE "
            Font "topaz",8
            Style PLAIN ,2,3
            TextColors 7,0,JAM1 
            Size 68,12
         EndScript
         OnRelease
            Do "DeleteRequirement"
            
         EndScript
      EndObj
      AKey "HelpKey"
         Definition
            QualifiersPressed NONE 
            KeyPressed HELP 
         EndScript
         OnUp
            Dos HelpViewer|||HelpPath||"GOOSA.guide EditUserReqCard"
            
         EndScript
      EndObj
      AreaButton "ModifyReq"
         Definition
            Origin 263,347
            Border BEVEL 
            Text " MODIFY "
            Font "topaz",8
            Style PLAIN ,2,3
            TextColors 2,0,JAM1 
            Size 68,12
         EndScript
         OnRelease
            Do "ModifyRequirement"
            
         EndScript
      EndObj
      AreaButton "Return_IST"
         Definition
            Origin 263,388
            Border BEVEL 
            Text " RETURN TO IST "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 8,0,JAM1 
            Size 124,12
         EndScript
         OnRelease
            Do "SaveRequirements"
            Let GotReqs = FALSE
            GotoCard "ISTCard"
         EndScript
      EndObj
      TextField ".InAttribute"
         Definition
            InitialText "User supplies..."
            Origin 376,20
            Size 200,12
            Border DOUBLEBEVEL 
            Label "Attribute:",HIGHLIGHT 
            Justification CENTER 
            MaxFieldLength 256
            Font "topaz",8
         EndScript
      EndObj
      TextField ".OutAttribute"
         Definition
            InitialText "System supplies..."
            Origin 376,38
            Size 200,12
            Border DOUBLEBEVEL 
            Label "Attribute:",HIGHLIGHT 
            Justification CENTER 
            MaxFieldLength 256
            Font "topaz",8
         EndScript
      EndObj
      TextField ".Number"
         Definition
            InitialText "R12345..."
            Origin 101,56
            Size 120,12
            Border DOUBLEBEVEL 
            Label "Requirement:",HIGHLIGHT 
            Justification CENTER 
            MaxFieldLength 32
            Font "topaz",8
         EndScript
      EndObj
      TextMenu "Save"
         Definition
            AttachTo MENU ,"PROJECT    "
            Text "Save"
            ShortCutKey "S"
         EndScript
         Occurred
            Do "SaveRequirements"
            Let GotReqs = FALSE
         EndScript
      EndObj
      TextMenu "Save As"
         Definition
            AttachTo MENU ,"PROJECT    "
            Text "Save As..."
            ShortCutKey "A"
         EndScript
         Occurred
            Do "SaveAsReqFile"
            
         EndScript
      EndObj
      TextMenu "InObject"
         Definition
            AttachTo MENU ,"SORTS"
            Text "By Input  Object "
         EndScript
      EndObj
      TextMenu "Ascending"
         Definition
            AttachTo OBJECT ,"InObject"
            Text "Ascending"
         EndScript
         Occurred
            Do "SortReqs",".INOBJECT",1
            
         EndScript
      EndObj
      TextMenu "Descending"
         Definition
            AttachTo OBJECT ,"InObject"
            Text "Descending"
         EndScript
         Occurred
            Do "SortReqs",".INOBJECT",2
         EndScript
      EndObj
      TextMenu "Number"
         Definition
            AttachTo MENU ,"SORTS"
            Text "By Req'   Number "
         EndScript
      EndObj
      TextMenu "UNAscending"
         Definition
            AttachTo OBJECT ,"Number"
            Text "Ascending"
         EndScript
         Occurred
            Do "SortReqs",".NUMBER",1
            
         EndScript
      EndObj
      TextMenu "UNDescending"
         Definition
            AttachTo OBJECT ,"Number"
            Text "Descending"
         EndScript
         Occurred
            Do "SortReqs",".NUMBER",2
         EndScript
      EndObj
      TextMenu "OutObject"
         Definition
            AttachTo MENU ,"SORTS"
            Text "By Output Object "
         EndScript
      EndObj
      TextMenu "OO_Ascending"
         Definition
            AttachTo OBJECT ,"OutObject"
            Text "Ascending"
         EndScript
         Occurred
            Do "SortReqs",".OUTOBJECT",1
            
         EndScript
      EndObj
      TextMenu "OO_Descending"
         Definition
            AttachTo OBJECT ,"OutObject"
            Text "Descending"
         EndScript
         Occurred
            Do "SortReqs",".OUTOBJECT",2
         EndScript
      EndObj
      IntegerField "NumberOfReqs"
         Definition
            Limits 0,99999999
            InitialInteger 0
            Origin 425,56
            Size 68,12
            Label "# Req's:"
            FieldFlags NOTABCYCLE 
            MaxFieldLength 32
            Font "topaz",8
            TextColors 7,0
            AltTextColors 7,0
         EndScript
      EndObj
      IntegerField "NumberOfCaps"
         Definition
            Limits 0,99999999
            InitialInteger 0
            Origin 553,56
            Size 69,12
            Label "# Cap's:"
            FieldFlags NOTABCYCLE 
            MaxFieldLength 32
            Font "topaz",8
            TextColors 7,0
            AltTextColors 7,0
         EndScript
      EndObj
      ErrorTrap "UserError_1"
         Occurred
            Do "HandleInternalError"
         EndScript
      EndObj
      IntegerField "EntryNum"
         Definition
            Limits 0,99999999
            InitialInteger 0
            Origin 286,276
            Size 60,14
            Border INVERT BEVEL 
            FieldFlags NOTABCYCLE 
            Justification CENTER 
            MaxFieldLength 10
         EndScript
         OnRelease
            SetInteger "EntryNum",C_Req
            
         EndScript
      EndObj
      List "Requirements"
         Definition
            ListDocument "ReqList"
            Origin 397,251
            Size 231,152
            Border INVERT BEVEL 
            Label "Requirements List:",ABOVE 
            Font "topaz",8
         EndScript
         OnRelease
            Do "RequirementSelected"
            
         EndScript
      EndObj
   EndObj
   Card "SysCapsCard"
      NoAttach
      Routine "LoadCapabilities"
         ; ---------------------------------
         ; LoadCapabilities() SubRoutine.
         ; ---------------------------------
         
         Local filename
         
         SetFileRequestMode REGULARMODE ,PATTERNFIELD 
         SetFileRequestPattern "#?","#?.Caps"
         
         Let filename = AskForFileName( DBasePath, "Load Capabilities:",10,16 )
         
         If filename <> NOTHING
            
            If FindChars( filename, ".Caps", 1 ) > 0
               Dispose Capability
               Let Capability = LoadVariable( filename )
               Let C_Cap      = FirstArrayIndex( Capability )
               Let GotCaps = TRUE
            Else
               Let filename = Do( "CorrectFileName", filename, ".Caps" )
               
               If Exists( filename ) AND filename <> NOTHING
                  Dispose Capability
                  Let Capability = LoadVariable( filename )
                  Let C_Cap      = FirstArrayIndex( Capability )
                  Let GotCaps = TRUE
               EndIf
            EndIf
         EndIf
         
         Do "SetupCapabilities"
         
      EndScript
      Routine "DisplayC_Cap"
         ; ----------------------------
         ; DisplayC_Cap() SubRoutine.
         ; ----------------------------
         
         If FirstArrayIndex( Capability ) = 0
            SetInteger "EntryNum",C_Cap + 1
         Else
            SetInteger "EntryNum",C_Cap
         EndIf
      EndScript
      Routine "HighlightC_Cap"
         ; --------------------------------------
         ; HighlightC_Cap( capnum ) SubRoutine.
         ; --------------------------------------
         
         Local safety
         
         WorkWithDocument "SysCapsList"
         MoveCursorTo STARTOF DOCUMENT 
         Let safety = LinesInDocument
         
         While safety > 0
            
            If FindChars( TheLine, Capability[Arg1].Number, 1 ) > 0
               ExitLoop
            EndIf
            
            Let safety = safety - 1
            MoveCursor DOWN 
         EndLoop
         
      EndScript
      Routine "SetupDisplay"
         ; -----------------------------------------
         ; SetupDisplay() Subroutine - SysCapsCard.
         ; -----------------------------------------
         
         Do "SetUpColors"
         
         If GotCaps = FALSE
            Do "ReadInCapabilities"
            Let GotCaps = TRUE
         EndIf
         
         Do "SetupCapabilities"
         Do "DisplayC_Cap"
         Do "CapabilitySelected",Capability[C_Cap].Number
         Do "HighlightC_Cap",C_Cap
      EndScript
      Routine "CapabilitySelected"
         ; ------------------------------------------
         ; CapabilitySelected( capnum ) SubRoutine.
         ; ------------------------------------------
         
         Local i
         Local str
         
         If Do( "EmptyString", Arg1 ) = TRUE
            WorkWithDocument "SysCapsList"
            Let str = TrimString( GetWord( TheLine, 2, " -*" ))
         Else
            Let str = TrimString( Arg1 )
         EndIf
         
         Let i = FirstArrayIndex( Capability )
         
         While i <= LastArrayIndex( Capability )
            
            If TrimString( Capability[i].Number ) = str
               Let C_Cap = i
               ExitLoop
            EndIf
            
            Let i = i + 1
         EndLoop
         
         Do "DisplayC_Cap"
      EndScript
      AfterAttachment
         SetWindowTitle WTTL[8]
         
         Do "SetUpColors"
         
         If Supervised = FALSE
            Do "SetupDisplay"
         EndIf
      EndScript
      Window "UserWindow"
         Definition
            Origin 0,16
            Title "System Capabilities:"
            WindowObjects DEPTHBUTTONS DRAGBAR 
            WindowLimits 250,15,640,480
            WindowZoom 0,13,250,15
            Size 640,400
            WindowFlags ACTIVATE TOFRONT WORKBENCH 
            VisualEffects NONE ,WAIT 
         EndScript
         OnCloseButton
            Quit
         EndScript
         OnActivated
            Do "SetupDisplay"
            
         EndScript
         OnResized
            Do "SetupDisplay"
         EndScript
      EndObj
      List "SysCaps_List"
         Definition
            ListDocument "SysCapsList"
            Origin 9,20
            Size 617,337
            Border EMBOSSED ,1,14
            Font "topaz",8
            TextColors 1,0,JAM2 
            Style PLAIN ,2,3
         EndScript
         OnRelease
            Do "CapabilitySelected"
            
         EndScript
      EndObj
      AreaButton "ReturnGadget"
         Definition
            Origin 15,382
            Border BEVEL 
            Text " Return To Main "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 8,0,JAM1 
            Size 132,12
         EndScript
         OnRelease
            GotoCard "MainCard"
         EndScript
      EndObj
      AreaButton "UserReqsGadget"
         Definition
            Origin 158,382
            Border BEVEL 
            Text " User Requirements "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 8,0,JAM1 
            Size 156,12
         EndScript
         OnRelease
            GotoCard "UserReqsCard"
         EndScript
      EndObj
      AreaButton "RTMGadget"
         Definition
            Origin 330,382
            Border BEVEL 
            Text " Req's Traceability Matrix "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 8,0,JAM1 
            Size 220,12
         EndScript
         OnRelease
            GotoCard "RTMCard"
         EndScript
      EndObj
      AreaButton "GotoEditor"
         Definition
            Origin 401,365
            Border BEVEL 
            Text " Make an Entry... "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 8,0,JAM1 
            Size 148,12
         EndScript
         OnRelease
            GotoCard "AddSysCap"
         EndScript
      EndObj
      AKey "HelpKey"
         Definition
            QualifiersPressed NONE 
            KeyPressed HELP 
         EndScript
         OnUp
            Let d = AskForHelp( HelpPath||"GOOSA.guide", "SysCapsCard" )
            
         EndScript
      EndObj
      TextMenu "Load"
         Definition
            AttachTo MENU ,"PROJECT    "
            Text "Load..."
            ShortCutKey "L"
         EndScript
         Occurred
            Do "LoadCapabilities"
            
         EndScript
      EndObj
      TextMenu "Print"
         Definition
            AttachTo MENU ,"PROJECT    "
            Text "Print "
         EndScript
      EndObj
      TextMenu "ToFile"
         Definition
            AttachTo OBJECT ,"Print"
            Text "To File"
            ShortCutKey "F"
         EndScript
         Occurred
            Do "PrintToFile","Print Capabilities to file:","SysCapsList"
         EndScript
      EndObj
      TextMenu "ToPar"
         Definition
            AttachTo OBJECT ,"Print"
            Text "To PAR:"
            ShortCutKey "P"
         EndScript
         Occurred
            Do "PrintToPAR","SysCapsList"
         EndScript
      EndObj
      TextMenu "ToSer"
         Definition
            AttachTo OBJECT ,"Print"
            Text "To SER:"
         EndScript
         Occurred
            Do "PrintToSER","SysCapsList"
         EndScript
      EndObj
      AKey "TabKey"
         Definition
            QualifiersPressed NONE 
            KeyPressed TAB 
         EndScript
         OnUp
            Do "DoA_TabKey"
         EndScript
      EndObj
      ErrorTrap "UserError_1"
         Occurred
            Do "HandleInternalError"
         EndScript
      EndObj
      IntegerField "EntryNum"
         Definition
            Limits 0,999999999
            InitialInteger 0
            Origin 573,364
            Size 50,12
            Justification CENTER 
            MaxFieldLength 10
         EndScript
         OnRelease
            SetInteger "EntryNum",C_Cap
         EndScript
      EndObj
   EndObj
   Card "AddSysCap"
      NoAttach
      Routine "PrevCapability"
         ; -------------------------------
         ; PrevCapability() SubRoutine.
         ; -------------------------------
         
         Let Capability[C_Cap] = GetDBObjects
         
         Let C_Cap = PreviousArrayIndex( Capability, C_Cap )
         
         If NOT SearchFound
            Let C_Cap = LastArrayIndex( Capability )
         EndIf
         
         Do "DisplayCapability"
         
      EndScript
      Routine "NextCapability"
         ; -------------------------------
         ; NextCapability() SubRoutine.
         ; -------------------------------
         
         Let Capability[C_Cap] = GetDBObjects
         
         Let C_Cap = NextArrayIndex( Capability, C_Cap )
         
         If NOT SearchFound
            Let C_Cap = FirstArrayIndex( Capability )
         EndIf
         
         Do "DisplayCapability"
         
      EndScript
      Routine "Check_SaveCaps"
         ; ----------------------------------------
         ; Check_SaveCaps( filename ) SubRoutine.
         ; ----------------------------------------
         
         Local ttl
         Local ans
         Local msg
         Local fname
         
         If Do( "EmptyString", Arg1 ) = TRUE
            Let fname = DefaultDBase||".Caps"
         Else
            Let fname = TrimString( Arg1 )
         EndIf
         
         Let ttl = "User WARNING:"
         Let msg = "Any changes you've made have to be saved to be"||Char(10)
         Let msg = msg||"made permanent, Should they be saved?"
         
         Let ans = AskForResponse( msg, ttl, "Save them!|NO!" )
         
         If ans = 2
            ExitScript
         EndIf
         
         Do "SaveCapabilities",fname
      EndScript
      Routine "HighlightCap"
         ; ------------------------------------
         ; HighlightCap( CapNum ) SubRoutine.
         ; ------------------------------------
         
         Local i
         Local num
         
         WorkWithDocument "CapList"
         MoveCursorTo STARTOF DOCUMENT 
         
         Let i   = LinesInDocument
         Let num = TrimString( GetWord( TheLine, 1, ":" ))
         
         While i > 0
            
            If TrimString( Capability[C_Cap].Number ) = num
               ExitLoop
            EndIf
            
            Let i = i - 1
            MoveCursor DOWN 
            Let num = TrimString( GetWord( TheLine, 1, ":" ))
         EndLoop
      EndScript
      Routine "ModifyCapability"
         ; --------------------------------
         ; ModifyCapability() SubRoutine.
         ; --------------------------------
         
         Let Capability[C_Cap] = GetDBObjects
         
         Do "MakeCapList"
         Do "DisplayCapability"
         
      EndScript
      Routine "SaveAsCapsFile"
         ; ------------------------------
         ; SaveAsCapsFile() SubRoutine.
         ; ------------------------------
         
         Local filename
         
         SetFileRequestMode SAVEFILEMODE ,REJECTICONS 
         SetFileRequestPattern "#?","#?.Caps"
         
         Let filename = AskForFileName( DBasePath, "Save Capabilities:",10,16 )
         
         If filename <> NOTHING
            
            If FindChars( filename, ".Caps", 1 ) > 0
               Let C_Cap = FirstArrayIndex( Capability )
               Do "DisplayCapability"
               
               While C_Cap <= LastArrayIndex( Capability )
                  Let Capability[C_Cap] = GetDBObjects
                  
                  If Do( "emptyString", Capability[C_Cap].Number ) = FALSE
                     SaveVariable Capability,filename
                  EndIf
                  
                  Let C_Cap = C_Cap + 1
                  Do "DisplayCapability"
               EndLoop
               
               Let GotCaps = FALSE
            Else
               Let filemame = Do( "CorrectFileName", filename, ".Caps" )
               
               If FindChars( filename, ".Caps", 1 ) > 0
                  Let C_Cap = FirstArrayIndex( Capability )
                  Do "DisplayCapability"
                  
                  While C_Cap <= LastArrayIndex( Capability )
                     Let Capability[C_Cap] = GetDBObjects
                     
                     If Do( "emptyString", Capability[C_Cap].Number ) = FALSE
                        SaveVariable Capability,filename
                     EndIf
                     
                     Let C_Cap = C_Cap + 1
                     Do "DisplayCapability"
                  EndLoop
                  
                  Let GotCaps = FALSE
               EndIf
            EndIf
         EndIf
         
         Let C_Cap = FirstArrayIndex( Capability )
         Do "DisplayCapability"
      EndScript
      Routine "SelectCapability"
         ; --------------------------------
         ; SelectCapability() Subroutine.
         ; --------------------------------
         
         Local capnum
         Local i
         
         Let i = FirstArrayIndex( Capability )
         
         WorkWithDocument "CapList"
         Let capnum = TrimString( GetWord( TheLine, 1, ":" ))
         
         If Do( "EmptyString", capnum ) = TRUE
            ExitScript
         EndIf
         
         While i <= LastArrayIndex( Capability )
            If TrimString( Capability[i].Number ) = capnum
               Let C_Cap = i
               ExitLoop
            EndIf
            
            Let i = i + 1
         EndLoop
         
         Do "DisplayCapability"
         
      EndScript
      Routine "HighlightReq"
         ; ------------------------------------
         ; HighlightReq( CapNum ) SubRoutine.
         ; ------------------------------------
         
         Local i
         Local num
         
         WorkWithDocument "RequirementsList"
         MoveCursorTo STARTOF DOCUMENT 
         
         Let i   = LinesInDocument
         Let num = TrimString( GetWord( TheLine, 1, ":-+#" ))
         
         While i > 0
            
            If TrimString( Capability[C_Cap].ReqNumber ) = num
               ExitLoop
            EndIf
            
            Let i = i - 1
            MoveCursor DOWN 
            Let num = TrimString( GetWord( TheLine, 1, ":-+#" ))
         EndLoop
      EndScript
      Routine "DisplayCapability"
         ; -----------------------------------------
         ; DisplayCapability( which ) Subroutine.
         ; -----------------------------------------
         
         SetDBObjects Capability[C_Cap]
         
         SetWindowTitle WTTL[9]
         
         If FirstArrayIndex( Capability ) = 0
            SetInteger "EntryNum",C_Cap+1
         Else
            SetInteger "EntryNum",C_Cap
         EndIf
         
         Do "HighlightCap"
         Do "HighlightReq"
         
      EndScript
      Routine "SelectRequirement"
         ; --------------------------------------------
         ; SelectRequirement() Subroutine.
         ; --------------------------------------------
         
         Local reqnum
         Local i
         Local colon
         Local index
         
         Let i = FirstArrayIndex( Capability )
         
         WorkWithDocument "RequirementsList"
         Let reqnum = TrimString( GetWord( TheLine, 1, " :-+#" ))
         
         If Do( "EmptyString", reqnum ) = TRUE
            ExitScript
         EndIf
         
         While i <= LastArrayIndex( Capability )
            
            If TrimString( Capability[i].ReqNumber ) = reqnum
               Let C_Cap = i
               ExitLoop
            EndIf
            
            Let i = i + 1
         EndLoop
         
         Do "DisplayCapability"
      EndScript
      Routine "AddCapability"
         ; -----------------------------------------
         ; AddCapability() SubRoutine.
         ; -----------------------------------------
         
         Local i
         
         Let i = C_Cap
         
         If C_Cap < LastArrayIndex( Capability )
            Let C_Cap = C_Cap + 1
         Else
            Let C_Cap = LastArrayIndex( Capability )
         EndIf
         
         InsertArrayEntry Capability,C_Cap
         
         Let Capability[C_Cap].CString        = "COPY_"||Capability[i].CString
         Let Capability[C_Cap].ReqString      = "COPY_"||Capability[i].ReqString
         Let Capability[C_Cap].Number         = Capability[i].Number||"_COPY"
         Let Capability[C_Cap].ReqNumber      = "COPY_"||Capability[i].ReqNumber
         Let Capability[C_Cap].Description    = "COPY_"||Capability[i].Description
         Let Capability[C_Cap].ReqDescription = "COPY_"||Capability[i].ReqDescription
         
         Do "SetCapNumber"
         Do "MakeCapList"
         
         Do "DisplayCapability"
      EndScript
      Routine "DeleteCapability"
         ; --------------------------------
         ; DeleteCapability() SubRoutine.
         ; --------------------------------
         
         DeleteArrayEntry Capability,C_Cap
         
         If VarType( Capability[C_Cap] ) = "Nothing"
            Let C_Cap = LastArrayIndex( Capability )
         EndIf
         
         Do "SetCapNumber"
         Do "MakeCapList"
         Do "DisplayCapability"
         
      EndScript
      Routine "SetCapNumber"
         ; -------------------------------
         ; SetCapNumber() Subroutine.
         ; -------------------------------
         
         Local last
         
         Let last = LastArrayIndex( Capability )
         
         If FirstArrayIndex( Capability ) = 0
            SetInteger "NumberOfCaps",last + 1
         Else
            SetInteger "NumberOfCaps",last
         EndIf
      EndScript
      Routine "SetReqNumber"
         ; -------------------------------
         ; SetReqNumber() Subroutine.
         ; -------------------------------
         
         Local last
         
         Let last = LastArrayIndex( Requirement )
         
         If FirstArrayIndex( Requirement ) = 0
            SetInteger "NumberOfReqs",last + 1
         Else
            SetInteger "NumberOfReqs",last
         EndIf
      EndScript
      Routine "CheckReqCapNums"
         ; --------------------------------
         ; CheckReqCapNums() SubFunction.
         ; --------------------------------
         
         Local cr
         Local ttl
         Local msg
         Local ans
         Local c
         Local r
         
         Let c = IntegerFrom( "NumberOfCaps" )
         Let r = IntegerFrom( "NumberOfReqs" )
         
         Let cr  = Char( 10 )
         Let ttl = "User WARNING:"
         Let msg = "# of Capabilities ( "||String( c )||" )"||cr
         Let msg = msg||" does NOT match # of Requirements ( "||String( r )||" )!"||cr
         Let msg = msg||"   Proceed anyway?"
         
         Let ans = AskForResponse( msg, ttl, "Continue!|CANCEL" )
         
         If ans = 2
            ExitScript FALSE
         Else
            ExitScript TRUE
         EndIf
      EndScript
      Routine "SortCaps"
         ; ----------------------------------------
         ; SortCaps( key, direction ) SubRoutine.
         ; ----------------------------------------
         
         Do "SortRecords","Capability",Arg1,Arg2,420,106
         
         Let C_Cap = FirstArrayIndex( Capability )
         
         Do "MakeCapList"
         Do "DisplayCapability"
         
      EndScript
      Routine "MakeCapList"
         ; ---------------------------
         ; MakeCapList() SubRoutine.
         ; ---------------------------
         
         Local i
         
         Let i = FirstArrayIndex( Capability )
         
         WorkWithDocument "CapList"
         Clear DOCUMENT 
         
         While i <= LastArrayIndex( Capability )
            
            If Do( "EmptyString", Capability[i].Number ) = FALSE
               Type Capability[i].Number||": "
               Type Capability[i].CString,NEWLINE 
            EndIf
            
            Let i = i + 1
         EndLoop
         
         MoveCursorTo STARTOF DOCUMENT 
      EndScript
      Routine "SetupDisplay"
         ; --------------------------------------------
         ; SetupDisplay() Subroutine - AddSysCap Card.
         ; --------------------------------------------
         
         Do "SetUpColors"
         Do "DrawRaisedBox",13,263,173,31
         
         Do "SetReqNumber"
         Do "SetCapNumber"
         
         ;If GotReqs = FALSE
         Do "SetupRequirements"
         Do "HighlightReq",C_Cap
         ;EndIf
         
         Do "MakeCapList"
         Do "HighlightCap",C_Cap
         
         Do "DisplayCapability"
         
         SetWindowTitle WTTL[9]
      EndScript
      AfterAttachment
         SetWindowTitle WTTL[9]
         
         Do "SetUpColors"
         
         If Supervised = FALSE
            Do "SetupDisplay"
         EndIf
      EndScript
      Window "UserWindow"
         Definition
            Origin 0,16
            Title "Define System Capability:"
            WindowObjects CLOSEBUTTON DEPTHBUTTONS DRAGBAR 
            WindowLimits 250,15,640,480
            WindowZoom 0,13,250,15
            Size 640,425
            WindowFlags ACTIVATE TOFRONT WORKBENCH 
            VisualEffects NONE ,WAIT 
         EndScript
         OnCloseButton
            If Do( "CheckReqCapNums" ) = TRUE
               Do "Check_SaveCaps"
               GotoCard "SysCapsCard"
            EndIf
         EndScript
         OnActivated
            Do "SetupDisplay"
            
         EndScript
         OnResized
            Do "SetupDisplay"
         EndScript
      EndObj
      AreaButton "NextCap"
         Definition
            Origin 128,272
            Border BEVEL 
            Text " NEXT "
            Font "topaz",8
            Style PLAIN ,2,3
            TextColors 12,0,JAM1 
            Size 52,12
         EndScript
         OnRelease
            Do "NextCapability"
            
         EndScript
      EndObj
      AreaButton "PrevCap"
         Definition
            Origin 20,272
            Border BEVEL 
            Text " PREV "
            Font "topaz",8
            Style PLAIN ,2,3
            TextColors 12,0,JAM1 
            Size 52,12
         EndScript
         OnRelease
            Do "PrevCapability"
            
         EndScript
      EndObj
      AKey "HelpKey"
         Definition
            QualifiersPressed NONE 
            KeyPressed HELP 
         EndScript
         OnUp
            Let d = AskForHelp( HelpPath||"GOOSA.guide", "AddSysCapCard" )
            
         EndScript
      EndObj
      AreaButton "AddCap"
         Definition
            Origin 12,306
            Border BEVEL 
            Text " ADD "
            Font "topaz",8
            Style PLAIN ,2,3
            TextColors 5,0,JAM1 
            Size 44,12
         EndScript
         OnRelease
            Do "AddCapability"
            
         EndScript
      EndObj
      TextField ".CString"
         Definition
            InitialText ""
            Origin 344,21
            Size 265,12
            Border DOUBLEBEVEL 
            Label "Input [O#.q#] O#.A#:",HIGHLIGHT 
            Justification CENTER 
            MaxFieldLength 128
            Font "topaz",8
         EndScript
      EndObj
      TextField ".Number"
         Definition
            InitialText "C1234..."
            Origin 110,21
            Size 86,12
            Border DOUBLEBEVEL 
            Label "Capability #:",HIGHLIGHT 
            Justification CENTER 
            MaxFieldLength 32
            Font "topaz",8
         EndScript
      EndObj
      TextField ".ReqNumber"
         Definition
            InitialText "R1234..."
            Origin 110,105
            Size 90,12
            Border DOUBLEBEVEL 
            Label "Requirement #:",HIGHLIGHT 
            Justification CENTER 
            MaxFieldLength 32
            Font "topaz",8
         EndScript
      EndObj
      TextField ".ReqString"
         Definition
            InitialText ""
            Origin 110,63
            Size 265,12
            Border DOUBLEBEVEL 
            Label "Output O#.A#:",HIGHLIGHT 
            Justification CENTER 
            MaxFieldLength 128
            Font "topaz",8
         EndScript
      EndObj
      AreaButton "ModifyCap"
         Definition
            Origin 12,326
            Border BEVEL 
            Text " MODIFY "
            Font "topaz",8
            Style PLAIN ,2,3
            TextColors 2,0,JAM1 
            Size 68,12
         EndScript
         OnRelease
            Do "ModifyCapability"
            
         EndScript
      EndObj
      TextField ".Description"
         Definition
            InitialText "Input Object(s).Attributes that will yield..."
            Origin 110,42
            Size 500,12
            Border DOUBLEBEVEL 
            Label "Cap' Description:",HIGHLIGHT 
            Justification CENTER 
            MaxFieldLength 256
            Font "topaz",8
         EndScript
      EndObj
      TextField ".ReqDescription"
         Definition
            InitialText "Output Object(s).Attribute(s) required!"
            Origin 110,84
            Size 500,12
            Border DOUBLEBEVEL 
            Label "Req' Description:",HIGHLIGHT 
            Justification CENTER 
            MaxFieldLength 256
            Font "topaz",8
         EndScript
      EndObj
      List "Requirements_List"
         Definition
            ListDocument "RequirementsList"
            Origin 8,124
            Size 623,128
            Border INVERT BEVEL 
            Label "Requirements List:",ABOVE 
            Font "topaz",8
         EndScript
         OnRelease
            Do "SelectRequirement"
            
         EndScript
      EndObj
      AreaButton "DeleteCap"
         Definition
            Origin 12,346
            Border BEVEL 
            Text " DELETE "
            Font "topaz",8
            Style PLAIN ,2,3
            TextColors 7,0,JAM1 
            Size 68,12
         EndScript
         OnRelease
            Do "DeleteCapability"
            
         EndScript
      EndObj
      AreaButton "Return_IST"
         Definition
            Origin 12,369
            Border BEVEL 
            Text " RETURN TO IST "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 8,0,JAM1 
            Size 124,12
         EndScript
         OnRelease
            Do "SaveCapabilities"
            GotoCard "ISTCard"
         EndScript
      EndObj
      AreaButton "Return_REQ"
         Definition
            Origin 12,389
            Border BEVEL 
            Text " RETURN TO REQ's "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 8,0,JAM1 
            Size 140,12
         EndScript
         OnRelease
            Do "SaveCapabilities"
            GotoCard "UserReqsCard"
         EndScript
      EndObj
      TextMenu "Save"
         Definition
            AttachTo MENU ,"PROJECT    "
            Text "Save"
            ShortCutKey "S"
         EndScript
         Occurred
            Do "SaveCapabilities"
            Let GotCaps = FALSE
         EndScript
      EndObj
      TextMenu "Save As"
         Definition
            AttachTo MENU ,"PROJECT    "
            Text "Save As..."
            ShortCutKey "A"
         EndScript
         Occurred
            Do "SaveAsCapsFile"
            
         EndScript
      EndObj
      TextMenu "CapNumber"
         Definition
            AttachTo MENU ,"SORTS"
            Text "By Capability  # "
         EndScript
      EndObj
      TextMenu "Ascending"
         Definition
            AttachTo OBJECT ,"CapNumber"
            Text "Ascending"
         EndScript
         Occurred
            Do "SortCaps",".NUMBER",1
            
         EndScript
      EndObj
      TextMenu "Descending"
         Definition
            AttachTo OBJECT ,"CapNumber"
            Text "Descending"
         EndScript
         Occurred
            Do "SortCaps",".NUMBER",2
         EndScript
      EndObj
      TextMenu "Description"
         Definition
            AttachTo MENU ,"SORTS"
            Text "By Description   "
         EndScript
      EndObj
      TextMenu "D_Ascending"
         Definition
            AttachTo OBJECT ,"Description"
            Text "Ascending"
         EndScript
         Occurred
            Do "SortCaps",".DESCRIPTION",1
            
         EndScript
      EndObj
      TextMenu "D_Descending"
         Definition
            AttachTo OBJECT ,"Description"
            Text "Descending"
         EndScript
         Occurred
            Do "SortCaps",".DESCRIPTION",2
         EndScript
      EndObj
      TextMenu "Output"
         Definition
            AttachTo MENU ,"SORTS"
            Text "By Output  O#.A# "
         EndScript
      EndObj
      TextMenu "O_Ascending"
         Definition
            AttachTo OBJECT ,"Output"
            Text "Ascending"
         EndScript
         Occurred
            Do "SortCaps",".REQSTRING",1
            
         EndScript
      EndObj
      TextMenu "O_Descending"
         Definition
            AttachTo OBJECT ,"Output"
            Text "Descending"
         EndScript
         Occurred
            Do "SortCaps",".REQSTRING",2
         EndScript
      EndObj
      TextMenu "ReqNumber"
         Definition
            AttachTo MENU ,"SORTS"
            Text "By Requirement # "
         EndScript
      EndObj
      TextMenu "R_Ascending"
         Definition
            AttachTo OBJECT ,"ReqNumber"
            Text "Ascending"
         EndScript
         Occurred
            Do "SortCaps",".REQNUMBER",1
            
         EndScript
      EndObj
      TextMenu "R_Descending"
         Definition
            AttachTo OBJECT ,"ReqNumber"
            Text "Descending"
         EndScript
         Occurred
            Do "SortCaps",".REQNUMBER",2
         EndScript
      EndObj
      IntegerField "NumberOfReqs"
         Definition
            Limits 0,99999999
            InitialInteger 0
            Origin 438,64
            Size 50,13
            Border INVERT BEVEL 
            Label "# Req's:"
            FieldFlags NOTABCYCLE 
            MaxFieldLength 10
            Font "topaz",8
            TextColors 7,0
            AltTextColors 7,0
         EndScript
      EndObj
      IntegerField "NumberOfCaps"
         Definition
            Limits 0,99999999
            InitialInteger 0
            Origin 552,64
            Size 50,13
            Border INVERT BEVEL 
            Label "# Cap's:"
            FieldFlags NOTABCYCLE 
            MaxFieldLength 10
            Font "topaz",8
            TextColors 7,0
            AltTextColors 7,0
         EndScript
      EndObj
      ErrorTrap "UserError_1"
         Occurred
            Do "HandleInternalError"
         EndScript
      EndObj
      IntegerField "EntryNum"
         Definition
            Limits 0,99999999
            InitialInteger 0
            Origin 77,270
            Size 46,17
            Border INVERT BEVEL 
            Justification CENTER 
            MaxFieldLength 10
         EndScript
         OnRelease
            SetInteger "EntryNum",C_Cap
         EndScript
      EndObj
      List "Cap_List"
         Definition
            ListDocument "CapList"
            Origin 207,273
            Size 420,145
            Border INVERT BEVEL 
            Label "Capabilities List:",ABOVE 
            Font "topaz",8
         EndScript
         OnRelease
            Do "SelectCapability"
            
         EndScript
      EndObj
   EndObj
   Card "RTMCard"
      NoAttach
      Routine "SetupDisplay"
         ; ------------------------------------------------------
         ; SetupDisplay() Subroutine - Req's Matrix Card.
         ; ------------------------------------------------------
         
         Do "SetUpColors"
         
         If GotReqs = FALSE
            Do "ReadInRequirements"
            Let GotReqs = TRUE
         EndIf
         
         If GotCaps = FALSE
            Do "ReadInCapabilities"
            Let GotCaps = TRUE
         EndIf
         
         SetWindowTitle "Creating Matrix..."
         Delay 0,1,0
         
         Do "SetupRTM"
         SetWindowTitle WTTL[10]
      EndScript
      Routine "RTMSelected"
         ; ---------------------------
         ; RTMSelected() SubRoutine.
         ; ---------------------------
         
         Local i
         Local rnum
         Local cnum
         
         WorkWithDocument "RTMTable"
         Let rnum = TrimString( GetWord( TheLine, 1, " :" ))
         Let cnum = TrimString( GetWord( TheLine, 3, ":< " ))
         
         Let i = FirstArrayIndex( Requirement )
         
         While i <= LastArrayIndex( Requirement )
            
            If Requirement[i].Number = rnum
               Let C_Req = i
               ExitLoop
            EndIf
            
            Let i = i + 1
         EndLoop
         
         If FirstArrayIndex( Requirement ) = 0
            SetInteger "ReqNum",C_Req + 1
         Else
            SetInteger "ReqNum",C_Req
         EndIf
         
         Let i = FirstArrayIndex( Capability )
         
         While i <= LastArrayIndex( Capability )
            
            If Capability[i].Number = cnum
               Let C_Cap = i
               
               If FirstArrayIndex( Capability ) = 0
                  SetInteger "CapNum",C_Cap + 1
               Else
                  SetInteger "CapNum",C_Cap
               EndIf
               
               ExitScript
            EndIf
            
            Let i = i + 1
         EndLoop
         
         Let C_Cap = FirstArrayIndex( Capability )
         
         If FirstArrayIndex( Capability ) = 0
            SetInteger "CapNum",C_Cap + 1
         Else
            SetInteger "CapNum",C_Cap
         EndIf
         
      EndScript
      AfterAttachment
         SetWindowTitle WTTL[10]
         
         Do "SetUpColors"
         
         If Supervised = FALSE
            Do "SetupDisplay"
         EndIf
      EndScript
      Window "UserWindow"
         Definition
            Origin 0,16
            Title "Requirements Traceability Matrix:"
            WindowObjects DEPTHBUTTONS DRAGBAR 
            WindowLimits 250,15,640,480
            WindowZoom 0,13,250,15
            Size 640,390
            WindowFlags ACTIVATE TOFRONT WORKBENCH 
            VisualEffects NONE ,WAIT 
         EndScript
         OnActivated
            Do "SetupDisplay"
            
         EndScript
         OnCloseButton
            Quit
         EndScript
         OnResized
            Do "SetupDisplay"
         EndScript
      EndObj
      AreaButton "ReturnGadget"
         Definition
            Origin 8,371
            Border BEVEL 
            Text " Return To Main "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 8,0,JAM1 
            Size 132,12
         EndScript
         OnRelease
            GotoCard "MainCard"
         EndScript
      EndObj
      List "RTMList"
         Definition
            ListDocument "RTMTable"
            Origin 8,20
            Size 623,342
            Border EMBOSSED ,1,14
            Font "topaz",8
            TextColors 1,0,JAM2 
            Style PLAIN ,2,3
         EndScript
         OnRelease
            Do "RTMSelected"
            
         EndScript
      EndObj
      AreaButton "UserReqsGadget"
         Definition
            Origin 160,371
            Border BEVEL 
            Text " User Req's... "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 8,0,JAM1 
            Size 124,12
         EndScript
         OnRelease
            GotoCard "UserReqsCard"
         EndScript
      EndObj
      AreaButton "SysCapGadget"
         Definition
            Origin 330,371
            Border BEVEL 
            Text " System Capabilities... "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 8,0,JAM1 
            Size 196,12
         EndScript
         OnRelease
            GotoCard "SysCapsCard"
         EndScript
      EndObj
      AKey "HelpKey"
         Definition
            QualifiersPressed NONE 
            KeyPressed HELP 
         EndScript
         OnUp
            Dos HelpViewer|||HelpPath||"GOOSA.guide RTMCard"
            
         EndScript
      EndObj
      TextMenu "Print"
         Definition
            AttachTo MENU ,"PROJECT    "
            Text "Print "
         EndScript
      EndObj
      TextMenu "ToFile"
         Definition
            AttachTo OBJECT ,"Print"
            Text "To File"
            ShortCutKey "F"
         EndScript
         Occurred
            Do "PrintToFile","Print Matrix to file:","RTMTable"
         EndScript
      EndObj
      TextMenu "ToPar"
         Definition
            AttachTo OBJECT ,"Print"
            Text "To PAR:"
            ShortCutKey "P"
         EndScript
         Occurred
            Do "PrintToPAR","RTMTable"
         EndScript
      EndObj
      TextMenu "ToSer"
         Definition
            AttachTo OBJECT ,"Print"
            Text "To SER:"
         EndScript
         Occurred
            Do "PrintToSER","RTMTable"
         EndScript
      EndObj
      ErrorTrap "UserError_1"
         Occurred
            Do "HandleInternalError"
         EndScript
      EndObj
      IntegerField "ReqNum"
         Definition
            Limits 0,999999999
            InitialInteger 0
            Origin 528,367
            Size 50,13
            Justification CENTER 
            MaxFieldLength 10
         EndScript
         OnRelease
            SetInteger "ReqNum",C_Req
         EndScript
      EndObj
      IntegerField "CapNum"
         Definition
            Limits 0,999999999
            InitialInteger 0
            Origin 580,367
            Size 50,13
            Justification CENTER 
            MaxFieldLength 10
         EndScript
         OnRelease
            SetInteger "CapNum",C_Cap
         EndScript
      EndObj
   EndObj
   Card "CDECard"
      NoAttach
      Routine "CDESelected"
         ; ----------------------------------------------------------
         ; CDESelected() SubRoutine.
         ;    Set C_CDE to the selected CDE[].TerminatorName
         ; ----------------------------------------------------------
         
         Local index
         Local str
         Local cmp
         
         WorkWithDocument "CDEList"
         
         Let str = TrimString( GetWord( TheLine, 2, ": " ) )
         
         Let index = FirstArrayIndex( CDE )
         Let cmp   = TrimString( CDE[index].TerminatorName )
         
         While index <= LastArrayIndex( CDE )
            
            If FindChars( cmp, str, 1 ) > 0
               Let C_CDE = index
               
               If FirstArrayIndex( CDE ) = 0
                  SetInteger "EntryNum",C_CDE + 1
               Else
                  SetInteger "EntryNum",C_CDE
               EndIf
               
               ExitScript
            EndIf
            
            Let index = index + 1
            Let cmp = TrimString( CDE[index].TerminatorName )
         EndLoop
         
         Let C_CDE = FirstArrayIndex( CDE ) ; Default value.
         
         If FirstArrayIndex( CDE ) = 0
            SetInteger "EntryNum",C_CDE + 1
         Else
            SetInteger "EntryNum",C_CDE
         EndIf
         
      EndScript
      Routine "LoadCDEFile"
         ; ----------------------------------
         ; LoadCDEFile() SubRoutine
         ; ----------------------------------
         
         SetFileRequestMode REGULARMODE ,PATTERNFIELD 
         SetFileRequestPattern "#?","#?.CDEs"
         
         Let filename = AskForFileName( DBasePath, "Load CDE's:",10,16 )
         
         If Exists( filename ) AND filename <> NOTHING
            If FindChars( filename, ".CDEs", 1 ) > 0
               Dispose CDE
               Let CDE   = LoadVariable( filename )
               Let C_CDE = FirstArrayIndex( CDE )
               Do "SetupCDE"
               Let GotCDEs = TRUE
            Else
               Let filename = Do( "CorrectFileName", filename, ".CDEs" )
               
               If Exists( filename ) AND filename <> NOTHING
                  Dispose CDE
                  Let CDE   = LoadVariable( filename )
                  Let C_CDE = FirstArrayIndex( CDE )
                  Do "SetupCDE"
                  Let GotCDEs = TRUE
               EndIf
            EndIf
            
            ; User selected Cancel button on ASL.
         EndIf
         
         SetWindowTitle WTTL[11]
      EndScript
      Routine "SetupDisplay"
         ; ----------------------------------------------
         ; SetupDisplay() Subroutine - CDECard.
         ; ----------------------------------------------
         
         Local saveindex
         Let saveindex = C_CDE
         
         WorkWithDocument "CDEList"
         Clear DOCUMENT 
         
         Do "SetUpColors"
         
         If GotCDEs = FALSE
            Do "ReadInCDEs"
            Let GotCDEs = TRUE
         EndIf
         
         Do "SetupCDE"
         
         Let C_IDE = saveindex
         
         WorkWithDocument "CDEList"
         MoveCursorTo STARTOF DOCUMENT 
         Let safety = LinesInDocument
         Let name   = TrimString( CDE[C_CDE].TerminatorName )
         
         While safety > 0
            
            Let str = TrimString( GetWord( TheLine, 2, " " ))
            
            If name = str
               ExitLoop
            EndIf
            
            Let safety = safety - 1
            MoveCursor DOWN 
         EndLoop
         
         If FirstArrayIndex( CDE ) = 0
            SetInteger "EntryNum",C_CDE + 1
         Else
            SetInteger "EntryNum",C_CDE
         EndIf
         
         SetWindowTitle WTTL[11]
      EndScript
      AfterAttachment
         SetWindowTitle WTTL[11]
         
         Do "SetUpColors"
         
         If Supervised = FALSE
            Do "SetupDisplay"
         EndIf
      EndScript
      Window "UserWindow"
         Definition
            Origin 0,16
            Title "Context Descriptive Entry(s):"
            WindowObjects DEPTHBUTTONS DRAGBAR 
            WindowLimits 250,15,640,480
            WindowZoom 0,13,250,15
            Size 640,386
            WindowFlags ACTIVATE TOFRONT WORKBENCH 
            VisualEffects NONE ,WAIT 
         EndScript
         OnActivated
            Do "SetupDisplay"
            
         EndScript
         OnResized
            Do "SetupDisplay"
         EndScript
      EndObj
      AreaButton "CSTGadget"
         Definition
            Origin 171,369
            Border BEVEL 
            Text " Context System Table... "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 8,0,JAM1 
            Size 204,12
         EndScript
         OnRelease
            GotoCard "CSTCard"
         EndScript
      EndObj
      AreaButton "ReturnGadget"
         Definition
            Origin 20,369
            Border BEVEL 
            Text " Return To Main "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 8,0,JAM1 
            Size 132,12
         EndScript
         OnRelease
            GotoCard "MainCard"
         EndScript
      EndObj
      AreaButton "CSDGadget"
         Definition
            Origin 395,369
            Border BEVEL 
            Text " Context System Diagram... "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 8,0,JAM1 
            Size 220,12
         EndScript
         OnRelease
            GotoCard "CSDCard"
         EndScript
      EndObj
      List "CDEntry"
         Definition
            ListDocument "CDEList"
            Origin 9,20
            Size 621,322
            Border INVERT EMBOSSED 
            Font "topaz",8
            TextColors 1,0,JAM2 
            Style PLAIN ,2,3
         EndScript
         OnRelease
            Do "CDESelected"
            
         EndScript
      EndObj
      AreaButton "GotoEditor"
         Definition
            Origin 395,351
            Border BEVEL 
            Text " Make an Entry... "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 8,0,JAM1 
            Size 148,12
         EndScript
         OnRelease
            GotoCard "EditCDE"
         EndScript
      EndObj
      AKey "HelpKey"
         Definition
            QualifiersPressed NONE 
            KeyPressed HELP 
         EndScript
         OnUp
            Let d = AskForHelp( HelpPath||"GOOSA.guide", "CDECard" )
            
         EndScript
      EndObj
      TextMenu "Load"
         Definition
            AttachTo MENU ,"PROJECT    "
            Text "Load..."
            ShortCutKey "L"
         EndScript
         Occurred
            Do "LoadCDEFile"
            
         EndScript
      EndObj
      TextMenu "Print"
         Definition
            AttachTo MENU ,"PROJECT    "
            Text "Print "
         EndScript
      EndObj
      TextMenu "ToFile"
         Definition
            AttachTo OBJECT ,"Print"
            Text "To File"
            ShortCutKey "F"
         EndScript
         Occurred
            Do "PrintToFile","Print CDE's to file:","CDEList"
         EndScript
      EndObj
      TextMenu "ToPar"
         Definition
            AttachTo OBJECT ,"Print"
            Text "To PAR:"
            ShortCutKey "P"
         EndScript
         Occurred
            Do "PrintToPAR","CDEList"
         EndScript
      EndObj
      TextMenu "ToSer"
         Definition
            AttachTo OBJECT ,"Print"
            Text "To SER:"
         EndScript
         Occurred
            Do "PrintToSER","CDEList"
         EndScript
      EndObj
      ErrorTrap "UserError_1"
         Occurred
            Do "HandleInternalError"
         EndScript
      EndObj
      IntegerField "EntryNum"
         Definition
            Limits 0,999999999
            InitialInteger 0
            Origin 581,349
            Size 50,13
            Justification CENTER 
            MaxFieldLength 10
         EndScript
         OnRelease
            SetInteger "EntryNum",C_CDE
         EndScript
      EndObj
   EndObj
   Card "EditCDE"
      NoAttach
      Routine "SetFlags"
         If UpperCase( Arg1 ) = "SOURCE"
            SetObjectState "SourceFlag",TRUE
            SetObjectState "SinkFlag",FALSE
            SetObjectState "SrcSinkFlag",FALSE
            
         ElseIf UpperCase( Arg1 ) = "SINK"
            SetObjectState "SourceFlag",FALSE
            SetObjectState "SinkFlag",TRUE
            SetObjectState "SrcSinkFlag",FALSE
            
         Else
            SetObjectState "SourceFlag",FALSE
            SetObjectState "SinkFlag",FALSE
            SetObjectState "SrcSinkFlag",TRUE
         EndIf
      EndScript
      Routine "PrevCDE"
         ; -----------------------
         ; PrevCDE() SubRoutine.
         ; -----------------------
         
         Let CDE[C_CDE] = GetDBObjects
         
         Let C_CDE = PreviousArrayIndex( CDE, C_CDE )
         
         If NOT SearchFound
            Let C_CDE = LastArrayIndex( CDE )
         EndIf
         
         Do "DisplayCDE"
         
      EndScript
      Routine "NextCDE"
         ; ------------------------
         ; NextCDE() SubRoutine.
         ; ------------------------
         
         Let CDE[C_CDE] = GetDBObjects
         
         Let C_CDE = NextArrayIndex( CDE, C_CDE )
         
         If NOT SearchFound
            Let C_CDE = FirstArrayIndex( CDE )
         EndIf
         
         Do "DisplayCDE"
         
      EndScript
      Routine "Check_SaveCDEs"
         ; ---------------------------------------
         ; Check_SaveCDEs( filename ) SubRoutine.
         ; ---------------------------------------
         
         Local ttl
         Local ans
         Local msg
         Local fname
         
         If Do( "EmptyString", Arg1 ) = TRUE
            Let fname = DefaultDBase||".CDEs"
         Else
            Let fname = TrimString( Arg1 )
         EndIf
         
         Let ttl = "User WARNING:"
         Let msg = "Any changes you've made have to be saved to be"||Char(10)
         Let msg = msg||"made permanent, Should they be saved?"
         
         Let ans = AskForResponse( msg, ttl, "Save them!|NO!" )
         
         If ans = 2
            ExitScript
         EndIf
         
         Do "SaveCDEs",fname
      EndScript
      Routine "ModifyCDE"
         ; -------------------------
         ; ModifyCDE() Subroutine.
         ; -------------------------
         
         Let CDE[C_CDE] = GetDBObjects
         
         Do "SetupCDE"
         Do "DisplayCDE"
         
      EndScript
      Routine "HighlightCDE"
         ; ----------------------------
         ; HighlightCDE() Subroutine.
         ; ----------------------------
         
         Local safety
         
         WorkWithDocument "CDEList"
         MoveCursorTo STARTOF DOCUMENT 
         Let safety = LinesInDocument
         
         While safety > 0
            
            If FindChars( TheLine, CDE[C_CDE].TerminatorName, 1 ) > 0
               ExitLoop
            EndIf
            
            Let safety = safety - 1
            MoveCursor DOWN 
         EndLoop
      EndScript
      Routine "CDESelected"
         ; ----------------------------------------------------------
         ; CDESelected() SubRoutine.
         ;    Set C_CDE to the selected CDE[].TerminatorName
         ; ----------------------------------------------------------
         
         Local index
         Local str
         Local cmp
         
         WorkWithDocument "CDEList"
         
         Let str = TrimString( GetWord( TheLine, 2, ": " ) )
         
         Let index = FirstArrayIndex( CDE )
         Let cmp   = TrimString( CDE[index].TerminatorName )
         
         While index <= LastArrayIndex( CDE )
            
            If FindChars( cmp, str, 1 ) > 0
               Let C_CDE = index
               ExitLoop
            EndIf
            
            Let index = index + 1
            Let cmp = TrimString( CDE[index].TerminatorName )
         EndLoop
         
         Do "DisplayCDE",TRUE
      EndScript
      Routine "DeleteCDE"
         ; ------------------------
         ; DeleteCDE() Subroutine.
         ; ------------------------
         
         DeleteArrayEntry CDE,C_CDE
         
         If VarType( CDE[C_CDE] ) = "Nothing"
            Let C_CDE = LastArrayIndex( CDE )
         EndIf
         
         Do "SetupCDE"
         Do "DisplayCDE"
         
      EndScript
      Routine "SaveAsCDEFile"
         ; ------------------------------
         ; SaveAsCDEFile() SubRoutine.
         ; ------------------------------
         
         Local filename
         Local ttl
         Local msg
         
         SetFileRequestMode SAVEFILEMODE ,REJECTICONS 
         SetFileRequestPattern "#?","#?.CDEs"
         
         Let filename = AskForFileName( DBasePath,"Save CDEs:",10,16 )
         
         If filename <> NOTHING
            If FindChars( filename, ".CDEs", 1 ) > 0
               Let C_CDE = FirstArrayIndex( CDE )
               Do "DisplayCDE"
               
               While C_CDE <= LastArrayIndex( CDE )
                  
                  Let CDE[C_CDE] = GetDBObjects
                  
                  If Do( "EmptyString", CDE[C_CDE].TerminatorName ) = FALSE
                     SaveVariable CDE,filename
                  EndIf
                  
                  Let C_CDE = C_CDE + 1
                  Do "DisplayCDE"
               EndLoop
            Else
               Let filename = Do( "CorrectFileName", filename, ".CDEs" )
               
               If filename <> NOTHING
                  Let C_CDE = FirstArrayIndex( CDE )
                  Do "DisplayCDE"
                  
                  While C_CDE <= LastArrayIndex( CDE )
                     
                     Let CDE[C_CDE] = GetDBObjects
                     
                     If Do( "EmptyString", CDE[C_CDE].TerminatorName ) = FALSE
                        SaveVariable CDE,filename
                     EndIf
                     
                     Let C_CDE = C_CDE + 1
                     Do "DisplayCDE"
                  EndLoop
               EndIf
            EndIf
         EndIf
         
         Let C_CDE = FirstArrayIndex( CDE )
         Do "DisplayCDE"
      EndScript
      Routine "DisplayCDE"
         ; ------------------------------
         ; DisplayCDE() Subroutine.
         ; ------------------------------
         
         SetDBObjects CDE[C_CDE]
         
         If FirstArrayIndex( CDE ) = 0
            SetInteger "EntryNum",C_CDE + 1
         Else
            SetInteger "EntryNum",C_CDE
         EndIf
         
         If Arg1 = FALSE OR Arg1 = NOTHING
            Do "HighlightCDE"
         EndIf
         
         SetWindowTitle WTTL[12]
      EndScript
      Routine "SortCDEs"
         ; ------------------------------------------
         ; SortCDEs( key, direction ) SubRoutine.
         ; ------------------------------------------
         
         Do "SortRecords","CDE",Arg1,Arg2,215,116
         
         Let C_CDE = FirstArrayIndex( CDE )
         
         Do "SetupCDE"
         
      EndScript
      Routine "AddCDE"
         ; ----------------------
         ; AddCDE() SubRoutine.
         ; ----------------------
         
         Local i
         
         Let i = C_CDE
         
         If C_CDE < LastArrayIndex( CDE )
            Let C_CDE = C_CDE + 1
         Else
            Let C_CDE = LastArrayIndex( CDE )
         EndIf
         
         InsertArrayEntry CDE,C_CDE
         
         Let CDE[C_CDE].TerminatorDescription = "COPY_"||CDE[i].TerminatorDescription
         
         Let CDE[C_CDE].SystemTitle    = CDE[i].SystemTitle
         Let CDE[C_CDE].TerminatorName = "COPY_"||CDE[i].TerminatorName
         Let CDE[C_CDE].ObjectNums     = "COPY_"||CDE[i].ObjectNums
         Let CDE[C_CDE].Number         = CDE[i].Number||"_COPY"
         
         Let CDE[C_CDE].SourceFlag  = CDE[i].SourceFlag
         Let CDE[C_CDE].SinkFlag    = CDE[i].SinkFlag
         Let CDE[C_CDE].SrcSinkFlag = CDE[i].SrcSinkFlag
         
         Do "SetupCDE"
         Do "DisplayCDE"
      EndScript
      Routine "SetupDisplay"
         ; -----------------------------------------
         ; SetupDisplay() Subroutine - EditCDE.
         ; -----------------------------------------
         
         Do "SetUpColors"
         
         DisableObject ".SystemTitle"
         
         Do "DrawRaisedBox",31,79,131,53  ; Src & Sink CheckBoxes
         Do "DrawRaisedBox",219,81,178,30 ; Prev & Next buttons
         
         If C_CDE < FirstArrayIndex( CDE )
            Let C_CDE = FirstArrayIndex( CDE )
         EndIf
         
         Do "DisplayCDE"
      EndScript
      Routine "ChangeSystemTitle"
         ; ---------------------------------
         ; ChangeSystemTitle() SubRoutine.
         ; ---------------------------------
         
         Local ttl
         Local msg
         Local st
         Local ans
         
         Let st = TrimString( TextFrom( ".SystemTitle" ) )
         
         Let ttl = "User WARNING:"
         Let msg = "Do you really want to change all CDE titles to"||Char(10)
         Let msg = msg||"   "||st||"?"
         
         Let ans = AskForResponse( msg, ttl, "Change them!|CANCEL" )
         
         If ans = 2
            ExitScript
         EndIf
         
         Let ans = FirstArrayIndex( CDE )
         
         While ans <= LastArrayIndex( CDE )
            
            If Do( "EmptyString", CDE[ans].TerminatorName ) = FALSE
               Let CDE[ans].SystemTitle = st
            EndIf
            
            Let ans = ans + 1
         EndLoop
         
         Do "SetupCDE"
         
         Let C_CDE = FirstArrayIndex( CDE )
         Do "DisplayCDE"
         
      EndScript
      AfterAttachment
         SetWindowTitle WTTL[12]
         
         Do "SetUpColors"
         
         If Supervised = FALSE
            Do "SetupDisplay"
         EndIf
      EndScript
      Window "UserWindow"
         Definition
            Origin 14,16
            Title "Context Descriptive Entry:"
            WindowObjects CLOSEBUTTON DEPTHBUTTONS DRAGBAR 
            WindowLimits 250,15,640,480
            WindowZoom 0,13,250,15
            Size 610,350
            WindowFlags ACTIVATE TOFRONT WORKBENCH 
            VisualEffects NONE ,WAIT 
         EndScript
         OnActivated
            Do "SetupDisplay"
            
         EndScript
         OnCloseButton
            Do "Check_SaveCDEs"
            
            GotoCard "CDECard"
            
         EndScript
         OnResized
            Do "SetupDisplay"
         EndScript
      EndObj
      TextField ".SystemTitle"
         Definition
            InitialText "Enter Title of the overall system/program..."
            Origin 92,20
            Size 500,12
            Border DOUBLEBEVEL 
            Label "Title:",HIGHLIGHT 
            Justification CENTER 
            MaxFieldLength 256
            Font "topaz",8
         EndScript
         OnRelease
            Do "ChangeSystemTitle"
         EndScript
      EndObj
      TextField ".TerminatorName"
         Definition
            InitialText "Enter Terminators name..."
            Origin 92,41
            Size 500,12
            Border DOUBLEBEVEL 
            Label "Terminator:",HIGHLIGHT 
            Justification CENTER 
            MaxFieldLength 256
            Font "topaz",8
         EndScript
      EndObj
      TextField ".TerminatorDescription"
         Definition
            InitialText "How does Terminator relate?"
            Origin 92,62
            Size 500,12
            Border DOUBLEBEVEL 
            Label "Relationship:",HIGHLIGHT 
            Justification CENTER 
            MaxFieldLength 256
            Font "topaz",8
         EndScript
      EndObj
      AreaButton "PrevCDE"
         Definition
            Origin 225,90
            Border BEVEL 
            Text " PREV "
            Font "topaz",8
            Style BOLD ,1,13
            TextColors 12,0,JAM1 
            Size 52,12
         EndScript
         OnRelease
            Do "PrevCDE"
            
         EndScript
      EndObj
      AreaButton "NextCDE"
         Definition
            Origin 339,90
            Border BEVEL 
            Text " NEXT "
            Font "topaz",8
            Style BOLD ,1,13
            TextColors 12,0,JAM1 
            Size 52,12
         EndScript
         OnRelease
            Do "NextCDE"
            
         EndScript
      EndObj
      AreaButton "DeleteCDE"
         Definition
            Origin 519,105
            Border BEVEL 
            Text " DELETE "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 7,0,JAM1 
            Size 68,12
         EndScript
         OnRelease
            Do "DeleteCDE"
            
         EndScript
      EndObj
      AKey "HelpKey"
         Definition
            QualifiersPressed NONE 
            KeyPressed HELP 
         EndScript
         OnUp
            Let d = AskForHelp( HelpPath||"GOOSA.guide", "EditCDECard" )
            
         EndScript
      EndObj
      AreaButton "AddCDE"
         Definition
            Origin 445,86
            Border BEVEL 
            Text " ADD "
            Font "topaz",8
            Style BOLD ,1,13
            TextColors 5,0,JAM1 
            Size 44,12
         EndScript
         OnRelease
            Do "AddCDE"
            
         EndScript
      EndObj
      AreaButton "ModifyCDE"
         Definition
            Origin 445,105
            Border BEVEL 
            Text " MODIFY "
            Font "topaz",8
            Style PLAIN ,2,3
            TextColors 2,0,JAM1 
            Size 68,12
         EndScript
         OnRelease
            Do "ModifyCDE"
            
         EndScript
      EndObj
      TextField ".ObjectNums"
         Definition
            InitialText "Object numbers (string)"
            Origin 92,137
            Size 500,12
            Border DOUBLEBEVEL 
            Label "Object #'s:",HIGHLIGHT 
            Justification CENTER 
            MaxFieldLength 256
            Font "topaz",8
         EndScript
      EndObj
      TextMenu "Save"
         Definition
            AttachTo MENU ,"PROJECT    "
            Text "Save"
            ShortCutKey "S"
         EndScript
         Occurred
            Do "SaveCDEs"
            Let GotCDEs = FALSE
            
         EndScript
      EndObj
      TextMenu "Save As"
         Definition
            AttachTo MENU ,"PROJECT    "
            Text "Save As..."
            ShortCutKey "A"
         EndScript
         Occurred
            Do "SaveAsCDEFile"
            
         EndScript
      EndObj
      TextMenu "Terminator"
         Definition
            AttachTo MENU ,"SORTS"
            Text "By Terminator Name "
         EndScript
      EndObj
      TextMenu "Ascending"
         Definition
            AttachTo OBJECT ,"Terminator"
            Text "Ascending"
         EndScript
         Occurred
            Do "SortCDEs",".TERMINATORNAME",1
         EndScript
      EndObj
      TextMenu "Descending"
         Definition
            AttachTo OBJECT ,"Terminator"
            Text "Descending"
         EndScript
         Occurred
            Do "SortCDEs",".TERMINATORNAME",2
         EndScript
      EndObj
      AreaButton ".SourceFlag"
         Definition
            Origin 127,84
            Border CHECK 
            Label "Source of Info:",HIGHLIGHT 
            Size 17,16
         EndScript
         OnRelease
            SetObjectState ".SourceFlag",TRUE
            SetObjectState ".SinkFlag",FALSE
            SetObjectState ".SrcSinkFlag",FALSE
            
         EndScript
      EndObj
      AreaButton ".SinkFlag"
         Definition
            Origin 127,100
            Border CHECK 
            Label "Sink of Info:",HIGHLIGHT 
            Size 17,16
         EndScript
         OnRelease
            SetObjectState ".SourceFlag",FALSE
            SetObjectState ".SinkFlag",TRUE
            SetObjectState ".SrcSinkFlag",FALSE
            
            
         EndScript
      EndObj
      AreaButton ".SrcSinkFlag"
         Definition
            Origin 127,116
            Border CHECK 
            Label "Source & Sink:",HIGHLIGHT 
            Size 27,11
         EndScript
         OnRelease
            SetObjectState ".SourceFlag",FALSE
            SetObjectState ".SinkFlag",FALSE
            SetObjectState ".SrcSinkFlag",TRUE
            
         EndScript
      EndObj
      ErrorTrap "UserError_1"
         Occurred
            Do "HandleInternalError"
         EndScript
      EndObj
      IntegerField "EntryNum"
         Definition
            Limits 0,99999999
            InitialInteger 0
            Origin 283,89
            Size 50,14
            Border INVERT BEVEL 
            Justification CENTER 
            MaxFieldLength 10
         EndScript
         OnRelease
            SetInteger "EntryNum",C_CDE
         EndScript
      EndObj
      List "CDEs"
         Definition
            ListDocument "CDEList"
            Origin 10,170
            Size 590,175
            Border INVERT BEVEL 
            Label "Context Descriptive Entry(s):",ABOVE 
            Font "topaz",8
         EndScript
         OnRelease
            Do "CDESelected"
            
         EndScript
      EndObj
      TextMenu "ModifyTitle"
         Definition
            AttachTo MENU ,"PROJECT    "
            Text "Change System Title"
         EndScript
         Occurred
            EnableObject ".SystemTitle"
         EndScript
      EndObj
   EndObj
   Card "IDECard"
      NoAttach
      Routine "IDESelected"
         ; --------------------------------------------------
         ; IDESelected() Script for IDTable Gadget Release.
         ; --------------------------------------------------
         
         Local i
         Local str
         
         Let i = FirstArrayIndex( IDE )
         
         WorkWithDocument "IDTable"
         Let str = TrimString( GetWord( TheLine, 3, ":" ))
         
         While i <= LastArrayIndex( IDE )
            
            If TrimString( IDE[ i ].Name ) = str
               
               If FirstArrayIndex( IDE ) = 0
                  SetInteger "EntryNum",i + 1
               Else
                  SetInteger "EntryNum",i
               EndIf
               
               Let C_IDE = i
               ExitLoop
            EndIf
            
            Let i = i + 1
         EndLoop
      EndScript
      Routine "SetupDisplay"
         ; -----------------------------------------
         ; SetupDisplay() Subroutine - IDECard.
         ; -----------------------------------------
         
         Local str
         Local name
         Local safety
         Local saveindex
         Let saveindex = C_IDE
         
         Do "SetUpColors"
         
         SetWindowTitle "Please WAIT!  Processing IDE's..."
         
         Do "ReadInIDEs"
         Do "SetupIDE"
         
         Let C_IDE = saveindex
         
         WorkWithDocument "IDTable"
         MoveCursorTo STARTOF DOCUMENT 
         Let safety = LinesInDocument
         Let name   = TrimString( IDE[C_IDE].Name )
         
         While safety > 0
            
            Let str = TrimString( GetWord( TheLine, 3, ":" ))
            
            If name = str
               ExitLoop
            EndIf
            
            Let safety = safety - 1
            MoveCursor DOWN 
         EndLoop
         
         If FirstArrayIndex( IDE ) = 0
            SetInteger "EntryNum",C_IDE + 1
         Else
            SetInteger "EntryNum",C_IDE
         EndIf
         
         SetWindowTitle WTTL[13]
      EndScript
      AfterAttachment
         SetWindowTitle WTTL[13]
         
         Do "SetUpColors"
         
         If Supervised = FALSE
            Do "SetupDisplay"
         EndIf
      EndScript
      Routine "LoadIDEFile"
         ; ---------------------------
         ; LoadIDEFile() Subroutine.
         ; ---------------------------
         
         SetFileRequestMode REGULARMODE ,PATTERNFIELD 
         SetFileRequestPattern "#?","#?.IDEs"
         
         Let filename = AskForFileName( DBasePath, "Load IDE's:",10,13 )
         
         If filename <> NOTHING
            
            If FindChars( filename, ".IDEs", 1 ) > 0
               Dispose IDE
               
               Let IDE     = LoadVariable( filename )
               Let C_IDE   = FirstArrayIndex( IDE )
               Let GotIDEs = TRUE
            Else
               Let filename = Do( "CorrectFileName", filename, ".IDEs" )
               
               If Exists( filename ) AND filename <> NOTHING
                  Dispose IDE
                  
                  Let IDE     = LoadVariable( filename )
                  Let C_IDE   = FirstArrayIndex( IDE )
                  Let GotIDEs = TRUE
               EndIf
            EndIf
         EndIf
         
      EndScript
      Window "UserWindow"
         Definition
            Origin 0,16
            Title "Information Descriptive Entry(s):"
            WindowObjects DEPTHBUTTONS DRAGBAR 
            WindowLimits 250,15,640,480
            WindowZoom 0,13,250,15
            Size 640,378
            WindowFlags ACTIVATE TOFRONT WORKBENCH 
            VisualEffects NONE ,WAIT 
         EndScript
         OnActivated
            Do "SetupDisplay"
            
         EndScript
         OnResized
            Do "SetupDisplay"
         EndScript
      EndObj
      AreaButton "ISTGadget"
         Definition
            Origin 8,359
            Border BEVEL 
            Text " Info' Structure Table... "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 8,0,JAM1 
            Size 212,12
         EndScript
         OnRelease
            GotoCard "ISTCard"
         EndScript
      EndObj
      AreaButton "ReturnGadget"
         Definition
            Origin 8,341
            Border BEVEL 
            Text " Return To Main "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 8,0,JAM1 
            Size 132,12
         EndScript
         OnRelease
            GotoCard "MainCard"
         EndScript
      EndObj
      AreaButton "ISDGadget"
         Definition
            Origin 228,359
            Border BEVEL 
            Text " Info' Structure Diagram... "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 8,0,JAM1 
            Size 228,12
         EndScript
         OnRelease
            GotoCard "ISDCard"
         EndScript
      EndObj
      List "IDTableList"
         Definition
            ListDocument "IDTable"
            Origin 9,20
            Size 622,313
            Border INVERT BEVEL 
            Font "topaz",8
            TextColors 1,0,JAM2 
            Style PLAIN ,2,3
         EndScript
         OnRelease
            Do "IDESelected"
            
         EndScript
      EndObj
      AreaButton "GotoEditor"
         Definition
            Origin 162,341
            Border BEVEL 
            Text " Make an Entry... "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 8,0,JAM1 
            Size 148,12
         EndScript
         OnRelease
            GotoCard "EditIDE"
         EndScript
      EndObj
      AKey "HelpKey"
         Definition
            QualifiersPressed NONE 
            KeyPressed HELP 
         EndScript
         OnUp
            Let d = AskForHelp( HelpPath||"GOOSA.guide", "IDECard" )
            
         EndScript
      EndObj
      TextMenu "Load"
         Definition
            AttachTo MENU ,"PROJECT    "
            Text "Load..."
            ShortCutKey "L"
         EndScript
         Occurred
            Do "LoadIDEFile"
            
         EndScript
      EndObj
      TextMenu "Print"
         Definition
            AttachTo MENU ,"PROJECT    "
            Text "Print "
         EndScript
      EndObj
      TextMenu "ToFile"
         Definition
            AttachTo OBJECT ,"Print"
            Text "To File"
            ShortCutKey "F"
         EndScript
         Occurred
            Do "PrintToFile","Print IDE's to file:","IDTable"
         EndScript
      EndObj
      TextMenu "ToPar"
         Definition
            AttachTo OBJECT ,"Print"
            Text "To PAR:"
            ShortCutKey "P"
         EndScript
         Occurred
            Do "PrintToPAR","IDTable"
         EndScript
      EndObj
      TextMenu "ToSer"
         Definition
            AttachTo OBJECT ,"Print"
            Text "To SER:"
         EndScript
         Occurred
            Do "PrintToSER","IDTable"
         EndScript
      EndObj
      ErrorTrap "UserError_1"
         Occurred
            Do "HandleInternalError"
         EndScript
      EndObj
      AKey "DwnArrow"
         Definition
            QualifiersPressed NONE 
            KeyPressed DOWN 
         EndScript
         OnDown
            ;WorkWithDocument "IDTable"
            ;MoveCursor DOWN
            ;RefreshObject "IDTable"
            
         EndScript
         OnRepeated
            ;WorkWithDocument "IDTable"
            ;MoveCursor DOWN ,10
            ;RefreshObject "IDTable"
            
         EndScript
      EndObj
      AKey "UpArrow"
         Definition
            QualifiersPressed NONE 
            KeyPressed UP 
         EndScript
         OnDown
            ;WorkWithDocument "IDTable"
            ;MoveCursor UP
            ;RefreshObject "IDTable"
            
         EndScript
         OnRepeated
            ;WorkWithDocument "IDTable"
            ;MoveCursor UP ,10
            ;RefreshObject "IDTable"
            
         EndScript
      EndObj
      IntegerField "EntryNum"
         Definition
            Limits 0,99999999
            InitialInteger 0
            Origin 583,339
            Size 50,13
            Justification CENTER 
            MaxFieldLength 10
         EndScript
         OnRelease
            SetInteger "EntryNum",C_IDE
         EndScript
      EndObj
   EndObj
   Card "EditIDE"
      NoAttach
      Routine "SetObjectTypeButtons"
         ; ------------------------------------------------
         ; SetObjectTypeButtons( IDE_Name ) Subroutine.
         ; ------------------------------------------------
         
         Local i
         
         Let i = FirstArrayIndex( Normal )
         
         While i <= LastArrayIndex( Normal )
            If Arg1 = Normal[i].ID
               SetObjectState "NormalType",TRUE
               ExitScript
            EndIf
            
            Let i = i + 1
         EndLoop
         
         Let i = FirstArrayIndex( Supertype )
         
         While i <= LastArrayIndex( Supertype )
            If Arg1 = Supertype[i].Name
               SetObjectState "SuperType",TRUE
               ExitScript
            EndIf
            
            Let i = i + 1
         EndLoop
         
         Let i = FirstArrayIndex( Subtype )
         
         While i <= LastArrayIndex( Subtype )
            If Arg1 = Subtype[i].Name
               SetObjectState "SubType",TRUE
               ExitScript
            EndIf
            
            Let i = i + 1
         EndLoop
         
         
      EndScript
      Routine "SetNumIDEs"
         ; --------------------------------
         ; SetNumIDEs() Subroutine.
         ; --------------------------------
         
         Local first
         Local last
         
         Let last  = LastArrayIndex( IDE )
         Let first = FirstArrayIndex( IDE )
         
         If first = 0
            Let last = last + 1
         EndIf
         
         SetInteger "NumIDES",last
      EndScript
      Routine "DeleteIDE"
         ; ---------------------------------------------
         ; DeleteIDE() Subroutine.
         ; ---------------------------------------------
         
         DeleteArrayEntry IDE,C_IDE
         
         If VarType( IDE[C_IDE] ) = "Nothing"
            Let C_IDE = LastArrayIndex( IDE )
         EndIf
         
         Do "DisplayIDE"
         Do "SetNumIDEs"
         
      EndScript
      Routine "PrevIDE"
         ; ---------------------------------------
         ; PrevIDE ButtonRelease Script.
         ; ---------------------------------------
         
         Let IDE[C_IDE] = GetDBObjects
         Let C_IDE      = PreviousArrayIndex( IDE, C_IDE )
         
         If NOT SearchFound
            Let C_IDE = LastArrayIndex( IDE )
         EndIf
         
         SetObjectState "SubType",FALSE
         SetObjectState "SuperType",FALSE
         SetObjectState "NormalType",FALSE
         
         Do "DisplayIDE"
         
      EndScript
      Routine "NextIDE"
         ; --------------------------------------
         ; NextIDE Button Release script.
         ; --------------------------------------
         
         Let IDE[C_IDE] = GetDBObjects
         
         Let C_IDE = NextArrayIndex( IDE, C_IDE )
         
         If NOT SearchFound
            Let C_IDE = FirstArrayIndex( IDE )
         EndIf
         
         SetObjectState "SubType",FALSE
         SetObjectState "SuperType",FALSE
         SetObjectState "NormalType",FALSE
         
         Do "DisplayIDE"
         
      EndScript
      Routine "DisplayIDE"
         ; -----------------------------------------
         ; DisplayIDE() Subroutine.
         ; -----------------------------------------
         
         SetDBObjects IDE[C_IDE]
         
         SetWindowTitle WTTL[14]
         
         If FirstArrayIndex( IDE ) = 0
            SetInteger "EntryNum",C_IDE + 1
         Else
            SetInteger "EntryNum",C_IDE
         EndIf
         
         Do "SetObjectTypeButtons",IDE[C_IDE].Name
      EndScript
      Routine "Check_SaveIDEs"
         ; ----------------------------------------
         ; Check_SaveIDEs( filename ) SubRoutine.
         ; ----------------------------------------
         
         Local ttl
         Local ans
         Local msg
         Local fname
         
         If Do( "EmptyString", Arg1 ) = TRUE
            Let fname = DefaultDBase||".IDEs"
         Else
            Let fname = TrimString( Arg1 )
         EndIf
         
         Let ttl = "User WARNING:"
         Let msg = "Any changes you've made have to be saved to be"||Char(10)
         Let msg = msg||"made permanent, Should they be saved?"
         
         Let ans = AskForResponse( msg, ttl, "Save them!|NO!" )
         
         If ans = 2
            ExitScript
         EndIf
         
         Do "SaveIDEs",fname
      EndScript
      Routine "ModifyIDE"
         ; -------------------------------------------
         ; ModifyIDE() Subroutine.
         ; -------------------------------------------
         
         Let IDE[C_IDE] = GetDBObjects
         
         Do "DisplayIDE"
         
         If ObjectState( "NormalType" ) = TRUE
            Do "DiffuseIDE",1
         ElseIf ObjectState( "SuperType" ) = TRUE
            Do "DiffuseIDE",2
         ElseIf ObjectState( "SubType" ) = TRUE
            Do "DiffuseIDE",3
         EndIf
         
      EndScript
      Routine "DiffuseIDE"
         ; ---------------------------------------
         ; DiffuseIDE( ObjectType ) Subroutine.
         ;
         ; Add a new IDE entry to the correct
         ; Object array, either Normal, Supertype
         ; or Subtype.
         ; ---------------------------------------
         
         Local name
         Local index
         Local safety
         Local which
         Local i
         Local len
         Local col
         
         Let index       = 0
         Let atrs[index] = ""
         Let name        = TrimString( TextFrom( ".Name" ) )
         Let len         = NumberOfChars( name )
         Let which       = Integer( TextFrom( ".Number" ))
         
         SetWordDelimiters " "
         WorkWithDocument "AttribDescription"
         MoveCursorTo STARTOF DOCUMENT 
         
         Let safety = LinesInDocument
         
         If FindChars( TheLine, name, 1 ) > 1
            MoveCursor RIGHT ,FindChars( TheLine, name, 1 ) + len
            Let col     = TheColumnNumber
            Let atrs[0] = TrimString( GetChars( TheLine, col, NumberOfChars( TheLine ) - col + 1))
            MoveCursor DOWN 
            MoveCursorTo STARTOF LINE 
            Let safety  = safety - 1
         EndIf
         
         Let index = 1
         
         While safety >= 0 ; Gather the Attr's from the "AttribDescription"
            
            If FindChars( TheLine, name, 1 ) > 1
               MoveCursor RIGHT ,FindChars( TheLine, name, 1 ) + len
               Let col         = TheColumnNumber
               Let atrs[index] = TrimString( GetChars( TheLine, col, NumberOfChars( TheLine ) - col + 1))
               Let index       = index + 1
            EndIf
            
            MoveCursor DOWN 
            MoveCursorTo STARTOF LINE 
            Let safety = safety - 1
         EndLoop
         
         If Arg1 = 1
            
            SetWindowTitle "Adding "||name||" to Normal Objects..."
            Let Normal[ which ].ID         = name
            Let Normal[ which ].ParentName = "FromIDEs"
            Let Normal[ which ].Origin     = 0
            Let Normal[ which ].Number     = which
            Let Normal[ which ].AttrCount  = index
            Let Normal[ which ].AttrNumber = ""
            Let Normal[ which ].AttrName   = ""
            
            Let i = 1
            
            While i <= index
               Let Normal[ which ].AttrNumber = Normal[ which ].AttrNumber||i||Char( 10 )
               Let Normal[ which ].AttrName   = Normal[ which ].AttrName||atrs[i-1]||Char( 10 )
               Let i = i + 1
            EndLoop
            
         ElseIf Arg1 = 2
            
            SetWindowTitle "Adding "||name||" to SuperType Objects..."
            Let Supertype[ which ].Name        = name
            Let Supertype[ which ].ParentName  = "FromIDEs"
            Let Supertype[ which ].NumChildren = 0
            Let Supertype[ which ].Child       = "None"
            Let Supertype[ which ].Number      = which
            Let Supertype[ which ].AttrCount   = index
            Let Supertype[ which ].AttrNumber  = ""
            Let Supertype[ which ].AttrName    = ""
            
            Let i = 1
            
            While i <= index
               Let Supertype[ which ].AttrNumber = Supertype[ which ].AttrNumber||i||Char( 10 )
               Let Supertype[ which ].AttrName   = Supertype[ which ].AttrName||atrs[i-1]||Char( 10 )
               Let i = i + 1
            EndLoop
            
         ElseIf Arg1 = 3
            
            SetWindowTitle "Adding "||name||" to SubType Objects..."
            Let Subtype[ which ].Name        = name
            Let Subtype[ which ].ParentName  = "FromIDEs"
            Let Subtype[ which ].NextChild   = "NoNextChild"
            Let Subtype[ which ].Number      = which
            Let Subtype[ which ].AttrCount   = index
            Let Subtype[ which ].AttrNumber  = ""
            Let Subtype[ which ].AttrName    = ""
            
            Let i = 1
            
            While i <= index
               Let Subtype[ which ].AttrNumber = Subtype[ which ].AttrNumber||i||Char( 10 )
               Let Subtype[ which ].AttrName   = Subtype[ which ].AttrName||atrs[i-1]||Char( 10 )
               Let i = i + 1
            EndLoop
         EndIf
         
         SetWindowTitle WTTL[14]
      EndScript
      Routine "SetupDisplay"
         ; -----------------------------------------------
         ; Setupdisplay() Subroutine - EditIDECard.
         ; -----------------------------------------------
         
         Do "SetUpColors"
         
         Do "DisplayIDE"
         
         SetPen 7 ; RED
         PrintText " Attribute  ",9,80
         PrintText "Description:",9,90
         PrintText "   Object   ",9,255
         PrintText "Description:",9,265
         PrintText "Attribute Summary:",70,337
         PrintText "Domain:",430,337
         PrintText "Object Type:  Normal:     Super:     Sub:",166,165
         
         Do "DrawRaisedBox",270,161,265,17
         Do "DrawRaisedBox",27,194,65,56
         
         WorkWithDocument "ReturnAddress"
         MoveCursorTo STARTOF DOCUMENT 
         
         If TheLine = CardName
            WorkWithDocument "ReturnObjectList"
            SetText ".Name",TheLine
         EndIf
         
         Do "SetNumIDES"
      EndScript
      Routine "AddIDEEntry"
         ; -----------------------------------------
         ; AddIDEEntry() Subroutine.
         ; -----------------------------------------
         
         Local name
         Local newitem
         Local save
         
         Let save = C_IDE
         
         If C_IDE < LastArrayindex( IDE )
            Let C_IDE = C_IDE + 1
         Else
            Let C_IDE = LastArrayIndex( IDE )
         EndIf
         
         InsertArrayEntry IDE,C_IDE
         
         Let IDE[C_IDE].Identifiers     = "COPY_"||IDE[save].Identifiers
         Let IDE[C_IDE].Name            = "COPY_"||IDE[save].Name
         Let IDE[C_IDE].AttrSummary     = "COPY_"||Char(10)||IDE[save].AttrSummary
         Let IDE[C_IDE].Description     = "COPY_"||Char(10)||IDE[save].Description
         Let IDE[C_IDE].AttrDescription = "COPY_"||Char(10)||IDE[save].AttrDescription
         Let IDE[C_IDE].Domain          = "COPY_"||Char(10)||IDE[save].Domain
         Let IDE[C_IDE].Number          = IDE[save].Number||"_COPY"
         
         Do "DisplayIDE"
         
         If ObjectState( "SubType" ) = TRUE
            Do "DiffuseIDE",3
         ElseIf ObjectState( "SuperType" ) = TRUE
            Do "DiffuseIDE",2
         Else
            Do "DiffuseIDE",1   ;NormalType is the default!
         EndIf
         
         Do "SetNumIDEs"
         
      EndScript
      Routine "SortIDEs"
         ; ------------------------------------------
         ; SortIDEs( key, direction ) SubRoutine.
         ; ------------------------------------------
         
         Do "SortRecords","IDE",Arg1,Arg2,190,184
         
         Let C_IDE = FirstArrayIndex( IDE )
         Do "DisplayIDE"
         
      EndScript
      AfterAttachment
         SetWindowTitle WTTL[14]
         
         Do "SetUpColors"
         
         If Supervised = FALSE
            Do "SetupDisplay"
         EndIf
      EndScript
      Window "UserWindow"
         Definition
            Origin 0,16
            Title "Information Descriptive Entry:"
            WindowObjects CLOSEBUTTON DEPTHBUTTONS DRAGBAR 
            WindowLimits 250,15,640,480
            WindowZoom 0,13,250,15
            Size 640,464
            WindowFlags ACTIVATE TOFRONT WORKBENCH 
            VisualEffects NONE ,WAIT 
         EndScript
         OnCloseButton
            Do "Check_SaveIDEs"
            
            GotoCard "IDECard"
            
         EndScript
         OnActivated
            Do "SetupDisplay"
            
         EndScript
         OnResized
            Do "SetupDisplay"
         EndScript
      EndObj
      TextField ".Name"
         Definition
            InitialText "Name of Object..."
            Origin 96,20
            Size 160,10
            Border DOUBLEBEVEL 
            Label "Object Name:",HIGHLIGHT 
            Justification CENTER 
            MaxFieldLength 256
            Font "topaz",8
         EndScript
      EndObj
      TextField ".Identifiers"
         Definition
            InitialText "Object.Name & ..."
            Origin 306,20
            Size 180,10
            Border DOUBLEBEVEL 
            Label "ID's:",HIGHLIGHT 
            Justification CENTER 
            MaxFieldLength 256
            Font "topaz",8
         EndScript
      EndObj
      AreaButton "PrevIDE"
         Definition
            Origin 34,198
            Border BEVEL 
            Text " PREV "
            Font "topaz",8
            Style BOLD ,1,13
            TextColors 12,0,JAM1 
            Size 52,12
         EndScript
         OnRelease
            Do "PrevIDE"
            
         EndScript
      EndObj
      AreaButton "NextIDE"
         Definition
            Origin 34,234
            Border BEVEL 
            Text " NEXT "
            Font "topaz",8
            Style BOLD ,1,13
            TextColors 12,0,JAM1 
            Size 52,12
         EndScript
         OnRelease
            Do "NextIDE"
            
         EndScript
      EndObj
      Memo ".AttrDescription"
         Definition
            MemoDocument "AttribDescription"
            ScrollBars RIGHT 
            Origin 108,37
            Size 520,118
            Border BEVEL 
            Font "topaz",8
         EndScript
      EndObj
      Memo ".Description"
         Definition
            MemoDocument "ObjectDescription"
            ScrollBars RIGHT 
            Origin 108,200
            Size 520,129
            Border BEVEL 
            Font "topaz",8
         EndScript
      EndObj
      Memo ".AttrSummary"
         Definition
            MemoDocument "AttributeSummary"
            ScrollBars RIGHT BOTTOM 
            Origin 8,349
            Size 313,107
            Border BEVEL 
            Font "topaz",8
         EndScript
      EndObj
      AreaButton "AddRelationship"
         Definition
            Origin 10,178
            Border BEVEL 
            Text " ADD RELATIONSHIP "
            Font "topaz",8
            Style BOLD ,2,3
            TextColors 8,0,JAM1 
            Size 148,12
         EndScript
         OnRelease
            Do "Check_SaveIDEs"
            GotoCard "EditRelation"
            
         EndScript
      EndObj
      AreaButton "ShowObjectList"
         Definition
            Origin 11,161
            Border BEVEL 
            Text " SHOW OBJECT LIST "
            Font "topaz",8
            Style PLAIN ,2,3
            TextColors 8,0,JAM1 
            Size 148,12
         EndScript
         OnRelease
            WorkWithDocument "ReturnAddress" ;EditIDE ShowObjectList button
            Clear DOCUMENT                         ;Release script!
            Type CardName,NEWLINE 
            GotoCard "ObjListCard"
         EndScript
      EndObj
      AKey "HelpKey"
         Definition
            QualifiersPressed NONE 
            KeyPressed HELP 
         EndScript
         OnUp
            Let d = AskForHelp( HelpPath||"GOOSA.guide", "EditIDECard" )
            
         EndScript
      EndObj
      Memo ".Domain"
         Definition
            MemoDocument "AttribDomain"
            ScrollBars RIGHT BOTTOM 
            Origin 328,349
            Size 299,107
            Border BEVEL 
            Font "topaz",8
         EndScript
      EndObj
      AreaButton "AddIDE"
         Definition
            Origin 358,182
            Border BEVEL 
            Text " ADD "
            Font "topaz",8
            Style BOLD ,1,13
            TextColors 5,0,JAM1 
            Size 44,12
         EndScript
         OnRelease
            Do "AddIDEEntry"
            
         EndScript
      EndObj
      AreaButton "ModifyIDE"
         Definition
            Origin 443,182
            Border BEVEL 
            Text " MODIFY "
            Font "topaz",8
            Style BOLD ,2,3
            TextColors 2,0,JAM1 
            Size 68,12
         EndScript
         OnRelease
            Do "ModifyIDE"
            
         EndScript
      EndObj
      TextMenu "Save"
         Definition
            AttachTo MENU ,"PROJECT    "
            Text "Save"
            ShortCutKey "S"
         EndScript
         Occurred
            Do "SaveIDEs",DefaultDBase||".IDEs"
            Let GotIDEs = FALSE
            
         EndScript
      EndObj
      TextMenu "Save As"
         Definition
            AttachTo MENU ,"PROJECT    "
            Text "Save As..."
            ShortCutKey "A"
         EndScript
         Occurred
            Do "SaveIDEs",""
            
         EndScript
      EndObj
      AreaButton "DeleteIDE"
         Definition
            Origin 522,182
            Border BEVEL 
            Text " DELETE "
            Font "topaz",8
            Style BOLD ,2,3
            TextColors 7,0,JAM1 
            Size 68,12
         EndScript
         OnRelease
            Do "DeleteIDE"
            
         EndScript
      EndObj
      TextField ".Number"
         Definition
            InitialText ""
            Origin 547,20
            Size 77,10
            Border DOUBLEBEVEL 
            Label "IDE #:",HIGHLIGHT 
            Justification CENTER 
            MaxFieldLength 32
            Font "topaz",8
         EndScript
      EndObj
      AKey "TabKey"
         Definition
            QualifiersPressed NONE 
            KeyPressed TAB 
         EndScript
         OnUp
            Do "DoA_TabKey"
         EndScript
      EndObj
      AreaButton "NormalType"
         Definition
            Origin 340,164
            Border INVERT CHECK 
            ButtonFlags BUTTONTOGGLES 
            Shape "CanDo:Brushes/RadioOff.br"
         EndScript
         OnRelease
            SetObjectState "SuperType",FALSE
            SetObjectState "SubType",FALSE
            SetObjectState "NormalType",TRUE
            
         EndScript
      EndObj
      AreaButton "SuperType"
         Definition
            Origin 430,164
            Border CHECK 
            ButtonFlags BUTTONTOGGLES 
            Shape "CanDo:Brushes/RadioOff.br"
         EndScript
         OnRelease
            SetObjectState "SuperType",TRUE
            SetObjectState "SubType",FALSE
            SetObjectState "NormalType",FALSE
         EndScript
      EndObj
      AreaButton "SubType"
         Definition
            Origin 501,164
            Border CHECK 
            ButtonFlags BUTTONTOGGLES 
            Shape "CanDo:Brushes/RadioOff.br"
         EndScript
         OnRelease
            SetObjectState "SuperType",FALSE
            SetObjectState "SubType",TRUE
            SetObjectState "NormalType",FALSE
         EndScript
      EndObj
      TextMenu "Name"
         Definition
            AttachTo MENU ,"SORTS"
            Text "By Object Name "
         EndScript
      EndObj
      TextMenu "Ascending"
         Definition
            AttachTo OBJECT ,"Name"
            Text "Ascending"
         EndScript
         Occurred
            Do "SortIDEs",".NAME",1
            
         EndScript
      EndObj
      TextMenu "Descending"
         Definition
            AttachTo OBJECT ,"Name"
            Text "Descending"
         EndScript
         Occurred
            Do "SortIDEs",".NAME",2
         EndScript
      EndObj
      TextMenu "Number"
         Definition
            AttachTo MENU ,"SORTS"
            Text "By IDE  Number "
         EndScript
      EndObj
      TextMenu "N_Ascending"
         Definition
            AttachTo OBJECT ,"Number"
            Text "Ascending"
         EndScript
         Occurred
            Do "SortIDEs",".NUMBER",1
            
         EndScript
      EndObj
      TextMenu "N_Descending"
         Definition
            AttachTo OBJECT ,"Number"
            Text "Descending"
         EndScript
         Occurred
            Do "SortIDEs",".NUMBER",2
         EndScript
      EndObj
      TextMenu "Identifier"
         Definition
            AttachTo MENU ,"SORTS"
            Text "By Identifiers "
         EndScript
      EndObj
      TextMenu "I_Ascending"
         Definition
            AttachTo OBJECT ,"Identifier"
            Text "Ascending"
         EndScript
         Occurred
            Do "SortIDEs",".IDENTIFIERS",1
            
         EndScript
      EndObj
      TextMenu "I_Descending"
         Definition
            AttachTo OBJECT ,"Identifier"
            Text "Descending"
         EndScript
         Occurred
            Do "SortIDEs",".IDENTIFIERS",2
         EndScript
      EndObj
      ErrorTrap "UserError_1"
         Occurred
            Do "HandleInternalError"
         EndScript
      EndObj
      IntegerField "NumIDES"
         Definition
            Limits 0,9999999
            InitialInteger 0
            Origin 30,50
            Size 50,12
            Border INVERT BEVEL 
            Label "# IDES:",ABOVE 
            FieldFlags NOTABCYCLE 
            Justification CENTER 
            MaxFieldLength 7
            Font "topaz",8
         EndScript
      EndObj
      IntegerField "EntryNum"
         Definition
            Limits 0,999999999
            InitialInteger 0
            Origin 35,214
            Size 50,16
            Border INVERT BEVEL 
            Justification CENTER 
            MaxFieldLength 10
         EndScript
         OnRelease
            SetInteger "EntryNum",C_IDE
         EndScript
      EndObj
   EndObj
   Card "BDECard"
      NoAttach
      Routine "ShowDetails"
         ; --------------------------------------
         ; ShowDetails() Subroutine.
         ; --------------------------------------
         
         Local index
         Local i
         
         Let index = IntegerFrom( "Check" )
         Let i = 0
         
         While i < 10
            Do "DEBUG","AD["||String(i)||"] = "||BDE[index].ActionDetails[i],2
            Let i = i + 1
         EndLoop
      EndScript
      Routine "SetupDisplay"
         ; ----------------------------------------------
         ; SetupDisplay() Subroutine - BDECard.
         ; ----------------------------------------------
         
         Local safety
         Local str
         
         Do "SetUpColors"
         
         If GotBDEs = FALSE
            Do "ReadInBDEs"
            Let GotBDEs = TRUE
         EndIf
         
         Do "SetupBDE"
         
         WorkWithDocument "ThreadsList"
         MoveCursorTo STARTOF DOCUMENT 
         Let safety = LinesInDocument
         
         While safety > 0
            Let str = TrimString( GetWord( TheLine, 2, " " ))
            
            If TrimString( BDE[C_BDE].State ) = str
               ExitLoop
            EndIf
            
            Let safety = safety - 1
            MoveCursor DOWN 
         EndLoop
         
         If FirstArrayIndex( BDE ) = 0
            SetInteger "EntryNum",C_BDE + 1
         Else
            SetInteger "EntryNum",C_BDE
         EndIf
      EndScript
      Routine "LoadBDEFile"
         ; ---------------------------
         ; LoadBDEFile() SubRoutine.
         ; ---------------------------
         
         Local filename
         
         SetFileRequestMode REGULARMODE ,PATTERNFIELD 
         SetFileRequestPattern "#?","#?.BDEs"
         
         Let filename = AskForFileName( DBasePath, "Load BDE's:",10,16 )
         
         If filename <> NOTHING
            
            If FindChars( filename, ".BDEs", 1 ) > 0
               Dispose BDE
               Let BDE     = LoadVariable( filename )
               Let C_BDE   = FirstArrayIndex( BDE )
               Let GotBDEs = TRUE
            Else
               Let filename = Do( "CorrectFileName", filename, ".BDEs" )
               
               If Exists( filename ) AND filename <> NOTHING
                  Dispose BDE
                  Let BDE     = LoadVariable( filename )
                  Let C_BDE   = FirstArrayIndex( BDE )
                  Let GotBDEs = TRUE
               EndIf
            EndIf
         EndIf
         
      EndScript
      Routine "BDESelected"
         ; ------------------------------------------
         ; BDESelected() Script for BDEList Gadget.
         ; ------------------------------------------
         
         Local i
         Local str
         
         Let i = FirstArrayIndex( BDE )
         
         WorkWithDocument "ThreadsList"
         Let str = TrimString( GetWord( TheLine, 2, " " ))
         
         While i <= LastArrayIndex( BDE )
            
            If TrimString( BDE[ i ].State ) = str
               
               If FirstArrayIndex( BDE ) = 0
                  SetInteger "EntryNum",i + 1
               Else
                  SetInteger "EntryNum",i
               EndIf
               
               Let C_BDE = i
               ExitLoop
            EndIf
            
            Let i = i + 1
         EndLoop
      EndScript
      AfterAttachment
         SetWindowTitle WTTL[15]
         
         Do "SetUpColors"
         
         If Supervised = FALSE
            Do "SetupDisplay"
         EndIf
      EndScript
      Window "UserWindow"
         Definition
            Origin 0,16
            Title "Behavior Descriptive Entry:"
            WindowObjects DEPTHBUTTONS DRAGBAR 
            WindowLimits 250,15,640,480
            WindowZoom 0,13,250,15
            Size 640,372
            WindowFlags ACTIVATE TOFRONT WORKBENCH 
            VisualEffects NONE ,WAIT 
         EndScript
         OnActivated
            Do "SetupDisplay"
            
         EndScript
         OnCloseButton
            Quit
         EndScript
         OnResized
            Do "SetupDisplay"
         EndScript
      EndObj
      AreaButton "ReturnGadget"
         Definition
            Origin 15,352
            Border BEVEL 
            Text " Return To Main "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 8,0,JAM1 
            Size 132,12
         EndScript
         OnRelease
            GotoCard "MainCard"
         EndScript
      EndObj
      List "BDEList"
         Definition
            ListDocument "ThreadsList"
            Origin 9,20
            Size 619,325
            Border INVERT BEVEL 
            Font "topaz",8
            TextColors 2,0,JAM1 
            Style PLAIN ,2,3
         EndScript
         OnRelease
            Do "BDESelected"
         EndScript
      EndObj
      AreaButton "GotoEditor"
         Definition
            Origin 411,352
            Border BEVEL 
            Text " Make an Entry... "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 8,0,JAM1 
            Size 148,12
         EndScript
         OnRelease
            GotoCard "EditBDE"
         EndScript
      EndObj
      AKey "HelpKey"
         Definition
            QualifiersPressed NONE 
            KeyPressed HELP 
         EndScript
         OnUp
            Let d = AskForHelp( HelpPath||"GOOSA.guide", "BDECard" )
            
         EndScript
      EndObj
      TextMenu "Load"
         Definition
            AttachTo MENU ,"PROJECT    "
            Text "Load..."
            ShortCutKey "L"
         EndScript
         Occurred
            Do "LoadBDEFile"
            
         EndScript
      EndObj
      TextMenu "Print"
         Definition
            AttachTo MENU ,"PROJECT    "
            Text "Print "
         EndScript
      EndObj
      TextMenu "ToFile"
         Definition
            AttachTo OBJECT ,"Print"
            Text "To File"
            ShortCutKey "F"
         EndScript
         Occurred
            Do "PrintToFile","Print BDE's to file:","ThreadsList"
         EndScript
      EndObj
      TextMenu "ToPar"
         Definition
            AttachTo OBJECT ,"Print"
            Text "To PAR:"
            ShortCutKey "P"
         EndScript
         Occurred
            Do "PrintToPAR","ThreadsList"
         EndScript
      EndObj
      TextMenu "ToSer"
         Definition
            AttachTo OBJECT ,"Print"
            Text "To SER:"
         EndScript
         Occurred
            Do "PrintToSER","ThreadsList"
         EndScript
      EndObj
      ErrorTrap "UserError_1"
         Occurred
            Do "HandleInternalError"
         EndScript
      EndObj
      IntegerField "EntryNum"
         Definition
            Limits 0,99999999
            InitialInteger 0
            Origin 580,352
            Size 50,13
            Justification CENTER 
            MaxFieldLength 10
         EndScript
         OnRelease
            SetInteger "EntryNum",C_BDE
         EndScript
      EndObj
   EndObj
   Card "EditBDE"
      NoAttach
      Routine "ParseThread"
         Nop; ParseThread to be filled in later!
      EndScript
      Routine "PrevBDE"
         ; -----------------------------------
         ; PrevBDE() Script for PREV Button.
         ; -----------------------------------
         
         Let BDE[C_BDE] = GetDBObjects
         
         Let C_BDE = PreviousArrayIndex( BDE, C_BDE )
         
         If NOT SearchFound
            Let C_BDE = LastArrayIndex( BDE )
         EndIf
         
         Do "DisplayBDE"
         
      EndScript
      Routine "NextBDE"
         ; -----------------------------------
         ; NextBDE() Script for NEXT Button.
         ; -----------------------------------
         
         Let BDE[C_BDE] = GetDBObjects
         
         Let C_BDE = NextArrayIndex( BDE, C_BDE )
         
         If NOT SearchFound
            Let C_BDE = FirstArrayIndex( BDE )
         EndIf
         
         Do "DisplayBDE"
         
      EndScript
      Routine "SaveAsBDEFile"
         ; -----------------------------
         ; SaveAsBDEFile() SubRoutine.
         ; -----------------------------
         
         Local filename
         
         SetFileRequestMode SAVEFILEMODE ,REJECTICONS 
         SetFileRequestPattern "#?","#?.BDEs"
         
         Let filename = AskForFileName( DBasePath, "Save BDEs:",10,16 )
         
         If filename <> NOTHING
            
            If FindChars( filename, ".BDEs", 1 ) > 0
               Let C_BDE = FirstArrayIndex( BDE )
               Do "DisplayBDE"
               
               While C_BDE <= LastArrayIndex( BDE )
                  Let BDE[C_BDE] = GetDBObjects
                  
                  If Do( "EmptyString", BDE[C_BDE].Number ) = FALSE
                     SaveVariable BDE,filename
                  EndIf
                  
                  Let C_BDE = C_BDE + 1
                  Do "DisplayBDE"
               EndLoop
               
               Let GotBDEs = FALSE
            Else
               Let filename = Do( "CorrectFileName", filename, ".BDEs" )
               
               If FindChars( filename, ".BDEs", 1 ) > 0
                  Let C_BDE = FirstArrayIndex( BDE )
                  Do "DisplayBDE"
                  
                  While C_BDE <= LastArrayIndex( BDE )
                     Let BDE[C_BDE] = GetDBObjects
                     
                     If Do( "EmptyString", BDE[C_BDE].Number ) = FALSE
                        SaveVariable BDE,filename
                     EndIf
                     
                     Let C_BDE = C_BDE + 1
                     Do "DisplayBDE"
                  EndLoop
                  
                  Let GotBDEs = FALSE
               EndIf
            EndIf
         EndIf
         
      EndScript
      Routine "LoadBDEFile"
         ; ---------------------------
         ; LoadBDEFile() SubRoutine.
         ; ---------------------------
         
         Local filename
         
         SetFileRequestMode REGULARMODE ,PATTERNFIELD 
         SetFileRequestPattern "#?","#?.BDEs"
         
         Let filename = AskForFileName( DBasePath, "Load BDEs:", 10, 16 )
         
         If filename <> NOTHING
            If FindChars( filename, ".BDEs", 1 ) > 0
               Dispose BDE
               
               Let BDE   = LoadVariable( filename )
               Let C_BDE = FirstArrayIndex( BDE )
               
               Do "DisplayBDE"
            Else
               Let filename = Do( "CorrectFileName", filename, ".BDEs" )
               
               If Exists( filename ) AND filename <> NOTHING
                  Dispose BDE
                  
                  Let BDE   = LoadVariable( filename )
                  Let C_BDE = FirstArrayIndex( BDE )
                  
                  Do "DisplayBDE"
               EndIf
            EndIf
         EndIf
         
      EndScript
      Routine "NextThread"
         ; ---------------------------
         ; NextThread() Subroutine.
         ; ---------------------------
         
         WorkWithDocument "ThreadsList"
         
         While FindChars( TheWord, "[", 1 ) = 0
            MoveCursorTo NEXTWORD 
            
            If TheLineNumber = LinesInDocument AND CharsToEndOfLine < 4
               MoveCursorTo STARTOF DOCUMENT 
            EndIf
         EndLoop
         
         Do "ParseThread"
         
      EndScript
      Routine "FirstThread"
         ; ---------------------------
         ; FirstThread() SubRoutine.
         ; ---------------------------
         
         WorkWithDocument "ThreadsList"
         MoveCursorTo STARTOF DOCUMENT 
         
         Do "ParseThread"
         
      EndScript
      Routine "PrevThread"
         ; --------------------------
         ; PrevThread() SubRoutine.
         ; --------------------------
         
         WorkWithDocument "ThreadsList"
         
         While FindChars( TheWord, "[", 1 ) = 0
            MoveCursorTo PREVIOUSWORD 
            
            If TheLineNumber = 1 AND CharsToBegOfLine = 0
               MoveCursorTo ENDOF DOCUMENT 
            EndIf
            
         EndLoop
         
         Do "ParseThread"
         
      EndScript
      Routine "LastThread"
         ; --------------------------
         ; LastThread() SubRoutine.
         ; --------------------------
         
         WorkWithDocument "ThreadsList"
         MoveCursorTo ENDOF DOCUMENT 
         
         While FindChars( TheWord, "[", 1 ) = 0
            MoveCursorTo PREVIOUSWORD 
         EndLoop
         
         Do "ParseThread"
         
      EndScript
      Routine "Check_SaveBDEs"
         ; ---------------------------------------
         ; Check_SaveBDEs( filename ) SubRoutine.
         ; ---------------------------------------
         
         Local ttl
         Local ans
         Local msg
         Local fname
         
         If Do( "EmptyString", Arg1 ) = TRUE
            Let fname = DefaultDBase||".BDEs"
         Else
            Let fname = TrimString( Arg1 )
         EndIf
         
         Let ttl = "User WARNING:"
         Let msg = "Any changes you've made have to be saved to be"||Char(10)
         Let msg = msg||"made permanent, Should they be saved?"
         
         Let ans = AskForResponse( msg, ttl, "Save them!|NO!" )
         
         If ans = 2
            ExitScript
         EndIf
         
         Do "SaveBDEs",fname
      EndScript
      Routine "SetupDisplay"
         ; ------------------------------------------
         ; SetupDisplay() Subroutine - EditBDECard.
         ; ------------------------------------------
         
         Do "SetUpColors"
         Do "DrawRaisedBox",440,298,180,32
         
         Do "MakeBDEList"
         Do "DisplayBDE"
      EndScript
      Routine "MakeBDEList"
         ; ----------------------------
         ; MakeBDEList() SubRoutine.
         ; ----------------------------
         
         Local i
         
         WorkWithDocument "BDEList"
         Clear DOCUMENT 
         
         Let i = FirstArrayIndex( BDE )
         
         While i <= LastArrayIndex( BDE )
            
            If Do( "EmptyString", BDE[i].Number ) = FALSE
               Type LeftJustify( BDE[i].Number, 10, " " )||": "
               Type LeftJustify( BDE[i].ThreadNum, 15, " " )||": "
               Type BDE[i].State,NEWLINE 
            EndIf
            
            Let i = i + 1
         EndLoop
         
         MoveCursorTo STARTOF DOCUMENT 
      EndScript
      Routine "HighlightBDE"
         ; ----------------------------
         ; HighlightBDE() SubRoutine.
         ; ----------------------------
         
         Local num
         Local safety
         
         WorkWithDocument "BDEList"
         MoveCursorTo STARTOF DOCUMENT 
         Let safety = LinesInDocument
         Let num    = TrimString( GetWord( TheLine, 1, " :" ))
         
         While safety > 0
            
            If TrimString( BDE[C_BDE].Number ) = num
               ExitLoop
            EndIf
            
            Let safety = safety - 1
            MoveCursor DOWN 
            Let num = TrimString( GetWord( TheLine, 1, " :" ))
         EndLoop
      EndScript
      Routine "DeleteBDE"
         ; -------------------------
         ; DeleteBDE() SubRoutine.
         ; -------------------------
         
         DeleteArrayEntry BDE,C_BDE
         
         If VarType( BDE[C_BDE] ) = "Nothing"
            Let C_BDE = LastArrayIndex( BDE )
         EndIf
         
         Do "MakeBDEList"
         
         Do "DisplayBDE"
         
      EndScript
      Routine "ModifyBDE"
         ; -------------------------
         ; ModifyBDE() SubRoutine.
         ; -------------------------
         
         Let BDE[C_BDE] = GetDBObjects
         
         Do "MakeBDEList"
         Do "DisplayBDE"
         
      EndScript
      Routine "SortBDEs"
         ; ----------------------------------------
         ; SortBDEs( key, direction ) SubRoutine.
         ; ----------------------------------------
         
         Do "SortRecords","BDE",Arg1,Arg2,175,78
         
         Let C_BDE = FirstArrayIndex( BDE )
         
         Do "MakeBDEList"
         Do "DisplayBDE"
         
      EndScript
      Routine "AddBDE"
         ; ----------------------
         ; AddBDE() SubRoutine.
         ; ----------------------
         
         Local i
         
         Let i = C_BDE
         
         If C_BDE < LastArrayIndex( BDE )
            Let C_BDE = C_BDE + 1
         Else
            Let C_BDE = LastArrayIndex( BDE )]
         EndIf
         
         InsertArrayEntry BDE,C_BDE
         
         Let BDE[C_BDE].State             = "COPY_"||BDE[i].State
         Let BDE[C_BDE].Event             = "COPY_"||BDE[i].Event
         Let BDE[C_BDE].Source            = "COPY_"||BDE[i].Source
         Let BDE[C_BDE].Destination       = "COPY_"||BDE[i].Destination
         Let BDE[C_BDE].ActionDescription = "COPY_"||BDE[i].ActionDescription
         Let BDE[C_BDE].TransitionTo      = "COPY_"||BDE[i].TransitionTo
         Let BDE[C_BDE].ThreadNum         = "COPY_"||BDE[i].ThreadNum
         Let BDE[C_BDE].ActionNum         = "COPY_"||BDE[i].ActionNum
         Let BDE[C_BDE].ActionDetails     = "COPY_"||BDE[i].ActionDetails
         Let BDE[C_BDE].Number            = BDE[i].Number||"_COPY"
         
         Do "MakeBDEList"
         Do "DisplayBDE"
         
      EndScript
      Routine "DisplayBDE"
         ; --------------------------------
         ; DisplayBDE( flag ) SubRoutine.
         ; --------------------------------
         
         SetDBObjects BDE[C_BDE]
         
         If FirstArrayIndex( BDE ) = 0
            SetInteger "EntryNum",C_BDE + 1
         Else
            SetInteger "EntryNum",C_BDE
         EndIf
         
         If Arg1 = FALSE OR Arg1 = NOTHING
            Do "HighlightBDE"
         EndIf
         
         SetWindowTitle WTTL[16]
      EndScript
      Routine "BDESelected"
         ; --------------------------
         ; BDESelected() SubRoutine.
         ; --------------------------
         
         Local i
         Local num
         
         WorkWithDocument "BDEList"
         Let num = TrimString( GetWord( TheLine, 1, " :" ))
         
         Let i = FirstArrayIndex( BDE )
         
         While i <= LastArrayIndex( BDE )
            
            If BDE[i].Number = num
               Let C_BDE = i
               ExitLoop
            EndIf
            
            Let i = i + 1
         EndLoop
         
         Do "DisplayBDE",TRUE
         
      EndScript
      AfterAttachment
         SetWindowTitle WTTL[16]
         
         Do "SetupColors"
         
         SetWordDelimiters " ,"
         
         If Supervised = FALSE
            Do "MakeBDEList"
            Do "SetupDisplay"
         EndIf
      EndScript
      Window "UserWindow"
         Definition
            Origin 0,16
            Title "Edit Behavior Descriptive Entries:"
            WindowObjects CLOSEBUTTON DEPTHBUTTONS DRAGBAR 
            WindowLimits 250,15,640,480
            WindowZoom 0,13,250,15
            Size 640,460
            WindowFlags ACTIVATE TOFRONT WORKBENCH 
            VisualEffects NONE ,WAIT 
         EndScript
         OnActivated
            Do "SetupDisplay"
            
         EndScript
         OnCloseButton
            Do "Check_SaveBDEs"
            
            GotoCard "BDECard"
            
         EndScript
         OnResized
            Do "SetupDisplay"
         EndScript
      EndObj
      AKey "HelpKey"
         Definition
            QualifiersPressed NONE 
            KeyPressed HELP 
         EndScript
         OnUp
            Let d = AskForHelp( HelpPath||"GOOSA.guide", "EditBDECard" )
            
         EndScript
      EndObj
      TextMenu "Load"
         Definition
            AttachTo MENU ,"PROJECT    "
            Text "Load..."
            ShortCutKey "L"
         EndScript
         Occurred
            Do "LoadBDEFile"
            
         EndScript
      EndObj
      TextMenu "Save"
         Definition
            AttachTo MENU ,"PROJECT    "
            Text "Save"
            ShortCutKey "S"
         EndScript
         Occurred
            Do "SaveBDEs"
            Let GotBDEs = FALSE
         EndScript
      EndObj
      TextMenu "FirstThread"
         Definition
            AttachTo MENU ,"THREADS"
            Text "First Thread"
            ShortCutKey "B"
         EndScript
         Occurred
            Do "FirstThread"
            
         EndScript
      EndObj
      TextMenu "NextThread"
         Definition
            AttachTo MENU ,"THREADS"
            Text "Next  Thread"
            ShortCutKey "N"
         EndScript
         Occurred
            Do "NextThread"
            
         EndScript
      EndObj
      TextMenu "PrevThread"
         Definition
            AttachTo MENU ,"THREADS"
            Text "Prev  Thread"
            ShortCutKey "P"
         EndScript
         Occurred
            Do "PrevThread"
            
         EndScript
      EndObj
      TextMenu "LastThread"
         Definition
            AttachTo MENU ,"THREADS"
            Text "Last  Thread"
            ShortCutKey "E"
         EndScript
         Occurred
            Do "LastThread"
            
         EndScript
      EndObj
      AreaButton "ShowObjectList"
         Definition
            Origin 434,341
            Border BEVEL 
            Text " SHOW OBJECT LIST "
            Font "topaz",8
            Style PLAIN ,2,3
            TextColors 8,0,JAM1 
            Size 148,12
         EndScript
         OnRelease
            WorkWithDocument "ReturnAddress" ;EditBDE ShowObjectList button
            Clear DOCUMENT                    ;Release script!
            Type CardName,NEWLINE 
            GotoCard "ObjListCard"
         EndScript
      EndObj
      TextField ".ThreadNum"
         Definition
            InitialText "[BObj#.b#]"
            Origin 228,20
            Size 150,12
            Border DOUBLEBEVEL 
            Label "Thread #:",HIGHLIGHT 
            Justification CENTER 
            MaxFieldLength 15
            Font "topaz",8
         EndScript
      EndObj
      TextField ".State"
         Definition
            InitialText "Object#_State#,..."
            Origin 228,39
            Size 300,12
            Border DOUBLEBEVEL 
            Label "Enter Object_State String:",HIGHLIGHT 
            Justification CENTER 
            MaxFieldLength 256
            Font "topaz",8
         EndScript
      EndObj
      TextField ".Source"
         Definition
            InitialText "Term' or Obj_State#"
            Origin 67,57
            Size 160,12
            Border DOUBLEBEVEL 
            Label "Msg Src:",HIGHLIGHT 
            Justification CENTER 
            MaxFieldLength 80
            Font "topaz",8
         EndScript
      EndObj
      TextField ".Event"
         Definition
            InitialText "E|X|I|T#"
            Origin 336,58
            Size 70,12
            Border DOUBLEBEVEL 
            Label "Sends Event:",HIGHLIGHT 
            Justification CENTER 
            MaxFieldLength 15
            Font "topaz",8
         EndScript
      EndObj
      TextField ".Destination"
         Definition
            InitialText "Term' or Obj_State#"
            Origin 482,58
            Size 140,12
            Border DOUBLEBEVEL 
            Label "Msg To:",HIGHLIGHT 
            Justification CENTER 
            MaxFieldLength 80
            Font "topaz",8
         EndScript
      EndObj
      TextField ".ActionNum"
         Definition
            InitialText "A1234..."
            Origin 67,77
            Size 90,12
            Border DOUBLEBEVEL 
            Label "Action #:",HIGHLIGHT 
            Justification CENTER 
            MaxFieldLength 15
            Font "topaz",8
         EndScript
      EndObj
      Memo ".ActionDetails"
         Definition
            MemoDocument "ActionsList"
            ScrollBars RIGHT 
            Origin 9,130
            Size 623,161
            Border BEVEL 
            Label "Action Details:",HIGHLIGHT ABOVE 
            Font "topaz",8
         EndScript
      EndObj
      TextField ".ActionDescription"
         Definition
            InitialText "Type of Action..."
            Origin 408,77
            Size 200,12
            Border DOUBLEBEVEL 
            Label "Action Descrip':",HIGHLIGHT 
            Justification CENTER 
            MaxFieldLength 80
            Font "topaz",8
         EndScript
      EndObj
      TextField ".TransitionTo"
         Definition
            InitialText "Object_State#"
            Origin 408,98
            Size 110,12
            Border DOUBLEBEVEL 
            Label "Transition to Obj_State #: ",HIGHLIGHT 
            Justification CENTER 
            MaxFieldLength 15
            Font "topaz",8
         EndScript
      EndObj
      AreaButton "GotoSTTCard"
         Definition
            Origin 434,379
            Border BEVEL 
            Text " GOTO STT "
            Font "topaz",8
            Style PLAIN ,2,3
            TextColors 8,0,JAM1 
            Size 84,12
         EndScript
         OnRelease
            Do "Check_SaveBDEs"
            GotoCard "STTCard"
            
         EndScript
      EndObj
      AreaButton "GotoSTDCard"
         Definition
            Origin 434,360
            Border BEVEL 
            Text " GOTO STD "
            Font "topaz",8
            Style PLAIN ,2,3
            TextColors 8,0,JAM1 
            Size 84,12
         EndScript
         OnRelease
            Do "Check_SaveBDEs"
            GotoCard "STDCard"
            
         EndScript
      EndObj
      AreaButton "GotoOCTCard"
         Definition
            Origin 535,360
            Border BEVEL 
            Text " GOTO OCT "
            Font "topaz",8
            Style PLAIN ,2,3
            TextColors 8,0,JAM1 
            Size 84,12
         EndScript
         OnRelease
            Do "Check_SaveBDEs"
            GotoCard "OCTCard"
            
         EndScript
      EndObj
      AreaButton "GotoOCDCard"
         Definition
            Origin 535,379
            Border BEVEL 
            Text " GOTO OCD "
            Font "topaz",8
            Style PLAIN ,2,3
            TextColors 8,0,JAM1 
            Size 84,12
         EndScript
         OnRelease
            Do "Check_SaveBDEs"
            GotoCard "OCDCard"
            
         EndScript
      EndObj
      ImageMenu "EDBDESep1"
         Definition
            AttachTo MENU ,"THREADS"
            BarImage
         EndScript
      EndObj
      TextMenu "DeleteThread"
         Definition
            AttachTo MENU ,"THREADS"
            Text "DELETE THREAD!"
         EndScript
         Occurred
            Do "DEBUG","Not Implemented Yet!",3
         EndScript
      EndObj
      AreaButton "NextBDE"
         Definition
            Origin 561,308
            Border BEVEL 
            Text " NEXT "
            Font "topaz",8
            Style PLAIN ,2,3
            TextColors 12,0,JAM1 
            Size 52,12
         EndScript
         OnRelease
            Do "NextBDE"
            
         EndScript
      EndObj
      AreaButton "PrevBDE"
         Definition
            Origin 447,308
            Border BEVEL 
            Text " PREV "
            Font "topaz",8
            Style PLAIN ,2,3
            TextColors 12,0,JAM1 
            Size 52,12
         EndScript
         OnRelease
            Do "PrevBDE"
            
         EndScript
      EndObj
      AreaButton "AddBDE"
         Definition
            Origin 434,399
            Border BEVEL 
            Text " ADD "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 5,0,JAM1 
            Size 44,12
         EndScript
         OnRelease
            Do "AddBDE"
            
         EndScript
      EndObj
      AreaButton "ModifyBDE"
         Definition
            Origin 486,399
            Border BEVEL 
            Text " MODIFY "
            Font "topaz",8
            Style PLAIN ,2,3
            TextColors 2,0,JAM1 
            Size 68,12
         EndScript
         OnRelease
            Do "ModifyBDE"
            
         EndScript
      EndObj
      TextField ".Number"
         Definition
            InitialText ""
            Origin 67,20
            Size 80,12
            Border DOUBLEBEVEL 
            Label "BDE #:",HIGHLIGHT 
            Justification CENTER 
            MaxFieldLength 32
            Font "topaz",8
         EndScript
      EndObj
      TextMenu "Save As"
         Definition
            AttachTo MENU ,"PROJECT    "
            Text "Save As..."
            ShortCutKey "A"
         EndScript
         Occurred
            Do "SaveAsBDEFile"
            
         EndScript
      EndObj
      AreaButton "DeleteBDE"
         Definition
            Origin 562,399
            Border BEVEL 
            Text " DELETE "
            Font "topaz",8
            Style PLAIN ,2,3
            TextColors 7,0,JAM1 
            Size 68,12
         EndScript
         OnRelease
            Do "DeleteBDE"
            
         EndScript
      EndObj
      AKey "TabKey"
         Definition
            QualifiersPressed NONE 
            KeyPressed TAB 
         EndScript
         OnUp
            Do "DoA_TabKey"
         EndScript
      EndObj
      TextMenu "ThreadNumber"
         Definition
            AttachTo MENU ,"SORTS"
            Text "By Thread   # "
         EndScript
      EndObj
      TextMenu "Ascending"
         Definition
            AttachTo OBJECT ,"ThreadNumber"
            Text "Ascending"
         EndScript
         Occurred
            Do "SortBDEs",".THREADNUM",1
            
         EndScript
      EndObj
      TextMenu "Descending"
         Definition
            AttachTo OBJECT ,"ThreadNumber"
            Text "Descending"
         EndScript
         Occurred
            Do "SortBDEs",".THREADNUM",2
         EndScript
      EndObj
      TextMenu "Number"
         Definition
            AttachTo MENU ,"SORTS"
            Text "By BDE Number "
         EndScript
      EndObj
      TextMenu "N_Ascending"
         Definition
            AttachTo OBJECT ,"Number"
            Text "Ascending"
         EndScript
         Occurred
            Do "SortBDEs",".NUMBER",1
         EndScript
      EndObj
      TextMenu "N_Descending"
         Definition
            AttachTo OBJECT ,"Number"
            Text "Descending"
         EndScript
         Occurred
            Do "SortBDEs",".NUMBER",2
         EndScript
      EndObj
      TextMenu "Msg_Src"
         Definition
            AttachTo MENU ,"SORTS"
            Text "By Msg Src    "
         EndScript
      EndObj
      TextMenu "MS_Ascending"
         Definition
            AttachTo OBJECT ,"Msg_Src"
            Text "Ascending"
         EndScript
         Occurred
            Do "SortBDEs",".SOURCE",1
         EndScript
      EndObj
      TextMenu "MS_Descending"
         Definition
            AttachTo OBJECT ,"Msg_Src"
            Text "Descending"
         EndScript
         Occurred
            Do "SortBDEs",".SOURCE",2
         EndScript
      EndObj
      TextMenu "Msg_Dest"
         Definition
            AttachTo MENU ,"SORTS"
            Text "By Msg To     "
         EndScript
      EndObj
      TextMenu "MD_Ascending"
         Definition
            AttachTo OBJECT ,"Msg_Dest"
            Text "Ascending"
         EndScript
         Occurred
            Do "SortBDEs",".DESTINATION",1
            
         EndScript
      EndObj
      TextMenu "MD_Descending"
         Definition
            AttachTo OBJECT ,"Msg_Dest"
            Text "Descending"
         EndScript
         Occurred
            Do "SortBDEs",".DESTINATION",2
         EndScript
      EndObj
      TextMenu "ActionNum"
         Definition
            AttachTo MENU ,"SORTS"
            Text "By Action #   "
         EndScript
      EndObj
      TextMenu "A_Ascending"
         Definition
            AttachTo OBJECT ,"ActionNum"
            Text "Ascending"
         EndScript
         Occurred
            Do "SortBDEs",".ACTIONNUM",1
            
         EndScript
      EndObj
      TextMenu "A_Descending"
         Definition
            AttachTo OBJECT ,"ActionNum"
            Text "Descending"
         EndScript
         Occurred
            Do "SortBDEs",".ACTIONNUM",2
         EndScript
      EndObj
      ErrorTrap "UserError_1"
         Occurred
            Do "HandleInternalError"
         EndScript
      EndObj
      IntegerField "EntryNum"
         Definition
            Limits 0,999999999
            InitialInteger 0
            Origin 505,306
            Size 50,16
            Border INVERT BEVEL 
            Justification CENTER 
            MaxFieldLength 10
         EndScript
         OnRelease
            SetInteger "EntryNum",C_BDE
         EndScript
      EndObj
      List "BDEs"
         Definition
            ListDocument "BDEList"
            Origin 9,312
            Size 415,137
            Border INVERT BEVEL 
            Label "BDEs:",ABOVE 
            Font "topaz",8
         EndScript
         OnRelease
            Do "BDESelected"
         EndScript
      EndObj
   EndObj
   Card "PDECard"
      NoAttach
      Routine "PDESelected"
         ; -----------------------------------------
         ; PDESelected() Script for PDEList Gadget.
         ; -----------------------------------------
         
         Local i
         Local str
         
         Let i = FirstArrayIndex( PDE )
         
         WorkWithDocument "PDEntry"
         Let str = TrimString( GetWord( TheLine, 3, " " ))
         
         While i <= LastArrayIndex( PDE )
            
            If FindChars( PDE[i].Number, str, 1 ) > 0
               Let C_PDE = i
               ExitLoop
            EndIf
            
            Let i = i + 1
         EndLoop
         
         If FirstArrayIndex( PDE ) = 0
            SetInteger "EntryNum",C_PDE + 1
         Else
            SetInteger "EntryNum",C_PDE
         EndIf
         
      EndScript
      Routine "LoadPDEFile"
         ; ---------------------------
         ; LoadPDEFile() SubRoutine.
         ; ---------------------------
         
         Local filename
         
         SetFileRequestMode REGULARMODE ,PATTERNFIELD 
         SetFileRequestPattern "#?","#?.PDEs"
         
         Let filename = AskForFileName( DBasePath, "Load PDE's:",10,16 )
         
         If filename <> NOTHING
            
            If FindChars( filename, ".PDEs", 1 ) > 0
               Dispose PDE
               Let PDE   = LoadVariable( filename )
               Let C_PDE = FirstArrayIndex( PDE )
               Do "DisplayPDE"
               Let GotPDEs = TRUE
            Else
               Let filename = Do( "CorrectFileName", filename, ".PDEs" )
               
               If Exists( filename ) AND filename <> NOTHING
                  Dispose PDE
                  Let PDE   = LoadVariable( filename )
                  Let C_PDE = FirstArrayIndex( PDE )
                  Do "DisplayPDE"
                  Let GotPDEs = TRUE
               EndIf
            EndIf
         EndIf
         
      EndScript
      Routine "DisplayPDE"
         ; --------------------------
         ; DisplayPDE() SubRoutine.
         ; --------------------------
         
         Do "SetupPDE"
         
         WorkWithDocument "PDEntry"
         MoveCursorTo STARTOF DOCUMENT 
         Let safety = LinesInDocument
         
         While safety > 0
            
            Let str = TrimString( GetWord( TheLine, 3, " " ))
            
            If TrimString( PDE[C_PDE].Number ) = str
               ExitLoop
            EndIf
            
            Let safety = safety - 1
            MoveCursor DOWN 
         EndLoop
         
         If FirstArrayIndex( PDE ) = 0
            SetInteger "EntryNum",C_PDE + 1
         Else
            SetInteger "EntryNum",C_PDE
         EndIf
      EndScript
      Routine "SetupDisplay"
         ; -------------------------------------------
         ; SetupDisplay() Subroutine - PDECard.
         ; -------------------------------------------
         
         Local safety
         Local str
         
         Do "SetUpColors"
         
         If GotPDEs = FALSE
            Do "ReadInPDEs"
            Let GotPDEs = TRUE
         EndIf
         
         Do "DisplayPDE"
      EndScript
      AfterAttachment
         SetWindowTitle WTTL[17]
         
         Do "SetUpColors"
         
         If Supervised = FALSE
            Do "SetupDisplay"
         EndIf
      EndScript
      Window "UserWindow"
         Definition
            Origin 0,16
            Title "Process Descriptive Entry:"
            WindowObjects DEPTHBUTTONS DRAGBAR 
            WindowLimits 250,15,640,480
            WindowZoom 0,13,250,15
            Size 640,379
            WindowFlags ACTIVATE TOFRONT WORKBENCH 
            VisualEffects NONE ,WAIT 
         EndScript
         OnActivated
            Do "SetupDisplay"
            
         EndScript
         OnCloseButton
            Quit
         EndScript
         OnResized
            Do "SetupDisplay"
         EndScript
      EndObj
      AreaButton "ReturnGadget"
         Definition
            Origin 13,361
            Border BEVEL 
            Text " Return To Main "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 8,0,JAM1 
            Size 132,12
         EndScript
         OnRelease
            GotoCard "MainCard"
         EndScript
      EndObj
      List "PDEList"
         Definition
            ListDocument "PDEntry"
            Origin 8,20
            Size 620,333
            Border INVERT BEVEL 
            Font "topaz",8
            TextColors 2,0,JAM1 
            Style PLAIN ,2,3
         EndScript
         OnRelease
            Do "PDESelected"
            
         EndScript
      EndObj
      AreaButton "PFDGadget"
         Definition
            Origin 157,361
            Border BEVEL 
            Text " Process Flow Diagram... "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 8,0,JAM1 
            Size 204,12
         EndScript
         OnRelease
            GotoCard "PFDCard"
         EndScript
      EndObj
      AreaButton "GotoEditor"
         Definition
            Origin 406,361
            Border BEVEL 
            Text " Make an Entry... "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 8,0,JAM1 
            Size 148,12
         EndScript
         OnRelease
            GotoCard "EditPDE"
         EndScript
      EndObj
      AKey "HelpKey"
         Definition
            QualifiersPressed NONE 
            KeyPressed HELP 
         EndScript
         OnUp
            Let d = AskForHelp( HelpPath||"GOOSA.guide", "PDECard" )
            
         EndScript
      EndObj
      TextMenu "Load"
         Definition
            AttachTo MENU ,"PROJECT    "
            Text "Load..."
            ShortCutKey "L"
         EndScript
         Occurred
            Do "LoadPDEFile"
            
         EndScript
      EndObj
      TextMenu "Print"
         Definition
            AttachTo MENU ,"PROJECT    "
            Text "Print "
         EndScript
      EndObj
      TextMenu "ToFile"
         Definition
            AttachTo OBJECT ,"Print"
            Text "To File"
            ShortCutKey "F"
         EndScript
         Occurred
            Do "PrintToFile","Print PDE's to file:","PDEntry"
         EndScript
      EndObj
      TextMenu "ToPar"
         Definition
            AttachTo OBJECT ,"Print"
            Text "To PAR:"
            ShortCutKey "P"
         EndScript
         Occurred
            Do "PrintToPAR","PDEntry"
         EndScript
      EndObj
      TextMenu "ToSer"
         Definition
            AttachTo OBJECT ,"Print"
            Text "To SER:"
         EndScript
         Occurred
            Do "PrintToSER","PDEntry"
         EndScript
      EndObj
      ErrorTrap "UserError_1"
         Occurred
            Do "HandleInternalError"
         EndScript
      EndObj
      IntegerField "EntryNum"
         Definition
            Limits 0,999999999
            InitialInteger 0
            Origin 581,361
            Size 50,13
            Justification CENTER 
            MaxFieldLength 10
         EndScript
         OnRelease
            SetInteger "EntryNum",C_PDE
         EndScript
      EndObj
   EndObj
   Card "EditPDE"
      NoAttach
      Routine "ParseThread"
         Nop; ParseThread to be filled in later!
      EndScript
      Routine "PrevPDE"
         ; -----------------------------------
         ; PrevPDE() Script for PREV Button.
         ; -----------------------------------
         
         Let PDE[C_PDE] = GetDBObjects
         
         Let C_PDE = PreviousArrayIndex( PDE, C_PDE )
         
         If NOT SearchFound
            Let C_PDE = LastArrayIndex( PDE )
         EndIf
         
         Do "DisplayPDE"
         
      EndScript
      Routine "NextPDE"
         ; -----------------------------------
         ; NextPDE() Script for NEXT Button.
         ; -----------------------------------
         
         Let PDE[C_PDE] = GetDBObjects
         
         Let C_PDE = NextArrayIndex( PDE, C_PDE )
         
         If NOT SearchFound
            Let C_PDE = FirstArrayIndex( PDE )
         EndIf
         
         Do "DisplayPDE"
         
      EndScript
      Routine "SaveAsPDEFile"
         ; -----------------------------
         ; SaveAsPDEFile() SubRoutine.
         ; -----------------------------
         
         Local filename
         
         SetFileRequestMode SAVEFILEMODE ,REJECTICONS 
         SetFileRequestPattern "#?","#?.PDEs"
         
         Let filename = AskForFileName( DBasePath, "Save PDEs:",10,16 )
         
         If filename <> NOTHING
            
            If FindChars( filename, ".PDEs", 1 ) > 0
               Let C_PDE = FirstArrayIndex( PDE )
               Do "DisplayPDE"
               
               While C_PDE <= LastArrayIndex( PDE )
                  Let PDE[C_PDE] = GetDBObjects
                  
                  If Do( "EmptyString", PDE[C_PDE].Name ) = FALSE
                     SaveVariable PDE,filename
                  EndIf
                  
                  Let C_PDE = C_PDE + 1
                  Do "DisplayPDE"
               EndLoop
               
               Let GotPDEs = FALSE
            Else
               Let filename = Do( "CorrectFileName", filename, ".PDEs" )
               If FindChars( filename, ".PDEs", 1 ) > 0
                  Let C_PDE = FirstArrayIndex( PDE )
                  Do "DisplayPDE"
                  
                  While C_PDE <= LastArrayIndex( PDE )
                     Let PDE[C_PDE] = GetDBObjects
                     
                     If Do( "EmptyString", PDE[C_PDE].Name ) = FALSE
                        SaveVariable PDE,filename
                     EndIf
                     
                     Let C_PDE = C_PDE + 1
                     Do "DisplayPDE"
                  EndLoop
                  
                  Let GotPDEs = FALSE
               EndIf
            EndIf
         EndIf
         
      EndScript
      Routine "Check_SavePDEs"
         ; ----------------------------------------
         ; Check_SavePDEs( filename ) SubRoutine.
         ; ----------------------------------------
         
         Local ttl
         Local ans
         Local msg
         Local fname
         
         If Do( "EmptyString", Arg1 ) = TRUE
            Let fname = DefaultDBase||".PDEs"
         Else
            Let fname = TrimString( Arg1 )
         EndIf
         
         Let ttl = "User WARNING:"
         Let msg = "Any changes you've made have to be saved to be"||Char(10)
         Let msg = msg||"made permanent, Should they be saved?"
         
         Let ans = AskForResponse( msg, ttl, "Save them!|NO!" )
         
         If ans = 2
            ExitScript
         EndIf
         
         Do "SavePDEs",fname
      EndScript
      Routine "MakePDEList"
         ; ---------------------------
         ; MakePDEList() SubRoutine.
         ; ---------------------------
         
         Local i
         
         WorkWithDocument "PDEList"
         Clear DOCUMENT 
         
         Let i = FirstArrayIndex( PDE )
         
         While i <= LastArrayIndex( PDE )
            
            If Do( "EmptyString", PDE[i].Name ) = FALSE
               Type LeftJustify( PDE[i].Number, 10, " " )||": "
               Type PDE[i].Name,NEWLINE 
            EndIf
            
            Let i = i + 1
         EndLoop
         
         MoveCursorTo STARTOF DOCUMENT 
      EndScript
      Routine "HighlightPDE"
         ; ---------------------------
         ; HighlightPDE() SubRoutine.
         ; ---------------------------
         
         Local num
         Local safety
         
         WorkWithDocument "PDEList"
         MoveCursorTo STARTOF DOCUMENT 
         Let safety = LinesInDocument
         Let num    = TrimString( GetWord( TheLine, 1, " :" ))
         
         While safety > 0
            
            If TrimString( PDE[C_PDE].Number ) = num
               ExitLoop
            EndIf
            
            Let safety = safety - 1
            MoveCursor DOWN 
            Let num = TrimString( GetWord( TheLine, 1, " :" ))
         EndLoop
      EndScript
      Routine "DeletePDE"
         ; -------------------------
         ; DeletePDE() SubRoutine.
         ; -------------------------
         
         DeleteArrayEntry PDE,C_PDE
         
         If VarType( PDE[C_PDE] ) = "Nothing"
            Let C_PDE = LastArrayIndex( PDE )
         EndIf
         
         Do "MakePDEList"
         Do "DisplayPDE"
         
      EndScript
      Routine "ModifyPDE"
         ; -------------------------
         ; ModifyPDE() SubRoutine.
         ; -------------------------
         
         Let PDE[C_PDE] = GetDBObjects
         
         Do "MakePDEList"
         Do "DisplayPDE"
         
      EndScript
      Routine "SortPDEs"
         ; ----------------------------------------
         ; SortPDEs( key, direction ) SubRoutine.
         ; ----------------------------------------
         
         Do "SortRecords","PDE",Arg1,Arg2,215,75
         
         Let C_PDE = FirstArrayIndex( PDE )
         
         Do "MakePDEList"
         Do "DisplayPDE"
         
      EndScript
      Routine "SetupDisplay"
         ; -----------------------------------------
         ; SetupDisplay() Subroutine - EditPDECard.
         ; -----------------------------------------
         
         Do "SetUpColors"
         Do "DrawRaisedBox",13,96,169,24
         
         If C_PDE < FirstArrayIndex( PDE )
            Let C_PDE = FirstArrayIndex( PDE )
         EndIf
         
         Do "MakePDEList"
         Do "DisplayPDE"
         
         SetWindowTitle WTTL[18]
      EndScript
      Routine "DisplayPDE"
         ; --------------------------------
         ; DisplayPDE( flag ) SubRoutine.
         ; --------------------------------
         
         SetDBObjects PDE[C_PDE]
         
         If FirstArrayIndex( PDE ) = 0
            SetInteger "EntryNum",C_PDE + 1
         Else
            SetInteger "EntryNum",C_PDE
         EndIf
         
         If Arg1 = FALSE OR Arg1 = NOTHING
            Do "HighlightPDE"
         EndIf
         
         SetWindowTitle WTTL[18]
      EndScript
      Routine "PDESelected"
         ; ---------------------------
         ; PDESelected() SubRoutine.
         ; ---------------------------
         
         Local i
         Local num
         
         WorkWithDocument "PDEList"
         Let num = TrimString( GetWord( TheLine, 1, " :" ))
         
         Let i = FirstArrayIndex( PDE )
         
         While i <= LastArrayIndex( PDE )
            
            If PDE[i].Number = num
               Let C_PDE = i
               ExitLoop
            EndIf
            
            Let i = i + 1
         EndLoop
         
         Do "DisplayPDE",TRUE
         
      EndScript
      Routine "AddPDE"
         ; ----------------------
         ; AddPDE() SubRoutine.
         ; ----------------------
         
         Local i
         
         Let i = C_PDE
         
         If C_PDE < LastArrayIndex( PDE )
            Let C_PDE = C_PDE + 1
         Else
            Let C_PDE = LastArrayIndex( PDE )
         EndIf
         
         InsertArrayEntry PDE,C_PDE
         
         Let PDE[C_PDE].ObjectName   = "COPY_"||PDE[i].ObjectName
         Let PDE[C_PDE].ObjectNum    = "COPY_"||PDE[i].ObjectNum
         Let PDE[C_PDE].Name         = "COPY_"||PDE[i].Name
         Let PDE[C_PDE].ActivityName = "COPY_"||PDE[i].ActivityName
         Let PDE[C_PDE].ActionNum    = "COPY_"||PDE[i].ActionNum
         Let PDE[C_PDE].ActionName   = "COPY_"||PDE[i].ActionName
         Let PDE[C_PDE].ActivityNum  = "COPY_"||PDE[i].ActivityNum
         Let PDE[C_PDE].Number       = PDE[i].Number||"_COPY"
         Let PDE[C_PDE].Description  = "COPY_"||PDE[i].Description
         
         Do "MakePDEList"
         Do "DisplayPDE"
         
      EndScript
      AfterAttachment
         SetWindowTitle WTTL[18]
         
         Do "SetupColors"
         
         If Supervised = FALSE
            Do "MakePDEList"
            Do "SetupDisplay"
         EndIf
      EndScript
      Window "UserWindow"
         Definition
            Origin 0,16
            Title "Edit Process Descriptive Entries:"
            WindowObjects CLOSEBUTTON DEPTHBUTTONS DRAGBAR 
            WindowLimits 250,15,640,480
            WindowZoom 0,13,250,15
            Size 640,390
            WindowFlags ACTIVATE TOFRONT WORKBENCH 
            VisualEffects NONE ,WAIT 
         EndScript
         OnCloseButton
            Do "Check_SavePDEs"
            
            GotoCard "PDECard"
            
         EndScript
         OnActivated
            Do "SetupDisplay"
         EndScript
         OnResized
            Do "SetupDisplay"
         EndScript
      EndObj
      AKey "HelpKey"
         Definition
            QualifiersPressed NONE 
            KeyPressed HELP 
         EndScript
         OnUp
            Let d = AskForHelp( HelpPath||"GOOSA.guide", "EditPDECard" )
            
         EndScript
      EndObj
      TextMenu "Save"
         Definition
            AttachTo MENU ,"PROJECT    "
            Text "Save"
            ShortCutKey "S"
         EndScript
         Occurred
            Do "SavePDEs"
            Let GotPDEs = FALSE
         EndScript
      EndObj
      AreaButton "NextPDE"
         Definition
            Origin 125,102
            Border BEVEL 
            Text " NEXT "
            Font "topaz",8
            Style PLAIN ,2,3
            TextColors 12,0,JAM1 
            Size 52,12
         EndScript
         OnRelease
            Do "NextPDE"
            
         EndScript
      EndObj
      AreaButton "PrevPDE"
         Definition
            Origin 18,102
            Border BEVEL 
            Text " PREV "
            Font "topaz",8
            Style PLAIN ,2,3
            TextColors 12,0,JAM1 
            Size 52,12
         EndScript
         OnRelease
            Do "PrevPDE"
            
         EndScript
      EndObj
      AreaButton "AddPDE"
         Definition
            Origin 558,77
            Border BEVEL 
            Text " ADD "
            Font "topaz",8
            Style PLAIN ,1,14
            TextColors 5,0,JAM1 
            Size 44,12
         EndScript
         OnRelease
            Do "AddPDE"
            
         EndScript
      EndObj
      TextField ".ObjectName"
         Definition
            InitialText ""
            Origin 428,56
            Size 170,12
            Border DOUBLEBEVEL 
            Label "Object Name:",HIGHLIGHT 
            Justification CENTER 
            MaxFieldLength 80
            Font "topaz",8
         EndScript
      EndObj
      TextField ".ObjectNum"
         Definition
            InitialText ""
            Origin 428,74
            Size 90,12
            Border DOUBLEBEVEL 
            Label "Object #:",HIGHLIGHT 
            Justification CENTER 
            MaxFieldLength 32
            Font "topaz",8
         EndScript
      EndObj
      TextField ".ActivityName"
         Definition
            InitialText ""
            Origin 427,20
            Size 170,12
            Border DOUBLEBEVEL 
            Label "Activity Name:",HIGHLIGHT 
            Justification CENTER 
            MaxFieldLength 80
            Font "topaz",8
         EndScript
      EndObj
      TextField ".ActivityNum"
         Definition
            InitialText ""
            Origin 427,38
            Size 90,12
            Border DOUBLEBEVEL 
            Label "Activity #:",HIGHLIGHT 
            Justification CENTER 
            MaxFieldLength 128
            Font "topaz",8
         EndScript
      EndObj
      TextField ".ActionName"
         Definition
            InitialText ""
            Origin 106,56
            Size 170,12
            Border DOUBLEBEVEL 
            Label "Action Name:",HIGHLIGHT 
            Justification CENTER 
            MaxFieldLength 80
            Font "topaz",8
         EndScript
      EndObj
      TextField ".ActionNum"
         Definition
            InitialText ""
            Origin 106,74
            Size 90,12
            Border DOUBLEBEVEL 
            Label "Action #:",HIGHLIGHT 
            Justification CENTER 
            MaxFieldLength 128
            Font "topaz",8
         EndScript
      EndObj
      TextField ".Name"
         Definition
            InitialText ""
            Origin 106,20
            Size 170,12
            Border DOUBLEBEVEL 
            Label "Process Name:",HIGHLIGHT 
            Justification CENTER 
            MaxFieldLength 80
            Font "topaz",8
         EndScript
      EndObj
      Memo ".Description"
         Definition
            MemoDocument "PDEDescList"
            ScrollBars RIGHT BOTTOM 
            Origin 9,136
            Size 624,114
            Border BEVEL 
            Label "Process Description:",HIGHLIGHT ABOVE 
            Font "topaz",8
         EndScript
      EndObj
      AreaButton "ModifyPDE"
         Definition
            Origin 558,97
            Border BEVEL 
            Text " MODIFY "
            Font "topaz",8
            Style PLAIN ,2,3
            TextColors 2,0,JAM1 
            Size 68,12
         EndScript
         OnRelease
            Do "ModifyPDE"
            
         EndScript
      EndObj
      TextMenu "Save As"
         Definition
            AttachTo MENU ,"PROJECT    "
            Text "Save As..."
            ShortCutKey "A"
         EndScript
         Occurred
            Do "SaveAsPDEFile"
            
         EndScript
      EndObj
      AreaButton "DeletePDE"
         Definition
            Origin 558,117
            Border BEVEL 
            Text 