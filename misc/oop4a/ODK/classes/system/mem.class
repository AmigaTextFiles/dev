
class mem
{
    Object class com.amiga.system.execwrapper exec
    Object class system/misc tools

    long mem_p memsize
   
    public getMem(long Len)
     {
       long newmem 

       if len>0
        {
           newmem=exec.AllocMem(len,#MEMF_FAST!MEMF_CLEAR)
        }

       if mem_P#0 and memsize#0
        {
          if newmem#0
           {
              if len<=memsize 
               {
                 exec.CopyMem(mem_p,newmem,len)
               }
              if len>memsize 
               {
                 exec.CopyMem(mem_p,newmem,memsize)
               }
           }
          exec.FreeMem(mem_p,memsize)
          mem_P==0
          memsize==0
        } 

       mem_P==newmem
       memsize==len
     }

    public getAddr()
     {
       return mem_P
     }

    public getChipMem(long Len)
     {
       if mem_P#0
        {
          exec.FreeMem(mem_p,len)
        }
       memsize==len
       if len>0
        {
           mem_p=exec.AllocMem(len,#MEMF_CHIP!MEMF_CLEAR)
        }
     }
     
    public addMem(long len)
     {

       long mem2 len2
        
       len2==memsize+len
       mem2=exec.AllocMem(len2,#MEMF_FAST!MEMF_CLEAR)
       if mem2#0
        {
          exec.CopyMem(mem_p,mem2,memsize)
          exec.FreeMem(mem_p,memsize)
          mem_p==mem2
          memsize==len2
          return memsize
        }
       return 0
     }

    public addMemContent(long source,long sourcelen)
     {
    
       long mem2 len2
        
       len2==memsize+sourcelen
       mem2=exec.AllocMem(len2,#MEMF_FAST!MEMF_CLEAR)
       if mem2#0
        {
          exec.CopyMem(mem_p,mem2,memsize)
          exec.FreeMem(mem_p,memsize)
          exec.CopyMem(source,mem2+memsize,sourcelen)
          mem_p==mem2
          memsize==len2
          return memsize
        }
       return 0
     }

    public clearMem()
     {
        tools.Fillbuffer(mem_p,0,memsize)
     }

    public getSize()
     {
        return memsize
     }

    public DeConstructor()
    {
      if mem_p#0
       {
         exec.FreeMem(mem_p,memsize)
         mem_P==0
       }
    }
}
