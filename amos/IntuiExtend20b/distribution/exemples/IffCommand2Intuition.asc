'**************************************
'                                     *
'     IntuiExtend.Lib 2.0/@1995-98    *
'                                     *
'          by CIERP Philippe.         *
'                                     *
'          from AMIGAzette 83         *
'                                     *
'**************************************
'
' Command  
'  -Iff Open Read
'  -Iff Get Error
'  -Iff Get Vmode
'  -Iff Get Width
'  -Iff Get Height   
'  -Iff Get Xpos   
'  -Iff Get Ypos   
'  -Iff Get Depth    
'  -Wb Depth To Colour 
'  -Wb Screen Open 
'  -Wb Screen Base 
'  -Wb Screen Rastport 
'  -Wb Screen Palette
'  -Iff Decode Picture 
'  -Hard Mouse Key 
'  -Wb Screen Close
'  -Iff Close
'
' Ouverture de l'image en lecture  
A$=Fsel$("")+Chr$(0)
_IFF=Iff Open Read(A$)
'
If _IFF<=0
   ERR0R=Iff Get Error
   Print ERR0R
   Iff Close _IFF
   End 
End If 
'
Amos To Back 
'
' Prendre le mode video (ViewMode > EHB, HAM6, HAM8, Lace, Hires etc...) 
VMODE=Iff Get Vmode(_IFF)
'
' Prise des informations dans le BMHD  
WIDTH=Iff Get Width(_IFF)
HEIGHT=Iff Get Height(_IFF)
XPOS=Iff Get Xpos(_IFF)
YPOS=Iff Get Ypos(_IFF)
DEPTH=Iff Get Depth(_IFF)
'
' Ouverture de l'écran intuition 
Wb Screen Open 0,0,WIDTH,HEIGHT,DEPTH,VMODE
SCR0=Wb Screen Base
'
' Adresse du rastport (Structure video des écrans et fenétres) 
RP0=Wb Screen Rastport(SCR0)
'
' Réservation de mémoire pour une image (Couleurs Max(256)*2)  
Reserve As Work 998,256*2 : CTABLE=Start(998)
'
'Convertion du CMAP en palette utilisable. 
_COLOR_MAX=Iff Get Ctable(_IFF,CTABLE)
'
'Puis installer la palette dans les écrans (IntuiExtend...). 
Wb Screen Palette CTABLE,_COLOR_MAX To SCR0
'
' Affiche l'image
RES=Iff Decode Picture(_IFF,RP0)
'
' Fermer le Buffer image 
Iff Close _IFF
'
' Attente d'un clik de souris, bouton de droite. 
While Hard Mouse Key<>2 : Wend 
' Fermer la fenetre
Wb Screen Close SCR0
