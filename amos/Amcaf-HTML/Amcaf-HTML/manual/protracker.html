<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <!--
      AMCAF Extension V1.40 Manual for Amos Professional, written by Chris Hodges (1994/95) and compiled by asymetrix for the Amiga community and should stay completely FREE FOREVER.
      Created 2009. :)
  -->
  <title>AMCAF Extension V1.40 Manual</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="keywords" content="AMCAF Extension V1.40 Manual, Amos Professional, Amiga, Programming, Basic, Chris Hodges, Extension, computing, code, AmigaDOS, Aminet.net">
  <meta name="author" content="asymetrix">

</head>

<body bgcolor="white">
<a href="../index.html">AMCAF Extension V1.40 Manual</a>&nbsp; <a href="../command.html">Index</a>

<hr align="center" size="1" width="100%">

<h1>Protracker Music Commands</h1>

<br>

<p>
As the AMOS Tracker commands are really crap and contain a lot of bugs,
of course there is a replacement for them in the AMCAF extension.</p>

<p>
Since version 1.1 there are new commands even to replay sound effects
during the normal protracker music.<br>
The AMOS Music Extension is rather obsolete now.</p>

<p>Here a brief list of all advances of the AMCAF commands:</p>


<ul>
  <li>CIA timing or VBL timing.</li>
  <li>Volume control.</li>
  <li>Channel toggling.</li>
  <li>Vu meters.</li>
  <li>Possibility to receive signals from the module.</li>
  <li>Support of all Protracker effect commands.</li>
  <li>Playback of sound effects along with the music.</li>
</ul>

<ul>
  <li><a href="#ptplay">Pt Play</a></li>
  <li><a href="#ptstop">Pt Stop</a></li>
  <li><a href="#ptcontinue">Pt Continue</a></li>
  <li><a href="#ptvolume">Pt Volume</a></li>
  <li><a href="#ptvoice">Pt Voice</a></li>
  <li><a href="#ptciaspeed">Pt Cia Speed</a></li>
  <li><a href="#ptrawplay">Pt Raw Play</a></li>
  <li><a href="#ptbank">Pt Bank</a></li>
  <li><a href="#ptinstrplay">Pt Instr Play</a></li>
  <li><a href="#ptsambank">Pt Sam Bank</a></li>
  <li><a href="#ptsamplay">Pt Sam Play</a></li>
  <li><a href="#ptsamstop">Pt Sam Stop</a></li>
  <li><a href="#ptsamvolume">Pt Sam Volume</a></li>
  <li><a href="#ptsamfreq">Pt Sam Freq</a></li>
  <li><a href="#ptvu">=Pt Vu</a></li>
  <li><a href="#ptsignal">=Pt Signal</a></li>
  <li><a href="#ptcpattern">=Pt Cpattern</a></li>
  <li><a href="#ptcpos">=Pt Cpos</a></li>
  <li><a href="#ptcinstr">=Pt Cinstr</a></li>
  <li><a href="#ptcnote">=Pt Cnote</a></li>
  <li><a href="#ptinstraddress">=Pt Instr Address</a></li>
  <li><a href="#ptinstrlength">=Pt Instr Length</a></li>
  <li><a href="#ptdatabase">=Pt Data Base</a></li>
</ul>

<br>

<a name="ptplay"></a>
<p><b>PT PLAY</b><br>
<i>instruction: replay a module</i><br>
<b>Pt Play</b> bank<br>
<b>Pt Play</b> bank,songpos</p>

<p>
Pt Play stars a Protracker music module which has be situated in memory
bank number 'bank'.<br>
Optionally, you can specify a song position, which the music should be played from.</p>

<p>
Before you start the music with Pt Play you should choose either Vertical
Blank-Timing or CIA-Timing for the module using Pt Cia Speed.</p>

<p>
With help of the Pt Instr Play instruction you can replay any instrument
of the music track.<br>
This method has the advantage that you can reuse a sample that occurs in the music for your sound effects.</p>

<p>
If you want to use the instruments only, without replaying the music, you
can call the Pt Bank command instead.<br>
The music will be turned off again with a call to the Pt Stop instruction.</p>

<br>

<a name="ptstop"></a>
<p><b>PT STOP</b><br>
<i>instruction: stop the current music module</i><br>
<b>Pt Stop</b></p>

<p>
This command stops the current music module. You can restart the music with the
Pt Continue command from the very position you stopped it.</p>

<br>

<a name="ptcontinue"></a>
<p><b>PT CONTINUE</b><br>
<i>instruction: restart a previously stopped protracker music</i><br>
<b>Pt Continue</b></p>

<p>
This command restarts the protracker music at that point it has previously been stopped
using Pt Stop.<br>
Do not attempt use Pt Continue without having started the music once with Pt Play.</p>

<br>

<a name="ptvolume"></a>
<p><b>PT VOLUME</b><br>
<i>instruction: set the volume of the protracker music</i><br>
<b>Pt Volume</b> value</p>

<p>
The Pt Volume instruction sets the volume of the music. The parameter
'value' may range from 0 (silent) to 64 (full volume).</p>

<br>

<a name="ptvoice"></a>
<p><b>PT VOICE</b><br>
<i>instruction: toggle the audio channels</i><br>
<b>Pt Voice</b> bitmask</p>

<p>
This command defines the channels which should be used for the music and
which should be free for e.g sound effects.</p>

<p>
The 'bitmask' parameter contains -similar to the AMOS Voice command- four
bits, that are assigned to one channel each.<br>
If a bit is set, this channel can be heard. Pt Voice %1111 turns on all sound channels.</p>

<br>

<a name="ptciaspeed"></a>
<p><b>PT CIA SPEED</b><br>
<i>instruction: change the replay speed of a protracker module</i><br>
<b>Pt Cia Speed</b> bpm</p>

<p>
With the help of this command, you can set the speed for replaying the
Protracker modules.<br>
However, the music may change the speed on it's own if it has been composed for CIA-Timing.</p>

<p>
The parameter 'bpm' set the number of beats per minute or if you specify a value of zero, the timing will be
switched from CIA-Timing to Vertical Blank Timing.<br>
Then the bpm rate is automatically set to exactly 125 and all CIA-Timing from the module are
ignored if such appear in the music.</p>

<p>
CIA-Timing causes some problems in conjunction with AMOS sprites, which
show up as a flickering at regular intervals.<br>
If you work with sprites you should switch back to VBL-Timing where possible using Pt Cia Speed 0.</p>

<p>
If a music module is not replaying correctly using VBL-Timing, i.e it is running to fast or slow,
you must switch to Cia-Timing.<br>
This can achieved with a Pt Cia Speed 125 command directly in front of a Pt Play instruction.<br>
The default is CIA-Timing with 125 bpm.</p>

<br>

<a name="ptrawplay"></a>
<p><b>PT RAW PLAY</b><br>
<i>instruction: play a chunk of memory as a sound sample</i><br>
<b>Pt Raw Play</b> voice,address,length,freq</p>

<p>
This command corresponds to the normal AMOS command Sam Raw. Pt Raw Play
replays a piece of memory as an audio sample.</p>

<p>
The 'voice' parameter sets the channels to use, 'address' contains the starting address of the
memory block.<br>
'length' is the length of the sample in bytes and 'freq' holds the replaying speed in Hertz.</p>

<br>

<a name="ptbank"></a>
<p><b>PT BANK</b><br>
<i>instruction: set the bank to use with pt instr play</i><br>
<b>Pt Bank</b> bank</p>

<p>
This command is used if you want to play back instruments from a music
module but the music bank has not yet been specified with Pt Play.</p>

<br>

<a name="ptinstrplay"></a>
<p><b>PT INSTR PLAY</b><br>
<i>instruction: play an instrument of a protracker module</i><br>
<b>Pt Instr Play</b> instnr<br>
<b>Pt Instr Play</b> voice,instnr<br>
<b>Pt Instr Play</b> voice,instnr,freq</p>

<p>The Pt Instr Play instruction replays an instrument of the current Protracker music module.</p>

<p>
The 'voice' parameter contains a bitmask that says on which channels the
instrument number 'instnr' should be played.<br>
If it is omitted, the sound effect is output on all four channels. 'instnr' must range between 1 and 31.<br>
The optional argument 'freq' holds the frequency which should be used for the sample.</p>

<p>
If you want to replay a sample repeatedly, just specify a negative value
for 'instnr'.<br>
The volume of the instrument can be set with the Pt Sam Volume command.</p>

<p>
Before you can replay an instrument of a module, you first have to specify
the bank that holds the music.<br>
This can be achieved either by a call to Pt Bank or Pt Play.</p>

<br>

<a name="ptsambank"></a>
<p><b>PT SAM BANK</b><br>
<i>instruction: set the bank to use with amos samples</i><br>
<b>Pt Sam Bank</b> bank</p>

<p>
If you want to replay standard AMOS samples with AMCAF, you have to
inform AMCAF about the Sample-Bank, which contains the sound effects.<br>
And that's exactly what Pt Sam Bank does. 'bank' holds the bank number of the AMOS sample bank.</p>

<p>Please remember, that you can replay the instruments of music modules directly.</p>

<br>

<a name="ptsamplay"></a>
<p><b>PT SAM PLAY</b><br>
<i>instruction: replay a sample from an amos sample bank</i><br>
<b>Pt Sam Play</b> samnr<br>
<b>Pt Sam Play</b> voice,samnr<br>
<b>Pt Sam Play</b> voice,samnr,freq</p>

<p>
The Pt Sam Play command plays a sample out of an AMOS sample bank. The
advantage to the normal Sam Play instruction is that the sounds 'interact'
with the Protracker music.<br>
Moreover, no notes are missed out, like AMOS does this on accelerated Amigas.</p>

<p>
The 'voice' parameter contains a bitmask, that describes, on which
channels  the sample number 'samnr' should be replayed.<br>
If it is omitted, the sound effect will be played on all four sound channels. The optional
argument 'freq' holds the replaying speed, that shall be used.</p>

<p>
If you want the sample to be looping, just give a negative value for
'samnr'. The volume of the sample can be changed using Pt Sam Volume.</p>

<br>

<a name="ptsamstop"></a>
<p><b>PT SAM STOP</b><br>
<i>instruction: stop the sfx on specific audio channels</i><br>
<b>Pt Sam Stop</b> voice</p>

<p>
This command stops a sound effect on the channels, which are defined in the bitmap
'voice'.<br>
This is valid for samples started by Pt Sam Play, Pt Instr Play and Pt Raw Play.</p>

<br>

<a name="ptsamvolume"></a>
<p><b>PT SAM VOLUME</b><br>
<i>instruction: set the volume of a sound effect</i><br>
<b>Pt Sam Volume</b> volume<br>
<b>Pt Sam Volume</b> voice,volume</p>

<p>
This instruction sets the volume for the following sample replays.
The 'volume' parameter must range from 0 to 64.<br>
If you specify the optional parameter 'voice', the command only has effect on the currently played
sample, but not on the following samples.</p>

<br>

<a name="ptsamfreq"></a>
<p><b>PT SAM FREQ</b><br>
<i>instruction: change the replaying speed of a sample</i><br>
<b>Pt Sam Freq</b> chan,freq</p>

<p>
This command changes the frequency of the sample currently being played on
channel chan to the new frequency in freq.<br>
If no sample is currently played on this channel, it will have no effect nor will it have effect on
the protracker music.</p>

<br>

<a name="ptvu"></a>
<p><b>PT VU</b><br>
<i>function: return the current vumeter value</i><br>
vol=<b>Pt Vu</b>(channel)</p>

<p>
This command allows you to read the current volume of channel number 'channel'.<br>
If a new note is played, 'vol' contains the volume level else 0.</p>

<br>

<a name="ptsignal"></a>
<p><b>PT SIGNAL</b><br>
<i>function: check for signals from the music</i><br>
signal=<b>Pt Signal</b></p>

<p>
The various music trackers Soundtracker, Noisetracker, Startrekker or
Protracker feature effect commands e.g.<br>
To change the volume of a note, or for portamento. Example for a Protracker noteline:</p>

<pre>
00 C-1 1000 --- 0000 G-2 2000 --- 0000
   ^ ^ ^
   | | `-----------------------------------------------.
   | `---------------------.                           |
   `--------------.        |                           |
   Plays the note C in the 1st octave using instrument 1.

Additionally, you can use effects, e.g like in this line here:

00 C-1 1C20 --- 0F04 G-2 2E00 --- 0801
        ^^^      ^^^      ^^^      ^^^
Set vol.to $20  Speed  Filter Off  \|/
         (=32)  4 VBLs              Y
 .----------------------------------'
 |
</pre>


<p>
Now this is an effect, which is unused in all trackers. It has been left
free to synchronize various events to the music.<br>
The value behind the '8' is directly transferred to Pt Signal, when the music reaches the specific
point.<br>
<b>Warning: The value used in Protracker is entered as hex number.</b></p>

<p>
With this technique you can wait for a special acoustic signal, or sync
some kind of musician bobs to the music.</p>

<p>
If there is no signal waiting, zero is returned in the variable 'signal'.
After using Pt Signal, the old signal will be cleared.<br>
Pt Signal can only keep one value at once, i.e if the last value hasn't been read out, the
next signal will overwrite the last one and is therefore lost.</p>

<p>If the end of the music is reached an $FF signal is sent automatically.</p>

<br>

<a name="ptcpattern"></a>
<p><b>PT CPATTERN</b><br>
<i>function: return the current song position</i><br>
songpos=<b>Pt Cpattern</b></p>

<p>
This function returns the current pattern/song position.<br>
This can be used to restart a song at a given position when you stopped the music with Pt Stop.</p>

<br>

<a name="ptcpos"></a>
<p><b>PT CPOS</b><br>
<i>function: return the current pattern line</i><br>
row=<b>Pt Cpos</b></p>

<p>
This function returns the current 'row' of the songs current pattern. The returned value is a number between 0 and 63.</p>

<br>

<a name="ptcinstr"></a>
<p><b>PT CINSTR</b><br>
<i>function: return the current instrument being played</i><br>
num=<b>Pt Cinstr</b>(chan)</p>

<p>
Pt Cinstr returns the instrument being played on music channel chan. num
is therefore a value between 0 and 31.<br>
A value of 0 tells you, that no sample has been trigged at that very moment.</p>

<br>

<a name="ptcnote"></a>
<p><b>PT CNOTE</b><br>
<i>function: return the frequency of the current instrument</i><br>
num=<b>Pt Cnote</b>(chan)</p>

<p>
Pt Cnote returns the frequency of an instrument being played on music
channel chan at that very moment.</p>

<br>

<a name="ptinstraddress"></a>
<p><b>PT INSTR ADDRESS</b><br>
<i>function: return the address of an instrument</i><br>
address=<b>Pt Instr Address</b>(instnr)</p>

<p>
This command returns the starting address of the music instrument with the
number 'instnr' of the current Protracker module.</p>

<br>

<a name="ptinstrlength"></a>
<p><b>PT INSTR LENGTH</b><br>
<i>function: return the length of an instrument</i><br>
length=<b>Pt Instr Length</b>(instnr)</p>

<p>This command returns the length of the instrument 'instnr'.</p>

<br>

<a name="ptdatabase"></a>
<p><b>PT DATA BASE</b><br>
<i>function: return the address of the pt-database</i><br>
address=<b>Pt Data Base</b></p>

<p>
This command returns the starting address of the internal data table of the protracker
replay routine. Please don't write into this area randomly.</p>

</body>
</html>
