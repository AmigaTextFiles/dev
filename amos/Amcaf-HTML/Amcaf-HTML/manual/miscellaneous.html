<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <!--
      AMCAF Extension V1.40 Manual for Amos Professional, written by Chris Hodges (1994/95) and compiled by asymetrix for the Amiga community and should stay completely FREE FOREVER.
      Created 2009. :)
  -->
  <title>AMCAF Extension V1.40 Manual</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="keywords" content="AMCAF Extension V1.40 Manual, Amos Professional, Amiga, Programming, Basic, Chris Hodges, Extension, computing, code, AmigaDOS, Aminet.net">
  <meta name="author" content="asymetrix">

</head>

<body bgcolor="white">
<a href="../index.html">AMCAF Extension V1.40 Manual</a>&nbsp; <a href="../command.html">Index</a>

<hr align="center" size="1" width="100%">

<h1>Misc Commands and Functions</h1>

<br>

<ul>
  <li><a href="#exchangebob">Exchange Bob</a></li>
  <li><a href="#exchangeicon">Exchange Icon</a></li>
  <li><a href="#audiolock">Audio Lock</a></li>
  <li><a href="#audiofree">Audio Free</a></li>
  <li><a href="#openworkbench">Open Workbench</a></li>
  <li><a href="#flushlibs">Flush Libs</a></li>
  <li><a href="#writecli">Write Cli</a></li>
  <li><a href="#resetcomputer">Reset Computer</a></li>
  <li><a href="#nop">Nop</a></li>
  <li><a href="#agadetect">=Aga Detect</a></li>
  <li><a href="#scanstr">=Scanstr$</a></li>
  <li><a href="#commandname">=Command Name$</a></li>
  <li><a href="#tooltypes">=Tool Types$</a></li>
  <li><a href="#amoscli">=Amos Cli</a></li>
  <li><a href="#speek">=Speek</a></li>
  <li><a href="#sdeek">=Sdeek</a></li>
  <li><a href="#cpu">=Cpu</a></li>
  <li><a href="#fpu">=Fpu</a></li>
  <li><a href="#nfn">=Nfn</a></li>
  <li><a href="#coppos">=Cop Pos</a></li>
</ul>

<br>

<a name="exchangebob"></a>
<p><b>EXCHANGE BOB</b><br>
<i>instruction: swap the two images in the sprite bank</i><br>
<b>Exchange Bob</b> image 1,image 2</p>

<p>
This command simply swaps the two images image 1 and image 2 in the current sprite
bank. image 1 and image 2 must exist as a valid image, otherwise an error will be reported.</p>

<br>

<a name="exchangeicon"></a>
<p><b>EXCHANGE ICON</b><br>
<i>instruction: swap the two images in the icon bank </i><br>
<b>Exchange Icon</b> image 1,image 2</p>

<p>
This command simply swaps the two images image 1 and image 2 in the current icon
bank. image 1 and image 2 must exist as a valid image, otherwise an error will be reported.</p>

<br>

<a name="audiolock"></a>
<p><b>AUDIO LOCK</b><br>
<i>instruction: reserve the audio device</i><br>
<b>Audio Lock</b></p>

<p>
When you start AMOS, the audio.device will be not informed, that AMOS wants to have the audio channels.<br>
Due to this flaw, other programs that are running in the background can replay a sound at any time, which will
irritate the AMOS sound system.<br>
To avoid this and to be more system friendly, you can use the command Audio Lock to reserve the sound channels.<br>
As AMOS has a bug, you'll have to do it like this:</p>

<pre>
Extremove 1     : Rem removes music extension
Trap Audio Lock : Rem reserves the audio channels
ERR=Errtrap     : Rem tests, if audio lock was successful
Extreinit 1     : Rem initializes the music extension again
Extdefault 1    : Rem calls the default routine of the extension
</pre>

<p>
This Routine should be called as soon as possible and BEFORE you start
to play music or sounds.<br>
If the audio channels are already in use by any other program, ERR holds an error code, otherwise zero.</p>

<p>To free the channels again, you have to call Audio Free.</p>

<br>

<a name="audiofree"></a>
<p><b>AUDIO FREE</b><br>
<i>instruction: free the audio device</i><br>
<b>Audio Free</b></p>

<p>Using Audio Free you can free previously allocated sound channels again.</p>

<br>

<a name="openworkbench"></a>
<p><b>OPEN WORKBENCH</b><br>
<i>instruction: reopen a previously closed workbench</i><br>
<b>Open Workbench</b></p>

<p>
This command tries to open the workbench again, if it has been closed previously.<br>
The Workbench screen can be closed using the AMOS command Close Workbench to get more memory.</p>

<br>

<a name="flushlibs"></a>
<p><b>FLUSH LIBS</b><br>
<i>instruction: free as much memory as possible </i><br>
<b>Flush Libs</b></p>

<p>
This command closes all libraries, fonts and devices, which are currently
not in use and tries to get as much memory as possible.<br>
During this process the PowerPacker and the diskfont.library will be 'flushed', too.</p>

<br>

<a name="writecli"></a>
<p><b>WRITE CLI</b><br>
<i>instruction: write text into the cli window</i><br>
<b>Write Cli</b> text$</p>

<p>
The Write Cli instruction writes the string 'text$' into the CLI window,
AMOS or your program has been start from.<br>
If this window does not exist, no text will be output.</p>

<br>

<a name="resetcomputer"></a>
<p><b>RESET COMPUTER</b><br>
<i>instruction: reset your computer</i><br>
<b>Reset Computer</b></p>

<p>
This very dangerous instruction reboots your Amiga. Obviously, this command never returns to the program.</p>

<br>

<a name="nop"></a>
<p><b>NOP</b><br>
<i>instruction: no effect</i><br>
<b>Nop</b></p>

<p>This 'command' has no effect et al. It's only use is for speed testing routines.</p>

<br>

<a name="agadetect"></a>
<p><b>AGA DETECT</b><br>
<i>function: check if the computer has aga chipset</i><br>
flag=<b>Aga Detect</b></p>

<p>
This is a simple function that checks for the existence of the AGA
chipset, found in A1200, A4000 and CD³² machines.<br>
It returns -1 (True), if the new chipset is mounted or 0 (False) if the ECS or OCS chipset are still in use.</p>

<p>
Note that it does not check for the kickstart version only, so A2000 and
A500 machines with kick 3.0 or higher will be detected as non-AGA
correctly.<br>
This function is 100% system conform and won't hack the hardware for it's result.<br>
Therefore, if the AGA chipset had been disabled either using the boot menu or the "Setpatch NOAGA" command, it will return
that no AGA is available.</p>

<br>

<a name="scanstr"></a>
<p><b>SCANSTR$</b><br>
<i>function: return the name of a key</i><br>
key$=<b>Scanstr$</b>(scancode)</p>

<p>
This very handy function returns the name of a key according to the
parameter 'scancode', which can be fetched using the AMOS Scancode
function.<br>
If there is no key for the scancode, an empty string will be returned.</p>

<br>

<a name="commandname"></a>
<p><b>COMMAND NAME$</b><br>
<i>function: return the name of the program</i><br>
fname$=<b>Command Name$</b></p>

<p>
Returns the file name of the program under which AMOS or the compiled
program has been started.<br>
This is required for example to read the own Tool Types.</p>

<br>

<a name="tooltypes"></a>
<p><b>TOOL TYPES$</b><br>
<i>function: read the tool types of an icon</i><br>
tools$=<b>Tool Types$</b>(filename$)</p>

<p>
With this function you can acquire the Tool Type of an icon. The supplied file 'filename$' must not have a '.info' appended!<br>
The various Tool Types are separated by a line feed character (Chr$(10)). So they can be printed out easily using Print. </p>

<p>The name of your own program can be fetched using Command Name$.</p>

<br>

<a name="amoscli"></a>
<p><b>AMOS CLI</b><br>
<i>function: return the cli process number of an amos.program</i><br>
n=<b>Amos Cli</b></p>

<p>
This function gives back the number of the cli process out of which the
program/AMOS has been started off or zero, if AMOS has been started from
Workbench.<br>
This gives you the choice to either interpret options from the command line or from the tool types of the appropriate icon.</p>

<br>

<a name="speek"></a>
<p><b>SPEEK</b><br>
<i>function: return a signed byte from memory</i><br>
value=<b>Speek</b>(address)</p>

<p>
The Speek function reads a <a href="additional.html#byte">Byte</a> from the memory address 'address',
exactly the AMOS function Peek.<br>
However, Bit 7 is used as sign bit so the result will be a value between -128 and 127.<br>
You are advised to use this function instead of Peek if you have poked a negative
value into memory and then want to read it again.</p>

<br>

<a name="sdeek"></a>
<p><b>SDEEK</b><br>
<i>function: return a signed word from memory</i><br>
value=<b>Sdeek</b>(address)</p>

<p>
The Sdeek function reads a <a href="additional.html#word">Word</a> from the EVEN memory address
'address', exactly the AMOS function Deek.<br>
However, Bit 15 is used as sign bit so the result will be a value between -32678 and 32677.<br>
You are advised to use this function instead of Deek if you have doked a negative value into
memory and then want to read it again.</p>

<br>

<a name="cpu"></a>
<p><b>CPU</b><br>
<i>function: return the number of the fitted cpu</i><br>
chip=<b>Cpu</b></p>

<p>
The cpu function returns the identification number of the central processing unit currently installed your Amiga.<br>
This number can currently lie between 68000 to 68060. Kickstart 1.3 knows only CPUs to the 68020.</p>

<br>

<a name="fpu"></a>
<p><b>FPU</b><br>
<i>function: return the id number of an coprocessor</i><br>
chip=<b>Fpu</b></p>

<p>
This function returns the number of an installed mathematic coprocessor
or 0, if none is fitted. As before, Kickstart 1.3 only knows the 68881.</p>

<p>
On 68040/68060 machines, the cpu contains the fpu, so 68040 or 68060 will be returned instead.</p>

<br>

<a name="nfn"></a>
<p><b>NFN</b><br>
<i>function: no effect</i><br>
dummy=<b>Nfn</b></p>

<p>
This 'function' returns nothing useful. It's only used, like Nop, in speed testing routines.</p>

<br>

<a name="coppos"></a>
<p><b>COP POS</b><br>
<i>function: return the current address of the copper list</i><br>
address=<b>Cop Pos</b></p>

<p>
If you create your own copper list, you can use this function to remember
the position of the next copper instruction.<br>
Later you can then write to this address directly to change the values of a copper instruction.</p>

</body>
</html>
