'
'   Get Tool Type V1.0  by Miroslaw Siedlarz  -  FreeWare  
'
'
_ICON_NAME$="Test_icon.info"
_TOOL_TYPE$="autocenter"
'
Proc _GET_TOOL_TYPE[_ICON_NAME$,_TOOL_TYPE$]
'
Print "icon name - "+_ICON_NAME$
Print "tool type - "+_TOOL_TYPE$
Print "result    - "+Param$
'
'
Procedure _GET_TOOL_TYPE[NAME$,TYPE$]
   
   If Not Exist(NAME$) : Pop Proc["file not found"] : End If 
   
   TYPE$=Lower$(TYPE$+"=")
   
   Open In 1,NAME$
   Reserve As Work 55,Lof(1)
   Close 1
   Bload NAME$,Start(55)
   
   Poke$ Start(55),Lower$(Peek$(Start(55),Length(55)))
   
   A=Hunt(Start(55) To Start(55)+Length(55),TYPE$)
   
   If A=0 or Peek$(A-1,1)="("
      A$="tool type is disabled"
   Else 
      B=Hunt(A To Start(55)+Length(55),Chr$(0))
      A$=Peek$(A,B-A)
      A$=A$-TYPE$
   End If 
   Erase 55
   
End Proc[A$]
'
