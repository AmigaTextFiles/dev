'***************************************************************************** 
'**         AMOS MUI Demo V1.0 - By Paul Hickman (ph@doc.ic.ac.uk)          **   
'**         ==================   =================================          ** 
'** This file is both a demonstraction, and an application template. Read   ** 
'** the comments on how & where to modify it.                               ** 
'**                                                                         ** 
'**    At least MUI V2.1 (muimaster.library V8) is required, and KS2.04+    ** 
'**                                                                         ** 
'** MUI V2.1 is available on aminet as /dev/gui/mui21usr.lha. You should    ** 
'** also get /dev/gui/mui21dev.lha to get the programers documentation &    ** 
'** autodocs. You do not need the rest of the developers archive, apart     ** 
'** from maybe the demo programs sources to look at examples of objects.    ** 
'**                                                                         ** 
'** This freeware. It may be freely distributed / modified as long as no    ** 
'** profit is made, except as part of a shareware program, where you may    ** 
'** use it if you send me a registered copy.                                ** 
'**                                                                         ** 
'** Please send me any MUIB macro procedures you write that may be usefull, ** 
'** other improvements, ideas, and bug reports.                             ** 
'***************************************************************************** 

'Rev 19
'
'NOTE: If you break an MUI program, or an error occurs, you should go to 
'direct mode and type  Areg(0)=APP_Obj : A=LibCall(2,-$24)  immediately  
'to remove the MUI windows & commodities brokers.
'
'
'NOTE: The symbolic names for MUI's constants have been taken from the MUI.I 
'      assembler include file, and in a few cases differ slightly from the 
'      C MUI.h file. 
'
'
'Bank Usage
'==========
'
'
'13 - Symbol Table Weight Balenced (Almost) Binary Tree for MUI & ASL taglists 
'14 - Generic Hook Code that calls _USER_RETURN_ID 
'17 - MUI Permanent Workspace
'18 - MUI Temporary Workspace
'
'32 - Special Hook Code for LISTSTRING objects 
'

Set Buffer 20
Load "MUI-DEMO.abk"
'
'
'********************  
'** Debugging Mode **
'********************
'
'Since if errors occur in your initial objects taglists, you may have some 
'objects already allocated, run with _DEBUG=1 initially, until you get the 
'message 'Application Tested OK', then switch _DEBUG=0 to run for real. When 
'_DEBUG=1, the no objects are actually created, so if something goes wrong,  
'you don't have to manually dispose of anything. 

_DEBUG=0
'
'****************************************************************************
'For Users of andrew chruches Intuition Extension, you can put MUI windows 
'on an AMOS Intuition screen - uncomment this line, and those in the window
'definitions, and the Iscreen Close at the end.
'
'Iscreen Open 0,640,256,2,Hires,"MUI Demo Screen"
'

'
'
'MUI Initialisation  
'==================
'
'Parameter 1 is size of bank 17 which is reserved for string gadget text,  
'hook data structures, etc. You can find out how much has been used at 
'any time by examining the value of MUI_WORK_PTR which points to it's end
'
'Parameter 2 is size of bank 18 which is used to store a taglist temporary 
'literal strings.
'
_MUI_INIT[10000,2000]

'MUI Macros
'==========
'
'I Have not yet converted all MUI macros. Some simple ones appear here,
'others occur as procedures below. 


Def Fn ADR$(A)="("+Ellong$(A)+"),"
Def Fn MUI_CHILD$(OBJ)="MUIA_Group_Child,"+ Fn ADR$(OBJ)
Def Fn MUI_WIN_CONTENT$(OBJ)="MUIA_Window_RootObject,"+ Fn ADR$(OBJ)
Def Fn MUI_APP_WINDOW$(OBJ)="MUIA_Application_Window,"+ Fn ADR$(OBJ)


'****************************************************************************
'Insert initialisation of your programs arrays & variables here. 


'****************************************************************************
'This part of the program creates the MUI Application interface. 
'=============================================================== 

'Unlike most languages where you can create the application in one massive 
'function call, in AMOS, you have to do it object by object from the bottom
'up - I.E. Before creating an object, you must have first created all of its 
'children. (Children = Sub Objects / Other Objects which it contains a pointer 
'to) 

'NOTE: To ensure correct deallocation of memory, you should create each
'      object, and totally ignore the return value. When you create an object  
'      if you set any of its children to 0 in the taglist, that object 
'      fails, and in doing so, disposes of any of its non-NULL children. When  
'      you create the application object, look at APP_OBJ. If it is 0, one of
'      your objects failed to create, but everything else has been deallocated 
'      from memory. Do not stop as soon as you find a NULL return value. 

'NOTE: Always call you application object APP_OBJ for consistancy. 


'AMOS Taglist Format 
'=================== 
'
'What is a taglist?
'------------------
'
'A Taglist is an set of consecutive pairs of longwords of memory, terminated 
'by a NULL longword e.g. 
'  
'   Ellong$(TAG1)+Ellong$(DATA1)+elong$(TAG2)+elong$(DATA2)+elong$(0)  
'
'The first longword of each pair is called the 'Tag' and is usually a
'constant value from an include/header file (An equate in AMOS), which 
'describes the attribute you wish to set. The 'Data' longword is the 
'value you wish to set that attribute to. So if the AMOS Screen Open 
'command took a taglist, it might be something like: 
'
'Screen Open Ellong$(SCR_NUMBER)+Ellong$(0)
'           +Ellong$(SCR_WIDTH)+Ellong$(320) 
'           +Ellong$(SCR_HEIGHT)+Ellong$(200)
'           +Ellong$(SCR_MODE)+Ellong$(SCR_MODE_LOWRES)
'           +Ellong$(SCR_COLOURS)+Ellong$(16)
'           +Ellong$(0)
'
'The variables are the 'tag' constants. The tags are used so that the
'parameter can be given in any order, and some can be left out. Any that 
'are left out are given default values.
'
'
'How does MUI use taglists?
'==========================
'
'MUI uses taglists to describe the intial attributes of the object which 
'make up your interface, and to change these attributes. It also uses them 
'in the _DO_METHOD function, but breaks the rules slightly here, as the
'tags aren't in pairs, and order is important. 
'
'
'How do I make using taglists from AMOS Easier?
'==============================================
'
'The taglist should be placed in an AMOS string, with each item seperated
'by commas. Elements can be: 
'
'
' - Decimal Numbers
'
' - Hex Numbers
'
' - Symbolic Names (Equates) from the assembler MUI.I file 
'
' - Literal Strings, by placing them in single quotes. These strings 
'   as temporary, suitable for MUI_Text_Contents & Listview elements.
'   They are overwritten by the next taglist's strings.
'
' - Permanent Literal Strings, by begining the quotes with a backward single 
'    quotes (` = Alt-'). These strings as copied into the MUI Workspace bank.
'   E.g. "MUIA_Window_Title,`The Window'"
'
' - Longwords, by placing them in parenthesis (). These are longwords
'   generated from integers with the Ellong$() function. Use for object
'   addresses / values in AMOS integer variables, via the ADDR$ macro  
'
'
'Literal Strings may contain (This may change in new versions):
'
' \n = Newline 
' \a = ' 
' \b = ` 
' \q = " 
' \t = Tab 
' \e = Escape
' \\ = \ 
'
'See Mui Autodoc for for Text.mui for details of MUI text formatting strings 
'
'Pass these taglists to _COMPILE, and a relocatable form of the taglist
'will be returned in Param$. This string could be saved in a bank, or
'wherever to remove the need for compiling it every time the program is
'run.
'
'
'General Use Of Strings
'======================
'
'
' If a string is to be displayed as text by MUI (E.g. Listviews, Labels, 
' buttons, etc.) it is safe to make it a temporary string. If it is to 
' be displayed by intuiton (E.g. Window Titles), make it permanent.
'
' There is no need to append chr$(0) to the end of your strings - my 
' procedure do this when necessary.
'
' If you manual include a pointer to a string in a taglist, make sure
' that address will remain constant until the taglist is used, and if
' the string is not copied my MUI, and needs to be permanent, make sure
' the address does not change until the object is disposed of. This means
' do not use Varptr(...$) as the AMOS garbage collector may move it. 
'
'
'Passing taglists to my MUI procedures 
'===================================== 
'
'The _COMPILE procedure replaces the symbolic names & hex/decimal integers 
'with longwords, and moves the literal strings together at the end of the
'string. It stores offset information about the literal strings at the very
'end of the taglist. 
'
'When you pass a taglist to a procedure, the address of the strings is 
'computed, and inserted into the list, which is then passed to MUI. Also 
'permanent strings are stored in bank 17 
'
'You may also pass any function which expects a taglist a real raw taglist 
'string (Array of longwords), on the condition that it does not end with 
'the longword $80000000, as this is how compiled taglist are identified. 
'If your raw taglist does end in $80000000, just add an Ellong$(0) to the
'end - this should not cause any problems. 




'****************************************************************************
'Creation of the demo application. 

'******* Creation of sounds window 
'
'Create the sound / close button objects 
'
_MUIB_KEYBUTTON["Quit","q"] : BUT_QUIT_OBJ=Param
_MUIB_KEYBUTTON["Bell","b"] : BUT_BELL_OBJ=Param
_MUIB_KEYBUTTON["Gun","g"] : BUT_SHOOT_OBJ=Param
_MUIB_KEYBUTTON["Explosion","e"] : BUT_BOOM_OBJ=Param

'Create the horizontal group for the buttons 
'
_MUIB_GROUP[Ellong$(BUT_BELL_OBJ)+Ellong$(BUT_SHOOT_OBJ)+Ellong$(BUT_BOOM_OBJ)+Ellong$(BUT_QUIT_OBJ),1,0]
GRP2_OBJ=Param

'Create the title label boxes
'
_MUIB_TITLE_LABEL["Some MUI Gadgets"] : LAB_GAD_OBJ=Param
_MUIB_TITLE_LABEL["AMOS Sound Effects"] : LAB_SOUND_OBJ=Param


'Create the string gadget
'
_MUIB_FILESTRING["File:","f","Filename","Select Filename"] : FILE_OBJ=Param


'Create the popinglist-string gadget 
'
_MUIB_LISTVIEW["Excellent|Super|Advanced|Default|Average|Crap|Useless|IBM"] : PLIST_OBJ=Param
_MUIB_LISTSTRING["Default",32,"c","Class:",PLIST_OBJ] : PLS_OBJ=Param


'Create the cycle gadget 
'
_MUIB_CYCLE["This|Is|A|Cycle|Gadget"] : CYC_OBJ=Param


'Create the listview gadget
'
_MUIB_LISTVIEW["This|Is A|Simple|Listview|Gadget"] : LIST_OBJ=Param


'Create the bitmap from bob image. 
'
_MUIB_BITMAP_BOB[1,"MUIV_FrameGroup"] : BIT_OBJ=Param


'Create the checkmark object 
'
'
_MUIB_CHECKMARK["Checkmark","m",0] : CHK_OBJ=Param


'Put the bitmap, checkmark & cycle in a group. 
'
_MUIB_GROUP[Ellong$(CYC_OBJ)+Ellong$(CHK_OBJ),0,1]
GRP3_OBJ=Param

_MUIB_GROUP[Ellong$(BIT_OBJ)+Ellong$(GRP3_OBJ),1,0]
GRP4_OBJ=Param


'Create the windows main group 
'
_MUIB_GROUP[Ellong$(LAB_GAD_OBJ)+Ellong$(GRP4_OBJ)+Ellong$(LIST_OBJ)+Ellong$(FILE_OBJ)+Ellong$(PLS_OBJ)+Ellong$(LAB_SOUND_OBJ)+Ellong$(GRP2_OBJ),0,0]
GRP1_OBJ=Param
'


'Create the window object
'
WIN$="MUIA_Window_Title,`MUI-AMOS Test Window',"
'
'Uncomment to put window on AMOS Intuition screen if you have that extension 
'WIN$=WIN$+"MUIA_Window_Screen,"+ Fn ADR$( Iscreen Base )  
WIN$=WIN$+ Fn MUI_WIN_CONTENT$(GRP1_OBJ)+"TAG_DONE"
_COMPILE[WIN$]
_MUI_NEW_OBJECT["Window.mui",Param$] : WIN_OBJ=Param





'********** Create the application object
'
'NOTE: All windows are children of the application object, but do not appear 
'      until the window open attribute is set. 
'
'NOTE: The strings below appear in commodities exchange & CLI version command
'      and should always be set. 
'
APP$="MUIA_Application_Author,'Paul Hickman',"
APP$=APP$+"MUIA_Application_Base,'AMOS-MUI',"
APP$=APP$+"MUIA_Application_Title,'AMOS MUI Demo',"
APP$=APP$+"MUIA_Application_Version,'$VER: AMOS MUI Demo 1.0 (12.08.94)',"
APP$=APP$+"MUIA_Application_Copyright,'Paul Hickman 1994.',"
APP$=APP$+"MUIA_Application_Description,'Example on how to use MUI from AMOS',"
APP$=APP$+ Fn MUI_APP_WINDOW$(WIN_OBJ)+"TAG_DONE"
_COMPILE[APP$]
_MUI_NEW_OBJECT["Application.mui",Param$] : APP_OBJ=Param

If APP_OBJ=0
   'Insert your emergency abort code here 
   
   If _DEBUG=1
      Print "Application Tested OK."
   Else 
      Print "Failed to create application."
   End If 
   _MUI_CLOSE
   End 
Else 
   Print "Application Created."
End If 

'****************************************************************************
'This part of the program initialises the methods. These are strings that
'say "Whenever this happens to object A, make this happen to object B", or 
'"Whenever this happens to object A, call the _USER_RETURNID procedure with
'this parameter. 
'
'
'NOTE: These methods can be initialised anytime after the objects they 
'      concern are created. Only those concerning APP_OBJ must wait until  
'      now. It is in fact better to put them before the APP_OBJ creation 
'      if possible so you can test them with _DEBUG=1. 
'
'
'Setup the window close button to quit the program 
'
'Parameters of taglist are:  
'
'MUIM_Notify - Says this is a notification method. Always 1st. 
'MUIA_Window_CloseRequest  -  Attribute of object to watch for changes.
'1 - Value to what for MUIA_Window_CloseRequest to change 1 (1=True in MUI)
'APP_OBJ - Object to send message to when MUIA_Window_Close request becomes 1
'2 - Number of parameters in the message 
'
'Then the message that is send to APP_OBJ: 
'
'MUIM_Application_ReturnID - This is a return value to AMOS Method 
'MUIV_Application_ReturnID_Quit - The ID code number to return is quit (-1)
'
'MUIV_Application_ReturnID_Quit is a special paramter, which instead of
'being passed to _USER_RETURN_ID like every other value causes the mainloop
'to exit, which means the application is quit. 
'
_COMPILE["MUIM_Notify,MUIA_Window_CloseRequest,1,"+ Fn ADR$(APP_OBJ)+"2,MUIM_Application_ReturnID,MUIV_Application_ReturnID_Quit"]
'
'The taglist above is sent to WIN_OBJ, as it is this objects close button
'we wish to monitor. 
'
_MUI_DO_METHOD[WIN_OBJ,Param$]


'Setup the quit button to also quit the program

'The general format for these notifies is: 
'
'MUIM_Notify, ATTRIBUTE, VALUE, SENDTO, NOPARAMS.  
'
'I.E. Whenever the ATTRIBUTE specified of the object passed in _MUI_DO_METHODA 
'     changes to the VALUE specified , send the message in the rest of the list
'     to the object in the SENDTO argument. NOPARAMS is the number of
'     parameters in the rest of the list (The message).
'
'
'
_COMPILE["MUIM_Notify,MUIA_Pressed,0,"+ Fn ADR$(APP_OBJ)+"2,MUIM_Application_ReturnID,MUIV_Application_ReturnID_Quit"]
_MUI_DO_METHOD[BUT_QUIT_OBJ,Param$]

'
'Setup the 3 sound buttons to return values to _USER_RETURN_ID 
'

_COMPILE["MUIM_Notify,MUIA_Pressed,0,"+ Fn ADR$(APP_OBJ)+"2,MUIM_Application_ReturnID,1"]
_MUI_DO_METHOD[BUT_BELL_OBJ,Param$]
_COMPILE["MUIM_Notify,MUIA_Pressed,0,"+ Fn ADR$(APP_OBJ)+"2,MUIM_Application_ReturnID,2"]
_MUI_DO_METHOD[BUT_SHOOT_OBJ,Param$]
_COMPILE["MUIM_Notify,MUIA_Pressed,0,"+ Fn ADR$(APP_OBJ)+"2,MUIM_Application_ReturnID,3"]
_MUI_DO_METHOD[BUT_BOOM_OBJ,Param$]

'
'Setup return in the string gadget to return 4 to _USED_RETURN_ID
'
'NOTE: Use of MUIV_EveryTime for the value.
'
_COMPILE["MUIM_Notify,MUIA_String_Acknowledge,MUIV_EveryTime,"+ Fn ADR$(APP_OBJ)+"2,MUIM_Application_ReturnID,4"]
_MUI_DO_METHOD[FILE_OBJ,Param$]

'Now setup the order of tab-cycling for that gadgets 
_COMPILE["MUIM_Window_SetCycleChain,"+ Fn ADR$(CYC_OBJ)+ Fn ADR$(CHK_OBJ)+ Fn ADR$(LIST_OBJ)+ Fn ADR$(FILE_OBJ)+ Fn ADR$(BUT_BELL_OBJ)+ Fn ADR$(BUT_SHOOT_OBJ)+ Fn ADR$(BUT_BOOM_OBJ)+ Fn ADR$(BUT_QUIT_OBJ)+"0"]
_MUI_DO_METHOD[WIN_OBJ,Param$]


'****************************************************************************
'This is the main part of the almost any MUI Program.  

Fill Start(18) To Start(18)+Length(18),0 : Rem ensure all temporary strings are erased so you can see mistakes! 

'Open the window 
'
_MUI_SET_ATTRS[WIN_OBJ,"MUIA_Window_Open",1]


'Wait for user to quit. NOTE: Amiga-A is disabled because we are waiting 
'on signals alot of the time - I.E. The AMOS process is suspended, and if
'the MUI screen is not accessable, the signals may never be sent, as they may
'come from user inputs, so you machine hangs!. 


Bell 
Print "Press A Key To Begin..."
Wait Key 
Amos Lock 
Amos To Back 
_MUI_MAIN_LOOP[APP_OBJ]
Amos To Front 
Amos Unlock 



'Close the application. This gets rid off all objects, as long as they 
'are children of the APP_OBJ. If they are other objects in existance,
'dispose of them here also.  
'

'NOTE: You APP_OBJ must be called APP_OBJ as it is a shared variable 

_MUI_CLOSE

'****************************************************************************
'Insert your programs termination tidy-up code here. 
'
'
'for Intuiton extension users only...
'Iscreen Close 0 
End 



'****************************************************************************
'** Below is the MUI interface procedures. Open each to see what its for.  **
'** These procedures do not require changing for other programs, except for**
'** _USER_RETURN_ID which needs re-coding each time.                       **
'****************************************************************************
'
'Taglist generator procedures
'
Procedure _COMPILE[A$]
Procedure _MATCH[TAG$]
Procedure _STORE[S$]

'Private procedures
'
Procedure _GET_STRING[A$,A]
Procedure _FORMAT[EL$]
Procedure _INSTALL[TAG$]

'MUI Control Procedures
'    
Procedure _MUI_NEW_OBJECT[NAME$,TAG_LIST$]
Procedure _MUI_DISPOSE_OBJECT[OBJ]
Procedure _MUI_SET_ATTRS[OBJ,TAG$,V]
Procedure _MUI_GET_ATTR[OBJ,TAG$]
Procedure _MUI_GET_STRING_ATTR[OBJ,TAG$]

Procedure _MUI_DO_METHOD[OBJ,TAG_LIST$]
Procedure _MUI_MAIN_LOOP[APP_OBJ]
Procedure _MUI_REQUEST[APP_OBJ,WIN_OBJ,TITLE$,TEX$,BUT$]

Procedure _MUI_INIT[WORKSPACE,TEMPSPACE]
Procedure _MUI_CLOSE
Procedure _MUI_INSTALL_HOOK[ADR,D]


'MUI Builtin Object Creators / Macro creation procedures 
'======================================================= 

'Buttons 
'
Procedure _MUIB_BUTTON[LABEL$]
Procedure _MUIB_KEYBUTTON[LABEL$,HOTKEY$]
Procedure _MUIB_POPBUTTON[IMAGE]
Procedure _MUIB_CHECKMARK[LABEL$,HOTKEY$,SELECTED]

'Labels
'
Procedure _MUIB_LABEL[LABEL$]
Procedure _MUIB_TITLE_LABEL[LABEL$]
Procedure _MUIB_LABELOBJ[LABEL$,HOTKEY$,OBJ,RIGHT]

'Strings 
'
Procedure _MUIB_KEYSTRING[S$,MXLEN,HOTKEY$]
Procedure _MUIB_LABSTRING[S$,MXLEN,HOTKEY$,LABEL$]
Procedure _MUIB_FILESTRING[LABEL$,HOTKEY$,INIT_FILE$,TITLE$]
Procedure _MUIB_LISTSTRING[S$,MXLEN,HOTKEY$,LABEL$,LOBJ]

'Others
'
Procedure _MUIB_CYCLE[LIST$]
Procedure _MUIB_LISTVIEW[LIST$]
Procedure _MUIB_BITMAP_BOB[_BOB,FRAME$]

'Groups

Procedure _MUIB_SIZEABLE[OBJ,HORIZ]
Procedure _MUIB_GROUP[OBJ$,HORIZ,FRAME]

'****************************************************************************
'These procedures require modification.  
'
Procedure _IS_ASL_OPEN
Procedure _USER_RETURN_ID[ID]

'
'
'****************************************************************************
'The future
'==========
'
'
'This file was thrown together over 3 days, and is only the second program 
'I have tried to write using MUI, and as such it is more an exploration of 
'MUI's features on my part, than anything else.
'
'
'
'
'The allocation/deallocation of memory is not very advanced - I just store 
'anything that needs keeping in a work bank, and forget about it. My eventual
'aim is to create Easylife commands/functions to aid MUI use:
'
' = Elmui New Object(TYPE$,TAG_LIST$)  
'
'Which will take an AMOS taglist (I.E. As specified in the source), _COMPILE 
'it, and _INSTALL it then create the object. But rather than putting the 
'permanent strings in an AMOS work bank, this function would allocate some 
'memory for permanent tag data, and store a pointer to it in MUIA_User_Data
'of the allocated object. The initial 2 longwords of this memory area would
'be left empty for the following:
'
'1st Longword. For Applications own use. (To replace _MUIA_User_Data)
'2nd Longword. Pointer to additional memory areas belonging to this object.
'
'
' = Elmui Dispose Object(OBJ)
'
'Which will dispose of the object, and of the MUI data areas pointed to
'by its _MUIA_User_Data field. 
'
'
' = Elmui Get Attrs(OBJ,TAG$)
'
'Which will return the objects attribute specified in TAG$ 
'
'  
' = Elmui Set Attrs(OBJ,TAG$,VALUE)
'
'Which will set the attribute, then return the values it was actually
'set to, so you tell if you succeeded (E.g. MUIA_Window_Open may fail) 
'
'
' = Elmui Do Method(OBJ,TAG_LIST$) 
'
'Which will do the method, but store any permanent data in the taglist 
'in the memory allocated to ,and pointer to in a chain from longword #2
'of the memory area in _MUIA_User_Data, so that disposing of the object
'will also dispose of the data from the taglist. 
'
'
'
'Each of the above funcitions would also have an equivilent which accepts
'a true taglist. 
'
' = Elmui Store(OBJ,ADDR,LENGTH) 
'
'Which will store a COPY of the memory area in the chain of additonal
'memory allocated to the object, for automatic disposal when the object
'is killed.
'
'
'I would also like the taglist parser to know which tags require permanent 
'storage of their data, and which don't, and automatically allocated it
'if the data is passed as a literal string in the taglist. This could be 
'done quite easily by storing a boolean in BANK 13 with each tag. The only 
'problem is knowing which tags need permanent storage. Any help in compiling 
'a list would be greatly appreciated. (Just E-Mail me tagnames, and YES/NO)  
'
'
'Something I an in the process of doing now, is to allow AMOS Procedures 
'to be hook functions, so you don't have to write them in assembler, 
'(although it is worth doing so if you can, as they are much faster) 
'
'
'If you would like to help develop an AMOS interface to MUI I would like the 
'following:
'
'
' - Any of the above function calls coded in assembler :-) 
'
' - More assembler hook routines in banks for various purposes 
'   (Preferably with source).
'
' - More MUIB object building procedures.
'
' - Any useful MUI External classes you may happen to have.
'
' - Example applications.
'
' - Suggestions for other MUI Easylife Functions  /  AMOS Procedures.
'   (Or non-MUI easylife functions for that matter)
'
' - Bug reports. 
'
'
'
'
'Known Bugs
'==========
'
'When you manually type an entry into a LISTSTRING (Such as Check: in the
'demo), then popup the list, the list is searched for the string and the 
'intial active/highlighted entry is set to it if it is found, otherwise
'there is no highlighted entry.  The hook function finds the entry in the
'list OK, but when it sets the lists the _MUIA_List_Active attribute, nothing
'happens - the highlight doesn't move. A Prize for anyone who can find out 
'why (See source Listview-Hooks.s) 
'

