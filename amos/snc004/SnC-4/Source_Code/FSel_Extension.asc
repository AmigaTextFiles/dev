' ---------------------------------------------------------------------------  
'                               FSel Extension       
'                               ~~~~~~~~~~~~~~ 
'               © Copyright 1994, Phantom Software Productions   
'                           Programming by Greg Cox      
' ---------------------------------------------------------------------------  
' Example: 
' ~~~~~~~~ 
Screen Open 0,640,256,2,Hires
Curs Off : Cls 0
F$=Fsel$("*.*","","FSel Extension Demo","Select a File")
If F$="" Then Edit 
FSEL_DEVICE[F$]
Print "You have selected:"
Print : Print "DEVICE   = ";Param$
FSEL_FILENAME[F$]
Print "FILENAME = ";Param$
FSEL_DRAWER[F$]
Print "LOCATION = ";Param$
FSEL_FILESIZE[F$]
Print "BYTES    = ";Param$
Print : Print "< Press Any Key >"
Wait Key 
Screen Close 0
Edit 
' ---------------------------------------------------------------------------  
Procedure FSEL_DEVICE[F$]
   Shared DEVICE$
   M=Instr(F$,":")
   DEVICE$=Left$(F$,M)
End Proc[DEVICE$]
Procedure FSEL_FILENAME[F$]
   Shared FILENAME$
   M=Instr(F$,":")
   FILENAME$=Mid$(F$,M+1)
   M=Instr(FILENAME$,"/")
   If M=0 Then Goto _END
   _NEXT:
   M1$=Mid$(FILENAME$,M+1)
   M=Instr(M1$,"/")
   If M=0 Then FILENAME$=M1$ : Goto _END
   FILENAME$=M1$
   Goto _NEXT
   _END:
End Proc[FILENAME$]
Procedure FSEL_FILESIZE[F$]
   Open In 1,F$
   B=Lof(1)
   Close 1
   B$=Str$(B)
   L=Instr(B$," ")
   L1$=Mid$(B$,L+1)
End Proc[L1$]
Procedure FSEL_DRAWER[F$]
   Shared FILENAME$,DEVICE$
   M=Instr(F$,":")
   M$=Mid$(F$,M+1)
   M=Instr(M$,"/")
   If M=0 Then M1$=DEVICE$ : Goto _END
   M1$=DEVICE$+Left$(M$,Len(M$)-Len(FILENAME$))
   _END:
End Proc[M1$]
