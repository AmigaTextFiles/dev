' AMOS PROFESSIONAL RAINBOW BULIDER Version 1.0
' Designed & Written by Marcin 'Maginus' Dlugosz 
' email: maginus@poczta.onet.pl    
' This program is Public Domain

VER$="1.0"
BY$="Maginus"
_SCREENOPEN[320,200,Lowres]
RA=1
RB=1
RC=1
GA=1
GB=0
GC=0
BA=1
BB=0
BC=0
DL=250
BAZA=0
YE=0
WYS=250
Do 
Set Rainbow 1,2,DL,"("+Str$(RA)+","+Str$(RB)+","+Str$(RC)+")","("+Str$(GA)+","+Str$(GB)+","+Str$(GC)+")","("+Str$(BA)+","+Str$(BB)+","+Str$(BC)+")"
Rainbow 1,BAZA,YE,WYS
Ink 1,0
Text 10,10,"Rainbow Bulider v"+VER$+" by "+BY$
Text 10,70,"press [p] for HELP"
Text 10,20,Str$(RA)+" "
Text 10,30,Str$(RB)+" "
Text 10,40,Str$(RC)+" "
Text 55,20,Str$(GA)+" "
Text 55,30,Str$(GB)+" "
Text 55,40,Str$(GC)+" "
Text 95,20,Str$(BA)+" "
Text 95,30,Str$(BB)+" "
Text 95,40,Str$(BC)+" "
Text 10,50,"lenght:"+Str$(DL)+"   "
Text 10,60,"base: "+Str$(BAZA)+"   "
Text 155,50,"y: "+Str$(YE)+"   "
Text 155,60,"height: "+Str$(WYS)+"   "
I$=Inkey$
SC=Scancode
If I$="z" and DL>16 : DL=DL-1 : End If 
If I$="x" and DL<32000 : DL=DL+1 : End If 
If I$="c" : BAZA=BAZA-1 : End If 
If I$="v" : BAZA=BAZA+1 : End If 
If I$="b" : YE=YE-1 : End If 
If I$="n" : YE=YE+1 : End If 
If I$="m" : WYS=WYS-1 : End If 
If I$="," : WYS=WYS+1 : End If 
If I$="q" : RA=RA+1 : End If 
If I$="a" and RA>1 : RA=RA-1 : End If 
If I$="w" : RB=RB+1 : End If 
If I$="s" : RB=RB-1 : End If 
If I$="e" : RC=RC+1 : End If 
If I$="d" and RC>0 : RC=RC-1 : End If 
If I$="r" : GA=GA+1 : End If 
If I$="f" and GA>1 : GA=GA-1 : End If 
If I$="t" : GB=GB+1 : End If 
If I$="g" : GB=GB-1 : End If 
If I$="y" : GC=GC+1 : End If 
If I$="h" and GC>0 : GC=GC-1 : End If 
If I$="u" : BA=BA+1 : End If 
If I$="j" and BA>1 : BA=BA-1 : End If 
If I$="i" : BB=BB+1 : End If 
If I$="k" : BB=BB-1 : End If 
If I$="o" : BC=BC+1 : End If 
If I$="l" and BC>0 : BC=BC-1 : End If 
If I$="p"
Screen Open 1,640,170,2,Hires
Palette $0,$FFF : Curs Off 
Print " press [key] for action:"
Print ""
Print " [q],[a],[w],[s],[e],[d] - red control"
Print " [r],[f],[t],[g],[y],[h] - green control"
Print " [u],[j],[i],[k],[o],[l] - blue control"
Print " [z],[x] - lenght control"
Print " [c],[v] - base control"
Print " [b],[n] - y control"
Print " [m],[,] - height control"
Print " [p] - this help"
Print " [F1] - reset all rainbow data"
Print " [F2] - reset RGB rainbow data"
Print " [F3] - reset lenght,base,y and height data"
Print " [F4] - show source code of rainbow"
Print " [F5] - save source code of rainbow (as ASCII)"
Print " [F6] - change screen resolution"
Print " [Esc] - exit"
Print ""
Print " This program is freeware. All rights reserved."
Print " Press any key to return to main program."
Wait Key 
Screen Close 1
End If 
If SC=69
End 
End If 
If SC=80
RA=1
RB=1
RC=1
GA=1
GB=0
GC=0
BA=1
BB=0
BC=0
DL=250
BAZA=0
YE=0
WYS=250
End If 
If SC=81
RA=1
RB=1
RC=1
GA=1
GB=0
GC=0
BA=1
BB=0
BC=0
End If 
If SC=82
DL=250
BAZA=0
YE=0
WYS=250
End If 
If SC=83
Screen Open 1,640,60,2,Hires
Curs Off : Palette $0,$FFF
S$=Chr$(34)
W$="Set Rainbow 1,1,"+Str$(DL)+","+S$+"("+Str$(RA)+","+Str$(RB)+","+Str$(RC)+")"+S$+","+S$+"("+Str$(GA)+","+Str$(GB)+","+Str$(GC)+")"+S$+","+S$+"("+Str$(BA)+","+Str$(BB)+","+Str$(BC)+")"+S$
W1$="Rainbow 1,"+Str$(BAZA)+","+Str$(YE)+","+Str$(WYS)
Print " AMOS source code of this rainbow:"
Print ""
Print W$
Print W1$
Print 
Print " Press any key to return to main program."
Wait Key 
Screen Close 1
End If 
If SC=84
S$=Chr$(34)
W$="Set Rainbow 1,1,"+Str$(DL)+","+S$+"("+Str$(RA)+","+Str$(RB)+","+Str$(RC)+")"+S$+","+S$+"("+Str$(GA)+","+Str$(GB)+","+Str$(GC)+")"+S$+","+S$+"("+Str$(BA)+","+Str$(BB)+","+Str$(BC)+")"+S$
W1$="Rainbow 1,"+Str$(BAZA)+","+Str$(YE)+","+Str$(WYS)
F$=Fsel$("*.Asc","","Save source code of rainbow","as ASCII")
If F$<>""
Open Out 1,F$
Print #1,W$
Print #1,W1$
Close 1
End If 
End If 
If SC=85
Screen Open 1,640,80,2,Hires
Curs Off : Palette $0,$FFF
Print " Press a [key] to select new resolution:"
Print ""
Print " [1] No change"
Print " [2] 320x200 Lowres"
Print " [3] 320x256 Lowres"
Print " [4] 640x200 Hires"
Print " [5] 640x256 Hires"
Print " [6] 320x512 Lowres+Laced"
Print " [7] 640x512 Hires+Laced"
I$=""
Repeat 
I$=Inkey$
Until I$="1" or I$="2" or I$="3" or I$="4" or I$="5" or I$="6" or I$="7"
Screen Close 1
If I$="1" : End If 
If I$="2" : _SCREENOPEN[320,200,Lowres] : End If 
If I$="3" : _SCREENOPEN[320,256,Lowres] : End If 
If I$="4" : _SCREENOPEN[640,200,Hires] : End If 
If I$="5" : _SCREENOPEN[640,256,Hires] : End If 
If I$="6" : _SCREENOPEN[320,512,Lowres+Laced] : End If 
If I$="7" : _SCREENOPEN[640,512,Hires+Laced] : End If 
End If 
Loop 
Procedure _SCREENOPEN[X,Y,ROZ]
Screen Open 0,X,Y,4,ROZ
Flash Off : Palette $0,$FFF,$678,$AAA : Cls 2
Ink 1 : Box 0,0 To Screen Width-1,Screen Height-1
End Proc
