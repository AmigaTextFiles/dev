@database "eSource"
@master "Ram Disk:T/docs/eSource.doc"

@Node Main "eSource.doc"
    @{" --background-- " Link "--background--"}
    @{" --eSource--() " Link "--eSource--()"}
    @{" buildPrivateObjectList() " Link "buildPrivateObjectList()"}
    @{" buildPrivateProcList() " Link "buildPrivateProcList()"}
    @{" buildPublicObjectList() " Link "buildPublicObjectList()"}
    @{" buildPublicProcList() " Link "buildPublicProcList()"}
    @{" findPrivateObject() " Link "findPrivateObject()"}
    @{" findPrivateProc() " Link "findPrivateProc()"}
    @{" findPublicObject() " Link "findPublicObject()"}
    @{" findPublicProc() " Link "findPublicProc()"}
    @{" freeMainLists() " Link "freeMainLists()"}
    @{" getInfo() " Link "getInfo()"}
    @{" getModules() " Link "getModules()"}
    @{" getSettings() " Link "getSettings()"}
    @{" needsModule() " Link "needsModule()"}
    @{" workOnObject() " Link "workOnObject()"}
    @{" workOnProc() " Link "workOnProc()"}
@EndNode

@Node "--background--" "eSource/--background--"

@{b}   PURPOSE@{ub}
         This object gives you the means the deal with sources of the E
         language.

@{b}   CREATION@{ub}
       September 26 1995 Gregor Goldbach

@{b}   HISTORY@{ub}
       October 11 1995 Gregor Goldbach
         Added getMethods(). Builds @{"elist" Link "elist/elist()"} of module name strings.
         Added @{"end()" Link "string/end()"}.

@{b}   NOTES@{ub}
       There are two groups of procs in this module. The first runs over the
       whole file and tries to find out everything about objects, proc,
       variables and their relationship. This group is called by @{"getInfo()" Link "getInfo()"}.

       The second group does not need the information provided by the procs
       of the first group. They search for more general aspectes of the
       source, e.g. the settings and the modules needed. These are the procs
       this group consists of:
           @{"getModules()" Link "getModules()"}
           @{"needsModule()" Link "needsModule()"}
           testSetting()

       Note that @{"getModules()" Link "getModules()"} has to be called before using @{"needsModule()" Link "needsModule()"}.

       To get all methods working on a source call @{"getInfo()" Link "getInfo()"} and
       @{"getModules()" Link "getModules()"} after sucking the file. To free the memory that was
       allocated by these methods call @{"freeContents()" Link "file/freeContents()"}, @{"freeMainLists()" Link "freeMainLists()"} and
       freeListModulesNeeded().

@EndNode

@Node "--eSource--()" "eSource/--eSource--"

@{b}   NAME@{ub}
       eSource

@{b}   ATTRIBUTES@{ub}
       privateObjectList:PTR TO LONG -- @{"elist" Link "elist/elist()"} of eSourceBlocks that
           represent private objects.

       publicObjectList:PTR TO LONG -- @{"elist" Link "elist/elist()"} of eSourceBlocks that
           represent public objects.

       privateProcList:PTR TO LONG -- @{"elist" Link "elist/elist()"} of eSourceBlocks that
           represent private procs.

       publicProcList:PTR TO LONG -- @{"elist" Link "elist/elist()"} of eSourceBlocks that
           represent public procs.

       privateVarList:PTR TO LONG -- @{"elist" Link "elist/elist()"} of eSourceBlocks that
           represent private variables.

       publicVarList:PTR TO LONG -- @{"elist" Link "elist/elist()"} of eSourceBlocks that
           represent public variables.

       modulesNeeded:PTR TO LONG -- @{"elist" Link "elist/elist()"} of Strings that represent a
           module name. These modules are needed to run this source.

@{b}   NOTES@{ub}
       Compilation and interpretation are not available

@EndNode

@Node "buildPrivateObjectList()" "eSource/buildPrivateObjectList"

@{b}   NAME@{ub}
       buildPrivateObjectList() -- Build list of private objects.

@{b}   SYNOPSIS@{ub}
       eSource.buildPrivateObjectList(fromLine=0)

@{b}   FUNCTION@{ub}
       Builds an @{"elist" Link "elist/elist()"} of eSourceBlocks that define private objects.

@{b}   INPUTS@{ub}
       fromLine=0 -- Where the search should start.

@{b}   RESULT@{ub}
       @{"elist" Link "elist/elist()"} of eSourceBlocks or NIL.

@{b}   NOTES@{ub}
       Does not know if somebody wrote OPT EXPORT at the start of the
       source. This may change.

@EndNode

@Node "buildPrivateProcList()" "eSource/buildPrivateProcList"

@{b}   NAME@{ub}
       buildPrivateProcList() -- Build list of private procs.

@{b}   SYNOPSIS@{ub}
       eSource.buildPrivateProcList(fromLine=0)

@{b}   FUNCTION@{ub}
       Builds an @{"elist" Link "elist/elist()"} of eSourceBlocks that define private procs.

@{b}   INPUTS@{ub}
       fromLine=0 -- Where the search should start.

@{b}   RESULT@{ub}
       @{"elist" Link "elist/elist()"} of eSourceBlocks or NIL.

@{b}   NOTES@{ub}
       Does not know if somebody wrote OPT EXPORT at the start of the
       source. This may change.

@EndNode

@Node "buildPublicObjectList()" "eSource/buildPublicObjectList"

@{b}   NAME@{ub}
       buildPublicObjectList() -- Build list of public objects.

@{b}   SYNOPSIS@{ub}
       eSource.buildPublicObjectList(fromLine=0)

@{b}   FUNCTION@{ub}
       Builds an @{"elist" Link "elist/elist()"} of eSourceBlocks that define public objects.

@{b}   INPUTS@{ub}
       fromLine=0 -- Where the search should start.

@{b}   RESULT@{ub}
       @{"elist" Link "elist/elist()"} of eSourceBlocks or NIL.

@EndNode

@Node "buildPublicProcList()" "eSource/buildPublicProcList"

@{b}   NAME@{ub}
       buildPublicProcList() -- Build list of public procs.

@{b}   SYNOPSIS@{ub}
       eSource.buildPublicProcList(fromLine=0)

@{b}   FUNCTION@{ub}
       Builds an @{"elist" Link "elist/elist()"} of eSourceBlocks that define public procs.

@{b}   INPUTS@{ub}
       fromLine=0 -- Where the search should start.

@{b}   RESULT@{ub}
       @{"elist" Link "elist/elist()"} of eSourceBlocks or NIL.

@EndNode

@Node "findPrivateObject()" "eSource/findPrivateObject"

@{b}   NAME@{ub}
       findPrivateObject() -- Get next private object definition.

@{b}   SYNOPSIS@{ub}
       eSource.findPrivateObject(fromLine=0)

@{b}   FUNCTION@{ub}
       Gets starting and ending line number of the next private object.

@{b}   INPUTS@{ub}
       fromLine=0 -- In which line the search should start

@{b}   RESULT@{ub}
       startLine, endLine -- Number of the lines the object starts and
           ends.

@{b}   NOTES@{ub}
       Does not know if somebody wrote OPT EXPORT at the start of the
       source. This may change.

@{b}   SEE ALSO@{ub}
       @{"buildPrivateObjectList()" Link "buildPrivateObjectList()"}

@EndNode

@Node "findPrivateProc()" "eSource/findPrivateProc"

@{b}   NAME@{ub}
       findPrivateProc() -- Get next private proc definition.

@{b}   SYNOPSIS@{ub}
       eSource.findPrivateProc(fromLine=0)

@{b}   FUNCTION@{ub}
       Gets starting and ending line number of the next private procedure.

@{b}   INPUTS@{ub}
       fromLine=0 -- In which line the search should start

@{b}   RESULT@{ub}
       startLine, endLine -- Number of the lines the procstarts and ends.

@{b}   NOTES@{ub}
       Does not know if somebody wrote OPT EXPORT at the start of the
       source. This may change.

@{b}   KNOWN BUGS@{ub}
       Does not find the single-line procs. Easy to fix.

@{b}   SEE ALSO@{ub}
       @{"buildPrivateProcList()" Link "buildPrivateProcList()"}

@EndNode

@Node "findPublicObject()" "eSource/findPublicObject"

@{b}   NAME@{ub}
       findPublicObject() -- Get next public object definition.

@{b}   SYNOPSIS@{ub}
       eSource.findPublicObject(fromLine=0)

@{b}   FUNCTION@{ub}
       Gets starting and ending line number of the next public object.

@{b}   INPUTS@{ub}
       fromLine=0 -- In which line the search should start

@{b}   RESULT@{ub}
       startLine, endLine -- Number of the lines the object starts and
           ends.

@{b}   SEE ALSO@{ub}
       @{"buildPublicObjectList()" Link "buildPublicObjectList()"}

@EndNode

@Node "findPublicProc()" "eSource/findPublicProc"

@{b}   NAME@{ub}
       findPublicProc() -- Get next public proc definition.

@{b}   SYNOPSIS@{ub}
       eSource.findPublicProc(fromLine=0)

@{b}   FUNCTION@{ub}
       Gets starting and ending line number of the next public procedure.

@{b}   INPUTS@{ub}
       fromLine=0 -- In which line the search should start

@{b}   RESULT@{ub}
       startLine, endLine -- Number of the lines the proc starts and ends.

@{b}   SEE ALSO@{ub}
       @{"buildPublicProcList()" Link "buildPublicProcList()"}

@EndNode

@Node "freeMainLists()" "eSource/freeMainLists"

@{b}   NAME@{ub}
       freeMainLists() -- Destructor for the @{"main" Link "master/main()"} lists.

@{b}   SYNOPSIS@{ub}
       eSource.freeMainLists()

@{b}   FUNCTION@{ub}
       Frees allocated resources this object uses. This can be quite
       an amount of bytes for the strings used. Every list is disposed.

@{b}   SEE ALSO@{ub}
       freeListModulesNeeded()
@EndNode

@Node "getInfo()" "eSource/getInfo"

@{b}   NAME@{ub}
       getInfo() -- build @{"main" Link "master/main()"} lists of eSource object.

@{b}   SYNOPSIS@{ub}
       eSource.getInfo()

@{b}   FUNCTION@{ub}
       Builds the @{"main" Link "master/main()"} lists of the object. The procs and the objects
       are listed.

@{b}   SEE ALSO@{ub}
        @{"buildPrivateProcList()" Link "buildPrivateProcList()"} ,@{"buildPublicProcList()" Link "buildPublicProcList()"},
        @{"buildPrivateObjectList()" Link "buildPrivateObjectList()"}, @{"buildPublicObjectList()" Link "buildPublicObjectList()"}

@EndNode

@Node "getModules()" "eSource/getModules"

@{b}   NAME@{ub}
       getModules() -- Determine what modules are included in this source.

@{b}   SYNOPSIS@{ub}
       eSource.getModules()

@{b}   FUNCTION@{ub}
       Determines what modules are needed to @{"interpret/compile" Link "programSource/compile()"} this source.
       This is done by checking what strings are behind the MODULE keyword.

@{b}   NOTES@{ub}
       Needs none of the internal lists. It searches directly for the module
       keyword.
@EndNode

@Node "getSettings()" "eSource/getSettings"

@{b}   NAME@{ub}
       testSetting() -- Determine if a specific setting is done for this
           source.

@{b}   SYNOPSIS@{ub}
       BOOL eSource.testSetting(PTR TO CHAR)

@{b}   FUNCTION@{ub}
       This function determines if a certain compiler setting is found
       after an OPT keyword. All ocurrences of OPT are used. However,
       the proc returns immediately after the setting was found.

@{b}   INPUTS@{ub}
       string:PTR TO CHAR -- The setting to look for. Refer to the
           reference for all available settings, some of them are:
               EXPORT, MODULE, ASM, DIR, STACK, LARGE

@{b}   NOTES@{ub}
       Needs none of the internal lists. It searches directly for the OPP
       keyword.
@EndNode

@Node "needsModule()" "eSource/needsModule"

@{b}   NAME@{ub}
       needsModule() -- Test if the source needs a specific module to run.

@{b}   SYNOPSIS@{ub}
       BOOL eSource.needsModule(PTR TO CHAR)

@{b}   FUNCTION@{ub}
       Tests if the module specified by the name is needed by the source
       to be run.

@{b}   INPUTS@{ub}
       name:PTR TO CHAR -- Name of the module. This name is searched for
           in the source's module list which may be NIL.

@{b}   RESULT@{ub}
       BOOL -- TRUE if a module of that name is needed, FALSE otherwise.

@{b}   NOTES@{ub}
       Doesn't care about the OPT DIR setting. EMODULES: is hard coded
       by now. This will change.

       Needs the list of modules needed to run the source. If not already
       present it calls @{"getModules()" Link "getModules()"}.

@EndNode

@Node "workOnObject()" "eSource/workOnObject"

@{b}   NAME@{ub}
       workOnObject()

@{b}   SYNOPSIS@{ub}
       eSource.workOnObject(sourceBlock:PTR TO sourceBlock)

@{b}   FUNCTION@{ub}
       Takes a Source Block and extracts the information of it to
       create an @{"eObject" Link "eObject/eObject()"}. The @{"eObject" Link "eObject/eObject()"} will have a valid entryList.

@{b}   INPUTS@{ub}
       sourceBlock:PTR TO sourceBlock -- Source Block that contains
           the location of an object definition in the source file.
           That information HAS to be valid, it is not tested.

@{b}   RESULT@{ub}
       Pointer to @{"eObject" Link "eObject/eObject()"} or to passed Source Block if an error
       occured.

@{b}   NOTES@{ub}
       To test if the procedure ran successfully over the Source Block
       thou may test the type entry, it is set to EOBJECT on success.

@{b}   SEE ALSO@{ub}
       sourceBlock

@EndNode

@Node "workOnProc()" "eSource/workOnProc"

@{b}   NAME@{ub}
       workOnProc()

@{b}   SYNOPSIS@{ub}
       eSource.workOnProc(sourceBlock:PTR TO sourceBlock)

@{b}   FUNCTION@{ub}
       Takes a Source Block and extracts the information of it to
       create an eProc.

@{b}   INPUTS@{ub}
       sourceBlock:PTR TO sourceBlock -- Source Block that contains
           the location of a procedure definition in the source file.
           That information HAS to be valid, it is not tested.

@{b}   RESULT@{ub}
       Pointer to eProc or to passed Source Block if an error
       occured.

@{b}   NOTES@{ub}
       To test if the procedure ran successfully over the Source Block
       thou may test the type entry, it is set to EPROC on success.

       The failure to detect single-lined procedures has been fixed.
       The difference between start and end line is 0. Therefore, any
       documentation of that proc is *not* included.

@{b}   SEE ALSO@{ub}
       sourceBlock

@EndNode

