SPIS TREÔCI

vmem.library/--ogólny opis--
vmem.library/vmAllocBlock
vmem.library/vmAllocData
vmem.library/vmAllocMem
vmem.library/vmFlush
vmem.library/vmFreeBlock
vmem.library/vmFreeData
vmem.library/vmFreeMem
vmem.library/vmLock
vmem.library/vmLockData
vmem.library/vmUnLock
vmem.library/vmUnLockData






vmem.library/--ogólny opis---                     vmem.library/--ogólny opis---


                       BIBLIOTEKA OBSÎUGUJÂCA ** PAMIËÊ WIRTUALNÂ **

                               ( WERSJA 1 )

                       COPYRIGHT (c) 1994 BY LEE BRAIDEN


       Oto dokumentacja dla programistów do vmem.library. VMem to prosta
   biblioteka posiadajâca szeôê funkcji oraz cztery makrodefinicje. Wszystko,
   co musisz zrobiiê aby z niej skorzystaê opisane jest poniûej:

       * Wywoîaj vmAllocBlock (albo skorzystaj z makrodefinicji vmAllocData)
   aby uzyskaê wskaúnik na dane. (Potrzebuje go VMem).

       * Wywoîaj vmLock (albo uûyj vmLockData) aby uzyskaê wskaúnik na
   dane, których bëdziesz uûywaê.

       * Korzystaj z danych.

       * Wywoîaj vmUnLock (anbo skorzystaj z makro vmUnLockData) aby
   "odbezpieczyê" dane.

       * Wywoîaj vmFreeBlock (albo uûyj makro vmFreeData) aby zwolniê
   wskaúnik, który zwróciîa funkcja v,AllocBlock (albo vmAllocData)

       Makrodefinicje pozwalajâ îatwo przydzieliê pamiëê wirtualnâ.
   Posiadajâ one z góry zdefiniowane niektóre parametry. (np. przydzielajâ
   tylko jeden element pamiëci, zwykle VMem korzysta z tablicy zawierajâcej
   wiele takich elementów).

       Dwie funkcje znajdujâce sië w VMem sâ kopiami oryginalnych funkcji
   Exec. Sâ to vmAllocMem() oraz vmFreeMem(). Oferujâ one wiëcej funkcji niû
   zwykîe funkcje Exec (miëdzy innymi zwalnienie nieuûywanej pam¡ëci
   wirtualnej).

       Aby obsîugiwaê te funkcje powinieneô przeczytaê "autodoki"
   przeznaczone dla systemu operacyjnego.

vmem.library/vmAllocBlock                           vmem.library/vmAllocBlock

   NAZWA
           vmAllocBlock

   WEJÔCIE/WYJÔCIE
           vmBlock *vmb = vmAllocBlock(ULONG size,ULONG nels,ULONG memflags)
                     d0                  d0          d1          d2

   PRZEZNACZENIE
           Przydziela vmBlock, który sîuûy do kontroli nad danymi pamiëci
       wirtualnej.

   ARGUNMENTY

       size:
       -   rozmiar kaûdego elementu tablicy
       nels:
       -   iloôê elementów w tablicy
       memflags:
       -   standardowe flagi znane z exec.library/AllocMem()

   REZULTAT

       vmb:
       -   Kontrolny wzkaúnik pam¡ëci wirtualnej (vmBlock). Zawiera on
           informacje o Twoich danych i bëdzie argumentem wielu innych
           funkcji VMem.

   PRZYKÎAD

       vmBlock *vmb;
       struct Preferences *prefs_ptr;
       ULONG i;
       ...

       if(!(vmb = vmAllocBlock(sizeof(struct Preferences),10,MEMF_PUBLIC)))
       {
           /* vmAllocBlock nie zadziaîa prawidîowo, jeôli masz bardzo maîo
              pamiëci albo na dysku nie wystarczy miejsca na odpowiednie
              pliki, które tworzy VMem */

           ...

       }else
       {
           for(i=0;i<NUM_ELS;i++)
           {
               if(!(prefs_ptr = vmLock(vmb,i)))
               {
                   /* nie zadziaîa prawidîowo jeôli - bîâd dyskowy, lub 
                      bardzo maîo pamiëci */
                   ....

               }else
               {
                   /* tu zrób coô z danymi */

                   ....

                   /*  "Odbezpiecz" dane, jek skoïczysz je uûywaê */

                   vmUnLock(vmb,i);

               };
           };

           /*  potem zwolnij vmBlock */

          vmFreeBlock(vmb);
       };




   UWAGI

   BÎËDY

       Na razie VMem jest w stanie utworzyê swoje pliki tylko na jednym
       urzâdzeniu. Nie moûna wiëc korzystaê jednoczeônie z plików pamiëci
       wirtualnej znajduâcych sië np. na dwóch twardych

   ZOBACZ TAKÛE

       vmFreeBlock,vmLock,vmUnLock,         vmAllocData
       exec.library/AllocMem autodoc (definicje atrybutow)

vmem.library/vmAllocData                             vmem.library/vmAllocData

   NAZWA

           vmAllocData         (MAKRO)

   WEJÔCIE/WYJÔCIE

           vmBlock *b = vmAllocData(ULONG blocksize,ULONG memflags);

   PRZEZNACZENIE

       Makro to jest zdefiniowane w Libraries/VMem.h jako vmAllocBlock(blocksize,1,memfla
   gs)

       Przydziela vmBlock, który nie jest tablicâ lecz zawiera tylko jeden
   element.

   ARGUMENTY

   REZULTAT

   PRZYKÎAD

   UWAGI

   BÎËDY

   ZOBACZ TAKÛE

       vmAllocBlock,    vmLockData,vmUnLockData,vmFreeData

vmem.library/vmAllocMem                               vmem.library/vmAllocMem

   NAZWA
           vmAllocMem

   WEJÔCIE/WYJÔCIE
           VOID *memptr = vmAllocMem(ULONG size,ULONG attrs)
                   d0                  d0          d1

   PRZEZNACZENIE
        Identyczne jak exec.library/AllocMem z wyjâtkiem tego, ûe zawiera
   dodatkowo sprawdzanie uûycia i ewentualne zwracanie nie uûywanej pam¡ëci
   wirtualnej.

   ARGUMENTY
        Identyczne jak exec.library/AllocMem.

   REZULTAT
       -   Wzkaúnik na pamiëê, która zostaîa przydzielona albo NULL jeôli
           coô poszîo niedobrze.


   PRZYKÎAD

   UWAGI

   BÎËDY

   ZOBACZ TAKÛE

        vmFreeMem,  exec.library/AllocMem

vmem.library/vmFlush                                     vmem.library/vmFlush

   NAZWA
           vmFlush

   WEJÔCIE/WYJÔCIE
           ULONG memflushed = vmFlush(ULONG memneeded,ULONG memflags);
                   d0                      d0              d1

   PRZEZNACZENIE
                 Zwalnia nie wykorzystanâ czëôê pamiëci wirtualnej.

   ARGUMENTY
           memneeded:
           -   iloôê *DODAWANEJ* pam¡ëci w bajtach.
           memflags:
           -   Typ zwalnienej pamiëci (standardowe atrybuty 
               exec.library/AllocMem)

   REZULTAT
           memflushed:
           -   Uzyskana iloôc pam¡ëci w bajtach.

   PRZYKÎAD

   UWAGI

           memflshed to zwolniona pamiëê przez të funkcjë. W miëdzyczasie
jednak jakiô inny program mógî jâ uûyê (tzn. zanim wywoîaîeô np.
vmAllocMem). Dlatego sprawdzaj rezultat vmAllocMem, nawet jeôli vmFlush
mówi, ûe jest wolna pamiëê.

   BÎËDY

   ZOBACZ TAKÛE

vmem.library/vmFreeBlock                             vmem.library/vmFreeBlock

   NAZWA
           vmFreeBlock

   WEJÔCIE/WYJÔCIE
           void vmFreeBlock(vmBlock *b)
                   a0

   PRZENZACZENIE
           Zwalnia vmBlock przeznaczony dla pamiëci wirtualnej, gdy juû go
       niee potrzebujesz.

   ARGUMENTY
           b:
           -   wskaúnik bloku, który ma byê zwolniony.

   REZULTAT
           Zwalnia wszystkâ pamiëê uûywanâ przez dane pamiëci wirtualnej,
       kasuje znajduâce sië na dysku pliki pam¡ëci wirtualnej.

   PRZYKÎAD

       Zobacz przykîad dla vmAllocBlock().

   UWAGI

   BÎËDY

   ZOBACZ TAKÛE

       vmAllocBlock,vmLock,vmUnLock,        vmFreeData

vmem.library/vmFreeData                               vmem.library/vmFreeData

   NAZWA

           vmFreeData          (MAKRO)

   WEJÔCIE/WYJÔCIE

           void vmFreeData(vmBlock *);

   PRZEZNACZENIE

       Funkcja ta jest zdefiniowana w Libraries/VMem.h jako vmFreeBlock(b).
       Robi to samo co vmFreeBlock. Zostaîa wprowadzona tylko w celu
       uîatwienia ûycia programiôcie. Zobacz opis do vmFreeBlock().

   ARGUMENTY

   REZULTAT

   PRZYKÎAD

   UWAGI

   BÎËDY

   ZOBACZ TAKÛE

       vmFreeBlock,     vmAllocData,vmLockData,vmUnLockData

vmem.library/vmFreeMem                                 vmem.library/vmFreeMem

   NAZWA
           vmFreeMem

   WEJÔCIE/WYJÔCIE
           VOID vmFreeMem(VOID *memptr,ULONG size)
                               d0          d1

   PRZEZNACZENIE
           Identyczne jak exec.library/FreeMem, z wyjâtkiem dodatkowych
   funkcji (zobacz vmAllocMem).

   ARGUMENTY
           Identyczne jak w exec.library/AllocMem. Obejrzyj opis tamtej
   funkcji.

   REZULTAT

   PRZYKÎAD

   UWAGI

   BÎËDY

   ZOBACZ TAKÛE

        vmAllocMem,     exec.library/FreeMem

vmem.library/vmLock                                       vmem.library/vmLock

   NAZWA
           vmLock

   WEJÔCIE/WYJÔCIE
           VOID *ptr = vmLock(vmBlock *b,ULONG el)
                 d0                  a0       d0

   PRZEZNACZENIE
           "Rezerwuje do uûycia" jeden element pam¡ëci wirtualnej.

   INPUTS
           b:
           -   vmBlock (zwraca go vmAllocBlock lub vmAllocData).

           el:
           -   Numer elementu, który ma byê uûywany.

   RESULT

           ptr:
           -   Adres przydzielonych danych.

   PRZYKÎAD

       Zobacz przykîad dla vmAllocBlock().

   UWAGI

   BÎËDY

   ZOBACZ TAKÛE

       vmAllocBlock,vmUnLock,vmFreeBlock,        vmLockData

vmem.library/vmLockData                               vmem.library/vmLockData

   NAZWA

       vmLockData          (MAKRO)

   WEJÔCIE/WYJÔCIE

       VOID *memptr = vmLockData(vmBlock *blk)

   PRZEZNACZENIE

       Jest zdefiniowana w Libraries/VMem.h jako vmLock(blk,0).
       "Rezerwuje do uûycia" blok pamiëci (vmBlock), który skîâda sië tylko
       z jednego elementu. Dziaîa tak samo jak vmLock.

   ARGUMENTY

   REZULTAT

   PRZYKÎAD

   UWAGI

   BÎËDY

   ZOBACZ TAKÛE

       vmLock, vmAllocData,vmUnLockData,vmFreeData

vmem.library/vmUnLock                                   vmem.library/vmUnLock

   NAZWA
           vmUnLock

   WEJÔCIE/WYJÔCIE
           void vmUnLock(vmBlock *b,ULONG el)
                               a0          d0

   PRZEZNACZENIE
           "Zwalnia z uûycia" element pamiëci wirtualnej, który zostaî 
       "zarazerwowany" przez vmLock().

   ARGMENTY
       b:
       -   wzkaúnik na vmBlock.
       el:
       -   Numer elementu do "zwolnienia".

   REZULTAT
           "Zwalnia dane". Gdy jest maîo rzeczywistej pamiëci, powoduje to
   zapisanie danych na plik pamiëci wirtualnej oraz zwolnienie rzeczywistej
   pamiëci.

   PRZYKÎAD

       Zobacz przykîad dla vmAllocBlock().

   UWAGI
           Pmiëtaj, ûe ta funkcja potrzebuje NUMERU elementu a nie
       wskaúnika.

   BÎËDY

   ZOBACZ TAKÛE

       vmAllocBlock,vmLock,vmFreeBlock,      vmUnLockData

vmem.library/vmUnLockData                           vmem.library/vmUnLockData

   NAZWA

           vmUnLockData        (MAKRO)

   WEJÔCIE/WYJÔCIE

           void vmUnLockData(vmBlock *blk);

   PRZEZNACZENIE

       Jest zdefiniowane w Libraries/VMem.h jako vmUnLock(blk,0). "Zwalnia"
blok pamiëci wirtualnej, który zawiera tylko jeden element. Poza tym zobacz
opis do vmLock().

   ARGUMENTY

   REZULTAT

   PRZYKÎAD

   UWAGI

   BÎËDY

   ZOBACZ TAKÛE

       vmUnLock,   vmAllocData,vmLockData,vmFreeData

