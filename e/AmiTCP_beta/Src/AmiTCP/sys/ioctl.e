OPT MODULE, PREPROCESS
OPT EXPORT

CONST IOCPARM_MASK=$1FFF

#define IOCPARM_LEN(x) (Shr((x),16) AND IOCPARM_MASK)
#define IOCBASCMD(x)   ((x) AND Not(IOCPARM_MASK))
#define IOCGROUP(x)    (Shr((x),8) AND $FF)

CONST IOCPARM_MAX=4096,
      IOC_VOID=$20000000,
      IOC_OUT=$40000000,
      IOC_IN=$80000000

CONST IOC_INOUT=IOC_IN OR IOC_OUT,
      IOC_DIRMASK=$E0000000

#define _IOC(inout,group,num,len) \
  ((inout) OR Shl((len) AND IOCPARM_MASK, 16) OR Shl((group), 8) OR (num))
#define _IO(g,n)     _IOC(IOC_VOID,  (g), (n), 0)
#define _IOR(g,n,t)  _IOC(IOC_OUT,   (g), (n), SIZEOF t)
#define _IOW(g,n,t)  _IOC(IOC_IN,    (g), (n), SIZEOF t)
#define _IOWR(g,n,t) _IOC(IOC_INOUT, (g), (n), SIZEOF t)

CONST FIOCLEX=  $20006601,
      FIONCLEX= $20006602,
      FIONREAD= $4004667F,
      FIONBIO=  $8004667E,
      FIOASYNC= $8004667D,
      FIOSETOWN=$8004667C,
      FIOGETOWN=$4004667B,
      SIOCATMARK=$40047307,
      SIOCSPGRP= $80047308,
      SIOCGPGRP= $40047309,
      SIOCADDRT= $8030720A,
      SIOCDELRT= $8030720B,
      SIOCSIFADDR=    $8020690C,
      SIOCGIFADDR=    $C0206921,
      SIOCSIFDSTADDR= $8020690E,
      SIOCGIFDSTADDR= $C0206922,
      SIOCSIFFLAGS=   $80206910,
      SIOCGIFFLAGS=   $C0206911,
      SIOCGIFBRDADDR= $C0206923,
      SIOCSIFBRDADDR= $80206913,
      SIOCGIFCONF=    $C0086924,
      SIOCGIFNETMASK= $C0206925,
      SIOCSIFNETMASK= $80206916,
      SIOCGIFMETRIC=  $C0206917,
      SIOCSIFMETRIC=  $80206918,
      SIOCDIFADDR=    $80206919,
      SIOCAIFADDR=    $8040691A,
      SIOCSARP=$8026491E,
      SIOCGARP=$C0264926,
      SIOCDARP=$80264920,
      SIOCGARPT=$C0324942
