@database rxobj_database

@node main "AMIGA-E Modules: rxobj_oo/Main"

                    ** RXOBJ_OO - Written By Fabio Rotondo **

                            ** DOCUMENTATION GUIDE **


    @{"  Introduction  " LINK rxobj_intro}       @{" Author's Infos " LINK author}         @{" Example Program " LINK example}


    COMMANDS                            BRIEF DESCRIPTION
    ---------------------------------------------------------------------------
    @{" rxobj(portname)                  " LINK rxobj_rxobj} Initializes the object
    @{" createPort(pname, pri)           " LINK rxobj_create} Creates a Message Port
    @{" deletePort(port)                 " LINK rxobj_delete} Deletes a Message Port
    @{" error()                          " LINK rxobj_error} Gets the last error
    @{" get(parseproc)                   " LINK rxobj_get} Gets the next incoming ARexx Message
    @{" getanswer()                      " LINK rxobj_getanswer} Waits for replies by another Rexx Host
    @{" rc()                             " LINK rxobj_rc} Returns the last RC got
    @{" reply(rxmsg, rc=0, res=NIL)      " LINK rxobj_reply} Reply to an ARexx Message
    @{" result()                         " LINK rxobj_result} Return the last RESULT string got
    @{" send(hname, comm, unkmsg, flags) " LINK rxobj_send} Sends a message to an ARexx Host
    @{" signal()                         " LINK rxobj_sig} Returns the SigBit

    @{" ERROR TABLE " LINK rxobj_errortable} ERROR TABLE DESCRIPTION
@endnode

@node author "Author's Infos"

    My name is Fabio Rotondo. I am a free-lance Amiga programmer and I would
    like to get in touch with anyone who writes code for the Amiga.
    I write in AmigaE, BlitzII, C and a bunch of other languages.

    Please, feel free to contact me for any suggestions/questions.

    My address is:

    Fabio Rotondo
    C.so Vercelli 9
    28100 Novara
    ITALY
    Tel. (ITA) - (0)321 - 459676
    e-mail: fsoft@intercom.it
       WWW: http://www.intercom.it/homepages/utenti/fsoft/index.html


    Thanks!
@endnode

@node example "AMIGA-E Modules: Example Program"
MODULE 'Fabio/rxobj_oo'     -> The MAGIC module should be in: EMODULES:Fabio dir

DEF quit = FALSE

PROC main()
  DEF rx:PTR TO rxobj       -> Our ARexx object
  DEF rxsig
  DEF sig

  NEW rx.rxobj('FabioSoft')  -> Here we init the obj with a Portname

  WriteF('Host: "FabioSoft" Alive AND Kicking!\n')
  WriteF('Send a QUIT message TO the port!\n')

  rxsig:=rx.signal()        -> This is our port SigBit
  REPEAT
    sig:=Wait(rxsig)        -> Waiting for Arexx commands
    rx.get({parse})         -> If any, parse them
  UNTIL quit=TRUE

  WriteF('This is the end...\n')
  END rx
ENDPROC

PROC parse(t)
  WriteF('Parsing:\s\n', t)   -> Variable t is a string...
  IF StrCmp(t, 'QUIT')
    quit:= TRUE
  ENDIF
ENDPROC TRUE, 0,NIL


@endnode

@node rxobj_intro "AMIGA-E Modules: rxobj_oo/Introduction"

    RXOBJ_OO - Introduction

    rxobj_oo is a little AmigaE "class" which helps the programmer to handle
    ARexx Ports. With this little module, you can easyly add an ARexx port to
    your programs and use it without worrying about what there is "inside".

    The rxobj_oo.m file should be placed inside a new dir you created called
    ** EMODULES:Fabio ** this will allows future compatibility with my new
    modules and also will save you from "losting" my module inside the mess
    of all the others... like I did so many times before creating this holy
    directory!!!

    The use is quite simple. Just DEFine a PTR TO rxobj at the beginning of
    your program and initialize it with a NEW objname.rxobj(portname).
    All the rest is funny! Look at the @{" Example Program " LINK example} for having
    an idea.

    rxobj_oo has been developed and is (C)Copyright by Fabio Rotondo.

    SEE ALSO: @{" Author's Infos " LINK author}
@endnode

@node rxobj_rxobj "AMIGA-E Modules: rxobj_oo/rxobj()"

           NAME: rxobj(portname:PTR TO CHAR)

    DESCRIPTION: This command initializes an rxobj and opens the Message Port
                 portname.

          INPUT: portname - Name of the MsgPort.

        RESULTS: NONE.

       SEE ALSO: @{" error() " LINK rxobj_error}
@endnode

@node rxobj_error "AMIGA-E Modules: rxobj_oo/error()"

           NAME: err := error()

    DESCRIPTION: returns the last generated error.

          INPUT: NONE.

        RESULTS: err - a LONG containing the last error.

       SEE ALSO: @{" ERROR TABLE " LINK rxobj_errortable}
@endnode

@node rxobj_get "AMIGA-E Modules: rxobj_oo/get()"

           NAME: get(parseproc)

    DESCRIPTION: gets the next ARexx message waiting and calls the parsing
                 PROC to handle it.

          INPUT: parseproc      - This is the address of the parsing PROC.
                                  The parsing proc MUST do these things:

                                  * get a PTR TO CHAR as an argument.

                                  * return three values in this order:

                                    isrxmessage (TRUE/FALSE - TRUE = recognised
                                                 rexx command)

                                    rc          = return code

                                    result      = result string

           NOTE: The get() command automagically calls the reply() method...

        RESULTS: NONE.

       SEE ALSO: @{" reply() " LINK rxobj_reply}

@endnode

@node rxobj_reply "AMIGA-E Modules: rxobj_oo/reply()"

           NAME: reply(rexxmsg:PTR TO rexxmsg, rc, resultstr)

    DESCRIPTION: reply to an ARexx Message, setting RC and RESULT string.

          INPUT: rexxmsg          - PTR TO rexxmsg, it is the message we want
                                    to reply() to.
                 rc               - RC of the ARexx Function.
                 resultstr        - RESULT ARexx String.

        RESULTS: NONE.

       SEE ALSO: @{" get() " LINK rxobj_get}

@endnode

@node rxobj_sig "AMIGA-E Modules: rxobj_oo/signal()"

           NAME: signal()

    DESCRIPTION: returns the value of the sigbit mask of rxobj.

          INPUT: NONE.

        RESULTS: a LONG value containing the sigbit.

       SEE ALSO: @{" rxobj() " LINK rxobj_rxobj}

@endnode

@node rxobj_send "AMIGA-E Modules: rxobj_oo/send()"

    *** NOTE: THIS COMMAND IS STILL EXPERIMENTAL !!! ***

           NAME: send(hostname, command, unknownmsg, flags)

    DESCRIPTION: sends a message to an ARexx Host.

          INPUT: hostname   - name of the ARexx Port of the Host.
                 command    - command to send to the ARexx Host.
                 unknownmsg - original msgpointer (usually NIL)
                 flags      - usually 0

        RESULTS: returns a rexxmsg for a succeded operation,
                 0 if it will fail.

       SEE ALSO:

@endnode

@node rxobj_errortable "AMIGA-E Modules: rxobj/ERROR TABLE"

    ** NOTE: These error may "grow" in future!!!

VALUE    NAME               MEANING
----------------------------------------
1        DOUBLE_PORT        The programmer tried to open a MsgPort twice with
                            the same Name.

2        SIGNAL_ALLOCATION  The rxobj failed creating the SigBit.


well, at the moment these are the only two errors the module can handle with.
In future, I'll promise you more and more accurate checks. 

@endnode

@node rxobj_getanswer "AMIGA-E Modules: rxobj_oo/getanswer()"

           NAME: getanswer()

    DESCRIPTION: This command waits for an asnwer by another Rexx Host.
                 This is usefull if you want to get the RC or Result String
                 from an Host where you have just sent a message.

          INPUT: NONE.

        RESULTS: NONE.

           NOTE: This command is DANGEROUS: you will lost any command sent to
                 your Host by other sites.

       SEE ALSO: @{" result() " LINK rxobj_result}
                 @{" rc()     " LINK rxobj_rc}
@endnode

@node rxobj_create "AMIGA-E Modules: rxobj_oo/createPort()"

           NAME: createPort(portname, priority)

    DESCRIPTION: This command creates a Message Port.
                 It is used by rxobj() itself, but it may turn to be usefull
                 also for other purposes.

          INPUT: portname       - Name of the port, if it is NIL, the port will
                                  be PRIVATE.

                 priority       - Public Port Priority.

        RESULTS: NONE.

           NOTE: Trying to create an EXISTING public Message Port will not get
                 to any error() message.

       SEE ALSO: @{" deletePort " LINK rxobj_delete}
@endnode

@node rxobj_delete "AMIGA-E Modules: rxobj_oo/deletePort()"

           NAME: deletePort(port:PTR TO mp)

    DESCRIPTION: This command deletes a Message Port.
                 It is used by rxobj() itself, but it may turn to be usefull
                 also for other purposes.

          INPUT: port         - PTR TO a message port structure.

        RESULTS: NONE.

           NOTE: Trying to delete a unexistsing Message Port will not get
                 to any error() message.

       SEE ALSO: @{" createPort " LINK rxobj_create}
@endnode


@node rxobj_result "AMIGA-E Modules: rxobj_oo/result()"

           NAME: result()

    DESCRIPTION: This command will return the last result obtained by a 
                 getanswer() or get() method.

          INPUT: NONE.

        RESULTS: a PTR TO CHAR containing the result string.

       SEE ALSO: @{" rc()        " LINK rxobj_rc}
                 @{" get()       " LINK rxobj_get}
                 @{" getanswer() " LINK rxobj_getanswer}
@endnode


@node rxobj_rc "AMIGA-E Modules: rxobj_oo/rc()"

           NAME: rc()

    DESCRIPTION: This command will return the last rc code obtained by a
                 getanswer() or get() method.

          INPUT: NONE.

        RESULTS: a LONG containing the rc code.

       SEE ALSO: @{" result()    " LINK rxobj_result}
                 @{" get()       " LINK rxobj_get}
                 @{" getanswer() " LINK rxobj_getanswer}
@endnode

