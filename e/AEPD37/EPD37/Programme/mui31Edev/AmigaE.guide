@DATABASE MUI-AmigaE.guide

@NODE MAIN "MUI-AmigaE.guide"
@NEXT INTRO

		      MUI DEVELOPER FILES FOR AMIGA E
		      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

	@{" First words " LINK INTRO}  Read this! (I moved again!)

	@{" Changes     " LINK CHANGES}  What's new ?
	@{" Files       " LINK FILES}  Description of the files.

	@{" Problems    " LINK PROBS}  Problems with MUI and AmigaE.
	@{" Future      " LINK FUTURE}  New MUI -> new files ?

	@{" Author      " LINK AUTHOR}  and copyright.
	@{" Disclaimer  " LINK DISCLAIMER}  No warranty!

@ENDNODE
**********************************************************************
@NODE INTRO "First words"
@PREV MAIN
@NEXT CHANGES
@TOC MAIN

				FIRST WORDS
				~~~~~~~~~~~

1) As you maybe already know from the guide-file that came with MUI 3.1, I
moved to Hamburg some time ago. The address I wrote into this (old) guide
was only a temporary address (address of my mother). Click @{" here " LINK AUTHOR} to see
my real new snailmail-address and my new email-address!

2) I think about splitting the very big "mui.m"-module into several
small modules (one module per class?) and put them into a new
EMODULES:mui-directory. This would cause the need to change old
sources, but I think it will give a better overview!? What do you think
about this?

@ENDNODE
**********************************************************************
@NODE CHANGES "Changes"
@PREV INTRO
@NEXT FILES
@TOC MAIN

				  CHANGES
				  ~~~~~~~

Changes since the files from the mui31dev.lha-archive:
  - Complete and already compiled modules.
  - New module @{" muicustomclass.m " LINK F_MCCM}.
  - New example-source @{" Class1.e " LINK F_CLASS1E}.

Changes since "mui23Edev.lha":
  - E versions <3.1a are no longer supported to keep the total size of this
    Amiga-E files reasonable. If you still use E v2.1b than update now or
    use "mui23Edev.lha".
  - The modules in "Modules/libraries" are partly generated automaticly by
    Stefan Stuntz. Because he has no e-compiler, and to keep the number of
    files small, only the source-code of this modules is provided. You have
    to compile them into an e-module by yourself.

@ENDNODE
**********************************************************************
@NODE FILES "The Files"
@PREV CHANGES
@NEXT PROBS
@TOC MAIN

				THE FILES
				~~~~~~~~~

	Modules/	    @{" muimaster.m      " LINK F_MUIMASTER}

	Modules/libraries/  @{" mui.m            " LINK F_MUIM }
			    @{" mui.e            " LINK F_MUIE }

			    @{" muip.m           " LINK F_MUIPM}
			    @{" muip.e           " LINK F_MUIPE}

	Modules/tools/	    @{" muicustomclass.m " LINK F_MCCM }
			    @{" muicustomclass.e " LINK F_MCCE }

	Examples/	    @{" MUI-Demo.e       " LINK F_MUIDEMOE}
			    @{" Class1.e         " LINK F_CLASS1E}

@ENDNODE
**********************************************************************
@NODE F_MUIMASTER "Files: Modules/muimaster.m"
@PREV F_MUIMASTER
@NEXT F_MUIM
@TOC FILES

			    "Modules/muimaster.m"
			    ~~~~~~~~~~~~~~~~~~~~~

   This file defines the functions of the muimaster.library. Copy it to
EMODULES: and to use it write in your source:

	MODULE 'muimaster'

ATTENTION: With "mui22Edev2.lha" I changed the names of the functions from
MuI_... to Mui_... (Lionel Vintenat (Mac2E) told me that Mui_... looks
nicer and I think he's right.) Maybe you have to change your old sources
to use this file.

@ENDNODE
***********************************************************************
@NODE F_MUIM "Files: Modules/libraries/mui.m"
@PREV F_MUIMASTER
@NEXT F_MUIE
@TOC FILES

			 "Modules/libraries/mui.m"
			 ~~~~~~~~~~~~~~~~~~~~~~~~~

   This module contains a complete translation of the original C mui.h
file with only one exception: The muip_... OBJECTs are moved to the
file @{" Modules/libraries/muip.m " LINK F_MUIPM}.

   The #defines (and CONSTs) are written exactly the same way as in the
mui.h file (with one exception: The macro String() is renamed to StringMUI()
to avoid conflicts with the E function String()). The identifiers of the
OBJECTs are all written totaly lowercase!!

   Copy this file to "EMODULES:libraries/mui.m". To use it in your
source write:

	MODULE 'libraries/mui'

   Don't forget to add "OPT PREPROCESS" to your source, if you want to use
the macros!

   See also: @{" Modules/libraries/mui.e " LINK F_MUIE} and @{" Modules/libraries/muip.m " LINK F_MUIPM}

   NOTE: Have a look at @{" First words " LINK INTRO}!

@ENDNODE
**********************************************************************
@NODE F_MUIE "Files: Modules/libraries/mui.e"
@PREV F_MUIM
@NEXT F_MUIPM
@TOC FILES

			 "Modules/libraries/mui.e"
			 ~~~~~~~~~~~~~~~~~~~~~~~~~

   This is the source-file of @{" mui.m " LINK F_MUIM}. Use it to find out what the macros
do and maybe read the comments.

@ENDNODE
**********************************************************************
@NODE F_MUIPM "Files: Modules/libraries/muip.m"
@PREV F_MUIE
@NEXT F_MUIPE
@TOC FILES

			 "Modules/libraries/muip.m"
			 ~~~~~~~~~~~~~~~~~~~~~~~~~~

   This module contains all the MUIP_...-structs of the original C mui.h
file as OBJECT's. I think, this OBJECT's are not very usefull in E, that's
why I didn't include them in the first releases. But to have a complete
AmigaE-MUI-interface...(and to use customclasses...)

   Copy this module to "EMODULES:libraries/muip.m". To use this module,
write in your source:

	MODULE 'libraries/muip.m'

   See also: @{" Modules/libraries/muip.e " LINK MUIPE} and "Examples/Class1.e"

@ENDNODE
**********************************************************************
@NODE F_MUIPE "Files: Modules/libraries/muip.e"
@PREV F_MUIPM
@NEXT F_MCCM
@TOC FILES

			 "Modules/libraries/muip.e"
			 ~~~~~~~~~~~~~~~~~~~~~~~~~~

   This is the source-file of @{" muip.m " LINK F_MUIPM}.

@ENDNODE
**********************************************************************
@NODE F_MCCM "Files: Modules/tools/muicustomclass.m"
@PREV F_MUIPE
@NEXT F_MCCE
@TOC FILES

		    "Modules/tools/muicustomclass.m"
		    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

   If you want to use custom-classes in you programms - and the new
philosophy of MUI-programming is, to use as many custom-classes as
possible (have a look at the comments of psi.c !) - you'll get a
problem.

   The dispatcher-function of the custom-class is called as a hook-
funktion. Normally you whould use the installhook()-function from the
installhook-module to install the hook-structure of a hook-function.

   But with custom-classes, MUI will install the hook-structure for
you and uses the userdata-field of this structure (which is normally
used by installhook to store the contents of A4) itself. So you can't
use installhook() with a custom-class-dispatcher.

   To solve this problem, I wrote the "muicustomclass.m"-module. It
contains a function called eMui_CreateCustomClass(), which should be
used as a replacement for the original Mui_CreateCustomClass()-function.
Have a look at the source of this module and at the example-source
@{" Class1.e " LINK F_CLASS1E} to see, how to use it and how it works.

Note: The userdata-filed of the iclass-structure your dispatcher gets,
is used by this module to point to some important data. But the first
LONG of this data is unused and could be used as a new userdata-field.
Simply write 'iclass.userdata[]' instead of 'iclass.userdata'.

   See also: @{" muicustomclass.e " LINK F_MCCE} and @{" Examples/Class1.e " LINK F_CLASS1E}

@ENDNODE
**********************************************************************
@NODE F_MCCE "Files: Modules/tools/muicustomclass.e"
@PREV F_MCCM
@NEXT F_MUIDEMOE
@TOC FILES

			"Modules/tools/muicustomclass.e"
			~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

   This is the source of @{" muicustomclass.m " LINK F_MCCM}. Have a look at the comments
to see, whats going on exactly.

   See also the example-source @{" Class1.e " LINK F_CLASS1E}.

@ENDNODE
**********************************************************************
@NODE F_MUIDEMOE "Files: Examples/MUI-Demo.e"
@PREV F_MCCE
@NEXT F_CLASS1E
@TOC FILES

			    "Examples/MUI-Demo.e"
			    ~~~~~~~~~~~~~~~~~~~~~

   This is a translation of the C demo-source "MUI-Demo.c" that came with
MUI v2.1. Use it to see, how to write MUI-programms in E and where are the
differences between C and E.

   See also: @{" Problems " LINK PROBS}

   Note: This source is really old and uses not the new features of the
	 actuall E-compiler in many cases. So, it's maybe not a good
	 example anymore!? Keep this in mind if you look at it.

@ENDNODE
**********************************************************************
@NODE F_CLASS1E "Files: Examples/Class1.e"
@PREV F_MUIDEMOE
@NEXT F_CLASS1E
@TOC FILES

			   "Examples/Class1.e"
			   ~~~~~~~~~~~~~~~~~~~

   This file is a translation of the C source "Class1.c". Use it to
see how to use customclasses in E and how to use the module
@{" muicustomclass.m " LINK F_MCCM}.

@ENDNODE
**********************************************************************
@NODE PROBS "Problems with MUI and E"
@PREV FILES
@NEXT FUTURE
@TOC MAIN

			   PROBLEMS WITH MUI AND E
			   ~~~~~~~~~~~~~~~~~~~~~~~

		@{" MUI_TRUE    " LINK P_TRUE}  Why a CONST MUI_TRUE?
		@{" SetAttrsA() " LINK P_SETATTRSA}  Problems with set()
		@{" TAG_IGNORE  " LINK P_TAGIGNORE}  Why "TAG_IGNORE,0," in some macros?

@ENDNODE

@NODE P_TRUE "Problems: TRUE=1 or TRUE=-1"
@PREV P_TRUE
@NEXT P_SETATTRSA
@TOC PROBS

			      TRUE=1 or TRUE=-1
			      ~~~~~~~~~~~~~~~~~

   In C TRUE has the value 1 but in E TRUE has the value -1. That can cause
problems, therefore a CONST "MUI_TRUE" with value 1 is defined in
@{" Modules/libraries/mui.e " LINK F_MUIE}. Use this one instead of TRUE whenever you want
to give TRUE to MUI. See "Examples/MUI_Demo.e".

@ENDNODE

@NODE P_SETATTRSA "Problems: Problem with SetAttrsA()"
@PREV P_TRUE
@NEXT P_TAGIGNORE
@TOC PROBS

			  Problem with SetAttrsA()
			  ~~~~~~~~~~~~~~~~~~~~~~~~

   Whenever you try to set an attribut to the value it allready has, MUI
overwrites this attribut in the taglist with TAG_IGNORE to make shure that
notify-class don't react on it. This is nessesary to prevent endless-
notification-loops. As long as you are a C programmer and use SetAttr()
that is no problem, because MUI then changes only a *copy* of the original
datas of the SetAttrs()-call. But if you use SetAttrsA(), as we must do
because SetAttrs() is a function of amiga.lib, it is a problem! You only
give a PTR to the original-datas with SetAttrsA() and now MUI changes this
*original* datas. If you then uses this datas again at the next execution
of the same SetAttrsA()-call, the datas are still changed and nothing
(TAG_IGNORE) will happen :-(

   One possible way to avoid this problem is, to make the attribut a non-
constant data. Instead of

   SetAttrsA(obj, [ MUIA_..., value, ..., TAG_DONE])

write

   SetAttrsA(obj, [Eval(`(MUIA_...)), value, ..., TAG_DONE])
		   ~~~~~~~        ~~
Now everytime this SetAttrsA()-call is executed, the attribute is again
"evaluated" and stored in the list.

   BUT: x:=[Eval(`(MUIA_...)),...]; SetAttrsA(obj,x); SetAttrsA(obj,x) has
*NOT* the wished result, because the non-constand datas of the LIST are only
evaluated when x is assigned to to the LIST but not everytime this PTR to
the LIST in x is used later!

   To avoid the SetAttrsA()-problem the macros set() (and nnset()) in the
file @{" Modules/libraries/mui.e " LINK F_MUIE} are defined like this:

  #define set(obj,attr,value) SetAttrsA(obj,[Eval(`(attr)),value,TAG_DONE])

   The global variable "setAttrsA" that was needed with the set() and
nnset() of former releases is now obsolete.

@ENDNODE

@NODE P_TAGIGNORE "Problems: TAG_IGNORE,0"
@PREV P_SETATTRSA
@NEXT P_TAGIGNORE
@TOC PROBS

				TAG_IGNORE,0
				~~~~~~~~~~~~

   Some of the macros in @{" Modules/libraries/mui.e " LINK F_MUIE} are ending with
"[TAG_IGNORE,0,". That seems to be superfluous but it is needed, because in
AmigaE v2.1b if you want to split a statement over several lines, you can't
end a line with "[" but with a comma. And with AmigaE v3.1 it's needed to
allow the same use of the macros.

@ENDNODE

@NODE AUTHOR "Author"
@PREV FUTURE
@NEXT DISCLAIMER
@TOC MAIN

				   AUTHOR
				   ~~~~~~

                       IMPORTANT NOTE: I moved again!

	Snail mail:	Jan Hendrik Schulz
			Elsässer Str. 19
		     	22049 Hamburg
			Germany

	e-mail:		schulz_j@informatik.fh-hamburg.de
				    or
			schulzjan@dame.shnet.org


@ENDNODE

@NODE FUTURE "Future"
@PREV PROBS
@NEXT AUTHOR
@TOC MAIN

				   FUTURE
				   ~~~~~~

   I still try to release a complete and useable AmigaE-MUI-interface
directly with MUI. Maybe with the next MUI-update...? If not, than
there will be again an archive like this.

   If you have some ideas to make things better, please write @{" me " LINK AUTHOR}.

@ENDNODE

@NODE DISCLAIMER "Disclaimer"
@PREV COPYRIGHTS
@NEXT DISCLAIMER
@TOC MAIN

				 DISCLAIMER
				 ~~~~~~~~~~

   This files are provided "AS IS" without warrenty of any kind, expressed
or implied! I'm NOT liable to you for damages or problems, including any
general, special, incidental or consequential damages or problems arising
out of the use or inhability to use of the files. Including but not limited
to loss of data or data being rendered inaccurate or losses sustained by you
or third parties or a failure of a program build with this files.

   (I hope you know what I want to say! My english is not good enough to
write such legal stuff!)

@ENDNODE
