#rE
	.include	ppcmacros.pasm
	.text
	.sdreg	r2
	.align	2
	.global	_SetColour
_SetColour:
.set	SetColour_scr,24
.set	SetColour_n,20
.set	SetColour_r,16
.set	SetColour_g,12
.set	SetColour_b,8
	link	a5,0
	push	a0
#IF GfxBase::GfxBase.LibNode.Version<39
	law	a0,_GfxBase
	lwz	a0,0(a0)
	lhz	d0,20(a0)
	andi.	d0,d0,0xFFFF
	cmpiw	d0,39
	bge	SetColour_else1_0
#SetRGB4(scr.RastPort,n,r>>4,g>>4,b>>4)
	lwz	a0,SetColour_scr(a5)
	addi	a0,a0,84
	lwz	d0,SetColour_n(a5)
	lwz	d1,SetColour_r(a5)
	srwi	d1,d1,4
	lwz	d2,SetColour_g(a5)
	srwi	d2,d2,4
	lwz	d3,SetColour_b(a5)
	srwi	d3,d3,4
	RUN_68K	_GfxBase,-288
#ELSE
	b	SetColour_endif1
SetColour_else1_0:
#SetRGB32(scr.RastPort,n,r<<24,g<<24,b<<24)
	lwz	a0,SetColour_scr(a5)
	addi	a0,a0,84
	lwz	d0,SetColour_n(a5)
	lwz	d1,SetColour_r(a5)
	slwi	d1,d1,24
	lwz	d2,SetColour_g(a5)
	slwi	d2,d2,24
	lwz	d3,SetColour_b(a5)
	slwi	d3,d3,24
	RUN_68K	_GfxBase,-852
SetColour_endif1:
	pop	a0
	unlk	a5
	blr

	.type	_SetColour,2
	.size	_SetColour,$-_SetColour

	.align	2
	.tocd
	.extern	_stdrast_
	.extern	_GfxBase_

	.tocd
	.extern	_PowerPCBase_
_SetColour_:	.long	_SetColour
