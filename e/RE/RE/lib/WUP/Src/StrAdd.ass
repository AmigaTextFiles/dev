
# StrAdd(a0:PTR TO CHAR,a1:PTR TO CHAR,d0=-1:LONG)

	.include	ppcmacros.pasm
	.text
	.global	_StrAdd

_StrAdd:
	mr	a6,a0
	subi	a0,a0,1		# find the end of the destination string
.find:	lbzu	r0,1(a0)
	mr.	r0,r0
	bne	.find

	mtctr	d0
	subi	a1,a1,1
	subi	a0,a0,1
.loop:	lbzu	r0,1(a1)	# get char from source
	mr.	r0,r0		# source end?
	beq	.finish
	stbu	r0,1(a0)	# put char to destination
	bdnz	.loop
.finish:	
	li	r0,0		# finish with zero byte
	stb	r0,1(a0)
	mr	d0,a6
	blr			# d0 contains destination string pointer

	.type	_StrAdd,@function
	.size	_StrAdd,$-_StrAdd
