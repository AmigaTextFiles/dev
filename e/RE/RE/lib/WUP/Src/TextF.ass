#rE
	.include	ppcmacros.pasm
	.text
	.sdreg	r2
	.align	2
#MOD:re:modules/exec.m
#MOD:re:modules/graphics.m
#MOD:re:modules/powerpc.m
#MOD:re:modules/lib/restd_PPC.m
	.global	_TextF
_TextF:
.set	TextF_x,20
.set	TextF_y,16
.set	TextF_fmtstring,12
.set	TextF_params,8
	link	a5,-520
	push	a0
#DEF buffer[512]:STRING
.set	TextF_buffer,-520
	addi	a0,a5,TextF_buffer
	mr	d0,a0
	addi	d0,d0,8
	stw	d0,0(a0)
	liw	d0,33554432
	stw	d0,4(a0)
	liw	d0,0
	stb	d0,8(a0)
#IF stdrast
#TextF_if1
	law	a0,_stdrast
	lwz	d0,0(a0)
	tstw	d0
	beq	TextF_else1_0
#RawDoFmtPPC(fmtstring,params,0,buffer)
	push	d0
	lwz	d1,TextF_fmtstring(a5)
	push	d1
	lwz	d1,TextF_params(a5)
	push	d1
	liw	d1,0
	push	d1
	lwz	r7,TextF_buffer(a5)
	pop	r6
	pop	r5
	pop	r4
	law	a6,_PowerPCBase
	lwz	r3,0(a6)
	lwz	a6,-840+2(r3)
	mtlr	a6
	blrl
	mr	d1,d0
	pop	d0
#
#Move(stdrast,x,y)
	push	d0
	law	a0,_stdrast
	lwz	d1,0(a0)
	push	d1
	lwz	d1,TextF_x(a5)
	push	d1
	lwz	d1,TextF_y(a5)
	pop	d0
	pop	a1
	RUN_68K	_GfxBase,-240
	mr	d1,d0
	pop	d0
#
#Text(stdrast,buffer,StrLen(buffer))
	push	d0
	law	a0,_stdrast
	lwz	d1,0(a0)
	push	d1
	lwz	d1,TextF_buffer(a5)
	push	d1
	push	d0
	lwz	d0,TextF_buffer(a5)
	bl	_StrLen
	mr	d1,d0
	pop	d0
	mr	d0,d1
	pop	a0
	pop	a1
	RUN_68K	_GfxBase,-60
	mr	d1,d0
	pop	d0
#
#ENDIF
TextF_else1_0:
#
#ENDPROC
	.global	TextF_end
TextF_end:
TextF_finish:
	pop	a0
	unlk	a5
	blr

	.type	_TextF,2
	.size	_TextF,$-_TextF

	.extern	_StrLen
	.align	2
	.tocd
	.extern	_laststackptr_
	.extern	_stdrast_
	.extern	_lastexceptptr_
	.extern	_lastframeptr_
	.extern	_ExecBase_
	.extern	_exceptioninfo_
	.extern	_GfxBase_
	.extern	_exception_
	.extern	_PowerPCBase_

	.tocd
	.extern	_PowerPCBase_
_TextF_:	.long	_TextF
TextF_end_:	.long	TextF_end
