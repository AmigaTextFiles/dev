
# Rnd(seed:r3:LONG)(LONG)

	.include	ppcmacros.pasm
	.text
	.sdreg	r2
	.global	_Rnd

_Rnd:	mr.	r8,r3
	blt	.set
	subi	r7,r8,1
	lwz	r3,.rnd(r2)
.l2:	add.	r3,r3,r3
	bgt	.l3
	xoris	r3,r3,0x1d87
	xori	r3,r3,0x2b41
.l3:	srwi.	r7,r7,1
	bne	.l2
	stw	r3,.rnd(r2)
	mr.	r8,r8
	bne	.l4
	rotlwi.	r3,r3,16
	b	.l5
.l4:	mullw	r3,r3,r8
.l5:	li	r3,0
	rotlwi.	r3,r3,16
	blr
.set:	neg	r8,r8
	stw	r8,.rnd(r2)
	blr

	.type	_Rnd,@function
	.size	_Rnd,$-_Rnd

	.tocd
	.global	.rnd
.rnd:	.long	0
