; d0 - exception
; d1 - exceptioninfo
;phxass NOEXE opt nrqbtlps re:lib/elib_68K/Raise.ass

	xdef	_Raise
	xdef	_exception
	xdef	_exceptioninfo
	xdef	_lastexceptptr
	xdef	_laststackptr
	xdef	_lastframeptr
	xref	_main_end

_Raise	move.l	d0,_exception
	move.l	d1,_exceptioninfo
	move.l	_lastexceptptr,d0
	beq.s	.exit
	movea.l	_laststackptr,a7
	movea.l	_lastframeptr,a5
	move.l	(a7)+,_lastframeptr
	move.l	(a7)+,_laststackptr
	move.l	(a7)+,_lastexceptptr
	movea.l	d0,a0
	jmp	(a0)
.exit	unlk	a5
	jmp	_main_end
;.exit	jmp	_main_end

;	section ".tocd",data
_exception	dc.l	0
_exceptioninfo	dc.l	0
_lastexceptptr	dc.l	0
_laststackptr	dc.l	0
_lastframeptr	dc.l	0

