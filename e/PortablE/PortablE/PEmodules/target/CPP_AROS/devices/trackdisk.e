/* $Id: trackdisk.h 25467 2007-03-19 06:46:34Z sonic $ */
OPT NATIVE, PREPROCESS
MODULE 'target/exec/devices', 'target/exec/io'
MODULE 'target/exec/types'
{#include <devices/trackdisk.h>}
NATIVE {DEVICES_TRACKDISK_H} CONST

NATIVE {TD_NAME} CONST
#define TD_NAME td_name
STATIC td_name = 'trackdisk.device'

/* OpenDevice() Flags */
NATIVE {TDB_ALLOW_NON_3_5}     CONST TDB_ALLOW_NON_3_5     = 0
NATIVE {TDF_ALLOW_NON_3_5} CONST TDF_ALLOW_NON_3_5 = $1

NATIVE {IOExtTD} OBJECT ioexttd
    {iotd_Req}	iostd	:iostd
    {iotd_Count}	count	:ULONG
    {iotd_SecLabel}	seclabel	:ULONG
ENDOBJECT

/* io_Flags */
NATIVE {IOTDB_INDEXSYNC}     CONST IOTDB_INDEXSYNC     = 4
NATIVE {IOTDF_INDEXSYNC} CONST IOTDF_INDEXSYNC = $10
NATIVE {IOTDB_WORDSYNC}      CONST IOTDB_WORDSYNC      = 5
NATIVE {IOTDF_WORDSYNC}  CONST IOTDF_WORDSYNC  = $20

/* trackdisk.device specific commands */
NATIVE {TD_MOTOR}        CONST TD_MOTOR        = (CMD_NONSTD + 0)
NATIVE {TD_SEEK}         CONST TD_SEEK         = (CMD_NONSTD + 1)
NATIVE {TD_FORMAT}       CONST TD_FORMAT       = (CMD_NONSTD + 2)
NATIVE {TD_REMOVE}       CONST TD_REMOVE       = (CMD_NONSTD + 3)
NATIVE {TD_CHANGENUM}    CONST TD_CHANGENUM    = (CMD_NONSTD + 4)
NATIVE {TD_CHANGESTATE}  CONST TD_CHANGESTATE  = (CMD_NONSTD + 5)
NATIVE {TD_PROTSTATUS}   CONST TD_PROTSTATUS   = (CMD_NONSTD + 6)
NATIVE {TD_RAWREAD}      CONST TD_RAWREAD      = (CMD_NONSTD + 7)
NATIVE {TD_RAWWRITE}     CONST TD_RAWWRITE     = (CMD_NONSTD + 8)
NATIVE {TD_GETDRIVETYPE} CONST TD_GETDRIVETYPE = (CMD_NONSTD + 9) /* see below */
NATIVE {TD_GETNUMTRACKS} CONST TD_GETNUMTRACKS = (CMD_NONSTD + 10)
NATIVE {TD_ADDCHANGEINT} CONST TD_ADDCHANGEINT = (CMD_NONSTD + 11)
NATIVE {TD_REMCHANGEINT} CONST TD_REMCHANGEINT = (CMD_NONSTD + 12)
NATIVE {TD_GETGEOMETRY}  CONST TD_GETGEOMETRY  = (CMD_NONSTD + 13) /* returns (DriveGeometry *) */
NATIVE {TD_EJECT}        CONST TD_EJECT        = (CMD_NONSTD + 14)
NATIVE {TD_LASTCOMM}     CONST TD_LASTCOMM     = (CMD_NONSTD + 15)

/* extended commands */
NATIVE {TDF_EXTCOM} CONST TDF_EXTCOM = $8000
NATIVE {ETD_READ}     CONST ETD_READ     = (CMD_READ     OR TDF_EXTCOM)
NATIVE {ETD_WRITE}    CONST ETD_WRITE    = (CMD_WRITE    OR TDF_EXTCOM)
NATIVE {ETD_UPDATE}   CONST ETD_UPDATE   = (CMD_UPDATE   OR TDF_EXTCOM)
NATIVE {ETD_CLEAR}    CONST ETD_CLEAR    = (CMD_CLEAR    OR TDF_EXTCOM)
NATIVE {ETD_MOTOR}    CONST ETD_MOTOR    = (TD_MOTOR     OR TDF_EXTCOM)
NATIVE {ETD_SEEK}     CONST ETD_SEEK     = (TD_SEEK      OR TDF_EXTCOM)
NATIVE {ETD_FORMAT}   CONST ETD_FORMAT   = (TD_FORMAT    OR TDF_EXTCOM)
NATIVE {ETD_RAWREAD}  CONST ETD_RAWREAD  = (TD_RAWREAD   OR TDF_EXTCOM)
NATIVE {ETD_RAWWRITE} CONST ETD_RAWWRITE = (TD_RAWWRITE  OR TDF_EXTCOM)

/* TD_GETDRIVETYPE */
NATIVE {DRIVE3_5}        CONST DRIVE3_5        = 1
NATIVE {DRIVE3_25}       CONST DRIVE3_25       = 2
NATIVE {DRIVE3_5_150RPM} CONST DRIVE3_5_150RPM = 3

NATIVE {DriveGeometry} OBJECT drivegeometry
    {dg_SectorSize}	sectorsize	:ULONG
    {dg_TotalSectors}	totalsectors	:ULONG
    {dg_Cylinders}	cylinders	:ULONG
    {dg_CylSectors}	cylsectors	:ULONG
    {dg_Heads}	heads	:ULONG
    {dg_TrackSectors}	tracksectors	:ULONG
    {dg_BufMemType}	bufmemtype	:ULONG
    {dg_DeviceType}	devicetype	:UBYTE   /* see below */
    {dg_Flags}	flags	:UBYTE        /* see below */
    {dg_Reserved}	reserved	:UINT
ENDOBJECT

/* dg_DeviceType */
NATIVE {DG_DIRECT_ACCESS}     CONST DG_DIRECT_ACCESS     = 0
NATIVE {DG_SEQUENTIAL_ACCESS} CONST DG_SEQUENTIAL_ACCESS = 1
NATIVE {DG_PRINTER}           CONST DG_PRINTER           = 2
NATIVE {DG_PROCESSOR}         CONST DG_PROCESSOR         = 3
NATIVE {DG_WORM}              CONST DG_WORM              = 4
NATIVE {DG_CDROM}             CONST DG_CDROM             = 5
NATIVE {DG_SCANNER}           CONST DG_SCANNER           = 6
NATIVE {DG_OPTICAL_DISK}      CONST DG_OPTICAL_DISK      = 7
NATIVE {DG_MEDIUM_CHANGER}    CONST DG_MEDIUM_CHANGER    = 8
NATIVE {DG_COMMUNICATION}     CONST DG_COMMUNICATION     = 9
NATIVE {DG_UNKNOWN}           CONST DG_UNKNOWN           = 31

/* dg_Flags */
NATIVE {DGB_REMOVABLE}     CONST DGB_REMOVABLE     = 0
NATIVE {DGF_REMOVABLE} CONST DGF_REMOVABLE = $1

NATIVE {TDU_PublicUnit} OBJECT publicunit
    {tdu_Unit}	unit	:unit

    {tdu_Comp01Track}	comp01track	:UINT
    {tdu_Comp10Track}	comp10track	:UINT
    {tdu_Comp11Track}	comp11track	:UINT
    {tdu_StepDelay}	stepdelay	:ULONG
    {tdu_SettleDelay}	settledelay	:ULONG
    {tdu_RetryCnt}	retrycnt	:UBYTE
    {tdu_PubFlags}	pubflags	:UBYTE       /* see below */
    {tdu_CurrTrk}	currtrk	:UINT
    {tdu_CalibrateDelay}	calibratedelay	:ULONG
    {tdu_Counter}	counter	:ULONG
ENDOBJECT

/* tdu_PubFlags */
NATIVE {TDPB_NOCLICK}      CONST TDPB_NOCLICK      = 0
NATIVE {TDPF_NOCLICK} CONST TDPF_NOCLICK = $1

NATIVE {TD_LABELSIZE} CONST TD_LABELSIZE = 16
NATIVE {TD_SECTOR} CONST TD_SECTOR = 512
NATIVE {TD_SECSHIFT} CONST TD_SECSHIFT = 9

NATIVE {TDERR_NotSpecified}   CONST TDERR_NOTSPECIFIED   = 20
NATIVE {TDERR_NoSecHdr}       CONST TDERR_NOSECHDR       = 21
NATIVE {TDERR_BadSecPreamble} CONST TDERR_BADSECPREAMBLE = 22
NATIVE {TDERR_BadSecID}       CONST TDERR_BADSECID       = 23
NATIVE {TDERR_BadHdrSum}      CONST TDERR_BADHDRSUM      = 24
NATIVE {TDERR_BadSecSum}      CONST TDERR_BADSECSUM      = 25
NATIVE {TDERR_TooFewSecs}     CONST TDERR_TOOFEWSECS     = 26
NATIVE {TDERR_BadSecHdr}      CONST TDERR_BADSECHDR      = 27
NATIVE {TDERR_WriteProt}      CONST TDERR_WRITEPROT      = 28
NATIVE {TDERR_DiskChanged}    CONST TDERR_DISKCHANGED    = 29
NATIVE {TDERR_SeekError}      CONST TDERR_SEEKERROR      = 30
NATIVE {TDERR_NoMem}          CONST TDERR_NOMEM          = 31
NATIVE {TDERR_BadUnitNum}     CONST TDERR_BADUNITNUM     = 32
NATIVE {TDERR_BadDriveType}   CONST TDERR_BADDRIVETYPE   = 33
NATIVE {TDERR_DriveInUse}     CONST TDERR_DRIVEINUSE     = 34
NATIVE {TDERR_PostReset}      CONST TDERR_POSTRESET      = 35
