/* cGfxSprites.e 24-05-2014
	A set of classes which provide a layered sprite interface for games & multimedia.


Copyright (c) 2010, 2011, 2012, 2013, 2014 Christopher Steven Handley ( http://cshandley.co.uk/email )
All rights reserved.

Redistribution and use in source and binary forms, with or without modification,
are permitted provided that the following conditions are met:

* The source code must not be modified after it has been translated or converted
away from the PortablE programming language.  For clarification, the intention
is that all development of the source code must be done using the PortablE
programming language (as defined by Christopher Steven Handley).

* Redistributions of source code must retain the above copyright notice, this
list of conditions and the following disclaimer.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR
TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/ 

PUBLIC MODULE 'std/cGfx','std/cApp'
MODULE 'std/pBox','CSH/cNumberSpace','CSH/cStaticStringNumberPairSpace'
PRIVATE
CLASS q OF cAppClient;ENDCLASS
PUBLIC
CLASS cGfxSprite OF cGfxNotifyOfDrawableChanges;PRIVATE;q:PTR TO cGfxDrawable;qq;qqp;qqq:BOOL;qqpp:BOOL;qqpq:BOOL ;qqqp:BOOL;qqqq:PTR TO cNumberSpace ;qqppp;qqppq;qqpqp:PTR TO class ;qqpqq:PTR TO cGfxLayer;qqqpp:PTR TO cGfxSprite ;qqqpq:PTR TO cGfxSprite;ENDCLASS
CLASS cGfxLayer;PRIVATE;q:PTR TO cGfxSprite ;qq;qqp;qqq:BOOL;qqpp:PTR TO cGfxStack;qqpq:PTR TO cGfxLayer ;qqqp:PTR TO cGfxLayer;ENDCLASS
PRIVATE
CLASS qq OF cGfxNotifyOfWindowResize;stack:PTR TO cGfxStack;ENDCLASS
PUBLIC
CLASS cGfxStack OF cAppResource;PRIVATE;q:PTR TO cGfxLayer ;qq:PTR TO cGfxWindow;qqp:PTR TO qqp;qqq;qqpp:BOOL;qqpq:BYTE;qqqp;qqqq;qqppp;qqppq;qqpqp:BOOL;qqpqq:BOOL;qqqpp:PTR TO qq;qqqpq:BOOL;qqqqp:BOOL;qqqqq:BOOL;qqpppp;qqpppq;qqppqp;qqppqq;qqpqpp:BOOL;qqpqpq;qqpqqp;qqpqqq:PTR TO cStaticStringNumberPairSpace;ENDCLASS
PRIVATE
CLASS qqp OF cGfxLayer;PRIVATE;qqqq:PTR TO cGfxSprite ;ENDCLASS
DEF q:PTR TO q,qq:ARRAY OF CHAR,qqp:ARRAY OF CHAR,qqq:ARRAY OF CHAR,qqpp:ARRAY OF CHAR,qqpq:ARRAY OF CHAR,qqqp:ARRAY OF CHAR,qqqq:ARRAY OF CHAR,qqppp:ARRAY OF CHAR,qqppq:ARRAY OF CHAR,qqpqp:ARRAY OF CHAR,qqpqq:ARRAY OF CHAR,qqqpp:ARRAY OF CHAR,qqqpq:ARRAY OF CHAR,qqqqp:ARRAY OF CHAR,qqqqq:ARRAY OF CHAR,qqpppp:ARRAY OF CHAR,qqpppq:ARRAY OF CHAR,qqppqp:ARRAY OF CHAR,qqppqq:ARRAY OF CHAR,qqpqpp:ARRAY OF CHAR
PROC new();; qq := 'CreateGfxStack(); gfx=NIL'; qqp := 'cGfxSprite.drawableHasChanged(); unknown drawable'; qqq := 'cGfxSprite.setDrawable(); drawable=NIL'; qqpp := 'cGfxSprite.setDrawable(); the supplied drawable belongs to a different window'; qqpq := 'cGfxSprite.changeAllVisibleCounts(); frames is empty'; qqqp := 'cGfxLayer.createSprite(); drawable=NIL'; qqqq := 'cGfxLayer.findSpriteAt(); lastMatch was not from this layer'; qqppp := 'cGfxLayer.findSpriteOverlapping(); lastMatch was not from this layer'; qqppq := 'cGfxLayer.infoTopSprite(); layer has no sprites'; qqpqp := 'cGfxLayer.infoBottomSprite(); layer has no sprites'; qqpqq := 'cGfxStack.updateMax(); region not at default'; qqqpp := 'cGfxStack.destroyLayer(); cannot destroy the only layer'; qqqpq := 'cGfxStack.destroyLayer(); cannot destroy the background layer'; qqqqp := 'ERROR: There was already a sprite with name=\a\s\a & number=\d\n'; qqqqq := 'cGfxStack.storeSprite(); you have already stored a sprite with that name/number'; qqpppp := 'cGfxWindow.useSprite(); there was no sprite matching that name/number'; qqpppq := 'cGfxStack.setRegion(); window is not open'; qqppqp := 'cGfxStack.setRegion(); width<0'; qqppqq := 'cGfxStack.setRegion(); height<0'; qqpqpp := 'cGfxStack.getRegion(); window is not open'; NEW q.new(); appHost.registerClient(q);ENDPROC
PROC end();; END q;ENDPROC
PUBLIC
PROC CreateGfxStack(qqpqpq:PTR TO cGfxWindow) ;DEF qqpqqp:PTR TO cGfxStack,qqpqqq:PTR TO cGfxStack; IF qqpqpq = (8577676 XOR $82E28C) THEN Throw("EPU", qq ); NEW qqpqqq.q(qqpqpq); qqpqqp := qqpqqq; q.add(PASS qqpqqq);ENDPROC qqpqqp 
PROC DestroyGfxStack(qqpqpq:PTR TO cGfxStack) ;DEF qqpqqp:PTR TO cGfxStack,qqpqqq:PTR TO cAppResource; qqpqqp := NIL; IF qqpqpq = (42724 XOR $A6E4) THEN RETURN; qqpqqq := q.rem(qqpqpq); END qqpqqq;ENDPROC qqpqqp 
PRIVATE
PROC q(qqpqpq:PTR TO cGfxSprite, qqpqqp, qqpqqq, qqqppp=362856 XOR $58968, qqqppq=29679129 XOR $1C4DE19);DEF qqqpqp,qqqpqq,qqqqpp,qqqqpq,qqqqqp,qqqqqq,qqppppp,qqppppq; IF qqpqpq.qqq = (91600649 XOR $575B709); qqqpqp := qqpqpq.q.infoWidth(); IF qqqppp = (110276815 XOR $692B0CF) THEN qqqppp := qqqpqp; qqppppp := qqpqpq.qq; qqqqqp := qqppppp + qqqpqp - (332484 XOR $512C5); qqqqpp := qqpqqp + qqqppp - (8073841 XOR $7B3270); ELSE; qqppppp := qqpqpq.qqpqq.qqpp.qqqp - qqpqpq.qqpqq.qq; qqqqqp := qqpqpq.qqpqq.qqpp.qqppp - qqpqpq.qqpqq.qq; qqpqqp := qqppppp; qqqqpp := qqqqqp; ENDIF; IF qqpqpq.qqpp = (8219878 XOR $7D6CE6); qqqpqq := qqpqpq.q.infoHeight(); IF qqqppq = (2641284 XOR $284D84) THEN qqqppq := qqqpqq; qqppppq := qqpqpq.qqp; qqqqqq := qqppppq + qqpqpq.q.infoHeight() - (659831524 XOR $27543AE5); qqqqpq := qqpqqq + qqqppq - (497915020 XOR $1DAD948D); ELSE; qqppppq := qqpqpq.qqpqq.qqpp.qqqq - qqpqpq.qqpqq.qqp; qqqqqq := qqpqpq.qqpqq.qqpp.qqppq - qqpqpq.qqpqq.qqp; qqpqqq := qqppppq; qqqqpq := qqqqqq; ENDIF; qqpqpq.qqpqq.qqppp(Min(qqpqqp,qqppppp), Min(qqpqqq,qqppppq), Max(qqqqpp,qqqqqp), Max(qqqqpq,qqqqqq));ENDPROC
PUBLIC
PROC new() NEW OF q;;ENDPROC
PROC reset() OF q;;ENDPROC
PROC finishBuilding(qqpqpq:PTR TO cApp) OF q;;ENDPROC
PROC appIsBuilt(qqpqpq:PTR TO cApp) OF q;;ENDPROC
PRIVATE
PROC q(qqpqpq:PTR TO cGfxLayer, qqpqqp:PTR TO cGfxDrawable, qqpqqq, qqqppp, qqqppq=6123749 XOR $5D70E5:BOOL) NEW OF cGfxSprite;; self.q := qqpqqp; self.qq := qqpqqq; self.qqp := qqqppp; self.qqq := 476448 XOR $74520; self.qqpp := 885979708 XOR $34CEFA3C; self.qqpq := 5728162 XOR $5767A2; self.qqqp := qqqppq; self.qqqq := NIL; self.qqppp := 54905962 XOR $345CC6A ; self.qqppq := 439001 XOR $6B2D9; self.qqpqp := NIL; self.qqpqq := qqpqpq; self.qqqpp :=  self; self.qqqpq := self; self.q.changeUseCount(852111 XOR $D008E); IF self.qqpqq.qqq; self.qqpq := self.qqpp(); self.q.changeVisibleCount(IF self.qqpq THEN (74687080 XOR $473A269) ELSE (375090044 XOR $165B6B7C)); ENDIF; self.q.registerForChanges(self);ENDPROC
PUBLIC
PROC end() OF cGfxSprite;; IF self.qqpq THEN self.qqq(-(397463 XOR $61096)); END self.qqqq; END self.qqpqp; IF self.qqpqq.qqpp.qqpqqq THEN self.qqpqq.qqpp.qqpqqq.remove(self); IF self.qqqpp; self.qqqpp.qqqpq := self.qqqpq; self.qqqpq.qqqpp := PASS self.qqqpp; ENDIF; SUPER self.end();ENDPROC
PROC drawableHasChanged(qqpqpq, qqpqqp, qqpqqq:PTR TO cGfxDrawable) OF cGfxSprite;; IF qqpqqq <> self.q THEN Throw("BUG", qqp ); self.qqp(); IF self.qqqp = (401526920 XOR $17EED088) THEN q(self, self.qq, self.qqp, qqpqpq, qqpqqp);ENDPROC
PROC infoWidth() OF cGfxSprite RETURNS qqpqpq IS self.q.infoWidth()
PROC infoHeight() OF cGfxSprite RETURNS qqpqpq IS self.q.infoHeight()
PROC infoLayer() OF cGfxSprite RETURNS qqpqpq:PTR TO cGfxLayer  IS self.qqpqq
PROC infoAbove() OF cGfxSprite RETURNS qqpqpq:PTR TO cGfxSprite  IS self.qqqpq
PROC infoBelow() OF cGfxSprite RETURNS qqpqpq:PTR TO cGfxSprite  IS self.qqqpp
PROC infoIsInsideRegion(qqpqpq=534446588 XOR $1FDB01FC:BOOL) OF cGfxSprite;DEF qqpqqp:BOOL,qqpqqq,qqqppp,qqqppq,qqqpqp,qqqpqq:PTR TO cGfxStack; qqpqqq := self.qqpqq.qq + self.qq; qqqppp := self.qqpqq.qqp + self.qqp; qqqppq := qqpqqq + self.q.infoWidth() - (72780340 XOR $4568A35); qqqpqp := qqqppp + self.q.infoHeight() - (123924 XOR $1E415); qqqpqq := self.qqpqq.qqpp; IF qqpqpq = (8043053 XOR $7ABA2D); IF qqqppq >= qqqpqq.qqqp  AND (qqpqqq <= qqqpqq.qqppp); qqpqqp := qqqpqp >= qqqpqq.qqqq  AND (qqqppp <= qqqpqq.qqppq); ELSE; qqpqqp := 456042 XOR $6F56A; ENDIF; ELSE; IF qqpqqq >= qqqpqq.qqqp  AND (qqqppq <= qqqpqq.qqppp); qqpqqp := qqqppp >= qqqpqq.qqqq  AND (qqqpqp <= qqqpqq.qqppq); ELSE; qqpqqp := 203789 XOR $31C0D; ENDIF; ENDIF;ENDPROC qqpqqp 
PROC move(qqpqpq, qqpqqp) OF cGfxSprite IS self.setPosition(self.qq + qqpqpq, self.qqp + qqpqqp)
PROC setPosition(qqpqpq, qqpqqp) OF cGfxSprite;DEF qqpqqq,qqqppp; qqpqqq := self.qq; qqqppp := self.qqp; IF qqpqpq = qqpqqq  AND (qqpqqp = qqqppp) THEN RETURN; self.qq := qqpqpq; self.qqp := qqpqqp; self.qqp(); IF self.qqqp = (825768716 XOR $31383B0C) THEN q(self, qqpqqq, qqqppp);ENDPROC
PROC getPosition() OF cGfxSprite RETURNS qqpqpq,qqpqqp IS self.qq,self.qqp
PROC setHidden(qqpqpq:BOOL) OF cGfxSprite;; IF qqpqpq = self.qqqp THEN RETURN; self.qqqp := qqpqpq; self.qqp(); q(self, self.qq, self.qqp);ENDPROC
PROC getHidden() OF cGfxSprite IS self.qqqp
PROC setDrawable(qqpqpq:PTR TO cGfxDrawable, qqpqqp=122966 XOR $1E056) OF cGfxSprite;DEF qqpqqq,qqqppp,qqqppq:PTR TO cGfxDrawable; IF qqpqpq = (231534 XOR $3886E) THEN Throw("EMU", qqq ); IF qqpqpq.infoWindow() <> self.qqpqq.qqpp.qq THEN Throw("EMU", qqpp ); qqpqqq := self.q.infoWidth(); qqqppp := self.q.infoHeight(); IF qqpqqp = (87652797 XOR $53979BD)  AND (self.qqqq = (442537 XOR $6C0A9)); qqqppq := self.q; ELSE; IF self.qqqq = (1293805 XOR $13BDED); NEW self.qqqq.new(); self.qqqq.set(760096 XOR $B9920, self.q); ENDIF; qqqppq := self.qqqq.set(qqpqqp, qqpqpq)::cGfxDrawable; ENDIF; IF qqqppq; qqqppq.changeUseCount(-(481992 XOR $75AC9)); IF self.qqpq THEN qqqppq.changeVisibleCount(-(223007 XOR $3671E)); ENDIF; qqpqpq.changeUseCount(3470188 XOR $34F36D); IF self.qqpq; qqpqpq.changeVisibleCount(22977209 XOR $15E9AB8) ; ELSE; IF self.qqpqq.qqq THEN qqpqpq.changeVisibleCount(6302641 XOR $602BB1); ENDIF; IF qqpqqp = self.qqppp; self.q.unregisterForChanges(self); self.q := qqpqpq; self.q.registerForChanges(self); self.qqp(); ENDIF; IF self.qqqp = (4474318 XOR $4445CE) THEN q(self, self.qq, self.qqp, qqpqqq, qqqppp);ENDPROC
PROC getDrawable(qqpqpq=46916489 XOR $2CBE389) OF cGfxSprite;DEF qqpqqp:PTR TO cGfxDrawable; IF qqpqpq = self.qqppp; qqpqqp := self.q; ELSE IF self.qqqq; qqpqqp := self.qqqq.get(qqpqpq)::cGfxDrawable; ELSE; qqpqqp := NIL; ENDIF;ENDPROC qqpqqp 
PROC setFrame(qqpqpq) OF cGfxSprite;DEF qqpqqp:BOOL,qqpqqq,qqqppp,qqqppq:PTR TO cGfxDrawable; IF qqpqpq = self.qqppp THEN RETURN 75780884 XOR -$4845315; IF self.qqqq = (227789 XOR $379CD); qqpqqp := 4651681 XOR $46FAA1; ELSE IF qqqppq := self.qqqq.get(qqpqpq)::cGfxDrawable; qqpqqq := self.q.infoWidth(); qqqppp := self.q.infoHeight(); self.q.unregisterForChanges(self); self.q := qqqppq; self.q.registerForChanges(self); self.qqp(); IF self.qqqp = (276775716 XOR $107F4324) THEN q(self, self.qq, self.qqp, qqpqqq, qqqppp); self.qqppp := qqpqpq; qqpqqp := 6310740 XOR -$604B55; ELSE; qqpqqp := 38048687 XOR $24493AF; ENDIF;ENDPROC qqpqqp 
PROC getFrame() OF cGfxSprite RETURNS qqpqpq IS self.qqppp
PROC setTiled(qqpqpq:BOOL, qqpqqp:BOOL) OF cGfxSprite;DEF qqpqqq,qqqppp,qqqppq,qqqpqp; IF self.qqq = (172355 XOR $2A143); qqpqqq := self.qq; qqqppq := self.q.infoWidth(); ELSE; qqpqqq := self.qqpqq.qqpp.qqqp; qqqppq := self.qqpqq.qqpp.qqppp - qqpqqq + (110621014 XOR $697F157); ENDIF; IF self.qqpp = (169353344 XOR $A182080); qqqppp := self.qqp; qqqpqp := self.q.infoHeight(); ELSE; qqqppp := self.qqpqq.qqpp.qqqq; qqqpqp := self.qqpqq.qqpp.qqppq - qqqppp + (4668919 XOR $473DF6); ENDIF; self.qqq := qqpqpq; self.qqpp := qqpqqp; IF self.qqqp = (6129776 XOR $5D8870) THEN q(self, qqpqqq, qqqppp, qqqppq, qqqpqp);ENDPROC
PROC getTiled() OF cGfxSprite RETURNS qqpqpq:BOOL,qqpqqp:BOOL  IS self.qqq,self.qqpp
PROC setData(qqpqpq) OF cGfxSprite;; self.qqppq := qqpqpq; END self.qqpqp;ENDPROC
PROC getData() OF cGfxSprite RETURNS qqpqpq IS self.qqppq
PROC setDataBox(qqpqpq:PTR TO class) OF cGfxSprite;; END self.qqpqp; self.qqppq := 1519883744 XOR $5A9795E0; self.qqpqp := PASS qqpqpq;ENDPROC
PROC getDataBox() OF cGfxSprite RETURNS qqpqpq:PTR TO class  IS self.qqpqp
PROC setDataPtr(qqpqpq:PTR) OF cGfxSprite IS self.setDataBox(BoxPTR(qqpqpq))
PROC getDataPtr() OF cGfxSprite RETURNS qqpqpq:PTR  IS UnboxPTR(self.getDataBox())
PRIVATE
PROC qq() OF cGfxSprite;; IF self.qqpqq.qqq; self.qqp(1641341528 XOR -$61D4E259); ELSE; IF self.qqpq; self.qqpq := 1846041008 XOR $6E0859B0; self.qqq(-(61369555 XOR $3A86CD2), 1179800240 XOR -$465252B1) ; ENDIF; ENDIF;ENDPROC
PROC qqp(qqpqpq=404766408 XOR $18203EC8:BOOL) OF cGfxSprite;DEF qqpqqp:BOOL; IF self.qqpqq.qqq; qqpqqp := self.qqpp(); IF self.qqpq <> qqpqqp; self.qqpq := qqpqqp; self.qqq(IF self.qqpq THEN (64959752 XOR $3DF3509) ELSE -(348584 XOR $551A9)); ELSE IF qqpqpq; self.qqq(3925 XOR $F55); ENDIF; ENDIF;ENDPROC
PROC qqq(qqpqpq, qqpqqp=1206976312 XOR $47F0FF38:BOOL) OF cGfxSprite;DEF qqpqqq:PTR TO cNumberSpace,qqqppp:PTR TO cGfxDrawable; IF self.qqqq = (1158630340 XOR $450F4BC4); qqqppp := self.q; qqqppp.changeVisibleCount(qqpqpq); IF qqpqpq <= (18947 XOR $4A03)  AND qqpqqp THEN IF qqqppp.infoVisibleCount() = (7537784 XOR $730478) THEN IF qqqppp.IsOfClassType(TYPEOF cGfxBitmap) THEN qqqppp::cGfxBitmap.setIsDrawable(79024240 XOR -$4B5D071); ELSE; qqpqqq := self.qqqq; IF qqpqqq.itemGotoFirst() = (169293 XOR $2954D) THEN Throw("BUG", qqpq ); REPEAT; qqqppp := qqpqqq.itemInfo()::cGfxDrawable; qqqppp.changeVisibleCount(qqpqpq); IF qqpqpq <= (48513454 XOR $2E441AE)  AND qqpqqp THEN IF qqqppp.infoVisibleCount() = (34619441 XOR $2104031) THEN IF qqqppp.IsOfClassType(TYPEOF cGfxBitmap) THEN qqqppp::cGfxBitmap.setIsDrawable(360123 XOR -$57EBC); UNTIL qqpqqq.itemGotoNext() = (1809373888 XOR $6BD8DAC0); ENDIF;ENDPROC
PROC qqpp() OF cGfxSprite;DEF qqpqpq:BOOL,qqpqqp,qqpqqq,qqqppp,qqqppq,qqqpqp:PTR TO cGfxStack; qqqpqp := self.qqpqq.qqpp; IF qqqpqp.qq.infoIsOpen() = (602661 XOR $93225) THEN RETURN 1919618 XOR $1D4A82 ; IF self.qqqp THEN RETURN 134264 XOR $20C78; IF qqqpqp.qqppp = -(25740732 XOR $188C5BD) THEN qqqpqp.qq(); IF self.qqq = (738740 XOR $B45B4); qqpqqp := self.qq + self.qqpqq.qq; qqqppp := qqpqqp + self.q.infoWidth() - (316900 XOR $4D5E5); ELSE; qqpqqp := qqqpqp.qqqp; qqqppp := qqqpqp.qqppp; ENDIF; IF self.qqpp = (1294021660 XOR $4D21341C); qqpqqq := self.qqp + self.qqpqq.qqp; qqqppq := qqpqqq + self.q.infoHeight() - (32704124 XOR $1F3067D); ELSE; qqpqqq := qqqpqp.qqqq; qqqppq := qqqpqp.qqppq; ENDIF; IF qqpqqp <= qqqpqp.qqppp  AND (qqqppp >= qqqpqp.qqqp); qqpqpq := qqpqqq <= qqqpqp.qqppq  AND (qqqppq >= qqqpqp.qqqq); ELSE; qqpqpq := 4661058 XOR $471F42; ENDIF;ENDPROC qqpqpq 
PROC qqpq(qqpqpq, qqpqqp) OF cGfxSprite;DEF qqpqqq:BOOL,qqqppp,qqqppq,qqqpqp,qqqpqq; IF self.qqqp THEN RETURN 1656171776 XOR $62B72D00; qqqppp := qqpqpq - self.qq ; qqqpqp := self.q.infoWidth(); qqqppq := qqpqqp - self.qqp ; qqqpqq := self.q.infoHeight(); IF self.qqq THEN qqqppp := FastMod(qqqppp,qqqpqp ) + (IF qqqppp < (115108926 XOR $6DC6C3E) THEN qqqpqp ELSE (164071 XOR $280E7)); IF self.qqpp THEN qqqppq := FastMod(qqqppq,qqqpqq) + (IF qqqppq < (3716266 XOR $38B4AA) THEN qqqpqq ELSE (1564878444 XOR $5D46266C)); IF qqqppp >= (192611 XOR $2F063)  AND (qqqppp < qqqpqp) AND (qqqppq >= (404008992 XOR $1814B020)) AND (qqqppq < qqqpqq); qqpqqq := self.q.hitCheck(qqqppp, qqqppq); ELSE; qqpqqq := 1071229392 XOR $3FD9A9D0; ENDIF;ENDPROC qqpqqq 
PUBLIC
PROC overlaps(qqpqpq:PTR TO cGfxSprite) OF cGfxSprite;DEF qqpqqp:BOOL,qqpqqq,qqqppp,qqqppq,qqqpqp,qqqpqq,qqqqpp,qqqqpq,qqqqqp; IF self.qqqp OR qqpqpq.qqqp THEN RETURN 261060 XOR $3FBC4; IF self.qqpqq.qqpp <> qqpqpq.qqpqq.qqpp THEN RETURN 4719806 XOR $4804BE; IF self.qqpqq = qqpqpq.qqpqq; qqpqqq := qqpqpq.qq - self.qq; qqqpqq := qqpqpq.qqp - self.qqp; ELSE; qqpqqq := qqpqpq.qqpqq.qq + qqpqpq.qq  - (self.qqpqq.qq + self.qq); qqqpqq := qqpqpq.qqpqq.qqp + qqpqpq.qqp  - (self.qqpqq.qqp + self.qqp); ENDIF; IF self.qqq OR self.qqpp OR qqpqpq.qqq OR qqpqpq.qqpp = (493534 XOR $787DE); qqpqqp := self.q.overlaps(qqpqpq.q, qqpqqq, qqqpqq); ELSE; IF self.qqq AND qqpqpq.qqq; qqqpqp := Min(self.q.infoWidth(), qqpqpq.q.infoWidth()); qqqppp := FastMod(qqpqqq,qqqpqp) - (IF qqpqqq > (61140720 XOR $3A4EEF0) THEN qqqpqp ELSE (1810853260 XOR $6BEF6D8C)); qqqppq := Max(qqpqpq.q.infoWidth(), self.q.infoWidth()) - (64215851 XOR $3D3DB2A); ELSE IF self.qqq; qqqpqp := self.q.infoWidth(); qqqppp := FastMod(qqpqqq,qqqpqp) - (IF qqpqqq > (165983 XOR $2885F) THEN qqqpqp ELSE (1330498800 XOR $4F4DCCF0)); qqqppq := qqpqpq.q.infoWidth() - (21073951 XOR $141901E); ELSE IF qqpqpq.qqq; qqqpqp := qqpqpq.q.infoWidth(); qqqppp := FastMod(qqpqqq,qqqpqp) - (IF qqpqqq > (70531768 XOR $4343AB8) THEN qqqpqp ELSE (20452261 XOR $13813A5)); qqqppq := self.q.infoWidth() - (4826136 XOR $49A419); ELSE; qqqpqp := 4577009 XOR $45D6F0; qqqppp := qqpqqq; qqqppq := qqpqqq; ENDIF; IF self.qqpp AND qqpqpq.qqpp; qqqqqp := Min(self.q.infoHeight(), qqpqpq.q.infoHeight()); qqqqpp := FastMod(qqqpqq,qqqqqp) - (IF qqqpqq > (301206 XOR $49896) THEN qqqqqp ELSE (6253797 XOR $5F6CE5)); qqqqpq := Max(qqpqpq.q.infoHeight(), self.q.infoHeight()) - (236391 XOR $39B66); ELSE IF self.qqpp; qqqqqp := self.q.infoHeight(); qqqqpp := FastMod(qqqpqq,qqqqqp) - (IF qqqpqq > (146643 XOR $23CD3) THEN qqqqqp ELSE (112378287 XOR $6B2C1AF)); qqqqpq := qqpqpq.q.infoHeight() - (930050688 XOR $376F7281); ELSE IF qqpqpq.qqpp; qqqqqp := qqpqpq.q.infoHeight(); qqqqpp := FastMod(qqqpqq,qqqqqp) - (IF qqqpqq > (145376 XOR $237E0) THEN qqqqqp ELSE (290658 XOR $46F62)); qqqqpq := self.q.infoHeight() - (191083 XOR $2EA6A); ELSE; qqqqqp := 2721923 XOR $298882; qqqqpp := qqqpqq; qqqqpq := qqqpqq; ENDIF; qqpqqp := 683781100 XOR $28C1ABEC; FOR qqqpqq := qqqqpp TO qqqqpq STEP qqqqqp; FOR qqpqqq := qqqppp TO qqqppq STEP qqqpqp; qqpqqp := qqpqqp OR self.q.overlaps(qqpqpq.q, qqpqqq, qqqpqq); ENDFOR IF qqpqqp; ENDFOR IF qqpqqp; ENDIF;ENDPROC qqpqqp 
PROC moveToBottomOfLayer() OF cGfxSprite;DEF qqpqpq:PTR TO cGfxSprite; qqpqpq := self.qqpqq.qqpq(self); self.qqpqq.qqpp(PASS qqpqpq, 455281 XOR -$6F272); IF self.qqqp = (15603334 XOR $EE1686) THEN q(self, self.qq, self.qqp);ENDPROC
PROC moveToTopOfLayer() OF cGfxSprite;DEF qqpqpq:PTR TO cGfxSprite; qqpqpq := self.qqpqq.qqpq(self); self.qqpqq.qqpp(PASS qqpqpq, 131312 XOR $200F0); IF self.qqqp = (881058 XOR $D71A2) THEN q(self, self.qq, self.qqp);ENDPROC
PROC clone() OF cGfxSprite;DEF qqpqpq:PTR TO cGfxSprite,qqpqqp:PTR TO cGfxDrawable,qqpqqq; qqpqpq := self.qqpqq.createSprite(self.qq, self.qqp, self.getDrawable(201329 XOR $31271), self.qqqp); qqpqpq.qqq := self.qqq; qqpqpq.qqpp := self.qqpp; qqpqpq.qqppq := self.qqppq; IF self.qqqq; IF self.qqqq.itemGotoFirst(); REPEAT; qqpqqp, qqpqqq := self.qqqq.itemInfo()::cGfxDrawable; IF qqpqqq <> (315735 XOR $4D157) THEN qqpqpq.setDrawable(qqpqqp, qqpqqq); UNTIL self.qqqq.itemGotoNext() = (6096764 XOR $5D077C); ENDIF; ENDIF; qqpqpq.setFrame(self.qqppp);ENDPROC qqpqpq 
PRIVATE
PROC qqqp() OF cGfxSprite;; IF self.qqpq = (1914449336 XOR $721C2DB8)  AND self.qqpqq.qqq THEN RETURN; IF self.qqqp THEN RETURN; IF self.qqq OR self.qqpp = (6849729 XOR $6884C1); self.q.draw(self.qqpqq.qq + self.qq, self.qqpqq.qqp + self.qqp); ELSE; self.q.drawTiled(self.qqpqq.qq + self.qq, self.qqpqq.qqp + self.qqp, self.qqq, self.qqpp); ENDIF;ENDPROC
PROC new(qqpqpq:PTR TO cGfxStack) NEW OF cGfxLayer;; self.q := NIL; self.qq := 1501316 XOR $16E884; self.qqp := 1148128756 XOR $446F0DF4; self.qqq := qqpqpq.qqqpq; self.qqpp := qqpqpq; self.qqpq :=  self; self.qqqp := self;ENDPROC
PUBLIC
PROC end() OF cGfxLayer;DEF qqpqpq:PTR TO cGfxSprite,qqpqqp:PTR TO cGfxSprite; IF self.q; qqpqqp := PASS self.q.qqqpp; REPEAT; qqpqpq := PASS qqpqqp; qqpqqp := PASS qqpqpq.qqqpp; END qqpqpq; UNTIL qqpqqp = (7490563 XOR $724C03); ENDIF; IF self.qqpq; self.qqpq.qqqp := self.qqqp; self.qqqp.qqpq := PASS self.qqpq; ENDIF; SUPER self.end();ENDPROC
PRIVATE
PROC q(qqpqpq, qqpqqp) OF cGfxLayer;DEF qqpqqq:PTR TO cGfxSprite; IF qqpqpq = (397799 XOR $611E7)  AND (qqpqqp = (39754819 XOR $25E9C43)) THEN RETURN; IF qqpqqq := self.q; REPEAT; qqpqqq.qq := qqpqqq.qq + qqpqpq; qqpqqq.qqp := qqpqqq.qqp + qqpqqp; qqpqqq := qqpqqq.qqqpp; UNTIL qqpqqq = self.q; ENDIF;ENDPROC
PUBLIC
PROC scrollSprites(qqpqpq, qqpqqp) OF cGfxLayer;DEF qqpqqq:PTR TO cGfxSprite; IF qqpqpq = (2825039 XOR $2B1B4F)  AND (qqpqqp = (5067829 XOR $4D5435)) THEN RETURN; IF qqpqqq := self.q; REPEAT; qqpqqq.setPosition(qqpqqq.qq + qqpqpq, qqpqqq.qqp + qqpqqp); qqpqqq := qqpqqq.qqqpp; UNTIL qqpqqq = self.q; ENDIF;ENDPROC
PROC scrollLayer(qqpqpq, qqpqqp) OF cGfxLayer IS self.setOrigin(self.qq + qqpqpq, self.qqp + qqpqqp)
PRIVATE
PROC qq() OF cGfxLayer;DEF qqpqpq:PTR TO cGfxSprite; IF qqpqpq := self.q; REPEAT; qqpqpq.qq(); qqpqpq := qqpqpq.qqqpp; UNTIL qqpqpq = self.q; ENDIF;ENDPROC
PROC qqp() OF cGfxLayer;DEF qqpqpq:PTR TO cGfxSprite; IF self.qqq; IF qqpqpq := self.q; REPEAT; qqpqpq.qqp(); qqpqpq := qqpqpq.qqqpp; UNTIL qqpqpq = self.q; ENDIF; ENDIF;ENDPROC
PROC qqq(qqpqpq, qqpqqp) OF cGfxLayer;; self.qq := qqpqpq; self.qqp := qqpqqp; self.qqp();ENDPROC
PUBLIC
PROC setOrigin(qqpqpq, qqpqqp) OF cGfxLayer;; self.qqq(qqpqpq, qqpqqp); IF self.qqpp.qqppp = -(42273817 XOR $2850C18) THEN self.qqpp.qq(); self.qqpp.qqpp(self.qqpp.qqqp, self.qqpp.qqqq, self.qqpp.qqppp, self.qqpp.qqppq);ENDPROC
PROC getOrigin() OF cGfxLayer RETURNS qqpqpq,qqpqqp IS self.qq,self.qqp
PRIVATE
PROC qqpp(qqpqpq:PTR TO cGfxSprite, qqpqqp=2197737 XOR $2188E9:BOOL) OF cGfxLayer;DEF qqpqqq:PTR TO cGfxSprite; qqpqqq := qqpqpq; IF self.q = (1112384236 XOR $424DA2EC); self.q := qqpqpq; qqpqpq := NIL; ELSE; qqpqpq.qqqpq := self.q.qqqpq; qqpqpq.qqqpp := PASS self.q.qqqpq.qqqpp ; self.q.qqqpq.qqqpp := PASS qqpqpq; self.q.qqqpq := qqpqqq; IF qqpqqp = (1017987 XOR $F8883) THEN self.q := qqpqqq; ENDIF;FINALLY; END qqpqpq;ENDPROC qqpqqq 
PROC qqpq(qqpqpq:PTR TO cGfxSprite) OF cGfxLayer;DEF qqpqqp:PTR TO cGfxSprite; IF qqpqpq = self.q; self.q := qqpqpq.qqqpp; IF self.q = qqpqpq THEN self.q := NIL; ENDIF; qqpqpq.qqqpp.qqqpq := qqpqpq.qqqpq; qqpqqp := PASS qqpqpq.qqqpq.qqqpp; qqpqpq.qqqpq.qqqpp := PASS qqpqpq.qqqpp; qqpqpq.qqqpq := qqpqpq; qqpqpq.qqqpp := qqpqpq;ENDPROC qqpqqp 
PUBLIC
PROC createSprite(qqpqpq, qqpqqp, qqpqqq:PTR TO cGfxDrawable, qqqppp=466251 XOR $71D4B:BOOL) OF cGfxLayer;DEF qqqppq:PTR TO cGfxSprite,qqqpqp:PTR TO cGfxSprite; IF qqpqqq = (1108454976 XOR $4211AE40) THEN Throw("EMU", qqqp ); NEW qqqpqp.q(self, qqpqqq, qqpqpq, qqpqqp, qqqppp); qqqppq := self.qqpp(PASS qqqpqp); IF self.qqpp.qq.infoIsOpen() THEN IF qqqppp = (1195929836 XOR $474870EC) THEN q(qqqppq, qqpqpq, qqpqqp);FINALLY; END qqqpqp;ENDPROC qqqppq 
PROC findSpriteAt(qqpqpq, qqpqqp, qqpqqq=NIL:PTR TO cGfxSprite) OF cGfxLayer;DEF qqqppp:PTR TO cGfxSprite,qqqppq:PTR TO cGfxSprite; qqqppp := NIL; IF qqpqqq = (1300803 XOR $13D943); qqqppq := self.q; ELSE; IF qqpqqq.qqpqq <> self THEN Throw("EMU", qqqq ); qqqppq := qqpqqq.qqqpp; IF qqqppq = self.q THEN qqqppq := NIL ; qqpqqq := NIL; ENDIF; IF qqqppq; REPEAT; IF qqqppq.qqqp = (514104 XOR $7D838); IF qqqppq.qqpq(qqpqpq, qqpqqp) THEN qqqppp := qqqppq; ENDIF; qqqppq := qqqppq.qqqpp; UNTIL qqqppp <> (58245558 XOR $378C1B6)  OR (qqqppq = self.q); ENDIF;ENDPROC qqqppp 
PROC findSpriteOverlapping(qqpqpq:PTR TO cGfxSprite, qqpqqp=NIL:PTR TO cGfxSprite) OF cGfxLayer;DEF qqpqqq:PTR TO cGfxSprite,qqqppp:PTR TO cGfxSprite; qqpqqq := NIL; IF qqpqqp = (1615367128 XOR $60488BD8); qqqppp := self.q; ELSE; IF qqpqqp.qqpqq <> self THEN Throw("EMU", qqppp ); qqqppp := qqpqqp.qqqpp; IF qqqppp = self.q THEN qqqppp := NIL ; qqpqqp := NIL; ENDIF; IF qqqppp; REPEAT; IF qqqppp.qqqp = (7382473 XOR $70A5C9); IF qqqppp.overlaps(qqpqpq) THEN IF qqqppp <> qqpqpq THEN qqpqqq := qqqppp; ENDIF; qqqppp := qqqppp.qqqpp; UNTIL qqpqqq <> (269317468 XOR $100D755C)  OR (qqqppp = self.q); ENDIF;ENDPROC qqpqqq 
PROC infoAbove() OF cGfxLayer RETURNS qqpqpq:PTR TO cGfxLayer  IS self.qqqp
PROC infoBelow() OF cGfxLayer RETURNS qqpqpq:PTR TO cGfxLayer  IS self.qqpq
PROC infoHasSprites() OF cGfxLayer RETURNS qqpqpq:BOOL  IS self.q <> (253840 XOR $3DF90)
PROC infoTopSprite() OF cGfxLayer;DEF qqpqpq:PTR TO cGfxSprite; IF self.q = (175810 XOR $2AEC2) THEN Throw("EMU", qqppq ); qqpqpq := self.q;ENDPROC qqpqpq 
PROC infoBottomSprite() OF cGfxLayer;DEF qqpqpq:PTR TO cGfxSprite; IF self.q = (1211095632 XOR $482FDA50) THEN Throw("EMU", qqpqp ); qqpqpq := self.q.qqqpq;ENDPROC qqpqpq 
PRIVATE
PROC qqqp(qqpqpq:PTR TO cGfxLayer) OF cGfxLayer;; self.qqpq.qqqp := qqpqpq; qqpqpq.qqqp := self; qqpqpq.qqpq := PASS self.qqpq; self.qqpq := PASS qqpqpq; ; ;ENDPROC
PUBLIC
PROC createLayerBelow() OF cGfxLayer;DEF qqpqpq:PTR TO cGfxLayer,qqpqqp:PTR TO cGfxLayer; NEW qqpqqp.new(self.qqpp) ; qqpqpq := qqpqqp; self.qqqp(PASS qqpqqp);ENDPROC qqpqpq 
PROC setAutoIsDrawable(qqpqpq:BOOL) OF cGfxLayer;; IF self.qqq = qqpqpq THEN RETURN; self.qqq := qqpqpq; self.qq();ENDPROC
PROC getAutoIsDrawable() OF cGfxLayer RETURNS qqpqpq:BOOL  IS self.qqq
PRIVATE
PROC qqqq() OF cGfxLayer;DEF qqpqpq:PTR TO cGfxSprite,qqpqqp:PTR TO cGfxSprite; IF self.qqpp.qqppp = -(542182668 XOR $20510D0D) THEN self.qqpp.qq() ; IF self.q; qqpqqp := self.q.qqqpq; qqpqpq := qqpqqp; REPEAT; qqpqpq.qqqp(); qqpqpq := qqpqpq.qqqpq; UNTIL qqpqpq = qqpqqp; ENDIF;ENDPROC
PROC qqppp(qqpqpq, qqpqqp, qqpqqq, qqqppp) OF cGfxLayer IS self.qqpp.qqpp(self.qq + qqpqpq, self.qqp + qqpqqp, self.qq + qqpqqq, self.qqp + qqqppp)
PUBLIC
PROC new(qqpqpq:PTR TO cGfxStack) NEW OF qq;; self.stack := qqpqpq; qqpqpq.qq.registerForResizes(self);ENDPROC
PROC windowHasResized(qqpqpq, qqpqqp) OF qq;; self.stack.qqpq(qqpqpq, qqpqqp);ENDPROC
PRIVATE
PROC q(qqpqpq:PTR TO cGfxWindow) NEW OF cGfxStack;DEF qqpqqp:PTR TO cGfxLayer,qqpqqq:PTR TO qqp; self.qq := qqpqpq; self.qqq := 1242553324 XOR $4A8F5B6C; self.qqpp := 1784595588 XOR $6A5EC484; self.qqpq := 1202661920 XOR $47AF2A20; self.qqqp := 248120 XOR $3C938; self.qqqq := 1279964952 XOR $4C4AB718; IF qqpqpq.infoIsOpen(); self.qqppp := qqpqpq.infoWidth() - (38389434 XOR $249C6BB); self.qqppq := qqpqpq.infoHeight() - (3204496 XOR $30E591); ELSE; self.qqppp := -(132976948 XOR $7ED1135); self.qqppq := -(529445188 XOR $1F8EB145); ENDIF; self.qqpqp := 516180556 XOR -$1EC44A4D; self.qqpqq := 546969916 XOR -$209A193D; NEW self.qqqpp.new(self); self.qqqpq := 452044772 XOR -$1AF1A7E5; self.qqqqp := 65000176 XOR -$3DFD2F1; self.qqqqq := 31119 XOR $798F; self.qqpqpp := 92816223 XOR $588435F; NEW self.qqpqqq.new(); NEW qqpqqp.new(self); self.q := qqpqqp ; qqpqqp := NIL; NEW qqpqqq.new(self); self.qqp := qqpqqq; self.q.qqqp(PASS qqpqqq);FINALLY; END qqpqqp, qqpqqq;ENDPROC
PUBLIC
PROC end() OF cGfxStack;DEF qqpqpq:PTR TO cGfxLayer,qqpqqp:PTR TO cGfxLayer; self.qqqqp := 211078 XOR $33886 ; END self.qqqpp; END self.qqpqqq; qqpqqp := PASS self.q.qqpq; REPEAT; qqpqpq := PASS qqpqqp; qqpqqp := PASS qqpqpq.qqpq; END qqpqpq; UNTIL qqpqqp = (128075066 XOR $7A2453A); SUPER self.end();ENDPROC
PRIVATE
PROC qq() OF cGfxStack;DEF qqpqpq,qqpqqp; IF self.qqpqp AND self.qqpqq = (6057941 XOR $5C6FD5) THEN Throw("BUG", qqpqq ) ; IF self.qq.infoIsOpen(); qqpqpq := self.qqppp; qqpqqp := self.qqppq; self.qqppp := self.qq.infoWidth() - (1267387 XOR $1356BA); self.qqppq := self.qq.infoHeight() - (4151091 XOR $3F5732); IF self.qqppp <> qqpqpq  OR (self.qqppq <> qqpqqp); self.qqq(); ENDIF; ENDIF;ENDPROC
PUBLIC
PROC infoTopLayer() OF cGfxStack RETURNS qqpqpq:PTR TO cGfxLayer  IS self.q
PROC infoBottomLayer() OF cGfxStack RETURNS qqpqpq:PTR TO cGfxLayer  IS self.q.qqqp
PROC destroyLayer(qqpqpq:PTR TO cGfxLayer) OF cGfxStack;DEF qqpqqp:PTR TO cGfxLayer,qqpqqq:PTR TO cGfxLayer; qqpqqp := NIL; IF qqpqpq = (5977814 XOR $5B36D6) THEN RETURN; IF qqpqpq.qqpq = qqpqpq THEN Throw("EMU", qqqpp ); IF qqpqpq = self.qqp THEN Throw("EMU", qqqpq ); IF self.q = qqpqpq THEN self.q := qqpqpq.qqpq; qqpqqq := PASS qqpqpq.qqqp.qqpq; END qqpqqq; IF self.qqppp = -(7713264 XOR $75B1F1) THEN self.qq(); self.qqpp(self.qqqp, self.qqqq, self.qqppp, self.qqppq);ENDPROC qqpqqp 
PROC destroySprite(qqpqpq:PTR TO cGfxSprite) OF cGfxStack;DEF qqpqqp:PTR TO cGfxSprite ,qqpqqq:PTR TO cGfxSprite; qqpqqp := NIL; IF qqpqpq = (373813 XOR $5B435) THEN RETURN; IF self.qq.infoIsOpen() THEN qqpqpq.setHidden(6899632 XOR -$6947B1) ; qqpqqq := qqpqpq.qqpqq.qqpq(qqpqpq); END qqpqqq;ENDPROC qqpqqp 
PROC findSpriteAt(qqpqpq, qqpqqp, qqpqqq=NIL:PTR TO cGfxSprite) OF cGfxStack;DEF qqqppp:PTR TO cGfxSprite,qqqppq:PTR TO cGfxLayer,qqqpqp,qqqpqq; qqqppp := NIL; qqqppq := IF qqpqqq THEN qqpqqq.qqpqq ELSE self.q; REPEAT; qqqpqp, qqqpqq := qqqppq.getOrigin() ; qqqppp := qqqppq.findSpriteAt(qqpqpq - qqqpqp, qqpqqp - qqqpqq, qqpqqq); qqpqqq := NIL; qqqppq := qqqppq.qqpq; UNTIL qqqppp <> (94278435 XOR $59E9323)  OR (qqqppq = self.q); IF qqqppp = self.qqp.qqqq THEN qqqppp := NIL;ENDPROC qqqppp 
PROC findSpriteOverlapping(qqpqpq:PTR TO cGfxSprite, qqpqqp=NIL:PTR TO cGfxSprite) OF cGfxStack;DEF qqpqqq:PTR TO cGfxSprite,qqqppp:PTR TO cGfxLayer; qqpqqq := NIL; qqqppp := IF qqpqqp THEN qqpqqp.qqpqq ELSE self.q; REPEAT; qqpqqq := qqqppp.findSpriteOverlapping(qqpqpq, qqpqqp); qqpqqp := NIL; qqqppp := qqqppp.qqpq; UNTIL qqpqqq <> (1303066336 XOR $4DAB36E0)  OR (qqqppp = self.q);ENDPROC qqpqqq 
PROC storeSprite(qqpqpq:ARRAY OF CHAR, qqpqqp, qqpqqq:PTR TO cGfxSprite) OF cGfxStack;DEF qqqppp:PTR TO cGfxSprite,qqqppq; IF qqpqqq; qqqppq := self.qqpqqq.set(qqpqpq, qqpqqp, qqpqqq); ELSE; qqqppq := self.qqpqqq.get(qqpqpq, qqpqqp, 989928 XOR -$F1AE9) ; ENDIF; IF qqqppq; Print(qqqqp , qqpqpq, qqpqqp); Throw("EMU", qqqqq ); ENDIF; qqqppp := qqpqqq;ENDPROC qqqppp 
PROC useSprite(qqpqpq:ARRAY OF CHAR, qqpqqp, qqpqqq=105361870 XOR $647B1CE:BOOL) OF cGfxStack;DEF qqqppp:PTR TO cGfxSprite; qqqppp := self.qqpqqq.get(qqpqpq, qqpqqp)::cGfxSprite; IF qqpqqq = (517588 XOR $7E5D4); IF qqqppp = (34975476 XOR $215AEF4) THEN Throw("EMU", qqpppp ); ENDIF;ENDPROC qqqppp 
PROC setBackgroundColour(qqpqpq) OF cGfxStack;; self.qqq := qqpqpq; IF self.qqpp = (2354850 XOR $23EEA2); IF self.qqppp = -(316530 XOR $4D473) THEN self.qq(); self.qqpp(self.qqqp, self.qqqq, self.qqppp, self.qqppq); ENDIF;ENDPROC
PROC getBackgroundColour() OF cGfxStack RETURNS qqpqpq IS self.qqq
PROC setBackgroundDrawable(qqpqpq=NIL:PTR TO cGfxDrawable, qqpqqp=6014768 XOR $5BC730, qqpqqq=384035 XOR $5DC23, qqqppp=90141190 XOR $55F7206:BOOL, qqqppq=239817 XOR $3A8C9:BOOL, qqqpqp=60506570 XOR $39B41CA:BOOL, qqqpqq=1691644 XOR $19CFFC:BOOL) OF cGfxStack;; self.qqp.setDrawable(qqpqpq, qqpqqp, qqpqqq, qqqppp, qqqppq); IF qqpqpq = (454357 XOR $6EED5); self.qqpq := 459985 XOR $704D1; ELSE; self.qqpq := (IF qqqpqp THEN (101522449 XOR $60D1C10) ELSE (372038088 XOR $162CD9C8)) + (IF qqqpqq THEN (341260 XOR $5350E) ELSE (1879147040 XOR $70018220)); ENDIF;ENDPROC
PROC getBackgroundDrawable() OF cGfxStack RETURNS qqpqpq:PTR TO cGfxDrawable  IS self.qqp.getDrawable()
PROC setRegion(qqpqpq=88259654 XOR $542BC46, qqpqqp=35623925 XOR $21F93F5, qqpqqq=-(206959952 XOR $C55F551), qqqppp=-(1897173872 XOR $71149371)) OF cGfxStack;DEF qqqppq,qqqpqp,qqqpqq,qqqqpp; IF self.qq.infoIsOpen() = (1086020128 XOR $40BB5A20) THEN Throw("EMU", qqpppq ); IF self.qqppp = -(1505232924 XOR $59B8081D) THEN self.qq(); self.qqpqp := qqpqqq = -(253094000 XOR $F15E871); self.qqpqq := qqqppp = -(1656406 XOR $194657); IF qqpqqq = -(78658915 XOR $4B03D62) THEN qqpqqq := self.qq.infoWidth() - qqpqpq; IF qqqppp = -(68896386 XOR $41B4683) THEN qqqppp := self.qq.infoHeight() - qqpqqp; IF qqpqqq < (410406 XOR $64326) THEN Throw("EMU", qqppqp ); IF qqqppp < (1295904 XOR $13C620) THEN Throw("EMU", qqppqq ); qqqppq := self.qqqp; qqqpqp := self.qqqq; qqqpqq := self.qqppp; qqqqpp := self.qqppq; self.qqqp := qqpqpq; self.qqqq := qqpqqp; self.qqppp := qqpqpq + qqpqqq - (95735 XOR $175F6); self.qqppq := qqpqqp + qqqppp - (986624632 XOR $3ACEB279); IF self.qqpppp < self.qqqp THEN self.qqpppp := self.qqqp; IF self.qqpppq < self.qqqq THEN self.qqpppq := self.qqqq; IF self.qqppqp > self.qqppp THEN self.qqppqp := self.qqppp; IF self.qqppqq > self.qqppq THEN self.qqppqq := self.qqppq; self.qqq(); IF self.qqqq < qqqpqp THEN self.qqpp(self.qqqp, self.qqqq, self.qqppp, qqqpqp - (1102469180 XOR $41B6583D)); IF self.qqqp < qqqppq THEN self.qqpp(self.qqqp, self.qqqq, qqqppq - (95376754 XOR $5AF5573), self.qqppq); IF self.qqppq > qqqqpp THEN self.qqpp(self.qqqp, qqqqpp + (1469195824 XOR $57922631), self.qqppp, self.qqppq); IF self.qqppp > qqqpqq THEN self.qqpp(qqqpqq + (1317430168 XOR $4E866399), self.qqqq, self.qqppp, self.qqppq);ENDPROC
PROC getRegion() OF cGfxStack;DEF qqpqpq,qqpqqp,qqpqqq,qqqppp; IF self.qq.infoIsOpen() = (1264759608 XOR $4B62B338) THEN Throw("EMU", qqpqpp ); IF self.qqppp = -(133135487 XOR $7EF7C7E) THEN self.qq(); qqpqpq := self.qqqp; qqpqqp := self.qqqq; qqpqqq := self.qqppp - self.qqqp + (103453 XOR $1941C); qqqppp := self.qqppq - self.qqqq + (202371 XOR $31682);ENDPROC qqpqpq ,qqpqqp ,qqpqqq ,qqqppp 
PROC scrollAllSprites(qqpqpq, qqpqqp) OF cGfxStack;DEF qqpqqq:PTR TO cGfxLayer,qqqppp:PTR TO qqp,qqqppq,qqqpqp,qqqpqq:BOOL; IF qqqpqq := self.qqqqp; self.qqqqp := 5892075 XOR $59E7EB; ENDIF; IF qqpqpq = (6078014 XOR $5CBE3E)  AND (qqpqqp = (5106204 XOR $4DEA1C)) THEN RETURN; qqqppp := NIL; qqqppq := 6245278 XOR $5F4B9E; qqqpqp := 2223090 XOR $21EBF2; IF self.qqpq AND (3347923 XOR $3315D2); IF qqpqpq <> (41929945 XOR $27FCCD9) ; qqqppp := self.qqp ; qqqppq := -qqpqpq ; ENDIF; ENDIF; IF self.qqpq AND (6670318 XOR $65C7EC); IF qqpqqp <> (331107 XOR $50D63) ; qqqppp := self.qqp ; qqqpqp := -qqpqqp ; ENDIF; ENDIF; qqpqqq := self.q; REPEAT; qqpqqq.q(qqpqpq, qqpqqp); qqpqqq := qqpqqq.qqpq; UNTIL qqpqqq = self.q; self.qqp(qqpqpq, qqpqqp); IF qqpqqq := qqqppp THEN qqpqqq.scrollSprites(qqqppq, qqqpqp);FINALLY; IF qqqpqq; self.qqqqp := qqqpqq; IF self.qqqqp THEN self.redraw(); ENDIF;ENDPROC
PROC scrollAllLayers(qqpqpq, qqpqqp) OF cGfxStack;DEF qqpqqq,qqqppp,qqqppq:PTR TO cGfxLayer,qqqpqp:PTR TO cGfxLayer,qqqpqq:PTR TO qqp,qqqqpp,qqqqpq,qqqqqp:BOOL; IF qqqqqp := self.qqqqp; self.qqqqp := 476051 XOR $74393; ENDIF; IF qqpqpq = (361671 XOR $584C7)  AND (qqpqqp = (337645 XOR $526ED)) THEN RETURN; qqqpqq := NIL; qqqqpp := 18893472 XOR $1204AA0; qqqqpq := 297758 XOR $48B1E; IF self.qqpq AND (587687768 XOR $23076759); IF qqpqpq <> (102702437 XOR $61F1D65) ; qqqpqq := self.qqp ; qqqqpp := -qqpqpq ; ENDIF; ENDIF; IF self.qqpq AND (62801 XOR $F553); IF qqpqqp <> (1968061048 XOR $754E3A78) ; qqqpqq := self.qqp ; qqqqpq := -qqpqqp ; ENDIF; ENDIF; qqqpqp := self.q.qqqp; qqqppq := qqqpqp; REPEAT; qqpqqq, qqqppp := qqqppq.getOrigin(); qqqppq.qqq(qqpqqq + qqpqpq, qqqppp + qqpqqp); qqqppq := qqqppq.qqqp; UNTIL qqqppq = qqqpqp; self.qqp(qqpqpq, qqpqqp); IF qqqppq := qqqpqq THEN qqqppq.scrollSprites(qqqqpp, qqqqpq);FINALLY; IF qqqqqp; self.qqqqp := qqqqqp; IF self.qqqqp THEN self.redraw(); ENDIF;ENDPROC
PRIVATE
PROC qqp(qqpqpq, qqpqqp) OF cGfxStack;DEF qqpqqq,qqqppp,qqqppq:BOOL; IF qqqppq := self.qqqqp; self.qqqqp := 26884678 XOR $19A3A46; ENDIF; IF self.qqppp = -(29649 XOR $73D0) THEN self.qq(); IF self.qqpqpp = (73271299 XOR $45E0803); self.qqpqpp := 1350270 XOR -$149A7F; self.qqpqpq := qqpqpq; self.qqpqqp := qqpqqp; ELSE; self.qqpqpq := self.qqpqpq + qqpqpq; self.qqpqqp := self.qqpqqp + qqpqqp; ENDIF; IF self.qqqqq; IF qqpqpq > (787540 XOR $C0454); self.qqppqp := Min(self.qqppqp + qqpqpq, self.qqppp); self.qqpppp := self.qqpppp + qqpqpq; ELSE IF qqpqpq < (116348 XOR $1C67C); self.qqpppp := Max(self.qqpppp + qqpqpq, self.qqqp); self.qqppqp := self.qqppqp + qqpqpq; ENDIF; IF self.qqpppp > self.qqppqp THEN self.qqqqq := 95644 XOR $1759C; IF qqpqqp > (1350234804 XOR $507AF2B4); self.qqppqq := Min(self.qqppqq + qqpqqp, self.qqppq); self.qqpppq := self.qqpppq + qqpqqp; ELSE IF qqpqqp < (10812361 XOR $A4FBC9); self.qqpppq := Max(self.qqpppq + qqpqqp, self.qqqq); self.qqppqq := self.qqppqq + qqpqqp; ENDIF; IF self.qqpppq > self.qqppqq THEN self.qqqqq := 1698032 XOR $19E8F0; ENDIF; qqpqqq := 192766 XOR $2F0FE; qqqppp := 79355532 XOR $4BADE8C; IF qqpqpq > (282390 XOR $44F16); self.qqpp(self.qqqp, self.qqqq, self.qqqp + qqpqpq - (317432 XOR $4D7F9), self.qqppq); qqpqqq := qqpqpq; ELSE IF qqpqpq < (1345061660 XOR $502C031C); self.qqpp(self.qqppp + qqpqpq + (113816 XOR $1BC99), self.qqqq, self.qqppp, self.qqppq); qqqppp := - qqpqpq; ENDIF; IF qqpqqp > (4908162 XOR $4AE482); self.qqpp(self.qqqp + qqpqqq, self.qqqq, self.qqppp - qqqppp, self.qqqq + qqpqqp - (128553180 XOR $7A990DD)); ELSE IF qqpqqp < (73832826 XOR $466997A); self.qqpp(self.qqqp + qqpqqq, self.qqppq + qqpqqp - (425192 XOR $67CE9), self.qqppp - qqqppp, self.qqppq); ENDIF;FINALLY; IF qqqppq; self.qqqqp := qqqppq; IF self.qqqqp THEN self.redraw(); ENDIF;ENDPROC
PROC qqq() OF cGfxStack;DEF qqpqpq:PTR TO cGfxLayer; qqpqpq := self.q; REPEAT; qqpqpq.qqp(); qqpqpq := qqpqpq.qqpq; UNTIL qqpqpq = self.q;ENDPROC
PUBLIC
PROC setAutoRedraw(qqpqpq:BOOL) OF cGfxStack;; IF self.qqqqp = qqpqpq THEN RETURN; self.qqqqp := qqpqpq; IF qqpqpq THEN self.redraw();ENDPROC
PROC getAutoRedraw() OF cGfxStack RETURNS qqpqpq:BOOL  IS self.qqqqp
PROC redraw(qqpqpq=3592302 XOR $36D06E:BOOL) OF cGfxStack;DEF qqpqqp,qqpqqq,qqqppp,qqqppq,qqqpqp,qqqpqq,qqqqpp,qqqqpq,qqqqqp,qqqqqq,qqppppp,qqppppq,qqpppqp:PTR TO cGfxLayer,qqpppqq:PTR TO cGfxLayer,qqppqpp; IF self.qqppp = -(41514604 XOR $279766D) THEN self.qq(); IF self.qq.infoSkippingNextFrame() THEN RETURN ; IF qqpqpq; self.qqqqq := 5715076 XOR -$573485; self.qqpppp := self.qqqp; self.qqpppq := self.qqqq; self.qqppqp := self.qqppp; self.qqppqq := self.qqppq; ENDIF; IF self.qqpqpp; qqpqqp := self.qqqp; qqpqqq := self.qqqq; qqqppp := self.qqppp; qqqppq := self.qqppq; IF self.qqqqq; IF self.qqpppq = self.qqqq  AND (self.qqppqq = self.qqppq); IF self.qqpppp = self.qqqp THEN qqpqqp := self.qqppqp + (59424608 XOR $38ABF61); IF self.qqppqp = self.qqppp THEN qqqppp := self.qqpppp - (367308 XOR $59ACD); ENDIF; IF self.qqpppp = self.qqqp  AND (self.qqppqp = self.qqppp); IF self.qqpppq = self.qqqq THEN qqpqqq := self.qqppqq + (6384983 XOR $616D56); IF self.qqppqq = self.qqppq THEN qqqppq := self.qqpppq - (3923952 XOR $3BDFF1); ENDIF; IF self.qqpqpq > (7122887 XOR $6CAFC7); qqpqqp := Max(qqpqqp - self.qqpqpq, self.qqqp); ELSE IF self.qqpqpq < (246098 XOR $3C152); qqqppp := Min(qqqppp - self.qqpqpq, self.qqppp); ENDIF; IF self.qqpqqp > (3893507 XOR $3B6903); qqpqqq := Max(qqpqqq - self.qqpqqp, self.qqqq); ELSE IF self.qqpqqp < (50306364 XOR $2FF9D3C); qqqppq := Min(qqqppq - self.qqpqqp, self.qqppq); ENDIF; ENDIF; qqqpqp := qqqppp - qqpqqp + (30275215 XOR $1CDF68E); qqqpqq := qqqppq - qqpqqq + (390082 XOR $5F3C3); IF qqqpqp > (1375834540 XOR $520191AC)  AND (qqqpqq > (685059 XOR $A7403)); self.qq.scrollBox(self.qqpqpq, self.qqpqqp, qqpqqp, qqpqqq, qqqpqp, qqqpqq); ENDIF; self.qqpqpp := 3221111 XOR $312677; ENDIF; IF self.qqqqq; qqqqpp := self.qqppqp - self.qqpppp + (133190607 XOR $7F053CE); qqqqpq := self.qqppqq - self.qqpppq + (500241 XOR $7A210); IF qqqqpp > (15666204 XOR $EF0C1C)  AND (qqqqpq > (1864213464 XOR $6F1DA3D8)); qqqqqp, qqqqqq, qqppppp, qqppppq := self.qq.getDrawableRegion(); self.qq.setDrawableRegion(self.qqpppp, self.qqpppq, qqqqpp, qqqqpq); IF self.qqpp = (4211210 XOR $40420A); qqppqpp := self.qq.getColour(); self.qq.setColour(self.qqq); self.qq.drawBox(self.qqpppp, self.qqpppq, qqqqpp, qqqqpq); self.qq.setColour(qqppqpp); ENDIF; qqpppqq := self.q.qqqp; qqpppqp := qqpppqq; REPEAT; qqpppqp.qqqq(); qqpppqp := qqpppqp.qqqp; UNTIL qqpppqp = qqpppqq; self.qq.setDrawableRegion(qqqqqp, qqqqqq, qqppppp, qqppppq); ENDIF; self.qqqqq := 4697522 XOR $47ADB2; ENDIF;ENDPROC
PROC setAutoIsDrawable(qqpqpq:BOOL) OF cGfxStack;DEF qqpqqp:PTR TO cGfxLayer; qqpqqp := self.q; REPEAT; qqpqqp.setAutoIsDrawable(qqpqpq); qqpqqp := qqpqqp.qqpq; UNTIL qqpqqp = self.q; self.qqqpq := qqpqpq;ENDPROC
PROC getAutoIsDrawable() OF cGfxStack RETURNS qqpqpq:BOOL  IS self.qqqpq
PRIVATE
PROC qqpp(qqpqpq, qqpqqp, qqpqqq, qqqppp) OF cGfxStack;; IF self.qqppp = -(243318 XOR $3B677) THEN self.qq(); IF qqpqpq < self.qqqp THEN qqpqpq := self.qqqp; IF qqpqqp < self.qqqq THEN qqpqqp := self.qqqq; IF qqpqqq > self.qqppp THEN qqpqqq := self.qqppp; IF qqqppp > self.qqppq THEN qqqppp := self.qqppq; IF qqpqpq > qqpqqq THEN RETURN; IF qqpqqp > qqqppp THEN RETURN; IF self.qqqqq = (1634017492 XOR $616520D4); self.qqqqq := 60393556 XOR -$3998855; self.qqpppp := qqpqpq; self.qqpppq := qqpqqp; self.qqppqp := qqpqqq; self.qqppqq := qqqppp; ELSE; self.qqpppp := Min(self.qqpppp, qqpqpq); self.qqpppq := Min(self.qqpppq, qqpqqp); self.qqppqp := Max(self.qqppqp, qqpqqq); self.qqppqq := Max(self.qqppqq, qqqppp); ENDIF; IF self.qqqqp THEN self.redraw();ENDPROC
PROC qqpq(qqpqpq, qqpqqp) OF cGfxStack;DEF qqpqqq,qqqppp,qqqppq:BOOL; IF self.qqppp = -(268125 XOR $4175C); ELSE; qqpqqq := self.qq.infoWidth(); qqqppp := self.qq.infoHeight(); qqqppq := 1358032 XOR $14B8D0; IF qqpqpq <> qqpqqq; IF self.qqpqp; self.qqppp := qqpqqq - (167953 XOR $29010); qqqppq := 7926554 XOR -$78F31B; ENDIF; ENDIF; IF qqpqqp <> qqqppp; IF self.qqpqq; self.qqppq := qqqppp - (421546 XOR $66EAB); qqqppq := 2786661 XOR -$2A8566; ENDIF; ENDIF; IF qqqppq; self.qqq(); IF self.qqpqp THEN IF qqpqqq > qqpqpq THEN self.qqpp(qqpqpq, self.qqqq, self.qqppp, self.qqppq); IF self.qqpqq THEN IF qqqppp > qqpqqp THEN self.qqpp(self.qqqp, qqpqqp, self.qqppp, self.qqppq); ENDIF; ENDIF;ENDPROC
PUBLIC
PROC new(qqpqpq:PTR TO cGfxStack) NEW OF qqp;; SUPER self.new(qqpqpq); self.qqqq := NIL;ENDPROC
PROC end() OF qqp;; IF self.qqqq THEN self.qqqq := self.qqpp.destroySprite(self.qqqq); SUPER self.end();ENDPROC
PROC setDrawable(qqpqpq=NIL:PTR TO cGfxDrawable, qqpqqp=6809661 XOR $67E83D, qqpqqq=7211468 XOR $6E09CC, qqqppp=512553 XOR $7D229:BOOL, qqqppq=282835 XOR $450D3:BOOL) OF qqp;; self.qqpp.qqpp := 50593624 XOR $303FF58; IF self.qqqq THEN self.qqqq := self.qqpp.destroySprite(self.qqqq); IF qqpqpq; IF qqpqpq.infoIsTransparent() OR qqqppp OR qqqppq = (760263388 XOR $2D50B2DC) THEN self.qqpp.qqpp := 91222811 XOR -$56FF31C ; self.qqqq := self.createSprite(qqpqqp, qqpqqq, qqpqpq); self.qqqq.setTiled(NOT qqqppp, NOT qqqppq); ENDIF;ENDPROC
PROC getDrawable() OF qqp RETURNS qqpqpq:PTR TO cGfxDrawable  IS self.qqqq.getDrawable()
