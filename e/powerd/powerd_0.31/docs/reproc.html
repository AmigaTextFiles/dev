<html>
<head>
  <title>PowerD.html - REPROC returning values</title>
  <meta http-equiv="Content-Type" content="text/html">
</head>
<body bgcolor=#ffffff>
<ul type=square>
<li><big>Description:</big><br>
  <font color=#ff0000>REPROC</font> keyword is an equivalent of <font color=#ff0000>RETURN</font> keyword. <font color=#ff0000>REPROC</font> allows You to
  execute a part of code, before the procedure will be leaved.<br>
  This feature allows single or multiple <font color=#ff0000>DREPROC</font> definition. When single
  only used, no <font color=#ff0000>OF &lt;id&gt;</font> allowed, because there is not defined another
  code. When <font color=#ff0000>REPROC</font> keyword reached it will setup return values and launch
  the <font color=#ff0000>DREPROC</font> code.<br><br>
  <font color=#0000ff>This is beta feature and may not be safe.</font>
<br><br>

<li><big>Syntax:</big>
<font color=#ff0000><pre>
  REPROC &lt;list&gt; [ OF &lt;id&gt; ]
</pre></font><br>
  where list is <font color=#ff0000>&lt;list&gt;</font> of return values
  to be returned by proc and <font color=#ff0000>&lt;id&gt;</font> is
  <font color=#ff0000>DREPROC</font> identificator, which selects <font color=#ff0000>DREPROC</font> code to be executed before
  the procedure leaves.
<font color=#ff0000><pre>
  DREPROC [ &lt;id&gt; ]
</pre></font><br>
  where <font color=#ff0000>&lt;id&gt;</font> is the <font color=#ff0000>DREPROC</font> identificator.
<br><br>

<li><big>Example:</big><br>
  Imagine: Your procedure does some operations and it uses some RETURNs
  to leave a procedure earlier. Some times is enough to only return a
  values, but sometimes a man need to do some operations, before the
  procedure will be leaved:
<font color=#ff0000><pre>
  PROC AllocScene()
    DEF scene:PTR TO LONG,err,n
    IF (scene:=AllocMem(4*SIZEOF_LONG,MEMF_PUBLIC|MEMF_CLEAR))=NIL THEN RETURN NIL,ERR_Mem
    LOOP n:=3
      IF (scene[n],err:=AllocObject())=NIL THEN REPROC NIL,err
    ENDLOOP
  DREPROC
    LOOP n:=3
      IF scene[n] THEN FreeObject(scene[n])
    ENDLOOP
  ENDPROC scene,ERR_None
</pre></font><br>
  This procedure will allocate a block of memory for scene and fill this
  scene with four objects. If scene allocation will fail, procedure will
  return NIL and ERR_Mem. If an object allocation will fail, then comes
  <font color=#ff0000>DREPROC</font> code to be executed, so all object will be freed, and NIL and
  err (returned by AllocObject()) will be returned. I know this may be
  used in same way as EXCEPTions, but this allows more then one code
  blocks, see above.
</ul>
</body>
</html>
