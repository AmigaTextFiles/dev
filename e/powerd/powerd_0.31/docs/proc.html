<html>
<head>
  <title>PowerD.html - PROC definition</title>
  <meta http-equiv="Content-Type" content="text/html">
</head>
<body bgcolor=#ffffff>
<ul type=square>
<li><big>News:</big>
  <ul type=disc>
  <li>0.18:<br>
    You are now allowed to use <a href="#regs">registers</a> as procedure arguments
  </ul>
<li><big>Syntaxes:</big>
<font color=#ff0000><pre>
  PROC &lt;name&gt;( [ &lt;args&gt; ] ) [ (&lt;results&gt;) ] IS &lt;exp&gt;

  PROC &lt;name&gt;( [ &lt;args&gt; ] ) [ (&lt;results&gt;) ]
    &lt;statements&gt;
  ENDPROC [ &lt;exp&gt; ]
</pre></font><br>
  where <font color=#ff0000>&lt;name&gt;</font> is the procedure name, <font color=#ff0000>&lt;args&gt;</font> are arguments
  of the procedure and <font color=#ff0000>&lt;results&gt;</font> are return value types. <font color=#ff0000>&lt;exp&gt;</font>
  is a list of returning expressions. <font color=#ff0000>&lt;statements&gt;</font> is all the code of
  the procedure.
<br><br>
<a name="ret"></a>
<li><big>Early exit (RETURN):</big><br>
  Procedure can be left before the end is reached be the RETURN keyword.
  This also allows to return a list of values:
<font color=#ff0000><pre>
  RETURN [ &lt;exp&gt; ]
</pre></font><br>
  where <font color=#ff0000>&lt;exp&gt;</font> is a list of returning expressions.
<br><br>

<li><big>Returning values:</big><br>
  Procedures in PowerD can return one or more return values. All of
  these should be defined in <font color=#ff0000>&lt;results&gt;</font> field (see above).
  Defaultly are all values typed as <font color=#ff0000>LONG</font>s, so if the procedure
  return eg. <font color=#ff0000>FLOAT</font>s or <font color=#ff0000>DOUBLE</font>s this field <font color=#0000ff>MUST</font> be defined. If not,
  procedure will return bad values. (<font color=#ff0000>FLOAT</font>s and <font color=#ff0000>DOUBLE</font>s are stored
  in floating point registers, while all others are stores in cpu
  data registers)<br>
  All of these return types can contain also default return value
  and everywhere a procedure will be left without a return values
  these default will be used instead like here:
<font color=#ff0000><pre>
  PROC test()(DOUBLE,DOUBLE)
    RETURN 2,1.1
  ENDPROC 1.0,1.1
</pre></font><br>
  is the same as:

<font color=#ff0000><pre>
  PROC test()(DOUBLE=1.0,DOUBLE=1.1)
    RETURN 2
  ENDPROC
</pre></font>
<a name="regs">
<li><big>Registers as arguments</big><br>
  This allows You to use registers instead of stack for arguments storage.
  This is important for library compilation, where all functions should use
  registers only. This is a 68k only feature, it's useless on ppc, because
  ppc uses single argument structure for all function types. Pay attention on
  registers You use for these arguments, You are allowed to use all data
  registers D0-D7, and some address registers A0-A3, A4 is also a possibility
  in PowerD, but this register has special meaning in other languages, so I
  wouldn't recommend to use it. And ofcourse You can use all the float registers
  FP0-FP7.<br><br>

  Syntactical example:
<font color=#ff0000><pre>
  PROC xxx(a:L IN d0,b:PTR IN a1,c:DOUBLE IN fp1)
  ENDPROC
</pre></font><br>
  Here You see, that the magic keyword is the 'IN' followed by the register
  itself.<br><br>

  Limitations:<br>
  Currently, if You use this feature, You have to use it on all the arguments.
  It isn't allowed to use eg: PROC xxx(a,b IN d0).
</ul>
</body>
</html>
