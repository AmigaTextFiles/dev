<html>
<head>
  <title>PowerD.html - definice PROC</title>
  <meta http-equiv="Content-Type" content="text/html">
</head>
<body bgcolor=#ffffff>
<ul type=square>
<li><big>Novinky:</big>
  <ul type=disc>
  <li>0.18: Nyni je mozne pouzit <a href="#regs">registry</a> jako argumenty
  </ul>
<br><br>

<li><big>Syntaxe:</big>
<font color=#ff0000><pre>
  PROC &lt;nazev&gt;( [ &lt;argumenty&gt; ] ) [ (&lt;navratove typy&gt;) ] IS &lt;vyraz&gt;

  PROC &lt;nazev&gt;( [ &lt;argumenty&gt; ] ) [ (&lt;navratove typy&gt;) ]
    &lt;prikazy&gt;
  ENDPROC [ &lt;vyraz&gt; ]
</pre></font><br>
  kde <font color=#ff0000>&lt;nazev&gt;</font> je jmeno procedury,
  <font color=#ff0000>&lt;argumenty&gt;</font> jsou argumenty procedury a
  <font color=#ff0000>&lt;navratove typy&gt;</font> jsou typy navratovych
  hodnot. <font color=#ff0000>&lt;vyraz&gt;</font> je seznam navratovych
  vyrazu. <font color=#ff0000>&lt;prikazy&gt;</font> jsou veskery dalsi
  kod procedury.
<br><br>

<a name="ret"></a>
<li><big>Predcasne opusteni procedury (RETURN):</big><br>
  Procedura muze byt opustena drive, nez dojde ke konci, a to klicovym
  slovem RETURN. Klicove slovo RETURN ma nasledujici syntaxi:
<font color=#ff0000><pre>
  RETURN [ &lt;vyraz&gt; ]
</pre></font><br>
  kde <font color=#ff0000>&lt;vyraz&gt;</font> je seznam navratovych vyrazu.
<br><br>

<li><big>Vraceni hodnot:</big><br>
  Procedury v PowerD mohou vracet jednu ci vice hodnot. Vsechny typy techto
  navratovych hodnot by meli byt definovany v poly
  <font color=#ff0000>&lt;navratove typy&gt;</font> (viz vyse)
  Standardne jsou vsechny typy nastaveny na <font color=#ff0000>LONG</font>y,
  takze pokud se vraci napriklad <font color=#ff0000>FLOAT</font>, tento typ
  se <font color=#0000ff>MUSI</font> nastavit, jinak se vrati pouze celociselna
  cast tohoto cisla. Typy <font color=#ff0000>FLOAT</font> a <font color=#ff0000>DOUBLE</font>
  se vraceji ve floatovych registrech, vsechny ostatni typy v datovych registrech.
<br>

  Vsechny tyto typy mohou obsahovat preddefinovane navratove hodnoty, a kdekoliv
  proceduru opustite pomoci klicoveho slova RETURN ci ENDPROC a vynechate dane
  navratove vyrazy, budou tyto nahrazeny prednastavenou navratovou hodnotou:
<font color=#ff0000><pre>
  PROC test()(DOUBLE,DOUBLE)
    RETURN 2,1.1
  ENDPROC 1.0,1.1
</pre></font><br>
  je to same jako:
<font color=#ff0000><pre>
  PROC test()(DOUBLE=1.0,DOUBLE=1.1)
    RETURN 2
  ENDPROC
</pre></font>

<a name="regs">
<li><big>Argumenty v registrech</big><br>
  Tento rys umoznuje nastavit vlastni registry jako argumenty na procesoru
  680x0. Standardni ukladani argumenty je na stack, coz ale znemoznuje napriklad
  pouzit tyto funkce snadno i treba pro hook funkce, ktere vyzaduji sve argumenty
  ulozene v danych registrech. Na PowerPC je toto zbytecne, protoze tam je struktura
  argumentu jednotna, a tudiz vsechny funkce maji stejny zpusob ukladani argumentu.
  Jako argumenty lze pouzit registry D0-D7, A0-A3, A4 lze v PowerD take pouzit, ale
  v jinych jazycich ma tento registr specialni pouziti, takze ho neporocuji pouzivat.
  Dale je samozrejme pouzit registry FP0-FP7 pro desetinna cisla.
<br><br>

  Syntakticka ukazka:
<font color=#ff0000><pre>
  PROC xxx(a:L IN d0,b:PTR IN a1,c:DOUBLE IN fp1)
  ENDPROC
</pre></font><br>
  Zde je videt ono magicke klicove slovo 'IN', jenz je nasledovano registrem samotnym.
<br><br>

  Omezeni:<br>
  Momentalne, pokud pouzivate tuto vymozenost, musite nastavit registry pro
  <font color=#0000ff>VSECHNY</font> argumenty, neni povoleno napriklad: PROC xxx(a,b IN d0).
</ul>
</body>
</html>
