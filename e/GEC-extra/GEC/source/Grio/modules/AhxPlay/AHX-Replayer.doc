;-------------------T-----------T-----------------T---------T---------------

;=============================================================================
;=============================================================================
;================================= a h x =====================================
;=============================================================================
;================= b i n a r y - r e p l a y e r   d o c u ===================
;=============================================================================
;=============================================================================
;========================= v e r s i o n   2 . 3 d ===========================
;=============================================================================
;=============================================================================

- Note that 68000er DeliPlayer as Noteplayer is NOT possible!

How to use the replayer in my own productions ??
 - Here we go (take a look at the example source!-and contact me!)

1. Include the "AHX-Offsets.I" file
2. Include the "AHX-Replayer.BIN" file (100% pc-relative) <needn't be chip>
3. Call the following procedures as described:
   for example: jsr ahxReplayer+ahxInitCIA
                jsr ahxReplayer+ahxInitPlayer
                jsr ahxReplayer+ahxInitModule (or BSR if in the same section!)
4. To access e.g. the volume etc. (the ahx_p... variables as seen in the
   "AHX-Offsets.I" file), proceed like this: (access them by byte!)


;---- ahxVoiceControl
;ahxVoiceControl
;               move.l      a0-a3/a6,-(sp)
;               move.l      ahxReplayer+ahxBSS_P(pc),a6
;               lea         ahx_pVoice0Temp(a6),a0
;               lea         ahx_pVoice1Temp(a6),a1
;               lea         ahx_pVoice2Temp(a6),a2
;               lea         ahx_pVoice3Temp(a6),a3
;               move        ahx_pvtAudioVolume(a0),VolumeMeterVoice0Volume
;               move        ahx_pvtAudioVolume(a1),VolumeMeterVoice1Volume
;               move        ahx_pvtAudioVolume(a2),VolumeMeterVoice2Volume
;               move        ahx_pvtAudioVolume(a3),VolumeMeterVoice3Volume
;               movem.l     (sp)+,a0-a3/a6
;               RTS

   This would read out the volumes of the 4 channels and write it to
   the 4 VolumeMeterVocieXVolumes (e.g.)... Anyway, gotta problem, wanna
   hack out more, not only the volume, look into the AHX-Offsets.I and if
   you still wanna hack more, contact me at Dexter.Abyss@iName.com

;---- ahxGetSubsongs
;ahxGetSubsongs move.l      a6,-(sp)
;               move.l      ahxReplayer+ahxBSS_P(pc),a6  ;get ptr to
;               moveq       #0,d0                        ;players public
;               move.b      ahx_pSubsongs(a6),d0         ;memory
;               move.l      (sp)+,a6                     ;and get nr. of
;               RTS                                      ;subsongs from there

   You may then also set the ahx_pPlaying flag to non-0 if the immediate play
   value was set to non-zero in ahxInitSubSong or you may set the volume, get
   your external timing (if you read out the ext. timing value, be sure to
   clear the BYTE after reading it!) or see if the song has reached its end.

5. That's it, now some technical information!



;            ----==== a Little Function-Overview ====----


; All Inputs are LONGWORDS, please!


;---- ahxInitCIA
;
; Inputs: a0: pointer to your cia-interrupt (return with RTS please!)
;             - or -
;  *NEW*  a0: pointer to a routine that sets the cia-timer (tempo is
;             given you over in d0.w, which will then be whether 28419/2,
;             28419/4, 28419/6 or 28419/8)  - if using your own cia (d0=1)
;             You need NOT save the registers here!
;         d0: 0 for system-friendly level 1 i think (called by exec.cause)
;               others are NOT YET included!
;    *NEW*    1 for using your own cia - pass a tempo_set routine in a0 then
;
; Output: d0:  0 for success
;             -1 for error (so don't call ahxKillCIA then later!)
;
: Function: will try to get one of amiga's cia-interrupts (system-method!)
;   *NEW*   but now also supports multiple-speed modules using your own cia!


;---- ahxInitPlayer
;
; Inputs: a0: pointer to 412150 bytes of public (fast) memory
;         a1: pointer to   2560 bytes of explicit chip memory
;      or null-pointer(s) (sub.l a0,a0 and/or sub.l a1,a1) for auto-allocation!
; *NEW*   d0: zero (0) for LoadWavesFile if possible (should normally be used)!
;             one (1) for ExplicitWavesPrecalcing
; *NEW*   d1: zero (0) for Filters (standard setting!)
;             one (1) for No Filters (use only if playing AHXv1.xx modules!
;
; Output: d0: non-zero (-1) for failure, zero (0) for no error!
;
: Function: will precalc the few waveforms and (if a0/a1 = 0) allocate
;           player's memory-blocks (auto-allocation is recommended!)
;           This function will also precalc the filter-waves, so
;           it may take some time depending on your cpu power (or if
;           possible loads it from your hdd)
; *NEW*     This function now also turns the audiohardware on.


;---- ahxInitModule
;
; Inputs: a0: pointer to a AHX-Module
;
; Output: d0: non-zero (-1) for failure, zero (0) for no error!
; *NEW*   d0: minus-two (-2) for 2x/3x/4x-speed module failed due no cia
;             was initialized (2x/3x/4x only works with cia!)
; *NEW*   d1: number of subsongs
;
; Function: initializes the given AHX-Module
;
; Bugs: No output value WAS returned until version v2.0 - Sorry


;---- ahxInitSubSong
;
; Inputs: d0: subsong number (0 means main tune, 1 means first subsong etc.)
;         d1: immediate play (zero means immediately play when ahxInterrupt is
;                             called, non-zero means wait until ahx_pPlaying
;                             flag is set to non-zero) normally use 0 here!
;
; Function: initializes the given subsong


;---- ahxInterrupt
;
; Function: plays 1/50 of a second, so you'll have to call it every 1/50 sec.!
;           If possible, use ahxInitCIA (with ahx's or your own cia), as you
;           can't play 2x/3x/4x-speed tunes with vbl-irq !!!


;---- ahxStopSong
;
; Function: stops the current playing song.


;---- ahxKillPlayer
;
; Function: shuts down the audio-channels and deallocates the two memory
;           blocks as long as they were allocated by ahxInitPlayer itsself!
; *BUG*     did not shut down the audio-channels before v2.1n
; *NEW*     now shuts down the audio-channels! :-)

;---- ahxKillCIA
;
; Function: Removes the cia-interrupt from system, call only if you're
;           sure it was initialized correctly!! (ahxInitCIA returns 0/-1)
;   *NEW*   Please do also call ahxKillCIA if you were using your own CIA!



; If ya wanna e.g. set the volume, contact me, i'll tell you !
; If ya need a shorter replayer for your production, contact me, i'll do!

; Take a look at the example source!!        - dexter/abyss! signing off!
