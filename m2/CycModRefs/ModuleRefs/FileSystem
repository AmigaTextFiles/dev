@database FileSystem
@node Main "FileSystem"

Procedures

   @{" Close " link Modul 43}                       @{" Delete " link Modul 39}                      @{" GetPos " link Modul 36}
   @{" Length " link Modul 41}                      @{" Lookup " link Modul 26}                      @{" ReadByteBlock " link Modul 30}
   @{" ReadBytes " link Modul 28}                   @{" ReadChar " link Modul 29}                    @{" SetPos " link Modul 37}
   @{" WriteByteBlock " link Modul 34}              @{" WriteBytes " link Modul 32}                  @{" WriteChar " link Modul 33}


Constants

   @{" BufSize " link Modul 7}                  

Type-Declarations

   @{" File " link Modul 15}                        @{" FileMode " link Modul 13}                    @{" FileModeSet " link Modul 14}
   @{" Response " link Modul 10}                 

@endnode
@node Modul "am2:ModuleRefs/FileSystem.def"
DEFINITION MODULE FileSystem;

(* (C) Copyright 1994 Marcel Timmermans. All rights reserved. *)

FROM SYSTEM IMPORT ADDRESS,BYTE;
IMPORT DosD;

CONST
  BufSize=1024;

TYPE
  Response=(done,notdone,memErr,openfileErr,readErr,writeErr,
            bufErr,seekErr,deleteErr);
  FileMode=(read,write);
  FileModeSet=SET OF FileMode;
  File=RECORD
    handle:DosD.FileHandlePtr;
    res:Response;
    eof:BOOLEAN;
    mode:FileModeSet;
    buffer:ARRAY[0..BufSize-1] OF CHAR;
    bufPos,
    bufLen,
    pos:LONGINT;
  END;

PROCEDURE Lookup(VAR file:File; name:ARRAY OF CHAR;new:BOOLEAN);

PROCEDURE ReadBytes(VAR file:File; adr:ADDRESS; size:LONGINT);
PROCEDURE ReadChar(VAR file:File; VAR ch:CHAR);
PROCEDURE ReadByteBlock(VAR file:File; VAR block:ARRAY OF BYTE);

PROCEDURE WriteBytes(VAR file:File; adr:ADDRESS; size:LONGINT);
PROCEDURE WriteChar(VAR file:File; ch:CHAR);
PROCEDURE WriteByteBlock(VAR file:File; VAR block:ARRAY OF BYTE);

PROCEDURE GetPos(VAR file:File; VAR Pos:LONGINT);
PROCEDURE SetPos(VAR file:File;Pos:LONGINT);

PROCEDURE Delete(VAR file:File);

PROCEDURE Length(VAR file:File; VAR len:LONGINT);

PROCEDURE Close(VAR file:File);


END FileSystem.

@endnode
