@database "guitools.guide"

@REMARK "$VER: GUITools_SRC.guide 38.1 (20.05.94)"

@NODE Main "GUITools.guide"


                                   GUITools

                                 Version 38.1

                           Modula-2 Source Code Guide

 =========================================================================

                                  Copyright

                       May 1994   Carsten Ziegeler
                                  Augustin-Wibbelt-Str.7
                                  D-33106 Paderborn
                                  Germany

                            All rights reserved

                                   FREEWARE

 =========================================================================




                                 GUITools


 Copyright / Disclaimer

      @{" Copyright " LINK GCHAP-Copyright}
      @{" Disclaimer " LINK GCHAP-Disclaimer}
      @{" Contents of V38.1 Source Code" LINK GCHAP-Contents}

 Some internal information about the source

      @{" Converting it into a shared library " LINK GCHAP-Converting}
      @{" The GUIGadgetInfo structure " LINK GCHAP-GadgetInfo}
      @{" The GUIInfo Status Flags " LINK GCHAP-Flags}
      @{" Memory allocation " LINK GCHAP-Memory}

 The rest

      @{" Using it as a standard library module " LINK GCHAP-Using}
      @{" Author / Final Words " LINK GCHAP-Author}


 Enjoy GUITools and let the AMIGA live forever !!!


Refer to the GUIToolsV38_1.lha archive for example programs in modula2
and the full documentation of all functions and structures !

@ENDNODE

@NODE GCHAP-Copyright "Copyright"

GUITools software and documentation are ©1994 by Carsten Ziegeler.
All rights reserved.
This package is freeware, this means that you can copy it freely as long
as you don't ask any more money for it than a nominal fee for copying
and as long as the complete GUITools distribution is included. (See
chapter @{" Contents of V38.1 Source Code " LINK GCHAP-Contents}).
This program cannot be used for commercial purposes without the written
permission from the author.
Also commercial distribution of the GUITools package is not allowed
without written permissiom from the @{" author " LINK GCHAP-Author}.
None of the files of the GUITools package may be modified. Crunching or
achiving is allowed only if none of the GUITools files get modified by it.
If you use GUITools please include a remark into your program, that
shows that the program uses GUITools which is © by C.Ziegeler.

@ENDNODE

@NODE GCHAP-Disclaimer "Disclaimer"

The @{" author " LINK GCHAP-Author} cannot be held liable for the suitability or accuracy of this
manual and/or the  program(s) it describes.  Any damage directly or in-
directly caused by the use or misuse of this manual and/or the program(s)
it describes is the sole responsibility of the user himself.
The author is not responsible for any loss of data, damages to software
or hardware that may result directly or indirectly from the use of this
package. The author reserves the right to make changes to the software
and/or documentation without notice.

@ENDNODE

@NODE GCHAP-Contents "Contents of V38.1 Source Code"

The whole GUITools Source Code package version 38.1 consists of the
following files.
If some of these files in your package are missing, please contact the
deliverer immediately. It may be possible that there are some additional
files which are not listed below.

    GUITools_SRC.guide        This general source code documentation

    GUITools.def              The standard modula-2 library modules
    GUITools.mod              for M2Amiga

    GTRequester.def           A standard modula-2 library module
    GTRequester.mod           which contains all the requester stuff
                              of GUITools.

@ENDNODE

@NODE GCHAP-Converting "Converting it into a shared library"

GUITools was converted into a shared library using M2LMC (© C.Ziegeler).
M2LMC simply scans the definition module and changes the parameter lists
into register parameters !

After the conversion with M2LMC, you have to do some changes/replacements
in the file GUIToolsLib.mod before compiling !

- ConvKMsgToGMsg : Change all calls to GadWithKey into GadWithKeyE (2 x)

- OpenIntWindow:  Replace old procedure with this one:

  (*$ EntryExitCode:=FALSE *)
  CONST wst = LONGCARD(waScreenTitle);
  BEGIN
    ASSEMBLE(MOVE.L A2, -(A7)
             MOVE.L #0, -(A7)
             MOVE.L #tagEnd, -(A7)
             MOVE.L A0, -(A7)
             MOVE.L #wst, -(A7)
             MOVE.L A7, A2
             BSR.S  OpenIntWindowTags
             ADD.L  #16, A7
             MOVE.L (A7)+, A2
             RTS    END);

- OpenIntScreen: Replace old procedure with this one:

  (*$ EntryExitCode:=FALSE *)
  BEGIN
  ASSEMBLE(MOVE.L A2, -(A7)
           MOVE.L #0, A2
           BSR.S OpenIntScreenTags
           MOVE.L (A7)+, A2
           RTS END);

- SimpleReq: Replace old procedure with this one

  (*$ EntryExitCode:=FALSE *)
  BEGIN
    ASSEMBLE(MOVE.L A0, A1
             MOVE.L A2, -(A7)
             MOVE.L #0, A0
             MOVE.L #0, A2
             BSR.S ShowRequester
             MOVE.L (A7)+, A2
             RTS END);

@ENDNODE

@NODE GCHAP-GadgetInfo "The GUIGadgetInfo structure"

The ScanGadget procedure gets the following items:

     v3            The gadget number within the gadgets field

     stringKind   : v0L : Resizing : ADR(string)
                    v2  :            string length
     integerKind  : v0I : Resizing : current value
     mxKind       : v0  : gtmxActive
                    v1  : amount of choices
     cycleKind    : v0  : gtcyActive
                    v1  : amount of choices
     checkboxKind : v0B : status
     sliderKind   : v0S : gtslLevel
                    v1S : gtslMax
                    v2S : gtslMin
     scrollerKind : v0S : gtscTop
                    v1S : gtscVisible
                    v2S : gtscTotal
     listviewKind : v0  : gtlvSelected
                    v1  : number of entries (65535 for no entry)
                    v2S : number of custom string gadget (-1 for none)
     paletteKind  : v0  : gtpaColor
                    v1  : 2^gtpaDepth
                    v2  : gtpaColorOffset

     progressIndicatorKind : v0  : piMax
                             v1  : piCurr
     bevelboxKind          : v0B : recessed

@ENDNODE

@NODE GCHAP-Flags "The GUIInfo Status Flags"

The flags (16 bits) are stored in gui^.status.

gadgetsSet         Are the gadgets set ?
menuSet            Is the menu set ?
rememberGadTags    Remember all tags (for RedrawGadgets)
redrawGads         Informs SetGUI about RedrawGadgets(.., FALSE)
                   SetGUI has now to deactivate all gadgets which should
                   not be active and it has to activate the first entry
                   gadget if wanted !
spezialGadsNoText  redraw GUITools gadgets but not the gadget text
                   e.g. for progressIndicator gadgets if only the value
                   changes
restoreProcessWindow when FreeGUIInfo is called the windowPtr entry of
                     the process structure is restored
setProcessWindow     Set the windowPtr entry in CreateGUIInfoTags to
                     the window
refreshWF          Call RefreshWindowFrame within EndRefresh
useGadDesc         Use the gadget description tag for self resizable
                   gadgets

@ENDNODE

@NODE GCHAP-Memory "Memory Allocation"

GUITools allocates for each GUIInfo structure some more space to
store extra information.
After the GUIInfo structure as documented in the definition module
follows a structure called GUIWindowInfo.
This structure is responsible to chain all GUIInfo structures in
a list. The root of the list is stored in the global variable
allWindowsWithGUI. Using this structure CloseIntWindow is able
to free an allocated GUIInfo structure.
After the GUIWindowInfo structure follow the entries with variable
length. For each gadget 4 bytes are reserved to store a GadgetPtr,
so all gadgets can be reached using an array of GadgetPtr.
For each menu entry a NewMenu structure will be reserved.
GUITools gets the amount of gadgets resp menu entries with the
two parameters maxGads and maxMenus !

Some constants used in GUITools.mod:

REALGUILENGTH  The real length of the allocated GUIInfo structure but
               without the variable entries !
GUIWININFO     The offset of the GUIWindowInfo structure
GUIEND         The offset for the variable entries

@ENDNODE

@NODE GCHAP-Using "Using it as a standard library module"

It is possible and also allowed to use GUITools as a standard library
module. The consequences are of course larger code but more independence!

But if you import from GUITools.def instead of from GUIToolsD.def resp.
GUIToolsL.def you should know this:

- GUITools doesn't know the procedures ShowRequesterP and SimpleReqP.
  You have to use IF ShowRequester(..) = 0 THEN END resp.
                  IF SimpleReq(..) = 0 THEN END instead !
- GUITools doesn't know the procedure CreateGadgetNew. Use
  CreateSpecialGadget instead !

@ENDNODE

@NODE GCHAP-Author "Author / Final Words"

Before you are delivered from this boring documentation, I have to do
some apologies:
The whole documentation is not entitled to be complete, without any
mistakes or at least understandable, although I worked really very
hard on it.
If you don't know how to program an Amiga, you can throw the documenta-
tion away. In many cases I left some explanations you can find in the
RKRMs. If you are familar with them, you will probably have no problems.

To reach a "wider audience" I tried to translate the definitions and
the documentation into the english language. I hope you can understand
it and that there will be noone who died by laughing at these texts !

Suggestions, bug reports, improvements, extensions and of course
appreciation, too, can be send to the following address:

    Carsten Ziegeler
    Augustin-Wibbelt-Str. 7
    D-33106 Paderborn
    Germany


ATTENTION: There will be no warranty or responsibility for posted goods.
           If you want to have your work back, you must include enough
           return postage I can use here in germany (e.g. german money
           or german stamps, but not e.g. english stamps or french food).
           All posting will be at your own risk and of your own free will.

You can reach me also under the following EMail-Address:

         tarot@uni-paderborn.de

So please, if possible use electronic mail to avoid any problems !


    Enjoy it !

@ENDNODE

