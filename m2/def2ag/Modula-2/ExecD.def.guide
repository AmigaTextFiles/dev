@database HYPER:Modula-2/ExecD
@node Main "HYPER:Modula-2/ExecD"

Konstanten

   @{" abortIO " link Modul 461}                     @{" aborted " link Modul 484}                     @{" addSWGadget " link Modul 286}
   @{" asyncPkt " link Modul 297}                    @{" audioDev " link Modul 314}                    @{" audioDevObj " link Modul 228}
   @{" badAddress " link Modul 487}                  @{" badChkSum " link Modul 302}                   @{" badExpansionFree " link Modul 312}
   @{" badFreeAddr " link Modul 259}                 @{" badGadget " link Modul 277}                   @{" badInitFunc " link Modul 306}
   @{" badLength " link Modul 486}                   @{" badMessage " link Modul 289}                  @{" badOverlay " link Modul 305}
   @{" badParm " link Modul 210}                     @{" badSegList " link Modul 309}                  @{" badState " link Modul 288}
   @{" base " link Modul 389}                        @{" baseChkSum " link Modul 247}                  @{" beginIO " link Modul 466}
   @{" bitMap " link Modul 300}                      @{" bltBitMap " link Modul 266}                   @{" bogusExcpt " link Modul 254}
   @{" bootError " link Modul 331}                   @{" bootStrap " link Modul 330}                   @{" bootStrapObj " link Modul 237}
   @{" ciaRsrc " link Modul 325}                     @{" ciaRsrcObj " link Modul 234}                  @{" clear " link Modul 475}
   @{" close " link Modul 393}                       @{" closeDev " link Modul 212}                    @{" closeLib " link Modul 211}
   @{" consoleDev " link Modul 315}                  @{" consoleDevObj " link Modul 229}               @{" createPort " link Modul 278}
   @{" deadEnd " link Modul 198}                     @{" diskBlkSeq " link Modul 299}                  @{" diskCopy " link Modul 350}
   @{" diskCopyObj " link Modul 239}                 @{" diskError " link Modul 303}                   @{" diskRsrc " link Modul 326}
   @{" diskRsrcObj " link Modul 235}                 @{" diskfontLib " link Modul 313}                 @{" diskfontLibObj " link Modul 226}
   @{" dosLib " link Modul 293}                      @{" dosLibObj " link Modul 222}                   @{" drHasDisk " link Modul 327}
   @{" drIntNoAct " link Modul 328}                  @{" endTask " link Modul 295}                     @{" excptVect " link Modul 246}
   @{" execLib " link Modul 245}                     @{" execLibObj " link Modul 217}                  @{" execName " link Modul 5}
   @{" expansionLib " link Modul 311}                @{" expansionLibObj " link Modul 225}             @{" expunge " link Modul 394}
   @{" extFunc " link Modul 395}                     @{" fileReclosed " link Modul 307}                @{" flush " link Modul 478}
   @{" freeTwice " link Modul 253}                   @{" freeVec " link Modul 298}                     @{" gadTools " link Modul 351}
   @{" gadToolsObj " link Modul 240}                 @{" gadgetType " link Modul 276}                  @{" gamePortDev " link Modul 317}
   @{" gamePortDevObj " link Modul 230}              @{" gfxFreeError " link Modul 270}                @{" gfxNewError " link Modul 269}
   @{" gfxNoLCM " link Modul 271}                    @{" gfxNoMem " link Modul 261}                    @{" gfxNoMemMspc " link Modul 262}
   @{" graphicsLib " link Modul 260}                 @{" graphicsLibObj " link Modul 218}              @{" iconLib " link Modul 310}
   @{" iconLibObj " link Modul 224}                  @{" initAPtr " link Modul 251}                    @{" intrMem " link Modul 250}
   @{" intuition " link Modul 275}                   @{" intuitionObj " link Modul 220}                @{" invalid " link Modul 470}
   @{" ioAfterClose " link Modul 257}                @{" ioError " link Modul 208}                     @{" ioUsedTwice " link Modul 255}
   @{" itemAlloc " link Modul 279}                   @{" itemBoxTop " link Modul 282}                  @{" keyFree " link Modul 301}
   @{" keyRange " link Modul 304}                    @{" keyboardDev " link Modul 318}                 @{" keyboardDevObj " link Modul 231}
   @{" layersLib " link Modul 273}                   @{" layersLibObj " link Modul 219}                @{" layersNoMem " link Modul 274}
   @{" libChkSum " link Modul 248}                   @{" longFrame " link Modul 263}                   @{" makeLib " link Modul 204}
   @{" makeVPort " link Modul 268}                   @{" matchword " link Modul 536}                   @{" mathLib " link Modul 292}
   @{" mathLibObj " link Modul 221}                  @{" memCorrupt " link Modul 249}                  @{" memoryInsane " link Modul 256}
   @{" miscRsrc " link Modul 329}                    @{" miscRsrcObj " link Modul 236}                 @{" never " link Modul 538}
   @{" nmi " link Modul 67}                         @{" noCmd " link Modul 485}                       @{" noConsole " link Modul 291}
   @{" noFonts " link Modul 333}                     @{" noMemory " link Modul 203}                    @{" noSignal " link Modul 209}
   @{" noWindow " link Modul 316}                    @{" nonStd " link Modul 391}                      @{" nonstd " link Modul 479}
   @{" obsoleteFont " link Modul 272}                @{" open " link Modul 392}                        @{" openDev " link Modul 206}
   @{" openFail " link Modul 483}                    @{" openLib " link Modul 205}                     @{" openRes " link Modul 207}
   @{" openScreen " link Modul 283}                  @{" openScrnRast " link Modul 284}                @{" openWindow " link Modul 287}
   @{" planeAlloc " link Modul 281}                  @{" procCreate " link Modul 213}                  @{" qPktFail " link Modul 296}
   @{" quick " link Modul 434}                       @{" ramLib " link Modul 308}                      @{" ramLibObj " link Modul 223}
   @{" read " link Modul 472}                        @{" recovery " link Modul 199}                    @{" regionMemory " link Modul 267}
   @{" reserved " link Modul 388}                    @{" reset " link Modul 471}                       @{" selfTest " link Modul 489}
   @{" semCorrupt " link Modul 252}                  @{" shortFrame " link Modul 264}                  @{" sigAbort " link Modul 184}
   @{" sigBlit " link Modul 190}                     @{" sigChild " link Modul 189}                    @{" sigDos " link Modul 193}
   @{" sigIntuition " link Modul 192}                @{" sigSingle " link Modul 191}                   @{" stackProbe " link Modul 258}
   @{" start " link Modul 477}                       @{" startMem " link Modul 294}                    @{" stop " link Modul 476}
   @{" subAlloc " link Modul 280}                    @{" sysScrnType " link Modul 285}                 @{" tdCalibSeek " link Modul 320}
   @{" tdDelay " link Modul 321}                     @{" textTmpRas " link Modul 265}                  @{" timerDev " link Modul 322}
   @{" timerDevObj " link Modul 233}                 @{" tmBadReq " link Modul 323}                    @{" tmBadSupply " link Modul 324}
   @{" trackDiskDev " link Modul 319}                @{" trackDiskDevObj " link Modul 232}             @{" unitBusy " link Modul 488}
   @{" unknownObj " link Modul 241}                  @{" unknownSubsystem " link Modul 353}            @{" update " link Modul 474}
   @{" userDef " link Modul 390}                     @{" utilityLib " link Modul 352}                  @{" utilityLibObj " link Modul 227}
   @{" vectSize " link Modul 386}                    @{" wbAddToolMenuItem " link Modul 341}           @{" wbBadIOMsg " link Modul 336}
   @{" wbBadStartupMsg1 " link Modul 334}            @{" wbBadStartupMsg2 " link Modul 335}            @{" wbCreateWBMenusCreateMenus1 " link Modul 338}
   @{" wbCreateWBMenusCreateMenus2 " link Modul 339}   @{" wbInitLayerDemon " link Modul 344}            @{" wbInitPotionAllocDrawer " link Modul 337}
   @{" wbInitScreenAndWindows1 " link Modul 346}     @{" wbInitScreenAndWindows2 " link Modul 347}     @{" wbInitScreenAndWindows3 " link Modul 348}
   @{" wbInitTimer " link Modul 343}                 @{" wbInitWbGels " link Modul 345}                @{" wbLayoutWBMenusLayoutMenus " link Modul 340}
   @{" wbMAlloc " link Modul 349}                    @{" wbReLayoutToolMenu " link Modul 342}          @{" weirdEcho " link Modul 290}
   @{" workbench " link Modul 332}                   @{" workbenchObj " link Modul 238}                @{" write " link Modul 473}


Variablen

   @{" execBase " link Modul 633}                 

Typ-Deklarationen

   @{" AttnFlagSet " link Modul 554}                 @{" AttnFlags " link Modul 543}                   @{" CacheFlagSet " link Modul 562}
   @{" CacheFlags " link Modul 556}                  @{" DMAControlFlagSet " link Modul 565}           @{" DMAControlFlags " link Modul 564}
   @{" Device " link Modul 417}                      @{" DevicePtr " link Modul 420}                   @{" ExecBase " link Modul 567}
   @{" ExecBasePtr " link Modul 631}                 @{" IOFlagSet " link Modul 431}                   @{" IORequest " link Modul 437}
   @{" IORequestPtr " link Modul 446}                @{" IOStdReq " link Modul 447}                    @{" IOStdReqPtr " link Modul 459}
   @{" IntFlags " link Modul 47}                    @{" IntVector " link Modul 57}                   @{" Interrupt " link Modul 51}
   @{" InterruptPtr " link Modul 56}                @{" LibFlagSet " link Modul 399}                  @{" LibFlags " link Modul 397}
   @{" Library " link Modul 400}                     @{" LibraryPtr " link Modul 412}                  @{" List " link Modul 30}
   @{" ListPtr " link Modul 37}                     @{" MemChunk " link Modul 89}                    @{" MemChunkPtr " link Modul 88}
   @{" MemEntry " link Modul 102}                    @{" MemHeader " link Modul 93}                   @{" MemHeaderPtr " link Modul 101}
   @{" MemList " link Modul 109}                     @{" MemListPtr " link Modul 142}                  @{" MemReqSet " link Modul 86}
   @{" MemReqs " link Modul 73}                     @{" MemTypeSet " link Modul 87}                  @{" Message " link Modul 376}
   @{" MessagePtr " link Modul 381}                  @{" MinList " link Modul 38}                     @{" MinListPtr " link Modul 43}
   @{" MinNode " link Modul 26}                     @{" MinNodePtr " link Modul 25}                  @{" MsgPort " link Modul 360}
   @{" MsgPortAction " link Modul 358}               @{" MsgPortPtr " link Modul 375}                  @{" Node " link Modul 18}
   @{" NodePtr " link Modul 17}                     @{" NodeType " link Modul 8}                    @{" Resident " link Modul 523}
   @{" ResidentFlagSet " link Modul 521}             @{" ResidentFlags " link Modul 517}               @{" ResidentPtr " link Modul 522}
   @{" Semaphore " link Modul 494}                   @{" SemaphorePtr " link Modul 499}                @{" SemaphoreRequest " link Modul 500}
   @{" SignalSemaphore " link Modul 504}             @{" SignalSemaphorePtr " link Modul 512}          @{" SoftIntList " link Modul 62}
   @{" StackSwapStruct " link Modul 178}             @{" Task " link Modul 152}                        @{" TaskFlagSet " link Modul 150}
   @{" TaskFlags " link Modul 147}                   @{" TaskPtr " link Modul 176}                     @{" TaskState " link Modul 151}
   @{" Unit " link Modul 423}                        @{" UnitFlagSet " link Modul 422}                 @{" UnitFlags " link Modul 421}
   @{" UnitPtr " link Modul 429}                  

@endnode
@node Modul "HYPER:Modula-2/ExecD.def.guide"
DEFINITION MODULE ExecD; (*$ Implementation:=FALSE *)
(* 02-Feb-1992/cn *)

FROM SYSTEM IMPORT ADDRESS,BITSET,BPTR,BYTE,LONGSET,SHORTSET,WORD;

CONST
 execName="exec.library";

TYPE
(*
 Listenverwaltung
*)
 @{" NodeType " link HYPER:Modula-2/ExecD.def.guide/Modul 8}=(
  unknown,task,interrupt,device,msgPort,message,freeMsg,
  replyMsg,resource,library,memory,softInt,font,process,
  semaphore,signalSem,bootNode,kickMem,graphics,deathMessage
 );
 @{" NodePtr " link HYPER:Modula-2/ExecD.def.guide/Modul 17}=POINTER TO @{" Node " link HYPER:Modula-2/ExecD.def.guide/Modul 18};
 @{" Node " link HYPER:Modula-2/ExecD.def.guide/Modul 18}=RECORD
   succ:@{" NodePtr " link HYPER:Modula-2/ExecD.def.guide/Modul 17};
   pred:@{" NodePtr " link HYPER:Modula-2/ExecD.def.guide/Modul 17};
   type:@{" NodeType " link HYPER:Modula-2/ExecD.def.guide/Modul 8};
   pri:SHORTINT;
   name:ADDRESS;
 END;
 @{" MinNodePtr " link HYPER:Modula-2/ExecD.def.guide/Modul 25}=POINTER TO @{" MinNode " link HYPER:Modula-2/ExecD.def.guide/Modul 26};
 @{" MinNode " link HYPER:Modula-2/ExecD.def.guide/Modul 26}=RECORD
   succ:@{" MinNodePtr " link HYPER:Modula-2/ExecD.def.guide/Modul 25};
   pred:@{" MinNodePtr " link HYPER:Modula-2/ExecD.def.guide/Modul 25};
 END;
 @{" List " link HYPER:Modula-2/ExecD.def.guide/Modul 30}=RECORD
   head:@{" NodePtr " link HYPER:Modula-2/ExecD.def.guide/Modul 17};
   tail:@{" NodePtr " link HYPER:Modula-2/ExecD.def.guide/Modul 17};
   tailPred:@{" NodePtr " link HYPER:Modula-2/ExecD.def.guide/Modul 17};
   type:@{" NodeType " link HYPER:Modula-2/ExecD.def.guide/Modul 8};
   pad:BYTE;
 END;
 @{" ListPtr " link HYPER:Modula-2/ExecD.def.guide/Modul 37}=POINTER TO @{" List " link HYPER:Modula-2/ExecD.def.guide/Modul 30};
 @{" MinList " link HYPER:Modula-2/ExecD.def.guide/Modul 38}=RECORD
   head:@{" MinNodePtr " link HYPER:Modula-2/ExecD.def.guide/Modul 25};
   tail:@{" MinNodePtr " link HYPER:Modula-2/ExecD.def.guide/Modul 25};
   tailPred:@{" MinNodePtr " link HYPER:Modula-2/ExecD.def.guide/Modul 25};
 END;
 @{" MinListPtr " link HYPER:Modula-2/ExecD.def.guide/Modul 43}=POINTER TO @{" MinList " link HYPER:Modula-2/ExecD.def.guide/Modul 38};
(*
 Interrupts
*)
  @{" IntFlags " link HYPER:Modula-2/ExecD.def.guide/Modul 47}=(
    tbeInt,dskblk,ifSoftint,ports,coper,vertb,blit,aud0i,
    aud1i,aud2i,aud3i,rbfInt,disksync,exter,inten,intSet
  );
  @{" Interrupt " link HYPER:Modula-2/ExecD.def.guide/Modul 51}=RECORD
    node:@{" Node " link HYPER:Modula-2/ExecD.def.guide/Modul 18};
    data:ADDRESS;
    code:PROC;
  END;
  @{" InterruptPtr " link HYPER:Modula-2/ExecD.def.guide/Modul 56}=POINTER TO @{" Interrupt " link HYPER:Modula-2/ExecD.def.guide/Modul 51};
  @{" IntVector " link HYPER:Modula-2/ExecD.def.guide/Modul 57}=RECORD
    data:ADDRESS;
    code:PROC;
    node:@{" NodePtr " link HYPER:Modula-2/ExecD.def.guide/Modul 17};
  END;
  @{" SoftIntList " link HYPER:Modula-2/ExecD.def.guide/Modul 62}=RECORD
    list:@{" List " link HYPER:Modula-2/ExecD.def.guide/Modul 30};
    pad:WORD;
  END;

CONST
 nmi=intSet;

(*
 Speicherverwaltung
*)
TYPE
  @{" MemReqs " link HYPER:Modula-2/ExecD.def.guide/Modul 73}=(
    public,chip,fast,mr3,mr4,mr5,mr6,mr7,
    local,dma24Bit,mr10,mr11,mr12,mr13,mr14,mr15,memClear,largest,
    reverse,total
  );
  (*
   Beachte:
    "MemReqSet" ist 32 bit gross und enthält alle Flags aus "MemReqs".
    "MemTypeSet" ist nur 16 bit gross und enthält die von gewissen
    Speicherverwaltungsprozeduren zusätzlich benötigten Flags
    "memClear", "largest", "reverse" und "total" nicht.
  *)
  @{" MemReqSet " link HYPER:Modula-2/ExecD.def.guide/Modul 86}=SET OF @{" MemReqs " link HYPER:Modula-2/ExecD.def.guide/Modul 73};
  @{" MemTypeSet " link HYPER:Modula-2/ExecD.def.guide/Modul 87}=SET OF [public..mr15];
  @{" MemChunkPtr " link HYPER:Modula-2/ExecD.def.guide/Modul 88}=POINTER TO @{" MemChunk " link HYPER:Modula-2/ExecD.def.guide/Modul 89};
  @{" MemChunk " link HYPER:Modula-2/ExecD.def.guide/Modul 89}=RECORD
    next:@{" MemChunkPtr " link HYPER:Modula-2/ExecD.def.guide/Modul 88};
    bytes:LONGCARD;
  END;
  @{" MemHeader " link HYPER:Modula-2/ExecD.def.guide/Modul 93}=RECORD
    node:@{" Node " link HYPER:Modula-2/ExecD.def.guide/Modul 18};
    attributes:@{" MemTypeSet " link HYPER:Modula-2/ExecD.def.guide/Modul 87};
    first:@{" MemChunkPtr " link HYPER:Modula-2/ExecD.def.guide/Modul 88};
    lower:ADDRESS;
    upper:ADDRESS;
    free:LONGCARD;
  END;
  @{" MemHeaderPtr " link HYPER:Modula-2/ExecD.def.guide/Modul 101}=POINTER TO @{" MemHeader " link HYPER:Modula-2/ExecD.def.guide/Modul 93};
  @{" MemEntry " link HYPER:Modula-2/ExecD.def.guide/Modul 102}=RECORD
    CASE :INTEGER OF
    | 1: reqs:@{" MemReqSet " link HYPER:Modula-2/ExecD.def.guide/Modul 86}
    | 2: addr:ADDRESS
    END;
    length:LONGCARD;
  END;
  @{" MemList " link HYPER:Modula-2/ExecD.def.guide/Modul 109}=RECORD
    node:@{" Node " link HYPER:Modula-2/ExecD.def.guide/Modul 18};
    numEntries:CARDINAL;
    (*
     der hier anschliessende Speicherplatz enthält MemEntry
     Elemente. Am besten deklariert man sich je nach Fall einen
     eignen Typ, der aus einem MemList Feld gefolgt von einem
     MemEntry Array. Das Beispiel auf Seite 135 der 3. Ausgabe
     des RKM Autodocs & Includes würde in M2Amiga so aussehen:

       VAR
        mem=RECORD
         list:MemList;
         entries:ARRAY [1..5] OF MemEntry;
        END;
        res:MemListPtr;
       BEGIN
        mem.list.numEntries:=5;
        mem.entries[1].reqs:=MemReqSet{memClear};
        mem.entries[1].length:=2;
        mem.entries[2].reqs:=MemReqSet{public};
        mem.entries[2].length:=4;
        mem.entries[3].reqs:=MemReqSet{chip,memClear};
        mem.entries[3].length:=8;
        mem.entries[4].reqs:=MemReqSet{memClear};
        mem.entries[4].length:=16;
        mem.entries[5].reqs:=MemReqSet{public,memClear};
        mem.entries[5].length:=32;
        res:=AllocEntry(ADR(mem));
        IF LONGINT(ADDRESS(res))>0 THEN
         (* Speicherallozierung war erfolgreich. *)
    *)
  END;
  @{" MemListPtr " link HYPER:Modula-2/ExecD.def.guide/Modul 142}=POINTER TO @{" MemList " link HYPER:Modula-2/ExecD.def.guide/Modul 109};

(*
 Tasks
*)
  @{" TaskFlags " link HYPER:Modula-2/ExecD.def.guide/Modul 147}=(
    procTime,tf1,tf2,eTask,stackChk,exception,switch,launch
  );
  @{" TaskFlagSet " link HYPER:Modula-2/ExecD.def.guide/Modul 150}=SET OF @{" TaskFlags " link HYPER:Modula-2/ExecD.def.guide/Modul 147};
  @{" TaskState " link HYPER:Modula-2/ExecD.def.guide/Modul 151}=(inval,added,run,ready,wait,except,removed);
  @{" Task " link HYPER:Modula-2/ExecD.def.guide/Modul 152}=RECORD
    node:@{" Node " link HYPER:Modula-2/ExecD.def.guide/Modul 18};
    flags:@{" TaskFlagSet " link HYPER:Modula-2/ExecD.def.guide/Modul 150};
    state:@{" TaskState " link HYPER:Modula-2/ExecD.def.guide/Modul 151};
    idNestCnt:SHORTINT;
    tdNestCnt:SHORTINT;
    sigAlloc:LONGSET;
    sigWait:LONGSET;
    sigRecvd:LONGSET;
    sigExcept:LONGSET;
    trapAlloc:BITSET;
    trapAble:BITSET;
    exceptData:ADDRESS;
    exceptCode:PROC;
    trapData:ADDRESS;
    trapCode:PROC;
    spReg:ADDRESS;
    spLower:ADDRESS;
    spUpper:ADDRESS;
    switch:PROC;
    launch:PROC;
    memEntry:@{" List " link HYPER:Modula-2/ExecD.def.guide/Modul 30};
    userData:ADDRESS;
  END;
  @{" TaskPtr " link HYPER:Modula-2/ExecD.def.guide/Modul 176}=POINTER TO @{" Task " link HYPER:Modula-2/ExecD.def.guide/Modul 152};

  @{" StackSwapStruct " link HYPER:Modula-2/ExecD.def.guide/Modul 178}=RECORD
    lower:ADDRESS;
    upper:ADDRESS;
    pointer:ADDRESS;
  END;

CONST
(*
 Vordefinierte Signalnummern
*)
  sigAbort=0;
  sigChild=1;
  sigBlit=4;
  sigSingle=sigBlit;
  sigIntuition=5;
  sigDos=8;

(*
 Alertarten
*)
 deadEnd=080000000H;
 recovery=000000000H;
(*
 Allgemeine Alertcodes
*)
 noMemory=000010000H;
 makeLib=000020000H;
 openLib=000030000H;
 openDev=000040000H;
 openRes=000050000H;
 ioError=000060000H;
 noSignal=000070000H;
 badParm=000080000H;
 closeLib=000090000H;
 closeDev=0000A0000H;
 procCreate=0000B0000H;
(*
 Alertobjekte
*)
 execLibObj=000008001H;
 graphicsLibObj=000008002H;
 layersLibObj=000008003H;
 intuitionObj=000008004H;
 mathLibObj=000008005H;
 dosLibObj=000008007H;
 ramLibObj=000008008H;
 iconLibObj=000008009H;
 expansionLibObj=00000800AH;
 diskfontLibObj=00000800BH;
 utilityLibObj=00000800CH;
 audioDevObj=000008010H;
 consoleDevObj=000008011H;
 gamePortDevObj=000008012H;
 keyboardDevObj=000008013H;
 trackDiskDevObj=000008014H;
 timerDevObj=000008015H;
 ciaRsrcObj=000008020H;
 diskRsrcObj=000008021H;
 miscRsrcObj=000008022H;
 bootStrapObj=000008030H;
 workbenchObj=000008031H;
 diskCopyObj=000008032H;
 gadToolsObj=000008033H;
 unknownObj=000008035H;
(*
 Spezifische Alerts
*)
 execLib=001000000H;
 excptVect=001000001H;
 baseChkSum=001000002H;
 libChkSum=001000003H;
 memCorrupt=081000005H;
 intrMem=081000006H;
 initAPtr=001000007H;
 semCorrupt=001000008H;
 freeTwice=001000009H;
 bogusExcpt=08100000AH;
 ioUsedTwice=00100000BH;
 memoryInsane=00100000CH;
 ioAfterClose=00100000DH;
 stackProbe=00100000EH;
 badFreeAddr=00100000FH;
 graphicsLib=002000000H;
 gfxNoMem=082010000H;
 gfxNoMemMspc=082010001H;
 longFrame=082010006H;
 shortFrame=082010007H;
 textTmpRas=002010009H;
 bltBitMap=08201000AH;
 regionMemory=08201000BH;
 makeVPort=082010030H;
 gfxNewError=00200000CH;
 gfxFreeError=00200000DH;
 gfxNoLCM=082011234H;
 obsoleteFont=002000401H;
 layersLib=003000000H;
 layersNoMem=083010000H;
 intuition=004000000H;
 gadgetType=084000001H;
 badGadget=004000001H;
 createPort=084010002H;
 itemAlloc=004010003H;
 subAlloc=004010004H;
 planeAlloc=084010005H;
 itemBoxTop=084000006H;
 openScreen=084010007H;
 openScrnRast=084010008H;
 sysScrnType=084000009H;
 addSWGadget=08401000AH;
 openWindow=08401000BH;
 badState=08400000CH;
 badMessage=08400000DH;
 weirdEcho=08400000EH;
 noConsole=08400000FH;
 mathLib=005000000H;
 dosLib=007000000H;
 startMem=007010001H;
 endTask=007000002H;
 qPktFail=007000003H;
 asyncPkt=007000004H;
 freeVec=007000005H;
 diskBlkSeq=007000006H;
 bitMap=007000007H;
 keyFree=007000008H;
 badChkSum=007000009H;
 diskError=00700000AH;
 keyRange=00700000BH;
 badOverlay=00700000CH;
 badInitFunc=00700000DH;
 fileReclosed=00700000EH;
 ramLib=008000000H;
 badSegList=008000001H;
 iconLib=009000000H;
 expansionLib=00A000000H;
 badExpansionFree=00A000001H;
 diskfontLib=00B000000H;
 audioDev=010000000H;
 consoleDev=011000000H;
 noWindow=011000001H;
 gamePortDev=012000000H;
 keyboardDev=013000000H;
 trackDiskDev=014000000H;
 tdCalibSeek=014000001H;
 tdDelay=014000002H;
 timerDev=015000000H;
 tmBadReq=015000001H;
 tmBadSupply=015000002H;
 ciaRsrc=020000000H;
 diskRsrc=021000000H;
 drHasDisk=021000001H;
 drIntNoAct=021000002H;
 miscRsrc=022000000H;
 bootStrap=030000000H;
 bootError=030000001H;
 workbench=031000000H;
 noFonts=0B1000001H;
 wbBadStartupMsg1=031000001H;
 wbBadStartupMsg2=031000002H;
 wbBadIOMsg=031000003H;
 wbInitPotionAllocDrawer=0B1010004H;
 wbCreateWBMenusCreateMenus1=0B1010005H;
 wbCreateWBMenusCreateMenus2=0B1010006H;
 wbLayoutWBMenusLayoutMenus=0B1010007H;
 wbAddToolMenuItem=0B1010008H;
 wbReLayoutToolMenu=0B1010009H;
 wbInitTimer=0B101000AH;
 wbInitLayerDemon=0B101000BH;
 wbInitWbGels=0B101000CH;
 wbInitScreenAndWindows1=0B101000DH;
 wbInitScreenAndWindows2=0B101000EH;
 wbInitScreenAndWindows3=0B101000FH;
 wbMAlloc=0B1010010H;
 diskCopy=032000000H;
 gadTools=033000000H;
 utilityLib=034000000H;
 unknownSubsystem=035000000H;

(*
 Meldungen
*)
TYPE
  @{" MsgPortAction " link HYPER:Modula-2/ExecD.def.guide/Modul 358}=(signal, softint, ignore);
  @{" MsgPort " link HYPER:Modula-2/ExecD.def.guide/Modul 360}=RECORD
    node:@{" Node " link HYPER:Modula-2/ExecD.def.guide/Modul 18};
    CASE flags:@{" MsgPortAction " link HYPER:Modula-2/ExecD.def.guide/Modul 358} OF
    | signal:
      sigBit:SHORTCARD;
      sigTask:@{" TaskPtr " link HYPER:Modula-2/ExecD.def.guide/Modul 176};
    | softint:
      pad0:BYTE;
      softInt:@{" InterruptPtr " link HYPER:Modula-2/ExecD.def.guide/Modul 56};
    | ignore:
      pad1:BYTE;
      pad2:ADDRESS
    END;
    msgList:@{" List " link HYPER:Modula-2/ExecD.def.guide/Modul 30};
  END;
  @{" MsgPortPtr " link HYPER:Modula-2/ExecD.def.guide/Modul 375}=POINTER TO @{" MsgPort " link HYPER:Modula-2/ExecD.def.guide/Modul 360};
  @{" Message " link HYPER:Modula-2/ExecD.def.guide/Modul 376}=RECORD
    node:@{" Node " link HYPER:Modula-2/ExecD.def.guide/Modul 18};
    replyPort:@{" MsgPortPtr " link HYPER:Modula-2/ExecD.def.guide/Modul 375};
    length:CARDINAL;
  END;
  @{" MessagePtr " link HYPER:Modula-2/ExecD.def.guide/Modul 381}=POINTER TO @{" Message " link HYPER:Modula-2/ExecD.def.guide/Modul 376};

(*
 Bibliotheken
*)
CONST
  vectSize=6;
  reserved=4;
  base=-vectSize;
  userDef=base-reserved*vectSize;
  nonStd=userDef;
  open=-6;
  close=-12;
  expunge=-18;
  extFunc=-24;

TYPE
  @{" LibFlags " link HYPER:Modula-2/ExecD.def.guide/Modul 397}=(summing,changed,sumUsed,delExp);
  @{" LibFlagSet " link HYPER:Modula-2/ExecD.def.guide/Modul 399}=SET OF @{" LibFlags " link HYPER:Modula-2/ExecD.def.guide/Modul 397};
  @{" Library " link HYPER:Modula-2/ExecD.def.guide/Modul 400}=RECORD
    node:@{" Node " link HYPER:Modula-2/ExecD.def.guide/Modul 18};
    flags:@{" LibFlagSet " link HYPER:Modula-2/ExecD.def.guide/Modul 399};
    pad:BYTE;
    negSize:CARDINAL;
    posSize:CARDINAL;
    version:CARDINAL;
    revision:CARDINAL;
    idString:ADDRESS;
    sum:LONGCARD;
    openCnt:CARDINAL;
  END;
  @{" LibraryPtr " link HYPER:Modula-2/ExecD.def.guide/Modul 412}=POINTER TO @{" Library " link HYPER:Modula-2/ExecD.def.guide/Modul 400};

(*
 Devices und I/O
*)
  @{" Device " link HYPER:Modula-2/ExecD.def.guide/Modul 417}=RECORD
    library:@{" Library " link HYPER:Modula-2/ExecD.def.guide/Modul 400};
  END;
  @{" DevicePtr " link HYPER:Modula-2/ExecD.def.guide/Modul 420}=POINTER TO @{" Device " link HYPER:Modula-2/ExecD.def.guide/Modul 417};
  @{" UnitFlags " link HYPER:Modula-2/ExecD.def.guide/Modul 421}=(active,inTask,uf2,uf3,uf4,uf5,uf6,uf7);
  @{" UnitFlagSet " link HYPER:Modula-2/ExecD.def.guide/Modul 422}=SET OF @{" UnitFlags " link HYPER:Modula-2/ExecD.def.guide/Modul 421};
  @{" Unit " link HYPER:Modula-2/ExecD.def.guide/Modul 423}=RECORD
    msgPort:@{" MsgPort " link HYPER:Modula-2/ExecD.def.guide/Modul 360};
    flags:@{" UnitFlagSet " link HYPER:Modula-2/ExecD.def.guide/Modul 422};
    pad:BYTE;
    openCnt:CARDINAL;
  END;
  @{" UnitPtr " link HYPER:Modula-2/ExecD.def.guide/Modul 429}=POINTER TO @{" Unit " link HYPER:Modula-2/ExecD.def.guide/Modul 423};

TYPE
  @{" IOFlagSet " link HYPER:Modula-2/ExecD.def.guide/Modul 431}=SHORTSET;

CONST
  quick=@{" IOFlagSet " link HYPER:Modula-2/ExecD.def.guide/Modul 431}{0};

TYPE
  @{" IORequest " link HYPER:Modula-2/ExecD.def.guide/Modul 437}=RECORD
    message:@{" Message " link HYPER:Modula-2/ExecD.def.guide/Modul 376};
    device:@{" DevicePtr " link HYPER:Modula-2/ExecD.def.guide/Modul 420};
    unit:@{" UnitPtr " link HYPER:Modula-2/ExecD.def.guide/Modul 429};
    command:CARDINAL;
    flags:@{" IOFlagSet " link HYPER:Modula-2/ExecD.def.guide/Modul 431};
    error:SHORTINT;
  END;
  @{" IORequestPtr " link HYPER:Modula-2/ExecD.def.guide/Modul 446}=POINTER TO @{" IORequest " link HYPER:Modula-2/ExecD.def.guide/Modul 437};
  @{" IOStdReq " link HYPER:Modula-2/ExecD.def.guide/Modul 447}=RECORD
    message:@{" Message " link HYPER:Modula-2/ExecD.def.guide/Modul 376};
    device:@{" DevicePtr " link HYPER:Modula-2/ExecD.def.guide/Modul 420};
    unit:@{" UnitPtr " link HYPER:Modula-2/ExecD.def.guide/Modul 429};
    command:CARDINAL;
    flags:@{" IOFlagSet " link HYPER:Modula-2/ExecD.def.guide/Modul 431};
    error:SHORTINT;
    actual:LONGCARD;
    length:LONGINT;
    data:ADDRESS;
    offset:LONGCARD;
  END;
  @{" IOStdReqPtr " link HYPER:Modula-2/ExecD.def.guide/Modul 459}=POINTER TO @{" IOStdReq " link HYPER:Modula-2/ExecD.def.guide/Modul 447};

CONST
(*
 Offsets der devicespezifischen Funktionen
*)
  abortIO=-36;
  beginIO=-30;
(*
 Standardbefehle für IORequest.command
*)
  invalid=0;
  reset=1;
  read=2;
  write=3;
  update=4;
  clear=5;
  stop=6;
  start=7;
  flush=8;
  nonstd=9;
(*
 Standard Fehlerwerte fuer IORequest.error
*)
  openFail=-1;
  aborted=-2;
  noCmd=-3;
  badLength=-4;
  badAddress=-5;
  unitBusy=-6;
  selfTest=-7;

(*
 Semaphore
*)
TYPE
  @{" Semaphore " link HYPER:Modula-2/ExecD.def.guide/Modul 494}=RECORD
    msgPort:@{" MsgPort " link HYPER:Modula-2/ExecD.def.guide/Modul 360};
    bids:INTEGER;
  END;
  @{" SemaphorePtr " link HYPER:Modula-2/ExecD.def.guide/Modul 499}=POINTER TO @{" Semaphore " link HYPER:Modula-2/ExecD.def.guide/Modul 494};
  @{" SemaphoreRequest " link HYPER:Modula-2/ExecD.def.guide/Modul 500}=RECORD
    link:@{" MinNode " link HYPER:Modula-2/ExecD.def.guide/Modul 26};
    waiter:@{" TaskPtr " link HYPER:Modula-2/ExecD.def.guide/Modul 176};
  END;
  @{" SignalSemaphore " link HYPER:Modula-2/ExecD.def.guide/Modul 504}=RECORD
    link:@{" Node " link HYPER:Modula-2/ExecD.def.guide/Modul 18};
    nestCount:INTEGER;
    waitQueue:@{" MinList " link HYPER:Modula-2/ExecD.def.guide/Modul 38};
    multipleLink:@{" SemaphoreRequest " link HYPER:Modula-2/ExecD.def.guide/Modul 500};
    owner:@{" TaskPtr " link HYPER:Modula-2/ExecD.def.guide/Modul 176};
    queueCount:INTEGER;
  END;
  @{" SignalSemaphorePtr " link HYPER:Modula-2/ExecD.def.guide/Modul 512}=POINTER TO @{" SignalSemaphore " link HYPER:Modula-2/ExecD.def.guide/Modul 504};

(*
 Residentstruktur
*)
TYPE
  @{" ResidentFlags " link HYPER:Modula-2/ExecD.def.guide/Modul 517}=(
   coldstart,singleTask,afterDos,rf3,rf4,rf5,rf6,autoinit
  );
  @{" ResidentFlagSet " link HYPER:Modula-2/ExecD.def.guide/Modul 521}=SET OF @{" ResidentFlags " link HYPER:Modula-2/ExecD.def.guide/Modul 517};
  @{" ResidentPtr " link HYPER:Modula-2/ExecD.def.guide/Modul 522}=POINTER TO @{" Resident " link HYPER:Modula-2/ExecD.def.guide/Modul 523};
  @{" Resident " link HYPER:Modula-2/ExecD.def.guide/Modul 523}=RECORD
    matchWord:CARDINAL;
    matchTag:@{" ResidentPtr " link HYPER:Modula-2/ExecD.def.guide/Modul 522};
    endSkip:ADDRESS;
    flags:@{" ResidentFlagSet " link HYPER:Modula-2/ExecD.def.guide/Modul 521};
    version:SHORTCARD;
    type:@{" NodeType " link HYPER:Modula-2/ExecD.def.guide/Modul 8};
    pri:SHORTINT;
    name:ADDRESS;
    idString:ADDRESS;
    init:ADDRESS;
  END;

CONST
  matchword=04AFCH;
  never=@{" ResidentFlagSet " link HYPER:Modula-2/ExecD.def.guide/Modul 521}{};

(*
 Librarystruktur vn Exec
*)
TYPE
  @{" AttnFlags " link HYPER:Modula-2/ExecD.def.guide/Modul 543}=(
    m68010,
    m68020,
    m68030,
    m68040,
    m68881,
    m68882,
    fpu40,
    af7,reserved8,reserved9,af10,af11,af12,af13,af14,private
  );
  @{" AttnFlagSet " link HYPER:Modula-2/ExecD.def.guide/Modul 554}=SET OF @{" AttnFlags " link HYPER:Modula-2/ExecD.def.guide/Modul 543};

  @{" CacheFlags " link HYPER:Modula-2/ExecD.def.guide/Modul 556}=(
    enableI,freezeI,cf2,clearI,ibe,cf5,cf6,cf7,
    enableD,freezeD,cf10,clearD,dbe,writeAllocate,cf14,cf15,
    cf16,cf17,cf18,cf19,cf20,cf21,cf22,cf23,
    cf24,cf25,cf26,cf27,cf28,cf29,cf30,copyBack
  );
  @{" CacheFlagSet " link HYPER:Modula-2/ExecD.def.guide/Modul 562}=SET OF @{" CacheFlags " link HYPER:Modula-2/ExecD.def.guide/Modul 556};

  @{" DMAControlFlags " link HYPER:Modula-2/ExecD.def.guide/Modul 564}=(continue,noModify);
  @{" DMAControlFlagSet " link HYPER:Modula-2/ExecD.def.guide/Modul 565}=SET OF @{" DMAControlFlags " link HYPER:Modula-2/ExecD.def.guide/Modul 564};

  @{" ExecBase " link HYPER:Modula-2/ExecD.def.guide/Modul 567}=RECORD
    libNode:@{" Library " link HYPER:Modula-2/ExecD.def.guide/Modul 400};
    softVer:CARDINAL;
    lowMemChkSum:INTEGER;
    chkBase:LONGCARD;
    coldCapture:ADDRESS;
    coolCapture:ADDRESS;
    warmCapture:ADDRESS;
    sysStkUpper:ADDRESS;
    sysStkLower:ADDRESS;
    maxLocMem:LONGCARD;
    debugEntry:ADDRESS;
    debugData:ADDRESS;
    alertData:ADDRESS;
    maxExtMem:ADDRESS;
    chkSum:CARDINAL;
    intVects:ARRAY @{" IntFlags " link HYPER:Modula-2/ExecD.def.guide/Modul 47} OF @{" IntVector " link HYPER:Modula-2/ExecD.def.guide/Modul 57};
    thisTask:@{" TaskPtr " link HYPER:Modula-2/ExecD.def.guide/Modul 176};
    idleCount:LONGCARD;
    dispCount:LONGCARD;
    quantum:CARDINAL;
    elapsed:CARDINAL;
    sysFlags:CARDINAL;
    idNestCnt:SHORTINT;
    tdNestCnt:SHORTINT;
    attnFlags:@{" AttnFlagSet " link HYPER:Modula-2/ExecD.def.guide/Modul 554};
    attnResched:CARDINAL;
    resModules:ADDRESS;
    taskTrapCode:PROC;
    taskExceptCode:PROC;
    taskExitCode:PROC;
    taskSigAlloc:LONGSET;
    taskTrapAlloc:BITSET;
    memList:@{" List " link HYPER:Modula-2/ExecD.def.guide/Modul 30};
    resourceList:@{" List " link HYPER:Modula-2/ExecD.def.guide/Modul 30};
    deviceList:@{" List " link HYPER:Modula-2/ExecD.def.guide/Modul 30};
    intrList:@{" List " link HYPER:Modula-2/ExecD.def.guide/Modul 30};
    libList:@{" List " link HYPER:Modula-2/ExecD.def.guide/Modul 30};
    portList:@{" List " link HYPER:Modula-2/ExecD.def.guide/Modul 30};
    taskReady:@{" List " link HYPER:Modula-2/ExecD.def.guide/Modul 30};
    taskWait:@{" List " link HYPER:Modula-2/ExecD.def.guide/Modul 30};
    softInts:ARRAY [0..4] OF @{" SoftIntList " link HYPER:Modula-2/ExecD.def.guide/Modul 62};
    lastAlert:ARRAY [0..3] OF LONGINT;
    vBlankFrequency:SHORTCARD;
    powerSupplyFrequency:SHORTCARD;
    semaphoreList:@{" List " link HYPER:Modula-2/ExecD.def.guide/Modul 30};
    kickMemPtr:ADDRESS;
    kickTagPtr:ADDRESS;
    kickCheckSum:LONGCARD;
    (*
     Neu ab Version 36:
    *)
    pad0:CARDINAL;
    launchPoint:LONGCARD;
    ramLibPrivate:ADDRESS;
    eClockFrequency:LONGCARD;
    cacheControl:@{" CacheFlagSet " link HYPER:Modula-2/ExecD.def.guide/Modul 562};
    taskId:LONGCARD;
    puddleSize:LONGCARD;
    poolThreshold:LONGCARD;
    publicPool:@{" MinList " link HYPER:Modula-2/ExecD.def.guide/Modul 38};
    mmuLock:ADDRESS;
    reserved:ARRAY[0..11] OF BYTE;
  END;
  @{" ExecBasePtr " link HYPER:Modula-2/ExecD.def.guide/Modul 631}=POINTER TO @{" ExecBase " link HYPER:Modula-2/ExecD.def.guide/Modul 567};

VAR
  execBase[4]:@{" ExecBasePtr " link HYPER:Modula-2/ExecD.def.guide/Modul 631};

END ExecD.noimp

@endnode
