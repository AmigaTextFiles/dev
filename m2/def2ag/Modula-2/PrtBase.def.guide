@database HYPER:Modula-2/PrtBase
@node Main "HYPER:Modula-2/PrtBase"

Konstanten

   @{" bgr " link Modul 53}                         @{" bgrWb " link Modul 54}                       @{" bgrw " link Modul 55}
   @{" bufSize " link Modul 59}                     @{" bw " link Modul 47}                          @{" bwAlpha " link Modul 37}
   @{" bwGfx " link Modul 39}                       @{" colorAlpha " link Modul 40}                  @{" colorGfx " link Modul 41}
   @{" oldStkSize " link Modul 57}                  @{" safeSize " link Modul 60}                    @{" stkSize " link Modul 58}
   @{" wb " link Modul 52}                          @{" ymc " link Modul 49}                         @{" ymcBw " link Modul 50}
   @{" ymcb " link Modul 51}                     

Typ-Deklarationen

   @{" ColorClass " link Modul 43}                  @{" ColorClassSet " link Modul 45}               @{" DeviceData " link Modul 23}
   @{" DeviceDataPtr " link Modul 31}               @{" PrinterClass " link Modul 33}                @{" PrinterClassSet " link Modul 35}
   @{" PrinterData " link Modul 97}                 @{" PrinterDataPtr " link Modul 123}              @{" PrinterExtendedData " link Modul 62}
   @{" PrinterExtendedDataPtr " link Modul 86}      @{" PrinterSegment " link Modul 88}              @{" PrinterSegmentPtr " link Modul 95}
   @{" StrPtr " link Modul 20}                   

@endnode
@node Modul "HYPER:Modula-2/PrtBase.def.guide"
DEFINITION MODULE PrtBase; (*$Implementation:=FALSE*)
(* 16-May-1992/cn *)

FROM SYSTEM IMPORT ADDRESS,BPTR,BYTE;

FROM ExecD IMPORT
 @{" Device " link HYPER:Modula-2/ExecD.def.guide/Modul 417},@{" ExecBasePtr " link HYPER:Modula-2/ExecD.def.guide/Modul 631},@{" Library " link HYPER:Modula-2/ExecD.def.guide/Modul 400},@{" MsgPort " link HYPER:Modula-2/ExecD.def.guide/Modul 360},@{" Task " link HYPER:Modula-2/ExecD.def.guide/Modul 152};

FROM IntuitionD IMPORT
 @{" Preferences " link HYPER:Modula-2/IntuitionD.def.guide/Modul 791};

FROM Parallel IMPORT
 @{" IOParallel " link HYPER:Modula-2/Parallel.def.guide/Modul 46};

FROM Serial IMPORT
 @{" IOSerial " link HYPER:Modula-2/Serial.def.guide/Modul 78};

FROM Timer IMPORT
 @{" IOTimer " link HYPER:Modula-2/Timer.def.guide/Modul 47};

TYPE
 @{" StrPtr " link HYPER:Modula-2/Arts.def.guide/Modul 20}=ADDRESS;

 @{" DeviceData " link HYPER:Modula-2/PrtBase.def.guide/Modul 23}=RECORD
  device:@{" Device " link HYPER:Modula-2/ExecD.def.guide/Modul 417};
  segment:BPTR;
  execBase:@{" ExecBasePtr " link HYPER:Modula-2/ExecD.def.guide/Modul 631};
  cmdVectors:ADDRESS;
  cmdBytes:ADDRESS;
  numCommands:CARDINAL;
 END;
 @{" DeviceDataPtr " link HYPER:Modula-2/PrtBase.def.guide/Modul 31}=POINTER TO @{" DeviceData " link HYPER:Modula-2/PrtBase.def.guide/Modul 23};

TYPE
 @{" PrinterClass " link HYPER:Modula-2/PrtBase.def.guide/Modul 33}=(gfx,color);
 @{" PrinterClassSet " link HYPER:Modula-2/PrtBase.def.guide/Modul 35}=SET OF @{" PrinterClass " link HYPER:Modula-2/PrtBase.def.guide/Modul 33};

CONST
 bwAlpha=@{" PrinterClassSet " link HYPER:Modula-2/PrtBase.def.guide/Modul 35}{};
 bwGfx=@{" PrinterClassSet " link HYPER:Modula-2/PrtBase.def.guide/Modul 35}{gfx};
 colorAlpha=@{" PrinterClassSet " link HYPER:Modula-2/PrtBase.def.guide/Modul 35}{color};
 colorGfx=@{" PrinterClassSet " link HYPER:Modula-2/PrtBase.def.guide/Modul 35}{gfx,color};

TYPE
 @{" ColorClass " link HYPER:Modula-2/PrtBase.def.guide/Modul 43}=(blackAndWhite,colors,fourColor,additive,multipass);
 @{" ColorClassSet " link HYPER:Modula-2/PrtBase.def.guide/Modul 45}=SET OF @{" ColorClass " link HYPER:Modula-2/PrtBase.def.guide/Modul 43};

CONST
 bw=@{" ColorClassSet " link HYPER:Modula-2/PrtBase.def.guide/Modul 45}{blackAndWhite};
 ymc=@{" ColorClassSet " link HYPER:Modula-2/PrtBase.def.guide/Modul 45}{colors};
 ymcBw=@{" ColorClassSet " link HYPER:Modula-2/PrtBase.def.guide/Modul 45}{blackAndWhite,colors};
 ymcb=@{" ColorClassSet " link HYPER:Modula-2/PrtBase.def.guide/Modul 45}{fourColor};
 wb=@{" ColorClassSet " link HYPER:Modula-2/PrtBase.def.guide/Modul 45}{blackAndWhite,additive};
 bgr=@{" ColorClassSet " link HYPER:Modula-2/PrtBase.def.guide/Modul 45}{colors,additive};
 bgrWb=@{" ColorClassSet " link HYPER:Modula-2/PrtBase.def.guide/Modul 45}{blackAndWhite,colors,additive};
 bgrw=@{" ColorClassSet " link HYPER:Modula-2/PrtBase.def.guide/Modul 45}{fourColor,additive};

 oldStkSize=0800H;
 (*36*)stkSize=1000H;
 bufSize=256;
 safeSize=128;

TYPE
 @{" PrinterExtendedData " link HYPER:Modula-2/PrtBase.def.guide/Modul 62}=RECORD
  printerName:@{" StrPtr " link HYPER:Modula-2/Arts.def.guide/Modul 20};
  init:PROC;
  expunge:PROC;
  open:PROCEDURE():INTEGER;
  close:PROC;
  printerClass:@{" PrinterClassSet " link HYPER:Modula-2/PrtBase.def.guide/Modul 35};
  colorClass:@{" ColorClassSet " link HYPER:Modula-2/PrtBase.def.guide/Modul 45};
  maxColumns:SHORTCARD;
  numCharSets:SHORTCARD;
  numRows:CARDINAL;
  maxXDots:LONGCARD;
  maxYDots:LONGCARD;
  xDotsInch:CARDINAL;
  yDotsInch:CARDINAL;
  commands:ADDRESS;
  doSpecial:PROCEDURE():LONGINT;
  render:PROCEDURE():LONGINT;
  timeoutSecs:LONGINT;
  eightBitChars:ADDRESS;
  printMode:LONGINT;
  (*34*)convFunc:PROCEDURE():LONGINT;
 END;
 @{" PrinterExtendedDataPtr " link HYPER:Modula-2/PrtBase.def.guide/Modul 86}=POINTER TO @{" PrinterExtendedData " link HYPER:Modula-2/PrtBase.def.guide/Modul 62};

 @{" PrinterSegment " link HYPER:Modula-2/PrtBase.def.guide/Modul 88}=RECORD
  nextSegment:BPTR;
  runAlert:LONGCARD;
  version:CARDINAL;
  revision:CARDINAL;
  ped:@{" PrinterExtendedData " link HYPER:Modula-2/PrtBase.def.guide/Modul 62};
 END;
 @{" PrinterSegmentPtr " link HYPER:Modula-2/PrtBase.def.guide/Modul 95}=POINTER TO @{" PrinterSegment " link HYPER:Modula-2/PrtBase.def.guide/Modul 88};

 @{" PrinterData " link HYPER:Modula-2/PrtBase.def.guide/Modul 97}=RECORD
  device:@{" DeviceData " link HYPER:Modula-2/PrtBase.def.guide/Modul 23};
  unit:@{" MsgPort " link HYPER:Modula-2/ExecD.def.guide/Modul 360};
  printerSegment:BPTR;
  printerType:CARDINAL;
  segmentData:@{" PrinterSegmentPtr " link HYPER:Modula-2/PrtBase.def.guide/Modul 95};
  printBuf:ADDRESS;
  pWrite:PROCEDURE():INTEGER;
  pBothReady:PROCEDURE():INTEGER;
  CASE :INTEGER OF
  |1: p0:@{" IOParallel " link HYPER:Modula-2/Parallel.def.guide/Modul 46};
      p1:@{" IOParallel " link HYPER:Modula-2/Parallel.def.guide/Modul 46};
  |2: s0:@{" IOSerial " link HYPER:Modula-2/Serial.def.guide/Modul 78};
      s1:@{" IOSerial " link HYPER:Modula-2/Serial.def.guide/Modul 78};
  END;
  tior:@{" IOTimer " link HYPER:Modula-2/Timer.def.guide/Modul 47};
  iorPort:@{" MsgPort " link HYPER:Modula-2/ExecD.def.guide/Modul 360};
  tc:@{" Task " link HYPER:Modula-2/ExecD.def.guide/Modul 152};
  oldStk:ARRAY [0..oldStkSize-1] OF BYTE;
  flags:SHORTCARD;
  pad:BYTE;
  preferences:@{" Preferences " link HYPER:Modula-2/IntuitionD.def.guide/Modul 791};
  pWaitEnabled:SHORTCARD;
  (*36*)flags1:SHORTCARD;
  (*36*)stk:ARRAY[0..stkSize-1] OF BYTE;
 END;
 @{" PrinterDataPtr " link HYPER:Modula-2/PrtBase.def.guide/Modul 123}=POINTER TO @{" PrinterData " link HYPER:Modula-2/PrtBase.def.guide/Modul 97};

END PrtBase.noimp

@endnode
