@database HYPER:Modula-2/DosD
@node Main "HYPER:Modula-2/DosD"

Konstanten

   @{" abortBusy " link Modul 130}                   @{" abortDiskError " link Modul 131}              @{" accessRead " link Modul 45}
   @{" accessWrite " link Modul 46}                 @{" actionEnd " link Modul 416}                   @{" actionNotKnown " link Modul 96}
   @{" addNotify " link Modul 432}                   @{" badHunk " link Modul 117}                     @{" badNumber " link Modul 81}
   @{" badStreamName " link Modul 94}               @{" badTemplate " link Modul 80}                 @{" beginning " link Modul 36}
   @{" break " link Modul 124}                       @{" bufFull " link Modul 72}                     @{" bufLine " link Modul 71}
   @{" bufNone " link Modul 73}                     @{" bufferOverflow " link Modul 123}              @{" changeFH " link Modul 60}
   @{" changeLock " link Modul 59}                  @{" changeMode " link Modul 425}                  @{" changeSignal " link Modul 410}
   @{" commentTooBig " link Modul 107}               @{" copyDir " link Modul 392}                     @{" copyDirFh " link Modul 426}
   @{" createDir " link Modul 395}                   @{" ctrlC " link Modul 177}                       @{" ctrlD " link Modul 178}
   @{" ctrlE " link Modul 179}                       @{" ctrlF " link Modul 180}                       @{" current " link Modul 37}
   @{" currentVolume " link Modul 383}               @{" deleteObject " link Modul 389}                @{" deleteProtected " link Modul 109}
   @{" deviceNotMounted " link Modul 105}            @{" die " link Modul 381}                         @{" dirNotFound " link Modul 92}
   @{" directoryNotEmpty " link Modul 103}           @{" diskChange " link Modul 406}                  @{" diskFull " link Modul 108}
   @{" diskInfo " link Modul 398}                    @{" diskNotValidated " link Modul 100}            @{" diskType " link Modul 405}
   @{" diskWriteProtected " link Modul 101}          @{" doWriteProtect " link Modul 421}              @{" dosCLI " link Modul 167}
   @{" dosDisk " link Modul 279}                     @{" dosExAllControl " link Modul 164}             @{" dosFALSE " link Modul 23}
   @{" dosFib " link Modul 165}                      @{" dosFileHandle " link Modul 163}               @{" dosName " link Modul 19}
   @{" dosRdArgs " link Modul 168}                   @{" dosStdPkt " link Modul 166}                   @{" dosTRUE " link Modul 22}
   @{" edComment " link Modul 656}                   @{" edDate " link Modul 655}                      @{" edName " link Modul 647}
   @{" edProtection " link Modul 654}                @{" edSize " link Modul 653}                      @{" edType " link Modul 652}
   @{" end " link Modul 38}                         @{" error " link Modul 147}                       @{" event " link Modul 382}
   @{" examineAll " link Modul 428}                  @{" examineFh " link Modul 429}                   @{" examineNext " link Modul 397}
   @{" examineObject " link Modul 396}               @{" exclusiveLock " link Modul 44}               @{" fail " link Modul 148}
   @{" ffsDisk " link Modul 280}                     @{" fhFromLock " link Modul 423}                  @{" fileNotObject " link Modul 87}
   @{" findInput " link Modul 414}                   @{" findOutput " link Modul 415}                  @{" findUpdate " link Modul 413}
   @{" flush " link Modul 400}                       @{" format " link Modul 418}                      @{" formatMAX " link Modul 661}
   @{" freeLock " link Modul 388}                    @{" freeRecord " link Modul 431}                  @{" getBlock " link Modul 379}
   @{" info " link Modul 399}                        @{" inhibit " link Modul 404}                     @{" interDOSDisk " link Modul 281}
   @{" interFFSDisk " link Modul 282}                @{" invalidComponentName " link Modul 97}        @{" invalidLock " link Modul 98}
   @{" invalidResidentLibrary " link Modul 88}      @{" isFileSystem " link Modul 424}                @{" isSoftLink " link Modul 115}
   @{" itemEqual " link Modul 153}                   @{" itemError " link Modul 154}                   @{" itemNothing " link Modul 155}
   @{" itemQuoted " link Modul 157}                  @{" itemUnquoted " link Modul 156}                @{" keyNeedsArg " link Modul 83}
   @{" kickstartDisk " link Modul 284}               @{" ldAll " link Modul 591}                       @{" lenDatString " link Modul 663}
   @{" lineTooLong " link Modul 86}                 @{" linkHard " link Modul 65}                    @{" linkSoft " link Modul 66}
   @{" locateObject " link Modul 384}                @{" lockCollision " link Modul 120}               @{" lockDifferent " link Modul 51}
   @{" lockRecord " link Modul 430}                  @{" lockSame " link Modul 52}                    @{" lockSameHandler " link Modul 54}
   @{" lockSameVolume " link Modul 53}              @{" lockTimeout " link Modul 121}                 @{" makeLink " link Modul 419}
   @{" maxMultiArgs " link Modul 793}                @{" maxTemplateItems " link Modul 791}            @{" moreCache " link Modul 391}
   @{" msdosDisk " link Modul 285}                   @{" newFile " link Modul 31}                     @{" nil " link Modul 373}
   @{" noDefaultDir " link Modul 89}                @{" noDisk " link Modul 113}                      @{" noDiskPresent " link Modul 277}
   @{" noFreeStore " link Modul 78}                 @{" noMoreEntries " link Modul 114}               @{" notADosDisk " link Modul 112}
   @{" notExecutable " link Modul 125}               @{" notImplemented " link Modul 118}              @{" notReallyDos " link Modul 283}
   @{" notifyClass " link Modul 695}                 @{" notifyCode " link Modul 697}                  @{" objectExists " link Modul 91}
   @{" objectInUse " link Modul 90}                 @{" objectLinked " link Modul 116}                @{" objectNotFound " link Modul 93}
   @{" objectTooLarge " link Modul 95}              @{" objectWrongType " link Modul 99}             @{" ok " link Modul 145}
   @{" oldFile " link Modul 30}                     @{" parent " link Modul 402}                      @{" parentFh " link Modul 427}
   @{" read " link Modul 387}                        @{" readLink " link Modul 422}                    @{" readOnly " link Modul 29}
   @{" readProtected " link Modul 111}               @{" readReturn " link Modul 411}                  @{" readWrite " link Modul 28}
   @{" recExclusive " link Modul 621}                @{" recExclusiveImmed " link Modul 623}           @{" recShared " link Modul 624}
   @{" recSharedImmed " link Modul 625}              @{" recordNotLocked " link Modul 119}             @{" removeNotify " link Modul 433}
   @{" renameAcrossDevices " link Modul 102}         @{" renameDisk " link Modul 385}                  @{" renameObject " link Modul 390}
   @{" reportInsert " link Modul 140}                @{" reportLock " link Modul 138}                  @{" reportStream " link Modul 136}
   @{" reportTask " link Modul 137}                  @{" reportVolume " link Modul 139}                @{" requiredArgMissing " link Modul 82}
   @{" runExecute " link Modul 170}                  @{" runSystem " link Modul 171}                   @{" runSystemAsynch " link Modul 172}
   @{" sameLock " link Modul 408}                    @{" screenMode " link Modul 409}                  @{" seek " link Modul 417}
   @{" seekError " link Modul 106}                   @{" serializeDisk " link Modul 434}               @{" setComment " link Modul 401}
   @{" setDate " link Modul 407}                     @{" setFileSize " link Modul 420}                 @{" setMap " link Modul 380}
   @{" setProtect " link Modul 394}                  @{" sharedLock " link Modul 43}                  @{" stFile " link Modul 248}
   @{" stLinkDir " link Modul 247}                   @{" stLinkFile " link Modul 249}                  @{" stPipeFile " link Modul 250}
   @{" stRoot " link Modul 243}                      @{" stSoftLink " link Modul 246}                  @{" stUserDir " link Modul 245}
   @{" startup " link Modul 378}                     @{" taskTableFull " link Modul 79}               @{" ticksPerSecond " link Modul 182}
   @{" timer " link Modul 403}                       @{" tooManyArgs " link Modul 84}                 @{" tooManyLevels " link Modul 104}
   @{" unLockError " link Modul 122}                 @{" unmatchedQuotes " link Modul 85}             @{" unreadableDisk " link Modul 278}
   @{" validated " link Modul 272}                   @{" validating " link Modul 271}                  @{" waitChar " link Modul 393}
   @{" warn " link Modul 146}                        @{" write " link Modul 386}                       @{" writeProtect " link Modul 266}
   @{" writeProtected " link Modul 110}              @{" writeReturn " link Modul 412}              

Typ-Deklarationen

   @{" AChain " link Modul 743}                      @{" AChainFlagSet " link Modul 740}               @{" AChainFlags " link Modul 737}
   @{" AChainPtr " link Modul 742}                   @{" AdoTags " link Modul 691}                     @{" AllocProc " link Modul 818}
   @{" AnchorPath " link Modul 756}                  @{" AnchorPathFlagSet " link Modul 754}           @{" AnchorPathFlags " link Modul 751}
   @{" AnchorPathPtr " link Modul 766}               @{" AssignList " link Modul 547}                  @{" AssignListPtr " link Modul 546}
   @{" BSTR " link Modul 184}                        @{" CSource " link Modul 768}                     @{" CSourcePtr " link Modul 773}
   @{" CliInitFlagSet " link Modul 836}              @{" CliInitFlags " link Modul 830}                @{" CliProcList " link Modul 444}
   @{" CliProcListPtr " link Modul 449}              @{" CommandLineInterface " link Modul 300}        @{" CommandLineInterfaceAPtr " link Modul 319}
   @{" CommandLineInterfacePtr " link Modul 318}     @{" Date " link Modul 215}                        @{" DateFormat " link Modul 658}
   @{" DatePtr " link Modul 220}                     @{" DateTime " link Modul 669}                    @{" DateTimeFlagSet " link Modul 667}
   @{" DateTimeFlags " link Modul 665}               @{" DateTimePtr " link Modul 677}                 @{" DevProc " link Modul 603}
   @{" DevProcFlagSet " link Modul 601}              @{" DevProcFlags " link Modul 594}                @{" DevProcPtr " link Modul 609}
   @{" DeviceList " link Modul 553}                  @{" DeviceListPtr " link Modul 186}               @{" DeviceListType " link Modul 552}
   @{" DeviceNode " link Modul 578}                  @{" DeviceNodePtr " link Modul 579}               @{" DosEnvec " link Modul 514}
   @{" DosEnvecPtr " link Modul 536}                 @{" DosInfo " link Modul 460}                     @{" DosInfoPtr " link Modul 470}
   @{" DosLibrary " link Modul 500}                  @{" DosLibraryPtr " link Modul 512}               @{" DosList " link Modul 580}
   @{" DosListPtr " link Modul 581}                  @{" DosPacket " link Modul 351}                   @{" DosPacketPtr " link Modul 365}
   @{" ErrorString " link Modul 494}                 @{" ErrorStringPtr " link Modul 498}              @{" ExAllControl " link Modul 639}
   @{" ExAllControlPtr " link Modul 645}             @{" ExAllData " link Modul 629}                   @{" ExAllDataPtr " link Modul 627}
   @{" FileHandle " link Modul 191}                  @{" FileHandlePtr " link Modul 204}               @{" FileInfoBlock " link Modul 229}
   @{" FileInfoBlockPtr " link Modul 241}            @{" FileLock " link Modul 207}                    @{" FileLockPtr " link Modul 206}
   @{" FileSysStartupMsg " link Modul 538}           @{" FileSysStartupMsgPtr " link Modul 544}        @{" FreeProc " link Modul 819}
   @{" ILArray " link Modul 823}                     @{" ILArrayPtr " link Modul 828}                  @{" InfoData " link Modul 252}
   @{" InfoDataPtr " link Modul 264}                 @{" LocalVar " link Modul 810}                    @{" LocalVarPtr " link Modul 816}
   @{" LockDosFlagSet " link Modul 589}              @{" LockDosFlags " link Modul 583}                @{" NotifyFlagSet " link Modul 706}
   @{" NotifyFlags " link Modul 699}                 @{" NotifyMessage " link Modul 727}               @{" NotifyMsgPtr " link Modul 735}
   @{" NotifyRequest " link Modul 708}               @{" NotifyRequestPtr " link Modul 725}            @{" NpTags " link Modul 683}
   @{" PathInfo " link Modul 295}                    @{" PathInfoPtr " link Modul 294}                 @{" Process " link Modul 321}
   @{" ProcessFlagSet " link Modul 292}              @{" ProcessFlags " link Modul 287}                @{" ProcessId " link Modul 187}
   @{" ProcessPtr " link Modul 349}                  @{" ProtectionFlagSet " link Modul 227}           @{" ProtectionFlags " link Modul 222}
   @{" RDAFlagSet " link Modul 780}                  @{" RDAFlags " link Modul 775}                    @{" RDArgs " link Modul 781}
   @{" RDArgsPtr " link Modul 789}                   @{" ReadProc " link Modul 820}                    @{" RecordLock " link Modul 611}
   @{" RecordLockArrayPtr " link Modul 619}          @{" RecordLockPtr " link Modul 617}               @{" ResidentSegment " link Modul 453}
   @{" ResidentSegmentAPtr " link Modul 451}         @{" ResidentSegmentPtr " link Modul 452}          @{" RootNode " link Modul 480}
   @{" RootNodeFlagSet " link Modul 478}             @{" RootNodeFlags " link Modul 472}               @{" RootNodePtr " link Modul 492}
   @{" SegmentPtr " link Modul 188}                  @{" StandardPacket " link Modul 367}              @{" StandardPacketPtr " link Modul 371}
   @{" Str255 " link Modul 189}                      @{" StrPtr " link Modul 17}                      @{" SysTags " link Modul 679}
   @{" TaskArray " link Modul 436}                   @{" TaskArrayAPtr " link Modul 442}               @{" TaskArrayPtr " link Modul 441}
   @{" Var16FlagSet " link Modul 807}                @{" Var8FlagSet " link Modul 808}                 @{" VarFlagSet " link Modul 806}
   @{" VarFlags " link Modul 795}                 

@endnode
@node Modul "HYPER:Modula-2/DosD.def.guide"
DEFINITION MODULE DosD; (*$ Implementation:=FALSE *)
(* 01-Mar-1992/cn *)

FROM SYSTEM IMPORT ADDRESS,BPTR,BYTE,CAST,LONGSET,WORD;

FROM ExecD IMPORT
 @{" Library " link HYPER:Modula-2/ExecD.def.guide/Modul 400},@{" LibraryPtr " link HYPER:Modula-2/ExecD.def.guide/Modul 412},@{" MemReqSet " link HYPER:Modula-2/ExecD.def.guide/Modul 86},@{" Message " link HYPER:Modula-2/ExecD.def.guide/Modul 376},@{" MessagePtr " link HYPER:Modula-2/ExecD.def.guide/Modul 381},@{" MinList " link HYPER:Modula-2/ExecD.def.guide/Modul 38},@{" MinNode " link HYPER:Modula-2/ExecD.def.guide/Modul 26}
 ,@{" MsgPort " link HYPER:Modula-2/ExecD.def.guide/Modul 360},@{" MsgPortPtr " link HYPER:Modula-2/ExecD.def.guide/Modul 375},@{" Node " link HYPER:Modula-2/ExecD.def.guide/Modul 18},@{" SignalSemaphore " link HYPER:Modula-2/ExecD.def.guide/Modul 504},@{" Task " link HYPER:Modula-2/ExecD.def.guide/Modul 152},@{" TaskPtr " link HYPER:Modula-2/ExecD.def.guide/Modul 176};

FROM Timer IMPORT
 @{" TimeRequestPtr " link HYPER:Modula-2/Timer.def.guide/Modul 44};

FROM UtilityD IMPORT
 @{" HookPtr " link HYPER:Modula-2/UtilityD.def.guide/Modul 47},tagUser,@{" TagItemPtr " link HYPER:Modula-2/UtilityD.def.guide/Modul 22};

IMPORT R;

TYPE @{" StrPtr " link HYPER:Modula-2/Arts.def.guide/Modul 20}=ADDRESS;

CONST
 dosName="dos.library";

 dosTRUE=LONGINT(-1);
 dosFALSE=LONGINT(0);

(*
 Mögliche Werte des Parameters accessMode der Prozedur Open
*)
 readWrite=1004;
 readOnly=1005;
 oldFile=readOnly;
 newFile=1006;

(*
 Mögliche Werte des Parameters mode der Prozedur Seek
*)
 beginning=-1;
 current=0;
 end=1;

(*
 Mögliche Werte des Parameters accessMode der Prozedur Lock
*)
 sharedLock=-2;
 exclusiveLock=-1;
 accessRead=sharedLock;
 accessWrite=exclusiveLock;

(*
 Rückgbewerte von SameLock()
*)
 lockDifferent=-1;
 lockSame=0;
 lockSameVolume=1;
 lockSameHandler=lockSameVolume;

(*
 Mögliche Werte des Parameters type der Prozedur ChangeMode
*)
 changeLock=0;
 changeFH=1;

(*
 Werte fuer MakeLink()
*)
 linkHard=0;
 linkSoft=1;

(*
 Mögliche Werte für den Parameter type der Prozedur SetVBuf
*)
 bufLine=0; (* flush on \n, etc. *)
 bufFull=1; (* never flush except when needed *)
 bufNone=2; (* no buffering *)

(*
 Mögliche Rückgabewerte von IoErr()
*)
 noFreeStore=103;
 taskTableFull=105;
 badTemplate=114;
 badNumber=115;
 requiredArgMissing=116;
 keyNeedsArg=117;
 tooManyArgs=118;
 unmatchedQuotes=119;
 lineTooLong=120;
 fileNotObject=121;
 invalidResidentLibrary=122;
 noDefaultDir=201;
 objectInUse=202;
 objectExists=203;
 dirNotFound=204;
 objectNotFound=205;
 badStreamName=206;
 objectTooLarge=207;
 actionNotKnown=209;
 invalidComponentName=210;
 invalidLock=211;
 objectWrongType=212;
 diskNotValidated=213;
 diskWriteProtected=214;
 renameAcrossDevices=215;
 directoryNotEmpty=216;
 tooManyLevels=217;
 deviceNotMounted=218;
 seekError=219;
 commentTooBig=220;
 diskFull=221;
 deleteProtected=222;
 writeProtected=223;
 readProtected=224;
 notADosDisk=225;
 noDisk=226;
 noMoreEntries=232;
 (*36*) isSoftLink=233;
 (*36*) objectLinked=234;
 (*36*) badHunk=235;
 (*36*) notImplemented=236;
 (*36*) recordNotLocked=240;
 (*36*) lockCollision=241;
 (*36*) lockTimeout=242;
 (*36*) unLockError=243;
 (*36*) bufferOverflow=303;
 (*36*) break=304;
 (*36*) notExecutable=305;

(*
 Mögliche Werte des Parameters code der Prozedur ErrorReport
*)
 abortBusy=288;
 abortDiskError=296;

(*
 Mögliche Werte des Parameters type der Prozedur ErrorReport
*)
 reportStream=0;
 reportTask=1;
 reportLock=2;
 reportVolume=3;
 reportInsert=4;

(*
 Vordefinierte Werte für den Parameter returnCode der Prozedur Exit
*)
 ok=0;
 warn=5;
 error=10;
 fail=20;

(*
 Rückgbewerte von ReadItem()
*)
 itemEqual=-2;
 itemError=-1;
 itemNothing=0;
 itemUnquoted=1;
 itemQuoted=2;

(*
 Mögliche Werte des Parameters type der Prozeduren AllocDosObject
 und FreeDosObject
*)
 dosFileHandle=0;
 dosExAllControl=1;
 dosFib=2;
 dosStdPkt=3;
 dosCLI=4;
 dosRdArgs=5;

 runExecute=-1;
 runSystem=-2;
 runSystemAsynch=-3;

(*
 break flags Exec.SetSignal, etc
*)
 ctrlC=12;
 ctrlD=13;
 ctrlE=14;
 ctrlF=15;

 ticksPerSecond=50;

TYPE
 @{" BSTR " link HYPER:Modula-2/DosD.def.guide/Modul 184}=BPOINTER TO @{" Str255 " link HYPER:Modula-2/DosD.def.guide/Modul 189};
 @{" DeviceListPtr " link HYPER:Modula-2/DosD.def.guide/Modul 186}=BPOINTER TO @{" DeviceList " link HYPER:Modula-2/DosD.def.guide/Modul 553};
 @{" ProcessId " link HYPER:Modula-2/DosD.def.guide/Modul 187}=@{" MsgPortPtr " link HYPER:Modula-2/ExecD.def.guide/Modul 375};
 @{" SegmentPtr " link HYPER:Modula-2/DosD.def.guide/Modul 188}=BPTR;
 @{" Str255 " link HYPER:Modula-2/DosD.def.guide/Modul 189}=ARRAY[0..255] OF CHAR;

 @{" FileHandle " link HYPER:Modula-2/DosD.def.guide/Modul 191}=RECORD
  link:@{" MessagePtr " link HYPER:Modula-2/ExecD.def.guide/Modul 381};
  port:@{" MsgPortPtr " link HYPER:Modula-2/ExecD.def.guide/Modul 375};
  type:@{" ProcessId " link HYPER:Modula-2/DosD.def.guide/Modul 187};
  buf:LONGINT;
  pos:LONGINT;
  end:LONGINT;
  func1:LONGINT;
  func2:LONGINT;
  func3:LONGINT;
  arg1:LONGINT;
  arg2:LONGINT;
 END;
 @{" FileHandlePtr " link HYPER:Modula-2/DosD.def.guide/Modul 204}=BPOINTER TO @{" FileHandle " link HYPER:Modula-2/DosD.def.guide/Modul 191};

 @{" FileLockPtr " link HYPER:Modula-2/DosD.def.guide/Modul 206}=BPOINTER TO @{" FileLock " link HYPER:Modula-2/DosD.def.guide/Modul 207};
 @{" FileLock " link HYPER:Modula-2/DosD.def.guide/Modul 207}=RECORD
  link:@{" FileLockPtr " link HYPER:Modula-2/DosD.def.guide/Modul 206};
  key:LONGINT;
  access:LONGINT;
  task:@{" ProcessId " link HYPER:Modula-2/DosD.def.guide/Modul 187};
  volume:@{" DeviceListPtr " link HYPER:Modula-2/DosD.def.guide/Modul 186};
 END;

 @{" Date " link HYPER:Modula-2/DosD.def.guide/Modul 215}=RECORD
  days:LONGINT;
  minute:LONGINT;
  tick:LONGINT;
 END;
 @{" DatePtr " link HYPER:Modula-2/DosD.def.guide/Modul 220}=POINTER TO @{" Date " link HYPER:Modula-2/DosD.def.guide/Modul 215};

 @{" ProtectionFlags " link HYPER:Modula-2/DosD.def.guide/Modul 222}=(
  delete,execute,writeProt,readProt,archive,pure,script,hidden,
  pf8,pf9,pf10,pf11,pf12,pf13,pf14,pf15,pf16,pf17,pf18,pf19,pf20,
  pf21,pf22,pf23,pf24,pf25,pf26,pf27,pf28,pf29,pf30,pf31
 );
 @{" ProtectionFlagSet " link HYPER:Modula-2/DosD.def.guide/Modul 227}=SET OF @{" ProtectionFlags " link HYPER:Modula-2/DosD.def.guide/Modul 222};

 @{" FileInfoBlock " link HYPER:Modula-2/DosD.def.guide/Modul 229}=RECORD
  diskKey:LONGINT;
  dirEntryType:LONGINT;
  fileName:ARRAY [0..107] OF CHAR;
  protection:@{" ProtectionFlagSet " link HYPER:Modula-2/DosD.def.guide/Modul 227};
  entryType:LONGINT;
  size:LONGINT;
  numBlocks:LONGINT;
  date:@{" Date " link HYPER:Modula-2/DosD.def.guide/Modul 215};
  comment:ARRAY [0..79] OF CHAR;
  reserved:ARRAY [0..35] OF CHAR;
 END;
 @{" FileInfoBlockPtr " link HYPER:Modula-2/DosD.def.guide/Modul 241}=POINTER TO @{" FileInfoBlock " link HYPER:Modula-2/DosD.def.guide/Modul 229};

CONST
 stRoot=1;
 stUserDir=2;
 stSoftLink=3;
 stLinkDir=4;
 stFile=-3;
 stLinkFile=-4;
 stPipeFile=-5;

TYPE
 @{" InfoData " link HYPER:Modula-2/DosD.def.guide/Modul 252}=RECORD
  numSoftErrors:LONGINT;
  unitNumber:LONGINT;
  diskState:LONGINT;
  numBlocks:LONGINT;
  numBlocksUsed:LONGINT;
  bytesPerBlock:LONGINT;
  diskType:LONGINT;
  volumeNode:@{" DeviceListPtr " link HYPER:Modula-2/DosD.def.guide/Modul 186};
  inUse:LONGINT;
 END;
 @{" InfoDataPtr " link HYPER:Modula-2/DosD.def.guide/Modul 264}=POINTER TO @{" InfoData " link HYPER:Modula-2/DosD.def.guide/Modul 252};

CONST
(*
 Mögliche Werte von InfoData.diskState
*)
 writeProtect=80;
 validating=81;
 validated=82;

(*
 Mögliche Werte von InfoData.diskType
*)
 noDiskPresent=-1;
 unreadableDisk=CAST(LONGINT,"BAD\o");
 dosDisk=CAST(LONGINT,"DOS\x00");
 (*36*) ffsDisk=CAST(LONGINT,"DOS\x01");
 (*??*) interDOSDisk=CAST(LONGINT,"DOS\x02");
 (*??*) interFFSDisk=CAST(LONGINT,"DOS\x03");
 notReallyDos=CAST(LONGINT,"NDOS");
 kickstartDisk=CAST(LONGINT,"KICK");
 (*??*) msdosDisk=CAST(LONGINT,"MSD\o");

TYPE
 @{" ProcessFlags " link HYPER:Modula-2/DosD.def.guide/Modul 287}=(
  freeSegList,freeCurrDir,freeCLI,closeInput,closeOutput,freeArgs,
  pr6,pr7,pr8,pr9,pr10,pr11,pr12,pr13,pr14,pr15,pr16
 );
 @{" ProcessFlagSet " link HYPER:Modula-2/DosD.def.guide/Modul 292}=SET OF @{" ProcessFlags " link HYPER:Modula-2/DosD.def.guide/Modul 287};

 @{" PathInfoPtr " link HYPER:Modula-2/DosD.def.guide/Modul 294}=BPOINTER TO @{" PathInfo " link HYPER:Modula-2/DosD.def.guide/Modul 295};
 @{" PathInfo " link HYPER:Modula-2/DosD.def.guide/Modul 295}=RECORD
  nextPath:@{" PathInfoPtr " link HYPER:Modula-2/DosD.def.guide/Modul 294};
  lock:@{" FileLockPtr " link HYPER:Modula-2/DosD.def.guide/Modul 206};
 END;

 @{" CommandLineInterface " link HYPER:Modula-2/DosD.def.guide/Modul 300}=RECORD
  result2:LONGINT;
  setName:@{" BSTR " link HYPER:Modula-2/DosD.def.guide/Modul 184};
  commandDir:@{" PathInfoPtr " link HYPER:Modula-2/DosD.def.guide/Modul 294};
  returnCode:LONGINT;
  commandName:@{" BSTR " link HYPER:Modula-2/DosD.def.guide/Modul 184};
  failLevel:LONGINT;
  prompt:@{" BSTR " link HYPER:Modula-2/DosD.def.guide/Modul 184};
  standardInput:@{" FileHandlePtr " link HYPER:Modula-2/DosD.def.guide/Modul 204};
  currentInput:@{" FileHandlePtr " link HYPER:Modula-2/DosD.def.guide/Modul 204};
  commandFile:@{" BSTR " link HYPER:Modula-2/DosD.def.guide/Modul 184};
  interactive:LONGINT; (* LONGBOOLEAN *)
  background:LONGINT; (* LONGBOOLEAN *)
  currentOutput:@{" FileHandlePtr " link HYPER:Modula-2/DosD.def.guide/Modul 204};
  defaultStack:LONGINT;
  standardOutput:@{" FileHandlePtr " link HYPER:Modula-2/DosD.def.guide/Modul 204};
  module:BPTR;
 END;
 @{" CommandLineInterfacePtr " link HYPER:Modula-2/DosD.def.guide/Modul 318}=BPOINTER TO @{" CommandLineInterface " link HYPER:Modula-2/DosD.def.guide/Modul 300};
 @{" CommandLineInterfaceAPtr " link HYPER:Modula-2/DosD.def.guide/Modul 319}=POINTER TO @{" CommandLineInterface " link HYPER:Modula-2/DosD.def.guide/Modul 300};

 @{" Process " link HYPER:Modula-2/DosD.def.guide/Modul 321}=RECORD
  task:@{" Task " link HYPER:Modula-2/ExecD.def.guide/Modul 152};
  msgPort:@{" MsgPort " link HYPER:Modula-2/ExecD.def.guide/Modul 360};
  pad:WORD;
  segList:BPTR;
  stackSize:LONGINT;
  globVec:ADDRESS;
  taskNum:LONGINT;
  stackBase:BPTR;
  result2:LONGINT;
  currentDir:@{" FileLockPtr " link HYPER:Modula-2/DosD.def.guide/Modul 206};
  cis:@{" FileHandlePtr " link HYPER:Modula-2/DosD.def.guide/Modul 204};
  cos:@{" FileHandlePtr " link HYPER:Modula-2/DosD.def.guide/Modul 204};
  consoleTask:@{" ProcessId " link HYPER:Modula-2/DosD.def.guide/Modul 187};
  fileSystemTask:@{" ProcessId " link HYPER:Modula-2/DosD.def.guide/Modul 187};
  cli:@{" CommandLineInterfacePtr " link HYPER:Modula-2/DosD.def.guide/Modul 318};
  returnAddr:ADDRESS;
  pktWait:ADDRESS;
  windowPtr:ADDRESS;
  homeDir: @{" FileLockPtr " link HYPER:Modula-2/DosD.def.guide/Modul 206};
  flags:@{" ProcessFlagSet " link HYPER:Modula-2/DosD.def.guide/Modul 292};
  exitCode:PROC;
  exitData:ADDRESS;
  arguments:@{" StrPtr " link HYPER:Modula-2/Arts.def.guide/Modul 20};
  localVars:@{" MinList " link HYPER:Modula-2/ExecD.def.guide/Modul 38};
  shellPrivate:LONGCARD;
  ces:@{" FileHandlePtr " link HYPER:Modula-2/DosD.def.guide/Modul 204};
 END;
 @{" ProcessPtr " link HYPER:Modula-2/DosD.def.guide/Modul 349}=POINTER TO @{" Process " link HYPER:Modula-2/DosD.def.guide/Modul 321};

 @{" DosPacket " link HYPER:Modula-2/DosD.def.guide/Modul 351}=RECORD
  link:@{" MessagePtr " link HYPER:Modula-2/ExecD.def.guide/Modul 381};
  port:@{" MsgPortPtr " link HYPER:Modula-2/ExecD.def.guide/Modul 375};
  type:LONGINT;
  res1:LONGINT;
  res2:LONGINT;
  arg1:LONGINT;
  arg2:LONGINT;
  arg3:LONGINT;
  arg4:LONGINT;
  arg5:LONGINT;
  arg6:LONGINT;
  arg7:LONGINT;
 END;
 @{" DosPacketPtr " link HYPER:Modula-2/DosD.def.guide/Modul 365}=POINTER TO @{" DosPacket " link HYPER:Modula-2/DosD.def.guide/Modul 351};

 @{" StandardPacket " link HYPER:Modula-2/DosD.def.guide/Modul 367}=RECORD
  msg:@{" Message " link HYPER:Modula-2/ExecD.def.guide/Modul 376};
  pkt:@{" DosPacket " link HYPER:Modula-2/DosD.def.guide/Modul 351};
 END;
 @{" StandardPacketPtr " link HYPER:Modula-2/DosD.def.guide/Modul 371}=POINTER TO @{" StandardPacket " link HYPER:Modula-2/DosD.def.guide/Modul 367};

CONST
 (*
  Mögliche Werte für DosPacket.type
 *)
 nil=0;
 startup=nil;
 getBlock=2;
 setMap=4;
 die=5;
 event=6;
 currentVolume=7;
 locateObject=8;
 renameDisk=9;
 write=ORD('W');
 read=ORD('R');
 freeLock=15;
 deleteObject=16;
 renameObject=17;
 moreCache=18;
 copyDir=19;
 waitChar=20;
 setProtect=21;
 createDir=22;
 examineObject=23;
 examineNext=24;
 diskInfo=25;
 info=26;
 flush=27;
 setComment=28;
 parent=29;
 timer=30;
 inhibit=31;
 diskType=32;
 diskChange=33;
 setDate=34;
 (*36*) sameLock=40;
 screenMode=994;
 (*36*) changeSignal=995;
 readReturn=1001;
 writeReturn=1002;
 findUpdate=1004;
 findInput=1005;
 findOutput=1006;
 actionEnd=1007;
 seek=1008;
 (*36*) format=1020;
 (*36*) makeLink=1021;
 setFileSize=1022;
 doWriteProtect=1023;
 (*36*) readLink=1024;
 (*36*) fhFromLock=1026;
 (*36*) isFileSystem=1027;
 (*36*) changeMode=1028;
 (*36*) copyDirFh=1030;
 (*36*) parentFh=1031;
 (*36*) examineAll=1033;
 (*36*) examineFh=1034;
 (*36*) lockRecord=2008;
 (*36*) freeRecord=2009;
 (*36*) addNotify=4097;
 (*36*) removeNotify=4098;
 (*37*) serializeDisk=4200;

TYPE
 @{" TaskArray " link HYPER:Modula-2/DosD.def.guide/Modul 436}=RECORD
  maxCli:LONGINT;
  cli:ARRAY [1..99] OF @{" ProcessId " link HYPER:Modula-2/DosD.def.guide/Modul 187};
 END;
 @{" TaskArrayPtr " link HYPER:Modula-2/DosD.def.guide/Modul 441}=BPOINTER TO @{" TaskArray " link HYPER:Modula-2/DosD.def.guide/Modul 436};
 @{" TaskArrayAPtr " link HYPER:Modula-2/DosD.def.guide/Modul 442}=POINTER TO @{" TaskArray " link HYPER:Modula-2/DosD.def.guide/Modul 436};

 @{" CliProcList " link HYPER:Modula-2/DosD.def.guide/Modul 444}=RECORD
  node:@{" MinNode " link HYPER:Modula-2/ExecD.def.guide/Modul 26};
  first:LONGINT;
  array:@{" TaskArrayAPtr " link HYPER:Modula-2/DosD.def.guide/Modul 442};
 END;
 @{" CliProcListPtr " link HYPER:Modula-2/DosD.def.guide/Modul 449}=POINTER TO @{" CliProcList " link HYPER:Modula-2/DosD.def.guide/Modul 444};

 @{" ResidentSegmentAPtr " link HYPER:Modula-2/DosD.def.guide/Modul 451}=POINTER TO @{" ResidentSegment " link HYPER:Modula-2/DosD.def.guide/Modul 453};
 @{" ResidentSegmentPtr " link HYPER:Modula-2/DosD.def.guide/Modul 452}=BPOINTER TO @{" ResidentSegment " link HYPER:Modula-2/DosD.def.guide/Modul 453};
 @{" ResidentSegment " link HYPER:Modula-2/DosD.def.guide/Modul 453}=RECORD
  next:@{" ResidentSegmentPtr " link HYPER:Modula-2/DosD.def.guide/Modul 452};
  usecount:LONGINT;
  segment:@{" SegmentPtr " link HYPER:Modula-2/DosD.def.guide/Modul 188};
  name:@{" Str255 " link HYPER:Modula-2/DosD.def.guide/Modul 189}; (* BString!! *)
 END;

 @{" DosInfo " link HYPER:Modula-2/DosD.def.guide/Modul 460}=RECORD
  resList:@{" ResidentSegmentPtr " link HYPER:Modula-2/DosD.def.guide/Modul 452};
  devInfo:@{" DeviceListPtr " link HYPER:Modula-2/DosD.def.guide/Modul 186};
  devices:BPTR;
  handlers:BPTR;
  netHand:@{" ResidentSegmentPtr " link HYPER:Modula-2/DosD.def.guide/Modul 452};
  devLock:@{" SignalSemaphore " link HYPER:Modula-2/ExecD.def.guide/Modul 504};
  entryLock:@{" SignalSemaphore " link HYPER:Modula-2/ExecD.def.guide/Modul 504};
  deleteLock:@{" SignalSemaphore " link HYPER:Modula-2/ExecD.def.guide/Modul 504};
 END;
 @{" DosInfoPtr " link HYPER:Modula-2/DosD.def.guide/Modul 470}=BPOINTER TO @{" DosInfo " link HYPER:Modula-2/DosD.def.guide/Modul 460};

 @{" RootNodeFlags " link HYPER:Modula-2/DosD.def.guide/Modul 472}=(
  rnf0,private1,rnf2,rnf3,rnf4,rnf5,rnf6,rnf7
  ,rnf8,rnf9,rnf10,rnf11,rnf12,rnf13,rnf14,rnf15
  ,rnf16,rnf17,rnf18,rnf19,rnf20,rnf21,rnf22,rnf23
  ,wildStar,rnf25,rnf26,rnf27,rnf28,rnf29,rnf30,rnf31
 );
 @{" RootNodeFlagSet " link HYPER:Modula-2/DosD.def.guide/Modul 478}=SET OF @{" RootNodeFlags " link HYPER:Modula-2/DosD.def.guide/Modul 472};

 @{" RootNode " link HYPER:Modula-2/DosD.def.guide/Modul 480}=RECORD
  taskArray:@{" TaskArrayPtr " link HYPER:Modula-2/DosD.def.guide/Modul 441};
  consoleSegment:@{" SegmentPtr " link HYPER:Modula-2/DosD.def.guide/Modul 188};
  time:@{" Date " link HYPER:Modula-2/DosD.def.guide/Modul 215};
  restartSeg:BPTR;
  info:@{" DosInfoPtr " link HYPER:Modula-2/DosD.def.guide/Modul 470};
  fileHandlerSegment:@{" SegmentPtr " link HYPER:Modula-2/DosD.def.guide/Modul 188};
  cliList:@{" MinList " link HYPER:Modula-2/ExecD.def.guide/Modul 38};
  bootProc:@{" ProcessId " link HYPER:Modula-2/DosD.def.guide/Modul 187};
  shellSegment:@{" SegmentPtr " link HYPER:Modula-2/DosD.def.guide/Modul 188};
  flags:@{" RootNodeFlagSet " link HYPER:Modula-2/DosD.def.guide/Modul 478};
 END;
 @{" RootNodePtr " link HYPER:Modula-2/DosD.def.guide/Modul 492}=POINTER TO @{" RootNode " link HYPER:Modula-2/DosD.def.guide/Modul 480};

 @{" ErrorString " link HYPER:Modula-2/DosD.def.guide/Modul 494}=RECORD
  nums: POINTER TO ARRAY [0..1000] OF LONGINT;
  strings:POINTER TO ARRAY [0..1000] OF @{" StrPtr " link HYPER:Modula-2/Arts.def.guide/Modul 20};
 END;
 @{" ErrorStringPtr " link HYPER:Modula-2/DosD.def.guide/Modul 498}=POINTER TO @{" ErrorString " link HYPER:Modula-2/DosD.def.guide/Modul 494};

 @{" DosLibrary " link HYPER:Modula-2/DosD.def.guide/Modul 500}=RECORD
  lib:@{" Library " link HYPER:Modula-2/ExecD.def.guide/Modul 400};
  root:@{" RootNodePtr " link HYPER:Modula-2/DosD.def.guide/Modul 492};
  gv:ADDRESS;
  a2:LONGINT;
  a5:LONGINT;
  a6:LONGINT;
  errors:@{" ErrorStringPtr " link HYPER:Modula-2/DosD.def.guide/Modul 498};
  timeReq:@{" TimeRequestPtr " link HYPER:Modula-2/Timer.def.guide/Modul 44};
  utilityBase:@{" LibraryPtr " link HYPER:Modula-2/ExecD.def.guide/Modul 412};
  intuitionBase:@{" LibraryPtr " link HYPER:Modula-2/ExecD.def.guide/Modul 412};
 END;
 @{" DosLibraryPtr " link HYPER:Modula-2/DosD.def.guide/Modul 512}=POINTER TO @{" DosLibrary " link HYPER:Modula-2/DosD.def.guide/Modul 500};

 @{" DosEnvec " link HYPER:Modula-2/DosD.def.guide/Modul 514}=RECORD
  tableSize:LONGCARD;
  sizeBlock:LONGCARD;
  secOrg:LONGCARD;
  surfaces:LONGCARD;
  sectorsPerBlock:LONGCARD;
  blocksPerTrack:LONGCARD;
  reserved:LONGCARD;
  preAlloc:LONGCARD;
  interleave:LONGCARD;
  lowCyl:LONGCARD;
  highCyl:LONGCARD;
  numBuffers:LONGCARD;
  bufMemType:LONGCARD;
  maxTransfers:LONGCARD;
  mask:LONGSET;
  bootPri:LONGINT;
  dosType:ARRAY [0..3] OF CHAR;
  baud:LONGCARD;
  control:LONGCARD;
  bootBlocks:LONGCARD;
 END;
 @{" DosEnvecPtr " link HYPER:Modula-2/DosD.def.guide/Modul 536}=BPOINTER TO @{" DosEnvec " link HYPER:Modula-2/DosD.def.guide/Modul 514};

 @{" FileSysStartupMsg " link HYPER:Modula-2/DosD.def.guide/Modul 538}=RECORD
  unit:LONGCARD;
  device:@{" BSTR " link HYPER:Modula-2/DosD.def.guide/Modul 184};
  environ:@{" DosEnvecPtr " link HYPER:Modula-2/DosD.def.guide/Modul 536};
  flags:LONGSET;
 END;
 @{" FileSysStartupMsgPtr " link HYPER:Modula-2/DosD.def.guide/Modul 544}=BPOINTER TO @{" FileSysStartupMsg " link HYPER:Modula-2/DosD.def.guide/Modul 538};

 @{" AssignListPtr " link HYPER:Modula-2/DosD.def.guide/Modul 546}=POINTER TO @{" AssignList " link HYPER:Modula-2/DosD.def.guide/Modul 547};
 @{" AssignList " link HYPER:Modula-2/DosD.def.guide/Modul 547}=RECORD
  next:@{" AssignListPtr " link HYPER:Modula-2/DosD.def.guide/Modul 546};
  lock:@{" FileLockPtr " link HYPER:Modula-2/DosD.def.guide/Modul 206};
 END;

 @{" DeviceListType " link HYPER:Modula-2/DosD.def.guide/Modul 552}=(device,directory,volume,late,nonBinding);
 @{" DeviceList " link HYPER:Modula-2/DosD.def.guide/Modul 553}=RECORD
  next:@{" DeviceListPtr " link HYPER:Modula-2/DosD.def.guide/Modul 186};
  pad1,pad2,pad3:BYTE;
  type:@{" DeviceListType " link HYPER:Modula-2/DosD.def.guide/Modul 552};
  task:@{" ProcessId " link HYPER:Modula-2/DosD.def.guide/Modul 187};
  lock:@{" FileLockPtr " link HYPER:Modula-2/DosD.def.guide/Modul 206};
  CASE :@{" DeviceListType " link HYPER:Modula-2/DosD.def.guide/Modul 552} OF
  | device:
   handler:@{" BSTR " link HYPER:Modula-2/DosD.def.guide/Modul 184};
   stackSize:LONGINT;
   priority:LONGINT;
   startup:@{" FileSysStartupMsgPtr " link HYPER:Modula-2/DosD.def.guide/Modul 544};
   segList:BPTR;
   globVec:BPTR;
  | volume:
   volumeDate:@{" Date " link HYPER:Modula-2/DosD.def.guide/Modul 215};
   lockList:@{" FileLockPtr " link HYPER:Modula-2/DosD.def.guide/Modul 206};
   diskType:LONGINT;
   unused:LONGINT
  | directory,late,nonBinding:
   assignName:ADDRESS;
   list:@{" AssignListPtr " link HYPER:Modula-2/DosD.def.guide/Modul 546};
  END;
  name:@{" BSTR " link HYPER:Modula-2/DosD.def.guide/Modul 184};
 END;
 @{" DeviceNode " link HYPER:Modula-2/DosD.def.guide/Modul 578}=@{" DeviceList " link HYPER:Modula-2/DosD.def.guide/Modul 553};
 @{" DeviceNodePtr " link HYPER:Modula-2/DosD.def.guide/Modul 579}=POINTER TO @{" DeviceNode " link HYPER:Modula-2/DosD.def.guide/Modul 578};
 @{" DosList " link HYPER:Modula-2/DosD.def.guide/Modul 580}=@{" DeviceList " link HYPER:Modula-2/DosD.def.guide/Modul 553};
 @{" DosListPtr " link HYPER:Modula-2/DosD.def.guide/Modul 581}=POINTER TO @{" DosList " link HYPER:Modula-2/DosD.def.guide/Modul 580};

 @{" LockDosFlags " link HYPER:Modula-2/DosD.def.guide/Modul 583}=(
  ldbRead,ldbWrite,devices,volumes,assigns,entry,ldbDelete,ldb7
  ,ldb8,ldb9,ldb10,ldb11,ldb12,ldb13,ldb14,ldb15
  ,ldb16,ldb17,ldb18,ldb19,ldb20,ldb21,ldb22,ldb23
  ,ldb24,ldb25,ldb26,ldb27,ldb28,ldb29,ldb30,ldb31
 );
 @{" LockDosFlagSet " link HYPER:Modula-2/DosD.def.guide/Modul 589}=SET OF @{" LockDosFlags " link HYPER:Modula-2/DosD.def.guide/Modul 583};

CONST
 ldAll=@{" LockDosFlagSet " link HYPER:Modula-2/DosD.def.guide/Modul 589}{devices,volumes,assigns};

TYPE
 @{" DevProcFlags " link HYPER:Modula-2/DosD.def.guide/Modul 594}=(
  unlock,assign,dpf2,dpf3,dpf4,dpf5,dpf6,dpf7
  ,dpf8,dpf9,dpf10,dpf11,dpf12,dpf13,dpf14,dpf15
  ,dpf16,dpf17,dpf18,dpf19,dpf20,dpf21,dpf22,dpf23
  ,dpf24,dpf25,dpf26,dpf27,dpf28,dpf29,dpf30,dpf31
 );
 @{" DevProcFlagSet " link HYPER:Modula-2/DosD.def.guide/Modul 601}=SET OF @{" DevProcFlags " link HYPER:Modula-2/DosD.def.guide/Modul 594};

 @{" DevProc " link HYPER:Modula-2/DosD.def.guide/Modul 603}=RECORD
  port:@{" MsgPortPtr " link HYPER:Modula-2/ExecD.def.guide/Modul 375};
  lock:@{" FileLockPtr " link HYPER:Modula-2/DosD.def.guide/Modul 206};
  flags:@{" DevProcFlagSet " link HYPER:Modula-2/DosD.def.guide/Modul 601};
  devNode:ADDRESS;
 END;
 @{" DevProcPtr " link HYPER:Modula-2/DosD.def.guide/Modul 609} = POINTER TO @{" DevProc " link HYPER:Modula-2/DosD.def.guide/Modul 603};

 @{" RecordLock " link HYPER:Modula-2/DosD.def.guide/Modul 611}=RECORD
  fh:@{" FileHandlePtr " link HYPER:Modula-2/DosD.def.guide/Modul 204}; (* fh=NIL: Ende des Arrays *)
  offset:LONGCARD;
  length:LONGCARD;
  mode:LONGCARD;
 END;
 @{" RecordLockPtr " link HYPER:Modula-2/DosD.def.guide/Modul 617}=POINTER TO @{" RecordLock " link HYPER:Modula-2/DosD.def.guide/Modul 611};
 (* generischer Array mit offener Obergrenze: *)
 @{" RecordLockArrayPtr " link HYPER:Modula-2/DosD.def.guide/Modul 619}=POINTER TO ARRAY [0..4095] OF @{" RecordLock " link HYPER:Modula-2/DosD.def.guide/Modul 611};

CONST (* modes für LockRecords(), UnLockRecords() *)
 recExclusive=0;
 recExclusiveImmed=1;
 recShared=2;
 recSharedImmed=3;

TYPE
 @{" ExAllDataPtr " link HYPER:Modula-2/DosD.def.guide/Modul 627}=POINTER TO @{" ExAllData " link HYPER:Modula-2/DosD.def.guide/Modul 629};
 @{" ExAllData " link HYPER:Modula-2/DosD.def.guide/Modul 629}=RECORD
  next:@{" ExAllDataPtr " link HYPER:Modula-2/DosD.def.guide/Modul 627};
  name:@{" StrPtr " link HYPER:Modula-2/Arts.def.guide/Modul 20};
  type:LONGINT;
  size:LONGCARD;
  prot:@{" ProtectionFlagSet " link HYPER:Modula-2/DosD.def.guide/Modul 227};
  date:@{" Date " link HYPER:Modula-2/DosD.def.guide/Modul 215};
  comment:@{" StrPtr " link HYPER:Modula-2/Arts.def.guide/Modul 20};
 END;

 @{" ExAllControl " link HYPER:Modula-2/DosD.def.guide/Modul 639}=RECORD
  entries:LONGCARD;
  lastKey:LONGCARD;
  matchString:@{" StrPtr " link HYPER:Modula-2/Arts.def.guide/Modul 20};
  matchFunc:@{" HookPtr " link HYPER:Modula-2/UtilityD.def.guide/Modul 47};
 END;
 @{" ExAllControlPtr " link HYPER:Modula-2/DosD.def.guide/Modul 645}=POINTER TO @{" ExAllControl " link HYPER:Modula-2/DosD.def.guide/Modul 639};

CONST
(*
 Mögliche Werte für den Parameter type von ExAll
*)
 edName=1;
 edType=2;
 edSize=3;
 edProtection=4;
 edDate=5;
 edComment=6;

TYPE
 @{" DateFormat " link HYPER:Modula-2/DosD.def.guide/Modul 658}=(formatDOS,formatINT,formatUSA,formatCDN);

CONST
 formatMAX=MAX(@{" DateFormat " link HYPER:Modula-2/DosD.def.guide/Modul 658});
 lenDatString=16;

TYPE
 @{" DateTimeFlags " link HYPER:Modula-2/DosD.def.guide/Modul 665}=(subst,future,dtf2,dtf3,dtf4,dtf5,dtf6,dtf7);
 @{" DateTimeFlagSet " link HYPER:Modula-2/DosD.def.guide/Modul 667}=SET OF @{" DateTimeFlags " link HYPER:Modula-2/DosD.def.guide/Modul 665};

 @{" DateTime " link HYPER:Modula-2/DosD.def.guide/Modul 669}=RECORD
  date:@{" Date " link HYPER:Modula-2/DosD.def.guide/Modul 215};
  format:@{" DateFormat " link HYPER:Modula-2/DosD.def.guide/Modul 658};
  flags:@{" DateTimeFlagSet " link HYPER:Modula-2/DosD.def.guide/Modul 667};
  strDay:@{" StrPtr " link HYPER:Modula-2/Arts.def.guide/Modul 20};
  strDate:@{" StrPtr " link HYPER:Modula-2/Arts.def.guide/Modul 20};
  strTime:@{" StrPtr " link HYPER:Modula-2/Arts.def.guide/Modul 20};
 END;
 @{" DateTimePtr " link HYPER:Modula-2/DosD.def.guide/Modul 677}=POINTER TO @{" DateTime " link HYPER:Modula-2/DosD.def.guide/Modul 669};

 @{" SysTags " link HYPER:Modula-2/DosD.def.guide/Modul 679}=(sysDummy:=tagUser+32,
  sysInput,sysOutput,sysASynch,sysUserShell,sysCustomShell
 );

 @{" NpTags " link HYPER:Modula-2/DosD.def.guide/Modul 683}=(npDummy:=tagUser+1000,
  npSeglist,npFreeSeglist,npEntry,npInput,npOutput,npCloseInput
  ,npCloseOutput,npError,npCloseError,npCurrentDir,npStackSize,npName
  ,npPriority,npConsoleTask,npWindowPtr,npHomeDir,npCopyVars,npCli
  ,npPath,npCommandName,npArguments,npNotifyOnDeath,npSynchronous
  ,npExitCode,npExitData
 );

 @{" AdoTags " link HYPER:Modula-2/DosD.def.guide/Modul 691}=(adoDummy:=tagUser+2000,
  adoFhMode,adoDirLen,adoCommNameLen,adoCommFileLen,adoPromptLen
 );

CONST
 notifyClass=40000000H;
 notifyCode=1234H;

TYPE
 @{" NotifyFlags " link HYPER:Modula-2/DosD.def.guide/Modul 699}=(
  sendMessage,sendSignal,nf2,waitReply,notifyInitial,
  nf5,nf6,nf7,nf8,nf9,nf10,nf11,nf12,nf13,nf14,nf15,
  nf16,nf17,nf18,nf19,nf20,nf21,nf22,nf23,nf24,nf25,
  nf26,nf27,nf28,nf29,nf30,magic
 );
 @{" NotifyFlagSet " link HYPER:Modula-2/DosD.def.guide/Modul 706}=SET OF @{" NotifyFlags " link HYPER:Modula-2/DosD.def.guide/Modul 699};

 @{" NotifyRequest " link HYPER:Modula-2/DosD.def.guide/Modul 708}=RECORD
  name:@{" StrPtr " link HYPER:Modula-2/Arts.def.guide/Modul 20};
  fullName:@{" StrPtr " link HYPER:Modula-2/Arts.def.guide/Modul 20};
  userData:ADDRESS;
  flags:@{" NotifyFlagSet " link HYPER:Modula-2/DosD.def.guide/Modul 706};
  CASE :INTEGER OF
  | 0:
   port:@{" MsgPortPtr " link HYPER:Modula-2/ExecD.def.guide/Modul 375};
  | 1:
   task:@{" TaskPtr " link HYPER:Modula-2/ExecD.def.guide/Modul 176};
   signalNum:SHORTCARD;
   pad:ARRAY[1..3] OF SHORTCARD;
  END;
  reserved:ARRAY[1..4] OF LONGCARD;
  msgCount:LONGCARD;
  handler:@{" MsgPortPtr " link HYPER:Modula-2/ExecD.def.guide/Modul 375};
 END;
 @{" NotifyRequestPtr " link HYPER:Modula-2/DosD.def.guide/Modul 725}=POINTER TO @{" NotifyRequest " link HYPER:Modula-2/DosD.def.guide/Modul 708};

 @{" NotifyMessage " link HYPER:Modula-2/DosD.def.guide/Modul 727}=RECORD
  execMessage:@{" Message " link HYPER:Modula-2/ExecD.def.guide/Modul 376};
  class:LONGCARD;
  code:CARDINAL;
  nReq:@{" NotifyRequestPtr " link HYPER:Modula-2/DosD.def.guide/Modul 725};
  doNotTouch:LONGCARD;
  doNotTouch2:LONGCARD;
 END;
 @{" NotifyMsgPtr " link HYPER:Modula-2/DosD.def.guide/Modul 735}=POINTER TO @{" NotifyMessage " link HYPER:Modula-2/DosD.def.guide/Modul 727};

 @{" AChainFlags " link HYPER:Modula-2/DosD.def.guide/Modul 737}=(
  patternBit,examinedBit,completed,allBit,single,acf5,acf6,acf7
 );
 @{" AChainFlagSet " link HYPER:Modula-2/DosD.def.guide/Modul 740}=SET OF @{" AChainFlags " link HYPER:Modula-2/DosD.def.guide/Modul 737};

 @{" AChainPtr " link HYPER:Modula-2/DosD.def.guide/Modul 742}=POINTER TO @{" AChain " link HYPER:Modula-2/DosD.def.guide/Modul 743};
 @{" AChain " link HYPER:Modula-2/DosD.def.guide/Modul 743}=RECORD
  child,parent:@{" AChainPtr " link HYPER:Modula-2/DosD.def.guide/Modul 742};
  lock:@{" FileLockPtr " link HYPER:Modula-2/DosD.def.guide/Modul 206};
  info:@{" FileInfoBlock " link HYPER:Modula-2/DosD.def.guide/Modul 229};
  flags:@{" AChainFlagSet " link HYPER:Modula-2/DosD.def.guide/Modul 740};
  (* string:ARRAY [0..??] OF CHAR; *)
 END;

 @{" AnchorPathFlags " link HYPER:Modula-2/DosD.def.guide/Modul 751}=(
  doWild,itsWild,doDir,didDir,noMemErr,doDot,dirChanged,followHLinks
 );
 @{" AnchorPathFlagSet " link HYPER:Modula-2/DosD.def.guide/Modul 754}=SET OF @{" AnchorPathFlags " link HYPER:Modula-2/DosD.def.guide/Modul 751};

 @{" AnchorPath " link HYPER:Modula-2/DosD.def.guide/Modul 756}=RECORD
  base,last:@{" AChainPtr " link HYPER:Modula-2/DosD.def.guide/Modul 742};
  breakBits:LONGSET;
  foundBreak:LONGSET;
  flags:@{" AnchorPathFlagSet " link HYPER:Modula-2/DosD.def.guide/Modul 754};
  reserved:SHORTINT;
  strLen:INTEGER;
  info:@{" FileInfoBlock " link HYPER:Modula-2/DosD.def.guide/Modul 229};
  (* buff:ARRAY [0..strLen-1] OF CHAR; *)
 END;
 @{" AnchorPathPtr " link HYPER:Modula-2/DosD.def.guide/Modul 766}=POINTER TO @{" AnchorPath " link HYPER:Modula-2/DosD.def.guide/Modul 756};

 @{" CSource " link HYPER:Modula-2/DosD.def.guide/Modul 768}=RECORD
  buffer:@{" StrPtr " link HYPER:Modula-2/Arts.def.guide/Modul 20};
  length:LONGINT;
  curChr:LONGINT;
 END;
 @{" CSourcePtr " link HYPER:Modula-2/DosD.def.guide/Modul 773}=POINTER TO @{" CSource " link HYPER:Modula-2/DosD.def.guide/Modul 768};

 @{" RDAFlags " link HYPER:Modula-2/DosD.def.guide/Modul 775}=(
  stdIn,noAlloc,noPrompt,rdaf3,rdaf4,rdaf5,rdaf6,rdaf7
  ,rdaf8,rdaf9,rdaf10,rdaf11,rdaf12,rdaf13,rdaf14,rdaf15
  ,rdaf16
 );
 @{" RDAFlagSet " link HYPER:Modula-2/DosD.def.guide/Modul 780}=SET OF @{" RDAFlags " link HYPER:Modula-2/DosD.def.guide/Modul 775};
 @{" RDArgs " link HYPER:Modula-2/DosD.def.guide/Modul 781}=RECORD
  source:@{" CSource " link HYPER:Modula-2/DosD.def.guide/Modul 768};
  daList:LONGINT;
  buffer:ADDRESS;
  bufSiz:LONGINT;
  extHelp:@{" StrPtr " link HYPER:Modula-2/Arts.def.guide/Modul 20};
  flags:@{" RDAFlagSet " link HYPER:Modula-2/DosD.def.guide/Modul 780};
 END;
 @{" RDArgsPtr " link HYPER:Modula-2/DosD.def.guide/Modul 789}=POINTER TO @{" RDArgs " link HYPER:Modula-2/DosD.def.guide/Modul 781};

CONST
 maxTemplateItems=100;
 maxMultiArgs=128;

TYPE
 @{" VarFlags " link HYPER:Modula-2/DosD.def.guide/Modul 795}=(
  alias,vf1,vf2,vf3,vf4,vf5,vf6,ignore
  ,globalOnly,localOnly,binaryVar,dontNullTerm,vf12,vf13,vf14,vf15
  ,vf16
 );
(*
 VarFlagSet wird als Paramter verwendet (32 bit) in xxxVar().
 Var16FlagSet wird in LocalVar verwendet (16 bit).
 Var8FlagSet wird verwendet um LocalVar.node.type zu setzen.
*)
 @{" VarFlagSet " link HYPER:Modula-2/DosD.def.guide/Modul 806}=SET OF @{" VarFlags " link HYPER:Modula-2/DosD.def.guide/Modul 795};
 @{" Var16FlagSet " link HYPER:Modula-2/DosD.def.guide/Modul 807}=SET OF [alias..vf15];
 @{" Var8FlagSet " link HYPER:Modula-2/DosD.def.guide/Modul 808}=SET OF [alias..ignore];

 @{" LocalVar " link HYPER:Modula-2/DosD.def.guide/Modul 810}=RECORD
  node:@{" Node " link HYPER:Modula-2/ExecD.def.guide/Modul 18};
  flags:@{" Var16FlagSet " link HYPER:Modula-2/DosD.def.guide/Modul 807};
  value:@{" StrPtr " link HYPER:Modula-2/Arts.def.guide/Modul 20};
  len:LONGCARD;
 END;
 @{" LocalVarPtr " link HYPER:Modula-2/DosD.def.guide/Modul 816}=POINTER TO @{" LocalVar " link HYPER:Modula-2/DosD.def.guide/Modul 810};

 @{" AllocProc " link HYPER:Modula-2/DosD.def.guide/Modul 818}=PROCEDURE(LONGINT{R.D0},@{" MemReqSet " link HYPER:Modula-2/ExecD.def.guide/Modul 86}{R.D1}):ADDRESS;
 @{" FreeProc " link HYPER:Modula-2/DosD.def.guide/Modul 819}=PROCEDURE(ADDRESS{R.A1},LONGINT{R.D0});
 @{" ReadProc " link HYPER:Modula-2/AMScan.def.guide/Modul 4}=PROCEDURE(
           FileHandlePtr{R.D1},ADDRESS{R.A0},LONGINT{R.D0}):LONGINT;

 @{" ILArray " link HYPER:Modula-2/DosD.def.guide/Modul 823}=RECORD
  read:@{" ReadProc " link HYPER:Modula-2/AMScan.def.guide/Modul 4};
  alloc:@{" AllocProc " link HYPER:Modula-2/DosD.def.guide/Modul 818};
  free:@{" FreeProc " link HYPER:Modula-2/DosD.def.guide/Modul 819};
 END;
 @{" ILArrayPtr " link HYPER:Modula-2/DosD.def.guide/Modul 828}=POINTER TO @{" ILArray " link HYPER:Modula-2/DosD.def.guide/Modul 823};

 @{" CliInitFlags " link HYPER:Modula-2/DosD.def.guide/Modul 830}=(
  runOutput,userInput,system,systemAsynch,cif4,cif5,cif6,cif7
  ,cif8,cif9,cif10,cif11,cif12,cif13,cif14,cif15
  ,cif16,cif17,cif18,cif19,cif20,cif21,cif22,cif23
  ,cif24,cif25,cif26,cif27,cif28,cif29,cif30,valid
 );
 @{" CliInitFlagSet " link HYPER:Modula-2/DosD.def.guide/Modul 836}=SET OF @{" CliInitFlags " link HYPER:Modula-2/DosD.def.guide/Modul 830};

END DosD.noimp

@endnode
