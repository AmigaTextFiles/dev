@database HYPER:Modula-2/RexxD
@node Main "HYPER:Modula-2/RexxD"

Konstanten

   @{" alpha " link Modul 39}                       @{" append " link Modul 222}                      @{" buffsz " link Modul 202}
   @{" dpNum " link Modul 38}                       @{" exist " link Modul 217}                       @{" globalsz " link Modul 102}
   @{" intNum " link Modul 36}                      @{" keepNum " link Modul 42}                     @{" keepStr " link Modul 41}
   @{" maxRMArg " link Modul 54}                    @{" memMask " link Modul 130}                     @{" memQuant " link Modul 128}
   @{" memQuick " link Modul 131}                    @{" owned " link Modul 40}                       @{" queue " link Modul 233}
   @{" read " link Modul 220}                        @{" rexxName " link Modul 13}                    @{" rxschunk " link Modul 191}
   @{" rxsdir " link Modul 16}                      @{" rxsname " link Modul 15}                     @{" rxsnest " link Modul 192}
   @{" rxsstack " link Modul 194}                    @{" rxstname " link Modul 17}                    @{" rxstpri " link Modul 193}
   @{" stack " link Modul 231}                       @{" stop " link Modul 188}                        @{" strf " link Modul 219}
   @{" write " link Modul 221}                    

Typ-Deklarationen

   @{" ActionRec " link Modul 67}                   @{" Argstring " link Modul 19}                   @{" AttributeFlagSet " link Modul 25}
   @{" AttributeFlags " link Modul 24}              @{" CharAttrFlagSet " link Modul 200}             @{" CharAttrFlags " link Modul 196}
   @{" Command " link Modul 57}                     @{" IoBuff " link Modul 205}                      @{" IoBuffPtr " link Modul 215}
   @{" ModifierFlagSet " link Modul 65}             @{" ModifierFlags " link Modul 62}               @{" NexxStr " link Modul 27}
   @{" NexxStrPtr " link Modul 34}                  @{" RexxArg " link Modul 44}                     @{" RexxArgPtr " link Modul 52}
   @{" RexxMsg " link Modul 73}                     @{" RexxMsgPort " link Modul 224}                 @{" RexxMsgPtr " link Modul 88}
   @{" RexxRsrc " link Modul 90}                    @{" RexxRsrcPtr " link Modul 98}                 @{" RexxTask " link Modul 109}
   @{" RexxTaskFlagSet " link Modul 107}             @{" RexxTaskFlags " link Modul 105}               @{" RexxTaskPtr " link Modul 126}
   @{" RsrcNodeType " link Modul 100}                @{" RxsLib " link Modul 142}                      @{" RxsLibPtr " link Modul 186}
   @{" SrcNode " link Modul 135}                     @{" SrcNodePtr " link Modul 133}                  @{" StrPtr " link Modul 22}


@endnode
@node Modul "HYPER:Modula-2/RexxD.def.guide"
DEFINITION MODULE RexxD; (*$Implementation:=FALSE*)
(* 15-May-1992/cn *)

FROM SYSTEM IMPORT ADDRESS,BPTR;

FROM DosD IMPORT
 @{" DosLibraryPtr " link HYPER:Modula-2/DosD.def.guide/Modul 512},@{" FileHandlePtr " link HYPER:Modula-2/DosD.def.guide/Modul 204},@{" FileLockPtr " link HYPER:Modula-2/DosD.def.guide/Modul 206};

FROM ExecD IMPORT
 @{" ExecBasePtr " link HYPER:Modula-2/ExecD.def.guide/Modul 631},@{" Library " link HYPER:Modula-2/ExecD.def.guide/Modul 400},@{" List " link HYPER:Modula-2/ExecD.def.guide/Modul 30},@{" ListPtr " link HYPER:Modula-2/ExecD.def.guide/Modul 37},@{" MemReqs " link HYPER:Modula-2/ExecD.def.guide/Modul 73},@{" Message " link HYPER:Modula-2/ExecD.def.guide/Modul 376},@{" MessagePtr " link HYPER:Modula-2/ExecD.def.guide/Modul 381}
 ,@{" MsgPort " link HYPER:Modula-2/ExecD.def.guide/Modul 360},@{" MsgPortPtr " link HYPER:Modula-2/ExecD.def.guide/Modul 375},@{" Node " link HYPER:Modula-2/ExecD.def.guide/Modul 18};


CONST
 rexxName="rexxsyslib.library";
 rxsname=rexxName;
 rxsdir="REXX";
 rxstname="ARexx";

TYPE
 @{" Argstring " link HYPER:Modula-2/RexxD.def.guide/Modul 19} = ADDRESS;

 @{" StrPtr " link HYPER:Modula-2/Arts.def.guide/Modul 20}=ADDRESS;

 @{" AttributeFlags " link HYPER:Modula-2/RexxD.def.guide/Modul 24}=(keep,string,notNum,number,binary,float,ext,source);
 @{" AttributeFlagSet " link HYPER:Modula-2/RexxD.def.guide/Modul 25}=SET OF @{" AttributeFlags " link HYPER:Modula-2/RexxD.def.guide/Modul 24};

 @{" NexxStr " link HYPER:Modula-2/RexxD.def.guide/Modul 27}=RECORD
  iValue:LONGINT;
  length:CARDINAL;
  flags:@{" AttributeFlagSet " link HYPER:Modula-2/RexxD.def.guide/Modul 25};
  hash:SHORTCARD;
  (* buff:ARRAY OF CHAR; *)
 END;
 @{" NexxStrPtr " link HYPER:Modula-2/RexxD.def.guide/Modul 34}=POINTER TO @{" NexxStr " link HYPER:Modula-2/RexxD.def.guide/Modul 27};

CONST
 intNum=@{" AttributeFlagSet " link HYPER:Modula-2/RexxD.def.guide/Modul 25}{number,binary,string};
 dpNum=@{" AttributeFlagSet " link HYPER:Modula-2/RexxD.def.guide/Modul 25}{number,float};
 alpha=@{" AttributeFlagSet " link HYPER:Modula-2/RexxD.def.guide/Modul 25}{notNum,string};
 owned=@{" AttributeFlagSet " link HYPER:Modula-2/RexxD.def.guide/Modul 25}{source,ext,keep};
 keepStr=@{" AttributeFlagSet " link HYPER:Modula-2/RexxD.def.guide/Modul 25}{string,source,notNum};
 keepNum=@{" AttributeFlagSet " link HYPER:Modula-2/RexxD.def.guide/Modul 25}{string,source,number,binary};

TYPE
 @{" RexxArg " link HYPER:Modula-2/RexxD.def.guide/Modul 44}=RECORD
  size:LONGINT;
  length:CARDINAL;
  flags:@{" AttributeFlagSet " link HYPER:Modula-2/RexxD.def.guide/Modul 25};
  hash:SHORTCARD;
  (* buff:ARRAY OF CHAR; *)
 END;
 @{" RexxArgPtr " link HYPER:Modula-2/RexxD.def.guide/Modul 52}=POINTER TO @{" RexxArg " link HYPER:Modula-2/RexxD.def.guide/Modul 44};

CONST
  maxRMArg=15;

TYPE
 @{" Command " link HYPER:Modula-2/RexxD.def.guide/Modul 57}=(
  co0,comm,func,close,query,co5,co6,addFH,
  addLib,remLib,addCon,remCon,tcOpn,tcCls
 );
 @{" ModifierFlags " link HYPER:Modula-2/RexxD.def.guide/Modul 62}=(
  noIO,result,moString,token,nonRet,mo5,mo6,mo7
 );
 @{" ModifierFlagSet " link HYPER:Modula-2/RexxD.def.guide/Modul 65}=SET OF @{" ModifierFlags " link HYPER:Modula-2/RexxD.def.guide/Modul 62};

 @{" ActionRec " link HYPER:Modula-2/RexxD.def.guide/Modul 67}=RECORD
  command:@{" Command " link HYPER:Modula-2/RexxD.def.guide/Modul 57};
  modifier:@{" ModifierFlagSet " link HYPER:Modula-2/RexxD.def.guide/Modul 65};
  add:CARDINAL;
 END;

 @{" RexxMsg " link HYPER:Modula-2/RexxD.def.guide/Modul 73}=RECORD
  node:@{" Message " link HYPER:Modula-2/ExecD.def.guide/Modul 376};
  taskBlock:ADDRESS;
  libBase:ADDRESS;
  action:@{" ActionRec " link HYPER:Modula-2/RexxD.def.guide/Modul 67};
  result1:LONGINT;
  result2:LONGINT;
  args:ARRAY [0..maxRMArg] OF @{" StrPtr " link HYPER:Modula-2/Arts.def.guide/Modul 20};
  passPort:@{" MsgPortPtr " link HYPER:Modula-2/ExecD.def.guide/Modul 375};
  commAddr:@{" StrPtr " link HYPER:Modula-2/Arts.def.guide/Modul 20};
  fileExt:@{" StrPtr " link HYPER:Modula-2/Arts.def.guide/Modul 20};
  stdin:@{" FileHandlePtr " link HYPER:Modula-2/DosD.def.guide/Modul 204};
  stdout:@{" FileHandlePtr " link HYPER:Modula-2/DosD.def.guide/Modul 204};
  avail:LONGINT;
 END;
 @{" RexxMsgPtr " link HYPER:Modula-2/RexxD.def.guide/Modul 88}=POINTER TO @{" RexxMsg " link HYPER:Modula-2/RexxD.def.guide/Modul 73};

 @{" RexxRsrc " link HYPER:Modula-2/RexxD.def.guide/Modul 90}=RECORD
  node:@{" Node " link HYPER:Modula-2/ExecD.def.guide/Modul 18};
  func:INTEGER;
  base:ADDRESS;
  size:LONGINT;
  arg1:LONGINT;
  arg2:LONGINT;
 END;
 @{" RexxRsrcPtr " link HYPER:Modula-2/RexxD.def.guide/Modul 98}=POINTER TO @{" RexxRsrc " link HYPER:Modula-2/RexxD.def.guide/Modul 90};

 @{" RsrcNodeType " link HYPER:Modula-2/RexxD.def.guide/Modul 100}=(any,lib,port,file,host,clip);

CONST
 globalsz=200;

TYPE
 @{" RexxTaskFlags " link HYPER:Modula-2/RexxD.def.guide/Modul 105}=(trace,halt,susp,tcUse,rtf4,rtf5,wait,rtfClose);
 @{" RexxTaskFlagSet " link HYPER:Modula-2/RexxD.def.guide/Modul 107}=SET OF @{" RexxTaskFlags " link HYPER:Modula-2/RexxD.def.guide/Modul 105};

 @{" RexxTask " link HYPER:Modula-2/RexxD.def.guide/Modul 109}=RECORD
  global:ARRAY [0..globalsz-1] OF SHORTINT;
  msgPort:@{" MsgPort " link HYPER:Modula-2/ExecD.def.guide/Modul 360};
  flags:@{" RexxTaskFlagSet " link HYPER:Modula-2/RexxD.def.guide/Modul 107};
  sigBit:SHORTINT;
  clientID:ADDRESS;
  msgPkt:ADDRESS;
  taskID:ADDRESS;
  rexxPort:ADDRESS;
  errTrap:ADDRESS;
  stackPtr:ADDRESS;
  envList:@{" List " link HYPER:Modula-2/ExecD.def.guide/Modul 30};
  freeList:@{" List " link HYPER:Modula-2/ExecD.def.guide/Modul 30};
  memList:@{" List " link HYPER:Modula-2/ExecD.def.guide/Modul 30};
  fileList:@{" List " link HYPER:Modula-2/ExecD.def.guide/Modul 30};
  portList:@{" List " link HYPER:Modula-2/ExecD.def.guide/Modul 30};
 END;
 @{" RexxTaskPtr " link HYPER:Modula-2/RexxD.def.guide/Modul 126}=POINTER TO @{" RexxTask " link HYPER:Modula-2/RexxD.def.guide/Modul 109};

CONST
 memQuant=16;
 memMask=0FFFFFFF0H;
 memQuick=public;

TYPE
 @{" SrcNodePtr " link HYPER:Modula-2/RexxD.def.guide/Modul 133}=POINTER TO @{" SrcNode " link HYPER:Modula-2/RexxD.def.guide/Modul 135};
 @{" SrcNode " link HYPER:Modula-2/RexxD.def.guide/Modul 135}=RECORD
  succ:@{" SrcNodePtr " link HYPER:Modula-2/RexxD.def.guide/Modul 133};
  pred:@{" SrcNodePtr " link HYPER:Modula-2/RexxD.def.guide/Modul 133};
  ptr:ADDRESS;
  size:LONGINT;
 END;

TYPE
 @{" RxsLib " link HYPER:Modula-2/RexxD.def.guide/Modul 142}=RECORD
  node:@{" Library " link HYPER:Modula-2/ExecD.def.guide/Modul 400};
  flags:@{" RexxTaskFlagSet " link HYPER:Modula-2/RexxD.def.guide/Modul 107};
  shadow:SHORTCARD;
  sysBase:@{" ExecBasePtr " link HYPER:Modula-2/ExecD.def.guide/Modul 631};
  dosBase:@{" DosLibraryPtr " link HYPER:Modula-2/DosD.def.guide/Modul 512};
  ieeeDPBase:ADDRESS;
  segList:BPTR;
  nil:@{" FileHandlePtr " link HYPER:Modula-2/DosD.def.guide/Modul 204};
  chunk:LONGINT;
  maxNest:LONGINT;
  null:@{" NexxStrPtr " link HYPER:Modula-2/RexxD.def.guide/Modul 34};
  false:@{" NexxStrPtr " link HYPER:Modula-2/RexxD.def.guide/Modul 34};
  true:@{" NexxStrPtr " link HYPER:Modula-2/RexxD.def.guide/Modul 34};
  rexx:@{" NexxStrPtr " link HYPER:Modula-2/RexxD.def.guide/Modul 34};
  command:@{" NexxStrPtr " link HYPER:Modula-2/RexxD.def.guide/Modul 34};
  stdin:@{" NexxStrPtr " link HYPER:Modula-2/RexxD.def.guide/Modul 34};
  stdout:@{" NexxStrPtr " link HYPER:Modula-2/RexxD.def.guide/Modul 34};
  stderr:@{" NexxStrPtr " link HYPER:Modula-2/RexxD.def.guide/Modul 34};
  version:@{" StrPtr " link HYPER:Modula-2/Arts.def.guide/Modul 20};
  taskName:@{" StrPtr " link HYPER:Modula-2/Arts.def.guide/Modul 20};
  taskPri:LONGINT;
  taskSeg:BPTR;
  stackSize:LONGINT;
  rexxDir:@{" StrPtr " link HYPER:Modula-2/Arts.def.guide/Modul 20};
  cTable:@{" StrPtr " link HYPER:Modula-2/Arts.def.guide/Modul 20};
  notice:@{" StrPtr " link HYPER:Modula-2/Arts.def.guide/Modul 20};
  rexxPort:@{" MsgPort " link HYPER:Modula-2/ExecD.def.guide/Modul 360};
  readLock:CARDINAL;
  traceFH:@{" FileHandlePtr " link HYPER:Modula-2/DosD.def.guide/Modul 204};
  taskList:@{" List " link HYPER:Modula-2/ExecD.def.guide/Modul 30};
  numTask:INTEGER;
  libList:@{" List " link HYPER:Modula-2/ExecD.def.guide/Modul 30};
  numLib:INTEGER;
  clipList:@{" List " link HYPER:Modula-2/ExecD.def.guide/Modul 30};
  numClip:INTEGER;
  msgList:@{" List " link HYPER:Modula-2/ExecD.def.guide/Modul 30};
  numMsg:INTEGER;
  pgmList:@{" List " link HYPER:Modula-2/ExecD.def.guide/Modul 30};
  numPgm:INTEGER;
  traceCnt:CARDINAL;
  avail:INTEGER;
 END;
 @{" RxsLibPtr " link HYPER:Modula-2/RexxD.def.guide/Modul 186}=POINTER TO @{" RxsLib " link HYPER:Modula-2/RexxD.def.guide/Modul 142};

CONST
 stop=wait;

 rxschunk=1024;
 rxsnest=32;
 rxstpri=0;
 rxsstack=4096;

TYPE
 @{" CharAttrFlags " link HYPER:Modula-2/RexxD.def.guide/Modul 196}=(
  space,digit,caAlpha,rexxSym,rexxOpr,rexxSpc,upper,lower
 );
 @{" CharAttrFlagSet " link HYPER:Modula-2/RexxD.def.guide/Modul 200}=SET OF @{" CharAttrFlags " link HYPER:Modula-2/RexxD.def.guide/Modul 196};

CONST
 buffsz=204;

TYPE
 @{" IoBuff " link HYPER:Modula-2/RexxD.def.guide/Modul 205}=RECORD
  node:@{" RexxRsrc " link HYPER:Modula-2/RexxD.def.guide/Modul 90};
  rpt:ADDRESS;
  rct:LONGINT;
  dfh:@{" FileHandlePtr " link HYPER:Modula-2/DosD.def.guide/Modul 204};
  lock:@{" FileLockPtr " link HYPER:Modula-2/DosD.def.guide/Modul 206};
  bct:LONGINT;
  area:ARRAY [0..buffsz-1] OF SHORTINT;
 END;
 @{" IoBuffPtr " link HYPER:Modula-2/RexxD.def.guide/Modul 215}=POINTER TO @{" IoBuff " link HYPER:Modula-2/RexxD.def.guide/Modul 205};

CONST
 exist=-1;
 strf=0;
 read=1;
 write=2;
 append=3;

TYPE
 @{" RexxMsgPort " link HYPER:Modula-2/RexxD.def.guide/Modul 224}=RECORD
  node:@{" RexxRsrc " link HYPER:Modula-2/RexxD.def.guide/Modul 90};
  port:@{" MsgPort " link HYPER:Modula-2/ExecD.def.guide/Modul 360};
  replyList:@{" List " link HYPER:Modula-2/ExecD.def.guide/Modul 30};
 END;

CONST
 stack=2002;
 queue=2003;

END RexxD.noimp

@endnode
