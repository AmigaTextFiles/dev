@database HYPER:Modula-2/Serial
@node Main "HYPER:Modula-2/Serial"

Konstanten

   @{" abort " link Modul 16}                       @{" active " link Modul 15}                      @{" break " link Modul 12}
   @{" bufrRead " link Modul 18}                    @{" defaultCtlChar " link Modul 20}              @{" query " link Modul 11}
   @{" queued " link Modul 17}                      @{" select " link Modul 49}                      @{" serialName " link Modul 8}
   @{" setParams " link Modul 13}                

Typ-Deklarationen

   @{" Error " link Modul 52}                       @{" ExtSerFlagSet " link Modul 40}               @{" ExtSerFlags " link Modul 35}
   @{" IOExtSer " link Modul 59}                    @{" IOExtSerPtr " link Modul 73}                 @{" IOSerial " link Modul 78}
   @{" IOSerialPtr " link Modul 79}                 @{" IOTArray " link Modul 22}                    @{" SerFlagSet " link Modul 33}
   @{" SerFlags " link Modul 28}                    @{" Status " link Modul 42}                      @{" StatusSet " link Modul 47}


@endnode
@node Modul "HYPER:Modula-2/Serial.def.guide"
DEFINITION MODULE Serial; (*$Implementation:=FALSE*)
(* 10-May-1992/cn *)

FROM SYSTEM IMPORT ADDRESS,BYTE,LONGSET;

FROM ExecD IMPORT
 nonstd,@{" IOFlagSet " link HYPER:Modula-2/ExecD.def.guide/Modul 431},@{" IOStdReq " link HYPER:Modula-2/ExecD.def.guide/Modul 447};

CONST
 serialName="serial.device";

 query=nonstd;
 break=nonstd+1;
 setParams=nonstd+2;

 active=@{" IOFlagSet " link HYPER:Modula-2/ExecD.def.guide/Modul 431}{4};
 abort=@{" IOFlagSet " link HYPER:Modula-2/ExecD.def.guide/Modul 431}{5};
 queued=@{" IOFlagSet " link HYPER:Modula-2/ExecD.def.guide/Modul 431}{6};
 bufrRead=@{" IOFlagSet " link HYPER:Modula-2/ExecD.def.guide/Modul 431}{7};

 defaultCtlChar=11130000H;

TYPE
 @{" IOTArray " link HYPER:Modula-2/Serial.def.guide/Modul 22}=RECORD
  termArray0:LONGCARD;
  termArray1:LONGCARD;
 END;

TYPE
 @{" SerFlags " link HYPER:Modula-2/Serial.def.guide/Modul 28}=(
  partyOn,partyOdd,sevenWire,queuedBrk
  ,radBoogie,shared,eofMode,xDisabled
 );
 @{" SerFlagSet " link HYPER:Modula-2/Serial.def.guide/Modul 33}=SET OF @{" SerFlags " link HYPER:Modula-2/Serial.def.guide/Modul 28};

 @{" ExtSerFlags " link HYPER:Modula-2/Serial.def.guide/Modul 35}=(
  mark,mSpOn,esf2,esf3,esf4,esf5,esf6,esf7,
  esf8,esf9,esf10,esf11,esf12,esf13,esf14,esf15,
  esf16
 );
 @{" ExtSerFlagSet " link HYPER:Modula-2/Serial.def.guide/Modul 40}=SET OF @{" ExtSerFlags " link HYPER:Modula-2/Serial.def.guide/Modul 35};

 @{" Status " link HYPER:Modula-2/Parallel.def.guide/Modul 28}=(
  sta0,sta1,ringIndicator,dataSetReady,clearToSend,carrierDetect
  ,readyToSend,dataTerminalReady,overrun,wroteBreak,readBreak
  ,xOffWrite,xOffRead
 );
 @{" StatusSet " link HYPER:Modula-2/Parallel.def.guide/Modul 30}=SET OF @{" Status " link HYPER:Modula-2/Parallel.def.guide/Modul 28};

CONST
 select=ringIndicator;

TYPE
 @{" Error " link HYPER:Modula-2/Printer.def.guide/Modul 95}=(
  e0,devBusy,baudMismatch,invBaud,bufErr,invParam,lineErr,notOpen
  ,portReset,parityErr,initErr,timerErr,bufOverflow,nodsr,nocts
  ,detectedBreak
 );

 @{" IOExtSer " link HYPER:Modula-2/Serial.def.guide/Modul 59}=RECORD
  ioSer:@{" IOStdReq " link HYPER:Modula-2/ExecD.def.guide/Modul 447};
  ctlChar:LONGCARD;
  rBufLen:LONGCARD;
  extFlags:@{" ExtSerFlagSet " link HYPER:Modula-2/Serial.def.guide/Modul 40};
  baud:LONGCARD;
  brkTime:LONGCARD;
  termArray:@{" IOTArray " link HYPER:Modula-2/Serial.def.guide/Modul 22};
  readLen:SHORTCARD;
  writeLen:SHORTCARD;
  stopBits:SHORTCARD;
  serFlags:@{" SerFlagSet " link HYPER:Modula-2/Serial.def.guide/Modul 33};
  status:@{" StatusSet " link HYPER:Modula-2/Parallel.def.guide/Modul 30};
 END;
 @{" IOExtSerPtr " link HYPER:Modula-2/Serial.def.guide/Modul 73}=POINTER TO @{" IOExtSer " link HYPER:Modula-2/Serial.def.guide/Modul 59};

(*
 Synonyme mit einheitlicher Namesgebung
*)
 @{" IOSerial " link HYPER:Modula-2/Serial.def.guide/Modul 78}=@{" IOExtSer " link HYPER:Modula-2/Serial.def.guide/Modul 59};
 @{" IOSerialPtr " link HYPER:Modula-2/Serial.def.guide/Modul 79}=@{" IOExtSerPtr " link HYPER:Modula-2/Serial.def.guide/Modul 73};

END Serial.noimp

@endnode
