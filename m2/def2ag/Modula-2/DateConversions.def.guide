@database HYPER:Modula-2/DateConversions
@node Main "HYPER:Modula-2/DateConversions"

Prozeduren

   @{" DateToStr " link Modul 36}                   @{" DecodeDate " link Modul 31}                  @{" EncodeDate " link Modul 33}
   @{" FromDos " link Modul 25}                     @{" FromTimer " link Modul 26}                   @{" ToDos " link Modul 28}
   @{" ToTimer " link Modul 29}                  

Konstanten

   @{" month " link Modul 13}                       @{" month3 " link Modul 11}                   

Typ-Deklarationen

   @{" DateInfo " link Modul 15}                 

@endnode
@node Modul "HYPER:Modula-2/DateConversions.def.guide"
DEFINITION MODULE DateConversions;
(*$ NameChk:=FALSE *)
(*
 * This modules handles times and dates in the range of
 * 00:00:00.000000 1 March 1900 - 23:59:59.999999 of the
 * 28 February 2100
 *)

FROM DosD IMPORT @{" Date " link HYPER:Modula-2/DosD.def.guide/Modul 215};
FROM Timer IMPORT @{" TimeVal " link HYPER:Modula-2/Timer.def.guide/Modul 19};

CONST
 month3="Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec";
 month="January|February|March|April|May|June|July|August|September|October|November|December";

TYPE
 @{" DateInfo " link HYPER:Modula-2/DateConversions.def.guide/Modul 15}=RECORD
  minutes:LONGINT;
  micros:LONGINT;
 END;
(*
 * Containes the minutes and microseconds passed
 * since 00:00 of the 1. March 1900
 *)

PROCEDURE FromDos(d:@{" Date " link HYPER:Modula-2/DosD.def.guide/Modul 215}; VAR di:@{" DateInfo " link HYPER:Modula-2/DateConversions.def.guide/Modul 15});
PROCEDURE FromTimer(t:@{" TimeVal " link HYPER:Modula-2/Timer.def.guide/Modul 19}; VAR di:@{" DateInfo " link HYPER:Modula-2/DateConversions.def.guide/Modul 15});

PROCEDURE ToDos(di:@{" DateInfo " link HYPER:Modula-2/DateConversions.def.guide/Modul 15}; VAR d:@{" Date " link HYPER:Modula-2/DosD.def.guide/Modul 215});
PROCEDURE ToTimer(di:@{" DateInfo " link HYPER:Modula-2/DateConversions.def.guide/Modul 15}; VAR t:@{" TimeVal " link HYPER:Modula-2/Timer.def.guide/Modul 19});

PROCEDURE DecodeDate(minutes:LONGINT;
                     VAR day,month,year:INTEGER);
PROCEDURE EncodeDate(day,month,year:INTEGER;
                     VAR minutes:LONGINT);

PROCEDURE @{" DateToStr " link HYPER:Autodocs/dos/DateToStr() }(di:@{" DateInfo " link HYPER:Modula-2/DateConversions.def.guide/Modul 15}; formatString,
                    monthText:ARRAY OF CHAR;
                    VAR output:ARRAY OF CHAR);
(*
 * The formatstring specifies which fields of the should
 * appear in the ouput string. The format string can
 * inlude normal text as well as format commands, e.g.
 *
 *   "Date: %d. %t %Y  Time: %H:%M:%S.%3"
 *
 * This format would result in a string like
 *
 *   Date: 25 July 1989  Time: 22:33:21.423
 *
 * The format commands are introduced by a % and are:
 *
 *  %E   Escape
 *  %N   Newline
 *  %T   Tab
 *  %%   %
 *  %d   day as 2 digit number
 *  %m   month as 2 digit number
 *  %t   month as text
 *  %y   year as 2 digit number
 *  %Y   year as 4 digit number
 *  %H   hour as 2 digit number
 *  %M   minute as 2 digit number
 *  %S   second as 2 digit number
 *  %1   tenth seconds as 1 digit number
 *  %2   hundreth seconds as 2 digit number
 *  %3   ...
 *  .
 *  %6   microsecond as 6 digit number
 *)

END DateConversions.

@endnode
