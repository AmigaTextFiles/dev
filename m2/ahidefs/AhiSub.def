DEFINITION MODULE AhiSub; (*$ Implementation:=FALSE *)

(*
**	$VER: ahi_sub.h 4.1 (2.4.97)
**
**	ahi/[driver].audio definitions
**
**	(C) Copyright 1994-1997 Martin Blom
**	All Rights Reserved.
**
**      Translated to Modula-2 (M2Amiga 4.3) by Nicky
**      Warning: Not tested !
*)

(*****************************************************************************)

 FROM SYSTEM IMPORT ADDRESS, LONGSET, CAST;
 FROM UtilityD IMPORT Hook, HookPtr, tagUser, TagItem, TagItemPtr;
 FROM Ahi IMPORT AHITagBase, AHIAudioCtrl, Fixed, sposition;
 IMPORT R;

(*****************************************************************************)

TYPE
(*** STRUCTURES *)

(* AHIAudioCtrlDrv *)
AHIAudioCtrlDrvPtr = POINTER TO AHIAudioCtrlDrv;
AHIAudioCtrlDrv = RECORD
	ahiacAudioCtrl: AHIAudioCtrl;
	ahiacFlags: LONGCARD;		(* See below for definition *)
	ahiacSoundFunc: HookPtr;	(* AHIA_SoundFunc *)
	ahiacPlayerFunc: HookPtr;	(* AHIA_PlayerFunc *)
	ahiacPlayerFreq: Fixed;		(* AHIA_PlayerFreq *)
	ahiacMinPlayerFreq: Fixed;	(* AHIA_MinPlayerFreq *)
	ahiacMaxPlayerFreq: Fixed;	(* AHIA_MaxPlayerFreq *)
	ahiacMixFreq: LONGCARD;		(* AHIA_MixFreq *)
	ahiacChannels: CARDINAL;	(* AHIA_Channels *)
	ahiacSounds: CARDINAL;		(* AHIA_Sounds *)

	ahiacDriverData: ADDRESS;	(* Unused. Store whatever you want here. *)

	ahiacMixerFunc: HookPtr;	(* Mixing routine Hook *)
	ahiacSamplerFunc: HookPtr;	(* Sampler routine Hook *)
	ahiacObsolete: LONGCARD;
	ahiacBuffSamples: LONGCARD;	(* Samples to mix this pass. *)
	ahiacMinBuffSamples: LONGCARD;	(* Min. samples to mix each pass. *)
	ahiacMaxBuffSamples: LONGCARD;	(* Max. samples to mix each pass. *)
	ahiacBuffSize: LONGCARD;	(* Buffer size ahiac_MixerFunc needs. *)
	ahiacBuffType: LONGCARD;	(* Buffer format (V2) *)
	ahiacPreTimer: PROCEDURE(): BOOLEAN;	(* Call before mixing (V4) *)
	ahiacPostTimer: PROC;		(* Call after mixing (V4) *)

(* The rest is PRIVATE! Hands off! They may change any time.
	[lots of private stuff] *)
END;

CONST
(*** TAGS *)

AHIDBUserBase = AHITagBase+500;		(* Use for driver specific tags *)


(*** DEFS *)

 (* AllocAudio return flags *)
AHISFERROR = 		LONGSET{0};
AHISFMIXING = 		LONGSET{1};
AHISFTIMING = 		LONGSET{2};
AHISFKNOWSTEREO = 	LONGSET{3};
AHISFKNOWHIFI = 	LONGSET{4};
AHISFCANRECORD = 	LONGSET{5};
AHISFCANPOSTPROCESS = 	LONGSET{6};

AHISBERROR = 		0;
AHISBMIXING = 		1;
AHISBTIMING = 		2;
AHISBKNOWSTEREO = 	3;
AHISBKNOWHIFI = 	4;
AHISBCANRECORD = 	5;
AHISBCANPOSTPROCESS = 	6;

 (* AHIsub_Start() and AHIsub_Stop() flags *)
AHISFPLAY =		LONGSET{0};
AHISFRECORD =		LONGSET{1};

AHISBPLAY =		0;
AHISBRECORD =		1;

 (* ahiac_Flags *)
AHIACFVOL =		LONGSET{0};
AHIACFPAN =		LONGSET{1};
AHIACFSTEREO =		LONGSET{2};
AHIACFHIFI =		LONGSET{2};
AHIACFPINGPONG =	LONGSET{4};
AHIACFRECORD =		LONGSET{5};
AHIACFMULTTAB =  	LONGSET{6};		(* Private! *)

AHIACBVOL =		0;
AHIACBPAN =		1;
AHIACBSTEREO =		2;
AHIACBHIFI =		3;
AHIACBPINGPONG =	4;
AHIACBRECORD =		5;
AHIACBMULTTAB =  	6;			(* Private! *)

 (* AHIsub_Set#? and AHIsub_(Un)LoadSound return code *)
AHISUNKNOWN =		MAX(LONGCARD);

 (* IFF chunk names for the audio mode file *)
IDAHIM =	CAST(LONGCARD, "AHIM");		(* AHI Modes *)
IDAUDN =	CAST(LONGCARD, "AUDN");		(* AUDio driver Name *)
IDAUDD =	CAST(LONGCARD, "AUDD");		(* AUDio driver Data *)
IDAUDM =	CAST(LONGCARD, "AUDM");		(* AUDio Mode *)


PROCEDURE AllocAudio(ahiSub{R.A6}: ADDRESS;
 tags{R.A1}: TagItemPtr; audioCtrl{R.A2}: AHIAudioCtrlDrvPtr): LONGSET;
CODE -30;

PROCEDURE FreeAudio(ahiSub{R.A6}: ADDRESS;
 audioCtrl{R.A2}: AHIAudioCtrlDrvPtr);
CODE -36;

PROCEDURE Disable(ahiSub{R.A6}: ADDRESS;
 audioCtrl{R.A2}: AHIAudioCtrlDrvPtr);
CODE -42;

PROCEDURE Enable(ahiSub{R.A6}: ADDRESS;
 audioCtrl{R.A2}: AHIAudioCtrlDrvPtr);
CODE -48;

PROCEDURE Start(ahiSub{R.A6}: ADDRESS;
 flags{R.D0}: LONGSET; audioCtrl{R.A2}: AHIAudioCtrlDrvPtr): LONGCARD;
CODE -54;

PROCEDURE Update(ahiSub{R.A6}: ADDRESS;
 flags{R.D0}: LONGSET; audioCtrl{R.A2}: AHIAudioCtrlDrvPtr): LONGCARD;
CODE -60;

PROCEDURE Stop(ahiSub{R.A6}: ADDRESS;
 flags{R.D0}: LONGSET; audioCtrl{R.A2}: AHIAudioCtrlDrvPtr): LONGCARD;
CODE -66;

PROCEDURE SetVol(ahiSub{R.A6}: ADDRESS;
 channel{R.D0}: CARDINAL; volume{R.D1}: Fixed; pan{R.D2}: sposition;
 audioCtrl{R.A2}: AHIAudioCtrlDrvPtr; flags{R.D3}: LONGSET): LONGCARD;
CODE -72;

PROCEDURE SetFreq(ahiSub{R.A6}: ADDRESS;
 channel{R.D0}: CARDINAL; freq{R.D1}: LONGCARD;
 audioCtrl{R.A2}: AHIAudioCtrlDrvPtr; flags{R.D2}: LONGSET): LONGCARD;
CODE -78;

PROCEDURE SetSound(ahiSub{R.A6}: ADDRESS;
 channel{R.D0}: CARDINAL; sound{R.D1}: CARDINAL; offset{R.D2}: LONGCARD;
 length{R.D3}: LONGINT; audioCtrl{R.A2}: AHIAudioCtrlDrvPtr;
 flags{R.D4}: LONGSET): LONGCARD;
CODE -84;

PROCEDURE SetEffect(ahiSub{R.A6}: ADDRESS;
 effect{R.A0}: ADDRESS; audioCtrl{R.A2}: AHIAudioCtrlDrvPtr): LONGCARD;
CODE -90;

PROCEDURE LoadSound(ahiSub{R.A6}: ADDRESS;
 sound{R.D0}: CARDINAL; type{R.D1}: LONGCARD;
 info{R.A0}: ADDRESS; audioCtrl{R.A2}: AHIAudioCtrlDrvPtr): LONGCARD;
CODE -96;

PROCEDURE UnloadSound(ahiSub{R.A6}: ADDRESS;
 sound{R.D0}: CARDINAL; audioCtrl{R.A2}: AHIAudioCtrlDrvPtr): LONGCARD;
CODE -102;

PROCEDURE GetAttr(ahiSub{R.A6}: ADDRESS;
 attribute{R.D0}: LONGCARD; argument{R.D1}, default{R.D2}: LONGINT;
 tags{R.A1}: TagItemPtr; audioCtrl{R.A2}: AHIAudioCtrlDrvPtr): LONGINT;
CODE -108;

PROCEDURE HardwareControl(ahiSub{R.A6}: ADDRESS;
 attribute{R.D0}: LONGCARD; argument{R.D1}: LONGINT;
 audioCtrl{R.A2}: AHIAudioCtrlDrvPtr): LONGINT;
CODE -114;

END AhiSub.
