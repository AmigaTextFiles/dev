#
#		$PROJECT: ConfigFile.library
#		$FILE: SMakeFile
#		$DESCRIPTION: SAS/C Make File.
#
#		(C) Copyright 1996-1997 Marcel Karas
#			 All Rights Reserved.
#

.c.o:
#	SC RESOPTS $(GST) $(CFLAGS) $(OPTIMIZE) CPU=$(CPU) DISASM=$*.s OBJNAME=$*.o $*.c
	SC RESOPTS $(GST) $(CFLAGS) $(OPTIMIZE) CPU=$(CPU) OBJNAME=$*.o $*.c

.asm.o:
	ASM -m2 $*.asm

FUNCS		= Funcs/

CFLAGS	=	NODEBUG STREQ STRMERGE NOSTKCHK NOVER PARMS=R MATH=S PPBUF=1000000 \
				MEMSIZE=H CNEST UCHAR NOMINC
#				MEMSIZE=H CNEST UCHAR NOMINC DEBUG=LINE
LFLAGS	= SC SD NOICONS

OPTIMIZE	= OPT OPTGO OPTSCHED OPTINLOCAL OPTSIZE OPTCOMP=0 OPTDEP=6 OPTRDEP=6 OPTLOOP
#OPTIMIZE	= 
GST		= GST=CF.GST GSTIMM
LIBS		= LIB:sc.lib LIB:amiga.lib
#CPU		= 000
CPU		= 060

OBJS		=	RomTag.o LibCode.o \
				$(FUNCS)StrConv.o \
				$(FUNCS)GlobalVars.o \
				$(FUNCS)Open&Close.o \
				$(FUNCS)Read.o \
				$(FUNCS)Write.o \
				$(FUNCS)WriteBuffer.o \
				$(FUNCS)Add.o \
				$(FUNCS)New.o \
				$(FUNCS)Dispose.o \
				$(FUNCS)Clone.o \
				$(FUNCS)Remove.o \
				$(FUNCS)Clear.o \
				$(FUNCS)Change.o \
				$(FUNCS)Find.o \
				$(FUNCS)Get.o \
				$(FUNCS)Lock.o \
				$(FUNCS)Next.o \
				$(FUNCS)Last.o \
				$(FUNCS)Unlock.o \
				$(FUNCS)GetName.o \
				$(FUNCS)GetOf.o \
				CType.o Utils.o

All: CF.GST ConfigFile.library

ConfigFile.library: $(OBJS)
	SLink WITH <<
$(OBJS)
MAP MapFile f,h,l,o,s,x WIDTH 86
LIB $(LIBS) $(LFLAGS)
TO $@2
<
	HunkShort $@2 $@
	Copy $@ TO LIBS: NOREQ
	Flush configfile.library

CF.GST: PreInclude.c INCLUDE:Libraries/ConfigFile.h CF.h
	GST >NIL: UNLOAD $@
	SC RESOPTS NOOBJNAME PPBUF=1000000 MEMSIZE=H MAKEGST=$@ PreInclude.c
	GST $@

ad:
	AutoDoc -a -s -C -I  \
	$(FUNCS)Open&Close.c \
	$(FUNCS)Read.c \
	$(FUNCS)Write.c \
	$(FUNCS)Add.c \
	$(FUNCS)New.c \
	$(FUNCS)Dispose.c \
	$(FUNCS)Clone.c \
	$(FUNCS)Remove.c \
	$(FUNCS)Clear.c \
	$(FUNCS)Change.c \
	$(FUNCS)Find.c \
	$(FUNCS)Get.c \
	$(FUNCS)Lock.c \
	$(FUNCS)Unlock.c \
	$(FUNCS)Next.c \
	$(FUNCS)Last.c \
	$(FUNCS)GetName.c \
	$(FUNCS)GetOf.c >ConfigFile.doc
	CleanSpaces ConfigFile.doc
	AD2AG ConfigFile.doc

br:
	SC:C/BumpRev 2 ConfigFile.library

RomTag.o: RomTag.asm ConfigFile.library_rev.i
LibCode.o: LibCode.c LibBase.h ConfigFile.library_rev.i
Utils.o: Utils.c Utils.h
