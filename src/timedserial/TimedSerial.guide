@DATABASE TimedSerial.guide
@REM Source: TimedSerial.c

@NODE "Main" "TimedSerial.guide"
@{JCENTER}
@{FG HIGHLIGHT}@{B}TABLE OF CONTENTS@{UB}@{FG TEXT} @{JLEFT}

  @{"TimeSerial.c          " LINK "TimeSerial.c"} -- Read me first!

  @{"BreakSerial()         " LINK "BreakSerial()"}
  @{"ClearSerial()         " LINK "ClearSerial()"}
  @{"CloseSerial()         " LINK "CloseSerial()"}
  @{"CloseTimer()          " LINK "CloseTimer()"}
  @{"FlushSerial()         " LINK "FlushSerial()"}
  @{"GetErrNum()           " LINK "GetErrNum()"}
  @{"GetSerialStatus()     " LINK "GetSerialStatus()"}
  @{"KillTimer()           " LINK "KillTimer()"}
  @{"OpenSerial()          " LINK "OpenSerial()"}
  @{"QuerySerial()         " LINK "QuerySerial()"}
  @{"ReadChar()            " LINK "ReadChar()"}
  @{"ReadString()          " LINK "ReadString()"}
  @{"ResetSerial()         " LINK "ResetSerial()"}
  @{"SetSerialParams()     " LINK "SetSerialParams()"}
  @{"SetupTimer()          " LINK "SetupTimer()"}
  @{"StartSerial()         " LINK "StartSerial()"}
  @{"StartTimer()          " LINK "StartTimer()"}
  @{"StopSerial()          " LINK "StopSerial()"}
  @{"TestTimer()           " LINK "TestTimer()"}
  @{"TimerDelay()          " LINK "TimerDelay()"}
  @{"TranslateErrorNumber()" LINK "TranslateErrorNumber()"}
  @{"WriteChar()           " LINK "WriteChar()"}
  @{"WriteString()         " LINK "WriteString()"}

@ENDNODE

@NODE "TimeSerial.c" "TimeSerial.c"
@{FG SHINE}TimeSerial.c@{FG TEXT}

@{B}NAME@{UB}
@{B}    TimedSerial.c@{UB}

@{B}COPYRIGHT@{UB}
    TimedSerial.c @{B}(C)@{UB} 2000 by Jim Steichen

    You may use the code as you see fit, but @{B}DO NOT@{UB} modify it without
    informing me of your changes!  I don't expect to get rich from 
    this code, but if you feel like paying for it, feel free to contact
    me at: @{B}jimbot\@frontiernet.net@{UB} for instructions on how to do so.
    
@{B}DESCRIPTION@{UB}
    This file contains the code to issue serial commands
    that will time-out if there is no response from the
    PC at the other end of the serial link.  Included in the archive are
    object files for the 68020 & the PowerPC (AmigaOne) processors.

@{B}HISTORY@{UB}
@{ FG SHINE}
    28-Oct-2004 - Added AmigaOS4 (PPC) & gcc support. @{FG TEXT}
        
    25-Dec-2002 - Added a boolean flag to each function that
                  uses the timer in order to control whether
                  the timer uses microseconds or seconds.
                  Also modified the TranslateErrorNumber
                  function to return a string with incorrect
                  error number values (V2.0).

    28-Sep-2000 - Added the serName parameter to the OpenSerial()
                  function (V1.1). 
    30-Dec-1998 - Added GetErrNum() & GetSerialStatus() (V1.0)
    06-Nov-1996 - Created.


@{B}NOTES@{UB}
@{B}@{FG SHINE}    The following functions are available to the User:

    VISIBLE int   GetErrNum( void );
    VISIBLE int   GetSerialStatus( void );
    VISIBLE void  TimerDelay( int delayseconds, BOOL microFlag );
    VISIBLE int   TestTimer( void );
    VISIBLE char *TranslateErrorNumber( int errnum );

    VISIBLE int   OpenSerial( char *serName,
                              int   unit, 
                              int   HowLong, 
                              int   buffersize,
                              int   flags
                            ); 

    VISIBLE void  CloseSerial( void );

    VISIBLE char  *ReadString( int timeout, BOOL microFlag, int strsize );
    VISIBLE UBYTE  ReadChar(   int timeout, BOOL microFlag              );

    VISIBLE int WriteString( int timeout, BOOL microFlag, char *string, int strsize );
    VISIBLE int WriteChar(   int timeout, BOOL microFlag, int   ch                  );

    VISIBLE int ResetSerial( int timeout, BOOL microFlag );
    VISIBLE int ClearSerial( int timeout, BOOL microFlag );
    VISIBLE int FlushSerial( int timeout, BOOL microFlag );
    VISIBLE int StopSerial(  int timeout, BOOL microFlag );
    VISIBLE int StartSerial( int timeout, BOOL microFlag );
    VISIBLE int QuerySerial( int timeout, BOOL microFlag );

    VISIBLE int BreakSerial( int timeout, BOOL microFlag, int duration );
    VISIBLE int SetSerialParams( int timeout, BOOL microFlag, int which, int params );

 $VER: TimedSerial.c 2.0 (25-Dec-2002) by J.T. Steichen
 
 My e-mail address: jimbot\@frontiernet.net

@{FG TEXT}@{UB}
@ENDNODE

@NODE "BreakSerial()" "BreakSerial()"
@{FG SHINE}BreakSerial()@{FG TEXT}

@{B}NAME@{UB}
@{B}    BreakSerial()

@{UB}
@{B}SYNOPSIS@{UB}
    int success = BreakSerial( int timeout, BOOL microFlag, int duration );


@{B}DESCRIPTION@{UB}
    Issue a SDCMD_BREAK to the Serial device with the break
    duration given (success < 0 means the timer timed out). 

@ENDNODE

@NODE "ClearSerial()" "ClearSerial()"
@{FG SHINE}ClearSerial()@{FG TEXT}

@{B}NAME@{UB}
@{B}    ClearSerial()

@{UB}
@{B}SYNOPSIS@{UB}
    int success = ClearSerial( int timeout, BOOL microFlag );


@{B}DESCRIPTION@{UB}
    Issue a CMD_CLEAR to the Serial device (success < 0 means
    the timer timed out). 

@ENDNODE

@NODE "CloseSerial()" "CloseSerial()"
@{FG SHINE}CloseSerial()@{FG TEXT}

@{B}NAME@{UB}
@{B}    CloseSerial()

@{UB}
@{B}SYNOPSIS@{UB}
    void CLoseSerial( void );


@{B}DESCRIPTION@{UB}
    Close the Serial & timeout timer devices, then Free the memory
    allocated to them.

@ENDNODE

@NODE "CloseTimer()" "CloseTimer()"
@{FG SHINE}CloseTimer()@{FG TEXT}

@{B}NAME@{UB}
@{B}    CloseTimer()

@{UB}
@{B}DESCRIPTION@{UB}
    Close the Timer & Serial devices & Free memory allocated.  

@ENDNODE

@NODE "FlushSerial()" "FlushSerial()"
@{FG SHINE}FlushSerial()@{FG TEXT}

@{B}NAME@{UB}
@{B}    FlushSerial()

@{UB}
@{B}SYNOPSIS@{UB}
    int success = FlushSerial( int timeout, BOOL microFlag );


@{B}DESCRIPTION@{UB}
    Issue a CMD_FLUSH to the Serial device (success < 0 means
    the timer timed out). 

@ENDNODE

@NODE "GetErrNum()" "GetErrNum()"
@{FG SHINE}GetErrNum()@{FG TEXT}

@{B}NAME@{UB}
@{B}    GetErrNum()

@{UB}
@{B}SYNOPSIS@{UB}
    int errnum = GetErrNum( void );


@{B}DESCRIPTION@{UB}
    Return the value that the internal ErrorNumber variable is set at.

@ENDNODE

@NODE "GetSerialStatus()" "GetSerialStatus()"
@{FG SHINE}GetSerialStatus()@{FG TEXT}

@{B}NAME@{UB}
@{B}    GetSerialStatus()

@{UB}
@{B}SYNOPSIS@{UB}
    int success = GetSerialStatus( void );


@{B}DESCRIPTION@{UB}
    Return the internal SerialStatus variable setting.

@ENDNODE

@NODE "KillTimer()" "KillTimer()"
@{FG SHINE}KillTimer()@{FG TEXT}

@{B}NAME@{UB}
@{B}    KillTimer()

@{UB}
@{B}DESCRIPTION@{UB}
    Stop the Serial timeout timer 


@{B}NOTES@{UB}
@{B}@{FG SHINE}    CloseTimer() still has to be called in order to shut down
    completely!
@{FG TEXT}@{UB}
@ENDNODE

@NODE "OpenSerial()" "OpenSerial()"
@{FG SHINE}OpenSerial()@{FG TEXT}

@{B}NAME@{UB}
@{B}    OpenSerial()

@{UB}
@{B}SYNOPSIS@{UB}
    int success = OpenSerial( char *serName,    // Name of Serial device
                              int   unit,       // Serial Unit #
                              int   HowLong,    // Timeout delay
                              int   buffersize, // Serial buffer size
                              int   flags       // SerialIO Flags
                            );

@{B}DESCRIPTION@{UB}
    Initialize & Open the Serial & timer devices.

@ENDNODE

@NODE "QuerySerial()" "QuerySerial()"
@{FG SHINE}QuerySerial()@{FG TEXT}

@{B}NAME@{UB}
@{B}    QuerySerial()

@{UB}
@{B}SYNOPSIS@{UB}
    int success = QuerySerial( int timeout, BOOL microFlag );

@{B}DESCRIPTION@{UB}
    Issue a SDCMD_QUERY to the Serial device (success < 0 means
    the timer timed out). 

@ENDNODE

@NODE "ReadChar()" "ReadChar()"
@{FG SHINE}ReadChar()@{FG TEXT}

@{B}NAME@{UB}
@{B}    ReadChar()

@{UB}
@{B}SYNOPSIS@{UB}
    UBYTE ch = ReadChar( int timeout, BOOL microFlag );


@{B}DESCRIPTION@{UB}
    Read a single character from the Serial port.

@ENDNODE

@NODE "ReadString()" "ReadString()"
@{FG SHINE}ReadString()@{FG TEXT}

@{B}NAME@{UB}
@{B}    ReadString()

@{UB}
@{B}SYNOPSIS@{UB}
    char *string = ReadString( int timeout, BOOL microFlag, int strsize );


@{B}DESCRIPTION@{UB}
    Read a string characters strsize long from the Serial port.

@ENDNODE

@NODE "ResetSerial()" "ResetSerial()"
@{FG SHINE}ResetSerial()@{FG TEXT}

@{B}NAME@{UB}
@{B}    ResetSerial()

@{UB}
@{B}SYNOPSIS@{UB}
    int success = ResetSerial( int timeout, BOOL microFlag );


@{B}DESCRIPTION@{UB}
    Reset the Serial Port & change the timeout value.
    (success >= 0 means NO ERROR).

@ENDNODE

@NODE "SetSerialParams()" "SetSerialParams()"
@{FG SHINE}SetSerialParams()@{FG TEXT}

@{B}NAME@{UB}
@{B}    SetSerialParams()

@{UB}
@{B}SYNOPSIS@{UB}
    int success = SetSerialParams( int  timeout,
                                   BOOL microFlag, 
                                   int  whichparm,
                                   int  param
                                 );


@{B}DESCRIPTION@{UB}
    Issue a SDCMD_SETPARAMS to the Serial device for the given
    parameter type & value (success < 0 means the timer timed 
    out or an unknown value for whichparm).

@ENDNODE

@NODE "SetupTimer()" "SetupTimer()"
@{FG SHINE}SetupTimer()@{FG TEXT}

@{B}NAME@{UB}
@{B}    SetupTimer()

@{UB}
@{B}DESCRIPTION@{UB}
    Initialize the timer's Port & Open the device.

@ENDNODE

@NODE "StartSerial()" "StartSerial()"
@{FG SHINE}StartSerial()@{FG TEXT}

@{B}NAME@{UB}
@{B}    StartSerial()

@{UB}
@{B}SYNOPSIS@{UB}
    int success = StartSerial( int timeout, BOOL microFlag );


@{B}DESCRIPTION@{UB}
    Issue a CMD_START to the Serial device (success < 0 means
    the timer timed out). 


@{B}SEE ALSO@{UB}
    StopSerial()

@ENDNODE

@NODE "StartTimer()" "StartTimer()"
@{FG SHINE}StartTimer()@{FG TEXT}

@{B}NAME@{UB}
@{B}    StartTimer()

@{UB}
@{B}DESCRIPTION@{UB}
    Tell the timeout timer to begin timing the serial device.

@ENDNODE

@NODE "StopSerial()" "StopSerial()"
@{FG SHINE}StopSerial()@{FG TEXT}

@{B}NAME@{UB}
@{B}    StopSerial()

@{UB}
@{B}SYNOPSIS@{UB}
    int success = StopSerial( int timeout, BOOL microFlag );


@{B}DESCRIPTION@{UB}
    Issue a CMD_STOP to the Serial device (success < 0 means
    the timer timed out). 


@{B}SEE ALSO@{UB}
    StartSerial()

@ENDNODE

@NODE "TestTimer()" "TestTimer()"
@{FG SHINE}TestTimer()@{FG TEXT}

@{B}NAME@{UB}
@{B}    TestTimer()

@{UB}
@{B}DESCRIPTION@{UB}
    Return any timer error values (zero means NO ERROR).

@ENDNODE


@NODE "TimerDelay()" "TimerDelay()"
@{FG SHINE}TimerDelay()@{FG TEXT}

@{B}NAME@{UB}
@{B}    TimerDelay()

@{UB}
@{B}DESCRIPTION@{UB}
    Start the Serial timeout timer & wait for it to time-out.

@ENDNODE
@NODE "TranslateErrorNumber()" "TranslateErrorNumber()"
@{FG SHINE}TranslateErrorNumber()@{FG TEXT}

@{B}NAME@{UB}
@{B}    TranslateErrorNumber()

@{UB}
@{B}DESCRIPTION@{UB}
    Return a string corresponding to the given error number.

@ENDNODE

@NODE "WriteChar()" "WriteChar()"
@{FG SHINE}WriteChar()@{FG TEXT}

@{B}NAME@{UB}
@{B}    WriteChar()

@{UB}
@{B}SYNOPSIS@{UB}
    int success = WriteChar( int timeout, BOOL microFlag, int ch );


@{B}DESCRIPTION@{UB}
    Write a single character to the Serial Port 
    (zero means success).

@ENDNODE
@NODE "WriteString()" "WriteString()"
@{FG SHINE}WriteString()@{FG TEXT}

@{B}NAME@{UB}
@{B}    WriteString()

@{UB}
@{B}SYNOPSIS@{UB}
    int success = WriteString( int   timeout, 
                               BOOL  microFlag,
                               char *string,
                               int   strsize
                             );


@{B}DESCRIPTION@{UB}
    Write a string to the Serial Port (zero means success). 

@ENDNODE
