/*
 *  Source machine generated by GadToolsBox V2.0b
 *  which is (c) Copyright 1991-1993 Jaba Development
 *
 *  GUI Designed by : Steve Anichini
 */


#include "window.h"

struct Screen         *Scr = NULL;
UBYTE                 *PubScreenName = "Workbench";
APTR                   VisualInfo = NULL;
struct Window         *DropBoxWnd = NULL;
struct Window         *SelectWnd = NULL;
struct Gadget         *DropBoxGList = NULL;
struct Gadget         *SelectGList = NULL;
struct Menu           *DropBoxMenus = NULL;
struct Gadget         *DropBoxGadgets[18];
struct Gadget         *SelectGadgets[3];
extern Class          *initGet( void );
struct IClass         *getClass = NULL;
struct _Object        *getImage = NULL;
UWORD                  DropBoxLeft = 103;
UWORD                  DropBoxTop = 150;
UWORD                  DropBoxWidth = 416;
UWORD                  DropBoxHeight = 162;
UWORD                  SelectLeft = 182;
UWORD                  SelectTop = 96;
UWORD                  SelectWidth = 211;
UWORD                  SelectHeight = 133;
UBYTE                 *DropBoxWdt = (UBYTE *)"DropBox 1.1";
UBYTE                 *SelectWdt = (UBYTE *)"DropBox Selection";

struct TextAttr topaz8 = {
	( STRPTR )"topaz.font", 8, 0x00, 0x00 };

struct NewMenu DropBoxNewMenu[] = {
	NM_TITLE, (STRPTR)"Project", NULL, 0, NULL, NULL,
	NM_ITEM, (STRPTR)"New...", (STRPTR)"N", 0, 0L, NULL,
	NM_ITEM, (STRPTR)NM_BARLABEL, NULL, 0, 0L, NULL,
	NM_ITEM, (STRPTR)"Open...", (STRPTR)"O", 0, 0L, NULL,
	NM_ITEM, (STRPTR)"Save", (STRPTR)"S", 0, 0L, NULL,
	NM_ITEM, (STRPTR)"Save as...", NULL, 0, 0L, NULL,
	NM_ITEM, (STRPTR)NM_BARLABEL, NULL, 0, 0L, NULL,
	NM_ITEM, (STRPTR)"About...", NULL, 0, 0L, NULL,
	NM_ITEM, (STRPTR)NM_BARLABEL, NULL, 0, 0L, NULL,
	NM_ITEM, (STRPTR)"Hide", (STRPTR)"H", 0, 0L, NULL,
	NM_ITEM, (STRPTR)"Quit...", (STRPTR)"Q", 0, 0L, NULL,
	NM_TITLE, (STRPTR)"Edit", NULL, 0, NULL, NULL,
	NM_ITEM, (STRPTR)"Cut", (STRPTR)"X", NM_ITEMDISABLED, 0L, NULL,
	NM_ITEM, (STRPTR)"Copy", (STRPTR)"C", NM_ITEMDISABLED, 0L, NULL,
	NM_ITEM, (STRPTR)"Paste", (STRPTR)"V", NM_ITEMDISABLED, 0L, NULL,
	NM_ITEM, (STRPTR)NM_BARLABEL, NULL, 0, 0L, NULL,
	NM_ITEM, (STRPTR)"Bubble Up", (STRPTR)"U", NM_ITEMDISABLED, 0L, NULL,
	NM_ITEM, (STRPTR)"Bubble Down", (STRPTR)"D", NM_ITEMDISABLED, 0L, NULL,
	NM_TITLE, (STRPTR)"Options", NULL, 0, NULL, NULL,
	NM_ITEM, (STRPTR)"Create Icons", NULL, CHECKIT|MENUTOGGLE, 0L, NULL,
	NM_ITEM, (STRPTR)"Use Select Window", NULL, CHECKIT|MENUTOGGLE, 0L, NULL,
	NM_ITEM, (STRPTR)"Verify Commands", NULL, CHECKIT|MENUTOGGLE, 0L, NULL,
	NM_ITEM, (STRPTR)NM_BARLABEL, NULL, 0, 0L, NULL,
	NM_ITEM, (STRPTR)"I/O Window size...", NULL, 0, 0L, NULL,
	NM_END, NULL, NULL, 0, 0L, NULL };

UWORD DropBoxGTypes[] = {
	BUTTON_KIND,
	BUTTON_KIND,
	BUTTON_KIND,
	GENERIC_KIND,
	BUTTON_KIND,
	GENERIC_KIND,
	CHECKBOX_KIND,
	STRING_KIND,
	LISTVIEW_KIND,
	STRING_KIND,
	LISTVIEW_KIND,
	STRING_KIND,
	STRING_KIND,
	STRING_KIND,
	BUTTON_KIND,
	BUTTON_KIND,
	BUTTON_KIND,
	CHECKBOX_KIND
};

UWORD SelectGTypes[] = {
	LISTVIEW_KIND,
	BUTTON_KIND,
	BUTTON_KIND
};

struct NewGadget DropBoxNGad[] = {
	5, 80, 41, 15, (UBYTE *)"_Add", NULL, GD_Add, PLACETEXT_IN, NULL, NULL,
	48, 80, 41, 15, (UBYTE *)"Del", NULL, GD_Delete, PLACETEXT_IN, NULL, NULL,
	91, 80, 41, 15, (UBYTE *)"_Ins", NULL, GD_Insert, PLACETEXT_IN, NULL, NULL,
	291, 103, 20, 14, NULL, NULL, GD_DestGet, 0, NULL, NULL,
	134, 80, 41, 15, (UBYTE *)"Sort", NULL, GD_Sort, PLACETEXT_IN, NULL, NULL,
	291, 123, 20, 14, NULL, NULL, GD_ComGet, 0, NULL, NULL,
	373, 15, 26, 11, (UBYTE *)"I/O", NULL, GD_Suppress, PLACETEXT_LEFT, NULL, NULL,
	5, 20, 170, 17, NULL, NULL, GD_Name, 0, NULL, NULL,
	5, 15, 170, 56, (UBYTE *)"DropItem Database", NULL, GD_File_Types, PLACETEXT_ABOVE|NG_HIGHLABEL, NULL, NULL,
	185, 20, 126, 17, NULL, NULL, GD_Pattern, 0, NULL, NULL,
	185, 15, 126, 56, (UBYTE *)"Pattern", NULL, GD_Pat_View, PLACETEXT_ABOVE|NG_HIGHLABEL, NULL, NULL,
	103, 100, 186, 17, (UBYTE *)"Destination", NULL, GD_Dest, PLACETEXT_LEFT, NULL, NULL,
	102, 120, 187, 17, (UBYTE *)"Command    ", NULL, GD_Command, PLACETEXT_LEFT, NULL, NULL,
	78, 140, 233, 17, (UBYTE *)"Template", NULL, GD_Template, PLACETEXT_LEFT, NULL, NULL,
	185, 80, 41, 15, (UBYTE *)"Add", NULL, GD_Pat_Add, PLACETEXT_IN, NULL, NULL,
	227, 80, 41, 15, (UBYTE *)"Del", NULL, GD_Pat_Del, PLACETEXT_IN, NULL, NULL,
	270, 80, 41, 15, (UBYTE *)"Ins", NULL, GD_Pat_Ins, PLACETEXT_IN, NULL, NULL,
	373, 30, 26, 11, (UBYTE *)"Create", NULL, GD_Create, PLACETEXT_LEFT, NULL, NULL
};

struct NewGadget SelectNGad[] = {
	17, 14, 170, 80, (UBYTE *)"Process With:", NULL, GD_SelectGad, PLACETEXT_ABOVE|NG_HIGHLABEL, NULL, NULL,
	127, 105, 60, 21, (UBYTE *)"Cancel", NULL, GD_Cancel, PLACETEXT_IN, NULL, NULL,
	17, 105, 43, 21, (UBYTE *)"Ok", NULL, GD_Ok, PLACETEXT_IN, NULL, NULL
};

ULONG DropBoxGTags[] = {
	(GT_Underscore), '_', (TAG_DONE),
	(GA_Disabled), TRUE, (TAG_DONE),
	(GT_Underscore), '_', (GA_Disabled), TRUE, (TAG_DONE),
	(TAG_DONE),
	(TAG_DONE),
	(TAG_DONE),
	(GA_Disabled), TRUE, (TAG_DONE),
	(GTST_MaxChars), 30, (GA_Disabled), TRUE, (TAG_DONE),
	(GTLV_ShowSelected), 1L, (TAG_DONE),
	(GTST_MaxChars), 10, (GA_Disabled), TRUE, (TAG_DONE),
	(GTLV_ShowSelected), 1L, (TAG_DONE),
	(GTST_MaxChars), 128, (GA_Disabled), TRUE, (TAG_DONE),
	(GTST_MaxChars), 128, (GA_Disabled), TRUE, (TAG_DONE),
	(GTST_MaxChars), 128, (GA_Disabled), TRUE, (TAG_DONE),
	(GA_Disabled), TRUE, (TAG_DONE),
	(GA_Disabled), TRUE, (TAG_DONE),
	(GA_Disabled), TRUE, (TAG_DONE),
	(GA_Disabled), TRUE, (TAG_DONE)
};

ULONG SelectGTags[] = {
	(GTLV_ShowSelected), NULL, (TAG_DONE),
	(TAG_DONE),
	(TAG_DONE)
};

int SetupScreen( void )
{
	if ( ! ( Scr = LockPubScreen( PubScreenName )))
		return( 1L );

	if ( ! ( VisualInfo = GetVisualInfo( Scr, TAG_DONE )))
		return( 2L );

	if ( ! ( getClass = initGet()))
		return( 3L );

	if ( ! ( getImage = NewObject( getClass, NULL, GT_VisualInfo, VisualInfo, TAG_DONE )))
		return( 4L );

	return( 0L );
}

void CloseDownScreen( void )
{
	if ( getImage   ) {
		DisposeObject( getImage );
		getImage = NULL;
	}

	if ( getClass   ) {
		FreeClass( getClass );
		getClass = NULL;
	}

	if ( VisualInfo ) {
		FreeVisualInfo( VisualInfo );
		VisualInfo = NULL;
	}

	if ( Scr        ) {
		UnlockPubScreen( NULL, Scr );
		Scr = NULL;
	}
}

int OpenDropBoxWindow( void )
{
	struct NewGadget	ng;
	struct Gadget	*g;
	struct TagItem	*tmp;
	UWORD		lc, tc;
	UWORD		offx = Scr->WBorLeft, offy = Scr->WBorTop + Scr->RastPort.TxHeight + 1;

	if ( ! ( g = CreateContext( &DropBoxGList )))
		return( 1L );

	for( lc = 0, tc = 0; lc < DropBox_CNT; lc++ ) {

		CopyMem((char * )&DropBoxNGad[ lc ], (char * )&ng, (long)sizeof( struct NewGadget ));

		ng.ng_VisualInfo = VisualInfo;
		ng.ng_TextAttr   = &topaz8;
		ng.ng_LeftEdge  += offx;
		ng.ng_TopEdge   += offy;

		if ( DropBoxGTypes[ lc ] == LISTVIEW_KIND ) {
			if ( tmp = FindTagItem( GTLV_ShowSelected, ( struct TagItem * )&DropBoxGTags[ tc ] )) {
				if ( tmp->ti_Data ) tmp->ti_Data = (ULONG)g;
			}
		}

		DropBoxGadgets[ lc ] = g = CreateGadgetA((ULONG)DropBoxGTypes[ lc ], g, &ng, ( struct TagItem * )&DropBoxGTags[ tc ] );

		if ( DropBoxGTypes[ lc ] == GENERIC_KIND ) {
			g->Flags             |= GFLG_GADGIMAGE | GFLG_GADGHIMAGE;
			g->Activation        |= GACT_RELVERIFY;
			g->GadgetRender       = (APTR)getImage;
			g->SelectRender       = (APTR)getImage;
		}

		while( DropBoxGTags[ tc ] ) tc += 2;
		tc++;

		if ( NOT g )
			return( 2L );
	}

	if ( ! ( DropBoxMenus = CreateMenus( DropBoxNewMenu, GTMN_FrontPen, 0L, TAG_DONE )))
		return( 3L );

	LayoutMenus( DropBoxMenus, VisualInfo, GTMN_TextAttr, &topaz8, TAG_DONE );

	if ( ! ( DropBoxWnd = OpenWindowTags( NULL,
				WA_Left,	DropBoxLeft,
				WA_Top,		DropBoxTop,
				WA_Width,	DropBoxWidth,
				WA_Height,	DropBoxHeight + offy,
				WA_IDCMP,	BUTTONIDCMP|IDCMP_GADGETUP|CHECKBOXIDCMP|STRINGIDCMP|LISTVIEWIDCMP|IDCMP_MENUPICK|IDCMP_CLOSEWINDOW|IDCMP_REFRESHWINDOW,
				WA_Flags,	WFLG_DRAGBAR|WFLG_DEPTHGADGET|WFLG_CLOSEGADGET|WFLG_SMART_REFRESH|WFLG_ACTIVATE,
				WA_Gadgets,	DropBoxGList,
				WA_Title,	DropBoxWdt,
				WA_ScreenTitle,	"DropBox 1.1 Copyright 1993 Steve Anichini.",
				WA_PubScreenFallBack,	TRUE,
				TAG_DONE )))
	return( 4L );

	SetMenuStrip( DropBoxWnd, DropBoxMenus );
	GT_RefreshWindow( DropBoxWnd, NULL );

	return( 0L );
}

void CloseDropBoxWindow( void )
{
	if ( DropBoxMenus      ) {
		ClearMenuStrip( DropBoxWnd );
		FreeMenus( DropBoxMenus );
		DropBoxMenus = NULL;	}

	if ( DropBoxWnd        ) {
		CloseWindow( DropBoxWnd );
		DropBoxWnd = NULL;
	}

	if ( DropBoxGList      ) {
		FreeGadgets( DropBoxGList );
		DropBoxGList = NULL;
	}
}

int OpenSelectWindow( void )
{
	struct NewGadget	ng;
	struct Gadget	*g;
	struct TagItem	*tmp;
	UWORD		lc, tc;
	UWORD		offx = Scr->WBorLeft, offy = Scr->WBorTop + Scr->RastPort.TxHeight + 1;

	if ( ! ( g = CreateContext( &SelectGList )))
		return( 1L );

	for( lc = 0, tc = 0; lc < Select_CNT; lc++ ) {

		CopyMem((char * )&SelectNGad[ lc ], (char * )&ng, (long)sizeof( struct NewGadget ));

		ng.ng_VisualInfo = VisualInfo;
		ng.ng_TextAttr   = &topaz8;
		ng.ng_LeftEdge  += offx;
		ng.ng_TopEdge   += offy;

		SelectGadgets[ lc ] = g = CreateGadgetA((ULONG)SelectGTypes[ lc ], g, &ng, ( struct TagItem * )&SelectGTags[ tc ] );

		while( SelectGTags[ tc ] ) tc += 2;
		tc++;

		if ( NOT g )
			return( 2L );
	}

	if ( ! ( SelectWnd = OpenWindowTags( NULL,
				WA_Left,	SelectLeft,
				WA_Top,		SelectTop,
				WA_Width,	SelectWidth,
				WA_Height,	SelectHeight + offy,
				WA_IDCMP,	LISTVIEWIDCMP|BUTTONIDCMP|IDCMP_CLOSEWINDOW|IDCMP_REFRESHWINDOW,
				WA_Flags,	WFLG_DRAGBAR|WFLG_DEPTHGADGET|WFLG_SMART_REFRESH|WFLG_SIMPLE_REFRESH|WFLG_ACTIVATE,
				WA_Gadgets,	SelectGList,
				WA_Title,	SelectWdt,
				WA_ScreenTitle,	"DropBox 1.1 Copyright 1993 SteveAnichini",
				TAG_DONE )))
	return( 4L );

	GT_RefreshWindow( SelectWnd, NULL );

	return( 0L );
}

void CloseSelectWindow( void )
{
	if ( SelectWnd        ) {
		CloseWindow( SelectWnd );
		SelectWnd = NULL;
	}

	if ( SelectGList      ) {
		FreeGadgets( SelectGList );
		SelectGList = NULL;
	}
}

