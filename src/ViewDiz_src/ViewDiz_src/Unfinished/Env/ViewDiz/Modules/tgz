.key file/a,cmd/a,desc
.bra {
.ket }
.def desc="t:file_id.diz"
if {cmd} eq "info"
 setenv viewdiz/.minf "*"{file}*"" rwxd 6 _UnTgz (#?.targz|#?.tgz|#?.gz) "Tar/GZip archive"
 skip end
endif
stack >nil: 10000
if warn
 echo "Not enough memory!"
 quit 5
endif
copy >nil: "{file}" to t:temp.tar.gz
gzip -d t:temp.tar.gz
if {cmd} eq "read"
 execute env:viewdiz/modules/tar t:temp.tar cmd=read desc="{desc}"
endif
if {cmd} eq "execute"
 execute env:viewdiz/modules/tar t:temp.tar cmd=execute desc="{desc}"
endif
if {cmd} eq "write"
 failat 21
 execute env:viewdiz/modules/tar t:temp.tar cmd=write desc="{desc}"
 gzip t:temp.tar
 if exists t:temp.tar.gz
  copy >nil: t:temp.tar.gz "{file}" noreq
  delete >nil: t:temp.tar.gz
 endif
endif
if {cmd} eq "delete"
 failat 21
 execute env:viewdiz/modules/tar t:temp.tar cmd=delete desc="{desc}"
 gzip t:temp.tar
 if exists t:temp.tar.gz
  copy >nil: t:temp.tar.gz "{file}" noreq
  delete >nil: t:temp.tar.gz
 endif
endif
delete >nil: t:temp.tar
lab end
;$VER: ViewDiz-TGZ.module 1.1 (31.8.98) Mikael Lund
