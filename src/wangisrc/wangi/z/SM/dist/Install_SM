; Startup-Menu install script for CBM Installer
;$VER: SM_install 1.0
;$AUTHOR: Lee Kindness

(set @default-dest '')

; make sure OS 2+
(set vernum (getversion))
(set ver (/ vernum 65536))

(if (< vernum 37)
	(abort 'Workbench 2 or higher required')
)

; mak' SM dir'
(makedir 'S:SM')

; copy reqtools library
(copylib
	(prompt 'Copying Reqtools.library')
	(help 'This file is required by SMPrefs. It is used to create some of the requesters.\n\n'@copylib-help)
	(source 'reqtools.library')
	(dest 'LIBS:')
	(confirm)
)

; copy SMPrefs
(copyfiles
	(prompt 'Copying Startup-Menu preference editor.')
	(help 'This file is used to configure the menu.\n\n'@copyfiles-help)
	(source 'SMPrefs')
	(dest 'SYS:Prefs')
	(confirm)
	(infos)
	(noposition)
)

; copy SM
(copyfiles
	(source 'Startup-Menu')
	(dest 'C:')
)

; copy .WIT files
(copyfiles
	(prompt 'Copying phrase files')
	(help 'These files are used to pick random phrases from. The phrases are then scrolled along the menu.\n\n'@copyfiles-help)
	(source 'S/SM')
	(dest 'S:SM')
	(pattern '#?.WIT')
	(confirm)
)

; copy Sample prefs
(if (askbool
		(prompt 'Do you wish to install the sample preferences?')
		(default 1)
		(help 'none.')
		)
		((copyfiles
			(source 'S/Startup-Menu.prefs')
			(dest 'S:')
			(confirm)
			(help 'This is a sample preference file\n\n.'@copyfiles-help)
			(prompt 'Copying sample prefs file')
		)

		(copyfiles
			(source 'S')
			(dest 'S:')
			(pattern '#?.rexx')
			(confirm)
			(help 'These are sample ARexx scripts.\n\n'@copyfiles-help)
			(prompt 'Copying sample ARexx scripts')
		)

		(copyfiles
			(source 'S/SM')
			(dest 'S:SM')
			(pattern '~(#?.WIT)')
			(confirm)
			(help 'These files are used by the sample config.\n\n'@copyfiles-help)
			(prompt 'Copying sample prefs script files')
		)
	)
)

; make startup-sequence backup

(If	(= (Exists "S:Startup-Sequence.SMOLD" (noreq)) 0) 
	(
		(copyfiles
			(source 'S:Startup-Sequence')
			(dest 'S:')
			(newname 'Startup-sequence.SMOLD')
			(nogauge)
		)
	)
)

; rename and copy new startup-sequence
(if (>= vernum 39)
	(set filetocopy "S/Startup-sequence_OS3")
	(set filetocopy "S/Startup-sequence_OS2")
)

(copyfiles
	(prompt 'Renaming Startup-Sequence')
	(help 'The Startup-sequence must be replaced. A backup (Startup-sequence.SMOLD) has been made.\n\n'@copyfiles-help)
	(source filetocopy)
	(dest 'S:')
	(newname 'Startup-sequence')
	(confirm)
)

(transcript '\nStartup-Menu installed.\n')

(exit 'I hope you find Startup-Menu useful.\n    LSK _\\\\//')

	




