#
# DMakefile for DICE link library "ums"
#
LIBNAME = ums
SRCS    = UMSLog.c UMSReadConfigTags.c UMSReadMsgTags.c UMSSearchTags.c \
          UMSSelectTags.c UMSWriteConfigTags.c UMSWriteMsgTags.c \
          UMSMatchConfigTags.c
#
UMSDIR  = ///
LIBDIR  = /
TMPDIR  = T:dlib/$(LIBNAME)/
SOBJS   = $(SRCS:"*.c":"$(TMPDIR)*s.o")
SROBJS  = $(SRCS:"*.c":"$(TMPDIR)*sr.o")
LOBJS   = $(SRCS:"*.c":"$(TMPDIR)*l.o")
LROBJS  = $(SRCS:"*.c":"$(TMPDIR)*lr.o")
SLIB    = $(LIBDIR)$(LIBNAME)s.lib
SRLIB   = $(LIBDIR)$(LIBNAME)sr.lib
LLIB    = $(LIBDIR)$(LIBNAME)l.lib
LRLIB   = $(LIBDIR)$(LIBNAME)lr.lib
FDLIB   = $(TMPDIR)$(LIBNAME)fd.lib
FTLOPTS = $(UMSDIR)fd/$(LIBNAME)_lib.fd \
          -h $(UMSDIR)c/include/clib/$(LIBNAME)_protos.h \
          -I $(UMSDIR)c/include -I DINCLUDE:amiga31 \
          -o $(FDLIB) -auto $(LIBNAME).library -v
CFLAGS  = -3.1 -mi -I $(UMSDIR)c/include

all       : $(SLIB) $(SRLIB) $(LLIB) $(LRLIB)

$(SLIB)   : $(SOBJS)
      fdtolib $(FTLOPTS) -md
      Join %(right) $(FDLIB) to %(left)
      -delete $(FDLIB)

$(SRLIB)  : $(SROBJS)
      fdtolib $(FTLOPTS) -md -mRR
      Join %(right) $(FDLIB) to %(left)
      -delete $(FDLIB)

$(LLIB)   : $(LOBJS)
      fdtolib $(FTLOPTS) -mD
      Join %(right) $(FDLIB) to %(left)
      -delete $(FDLIB)

$(LRLIB)  : $(LROBJS)
      fdtolib $(FTLOPTS) -mD -mRR
      Join %(right) $(FDLIB) to %(left)
      -delete $(FDLIB)

$(SOBJS)  : $(SRCS)
      dcc $(CFLAGS) -o %(left) -c %(right) -md

$(SROBJS) : $(SRCS)
      dcc $(CFLAGS) -o %(left) -c %(right) -md -mRR

$(LOBJS)  : $(SRCS)
      dcc $(CFLAGS) -o %(left) -c %(right) -mD

$(LROBJS) : $(SRCS)
      dcc $(CFLAGS) -o %(left) -c %(right) -mD -mRR

clean     :
      -Delete $(TMPDIR) ALL QUIET

new       :
      DMake clean
      DMake all
