#
# DMakefile  V3.1
#
# Makefile for ToolManager 3.1 (Library)
#
# Copyright (C) 1990-98 Stefan Becker
#
# This source code is for educational purposes only. You may study it
# and copy ideas or algorithms from it for your own projects. It is
# not allowed to use any of the source codes (in full or in parts)
# in other programs. Especially it is not allowed to create variants
# of ToolManager or ToolManager-like programs from this source code.
#
TMPDIR = T:
PRE    = $(TMPDIR)tmlib.m
FLAGS  = -3.1 -mi -mRR -ms
IDIRS  = -I //Developer/C/include -I ///ScreenNotify/include \
         -I ///WBStart/dev/c/include -I ///DOSPath/dev/c/include \
         -I Work:PictureDT-V43/include
#CFLAGS = $(FLAGS) -DDEBUG=1 -d1 $(IDIRS) -proto -H$(PRE)=toolmanager.h -c
#CFLAGS = $(FLAGS) -DDEBUG=0 -d1 $(IDIRS) -proto -H$(PRE)=toolmanager.h -c
CFLAGS = $(FLAGS) $(IDIRS) -proto -H$(PRE)=toolmanager.h -c
#LFLAGS = $(FLAGS) -d1
LFLAGS = $(FLAGS)
#LIBS   = -l0 -ldebug -lamiga31 -lamiga31s -lc
LIBS   = -l0 -lamiga31 -lc

CSRCS  = toolmanager.c handler.c handle.c config.c global.c \
         window.c commodities.c appmsgs.c network.c screen.c commands.c \
         base.c exec.c image.c sound.c menu.c icon.c dock.c \
         group.c button.c entry.c \
         clistart.c wbstart.c arexx.c cmdline.c \
         locale.c memory.c misc.c debug.c
COBJS  = $(CSRCS:"*.c":"$(TMPDIR)lib*.o")
DOBJ   = $(COBJS:"*debug.o")
MEOBJ  = $(COBJS:"*memory.o")
MIOBJ  = $(COBJS:"*misc.o")
AOBJ   = $(TMPDIR)libboopsi.o

DEST   = //libs/toolmanager.library

all      : $(DEST)

$(DEST)  : $(COBJS) $(AOBJ)
         dcc $(LFLAGS) -o %(left) %(right) $(LIBS)

$(COBJS) : $(CSRCS)
         dcc $(CFLAGS) -o %(left) %(right)

$(COBJS) : $(PRE)

$(DOBJ)  : /global_debug.c

$(MEOBJ) : /global_memory.c

$(MIOBJ) : /global_misc.c

$(AOBJ)  : /global_boopsi.a
         das -o %(left) %(right)

$(PRE)   : toolmanager.h //Developer/C/include/libraries/toolmanager.h \
           /global.h DMakefile
         -Delete %(left) QUIET

clean    :
         -Delete $(PRE) $(COBJS) $(AOBJ) QUIET
