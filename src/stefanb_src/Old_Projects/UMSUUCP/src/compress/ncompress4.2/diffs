*** compress42.c.orig	Wed Oct 28 11:10:53 1992
--- compress42.c	Sun Jun  6 22:48:19 1993
***************
*** 138,143 ****
--- 138,147 ----
  #include        <sys/stat.h>
  #include        <errno.h>
  
+ #include <string.h>
+ #include <stdlib.h>
+ #define utime(a,b) 0
+ 
  #ifdef DIRENT
  #       include <dirent.h>
  #       define  RECURSIVE               1
***************
*** 588,595 ****
  	 }
  #	define	clear_tab_prefixof()	memset(code0tab, 0, 256);
  #else	/* Normal machine */
! 	count_int		htab[HSIZE];
! 	unsigned short	codetab[HSIZE];
  
  #	define	htabof(i)				htab[i]
  #	define	codetabof(i)			codetab[i]
--- 592,599 ----
           }
  #       define  clear_tab_prefixof()    memset(code0tab, 0, 256);
  #else   /* Normal machine */
!         count_int *htab;
!         unsigned short  *codetab;
  
  #       define  htabof(i)                               htab[i]
  #       define  codetabof(i)                    codetab[i]
***************
*** 596,602 ****
  #	define	tab_prefixof(i)			codetabof(i)
  #	define	tab_suffixof(i)			((char_type *)(htab))[i]
  #	define	de_stack				((char_type *)&(htab[HSIZE-1]))
! #	define	clear_htab()			memset(htab, -1, sizeof(htab))
  #	define	clear_tab_prefixof()	memset(codetab, 0, 256);
  #endif	/* MAXSEG_64K */
  
--- 600,606 ----
  #       define  tab_prefixof(i)                 codetabof(i)
  #       define  tab_suffixof(i)                 ((char_type *)(htab))[i]
  #       define  de_stack                                ((char_type *)&(htab[HSIZE-1]))
! #       define  clear_htab()                    memset(htab, -1, HSIZE * sizeof(count_int))
  #       define  clear_tab_prefixof()    memset(codetab, 0, 256);
  #endif  /* MAXSEG_64K */
  
***************
*** 711,717 ****
      	nomagic = 1;	/* Original didn't have a magic number */
  #endif
  
!     	filelist = fileptr = (char **)malloc(argc*sizeof(char *));
      	*filelist = NULL;
  
      	if((progname = rindex(argv[0], '/')) != 0)
--- 715,725 ----
          nomagic = 1;    /* Original didn't have a magic number */
  #endif
  
!         if (!(htab = (count_int *) malloc(HSIZE * sizeof(count_int))) ||
!             !(codetab = (short *) malloc(HSIZE * sizeof(short))) ||
!             !(filelist = fileptr = (char **)malloc(argc*sizeof(char *))))
!          exit(20);
! 
          *filelist = NULL;
  
          if((progname = rindex(argv[0], '/')) != 0)
